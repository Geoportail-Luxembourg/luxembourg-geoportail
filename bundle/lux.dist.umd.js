var __defProp = Object.defineProperty;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __publicField = (obj, key, value) => {
  __defNormalProp(obj, typeof key !== "symbol" ? key + "" : key, value);
  return value;
};
(function(global2, factory) {
  typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("vue"), require("@vue/runtime-core"), require("@vue/shared"), require("@vue/runtime-dom")) : typeof define === "function" && define.amd ? define(["exports", "vue", "@vue/runtime-core", "@vue/shared", "@vue/runtime-dom"], factory) : (global2 = typeof globalThis !== "undefined" ? globalThis : global2 || self, factory(global2["luxembourg-geoportail"] = {}, global2.Vue, global2.runtimeCore, global2.shared$1, global2.runtimeDom));
})(this, function(exports2, vue, runtimeCore, shared$1, runtimeDom) {
  "use strict";
  function _mergeNamespaces(n, m) {
    for (var i = 0; i < m.length; i++) {
      const e = m[i];
      if (typeof e !== "string" && !Array.isArray(e)) {
        for (const k in e) {
          if (k !== "default" && !(k in n)) {
            const d = Object.getOwnPropertyDescriptor(e, k);
            if (d) {
              Object.defineProperty(n, k, d.get ? d : {
                enumerable: true,
                get: () => e[k]
              });
            }
          }
        }
      }
    }
    return Object.freeze(Object.defineProperty(n, Symbol.toStringTag, { value: "Module" }));
  }
  /*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */
  function _typeof$5(obj) {
    "@babel/helpers - typeof";
    return _typeof$5 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(obj2) {
      return typeof obj2;
    } : function(obj2) {
      return obj2 && "function" == typeof Symbol && obj2.constructor === Symbol && obj2 !== Symbol.prototype ? "symbol" : typeof obj2;
    }, _typeof$5(obj);
  }
  function _setPrototypeOf$1(o, p2) {
    _setPrototypeOf$1 = Object.setPrototypeOf || function _setPrototypeOf2(o2, p3) {
      o2.__proto__ = p3;
      return o2;
    };
    return _setPrototypeOf$1(o, p2);
  }
  function _isNativeReflectConstruct$4() {
    if (typeof Reflect === "undefined" || !Reflect.construct)
      return false;
    if (Reflect.construct.sham)
      return false;
    if (typeof Proxy === "function")
      return true;
    try {
      Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
      }));
      return true;
    } catch (e) {
      return false;
    }
  }
  function _construct(Parent, args, Class) {
    if (_isNativeReflectConstruct$4()) {
      _construct = Reflect.construct;
    } else {
      _construct = function _construct2(Parent2, args2, Class2) {
        var a = [null];
        a.push.apply(a, args2);
        var Constructor = Function.bind.apply(Parent2, a);
        var instance2 = new Constructor();
        if (Class2)
          _setPrototypeOf$1(instance2, Class2.prototype);
        return instance2;
      };
    }
    return _construct.apply(null, arguments);
  }
  function _toConsumableArray(arr2) {
    return _arrayWithoutHoles(arr2) || _iterableToArray$1(arr2) || _unsupportedIterableToArray$1(arr2) || _nonIterableSpread();
  }
  function _arrayWithoutHoles(arr2) {
    if (Array.isArray(arr2))
      return _arrayLikeToArray$1(arr2);
  }
  function _iterableToArray$1(iter) {
    if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null)
      return Array.from(iter);
  }
  function _unsupportedIterableToArray$1(o, minLen) {
    if (!o)
      return;
    if (typeof o === "string")
      return _arrayLikeToArray$1(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor)
      n = o.constructor.name;
    if (n === "Map" || n === "Set")
      return Array.from(o);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))
      return _arrayLikeToArray$1(o, minLen);
  }
  function _arrayLikeToArray$1(arr2, len) {
    if (len == null || len > arr2.length)
      len = arr2.length;
    for (var i = 0, arr22 = new Array(len); i < len; i++)
      arr22[i] = arr2[i];
    return arr22;
  }
  function _nonIterableSpread() {
    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }
  var hasOwnProperty = Object.hasOwnProperty, setPrototypeOf = Object.setPrototypeOf, isFrozen = Object.isFrozen, getPrototypeOf = Object.getPrototypeOf, getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;
  var freeze = Object.freeze, seal = Object.seal, create$1 = Object.create;
  var _ref = typeof Reflect !== "undefined" && Reflect, apply$1 = _ref.apply, construct = _ref.construct;
  if (!apply$1) {
    apply$1 = function apply2(fun, thisValue, args) {
      return fun.apply(thisValue, args);
    };
  }
  if (!freeze) {
    freeze = function freeze2(x) {
      return x;
    };
  }
  if (!seal) {
    seal = function seal2(x) {
      return x;
    };
  }
  if (!construct) {
    construct = function construct2(Func, args) {
      return _construct(Func, _toConsumableArray(args));
    };
  }
  var arrayForEach = unapply(Array.prototype.forEach);
  var arrayPop = unapply(Array.prototype.pop);
  var arrayPush = unapply(Array.prototype.push);
  var stringToLowerCase = unapply(String.prototype.toLowerCase);
  var stringToString = unapply(String.prototype.toString);
  var stringMatch = unapply(String.prototype.match);
  var stringReplace = unapply(String.prototype.replace);
  var stringIndexOf = unapply(String.prototype.indexOf);
  var stringTrim = unapply(String.prototype.trim);
  var regExpTest = unapply(RegExp.prototype.test);
  var typeErrorCreate = unconstruct(TypeError);
  function unapply(func) {
    return function(thisArg) {
      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        args[_key - 1] = arguments[_key];
      }
      return apply$1(func, thisArg, args);
    };
  }
  function unconstruct(func) {
    return function() {
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }
      return construct(func, args);
    };
  }
  function addToSet(set2, array, transformCaseFunc) {
    transformCaseFunc = transformCaseFunc ? transformCaseFunc : stringToLowerCase;
    if (setPrototypeOf) {
      setPrototypeOf(set2, null);
    }
    var l = array.length;
    while (l--) {
      var element = array[l];
      if (typeof element === "string") {
        var lcElement = transformCaseFunc(element);
        if (lcElement !== element) {
          if (!isFrozen(array)) {
            array[l] = lcElement;
          }
          element = lcElement;
        }
      }
      set2[element] = true;
    }
    return set2;
  }
  function clone$2(object) {
    var newObject = create$1(null);
    var property;
    for (property in object) {
      if (apply$1(hasOwnProperty, object, [property]) === true) {
        newObject[property] = object[property];
      }
    }
    return newObject;
  }
  function lookupGetter(object, prop) {
    while (object !== null) {
      var desc = getOwnPropertyDescriptor(object, prop);
      if (desc) {
        if (desc.get) {
          return unapply(desc.get);
        }
        if (typeof desc.value === "function") {
          return unapply(desc.value);
        }
      }
      object = getPrototypeOf(object);
    }
    function fallbackValue(element) {
      console.warn("fallback value for", element);
      return null;
    }
    return fallbackValue;
  }
  var html$1 = freeze(["a", "abbr", "acronym", "address", "area", "article", "aside", "audio", "b", "bdi", "bdo", "big", "blink", "blockquote", "body", "br", "button", "canvas", "caption", "center", "cite", "code", "col", "colgroup", "content", "data", "datalist", "dd", "decorator", "del", "details", "dfn", "dialog", "dir", "div", "dl", "dt", "element", "em", "fieldset", "figcaption", "figure", "font", "footer", "form", "h1", "h2", "h3", "h4", "h5", "h6", "head", "header", "hgroup", "hr", "html", "i", "img", "input", "ins", "kbd", "label", "legend", "li", "main", "map", "mark", "marquee", "menu", "menuitem", "meter", "nav", "nobr", "ol", "optgroup", "option", "output", "p", "picture", "pre", "progress", "q", "rp", "rt", "ruby", "s", "samp", "section", "select", "shadow", "small", "source", "spacer", "span", "strike", "strong", "style", "sub", "summary", "sup", "table", "tbody", "td", "template", "textarea", "tfoot", "th", "thead", "time", "tr", "track", "tt", "u", "ul", "var", "video", "wbr"]);
  var svg$1 = freeze(["svg", "a", "altglyph", "altglyphdef", "altglyphitem", "animatecolor", "animatemotion", "animatetransform", "circle", "clippath", "defs", "desc", "ellipse", "filter", "font", "g", "glyph", "glyphref", "hkern", "image", "line", "lineargradient", "marker", "mask", "metadata", "mpath", "path", "pattern", "polygon", "polyline", "radialgradient", "rect", "stop", "style", "switch", "symbol", "text", "textpath", "title", "tref", "tspan", "view", "vkern"]);
  var svgFilters = freeze(["feBlend", "feColorMatrix", "feComponentTransfer", "feComposite", "feConvolveMatrix", "feDiffuseLighting", "feDisplacementMap", "feDistantLight", "feFlood", "feFuncA", "feFuncB", "feFuncG", "feFuncR", "feGaussianBlur", "feImage", "feMerge", "feMergeNode", "feMorphology", "feOffset", "fePointLight", "feSpecularLighting", "feSpotLight", "feTile", "feTurbulence"]);
  var svgDisallowed = freeze(["animate", "color-profile", "cursor", "discard", "fedropshadow", "font-face", "font-face-format", "font-face-name", "font-face-src", "font-face-uri", "foreignobject", "hatch", "hatchpath", "mesh", "meshgradient", "meshpatch", "meshrow", "missing-glyph", "script", "set", "solidcolor", "unknown", "use"]);
  var mathMl$1 = freeze(["math", "menclose", "merror", "mfenced", "mfrac", "mglyph", "mi", "mlabeledtr", "mmultiscripts", "mn", "mo", "mover", "mpadded", "mphantom", "mroot", "mrow", "ms", "mspace", "msqrt", "mstyle", "msub", "msup", "msubsup", "mtable", "mtd", "mtext", "mtr", "munder", "munderover"]);
  var mathMlDisallowed = freeze(["maction", "maligngroup", "malignmark", "mlongdiv", "mscarries", "mscarry", "msgroup", "mstack", "msline", "msrow", "semantics", "annotation", "annotation-xml", "mprescripts", "none"]);
  var text = freeze(["#text"]);
  var html = freeze(["accept", "action", "align", "alt", "autocapitalize", "autocomplete", "autopictureinpicture", "autoplay", "background", "bgcolor", "border", "capture", "cellpadding", "cellspacing", "checked", "cite", "class", "clear", "color", "cols", "colspan", "controls", "controlslist", "coords", "crossorigin", "datetime", "decoding", "default", "dir", "disabled", "disablepictureinpicture", "disableremoteplayback", "download", "draggable", "enctype", "enterkeyhint", "face", "for", "headers", "height", "hidden", "high", "href", "hreflang", "id", "inputmode", "integrity", "ismap", "kind", "label", "lang", "list", "loading", "loop", "low", "max", "maxlength", "media", "method", "min", "minlength", "multiple", "muted", "name", "nonce", "noshade", "novalidate", "nowrap", "open", "optimum", "pattern", "placeholder", "playsinline", "poster", "preload", "pubdate", "radiogroup", "readonly", "rel", "required", "rev", "reversed", "role", "rows", "rowspan", "spellcheck", "scope", "selected", "shape", "size", "sizes", "span", "srclang", "start", "src", "srcset", "step", "style", "summary", "tabindex", "title", "translate", "type", "usemap", "valign", "value", "width", "xmlns", "slot"]);
  var svg = freeze(["accent-height", "accumulate", "additive", "alignment-baseline", "ascent", "attributename", "attributetype", "azimuth", "basefrequency", "baseline-shift", "begin", "bias", "by", "class", "clip", "clippathunits", "clip-path", "clip-rule", "color", "color-interpolation", "color-interpolation-filters", "color-profile", "color-rendering", "cx", "cy", "d", "dx", "dy", "diffuseconstant", "direction", "display", "divisor", "dur", "edgemode", "elevation", "end", "fill", "fill-opacity", "fill-rule", "filter", "filterunits", "flood-color", "flood-opacity", "font-family", "font-size", "font-size-adjust", "font-stretch", "font-style", "font-variant", "font-weight", "fx", "fy", "g1", "g2", "glyph-name", "glyphref", "gradientunits", "gradienttransform", "height", "href", "id", "image-rendering", "in", "in2", "k", "k1", "k2", "k3", "k4", "kerning", "keypoints", "keysplines", "keytimes", "lang", "lengthadjust", "letter-spacing", "kernelmatrix", "kernelunitlength", "lighting-color", "local", "marker-end", "marker-mid", "marker-start", "markerheight", "markerunits", "markerwidth", "maskcontentunits", "maskunits", "max", "mask", "media", "method", "mode", "min", "name", "numoctaves", "offset", "operator", "opacity", "order", "orient", "orientation", "origin", "overflow", "paint-order", "path", "pathlength", "patterncontentunits", "patterntransform", "patternunits", "points", "preservealpha", "preserveaspectratio", "primitiveunits", "r", "rx", "ry", "radius", "refx", "refy", "repeatcount", "repeatdur", "restart", "result", "rotate", "scale", "seed", "shape-rendering", "specularconstant", "specularexponent", "spreadmethod", "startoffset", "stddeviation", "stitchtiles", "stop-color", "stop-opacity", "stroke-dasharray", "stroke-dashoffset", "stroke-linecap", "stroke-linejoin", "stroke-miterlimit", "stroke-opacity", "stroke", "stroke-width", "style", "surfacescale", "systemlanguage", "tabindex", "targetx", "targety", "transform", "transform-origin", "text-anchor", "text-decoration", "text-rendering", "textlength", "type", "u1", "u2", "unicode", "values", "viewbox", "visibility", "version", "vert-adv-y", "vert-origin-x", "vert-origin-y", "width", "word-spacing", "wrap", "writing-mode", "xchannelselector", "ychannelselector", "x", "x1", "x2", "xmlns", "y", "y1", "y2", "z", "zoomandpan"]);
  var mathMl = freeze(["accent", "accentunder", "align", "bevelled", "close", "columnsalign", "columnlines", "columnspan", "denomalign", "depth", "dir", "display", "displaystyle", "encoding", "fence", "frame", "height", "href", "id", "largeop", "length", "linethickness", "lspace", "lquote", "mathbackground", "mathcolor", "mathsize", "mathvariant", "maxsize", "minsize", "movablelimits", "notation", "numalign", "open", "rowalign", "rowlines", "rowspacing", "rowspan", "rspace", "rquote", "scriptlevel", "scriptminsize", "scriptsizemultiplier", "selection", "separator", "separators", "stretchy", "subscriptshift", "supscriptshift", "symmetric", "voffset", "width", "xmlns"]);
  var xml = freeze(["xlink:href", "xml:id", "xlink:title", "xml:space", "xmlns:xlink"]);
  var MUSTACHE_EXPR = seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm);
  var ERB_EXPR = seal(/<%[\w\W]*|[\w\W]*%>/gm);
  var TMPLIT_EXPR = seal(/\${[\w\W]*}/gm);
  var DATA_ATTR = seal(/^data-[\-\w.\u00B7-\uFFFF]/);
  var ARIA_ATTR = seal(/^aria-[\-\w]+$/);
  var IS_ALLOWED_URI = seal(
    /^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i
  );
  var IS_SCRIPT_OR_DATA = seal(/^(?:\w+script|data):/i);
  var ATTR_WHITESPACE = seal(
    /[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g
  );
  var DOCTYPE_NAME = seal(/^html$/i);
  var getGlobal = function getGlobal2() {
    return typeof window === "undefined" ? null : window;
  };
  var _createTrustedTypesPolicy = function _createTrustedTypesPolicy2(trustedTypes, document2) {
    if (_typeof$5(trustedTypes) !== "object" || typeof trustedTypes.createPolicy !== "function") {
      return null;
    }
    var suffix = null;
    var ATTR_NAME = "data-tt-policy-suffix";
    if (document2.currentScript && document2.currentScript.hasAttribute(ATTR_NAME)) {
      suffix = document2.currentScript.getAttribute(ATTR_NAME);
    }
    var policyName = "dompurify" + (suffix ? "#" + suffix : "");
    try {
      return trustedTypes.createPolicy(policyName, {
        createHTML: function createHTML(html2) {
          return html2;
        },
        createScriptURL: function createScriptURL(scriptUrl) {
          return scriptUrl;
        }
      });
    } catch (_) {
      console.warn("TrustedTypes policy " + policyName + " could not be created.");
      return null;
    }
  };
  function createDOMPurify() {
    var window2 = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : getGlobal();
    var DOMPurify = function DOMPurify2(root) {
      return createDOMPurify(root);
    };
    DOMPurify.version = "2.4.5";
    DOMPurify.removed = [];
    if (!window2 || !window2.document || window2.document.nodeType !== 9) {
      DOMPurify.isSupported = false;
      return DOMPurify;
    }
    var originalDocument = window2.document;
    var document2 = window2.document;
    var DocumentFragment = window2.DocumentFragment, HTMLTemplateElement = window2.HTMLTemplateElement, Node2 = window2.Node, Element = window2.Element, NodeFilter = window2.NodeFilter, _window$NamedNodeMap = window2.NamedNodeMap, NamedNodeMap = _window$NamedNodeMap === void 0 ? window2.NamedNodeMap || window2.MozNamedAttrMap : _window$NamedNodeMap, HTMLFormElement = window2.HTMLFormElement, DOMParser2 = window2.DOMParser, trustedTypes = window2.trustedTypes;
    var ElementPrototype = Element.prototype;
    var cloneNode = lookupGetter(ElementPrototype, "cloneNode");
    var getNextSibling = lookupGetter(ElementPrototype, "nextSibling");
    var getChildNodes = lookupGetter(ElementPrototype, "childNodes");
    var getParentNode = lookupGetter(ElementPrototype, "parentNode");
    if (typeof HTMLTemplateElement === "function") {
      var template = document2.createElement("template");
      if (template.content && template.content.ownerDocument) {
        document2 = template.content.ownerDocument;
      }
    }
    var trustedTypesPolicy = _createTrustedTypesPolicy(trustedTypes, originalDocument);
    var emptyHTML = trustedTypesPolicy ? trustedTypesPolicy.createHTML("") : "";
    var _document = document2, implementation = _document.implementation, createNodeIterator = _document.createNodeIterator, createDocumentFragment = _document.createDocumentFragment, getElementsByTagName = _document.getElementsByTagName;
    var importNode = originalDocument.importNode;
    var documentMode = {};
    try {
      documentMode = clone$2(document2).documentMode ? document2.documentMode : {};
    } catch (_) {
    }
    var hooks = {};
    DOMPurify.isSupported = typeof getParentNode === "function" && implementation && typeof implementation.createHTMLDocument !== "undefined" && documentMode !== 9;
    var MUSTACHE_EXPR$1 = MUSTACHE_EXPR, ERB_EXPR$1 = ERB_EXPR, TMPLIT_EXPR$1 = TMPLIT_EXPR, DATA_ATTR$1 = DATA_ATTR, ARIA_ATTR$1 = ARIA_ATTR, IS_SCRIPT_OR_DATA$1 = IS_SCRIPT_OR_DATA, ATTR_WHITESPACE$1 = ATTR_WHITESPACE;
    var IS_ALLOWED_URI$1 = IS_ALLOWED_URI;
    var ALLOWED_TAGS = null;
    var DEFAULT_ALLOWED_TAGS = addToSet({}, [].concat(_toConsumableArray(html$1), _toConsumableArray(svg$1), _toConsumableArray(svgFilters), _toConsumableArray(mathMl$1), _toConsumableArray(text)));
    var ALLOWED_ATTR = null;
    var DEFAULT_ALLOWED_ATTR = addToSet({}, [].concat(_toConsumableArray(html), _toConsumableArray(svg), _toConsumableArray(mathMl), _toConsumableArray(xml)));
    var CUSTOM_ELEMENT_HANDLING = Object.seal(Object.create(null, {
      tagNameCheck: {
        writable: true,
        configurable: false,
        enumerable: true,
        value: null
      },
      attributeNameCheck: {
        writable: true,
        configurable: false,
        enumerable: true,
        value: null
      },
      allowCustomizedBuiltInElements: {
        writable: true,
        configurable: false,
        enumerable: true,
        value: false
      }
    }));
    var FORBID_TAGS = null;
    var FORBID_ATTR = null;
    var ALLOW_ARIA_ATTR = true;
    var ALLOW_DATA_ATTR = true;
    var ALLOW_UNKNOWN_PROTOCOLS = false;
    var ALLOW_SELF_CLOSE_IN_ATTR = true;
    var SAFE_FOR_TEMPLATES = false;
    var WHOLE_DOCUMENT = false;
    var SET_CONFIG = false;
    var FORCE_BODY = false;
    var RETURN_DOM = false;
    var RETURN_DOM_FRAGMENT = false;
    var RETURN_TRUSTED_TYPE = false;
    var SANITIZE_DOM = true;
    var SANITIZE_NAMED_PROPS = false;
    var SANITIZE_NAMED_PROPS_PREFIX = "user-content-";
    var KEEP_CONTENT = true;
    var IN_PLACE = false;
    var USE_PROFILES = {};
    var FORBID_CONTENTS = null;
    var DEFAULT_FORBID_CONTENTS = addToSet({}, ["annotation-xml", "audio", "colgroup", "desc", "foreignobject", "head", "iframe", "math", "mi", "mn", "mo", "ms", "mtext", "noembed", "noframes", "noscript", "plaintext", "script", "style", "svg", "template", "thead", "title", "video", "xmp"]);
    var DATA_URI_TAGS = null;
    var DEFAULT_DATA_URI_TAGS = addToSet({}, ["audio", "video", "img", "source", "image", "track"]);
    var URI_SAFE_ATTRIBUTES = null;
    var DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, ["alt", "class", "for", "id", "label", "name", "pattern", "placeholder", "role", "summary", "title", "value", "style", "xmlns"]);
    var MATHML_NAMESPACE = "http://www.w3.org/1998/Math/MathML";
    var SVG_NAMESPACE = "http://www.w3.org/2000/svg";
    var HTML_NAMESPACE = "http://www.w3.org/1999/xhtml";
    var NAMESPACE = HTML_NAMESPACE;
    var IS_EMPTY_INPUT = false;
    var ALLOWED_NAMESPACES = null;
    var DEFAULT_ALLOWED_NAMESPACES = addToSet({}, [MATHML_NAMESPACE, SVG_NAMESPACE, HTML_NAMESPACE], stringToString);
    var PARSER_MEDIA_TYPE;
    var SUPPORTED_PARSER_MEDIA_TYPES = ["application/xhtml+xml", "text/html"];
    var DEFAULT_PARSER_MEDIA_TYPE = "text/html";
    var transformCaseFunc;
    var CONFIG = null;
    var formElement = document2.createElement("form");
    var isRegexOrFunction = function isRegexOrFunction2(testValue) {
      return testValue instanceof RegExp || testValue instanceof Function;
    };
    var _parseConfig = function _parseConfig2(cfg) {
      if (CONFIG && CONFIG === cfg) {
        return;
      }
      if (!cfg || _typeof$5(cfg) !== "object") {
        cfg = {};
      }
      cfg = clone$2(cfg);
      PARSER_MEDIA_TYPE = SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE) === -1 ? PARSER_MEDIA_TYPE = DEFAULT_PARSER_MEDIA_TYPE : PARSER_MEDIA_TYPE = cfg.PARSER_MEDIA_TYPE;
      transformCaseFunc = PARSER_MEDIA_TYPE === "application/xhtml+xml" ? stringToString : stringToLowerCase;
      ALLOWED_TAGS = "ALLOWED_TAGS" in cfg ? addToSet({}, cfg.ALLOWED_TAGS, transformCaseFunc) : DEFAULT_ALLOWED_TAGS;
      ALLOWED_ATTR = "ALLOWED_ATTR" in cfg ? addToSet({}, cfg.ALLOWED_ATTR, transformCaseFunc) : DEFAULT_ALLOWED_ATTR;
      ALLOWED_NAMESPACES = "ALLOWED_NAMESPACES" in cfg ? addToSet({}, cfg.ALLOWED_NAMESPACES, stringToString) : DEFAULT_ALLOWED_NAMESPACES;
      URI_SAFE_ATTRIBUTES = "ADD_URI_SAFE_ATTR" in cfg ? addToSet(
        clone$2(DEFAULT_URI_SAFE_ATTRIBUTES),
        cfg.ADD_URI_SAFE_ATTR,
        transformCaseFunc
      ) : DEFAULT_URI_SAFE_ATTRIBUTES;
      DATA_URI_TAGS = "ADD_DATA_URI_TAGS" in cfg ? addToSet(
        clone$2(DEFAULT_DATA_URI_TAGS),
        cfg.ADD_DATA_URI_TAGS,
        transformCaseFunc
      ) : DEFAULT_DATA_URI_TAGS;
      FORBID_CONTENTS = "FORBID_CONTENTS" in cfg ? addToSet({}, cfg.FORBID_CONTENTS, transformCaseFunc) : DEFAULT_FORBID_CONTENTS;
      FORBID_TAGS = "FORBID_TAGS" in cfg ? addToSet({}, cfg.FORBID_TAGS, transformCaseFunc) : {};
      FORBID_ATTR = "FORBID_ATTR" in cfg ? addToSet({}, cfg.FORBID_ATTR, transformCaseFunc) : {};
      USE_PROFILES = "USE_PROFILES" in cfg ? cfg.USE_PROFILES : false;
      ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false;
      ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false;
      ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false;
      ALLOW_SELF_CLOSE_IN_ATTR = cfg.ALLOW_SELF_CLOSE_IN_ATTR !== false;
      SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false;
      WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false;
      RETURN_DOM = cfg.RETURN_DOM || false;
      RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false;
      RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false;
      FORCE_BODY = cfg.FORCE_BODY || false;
      SANITIZE_DOM = cfg.SANITIZE_DOM !== false;
      SANITIZE_NAMED_PROPS = cfg.SANITIZE_NAMED_PROPS || false;
      KEEP_CONTENT = cfg.KEEP_CONTENT !== false;
      IN_PLACE = cfg.IN_PLACE || false;
      IS_ALLOWED_URI$1 = cfg.ALLOWED_URI_REGEXP || IS_ALLOWED_URI$1;
      NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;
      CUSTOM_ELEMENT_HANDLING = cfg.CUSTOM_ELEMENT_HANDLING || {};
      if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)) {
        CUSTOM_ELEMENT_HANDLING.tagNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;
      }
      if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)) {
        CUSTOM_ELEMENT_HANDLING.attributeNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;
      }
      if (cfg.CUSTOM_ELEMENT_HANDLING && typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements === "boolean") {
        CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements = cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;
      }
      if (SAFE_FOR_TEMPLATES) {
        ALLOW_DATA_ATTR = false;
      }
      if (RETURN_DOM_FRAGMENT) {
        RETURN_DOM = true;
      }
      if (USE_PROFILES) {
        ALLOWED_TAGS = addToSet({}, _toConsumableArray(text));
        ALLOWED_ATTR = [];
        if (USE_PROFILES.html === true) {
          addToSet(ALLOWED_TAGS, html$1);
          addToSet(ALLOWED_ATTR, html);
        }
        if (USE_PROFILES.svg === true) {
          addToSet(ALLOWED_TAGS, svg$1);
          addToSet(ALLOWED_ATTR, svg);
          addToSet(ALLOWED_ATTR, xml);
        }
        if (USE_PROFILES.svgFilters === true) {
          addToSet(ALLOWED_TAGS, svgFilters);
          addToSet(ALLOWED_ATTR, svg);
          addToSet(ALLOWED_ATTR, xml);
        }
        if (USE_PROFILES.mathMl === true) {
          addToSet(ALLOWED_TAGS, mathMl$1);
          addToSet(ALLOWED_ATTR, mathMl);
          addToSet(ALLOWED_ATTR, xml);
        }
      }
      if (cfg.ADD_TAGS) {
        if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {
          ALLOWED_TAGS = clone$2(ALLOWED_TAGS);
        }
        addToSet(ALLOWED_TAGS, cfg.ADD_TAGS, transformCaseFunc);
      }
      if (cfg.ADD_ATTR) {
        if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {
          ALLOWED_ATTR = clone$2(ALLOWED_ATTR);
        }
        addToSet(ALLOWED_ATTR, cfg.ADD_ATTR, transformCaseFunc);
      }
      if (cfg.ADD_URI_SAFE_ATTR) {
        addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR, transformCaseFunc);
      }
      if (cfg.FORBID_CONTENTS) {
        if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {
          FORBID_CONTENTS = clone$2(FORBID_CONTENTS);
        }
        addToSet(FORBID_CONTENTS, cfg.FORBID_CONTENTS, transformCaseFunc);
      }
      if (KEEP_CONTENT) {
        ALLOWED_TAGS["#text"] = true;
      }
      if (WHOLE_DOCUMENT) {
        addToSet(ALLOWED_TAGS, ["html", "head", "body"]);
      }
      if (ALLOWED_TAGS.table) {
        addToSet(ALLOWED_TAGS, ["tbody"]);
        delete FORBID_TAGS.tbody;
      }
      if (freeze) {
        freeze(cfg);
      }
      CONFIG = cfg;
    };
    var MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, ["mi", "mo", "mn", "ms", "mtext"]);
    var HTML_INTEGRATION_POINTS = addToSet({}, ["foreignobject", "desc", "title", "annotation-xml"]);
    var COMMON_SVG_AND_HTML_ELEMENTS = addToSet({}, ["title", "style", "font", "a", "script"]);
    var ALL_SVG_TAGS = addToSet({}, svg$1);
    addToSet(ALL_SVG_TAGS, svgFilters);
    addToSet(ALL_SVG_TAGS, svgDisallowed);
    var ALL_MATHML_TAGS = addToSet({}, mathMl$1);
    addToSet(ALL_MATHML_TAGS, mathMlDisallowed);
    var _checkValidNamespace = function _checkValidNamespace2(element) {
      var parent = getParentNode(element);
      if (!parent || !parent.tagName) {
        parent = {
          namespaceURI: NAMESPACE,
          tagName: "template"
        };
      }
      var tagName = stringToLowerCase(element.tagName);
      var parentTagName = stringToLowerCase(parent.tagName);
      if (!ALLOWED_NAMESPACES[element.namespaceURI]) {
        return false;
      }
      if (element.namespaceURI === SVG_NAMESPACE) {
        if (parent.namespaceURI === HTML_NAMESPACE) {
          return tagName === "svg";
        }
        if (parent.namespaceURI === MATHML_NAMESPACE) {
          return tagName === "svg" && (parentTagName === "annotation-xml" || MATHML_TEXT_INTEGRATION_POINTS[parentTagName]);
        }
        return Boolean(ALL_SVG_TAGS[tagName]);
      }
      if (element.namespaceURI === MATHML_NAMESPACE) {
        if (parent.namespaceURI === HTML_NAMESPACE) {
          return tagName === "math";
        }
        if (parent.namespaceURI === SVG_NAMESPACE) {
          return tagName === "math" && HTML_INTEGRATION_POINTS[parentTagName];
        }
        return Boolean(ALL_MATHML_TAGS[tagName]);
      }
      if (element.namespaceURI === HTML_NAMESPACE) {
        if (parent.namespaceURI === SVG_NAMESPACE && !HTML_INTEGRATION_POINTS[parentTagName]) {
          return false;
        }
        if (parent.namespaceURI === MATHML_NAMESPACE && !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]) {
          return false;
        }
        return !ALL_MATHML_TAGS[tagName] && (COMMON_SVG_AND_HTML_ELEMENTS[tagName] || !ALL_SVG_TAGS[tagName]);
      }
      if (PARSER_MEDIA_TYPE === "application/xhtml+xml" && ALLOWED_NAMESPACES[element.namespaceURI]) {
        return true;
      }
      return false;
    };
    var _forceRemove = function _forceRemove2(node) {
      arrayPush(DOMPurify.removed, {
        element: node
      });
      try {
        node.parentNode.removeChild(node);
      } catch (_) {
        try {
          node.outerHTML = emptyHTML;
        } catch (_2) {
          node.remove();
        }
      }
    };
    var _removeAttribute = function _removeAttribute2(name, node) {
      try {
        arrayPush(DOMPurify.removed, {
          attribute: node.getAttributeNode(name),
          from: node
        });
      } catch (_) {
        arrayPush(DOMPurify.removed, {
          attribute: null,
          from: node
        });
      }
      node.removeAttribute(name);
      if (name === "is" && !ALLOWED_ATTR[name]) {
        if (RETURN_DOM || RETURN_DOM_FRAGMENT) {
          try {
            _forceRemove(node);
          } catch (_) {
          }
        } else {
          try {
            node.setAttribute(name, "");
          } catch (_) {
          }
        }
      }
    };
    var _initDocument = function _initDocument2(dirty) {
      var doc;
      var leadingWhitespace;
      if (FORCE_BODY) {
        dirty = "<remove></remove>" + dirty;
      } else {
        var matches2 = stringMatch(dirty, /^[\r\n\t ]+/);
        leadingWhitespace = matches2 && matches2[0];
      }
      if (PARSER_MEDIA_TYPE === "application/xhtml+xml" && NAMESPACE === HTML_NAMESPACE) {
        dirty = '<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>' + dirty + "</body></html>";
      }
      var dirtyPayload = trustedTypesPolicy ? trustedTypesPolicy.createHTML(dirty) : dirty;
      if (NAMESPACE === HTML_NAMESPACE) {
        try {
          doc = new DOMParser2().parseFromString(dirtyPayload, PARSER_MEDIA_TYPE);
        } catch (_) {
        }
      }
      if (!doc || !doc.documentElement) {
        doc = implementation.createDocument(NAMESPACE, "template", null);
        try {
          doc.documentElement.innerHTML = IS_EMPTY_INPUT ? emptyHTML : dirtyPayload;
        } catch (_) {
        }
      }
      var body = doc.body || doc.documentElement;
      if (dirty && leadingWhitespace) {
        body.insertBefore(document2.createTextNode(leadingWhitespace), body.childNodes[0] || null);
      }
      if (NAMESPACE === HTML_NAMESPACE) {
        return getElementsByTagName.call(doc, WHOLE_DOCUMENT ? "html" : "body")[0];
      }
      return WHOLE_DOCUMENT ? doc.documentElement : body;
    };
    var _createIterator = function _createIterator2(root) {
      return createNodeIterator.call(
        root.ownerDocument || root,
        root,
        NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_COMMENT | NodeFilter.SHOW_TEXT,
        null,
        false
      );
    };
    var _isClobbered = function _isClobbered2(elm) {
      return elm instanceof HTMLFormElement && (typeof elm.nodeName !== "string" || typeof elm.textContent !== "string" || typeof elm.removeChild !== "function" || !(elm.attributes instanceof NamedNodeMap) || typeof elm.removeAttribute !== "function" || typeof elm.setAttribute !== "function" || typeof elm.namespaceURI !== "string" || typeof elm.insertBefore !== "function" || typeof elm.hasChildNodes !== "function");
    };
    var _isNode = function _isNode2(object) {
      return _typeof$5(Node2) === "object" ? object instanceof Node2 : object && _typeof$5(object) === "object" && typeof object.nodeType === "number" && typeof object.nodeName === "string";
    };
    var _executeHook = function _executeHook2(entryPoint, currentNode, data) {
      if (!hooks[entryPoint]) {
        return;
      }
      arrayForEach(hooks[entryPoint], function(hook) {
        hook.call(DOMPurify, currentNode, data, CONFIG);
      });
    };
    var _sanitizeElements = function _sanitizeElements2(currentNode) {
      var content;
      _executeHook("beforeSanitizeElements", currentNode, null);
      if (_isClobbered(currentNode)) {
        _forceRemove(currentNode);
        return true;
      }
      if (regExpTest(/[\u0080-\uFFFF]/, currentNode.nodeName)) {
        _forceRemove(currentNode);
        return true;
      }
      var tagName = transformCaseFunc(currentNode.nodeName);
      _executeHook("uponSanitizeElement", currentNode, {
        tagName,
        allowedTags: ALLOWED_TAGS
      });
      if (currentNode.hasChildNodes() && !_isNode(currentNode.firstElementChild) && (!_isNode(currentNode.content) || !_isNode(currentNode.content.firstElementChild)) && regExpTest(/<[/\w]/g, currentNode.innerHTML) && regExpTest(/<[/\w]/g, currentNode.textContent)) {
        _forceRemove(currentNode);
        return true;
      }
      if (tagName === "select" && regExpTest(/<template/i, currentNode.innerHTML)) {
        _forceRemove(currentNode);
        return true;
      }
      if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {
        if (!FORBID_TAGS[tagName] && _basicCustomElementTest(tagName)) {
          if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, tagName))
            return false;
          if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName))
            return false;
        }
        if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {
          var parentNode = getParentNode(currentNode) || currentNode.parentNode;
          var childNodes = getChildNodes(currentNode) || currentNode.childNodes;
          if (childNodes && parentNode) {
            var childCount = childNodes.length;
            for (var i = childCount - 1; i >= 0; --i) {
              parentNode.insertBefore(cloneNode(childNodes[i], true), getNextSibling(currentNode));
            }
          }
        }
        _forceRemove(currentNode);
        return true;
      }
      if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {
        _forceRemove(currentNode);
        return true;
      }
      if ((tagName === "noscript" || tagName === "noembed") && regExpTest(/<\/no(script|embed)/i, currentNode.innerHTML)) {
        _forceRemove(currentNode);
        return true;
      }
      if (SAFE_FOR_TEMPLATES && currentNode.nodeType === 3) {
        content = currentNode.textContent;
        content = stringReplace(content, MUSTACHE_EXPR$1, " ");
        content = stringReplace(content, ERB_EXPR$1, " ");
        content = stringReplace(content, TMPLIT_EXPR$1, " ");
        if (currentNode.textContent !== content) {
          arrayPush(DOMPurify.removed, {
            element: currentNode.cloneNode()
          });
          currentNode.textContent = content;
        }
      }
      _executeHook("afterSanitizeElements", currentNode, null);
      return false;
    };
    var _isValidAttribute = function _isValidAttribute2(lcTag, lcName, value) {
      if (SANITIZE_DOM && (lcName === "id" || lcName === "name") && (value in document2 || value in formElement)) {
        return false;
      }
      if (ALLOW_DATA_ATTR && !FORBID_ATTR[lcName] && regExpTest(DATA_ATTR$1, lcName))
        ;
      else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR$1, lcName))
        ;
      else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {
        if (_basicCustomElementTest(lcTag) && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, lcTag) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag)) && (CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck, lcName) || CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName)) || lcName === "is" && CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, value) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(value)))
          ;
        else {
          return false;
        }
      } else if (URI_SAFE_ATTRIBUTES[lcName])
        ;
      else if (regExpTest(IS_ALLOWED_URI$1, stringReplace(value, ATTR_WHITESPACE$1, "")))
        ;
      else if ((lcName === "src" || lcName === "xlink:href" || lcName === "href") && lcTag !== "script" && stringIndexOf(value, "data:") === 0 && DATA_URI_TAGS[lcTag])
        ;
      else if (ALLOW_UNKNOWN_PROTOCOLS && !regExpTest(IS_SCRIPT_OR_DATA$1, stringReplace(value, ATTR_WHITESPACE$1, "")))
        ;
      else if (!value)
        ;
      else {
        return false;
      }
      return true;
    };
    var _basicCustomElementTest = function _basicCustomElementTest2(tagName) {
      return tagName.indexOf("-") > 0;
    };
    var _sanitizeAttributes = function _sanitizeAttributes2(currentNode) {
      var attr;
      var value;
      var lcName;
      var l;
      _executeHook("beforeSanitizeAttributes", currentNode, null);
      var attributes = currentNode.attributes;
      if (!attributes) {
        return;
      }
      var hookEvent = {
        attrName: "",
        attrValue: "",
        keepAttr: true,
        allowedAttributes: ALLOWED_ATTR
      };
      l = attributes.length;
      while (l--) {
        attr = attributes[l];
        var _attr = attr, name = _attr.name, namespaceURI = _attr.namespaceURI;
        value = name === "value" ? attr.value : stringTrim(attr.value);
        lcName = transformCaseFunc(name);
        hookEvent.attrName = lcName;
        hookEvent.attrValue = value;
        hookEvent.keepAttr = true;
        hookEvent.forceKeepAttr = void 0;
        _executeHook("uponSanitizeAttribute", currentNode, hookEvent);
        value = hookEvent.attrValue;
        if (hookEvent.forceKeepAttr) {
          continue;
        }
        _removeAttribute(name, currentNode);
        if (!hookEvent.keepAttr) {
          continue;
        }
        if (!ALLOW_SELF_CLOSE_IN_ATTR && regExpTest(/\/>/i, value)) {
          _removeAttribute(name, currentNode);
          continue;
        }
        if (SAFE_FOR_TEMPLATES) {
          value = stringReplace(value, MUSTACHE_EXPR$1, " ");
          value = stringReplace(value, ERB_EXPR$1, " ");
          value = stringReplace(value, TMPLIT_EXPR$1, " ");
        }
        var lcTag = transformCaseFunc(currentNode.nodeName);
        if (!_isValidAttribute(lcTag, lcName, value)) {
          continue;
        }
        if (SANITIZE_NAMED_PROPS && (lcName === "id" || lcName === "name")) {
          _removeAttribute(name, currentNode);
          value = SANITIZE_NAMED_PROPS_PREFIX + value;
        }
        if (trustedTypesPolicy && _typeof$5(trustedTypes) === "object" && typeof trustedTypes.getAttributeType === "function") {
          if (namespaceURI)
            ;
          else {
            switch (trustedTypes.getAttributeType(lcTag, lcName)) {
              case "TrustedHTML":
                value = trustedTypesPolicy.createHTML(value);
                break;
              case "TrustedScriptURL":
                value = trustedTypesPolicy.createScriptURL(value);
                break;
            }
          }
        }
        try {
          if (namespaceURI) {
            currentNode.setAttributeNS(namespaceURI, name, value);
          } else {
            currentNode.setAttribute(name, value);
          }
          arrayPop(DOMPurify.removed);
        } catch (_) {
        }
      }
      _executeHook("afterSanitizeAttributes", currentNode, null);
    };
    var _sanitizeShadowDOM = function _sanitizeShadowDOM2(fragment) {
      var shadowNode;
      var shadowIterator = _createIterator(fragment);
      _executeHook("beforeSanitizeShadowDOM", fragment, null);
      while (shadowNode = shadowIterator.nextNode()) {
        _executeHook("uponSanitizeShadowNode", shadowNode, null);
        if (_sanitizeElements(shadowNode)) {
          continue;
        }
        if (shadowNode.content instanceof DocumentFragment) {
          _sanitizeShadowDOM2(shadowNode.content);
        }
        _sanitizeAttributes(shadowNode);
      }
      _executeHook("afterSanitizeShadowDOM", fragment, null);
    };
    DOMPurify.sanitize = function(dirty) {
      var cfg = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
      var body;
      var importedNode;
      var currentNode;
      var oldNode;
      var returnNode;
      IS_EMPTY_INPUT = !dirty;
      if (IS_EMPTY_INPUT) {
        dirty = "<!-->";
      }
      if (typeof dirty !== "string" && !_isNode(dirty)) {
        if (typeof dirty.toString !== "function") {
          throw typeErrorCreate("toString is not a function");
        } else {
          dirty = dirty.toString();
          if (typeof dirty !== "string") {
            throw typeErrorCreate("dirty is not a string, aborting");
          }
        }
      }
      if (!DOMPurify.isSupported) {
        if (_typeof$5(window2.toStaticHTML) === "object" || typeof window2.toStaticHTML === "function") {
          if (typeof dirty === "string") {
            return window2.toStaticHTML(dirty);
          }
          if (_isNode(dirty)) {
            return window2.toStaticHTML(dirty.outerHTML);
          }
        }
        return dirty;
      }
      if (!SET_CONFIG) {
        _parseConfig(cfg);
      }
      DOMPurify.removed = [];
      if (typeof dirty === "string") {
        IN_PLACE = false;
      }
      if (IN_PLACE) {
        if (dirty.nodeName) {
          var tagName = transformCaseFunc(dirty.nodeName);
          if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {
            throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place");
          }
        }
      } else if (dirty instanceof Node2) {
        body = _initDocument("<!---->");
        importedNode = body.ownerDocument.importNode(dirty, true);
        if (importedNode.nodeType === 1 && importedNode.nodeName === "BODY") {
          body = importedNode;
        } else if (importedNode.nodeName === "HTML") {
          body = importedNode;
        } else {
          body.appendChild(importedNode);
        }
      } else {
        if (!RETURN_DOM && !SAFE_FOR_TEMPLATES && !WHOLE_DOCUMENT && dirty.indexOf("<") === -1) {
          return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(dirty) : dirty;
        }
        body = _initDocument(dirty);
        if (!body) {
          return RETURN_DOM ? null : RETURN_TRUSTED_TYPE ? emptyHTML : "";
        }
      }
      if (body && FORCE_BODY) {
        _forceRemove(body.firstChild);
      }
      var nodeIterator = _createIterator(IN_PLACE ? dirty : body);
      while (currentNode = nodeIterator.nextNode()) {
        if (currentNode.nodeType === 3 && currentNode === oldNode) {
          continue;
        }
        if (_sanitizeElements(currentNode)) {
          continue;
        }
        if (currentNode.content instanceof DocumentFragment) {
          _sanitizeShadowDOM(currentNode.content);
        }
        _sanitizeAttributes(currentNode);
        oldNode = currentNode;
      }
      oldNode = null;
      if (IN_PLACE) {
        return dirty;
      }
      if (RETURN_DOM) {
        if (RETURN_DOM_FRAGMENT) {
          returnNode = createDocumentFragment.call(body.ownerDocument);
          while (body.firstChild) {
            returnNode.appendChild(body.firstChild);
          }
        } else {
          returnNode = body;
        }
        if (ALLOWED_ATTR.shadowroot || ALLOWED_ATTR.shadowrootmod) {
          returnNode = importNode.call(originalDocument, returnNode, true);
        }
        return returnNode;
      }
      var serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;
      if (WHOLE_DOCUMENT && ALLOWED_TAGS["!doctype"] && body.ownerDocument && body.ownerDocument.doctype && body.ownerDocument.doctype.name && regExpTest(DOCTYPE_NAME, body.ownerDocument.doctype.name)) {
        serializedHTML = "<!DOCTYPE " + body.ownerDocument.doctype.name + ">\n" + serializedHTML;
      }
      if (SAFE_FOR_TEMPLATES) {
        serializedHTML = stringReplace(serializedHTML, MUSTACHE_EXPR$1, " ");
        serializedHTML = stringReplace(serializedHTML, ERB_EXPR$1, " ");
        serializedHTML = stringReplace(serializedHTML, TMPLIT_EXPR$1, " ");
      }
      return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(serializedHTML) : serializedHTML;
    };
    DOMPurify.setConfig = function(cfg) {
      _parseConfig(cfg);
      SET_CONFIG = true;
    };
    DOMPurify.clearConfig = function() {
      CONFIG = null;
      SET_CONFIG = false;
    };
    DOMPurify.isValidAttribute = function(tag, attr, value) {
      if (!CONFIG) {
        _parseConfig({});
      }
      var lcTag = transformCaseFunc(tag);
      var lcName = transformCaseFunc(attr);
      return _isValidAttribute(lcTag, lcName, value);
    };
    DOMPurify.addHook = function(entryPoint, hookFunction) {
      if (typeof hookFunction !== "function") {
        return;
      }
      hooks[entryPoint] = hooks[entryPoint] || [];
      arrayPush(hooks[entryPoint], hookFunction);
    };
    DOMPurify.removeHook = function(entryPoint) {
      if (hooks[entryPoint]) {
        return arrayPop(hooks[entryPoint]);
      }
    };
    DOMPurify.removeHooks = function(entryPoint) {
      if (hooks[entryPoint]) {
        hooks[entryPoint] = [];
      }
    };
    DOMPurify.removeAllHooks = function() {
      hooks = {};
    };
    return DOMPurify;
  }
  var purify = createDOMPurify();
  var isVue2 = false;
  function set(target, key, val) {
    if (Array.isArray(target)) {
      target.length = Math.max(target.length, key);
      target.splice(key, 1, val);
      return val;
    }
    target[key] = val;
    return val;
  }
  function del(target, key) {
    if (Array.isArray(target)) {
      target.splice(key, 1);
      return;
    }
    delete target[key];
  }
  function p(o, i) {
    var _a;
    const n = (_a = o.hooks) != null ? _a : {};
    let t;
    for (t in n) {
      const e = n[t];
      e !== void 0 && i.addHook(t, e);
    }
  }
  function c() {
    return purify();
  }
  function v(o = {}, i = c) {
    const n = i();
    p(o, n);
    const t = function(e, r) {
      var _a, _b;
      const u = r.value;
      if (r.oldValue === u)
        return;
      const a = `${u}`, s = r.arg, d = o.namedConfigurations, f = (_a = o.default) != null ? _a : {};
      if (d && s !== void 0) {
        e.innerHTML = n.sanitize(
          a,
          (_b = d[s]) != null ? _b : f
        );
        return;
      }
      e.innerHTML = n.sanitize(
        a,
        f
      );
    };
    return {
      mounted: t,
      updated: t
    };
  }
  const y = {
    install(o, i = {}, n = c) {
      o.directive(
        "dompurify-html",
        v(i, n)
      );
    }
  };
  function getDevtoolsGlobalHook() {
    return getTarget().__VUE_DEVTOOLS_GLOBAL_HOOK__;
  }
  function getTarget() {
    return typeof navigator !== "undefined" && typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {};
  }
  const isProxyAvailable = typeof Proxy === "function";
  const HOOK_SETUP = "devtools-plugin:setup";
  const HOOK_PLUGIN_SETTINGS_SET = "plugin:settings:set";
  let supported;
  let perf;
  function isPerformanceSupported() {
    var _a;
    if (supported !== void 0) {
      return supported;
    }
    if (typeof window !== "undefined" && window.performance) {
      supported = true;
      perf = window.performance;
    } else if (typeof global !== "undefined" && ((_a = global.perf_hooks) === null || _a === void 0 ? void 0 : _a.performance)) {
      supported = true;
      perf = global.perf_hooks.performance;
    } else {
      supported = false;
    }
    return supported;
  }
  function now() {
    return isPerformanceSupported() ? perf.now() : Date.now();
  }
  class ApiProxy {
    constructor(plugin, hook) {
      this.target = null;
      this.targetQueue = [];
      this.onQueue = [];
      this.plugin = plugin;
      this.hook = hook;
      const defaultSettings = {};
      if (plugin.settings) {
        for (const id in plugin.settings) {
          const item = plugin.settings[id];
          defaultSettings[id] = item.defaultValue;
        }
      }
      const localSettingsSaveId = `__vue-devtools-plugin-settings__${plugin.id}`;
      let currentSettings = Object.assign({}, defaultSettings);
      try {
        const raw = localStorage.getItem(localSettingsSaveId);
        const data = JSON.parse(raw);
        Object.assign(currentSettings, data);
      } catch (e) {
      }
      this.fallbacks = {
        getSettings() {
          return currentSettings;
        },
        setSettings(value) {
          try {
            localStorage.setItem(localSettingsSaveId, JSON.stringify(value));
          } catch (e) {
          }
          currentSettings = value;
        },
        now() {
          return now();
        }
      };
      if (hook) {
        hook.on(HOOK_PLUGIN_SETTINGS_SET, (pluginId, value) => {
          if (pluginId === this.plugin.id) {
            this.fallbacks.setSettings(value);
          }
        });
      }
      this.proxiedOn = new Proxy({}, {
        get: (_target, prop) => {
          if (this.target) {
            return this.target.on[prop];
          } else {
            return (...args) => {
              this.onQueue.push({
                method: prop,
                args
              });
            };
          }
        }
      });
      this.proxiedTarget = new Proxy({}, {
        get: (_target, prop) => {
          if (this.target) {
            return this.target[prop];
          } else if (prop === "on") {
            return this.proxiedOn;
          } else if (Object.keys(this.fallbacks).includes(prop)) {
            return (...args) => {
              this.targetQueue.push({
                method: prop,
                args,
                resolve: () => {
                }
              });
              return this.fallbacks[prop](...args);
            };
          } else {
            return (...args) => {
              return new Promise((resolve) => {
                this.targetQueue.push({
                  method: prop,
                  args,
                  resolve
                });
              });
            };
          }
        }
      });
    }
    async setRealTarget(target) {
      this.target = target;
      for (const item of this.onQueue) {
        this.target.on[item.method](...item.args);
      }
      for (const item of this.targetQueue) {
        item.resolve(await this.target[item.method](...item.args));
      }
    }
  }
  function setupDevtoolsPlugin(pluginDescriptor, setupFn) {
    const descriptor = pluginDescriptor;
    const target = getTarget();
    const hook = getDevtoolsGlobalHook();
    const enableProxy = isProxyAvailable && descriptor.enableEarlyProxy;
    if (hook && (target.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__ || !enableProxy)) {
      hook.emit(HOOK_SETUP, pluginDescriptor, setupFn);
    } else {
      const proxy = enableProxy ? new ApiProxy(descriptor, hook) : null;
      const list = target.__VUE_DEVTOOLS_PLUGINS__ = target.__VUE_DEVTOOLS_PLUGINS__ || [];
      list.push({
        pluginDescriptor: descriptor,
        setupFn,
        proxy
      });
      if (proxy)
        setupFn(proxy.proxiedTarget);
    }
  }
  /*!
    * pinia v2.0.33
    * (c) 2023 Eduardo San Martin Morote
    * @license MIT
    */
  let activePinia;
  const setActivePinia = (pinia) => activePinia = pinia;
  const piniaSymbol = process.env.NODE_ENV !== "production" ? Symbol("pinia") : Symbol();
  function isPlainObject(o) {
    return o && typeof o === "object" && Object.prototype.toString.call(o) === "[object Object]" && typeof o.toJSON !== "function";
  }
  var MutationType;
  (function(MutationType2) {
    MutationType2["direct"] = "direct";
    MutationType2["patchObject"] = "patch object";
    MutationType2["patchFunction"] = "patch function";
  })(MutationType || (MutationType = {}));
  const IS_CLIENT = typeof window !== "undefined";
  const USE_DEVTOOLS = (process.env.NODE_ENV !== "production" || false) && !(process.env.NODE_ENV === "test") && IS_CLIENT;
  const _global = /* @__PURE__ */ (() => typeof window === "object" && window.window === window ? window : typeof self === "object" && self.self === self ? self : typeof global === "object" && global.global === global ? global : typeof globalThis === "object" ? globalThis : { HTMLElement: null })();
  function bom(blob, { autoBom = false } = {}) {
    if (autoBom && /^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)) {
      return new Blob([String.fromCharCode(65279), blob], { type: blob.type });
    }
    return blob;
  }
  function download(url, name, opts) {
    const xhr = new XMLHttpRequest();
    xhr.open("GET", url);
    xhr.responseType = "blob";
    xhr.onload = function() {
      saveAs(xhr.response, name, opts);
    };
    xhr.onerror = function() {
      console.error("could not download file");
    };
    xhr.send();
  }
  function corsEnabled(url) {
    const xhr = new XMLHttpRequest();
    xhr.open("HEAD", url, false);
    try {
      xhr.send();
    } catch (e) {
    }
    return xhr.status >= 200 && xhr.status <= 299;
  }
  function click(node) {
    try {
      node.dispatchEvent(new MouseEvent("click"));
    } catch (e) {
      const evt = document.createEvent("MouseEvents");
      evt.initMouseEvent("click", true, true, window, 0, 0, 0, 80, 20, false, false, false, false, 0, null);
      node.dispatchEvent(evt);
    }
  }
  const _navigator = typeof navigator === "object" ? navigator : { userAgent: "" };
  const isMacOSWebView = /* @__PURE__ */ (() => /Macintosh/.test(_navigator.userAgent) && /AppleWebKit/.test(_navigator.userAgent) && !/Safari/.test(_navigator.userAgent))();
  const saveAs = !IS_CLIENT ? () => {
  } : typeof HTMLAnchorElement !== "undefined" && "download" in HTMLAnchorElement.prototype && !isMacOSWebView ? downloadSaveAs : "msSaveOrOpenBlob" in _navigator ? msSaveAs : fileSaverSaveAs;
  function downloadSaveAs(blob, name = "download", opts) {
    const a = document.createElement("a");
    a.download = name;
    a.rel = "noopener";
    if (typeof blob === "string") {
      a.href = blob;
      if (a.origin !== location.origin) {
        if (corsEnabled(a.href)) {
          download(blob, name, opts);
        } else {
          a.target = "_blank";
          click(a);
        }
      } else {
        click(a);
      }
    } else {
      a.href = URL.createObjectURL(blob);
      setTimeout(function() {
        URL.revokeObjectURL(a.href);
      }, 4e4);
      setTimeout(function() {
        click(a);
      }, 0);
    }
  }
  function msSaveAs(blob, name = "download", opts) {
    if (typeof blob === "string") {
      if (corsEnabled(blob)) {
        download(blob, name, opts);
      } else {
        const a = document.createElement("a");
        a.href = blob;
        a.target = "_blank";
        setTimeout(function() {
          click(a);
        });
      }
    } else {
      navigator.msSaveOrOpenBlob(bom(blob, opts), name);
    }
  }
  function fileSaverSaveAs(blob, name, opts, popup) {
    popup = popup || open("", "_blank");
    if (popup) {
      popup.document.title = popup.document.body.innerText = "downloading...";
    }
    if (typeof blob === "string")
      return download(blob, name, opts);
    const force = blob.type === "application/octet-stream";
    const isSafari = /constructor/i.test(String(_global.HTMLElement)) || "safari" in _global;
    const isChromeIOS = /CriOS\/[\d]+/.test(navigator.userAgent);
    if ((isChromeIOS || force && isSafari || isMacOSWebView) && typeof FileReader !== "undefined") {
      const reader = new FileReader();
      reader.onloadend = function() {
        let url = reader.result;
        if (typeof url !== "string") {
          popup = null;
          throw new Error("Wrong reader.result type");
        }
        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, "data:attachment/file;");
        if (popup) {
          popup.location.href = url;
        } else {
          location.assign(url);
        }
        popup = null;
      };
      reader.readAsDataURL(blob);
    } else {
      const url = URL.createObjectURL(blob);
      if (popup)
        popup.location.assign(url);
      else
        location.href = url;
      popup = null;
      setTimeout(function() {
        URL.revokeObjectURL(url);
      }, 4e4);
    }
  }
  function toastMessage(message, type) {
    const piniaMessage = "\u{1F34D} " + message;
    if (typeof __VUE_DEVTOOLS_TOAST__ === "function") {
      __VUE_DEVTOOLS_TOAST__(piniaMessage, type);
    } else if (type === "error") {
      console.error(piniaMessage);
    } else if (type === "warn") {
      console.warn(piniaMessage);
    } else {
      console.log(piniaMessage);
    }
  }
  function isPinia(o) {
    return "_a" in o && "install" in o;
  }
  function checkClipboardAccess() {
    if (!("clipboard" in navigator)) {
      toastMessage(`Your browser doesn't support the Clipboard API`, "error");
      return true;
    }
  }
  function checkNotFocusedError(error) {
    if (error instanceof Error && error.message.toLowerCase().includes("document is not focused")) {
      toastMessage('You need to activate the "Emulate a focused page" setting in the "Rendering" panel of devtools.', "warn");
      return true;
    }
    return false;
  }
  async function actionGlobalCopyState(pinia) {
    if (checkClipboardAccess())
      return;
    try {
      await navigator.clipboard.writeText(JSON.stringify(pinia.state.value));
      toastMessage("Global state copied to clipboard.");
    } catch (error) {
      if (checkNotFocusedError(error))
        return;
      toastMessage(`Failed to serialize the state. Check the console for more details.`, "error");
      console.error(error);
    }
  }
  async function actionGlobalPasteState(pinia) {
    if (checkClipboardAccess())
      return;
    try {
      pinia.state.value = JSON.parse(await navigator.clipboard.readText());
      toastMessage("Global state pasted from clipboard.");
    } catch (error) {
      if (checkNotFocusedError(error))
        return;
      toastMessage(`Failed to deserialize the state from clipboard. Check the console for more details.`, "error");
      console.error(error);
    }
  }
  async function actionGlobalSaveState(pinia) {
    try {
      saveAs(new Blob([JSON.stringify(pinia.state.value)], {
        type: "text/plain;charset=utf-8"
      }), "pinia-state.json");
    } catch (error) {
      toastMessage(`Failed to export the state as JSON. Check the console for more details.`, "error");
      console.error(error);
    }
  }
  let fileInput;
  function getFileOpener() {
    if (!fileInput) {
      fileInput = document.createElement("input");
      fileInput.type = "file";
      fileInput.accept = ".json";
    }
    function openFile() {
      return new Promise((resolve, reject) => {
        fileInput.onchange = async () => {
          const files = fileInput.files;
          if (!files)
            return resolve(null);
          const file = files.item(0);
          if (!file)
            return resolve(null);
          return resolve({ text: await file.text(), file });
        };
        fileInput.oncancel = () => resolve(null);
        fileInput.onerror = reject;
        fileInput.click();
      });
    }
    return openFile;
  }
  async function actionGlobalOpenStateFile(pinia) {
    try {
      const open2 = await getFileOpener();
      const result = await open2();
      if (!result)
        return;
      const { text: text2, file } = result;
      pinia.state.value = JSON.parse(text2);
      toastMessage(`Global state imported from "${file.name}".`);
    } catch (error) {
      toastMessage(`Failed to export the state as JSON. Check the console for more details.`, "error");
      console.error(error);
    }
  }
  function formatDisplay(display) {
    return {
      _custom: {
        display
      }
    };
  }
  const PINIA_ROOT_LABEL = "\u{1F34D} Pinia (root)";
  const PINIA_ROOT_ID = "_root";
  function formatStoreForInspectorTree(store) {
    return isPinia(store) ? {
      id: PINIA_ROOT_ID,
      label: PINIA_ROOT_LABEL
    } : {
      id: store.$id,
      label: store.$id
    };
  }
  function formatStoreForInspectorState(store) {
    if (isPinia(store)) {
      const storeNames = Array.from(store._s.keys());
      const storeMap = store._s;
      const state2 = {
        state: storeNames.map((storeId) => ({
          editable: true,
          key: storeId,
          value: store.state.value[storeId]
        })),
        getters: storeNames.filter((id) => storeMap.get(id)._getters).map((id) => {
          const store2 = storeMap.get(id);
          return {
            editable: false,
            key: id,
            value: store2._getters.reduce((getters, key) => {
              getters[key] = store2[key];
              return getters;
            }, {})
          };
        })
      };
      return state2;
    }
    const state = {
      state: Object.keys(store.$state).map((key) => ({
        editable: true,
        key,
        value: store.$state[key]
      }))
    };
    if (store._getters && store._getters.length) {
      state.getters = store._getters.map((getterName) => ({
        editable: false,
        key: getterName,
        value: store[getterName]
      }));
    }
    if (store._customProperties.size) {
      state.customProperties = Array.from(store._customProperties).map((key) => ({
        editable: true,
        key,
        value: store[key]
      }));
    }
    return state;
  }
  function formatEventData(events) {
    if (!events)
      return {};
    if (Array.isArray(events)) {
      return events.reduce((data, event) => {
        data.keys.push(event.key);
        data.operations.push(event.type);
        data.oldValue[event.key] = event.oldValue;
        data.newValue[event.key] = event.newValue;
        return data;
      }, {
        oldValue: {},
        keys: [],
        operations: [],
        newValue: {}
      });
    } else {
      return {
        operation: formatDisplay(events.type),
        key: formatDisplay(events.key),
        oldValue: events.oldValue,
        newValue: events.newValue
      };
    }
  }
  function formatMutationType(type) {
    switch (type) {
      case MutationType.direct:
        return "mutation";
      case MutationType.patchFunction:
        return "$patch";
      case MutationType.patchObject:
        return "$patch";
      default:
        return "unknown";
    }
  }
  let isTimelineActive = true;
  const componentStateTypes = [];
  const MUTATIONS_LAYER_ID = "pinia:mutations";
  const INSPECTOR_ID = "pinia";
  const { assign: assign$1 } = Object;
  const getStoreType = (id) => "\u{1F34D} " + id;
  function registerPiniaDevtools(app2, pinia) {
    setupDevtoolsPlugin({
      id: "dev.esm.pinia",
      label: "Pinia \u{1F34D}",
      logo: "https://pinia.vuejs.org/logo.svg",
      packageName: "pinia",
      homepage: "https://pinia.vuejs.org",
      componentStateTypes,
      app: app2
    }, (api) => {
      if (typeof api.now !== "function") {
        toastMessage("You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html.");
      }
      api.addTimelineLayer({
        id: MUTATIONS_LAYER_ID,
        label: `Pinia \u{1F34D}`,
        color: 15064968
      });
      api.addInspector({
        id: INSPECTOR_ID,
        label: "Pinia \u{1F34D}",
        icon: "storage",
        treeFilterPlaceholder: "Search stores",
        actions: [
          {
            icon: "content_copy",
            action: () => {
              actionGlobalCopyState(pinia);
            },
            tooltip: "Serialize and copy the state"
          },
          {
            icon: "content_paste",
            action: async () => {
              await actionGlobalPasteState(pinia);
              api.sendInspectorTree(INSPECTOR_ID);
              api.sendInspectorState(INSPECTOR_ID);
            },
            tooltip: "Replace the state with the content of your clipboard"
          },
          {
            icon: "save",
            action: () => {
              actionGlobalSaveState(pinia);
            },
            tooltip: "Save the state as a JSON file"
          },
          {
            icon: "folder_open",
            action: async () => {
              await actionGlobalOpenStateFile(pinia);
              api.sendInspectorTree(INSPECTOR_ID);
              api.sendInspectorState(INSPECTOR_ID);
            },
            tooltip: "Import the state from a JSON file"
          }
        ],
        nodeActions: [
          {
            icon: "restore",
            tooltip: "Reset the state (option store only)",
            action: (nodeId) => {
              const store = pinia._s.get(nodeId);
              if (!store) {
                toastMessage(`Cannot reset "${nodeId}" store because it wasn't found.`, "warn");
              } else if (!store._isOptionsAPI) {
                toastMessage(`Cannot reset "${nodeId}" store because it's a setup store.`, "warn");
              } else {
                store.$reset();
                toastMessage(`Store "${nodeId}" reset.`);
              }
            }
          }
        ]
      });
      api.on.inspectComponent((payload, ctx) => {
        const proxy = payload.componentInstance && payload.componentInstance.proxy;
        if (proxy && proxy._pStores) {
          const piniaStores = payload.componentInstance.proxy._pStores;
          Object.values(piniaStores).forEach((store) => {
            payload.instanceData.state.push({
              type: getStoreType(store.$id),
              key: "state",
              editable: true,
              value: store._isOptionsAPI ? {
                _custom: {
                  value: vue.toRaw(store.$state),
                  actions: [
                    {
                      icon: "restore",
                      tooltip: "Reset the state of this store",
                      action: () => store.$reset()
                    }
                  ]
                }
              } : Object.keys(store.$state).reduce((state, key) => {
                state[key] = store.$state[key];
                return state;
              }, {})
            });
            if (store._getters && store._getters.length) {
              payload.instanceData.state.push({
                type: getStoreType(store.$id),
                key: "getters",
                editable: false,
                value: store._getters.reduce((getters, key) => {
                  try {
                    getters[key] = store[key];
                  } catch (error) {
                    getters[key] = error;
                  }
                  return getters;
                }, {})
              });
            }
          });
        }
      });
      api.on.getInspectorTree((payload) => {
        if (payload.app === app2 && payload.inspectorId === INSPECTOR_ID) {
          let stores = [pinia];
          stores = stores.concat(Array.from(pinia._s.values()));
          payload.rootNodes = (payload.filter ? stores.filter((store) => "$id" in store ? store.$id.toLowerCase().includes(payload.filter.toLowerCase()) : PINIA_ROOT_LABEL.toLowerCase().includes(payload.filter.toLowerCase())) : stores).map(formatStoreForInspectorTree);
        }
      });
      api.on.getInspectorState((payload) => {
        if (payload.app === app2 && payload.inspectorId === INSPECTOR_ID) {
          const inspectedStore = payload.nodeId === PINIA_ROOT_ID ? pinia : pinia._s.get(payload.nodeId);
          if (!inspectedStore) {
            return;
          }
          if (inspectedStore) {
            payload.state = formatStoreForInspectorState(inspectedStore);
          }
        }
      });
      api.on.editInspectorState((payload, ctx) => {
        if (payload.app === app2 && payload.inspectorId === INSPECTOR_ID) {
          const inspectedStore = payload.nodeId === PINIA_ROOT_ID ? pinia : pinia._s.get(payload.nodeId);
          if (!inspectedStore) {
            return toastMessage(`store "${payload.nodeId}" not found`, "error");
          }
          const { path } = payload;
          if (!isPinia(inspectedStore)) {
            if (path.length !== 1 || !inspectedStore._customProperties.has(path[0]) || path[0] in inspectedStore.$state) {
              path.unshift("$state");
            }
          } else {
            path.unshift("state");
          }
          isTimelineActive = false;
          payload.set(inspectedStore, path, payload.state.value);
          isTimelineActive = true;
        }
      });
      api.on.editComponentState((payload) => {
        if (payload.type.startsWith("\u{1F34D}")) {
          const storeId = payload.type.replace(/^\s*/, "");
          const store = pinia._s.get(storeId);
          if (!store) {
            return toastMessage(`store "${storeId}" not found`, "error");
          }
          const { path } = payload;
          if (path[0] !== "state") {
            return toastMessage(`Invalid path for store "${storeId}":
${path}
Only state can be modified.`);
          }
          path[0] = "$state";
          isTimelineActive = false;
          payload.set(store, path, payload.state.value);
          isTimelineActive = true;
        }
      });
    });
  }
  function addStoreToDevtools(app2, store) {
    if (!componentStateTypes.includes(getStoreType(store.$id))) {
      componentStateTypes.push(getStoreType(store.$id));
    }
    setupDevtoolsPlugin({
      id: "dev.esm.pinia",
      label: "Pinia \u{1F34D}",
      logo: "https://pinia.vuejs.org/logo.svg",
      packageName: "pinia",
      homepage: "https://pinia.vuejs.org",
      componentStateTypes,
      app: app2,
      settings: {
        logStoreChanges: {
          label: "Notify about new/deleted stores",
          type: "boolean",
          defaultValue: true
        }
      }
    }, (api) => {
      const now2 = typeof api.now === "function" ? api.now.bind(api) : Date.now;
      store.$onAction(({ after, onError, name, args }) => {
        const groupId = runningActionId++;
        api.addTimelineEvent({
          layerId: MUTATIONS_LAYER_ID,
          event: {
            time: now2(),
            title: "\u{1F6EB} " + name,
            subtitle: "start",
            data: {
              store: formatDisplay(store.$id),
              action: formatDisplay(name),
              args
            },
            groupId
          }
        });
        after((result) => {
          activeAction = void 0;
          api.addTimelineEvent({
            layerId: MUTATIONS_LAYER_ID,
            event: {
              time: now2(),
              title: "\u{1F6EC} " + name,
              subtitle: "end",
              data: {
                store: formatDisplay(store.$id),
                action: formatDisplay(name),
                args,
                result
              },
              groupId
            }
          });
        });
        onError((error) => {
          activeAction = void 0;
          api.addTimelineEvent({
            layerId: MUTATIONS_LAYER_ID,
            event: {
              time: now2(),
              logType: "error",
              title: "\u{1F4A5} " + name,
              subtitle: "end",
              data: {
                store: formatDisplay(store.$id),
                action: formatDisplay(name),
                args,
                error
              },
              groupId
            }
          });
        });
      }, true);
      store._customProperties.forEach((name) => {
        vue.watch(() => vue.unref(store[name]), (newValue, oldValue) => {
          api.notifyComponentUpdate();
          api.sendInspectorState(INSPECTOR_ID);
          if (isTimelineActive) {
            api.addTimelineEvent({
              layerId: MUTATIONS_LAYER_ID,
              event: {
                time: now2(),
                title: "Change",
                subtitle: name,
                data: {
                  newValue,
                  oldValue
                },
                groupId: activeAction
              }
            });
          }
        }, { deep: true });
      });
      store.$subscribe(({ events, type }, state) => {
        api.notifyComponentUpdate();
        api.sendInspectorState(INSPECTOR_ID);
        if (!isTimelineActive)
          return;
        const eventData = {
          time: now2(),
          title: formatMutationType(type),
          data: assign$1({ store: formatDisplay(store.$id) }, formatEventData(events)),
          groupId: activeAction
        };
        activeAction = void 0;
        if (type === MutationType.patchFunction) {
          eventData.subtitle = "\u2935\uFE0F";
        } else if (type === MutationType.patchObject) {
          eventData.subtitle = "\u{1F9E9}";
        } else if (events && !Array.isArray(events)) {
          eventData.subtitle = events.type;
        }
        if (events) {
          eventData.data["rawEvent(s)"] = {
            _custom: {
              display: "DebuggerEvent",
              type: "object",
              tooltip: "raw DebuggerEvent[]",
              value: events
            }
          };
        }
        api.addTimelineEvent({
          layerId: MUTATIONS_LAYER_ID,
          event: eventData
        });
      }, { detached: true, flush: "sync" });
      const hotUpdate = store._hotUpdate;
      store._hotUpdate = vue.markRaw((newStore) => {
        hotUpdate(newStore);
        api.addTimelineEvent({
          layerId: MUTATIONS_LAYER_ID,
          event: {
            time: now2(),
            title: "\u{1F525} " + store.$id,
            subtitle: "HMR update",
            data: {
              store: formatDisplay(store.$id),
              info: formatDisplay(`HMR update`)
            }
          }
        });
        api.notifyComponentUpdate();
        api.sendInspectorTree(INSPECTOR_ID);
        api.sendInspectorState(INSPECTOR_ID);
      });
      const { $dispose } = store;
      store.$dispose = () => {
        $dispose();
        api.notifyComponentUpdate();
        api.sendInspectorTree(INSPECTOR_ID);
        api.sendInspectorState(INSPECTOR_ID);
        api.getSettings().logStoreChanges && toastMessage(`Disposed "${store.$id}" store \u{1F5D1}`);
      };
      api.notifyComponentUpdate();
      api.sendInspectorTree(INSPECTOR_ID);
      api.sendInspectorState(INSPECTOR_ID);
      api.getSettings().logStoreChanges && toastMessage(`"${store.$id}" store installed \u{1F195}`);
    });
  }
  let runningActionId = 0;
  let activeAction;
  function patchActionForGrouping(store, actionNames) {
    const actions = actionNames.reduce((storeActions, actionName) => {
      storeActions[actionName] = vue.toRaw(store)[actionName];
      return storeActions;
    }, {});
    for (const actionName in actions) {
      store[actionName] = function() {
        const _actionId = runningActionId;
        const trackedStore = new Proxy(store, {
          get(...args) {
            activeAction = _actionId;
            return Reflect.get(...args);
          },
          set(...args) {
            activeAction = _actionId;
            return Reflect.set(...args);
          }
        });
        return actions[actionName].apply(trackedStore, arguments);
      };
    }
  }
  function devtoolsPlugin({ app: app2, store, options }) {
    if (store.$id.startsWith("__hot:")) {
      return;
    }
    if (options.state) {
      store._isOptionsAPI = true;
    }
    if (typeof options.state === "function") {
      patchActionForGrouping(
        store,
        Object.keys(options.actions)
      );
      const originalHotUpdate = store._hotUpdate;
      vue.toRaw(store)._hotUpdate = function(newStore) {
        originalHotUpdate.apply(this, arguments);
        patchActionForGrouping(store, Object.keys(newStore._hmrPayload.actions));
      };
    }
    addStoreToDevtools(
      app2,
      store
    );
  }
  function createPinia() {
    const scope = vue.effectScope(true);
    const state = scope.run(() => vue.ref({}));
    let _p = [];
    let toBeInstalled = [];
    const pinia = vue.markRaw({
      install(app2) {
        setActivePinia(pinia);
        {
          pinia._a = app2;
          app2.provide(piniaSymbol, pinia);
          app2.config.globalProperties.$pinia = pinia;
          if (USE_DEVTOOLS) {
            registerPiniaDevtools(app2, pinia);
          }
          toBeInstalled.forEach((plugin) => _p.push(plugin));
          toBeInstalled = [];
        }
      },
      use(plugin) {
        if (!this._a && !isVue2) {
          toBeInstalled.push(plugin);
        } else {
          _p.push(plugin);
        }
        return this;
      },
      _p,
      _a: null,
      _e: scope,
      _s: /* @__PURE__ */ new Map(),
      state
    });
    if (USE_DEVTOOLS && typeof Proxy !== "undefined") {
      pinia.use(devtoolsPlugin);
    }
    return pinia;
  }
  function patchObject(newState, oldState) {
    for (const key in oldState) {
      const subPatch = oldState[key];
      if (!(key in newState)) {
        continue;
      }
      const targetValue = newState[key];
      if (isPlainObject(targetValue) && isPlainObject(subPatch) && !vue.isRef(subPatch) && !vue.isReactive(subPatch)) {
        newState[key] = patchObject(targetValue, subPatch);
      } else {
        {
          newState[key] = subPatch;
        }
      }
    }
    return newState;
  }
  const noop$1 = () => {
  };
  function addSubscription(subscriptions, callback, detached, onCleanup = noop$1) {
    subscriptions.push(callback);
    const removeSubscription = () => {
      const idx = subscriptions.indexOf(callback);
      if (idx > -1) {
        subscriptions.splice(idx, 1);
        onCleanup();
      }
    };
    if (!detached && vue.getCurrentScope()) {
      vue.onScopeDispose(removeSubscription);
    }
    return removeSubscription;
  }
  function triggerSubscriptions(subscriptions, ...args) {
    subscriptions.slice().forEach((callback) => {
      callback(...args);
    });
  }
  function mergeReactiveObjects(target, patchToApply) {
    if (target instanceof Map && patchToApply instanceof Map) {
      patchToApply.forEach((value, key) => target.set(key, value));
    }
    if (target instanceof Set && patchToApply instanceof Set) {
      patchToApply.forEach(target.add, target);
    }
    for (const key in patchToApply) {
      if (!patchToApply.hasOwnProperty(key))
        continue;
      const subPatch = patchToApply[key];
      const targetValue = target[key];
      if (isPlainObject(targetValue) && isPlainObject(subPatch) && target.hasOwnProperty(key) && !vue.isRef(subPatch) && !vue.isReactive(subPatch)) {
        target[key] = mergeReactiveObjects(targetValue, subPatch);
      } else {
        target[key] = subPatch;
      }
    }
    return target;
  }
  const skipHydrateSymbol = process.env.NODE_ENV !== "production" ? Symbol("pinia:skipHydration") : Symbol();
  function shouldHydrate(obj) {
    return !isPlainObject(obj) || !obj.hasOwnProperty(skipHydrateSymbol);
  }
  const { assign } = Object;
  function isComputed(o) {
    return !!(vue.isRef(o) && o.effect);
  }
  function createOptionsStore(id, options, pinia, hot) {
    const { state, actions, getters } = options;
    const initialState = pinia.state.value[id];
    let store;
    function setup() {
      if (!initialState && (!(process.env.NODE_ENV !== "production") || !hot)) {
        {
          pinia.state.value[id] = state ? state() : {};
        }
      }
      const localState = process.env.NODE_ENV !== "production" && hot ? vue.toRefs(vue.ref(state ? state() : {}).value) : vue.toRefs(pinia.state.value[id]);
      return assign(localState, actions, Object.keys(getters || {}).reduce((computedGetters, name) => {
        if (process.env.NODE_ENV !== "production" && name in localState) {
          console.warn(`[\u{1F34D}]: A getter cannot have the same name as another state property. Rename one of them. Found with "${name}" in store "${id}".`);
        }
        computedGetters[name] = vue.markRaw(vue.computed(() => {
          setActivePinia(pinia);
          const store2 = pinia._s.get(id);
          return getters[name].call(store2, store2);
        }));
        return computedGetters;
      }, {}));
    }
    store = createSetupStore(id, setup, options, pinia, hot, true);
    return store;
  }
  function createSetupStore($id, setup, options = {}, pinia, hot, isOptionsStore) {
    let scope;
    const optionsForPlugin = assign({ actions: {} }, options);
    if (process.env.NODE_ENV !== "production" && !pinia._e.active) {
      throw new Error("Pinia destroyed");
    }
    const $subscribeOptions = {
      deep: true
    };
    if (process.env.NODE_ENV !== "production" && !isVue2) {
      $subscribeOptions.onTrigger = (event) => {
        if (isListening) {
          debuggerEvents = event;
        } else if (isListening == false && !store._hotUpdating) {
          if (Array.isArray(debuggerEvents)) {
            debuggerEvents.push(event);
          } else {
            console.error("\u{1F34D} debuggerEvents should be an array. This is most likely an internal Pinia bug.");
          }
        }
      };
    }
    let isListening;
    let isSyncListening;
    let subscriptions = vue.markRaw([]);
    let actionSubscriptions = vue.markRaw([]);
    let debuggerEvents;
    const initialState = pinia.state.value[$id];
    if (!isOptionsStore && !initialState && (!(process.env.NODE_ENV !== "production") || !hot)) {
      {
        pinia.state.value[$id] = {};
      }
    }
    const hotState = vue.ref({});
    let activeListener;
    function $patch(partialStateOrMutator) {
      let subscriptionMutation;
      isListening = isSyncListening = false;
      if (process.env.NODE_ENV !== "production") {
        debuggerEvents = [];
      }
      if (typeof partialStateOrMutator === "function") {
        partialStateOrMutator(pinia.state.value[$id]);
        subscriptionMutation = {
          type: MutationType.patchFunction,
          storeId: $id,
          events: debuggerEvents
        };
      } else {
        mergeReactiveObjects(pinia.state.value[$id], partialStateOrMutator);
        subscriptionMutation = {
          type: MutationType.patchObject,
          payload: partialStateOrMutator,
          storeId: $id,
          events: debuggerEvents
        };
      }
      const myListenerId = activeListener = Symbol();
      vue.nextTick().then(() => {
        if (activeListener === myListenerId) {
          isListening = true;
        }
      });
      isSyncListening = true;
      triggerSubscriptions(subscriptions, subscriptionMutation, pinia.state.value[$id]);
    }
    const $reset = isOptionsStore ? function $reset2() {
      const { state } = options;
      const newState = state ? state() : {};
      this.$patch(($state) => {
        assign($state, newState);
      });
    } : process.env.NODE_ENV !== "production" ? () => {
      throw new Error(`\u{1F34D}: Store "${$id}" is built using the setup syntax and does not implement $reset().`);
    } : noop$1;
    function $dispose() {
      scope.stop();
      subscriptions = [];
      actionSubscriptions = [];
      pinia._s.delete($id);
    }
    function wrapAction(name, action) {
      return function() {
        setActivePinia(pinia);
        const args = Array.from(arguments);
        const afterCallbackList = [];
        const onErrorCallbackList = [];
        function after(callback) {
          afterCallbackList.push(callback);
        }
        function onError(callback) {
          onErrorCallbackList.push(callback);
        }
        triggerSubscriptions(actionSubscriptions, {
          args,
          name,
          store,
          after,
          onError
        });
        let ret;
        try {
          ret = action.apply(this && this.$id === $id ? this : store, args);
        } catch (error) {
          triggerSubscriptions(onErrorCallbackList, error);
          throw error;
        }
        if (ret instanceof Promise) {
          return ret.then((value) => {
            triggerSubscriptions(afterCallbackList, value);
            return value;
          }).catch((error) => {
            triggerSubscriptions(onErrorCallbackList, error);
            return Promise.reject(error);
          });
        }
        triggerSubscriptions(afterCallbackList, ret);
        return ret;
      };
    }
    const _hmrPayload = /* @__PURE__ */ vue.markRaw({
      actions: {},
      getters: {},
      state: [],
      hotState
    });
    const partialStore = {
      _p: pinia,
      $id,
      $onAction: addSubscription.bind(null, actionSubscriptions),
      $patch,
      $reset,
      $subscribe(callback, options2 = {}) {
        const removeSubscription = addSubscription(subscriptions, callback, options2.detached, () => stopWatcher());
        const stopWatcher = scope.run(() => vue.watch(() => pinia.state.value[$id], (state) => {
          if (options2.flush === "sync" ? isSyncListening : isListening) {
            callback({
              storeId: $id,
              type: MutationType.direct,
              events: debuggerEvents
            }, state);
          }
        }, assign({}, $subscribeOptions, options2)));
        return removeSubscription;
      },
      $dispose
    };
    const store = vue.reactive(process.env.NODE_ENV !== "production" || USE_DEVTOOLS ? assign(
      {
        _hmrPayload,
        _customProperties: vue.markRaw(/* @__PURE__ */ new Set())
      },
      partialStore
    ) : partialStore);
    pinia._s.set($id, store);
    const setupStore = pinia._e.run(() => {
      scope = vue.effectScope();
      return scope.run(() => setup());
    });
    for (const key in setupStore) {
      const prop = setupStore[key];
      if (vue.isRef(prop) && !isComputed(prop) || vue.isReactive(prop)) {
        if (process.env.NODE_ENV !== "production" && hot) {
          set(hotState.value, key, vue.toRef(setupStore, key));
        } else if (!isOptionsStore) {
          if (initialState && shouldHydrate(prop)) {
            if (vue.isRef(prop)) {
              prop.value = initialState[key];
            } else {
              mergeReactiveObjects(prop, initialState[key]);
            }
          }
          {
            pinia.state.value[$id][key] = prop;
          }
        }
        if (process.env.NODE_ENV !== "production") {
          _hmrPayload.state.push(key);
        }
      } else if (typeof prop === "function") {
        const actionValue = process.env.NODE_ENV !== "production" && hot ? prop : wrapAction(key, prop);
        {
          setupStore[key] = actionValue;
        }
        if (process.env.NODE_ENV !== "production") {
          _hmrPayload.actions[key] = prop;
        }
        optionsForPlugin.actions[key] = prop;
      } else if (process.env.NODE_ENV !== "production") {
        if (isComputed(prop)) {
          _hmrPayload.getters[key] = isOptionsStore ? options.getters[key] : prop;
          if (IS_CLIENT) {
            const getters = setupStore._getters || (setupStore._getters = vue.markRaw([]));
            getters.push(key);
          }
        }
      }
    }
    {
      assign(store, setupStore);
      assign(vue.toRaw(store), setupStore);
    }
    Object.defineProperty(store, "$state", {
      get: () => process.env.NODE_ENV !== "production" && hot ? hotState.value : pinia.state.value[$id],
      set: (state) => {
        if (process.env.NODE_ENV !== "production" && hot) {
          throw new Error("cannot set hotState");
        }
        $patch(($state) => {
          assign($state, state);
        });
      }
    });
    if (process.env.NODE_ENV !== "production") {
      store._hotUpdate = vue.markRaw((newStore) => {
        store._hotUpdating = true;
        newStore._hmrPayload.state.forEach((stateKey) => {
          if (stateKey in store.$state) {
            const newStateTarget = newStore.$state[stateKey];
            const oldStateSource = store.$state[stateKey];
            if (typeof newStateTarget === "object" && isPlainObject(newStateTarget) && isPlainObject(oldStateSource)) {
              patchObject(newStateTarget, oldStateSource);
            } else {
              newStore.$state[stateKey] = oldStateSource;
            }
          }
          set(store, stateKey, vue.toRef(newStore.$state, stateKey));
        });
        Object.keys(store.$state).forEach((stateKey) => {
          if (!(stateKey in newStore.$state)) {
            del(store, stateKey);
          }
        });
        isListening = false;
        isSyncListening = false;
        pinia.state.value[$id] = vue.toRef(newStore._hmrPayload, "hotState");
        isSyncListening = true;
        vue.nextTick().then(() => {
          isListening = true;
        });
        for (const actionName in newStore._hmrPayload.actions) {
          const action = newStore[actionName];
          set(store, actionName, wrapAction(actionName, action));
        }
        for (const getterName in newStore._hmrPayload.getters) {
          const getter = newStore._hmrPayload.getters[getterName];
          const getterValue = isOptionsStore ? vue.computed(() => {
            setActivePinia(pinia);
            return getter.call(store, store);
          }) : getter;
          set(store, getterName, getterValue);
        }
        Object.keys(store._hmrPayload.getters).forEach((key) => {
          if (!(key in newStore._hmrPayload.getters)) {
            del(store, key);
          }
        });
        Object.keys(store._hmrPayload.actions).forEach((key) => {
          if (!(key in newStore._hmrPayload.actions)) {
            del(store, key);
          }
        });
        store._hmrPayload = newStore._hmrPayload;
        store._getters = newStore._getters;
        store._hotUpdating = false;
      });
    }
    if (USE_DEVTOOLS) {
      const nonEnumerable = {
        writable: true,
        configurable: true,
        enumerable: false
      };
      ["_p", "_hmrPayload", "_getters", "_customProperties"].forEach((p2) => {
        Object.defineProperty(store, p2, assign({ value: store[p2] }, nonEnumerable));
      });
    }
    pinia._p.forEach((extender) => {
      if (USE_DEVTOOLS) {
        const extensions = scope.run(() => extender({
          store,
          app: pinia._a,
          pinia,
          options: optionsForPlugin
        }));
        Object.keys(extensions || {}).forEach((key) => store._customProperties.add(key));
        assign(store, extensions);
      } else {
        assign(store, scope.run(() => extender({
          store,
          app: pinia._a,
          pinia,
          options: optionsForPlugin
        })));
      }
    });
    if (process.env.NODE_ENV !== "production" && store.$state && typeof store.$state === "object" && typeof store.$state.constructor === "function" && !store.$state.constructor.toString().includes("[native code]")) {
      console.warn(`[\u{1F34D}]: The "state" must be a plain object. It cannot be
	state: () => new MyClass()
Found in store "${store.$id}".`);
    }
    if (initialState && isOptionsStore && options.hydrate) {
      options.hydrate(store.$state, initialState);
    }
    isListening = true;
    isSyncListening = true;
    return store;
  }
  function defineStore(idOrOptions, setup, setupOptions) {
    let id;
    let options;
    const isSetupStore = typeof setup === "function";
    if (typeof idOrOptions === "string") {
      id = idOrOptions;
      options = isSetupStore ? setupOptions : setup;
    } else {
      options = idOrOptions;
      id = idOrOptions.id;
    }
    function useStore(pinia, hot) {
      const currentInstance = vue.getCurrentInstance();
      pinia = (process.env.NODE_ENV === "test" && activePinia && activePinia._testing ? null : pinia) || currentInstance && vue.inject(piniaSymbol, null);
      if (pinia)
        setActivePinia(pinia);
      if (process.env.NODE_ENV !== "production" && !activePinia) {
        throw new Error(`[\u{1F34D}]: getActivePinia was called with no active Pinia. Did you forget to install pinia?
	const pinia = createPinia()
	app.use(pinia)
This will fail in production.`);
      }
      pinia = activePinia;
      if (!pinia._s.has(id)) {
        if (isSetupStore) {
          createSetupStore(id, setup, options, pinia);
        } else {
          createOptionsStore(id, options, pinia);
        }
        if (process.env.NODE_ENV !== "production") {
          useStore._pinia = pinia;
        }
      }
      const store = pinia._s.get(id);
      if (process.env.NODE_ENV !== "production" && hot) {
        const hotId = "__hot:" + id;
        const newStore = isSetupStore ? createSetupStore(hotId, setup, options, pinia, true) : createOptionsStore(hotId, assign({}, options), pinia, true);
        hot._hotUpdate(newStore);
        delete pinia.state.value[hotId];
        pinia._s.delete(hotId);
      }
      if (process.env.NODE_ENV !== "production" && IS_CLIENT && currentInstance && currentInstance.proxy && !hot) {
        const vm = currentInstance.proxy;
        const cache2 = "_pStores" in vm ? vm._pStores : vm._pStores = {};
        cache2[id] = store;
      }
      return store;
    }
    useStore.$id = id;
    return useStore;
  }
  function storeToRefs(store) {
    {
      store = vue.toRaw(store);
      const refs = {};
      for (const key in store) {
        const value = store[key];
        if (vue.isRef(value) || vue.isReactive(value)) {
          refs[key] = vue.toRef(store, key);
        }
      }
      return refs;
    }
  }
  const METERS_PER_UNIT$1 = {
    "radians": 6370997 / (2 * Math.PI),
    "degrees": 2 * Math.PI * 6370997 / 360,
    "ft": 0.3048,
    "m": 1,
    "us-ft": 1200 / 3937
  };
  class Projection$1 {
    constructor(options) {
      this.code_ = options.code;
      this.units_ = options.units;
      this.extent_ = options.extent !== void 0 ? options.extent : null;
      this.worldExtent_ = options.worldExtent !== void 0 ? options.worldExtent : null;
      this.axisOrientation_ = options.axisOrientation !== void 0 ? options.axisOrientation : "enu";
      this.global_ = options.global !== void 0 ? options.global : false;
      this.canWrapX_ = !!(this.global_ && this.extent_);
      this.getPointResolutionFunc_ = options.getPointResolution;
      this.defaultTileGrid_ = null;
      this.metersPerUnit_ = options.metersPerUnit;
    }
    canWrapX() {
      return this.canWrapX_;
    }
    getCode() {
      return this.code_;
    }
    getExtent() {
      return this.extent_;
    }
    getUnits() {
      return this.units_;
    }
    getMetersPerUnit() {
      return this.metersPerUnit_ || METERS_PER_UNIT$1[this.units_];
    }
    getWorldExtent() {
      return this.worldExtent_;
    }
    getAxisOrientation() {
      return this.axisOrientation_;
    }
    isGlobal() {
      return this.global_;
    }
    setGlobal(global2) {
      this.global_ = global2;
      this.canWrapX_ = !!(global2 && this.extent_);
    }
    getDefaultTileGrid() {
      return this.defaultTileGrid_;
    }
    setDefaultTileGrid(tileGrid) {
      this.defaultTileGrid_ = tileGrid;
    }
    setExtent(extent) {
      this.extent_ = extent;
      this.canWrapX_ = !!(this.global_ && extent);
    }
    setWorldExtent(worldExtent) {
      this.worldExtent_ = worldExtent;
    }
    setGetPointResolution(func) {
      this.getPointResolutionFunc_ = func;
    }
    getPointResolutionFunc() {
      return this.getPointResolutionFunc_;
    }
  }
  const Projection$2 = Projection$1;
  const RADIUS$1 = 6378137;
  const HALF_SIZE = Math.PI * RADIUS$1;
  const EXTENT$1 = [-HALF_SIZE, -HALF_SIZE, HALF_SIZE, HALF_SIZE];
  const WORLD_EXTENT = [-180, -85, 180, 85];
  const MAX_SAFE_Y = RADIUS$1 * Math.log(Math.tan(Math.PI / 2));
  class EPSG3857Projection extends Projection$2 {
    constructor(code) {
      super({
        code,
        units: "m",
        extent: EXTENT$1,
        global: true,
        worldExtent: WORLD_EXTENT,
        getPointResolution: function(resolution, point) {
          return resolution / Math.cosh(point[1] / RADIUS$1);
        }
      });
    }
  }
  const PROJECTIONS$1 = [
    new EPSG3857Projection("EPSG:3857"),
    new EPSG3857Projection("EPSG:102100"),
    new EPSG3857Projection("EPSG:102113"),
    new EPSG3857Projection("EPSG:900913"),
    new EPSG3857Projection("http://www.opengis.net/def/crs/EPSG/0/3857"),
    new EPSG3857Projection("http://www.opengis.net/gml/srs/epsg.xml#3857")
  ];
  function fromEPSG4326(input, output, dimension) {
    const length = input.length;
    dimension = dimension > 1 ? dimension : 2;
    if (output === void 0) {
      if (dimension > 2) {
        output = input.slice();
      } else {
        output = new Array(length);
      }
    }
    for (let i = 0; i < length; i += dimension) {
      output[i] = HALF_SIZE * input[i] / 180;
      let y2 = RADIUS$1 * Math.log(Math.tan(Math.PI * (+input[i + 1] + 90) / 360));
      if (y2 > MAX_SAFE_Y) {
        y2 = MAX_SAFE_Y;
      } else if (y2 < -MAX_SAFE_Y) {
        y2 = -MAX_SAFE_Y;
      }
      output[i + 1] = y2;
    }
    return output;
  }
  function toEPSG4326(input, output, dimension) {
    const length = input.length;
    dimension = dimension > 1 ? dimension : 2;
    if (output === void 0) {
      if (dimension > 2) {
        output = input.slice();
      } else {
        output = new Array(length);
      }
    }
    for (let i = 0; i < length; i += dimension) {
      output[i] = 180 * input[i] / HALF_SIZE;
      output[i + 1] = 360 * Math.atan(Math.exp(input[i + 1] / RADIUS$1)) / Math.PI - 90;
    }
    return output;
  }
  const RADIUS = 6378137;
  const EXTENT = [-180, -90, 180, 90];
  const METERS_PER_UNIT = Math.PI * RADIUS / 180;
  class EPSG4326Projection extends Projection$2 {
    constructor(code, axisOrientation) {
      super({
        code,
        units: "degrees",
        extent: EXTENT,
        axisOrientation,
        global: true,
        metersPerUnit: METERS_PER_UNIT,
        worldExtent: EXTENT
      });
    }
  }
  const PROJECTIONS = [
    new EPSG4326Projection("CRS:84"),
    new EPSG4326Projection("EPSG:4326", "neu"),
    new EPSG4326Projection("urn:ogc:def:crs:OGC:1.3:CRS84"),
    new EPSG4326Projection("urn:ogc:def:crs:OGC:2:84"),
    new EPSG4326Projection("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),
    new EPSG4326Projection("http://www.opengis.net/gml/srs/epsg.xml#4326", "neu"),
    new EPSG4326Projection("http://www.opengis.net/def/crs/EPSG/0/4326", "neu")
  ];
  let cache = {};
  function get$4(code) {
    return cache[code] || cache[code.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/, "EPSG:$3")] || null;
  }
  function add$3(code, projection) {
    cache[code] = projection;
  }
  function clear(object) {
    for (const property in object) {
      delete object[property];
    }
  }
  function isEmpty$1(object) {
    let property;
    for (property in object) {
      return false;
    }
    return !property;
  }
  let transforms = {};
  function add$2(source, destination, transformFn) {
    const sourceCode = source.getCode();
    const destinationCode = destination.getCode();
    if (!(sourceCode in transforms)) {
      transforms[sourceCode] = {};
    }
    transforms[sourceCode][destinationCode] = transformFn;
  }
  function get$3(sourceCode, destinationCode) {
    let transform2;
    if (sourceCode in transforms && destinationCode in transforms[sourceCode]) {
      transform2 = transforms[sourceCode][destinationCode];
    }
    return transform2;
  }
  const Relationship = {
    UNKNOWN: 0,
    INTERSECTING: 1,
    ABOVE: 2,
    RIGHT: 4,
    BELOW: 8,
    LEFT: 16
  };
  const messages = {
    1: "The view center is not defined",
    2: "The view resolution is not defined",
    3: "The view rotation is not defined",
    4: "`image` and `src` cannot be provided at the same time",
    5: "`imgSize` must be set when `image` is provided",
    7: "`format` must be set when `url` is set",
    8: "Unknown `serverType` configured",
    9: "`url` must be configured or set using `#setUrl()`",
    10: "The default `geometryFunction` can only handle `Point` geometries",
    11: "`options.featureTypes` must be an Array",
    12: "`options.geometryName` must also be provided when `options.bbox` is set",
    13: "Invalid corner",
    14: "Invalid color",
    15: "Tried to get a value for a key that does not exist in the cache",
    16: "Tried to set a value for a key that is used already",
    17: "`resolutions` must be sorted in descending order",
    18: "Either `origin` or `origins` must be configured, never both",
    19: "Number of `tileSizes` and `resolutions` must be equal",
    20: "Number of `origins` and `resolutions` must be equal",
    22: "Either `tileSize` or `tileSizes` must be configured, never both",
    24: "Invalid extent or geometry provided as `geometry`",
    25: "Cannot fit empty extent provided as `geometry`",
    26: "Features must have an id set",
    27: "Features must have an id set",
    28: '`renderMode` must be `"hybrid"` or `"vector"`',
    30: "The passed `feature` was already added to the source",
    31: "Tried to enqueue an `element` that was already added to the queue",
    32: "Transformation matrix cannot be inverted",
    33: "Invalid units",
    34: "Invalid geometry layout",
    36: "Unknown SRS type",
    37: "Unknown geometry type found",
    38: "`styleMapValue` has an unknown type",
    39: "Unknown geometry type",
    40: "Expected `feature` to have a geometry",
    41: "Expected an `ol/style/Style` or an array of `ol/style/Style.js`",
    42: "Question unknown, the answer is 42",
    43: "Expected `layers` to be an array or a `Collection`",
    47: "Expected `controls` to be an array or an `ol/Collection`",
    48: "Expected `interactions` to be an array or an `ol/Collection`",
    49: "Expected `overlays` to be an array or an `ol/Collection`",
    50: "`options.featureTypes` should be an Array",
    51: "Either `url` or `tileJSON` options must be provided",
    52: "Unknown `serverType` configured",
    53: "Unknown `tierSizeCalculation` configured",
    55: "The {-y} placeholder requires a tile grid with extent",
    56: "mapBrowserEvent must originate from a pointer event",
    57: "At least 2 conditions are required",
    59: "Invalid command found in the PBF",
    60: "Missing or invalid `size`",
    61: "Cannot determine IIIF Image API version from provided image information JSON",
    62: "A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",
    64: "Layer opacity must be a number",
    66: "`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",
    67: "A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",
    68: "A VectorTile source can only be rendered if it has a projection compatible with the view projection",
    69: "`width` or `height` cannot be provided together with `scale`"
  };
  class AssertionError extends Error {
    constructor(code) {
      const message = messages[code];
      super(message);
      this.code = code;
      this.name = "AssertionError";
      this.message = message;
    }
  }
  const AssertionError$1 = AssertionError;
  function assert(assertion, errorCode) {
    if (!assertion) {
      throw new AssertionError$1(errorCode);
    }
  }
  function boundingExtent(coordinates2) {
    const extent = createEmpty();
    for (let i = 0, ii = coordinates2.length; i < ii; ++i) {
      extendCoordinate(extent, coordinates2[i]);
    }
    return extent;
  }
  function _boundingExtentXYs(xs, ys, dest) {
    const minX = Math.min.apply(null, xs);
    const minY = Math.min.apply(null, ys);
    const maxX = Math.max.apply(null, xs);
    const maxY = Math.max.apply(null, ys);
    return createOrUpdate$2(minX, minY, maxX, maxY, dest);
  }
  function clone$1(extent, dest) {
    if (dest) {
      dest[0] = extent[0];
      dest[1] = extent[1];
      dest[2] = extent[2];
      dest[3] = extent[3];
      return dest;
    }
    return extent.slice();
  }
  function closestSquaredDistanceXY(extent, x, y2) {
    let dx, dy;
    if (x < extent[0]) {
      dx = extent[0] - x;
    } else if (extent[2] < x) {
      dx = x - extent[2];
    } else {
      dx = 0;
    }
    if (y2 < extent[1]) {
      dy = extent[1] - y2;
    } else if (extent[3] < y2) {
      dy = y2 - extent[3];
    } else {
      dy = 0;
    }
    return dx * dx + dy * dy;
  }
  function containsCoordinate(extent, coordinate) {
    return containsXY(extent, coordinate[0], coordinate[1]);
  }
  function containsExtent(extent1, extent2) {
    return extent1[0] <= extent2[0] && extent2[2] <= extent1[2] && extent1[1] <= extent2[1] && extent2[3] <= extent1[3];
  }
  function containsXY(extent, x, y2) {
    return extent[0] <= x && x <= extent[2] && extent[1] <= y2 && y2 <= extent[3];
  }
  function coordinateRelationship(extent, coordinate) {
    const minX = extent[0];
    const minY = extent[1];
    const maxX = extent[2];
    const maxY = extent[3];
    const x = coordinate[0];
    const y2 = coordinate[1];
    let relationship = Relationship.UNKNOWN;
    if (x < minX) {
      relationship = relationship | Relationship.LEFT;
    } else if (x > maxX) {
      relationship = relationship | Relationship.RIGHT;
    }
    if (y2 < minY) {
      relationship = relationship | Relationship.BELOW;
    } else if (y2 > maxY) {
      relationship = relationship | Relationship.ABOVE;
    }
    if (relationship === Relationship.UNKNOWN) {
      relationship = Relationship.INTERSECTING;
    }
    return relationship;
  }
  function createEmpty() {
    return [Infinity, Infinity, -Infinity, -Infinity];
  }
  function createOrUpdate$2(minX, minY, maxX, maxY, dest) {
    if (dest) {
      dest[0] = minX;
      dest[1] = minY;
      dest[2] = maxX;
      dest[3] = maxY;
      return dest;
    }
    return [minX, minY, maxX, maxY];
  }
  function createOrUpdateEmpty(dest) {
    return createOrUpdate$2(Infinity, Infinity, -Infinity, -Infinity, dest);
  }
  function createOrUpdateFromCoordinate(coordinate, dest) {
    const x = coordinate[0];
    const y2 = coordinate[1];
    return createOrUpdate$2(x, y2, x, y2, dest);
  }
  function createOrUpdateFromFlatCoordinates(flatCoordinates, offset, end, stride, dest) {
    const extent = createOrUpdateEmpty(dest);
    return extendFlatCoordinates(extent, flatCoordinates, offset, end, stride);
  }
  function equals$2(extent1, extent2) {
    return extent1[0] == extent2[0] && extent1[2] == extent2[2] && extent1[1] == extent2[1] && extent1[3] == extent2[3];
  }
  function extend$3(extent1, extent2) {
    if (extent2[0] < extent1[0]) {
      extent1[0] = extent2[0];
    }
    if (extent2[2] > extent1[2]) {
      extent1[2] = extent2[2];
    }
    if (extent2[1] < extent1[1]) {
      extent1[1] = extent2[1];
    }
    if (extent2[3] > extent1[3]) {
      extent1[3] = extent2[3];
    }
    return extent1;
  }
  function extendCoordinate(extent, coordinate) {
    if (coordinate[0] < extent[0]) {
      extent[0] = coordinate[0];
    }
    if (coordinate[0] > extent[2]) {
      extent[2] = coordinate[0];
    }
    if (coordinate[1] < extent[1]) {
      extent[1] = coordinate[1];
    }
    if (coordinate[1] > extent[3]) {
      extent[3] = coordinate[1];
    }
  }
  function extendFlatCoordinates(extent, flatCoordinates, offset, end, stride) {
    for (; offset < end; offset += stride) {
      extendXY(extent, flatCoordinates[offset], flatCoordinates[offset + 1]);
    }
    return extent;
  }
  function extendXY(extent, x, y2) {
    extent[0] = Math.min(extent[0], x);
    extent[1] = Math.min(extent[1], y2);
    extent[2] = Math.max(extent[2], x);
    extent[3] = Math.max(extent[3], y2);
  }
  function forEachCorner(extent, callback) {
    let val;
    val = callback(getBottomLeft(extent));
    if (val) {
      return val;
    }
    val = callback(getBottomRight(extent));
    if (val) {
      return val;
    }
    val = callback(getTopRight(extent));
    if (val) {
      return val;
    }
    val = callback(getTopLeft(extent));
    if (val) {
      return val;
    }
    return false;
  }
  function getArea(extent) {
    let area = 0;
    if (!isEmpty(extent)) {
      area = getWidth(extent) * getHeight(extent);
    }
    return area;
  }
  function getBottomLeft(extent) {
    return [extent[0], extent[1]];
  }
  function getBottomRight(extent) {
    return [extent[2], extent[1]];
  }
  function getCenter(extent) {
    return [(extent[0] + extent[2]) / 2, (extent[1] + extent[3]) / 2];
  }
  function getCorner(extent, corner) {
    let coordinate;
    if (corner === "bottom-left") {
      coordinate = getBottomLeft(extent);
    } else if (corner === "bottom-right") {
      coordinate = getBottomRight(extent);
    } else if (corner === "top-left") {
      coordinate = getTopLeft(extent);
    } else if (corner === "top-right") {
      coordinate = getTopRight(extent);
    } else {
      assert(false, 13);
    }
    return coordinate;
  }
  function getForViewAndSize(center, resolution, rotation, size, dest) {
    const [x0, y0, x1, y1, x2, y2, x3, y3] = getRotatedViewport(
      center,
      resolution,
      rotation,
      size
    );
    return createOrUpdate$2(
      Math.min(x0, x1, x2, x3),
      Math.min(y0, y1, y2, y3),
      Math.max(x0, x1, x2, x3),
      Math.max(y0, y1, y2, y3),
      dest
    );
  }
  function getRotatedViewport(center, resolution, rotation, size) {
    const dx = resolution * size[0] / 2;
    const dy = resolution * size[1] / 2;
    const cosRotation = Math.cos(rotation);
    const sinRotation = Math.sin(rotation);
    const xCos = dx * cosRotation;
    const xSin = dx * sinRotation;
    const yCos = dy * cosRotation;
    const ySin = dy * sinRotation;
    const x = center[0];
    const y2 = center[1];
    return [
      x - xCos + ySin,
      y2 - xSin - yCos,
      x - xCos - ySin,
      y2 - xSin + yCos,
      x + xCos - ySin,
      y2 + xSin + yCos,
      x + xCos + ySin,
      y2 + xSin - yCos,
      x - xCos + ySin,
      y2 - xSin - yCos
    ];
  }
  function getHeight(extent) {
    return extent[3] - extent[1];
  }
  function getIntersection(extent1, extent2, dest) {
    const intersection = dest ? dest : createEmpty();
    if (intersects(extent1, extent2)) {
      if (extent1[0] > extent2[0]) {
        intersection[0] = extent1[0];
      } else {
        intersection[0] = extent2[0];
      }
      if (extent1[1] > extent2[1]) {
        intersection[1] = extent1[1];
      } else {
        intersection[1] = extent2[1];
      }
      if (extent1[2] < extent2[2]) {
        intersection[2] = extent1[2];
      } else {
        intersection[2] = extent2[2];
      }
      if (extent1[3] < extent2[3]) {
        intersection[3] = extent1[3];
      } else {
        intersection[3] = extent2[3];
      }
    } else {
      createOrUpdateEmpty(intersection);
    }
    return intersection;
  }
  function getTopLeft(extent) {
    return [extent[0], extent[3]];
  }
  function getTopRight(extent) {
    return [extent[2], extent[3]];
  }
  function getWidth(extent) {
    return extent[2] - extent[0];
  }
  function intersects(extent1, extent2) {
    return extent1[0] <= extent2[2] && extent1[2] >= extent2[0] && extent1[1] <= extent2[3] && extent1[3] >= extent2[1];
  }
  function isEmpty(extent) {
    return extent[2] < extent[0] || extent[3] < extent[1];
  }
  function returnOrUpdate(extent, dest) {
    if (dest) {
      dest[0] = extent[0];
      dest[1] = extent[1];
      dest[2] = extent[2];
      dest[3] = extent[3];
      return dest;
    }
    return extent;
  }
  function intersectsSegment(extent, start2, end) {
    let intersects2 = false;
    const startRel = coordinateRelationship(extent, start2);
    const endRel = coordinateRelationship(extent, end);
    if (startRel === Relationship.INTERSECTING || endRel === Relationship.INTERSECTING) {
      intersects2 = true;
    } else {
      const minX = extent[0];
      const minY = extent[1];
      const maxX = extent[2];
      const maxY = extent[3];
      const startX = start2[0];
      const startY = start2[1];
      const endX = end[0];
      const endY = end[1];
      const slope = (endY - startY) / (endX - startX);
      let x, y2;
      if (!!(endRel & Relationship.ABOVE) && !(startRel & Relationship.ABOVE)) {
        x = endX - (endY - maxY) / slope;
        intersects2 = x >= minX && x <= maxX;
      }
      if (!intersects2 && !!(endRel & Relationship.RIGHT) && !(startRel & Relationship.RIGHT)) {
        y2 = endY - (endX - maxX) * slope;
        intersects2 = y2 >= minY && y2 <= maxY;
      }
      if (!intersects2 && !!(endRel & Relationship.BELOW) && !(startRel & Relationship.BELOW)) {
        x = endX - (endY - minY) / slope;
        intersects2 = x >= minX && x <= maxX;
      }
      if (!intersects2 && !!(endRel & Relationship.LEFT) && !(startRel & Relationship.LEFT)) {
        y2 = endY - (endX - minX) * slope;
        intersects2 = y2 >= minY && y2 <= maxY;
      }
    }
    return intersects2;
  }
  function applyTransform(extent, transformFn, dest, stops) {
    let coordinates2 = [];
    if (stops > 1) {
      const width = extent[2] - extent[0];
      const height = extent[3] - extent[1];
      for (let i = 0; i < stops; ++i) {
        coordinates2.push(
          extent[0] + width * i / stops,
          extent[1],
          extent[2],
          extent[1] + height * i / stops,
          extent[2] - width * i / stops,
          extent[3],
          extent[0],
          extent[3] - height * i / stops
        );
      }
    } else {
      coordinates2 = [
        extent[0],
        extent[1],
        extent[2],
        extent[1],
        extent[2],
        extent[3],
        extent[0],
        extent[3]
      ];
    }
    transformFn(coordinates2, coordinates2, 2);
    const xs = [];
    const ys = [];
    for (let i = 0, l = coordinates2.length; i < l; i += 2) {
      xs.push(coordinates2[i]);
      ys.push(coordinates2[i + 1]);
    }
    return _boundingExtentXYs(xs, ys, dest);
  }
  function clamp(value, min, max) {
    return Math.min(Math.max(value, min), max);
  }
  function squaredSegmentDistance(x, y2, x1, y1, x2, y22) {
    const dx = x2 - x1;
    const dy = y22 - y1;
    if (dx !== 0 || dy !== 0) {
      const t = ((x - x1) * dx + (y2 - y1) * dy) / (dx * dx + dy * dy);
      if (t > 1) {
        x1 = x2;
        y1 = y22;
      } else if (t > 0) {
        x1 += dx * t;
        y1 += dy * t;
      }
    }
    return squaredDistance(x, y2, x1, y1);
  }
  function squaredDistance(x1, y1, x2, y2) {
    const dx = x2 - x1;
    const dy = y2 - y1;
    return dx * dx + dy * dy;
  }
  function solveLinearSystem(mat) {
    const n = mat.length;
    for (let i = 0; i < n; i++) {
      let maxRow = i;
      let maxEl = Math.abs(mat[i][i]);
      for (let r = i + 1; r < n; r++) {
        const absValue = Math.abs(mat[r][i]);
        if (absValue > maxEl) {
          maxEl = absValue;
          maxRow = r;
        }
      }
      if (maxEl === 0) {
        return null;
      }
      const tmp = mat[maxRow];
      mat[maxRow] = mat[i];
      mat[i] = tmp;
      for (let j = i + 1; j < n; j++) {
        const coef = -mat[j][i] / mat[i][i];
        for (let k = i; k < n + 1; k++) {
          if (i == k) {
            mat[j][k] = 0;
          } else {
            mat[j][k] += coef * mat[i][k];
          }
        }
      }
    }
    const x = new Array(n);
    for (let l = n - 1; l >= 0; l--) {
      x[l] = mat[l][n] / mat[l][l];
      for (let m = l - 1; m >= 0; m--) {
        mat[m][n] -= mat[m][l] * x[l];
      }
    }
    return x;
  }
  function toDegrees(angleInRadians) {
    return angleInRadians * 180 / Math.PI;
  }
  function toRadians(angleInDegrees) {
    return angleInDegrees * Math.PI / 180;
  }
  function modulo(a, b) {
    const r = a % b;
    return r * b < 0 ? r + b : r;
  }
  function lerp(a, b, x) {
    return a + x * (b - a);
  }
  function toFixed(n, decimals) {
    const factor = Math.pow(10, decimals);
    return Math.round(n * factor) / factor;
  }
  function round(n, decimals) {
    return Math.round(toFixed(n, decimals));
  }
  function floor(n, decimals) {
    return Math.floor(toFixed(n, decimals));
  }
  function ceil(n, decimals) {
    return Math.ceil(toFixed(n, decimals));
  }
  function compareVersions(v1, v2) {
    const s1 = ("" + v1).split(".");
    const s2 = ("" + v2).split(".");
    for (let i = 0; i < Math.max(s1.length, s2.length); i++) {
      const n1 = parseInt(s1[i] || "0", 10);
      const n2 = parseInt(s2[i] || "0", 10);
      if (n1 > n2) {
        return 1;
      }
      if (n2 > n1) {
        return -1;
      }
    }
    return 0;
  }
  function add$1(coordinate, delta) {
    coordinate[0] += +delta[0];
    coordinate[1] += +delta[1];
    return coordinate;
  }
  function equals$1(coordinate1, coordinate2) {
    let equals2 = true;
    for (let i = coordinate1.length - 1; i >= 0; --i) {
      if (coordinate1[i] != coordinate2[i]) {
        equals2 = false;
        break;
      }
    }
    return equals2;
  }
  function rotate$1(coordinate, angle) {
    const cosAngle = Math.cos(angle);
    const sinAngle = Math.sin(angle);
    const x = coordinate[0] * cosAngle - coordinate[1] * sinAngle;
    const y2 = coordinate[1] * cosAngle + coordinate[0] * sinAngle;
    coordinate[0] = x;
    coordinate[1] = y2;
    return coordinate;
  }
  function scale$2(coordinate, scale2) {
    coordinate[0] *= scale2;
    coordinate[1] *= scale2;
    return coordinate;
  }
  function wrapX$1(coordinate, projection) {
    if (projection.canWrapX()) {
      const worldWidth = getWidth(projection.getExtent());
      const worldsAway = getWorldsAway(coordinate, projection, worldWidth);
      if (worldsAway) {
        coordinate[0] -= worldsAway * worldWidth;
      }
    }
    return coordinate;
  }
  function getWorldsAway(coordinate, projection, sourceExtentWidth) {
    const projectionExtent = projection.getExtent();
    let worldsAway = 0;
    if (projection.canWrapX() && (coordinate[0] < projectionExtent[0] || coordinate[0] > projectionExtent[2])) {
      sourceExtentWidth = sourceExtentWidth || getWidth(projectionExtent);
      worldsAway = Math.floor(
        (coordinate[0] - projectionExtent[0]) / sourceExtentWidth
      );
    }
    return worldsAway;
  }
  const DEFAULT_RADIUS = 63710088e-1;
  function getDistance(c1, c2, radius) {
    radius = radius || DEFAULT_RADIUS;
    const lat1 = toRadians(c1[1]);
    const lat2 = toRadians(c2[1]);
    const deltaLatBy2 = (lat2 - lat1) / 2;
    const deltaLonBy2 = toRadians(c2[0] - c1[0]) / 2;
    const a = Math.sin(deltaLatBy2) * Math.sin(deltaLatBy2) + Math.sin(deltaLonBy2) * Math.sin(deltaLonBy2) * Math.cos(lat1) * Math.cos(lat2);
    return 2 * radius * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
  }
  const levels = {
    info: 1,
    warn: 2,
    error: 3,
    none: 4
  };
  let level = levels.info;
  function warn(...args) {
    if (level > levels.warn) {
      return;
    }
    console.warn(...args);
  }
  let showCoordinateWarning = true;
  function disableCoordinateWarning(disable2) {
    const hide = disable2 === void 0 ? true : disable2;
    showCoordinateWarning = !hide;
  }
  function cloneTransform(input, output) {
    if (output !== void 0) {
      for (let i = 0, ii = input.length; i < ii; ++i) {
        output[i] = input[i];
      }
      output = output;
    } else {
      output = input.slice();
    }
    return output;
  }
  function identityTransform(input, output) {
    if (output !== void 0 && input !== output) {
      for (let i = 0, ii = input.length; i < ii; ++i) {
        output[i] = input[i];
      }
      input = output;
    }
    return input;
  }
  function addProjection(projection) {
    add$3(projection.getCode(), projection);
    add$2(projection, projection, cloneTransform);
  }
  function addProjections(projections2) {
    projections2.forEach(addProjection);
  }
  function get$2(projectionLike) {
    return typeof projectionLike === "string" ? get$4(projectionLike) : projectionLike || null;
  }
  function getPointResolution(projection, resolution, point, units2) {
    projection = get$2(projection);
    let pointResolution;
    const getter = projection.getPointResolutionFunc();
    if (getter) {
      pointResolution = getter(resolution, point);
      if (units2 && units2 !== projection.getUnits()) {
        const metersPerUnit = projection.getMetersPerUnit();
        if (metersPerUnit) {
          pointResolution = pointResolution * metersPerUnit / METERS_PER_UNIT$1[units2];
        }
      }
    } else {
      const projUnits = projection.getUnits();
      if (projUnits == "degrees" && !units2 || units2 == "degrees") {
        pointResolution = resolution;
      } else {
        const toEPSG43262 = getTransformFromProjections(
          projection,
          get$2("EPSG:4326")
        );
        if (toEPSG43262 === identityTransform && projUnits !== "degrees") {
          pointResolution = resolution * projection.getMetersPerUnit();
        } else {
          let vertices = [
            point[0] - resolution / 2,
            point[1],
            point[0] + resolution / 2,
            point[1],
            point[0],
            point[1] - resolution / 2,
            point[0],
            point[1] + resolution / 2
          ];
          vertices = toEPSG43262(vertices, vertices, 2);
          const width = getDistance(vertices.slice(0, 2), vertices.slice(2, 4));
          const height = getDistance(vertices.slice(4, 6), vertices.slice(6, 8));
          pointResolution = (width + height) / 2;
        }
        const metersPerUnit = units2 ? METERS_PER_UNIT$1[units2] : projection.getMetersPerUnit();
        if (metersPerUnit !== void 0) {
          pointResolution /= metersPerUnit;
        }
      }
    }
    return pointResolution;
  }
  function addEquivalentProjections(projections2) {
    addProjections(projections2);
    projections2.forEach(function(source) {
      projections2.forEach(function(destination) {
        if (source !== destination) {
          add$2(source, destination, cloneTransform);
        }
      });
    });
  }
  function addEquivalentTransforms(projections1, projections2, forwardTransform, inverseTransform) {
    projections1.forEach(function(projection1) {
      projections2.forEach(function(projection2) {
        add$2(projection1, projection2, forwardTransform);
        add$2(projection2, projection1, inverseTransform);
      });
    });
  }
  function createProjection(projection, defaultCode) {
    if (!projection) {
      return get$2(defaultCode);
    } else if (typeof projection === "string") {
      return get$2(projection);
    }
    return projection;
  }
  function createTransformFromCoordinateTransform(coordTransform) {
    return function(input, output, dimension) {
      const length = input.length;
      dimension = dimension !== void 0 ? dimension : 2;
      output = output !== void 0 ? output : new Array(length);
      for (let i = 0; i < length; i += dimension) {
        const point = coordTransform(input.slice(i, i + dimension));
        const pointLength = point.length;
        for (let j = 0, jj = dimension; j < jj; ++j) {
          output[i + j] = j >= pointLength ? input[i + j] : point[j];
        }
      }
      return output;
    };
  }
  function addCoordinateTransforms(source, destination, forward2, inverse2) {
    const sourceProj = get$2(source);
    const destProj = get$2(destination);
    add$2(
      sourceProj,
      destProj,
      createTransformFromCoordinateTransform(forward2)
    );
    add$2(
      destProj,
      sourceProj,
      createTransformFromCoordinateTransform(inverse2)
    );
  }
  function toLonLat(coordinate, projection) {
    const lonLat = transform$1(
      coordinate,
      projection !== void 0 ? projection : "EPSG:3857",
      "EPSG:4326"
    );
    const lon = lonLat[0];
    if (lon < -180 || lon > 180) {
      lonLat[0] = modulo(lon + 180, 360) - 180;
    }
    return lonLat;
  }
  function equivalent(projection1, projection2) {
    if (projection1 === projection2) {
      return true;
    }
    const equalUnits = projection1.getUnits() === projection2.getUnits();
    if (projection1.getCode() === projection2.getCode()) {
      return equalUnits;
    }
    const transformFunc = getTransformFromProjections(projection1, projection2);
    return transformFunc === cloneTransform && equalUnits;
  }
  function getTransformFromProjections(sourceProjection, destinationProjection) {
    const sourceCode = sourceProjection.getCode();
    const destinationCode = destinationProjection.getCode();
    let transformFunc = get$3(sourceCode, destinationCode);
    if (!transformFunc) {
      transformFunc = identityTransform;
    }
    return transformFunc;
  }
  function getTransform(source, destination) {
    const sourceProjection = get$2(source);
    const destinationProjection = get$2(destination);
    return getTransformFromProjections(sourceProjection, destinationProjection);
  }
  function transform$1(coordinate, source, destination) {
    const transformFunc = getTransform(source, destination);
    return transformFunc(coordinate, void 0, coordinate.length);
  }
  function transformExtent(extent, source, destination, stops) {
    const transformFunc = getTransform(source, destination);
    return applyTransform(extent, transformFunc, void 0, stops);
  }
  function toUserCoordinate(coordinate, sourceProjection) {
    {
      return coordinate;
    }
  }
  function fromUserCoordinate(coordinate, destProjection) {
    {
      if (showCoordinateWarning && !equals$1(coordinate, [0, 0]) && coordinate[0] >= -180 && coordinate[0] <= 180 && coordinate[1] >= -90 && coordinate[1] <= 90) {
        showCoordinateWarning = false;
        warn(
          "Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates."
        );
      }
      return coordinate;
    }
  }
  function toUserExtent(extent, sourceProjection) {
    {
      return extent;
    }
  }
  function fromUserExtent(extent, destProjection) {
    {
      return extent;
    }
  }
  function createSafeCoordinateTransform(sourceProj, destProj, transform2) {
    return function(coord) {
      let transformed, worldsAway;
      if (sourceProj.canWrapX()) {
        const sourceExtent = sourceProj.getExtent();
        const sourceExtentWidth = getWidth(sourceExtent);
        coord = coord.slice(0);
        worldsAway = getWorldsAway(coord, sourceProj, sourceExtentWidth);
        if (worldsAway) {
          coord[0] = coord[0] - worldsAway * sourceExtentWidth;
        }
        coord[0] = clamp(coord[0], sourceExtent[0], sourceExtent[2]);
        coord[1] = clamp(coord[1], sourceExtent[1], sourceExtent[3]);
        transformed = transform2(coord);
      } else {
        transformed = transform2(coord);
      }
      if (worldsAway && destProj.canWrapX()) {
        transformed[0] += worldsAway * getWidth(destProj.getExtent());
      }
      return transformed;
    };
  }
  function addCommon() {
    addEquivalentProjections(PROJECTIONS$1);
    addEquivalentProjections(PROJECTIONS);
    addEquivalentTransforms(
      PROJECTIONS,
      PROJECTIONS$1,
      fromEPSG4326,
      toEPSG4326
    );
  }
  addCommon();
  let registered = null;
  function register(proj42) {
    registered = proj42;
    const projCodes = Object.keys(proj42.defs);
    const len = projCodes.length;
    let i, j;
    for (i = 0; i < len; ++i) {
      const code = projCodes[i];
      if (!get$2(code)) {
        const def = proj42.defs(code);
        let units2 = def.units;
        if (!units2 && def.projName === "longlat") {
          units2 = "degrees";
        }
        addProjection(
          new Projection$2({
            code,
            axisOrientation: def.axis,
            metersPerUnit: def.to_meter,
            units: units2
          })
        );
      }
    }
    for (i = 0; i < len; ++i) {
      const code1 = projCodes[i];
      const proj1 = get$2(code1);
      for (j = 0; j < len; ++j) {
        const code2 = projCodes[j];
        const proj2 = get$2(code2);
        if (!get$3(code1, code2)) {
          if (proj42.defs[code1] === proj42.defs[code2]) {
            addEquivalentProjections([proj1, proj2]);
          } else {
            const transform2 = proj42(code1, code2);
            addCoordinateTransforms(
              proj1,
              proj2,
              createSafeCoordinateTransform(proj1, proj2, transform2.forward),
              createSafeCoordinateTransform(proj2, proj1, transform2.inverse)
            );
          }
        }
      }
    }
  }
  function globals(defs2) {
    defs2("EPSG:4326", "+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees");
    defs2("EPSG:4269", "+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees");
    defs2("EPSG:3857", "+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");
    defs2.WGS84 = defs2["EPSG:4326"];
    defs2["EPSG:3785"] = defs2["EPSG:3857"];
    defs2.GOOGLE = defs2["EPSG:3857"];
    defs2["EPSG:900913"] = defs2["EPSG:3857"];
    defs2["EPSG:102113"] = defs2["EPSG:3857"];
  }
  var PJD_3PARAM = 1;
  var PJD_7PARAM = 2;
  var PJD_GRIDSHIFT = 3;
  var PJD_WGS84 = 4;
  var PJD_NODATUM = 5;
  var SRS_WGS84_SEMIMAJOR = 6378137;
  var SRS_WGS84_SEMIMINOR = 6356752314e-3;
  var SRS_WGS84_ESQUARED = 0.0066943799901413165;
  var SEC_TO_RAD = 484813681109536e-20;
  var HALF_PI = Math.PI / 2;
  var SIXTH = 0.16666666666666666;
  var RA4 = 0.04722222222222222;
  var RA6 = 0.022156084656084655;
  var EPSLN = 1e-10;
  var D2R$1 = 0.017453292519943295;
  var R2D = 57.29577951308232;
  var FORTPI = Math.PI / 4;
  var TWO_PI = Math.PI * 2;
  var SPI = 3.14159265359;
  var exports$3 = {};
  exports$3.greenwich = 0;
  exports$3.lisbon = -9.131906111111;
  exports$3.paris = 2.337229166667;
  exports$3.bogota = -74.080916666667;
  exports$3.madrid = -3.687938888889;
  exports$3.rome = 12.452333333333;
  exports$3.bern = 7.439583333333;
  exports$3.jakarta = 106.807719444444;
  exports$3.ferro = -17.666666666667;
  exports$3.brussels = 4.367975;
  exports$3.stockholm = 18.058277777778;
  exports$3.athens = 23.7163375;
  exports$3.oslo = 10.722916666667;
  const units = {
    ft: { to_meter: 0.3048 },
    "us-ft": { to_meter: 1200 / 3937 }
  };
  var ignoredChar = /[\s_\-\/\(\)]/g;
  function match(obj, key) {
    if (obj[key]) {
      return obj[key];
    }
    var keys = Object.keys(obj);
    var lkey = key.toLowerCase().replace(ignoredChar, "");
    var i = -1;
    var testkey, processedKey;
    while (++i < keys.length) {
      testkey = keys[i];
      processedKey = testkey.toLowerCase().replace(ignoredChar, "");
      if (processedKey === lkey) {
        return obj[testkey];
      }
    }
  }
  function projStr(defData) {
    var self2 = {};
    var paramObj = defData.split("+").map(function(v2) {
      return v2.trim();
    }).filter(function(a) {
      return a;
    }).reduce(function(p2, a) {
      var split = a.split("=");
      split.push(true);
      p2[split[0].toLowerCase()] = split[1];
      return p2;
    }, {});
    var paramName, paramVal, paramOutname;
    var params2 = {
      proj: "projName",
      datum: "datumCode",
      rf: function(v2) {
        self2.rf = parseFloat(v2);
      },
      lat_0: function(v2) {
        self2.lat0 = v2 * D2R$1;
      },
      lat_1: function(v2) {
        self2.lat1 = v2 * D2R$1;
      },
      lat_2: function(v2) {
        self2.lat2 = v2 * D2R$1;
      },
      lat_ts: function(v2) {
        self2.lat_ts = v2 * D2R$1;
      },
      lon_0: function(v2) {
        self2.long0 = v2 * D2R$1;
      },
      lon_1: function(v2) {
        self2.long1 = v2 * D2R$1;
      },
      lon_2: function(v2) {
        self2.long2 = v2 * D2R$1;
      },
      alpha: function(v2) {
        self2.alpha = parseFloat(v2) * D2R$1;
      },
      gamma: function(v2) {
        self2.rectified_grid_angle = parseFloat(v2);
      },
      lonc: function(v2) {
        self2.longc = v2 * D2R$1;
      },
      x_0: function(v2) {
        self2.x0 = parseFloat(v2);
      },
      y_0: function(v2) {
        self2.y0 = parseFloat(v2);
      },
      k_0: function(v2) {
        self2.k0 = parseFloat(v2);
      },
      k: function(v2) {
        self2.k0 = parseFloat(v2);
      },
      a: function(v2) {
        self2.a = parseFloat(v2);
      },
      b: function(v2) {
        self2.b = parseFloat(v2);
      },
      r_a: function() {
        self2.R_A = true;
      },
      zone: function(v2) {
        self2.zone = parseInt(v2, 10);
      },
      south: function() {
        self2.utmSouth = true;
      },
      towgs84: function(v2) {
        self2.datum_params = v2.split(",").map(function(a) {
          return parseFloat(a);
        });
      },
      to_meter: function(v2) {
        self2.to_meter = parseFloat(v2);
      },
      units: function(v2) {
        self2.units = v2;
        var unit = match(units, v2);
        if (unit) {
          self2.to_meter = unit.to_meter;
        }
      },
      from_greenwich: function(v2) {
        self2.from_greenwich = v2 * D2R$1;
      },
      pm: function(v2) {
        var pm = match(exports$3, v2);
        self2.from_greenwich = (pm ? pm : parseFloat(v2)) * D2R$1;
      },
      nadgrids: function(v2) {
        if (v2 === "@null") {
          self2.datumCode = "none";
        } else {
          self2.nadgrids = v2;
        }
      },
      axis: function(v2) {
        var legalAxis = "ewnsud";
        if (v2.length === 3 && legalAxis.indexOf(v2.substr(0, 1)) !== -1 && legalAxis.indexOf(v2.substr(1, 1)) !== -1 && legalAxis.indexOf(v2.substr(2, 1)) !== -1) {
          self2.axis = v2;
        }
      },
      approx: function() {
        self2.approx = true;
      }
    };
    for (paramName in paramObj) {
      paramVal = paramObj[paramName];
      if (paramName in params2) {
        paramOutname = params2[paramName];
        if (typeof paramOutname === "function") {
          paramOutname(paramVal);
        } else {
          self2[paramOutname] = paramVal;
        }
      } else {
        self2[paramName] = paramVal;
      }
    }
    if (typeof self2.datumCode === "string" && self2.datumCode !== "WGS84") {
      self2.datumCode = self2.datumCode.toLowerCase();
    }
    return self2;
  }
  var NEUTRAL = 1;
  var KEYWORD = 2;
  var NUMBER = 3;
  var QUOTED = 4;
  var AFTERQUOTE = 5;
  var ENDED = -1;
  var whitespace = /\s/;
  var latin = /[A-Za-z]/;
  var keyword = /[A-Za-z84_]/;
  var endThings = /[,\]]/;
  var digets = /[\d\.E\-\+]/;
  function Parser$2(text2) {
    if (typeof text2 !== "string") {
      throw new Error("not a string");
    }
    this.text = text2.trim();
    this.level = 0;
    this.place = 0;
    this.root = null;
    this.stack = [];
    this.currentObject = null;
    this.state = NEUTRAL;
  }
  Parser$2.prototype.readCharicter = function() {
    var char = this.text[this.place++];
    if (this.state !== QUOTED) {
      while (whitespace.test(char)) {
        if (this.place >= this.text.length) {
          return;
        }
        char = this.text[this.place++];
      }
    }
    switch (this.state) {
      case NEUTRAL:
        return this.neutral(char);
      case KEYWORD:
        return this.keyword(char);
      case QUOTED:
        return this.quoted(char);
      case AFTERQUOTE:
        return this.afterquote(char);
      case NUMBER:
        return this.number(char);
      case ENDED:
        return;
    }
  };
  Parser$2.prototype.afterquote = function(char) {
    if (char === '"') {
      this.word += '"';
      this.state = QUOTED;
      return;
    }
    if (endThings.test(char)) {
      this.word = this.word.trim();
      this.afterItem(char);
      return;
    }
    throw new Error(`havn't handled "` + char + '" in afterquote yet, index ' + this.place);
  };
  Parser$2.prototype.afterItem = function(char) {
    if (char === ",") {
      if (this.word !== null) {
        this.currentObject.push(this.word);
      }
      this.word = null;
      this.state = NEUTRAL;
      return;
    }
    if (char === "]") {
      this.level--;
      if (this.word !== null) {
        this.currentObject.push(this.word);
        this.word = null;
      }
      this.state = NEUTRAL;
      this.currentObject = this.stack.pop();
      if (!this.currentObject) {
        this.state = ENDED;
      }
      return;
    }
  };
  Parser$2.prototype.number = function(char) {
    if (digets.test(char)) {
      this.word += char;
      return;
    }
    if (endThings.test(char)) {
      this.word = parseFloat(this.word);
      this.afterItem(char);
      return;
    }
    throw new Error(`havn't handled "` + char + '" in number yet, index ' + this.place);
  };
  Parser$2.prototype.quoted = function(char) {
    if (char === '"') {
      this.state = AFTERQUOTE;
      return;
    }
    this.word += char;
    return;
  };
  Parser$2.prototype.keyword = function(char) {
    if (keyword.test(char)) {
      this.word += char;
      return;
    }
    if (char === "[") {
      var newObjects = [];
      newObjects.push(this.word);
      this.level++;
      if (this.root === null) {
        this.root = newObjects;
      } else {
        this.currentObject.push(newObjects);
      }
      this.stack.push(this.currentObject);
      this.currentObject = newObjects;
      this.state = NEUTRAL;
      return;
    }
    if (endThings.test(char)) {
      this.afterItem(char);
      return;
    }
    throw new Error(`havn't handled "` + char + '" in keyword yet, index ' + this.place);
  };
  Parser$2.prototype.neutral = function(char) {
    if (latin.test(char)) {
      this.word = char;
      this.state = KEYWORD;
      return;
    }
    if (char === '"') {
      this.word = "";
      this.state = QUOTED;
      return;
    }
    if (digets.test(char)) {
      this.word = char;
      this.state = NUMBER;
      return;
    }
    if (endThings.test(char)) {
      this.afterItem(char);
      return;
    }
    throw new Error(`havn't handled "` + char + '" in neutral yet, index ' + this.place);
  };
  Parser$2.prototype.output = function() {
    while (this.place < this.text.length) {
      this.readCharicter();
    }
    if (this.state === ENDED) {
      return this.root;
    }
    throw new Error('unable to parse string "' + this.text + '". State is ' + this.state);
  };
  function parseString(txt) {
    var parser = new Parser$2(txt);
    return parser.output();
  }
  function mapit(obj, key, value) {
    if (Array.isArray(key)) {
      value.unshift(key);
      key = null;
    }
    var thing = key ? {} : obj;
    var out = value.reduce(function(newObj, item) {
      sExpr(item, newObj);
      return newObj;
    }, thing);
    if (key) {
      obj[key] = out;
    }
  }
  function sExpr(v2, obj) {
    if (!Array.isArray(v2)) {
      obj[v2] = true;
      return;
    }
    var key = v2.shift();
    if (key === "PARAMETER") {
      key = v2.shift();
    }
    if (v2.length === 1) {
      if (Array.isArray(v2[0])) {
        obj[key] = {};
        sExpr(v2[0], obj[key]);
        return;
      }
      obj[key] = v2[0];
      return;
    }
    if (!v2.length) {
      obj[key] = true;
      return;
    }
    if (key === "TOWGS84") {
      obj[key] = v2;
      return;
    }
    if (key === "AXIS") {
      if (!(key in obj)) {
        obj[key] = [];
      }
      obj[key].push(v2);
      return;
    }
    if (!Array.isArray(key)) {
      obj[key] = {};
    }
    var i;
    switch (key) {
      case "UNIT":
      case "PRIMEM":
      case "VERT_DATUM":
        obj[key] = {
          name: v2[0].toLowerCase(),
          convert: v2[1]
        };
        if (v2.length === 3) {
          sExpr(v2[2], obj[key]);
        }
        return;
      case "SPHEROID":
      case "ELLIPSOID":
        obj[key] = {
          name: v2[0],
          a: v2[1],
          rf: v2[2]
        };
        if (v2.length === 4) {
          sExpr(v2[3], obj[key]);
        }
        return;
      case "PROJECTEDCRS":
      case "PROJCRS":
      case "GEOGCS":
      case "GEOCCS":
      case "PROJCS":
      case "LOCAL_CS":
      case "GEODCRS":
      case "GEODETICCRS":
      case "GEODETICDATUM":
      case "EDATUM":
      case "ENGINEERINGDATUM":
      case "VERT_CS":
      case "VERTCRS":
      case "VERTICALCRS":
      case "COMPD_CS":
      case "COMPOUNDCRS":
      case "ENGINEERINGCRS":
      case "ENGCRS":
      case "FITTED_CS":
      case "LOCAL_DATUM":
      case "DATUM":
        v2[0] = ["name", v2[0]];
        mapit(obj, key, v2);
        return;
      default:
        i = -1;
        while (++i < v2.length) {
          if (!Array.isArray(v2[i])) {
            return sExpr(v2, obj[key]);
          }
        }
        return mapit(obj, key, v2);
    }
  }
  var D2R = 0.017453292519943295;
  function rename(obj, params2) {
    var outName = params2[0];
    var inName = params2[1];
    if (!(outName in obj) && inName in obj) {
      obj[outName] = obj[inName];
      if (params2.length === 3) {
        obj[outName] = params2[2](obj[outName]);
      }
    }
  }
  function d2r(input) {
    return input * D2R;
  }
  function cleanWKT(wkt2) {
    if (wkt2.type === "GEOGCS") {
      wkt2.projName = "longlat";
    } else if (wkt2.type === "LOCAL_CS") {
      wkt2.projName = "identity";
      wkt2.local = true;
    } else {
      if (typeof wkt2.PROJECTION === "object") {
        wkt2.projName = Object.keys(wkt2.PROJECTION)[0];
      } else {
        wkt2.projName = wkt2.PROJECTION;
      }
    }
    if (wkt2.AXIS) {
      var axisOrder = "";
      for (var i = 0, ii = wkt2.AXIS.length; i < ii; ++i) {
        var axis = [wkt2.AXIS[i][0].toLowerCase(), wkt2.AXIS[i][1].toLowerCase()];
        if (axis[0].indexOf("north") !== -1 || (axis[0] === "y" || axis[0] === "lat") && axis[1] === "north") {
          axisOrder += "n";
        } else if (axis[0].indexOf("south") !== -1 || (axis[0] === "y" || axis[0] === "lat") && axis[1] === "south") {
          axisOrder += "s";
        } else if (axis[0].indexOf("east") !== -1 || (axis[0] === "x" || axis[0] === "lon") && axis[1] === "east") {
          axisOrder += "e";
        } else if (axis[0].indexOf("west") !== -1 || (axis[0] === "x" || axis[0] === "lon") && axis[1] === "west") {
          axisOrder += "w";
        }
      }
      if (axisOrder.length === 2) {
        axisOrder += "u";
      }
      if (axisOrder.length === 3) {
        wkt2.axis = axisOrder;
      }
    }
    if (wkt2.UNIT) {
      wkt2.units = wkt2.UNIT.name.toLowerCase();
      if (wkt2.units === "metre") {
        wkt2.units = "meter";
      }
      if (wkt2.UNIT.convert) {
        if (wkt2.type === "GEOGCS") {
          if (wkt2.DATUM && wkt2.DATUM.SPHEROID) {
            wkt2.to_meter = wkt2.UNIT.convert * wkt2.DATUM.SPHEROID.a;
          }
        } else {
          wkt2.to_meter = wkt2.UNIT.convert;
        }
      }
    }
    var geogcs = wkt2.GEOGCS;
    if (wkt2.type === "GEOGCS") {
      geogcs = wkt2;
    }
    if (geogcs) {
      if (geogcs.DATUM) {
        wkt2.datumCode = geogcs.DATUM.name.toLowerCase();
      } else {
        wkt2.datumCode = geogcs.name.toLowerCase();
      }
      if (wkt2.datumCode.slice(0, 2) === "d_") {
        wkt2.datumCode = wkt2.datumCode.slice(2);
      }
      if (wkt2.datumCode === "new_zealand_geodetic_datum_1949" || wkt2.datumCode === "new_zealand_1949") {
        wkt2.datumCode = "nzgd49";
      }
      if (wkt2.datumCode === "wgs_1984" || wkt2.datumCode === "world_geodetic_system_1984") {
        if (wkt2.PROJECTION === "Mercator_Auxiliary_Sphere") {
          wkt2.sphere = true;
        }
        wkt2.datumCode = "wgs84";
      }
      if (wkt2.datumCode.slice(-6) === "_ferro") {
        wkt2.datumCode = wkt2.datumCode.slice(0, -6);
      }
      if (wkt2.datumCode.slice(-8) === "_jakarta") {
        wkt2.datumCode = wkt2.datumCode.slice(0, -8);
      }
      if (~wkt2.datumCode.indexOf("belge")) {
        wkt2.datumCode = "rnb72";
      }
      if (geogcs.DATUM && geogcs.DATUM.SPHEROID) {
        wkt2.ellps = geogcs.DATUM.SPHEROID.name.replace("_19", "").replace(/[Cc]larke\_18/, "clrk");
        if (wkt2.ellps.toLowerCase().slice(0, 13) === "international") {
          wkt2.ellps = "intl";
        }
        wkt2.a = geogcs.DATUM.SPHEROID.a;
        wkt2.rf = parseFloat(geogcs.DATUM.SPHEROID.rf, 10);
      }
      if (geogcs.DATUM && geogcs.DATUM.TOWGS84) {
        wkt2.datum_params = geogcs.DATUM.TOWGS84;
      }
      if (~wkt2.datumCode.indexOf("osgb_1936")) {
        wkt2.datumCode = "osgb36";
      }
      if (~wkt2.datumCode.indexOf("osni_1952")) {
        wkt2.datumCode = "osni52";
      }
      if (~wkt2.datumCode.indexOf("tm65") || ~wkt2.datumCode.indexOf("geodetic_datum_of_1965")) {
        wkt2.datumCode = "ire65";
      }
      if (wkt2.datumCode === "ch1903+") {
        wkt2.datumCode = "ch1903";
      }
      if (~wkt2.datumCode.indexOf("israel")) {
        wkt2.datumCode = "isr93";
      }
    }
    if (wkt2.b && !isFinite(wkt2.b)) {
      wkt2.b = wkt2.a;
    }
    function toMeter(input) {
      var ratio = wkt2.to_meter || 1;
      return input * ratio;
    }
    var renamer = function(a) {
      return rename(wkt2, a);
    };
    var list = [
      ["standard_parallel_1", "Standard_Parallel_1"],
      ["standard_parallel_1", "Latitude of 1st standard parallel"],
      ["standard_parallel_2", "Standard_Parallel_2"],
      ["standard_parallel_2", "Latitude of 2nd standard parallel"],
      ["false_easting", "False_Easting"],
      ["false_easting", "False easting"],
      ["false-easting", "Easting at false origin"],
      ["false_northing", "False_Northing"],
      ["false_northing", "False northing"],
      ["false_northing", "Northing at false origin"],
      ["central_meridian", "Central_Meridian"],
      ["central_meridian", "Longitude of natural origin"],
      ["central_meridian", "Longitude of false origin"],
      ["latitude_of_origin", "Latitude_Of_Origin"],
      ["latitude_of_origin", "Central_Parallel"],
      ["latitude_of_origin", "Latitude of natural origin"],
      ["latitude_of_origin", "Latitude of false origin"],
      ["scale_factor", "Scale_Factor"],
      ["k0", "scale_factor"],
      ["latitude_of_center", "Latitude_Of_Center"],
      ["latitude_of_center", "Latitude_of_center"],
      ["lat0", "latitude_of_center", d2r],
      ["longitude_of_center", "Longitude_Of_Center"],
      ["longitude_of_center", "Longitude_of_center"],
      ["longc", "longitude_of_center", d2r],
      ["x0", "false_easting", toMeter],
      ["y0", "false_northing", toMeter],
      ["long0", "central_meridian", d2r],
      ["lat0", "latitude_of_origin", d2r],
      ["lat0", "standard_parallel_1", d2r],
      ["lat1", "standard_parallel_1", d2r],
      ["lat2", "standard_parallel_2", d2r],
      ["azimuth", "Azimuth"],
      ["alpha", "azimuth", d2r],
      ["srsCode", "name"]
    ];
    list.forEach(renamer);
    if (!wkt2.long0 && wkt2.longc && (wkt2.projName === "Albers_Conic_Equal_Area" || wkt2.projName === "Lambert_Azimuthal_Equal_Area")) {
      wkt2.long0 = wkt2.longc;
    }
    if (!wkt2.lat_ts && wkt2.lat1 && (wkt2.projName === "Stereographic_South_Pole" || wkt2.projName === "Polar Stereographic (variant B)")) {
      wkt2.lat0 = d2r(wkt2.lat1 > 0 ? 90 : -90);
      wkt2.lat_ts = wkt2.lat1;
    }
  }
  function wkt(wkt2) {
    var lisp = parseString(wkt2);
    var type = lisp.shift();
    var name = lisp.shift();
    lisp.unshift(["name", name]);
    lisp.unshift(["type", type]);
    var obj = {};
    sExpr(lisp, obj);
    cleanWKT(obj);
    return obj;
  }
  function defs(name) {
    var that = this;
    if (arguments.length === 2) {
      var def = arguments[1];
      if (typeof def === "string") {
        if (def.charAt(0) === "+") {
          defs[name] = projStr(arguments[1]);
        } else {
          defs[name] = wkt(arguments[1]);
        }
      } else {
        defs[name] = def;
      }
    } else if (arguments.length === 1) {
      if (Array.isArray(name)) {
        return name.map(function(v2) {
          if (Array.isArray(v2)) {
            defs.apply(that, v2);
          } else {
            defs(v2);
          }
        });
      } else if (typeof name === "string") {
        if (name in defs) {
          return defs[name];
        }
      } else if ("EPSG" in name) {
        defs["EPSG:" + name.EPSG] = name;
      } else if ("ESRI" in name) {
        defs["ESRI:" + name.ESRI] = name;
      } else if ("IAU2000" in name) {
        defs["IAU2000:" + name.IAU2000] = name;
      } else {
        console.log(name);
      }
      return;
    }
  }
  globals(defs);
  function testObj(code) {
    return typeof code === "string";
  }
  function testDef(code) {
    return code in defs;
  }
  var codeWords = ["PROJECTEDCRS", "PROJCRS", "GEOGCS", "GEOCCS", "PROJCS", "LOCAL_CS", "GEODCRS", "GEODETICCRS", "GEODETICDATUM", "ENGCRS", "ENGINEERINGCRS"];
  function testWKT(code) {
    return codeWords.some(function(word) {
      return code.indexOf(word) > -1;
    });
  }
  var codes = ["3857", "900913", "3785", "102113"];
  function checkMercator(item) {
    var auth = match(item, "authority");
    if (!auth) {
      return;
    }
    var code = match(auth, "epsg");
    return code && codes.indexOf(code) > -1;
  }
  function checkProjStr(item) {
    var ext = match(item, "extension");
    if (!ext) {
      return;
    }
    return match(ext, "proj4");
  }
  function testProj(code) {
    return code[0] === "+";
  }
  function parse$1(code) {
    if (testObj(code)) {
      if (testDef(code)) {
        return defs[code];
      }
      if (testWKT(code)) {
        var out = wkt(code);
        if (checkMercator(out)) {
          return defs["EPSG:3857"];
        }
        var maybeProjStr = checkProjStr(out);
        if (maybeProjStr) {
          return projStr(maybeProjStr);
        }
        return out;
      }
      if (testProj(code)) {
        return projStr(code);
      }
    } else {
      return code;
    }
  }
  function extend$2(destination, source) {
    destination = destination || {};
    var value, property;
    if (!source) {
      return destination;
    }
    for (property in source) {
      value = source[property];
      if (value !== void 0) {
        destination[property] = value;
      }
    }
    return destination;
  }
  function msfnz(eccent, sinphi, cosphi) {
    var con = eccent * sinphi;
    return cosphi / Math.sqrt(1 - con * con);
  }
  function sign(x) {
    return x < 0 ? -1 : 1;
  }
  function adjust_lon(x) {
    return Math.abs(x) <= SPI ? x : x - sign(x) * TWO_PI;
  }
  function tsfnz(eccent, phi, sinphi) {
    var con = eccent * sinphi;
    var com = 0.5 * eccent;
    con = Math.pow((1 - con) / (1 + con), com);
    return Math.tan(0.5 * (HALF_PI - phi)) / con;
  }
  function phi2z(eccent, ts) {
    var eccnth = 0.5 * eccent;
    var con, dphi;
    var phi = HALF_PI - 2 * Math.atan(ts);
    for (var i = 0; i <= 15; i++) {
      con = eccent * Math.sin(phi);
      dphi = HALF_PI - 2 * Math.atan(ts * Math.pow((1 - con) / (1 + con), eccnth)) - phi;
      phi += dphi;
      if (Math.abs(dphi) <= 1e-10) {
        return phi;
      }
    }
    return -9999;
  }
  function init$v() {
    var con = this.b / this.a;
    this.es = 1 - con * con;
    if (!("x0" in this)) {
      this.x0 = 0;
    }
    if (!("y0" in this)) {
      this.y0 = 0;
    }
    this.e = Math.sqrt(this.es);
    if (this.lat_ts) {
      if (this.sphere) {
        this.k0 = Math.cos(this.lat_ts);
      } else {
        this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));
      }
    } else {
      if (!this.k0) {
        if (this.k) {
          this.k0 = this.k;
        } else {
          this.k0 = 1;
        }
      }
    }
  }
  function forward$u(p2) {
    var lon = p2.x;
    var lat = p2.y;
    if (lat * R2D > 90 && lat * R2D < -90 && lon * R2D > 180 && lon * R2D < -180) {
      return null;
    }
    var x, y2;
    if (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {
      return null;
    } else {
      if (this.sphere) {
        x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);
        y2 = this.y0 + this.a * this.k0 * Math.log(Math.tan(FORTPI + 0.5 * lat));
      } else {
        var sinphi = Math.sin(lat);
        var ts = tsfnz(this.e, lat, sinphi);
        x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);
        y2 = this.y0 - this.a * this.k0 * Math.log(ts);
      }
      p2.x = x;
      p2.y = y2;
      return p2;
    }
  }
  function inverse$u(p2) {
    var x = p2.x - this.x0;
    var y2 = p2.y - this.y0;
    var lon, lat;
    if (this.sphere) {
      lat = HALF_PI - 2 * Math.atan(Math.exp(-y2 / (this.a * this.k0)));
    } else {
      var ts = Math.exp(-y2 / (this.a * this.k0));
      lat = phi2z(this.e, ts);
      if (lat === -9999) {
        return null;
      }
    }
    lon = adjust_lon(this.long0 + x / (this.a * this.k0));
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  var names$w = ["Mercator", "Popular Visualisation Pseudo Mercator", "Mercator_1SP", "Mercator_Auxiliary_Sphere", "merc"];
  const merc = {
    init: init$v,
    forward: forward$u,
    inverse: inverse$u,
    names: names$w
  };
  function init$u() {
  }
  function identity(pt) {
    return pt;
  }
  var names$v = ["longlat", "identity"];
  const longlat = {
    init: init$u,
    forward: identity,
    inverse: identity,
    names: names$v
  };
  var projs = [merc, longlat];
  var names$u = {};
  var projStore = [];
  function add(proj, i) {
    var len = projStore.length;
    if (!proj.names) {
      console.log(i);
      return true;
    }
    projStore[len] = proj;
    proj.names.forEach(function(n) {
      names$u[n.toLowerCase()] = len;
    });
    return this;
  }
  function get$1(name) {
    if (!name) {
      return false;
    }
    var n = name.toLowerCase();
    if (typeof names$u[n] !== "undefined" && projStore[names$u[n]]) {
      return projStore[names$u[n]];
    }
  }
  function start() {
    projs.forEach(add);
  }
  const projections = {
    start,
    add,
    get: get$1
  };
  var exports$2 = {};
  exports$2.MERIT = {
    a: 6378137,
    rf: 298.257,
    ellipseName: "MERIT 1983"
  };
  exports$2.SGS85 = {
    a: 6378136,
    rf: 298.257,
    ellipseName: "Soviet Geodetic System 85"
  };
  exports$2.GRS80 = {
    a: 6378137,
    rf: 298.257222101,
    ellipseName: "GRS 1980(IUGG, 1980)"
  };
  exports$2.IAU76 = {
    a: 6378140,
    rf: 298.257,
    ellipseName: "IAU 1976"
  };
  exports$2.airy = {
    a: 6377563396e-3,
    b: 635625691e-2,
    ellipseName: "Airy 1830"
  };
  exports$2.APL4 = {
    a: 6378137,
    rf: 298.25,
    ellipseName: "Appl. Physics. 1965"
  };
  exports$2.NWL9D = {
    a: 6378145,
    rf: 298.25,
    ellipseName: "Naval Weapons Lab., 1965"
  };
  exports$2.mod_airy = {
    a: 6377340189e-3,
    b: 6356034446e-3,
    ellipseName: "Modified Airy"
  };
  exports$2.andrae = {
    a: 637710443e-2,
    rf: 300,
    ellipseName: "Andrae 1876 (Den., Iclnd.)"
  };
  exports$2.aust_SA = {
    a: 6378160,
    rf: 298.25,
    ellipseName: "Australian Natl & S. Amer. 1969"
  };
  exports$2.GRS67 = {
    a: 6378160,
    rf: 298.247167427,
    ellipseName: "GRS 67(IUGG 1967)"
  };
  exports$2.bessel = {
    a: 6377397155e-3,
    rf: 299.1528128,
    ellipseName: "Bessel 1841"
  };
  exports$2.bess_nam = {
    a: 6377483865e-3,
    rf: 299.1528128,
    ellipseName: "Bessel 1841 (Namibia)"
  };
  exports$2.clrk66 = {
    a: 63782064e-1,
    b: 63565838e-1,
    ellipseName: "Clarke 1866"
  };
  exports$2.clrk80 = {
    a: 6378249145e-3,
    rf: 293.4663,
    ellipseName: "Clarke 1880 mod."
  };
  exports$2.clrk58 = {
    a: 6378293645208759e-9,
    rf: 294.2606763692654,
    ellipseName: "Clarke 1858"
  };
  exports$2.CPM = {
    a: 63757387e-1,
    rf: 334.29,
    ellipseName: "Comm. des Poids et Mesures 1799"
  };
  exports$2.delmbr = {
    a: 6376428,
    rf: 311.5,
    ellipseName: "Delambre 1810 (Belgium)"
  };
  exports$2.engelis = {
    a: 637813605e-2,
    rf: 298.2566,
    ellipseName: "Engelis 1985"
  };
  exports$2.evrst30 = {
    a: 6377276345e-3,
    rf: 300.8017,
    ellipseName: "Everest 1830"
  };
  exports$2.evrst48 = {
    a: 6377304063e-3,
    rf: 300.8017,
    ellipseName: "Everest 1948"
  };
  exports$2.evrst56 = {
    a: 6377301243e-3,
    rf: 300.8017,
    ellipseName: "Everest 1956"
  };
  exports$2.evrst69 = {
    a: 6377295664e-3,
    rf: 300.8017,
    ellipseName: "Everest 1969"
  };
  exports$2.evrstSS = {
    a: 6377298556e-3,
    rf: 300.8017,
    ellipseName: "Everest (Sabah & Sarawak)"
  };
  exports$2.fschr60 = {
    a: 6378166,
    rf: 298.3,
    ellipseName: "Fischer (Mercury Datum) 1960"
  };
  exports$2.fschr60m = {
    a: 6378155,
    rf: 298.3,
    ellipseName: "Fischer 1960"
  };
  exports$2.fschr68 = {
    a: 6378150,
    rf: 298.3,
    ellipseName: "Fischer 1968"
  };
  exports$2.helmert = {
    a: 6378200,
    rf: 298.3,
    ellipseName: "Helmert 1906"
  };
  exports$2.hough = {
    a: 6378270,
    rf: 297,
    ellipseName: "Hough"
  };
  exports$2.intl = {
    a: 6378388,
    rf: 297,
    ellipseName: "International 1909 (Hayford)"
  };
  exports$2.kaula = {
    a: 6378163,
    rf: 298.24,
    ellipseName: "Kaula 1961"
  };
  exports$2.lerch = {
    a: 6378139,
    rf: 298.257,
    ellipseName: "Lerch 1979"
  };
  exports$2.mprts = {
    a: 6397300,
    rf: 191,
    ellipseName: "Maupertius 1738"
  };
  exports$2.new_intl = {
    a: 63781575e-1,
    b: 63567722e-1,
    ellipseName: "New International 1967"
  };
  exports$2.plessis = {
    a: 6376523,
    rf: 6355863,
    ellipseName: "Plessis 1817 (France)"
  };
  exports$2.krass = {
    a: 6378245,
    rf: 298.3,
    ellipseName: "Krassovsky, 1942"
  };
  exports$2.SEasia = {
    a: 6378155,
    b: 63567733205e-4,
    ellipseName: "Southeast Asia"
  };
  exports$2.walbeck = {
    a: 6376896,
    b: 63558348467e-4,
    ellipseName: "Walbeck"
  };
  exports$2.WGS60 = {
    a: 6378165,
    rf: 298.3,
    ellipseName: "WGS 60"
  };
  exports$2.WGS66 = {
    a: 6378145,
    rf: 298.25,
    ellipseName: "WGS 66"
  };
  exports$2.WGS7 = {
    a: 6378135,
    rf: 298.26,
    ellipseName: "WGS 72"
  };
  var WGS84 = exports$2.WGS84 = {
    a: 6378137,
    rf: 298.257223563,
    ellipseName: "WGS 84"
  };
  exports$2.sphere = {
    a: 6370997,
    b: 6370997,
    ellipseName: "Normal Sphere (r=6370997)"
  };
  function eccentricity(a, b, rf, R_A) {
    var a2 = a * a;
    var b2 = b * b;
    var es = (a2 - b2) / a2;
    var e = 0;
    if (R_A) {
      a *= 1 - es * (SIXTH + es * (RA4 + es * RA6));
      a2 = a * a;
      es = 0;
    } else {
      e = Math.sqrt(es);
    }
    var ep2 = (a2 - b2) / b2;
    return {
      es,
      e,
      ep2
    };
  }
  function sphere(a, b, rf, ellps, sphere2) {
    if (!a) {
      var ellipse = match(exports$2, ellps);
      if (!ellipse) {
        ellipse = WGS84;
      }
      a = ellipse.a;
      b = ellipse.b;
      rf = ellipse.rf;
    }
    if (rf && !b) {
      b = (1 - 1 / rf) * a;
    }
    if (rf === 0 || Math.abs(a - b) < EPSLN) {
      sphere2 = true;
      b = a;
    }
    return {
      a,
      b,
      rf,
      sphere: sphere2
    };
  }
  var exports$1 = {};
  exports$1.wgs84 = {
    towgs84: "0,0,0",
    ellipse: "WGS84",
    datumName: "WGS84"
  };
  exports$1.ch1903 = {
    towgs84: "674.374,15.056,405.346",
    ellipse: "bessel",
    datumName: "swiss"
  };
  exports$1.ggrs87 = {
    towgs84: "-199.87,74.79,246.62",
    ellipse: "GRS80",
    datumName: "Greek_Geodetic_Reference_System_1987"
  };
  exports$1.nad83 = {
    towgs84: "0,0,0",
    ellipse: "GRS80",
    datumName: "North_American_Datum_1983"
  };
  exports$1.nad27 = {
    nadgrids: "@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",
    ellipse: "clrk66",
    datumName: "North_American_Datum_1927"
  };
  exports$1.potsdam = {
    towgs84: "598.1,73.7,418.2,0.202,0.045,-2.455,6.7",
    ellipse: "bessel",
    datumName: "Potsdam Rauenberg 1950 DHDN"
  };
  exports$1.carthage = {
    towgs84: "-263.0,6.0,431.0",
    ellipse: "clark80",
    datumName: "Carthage 1934 Tunisia"
  };
  exports$1.hermannskogel = {
    towgs84: "577.326,90.129,463.919,5.137,1.474,5.297,2.4232",
    ellipse: "bessel",
    datumName: "Hermannskogel"
  };
  exports$1.osni52 = {
    towgs84: "482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",
    ellipse: "airy",
    datumName: "Irish National"
  };
  exports$1.ire65 = {
    towgs84: "482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",
    ellipse: "mod_airy",
    datumName: "Ireland 1965"
  };
  exports$1.rassadiran = {
    towgs84: "-133.63,-157.5,-158.62",
    ellipse: "intl",
    datumName: "Rassadiran"
  };
  exports$1.nzgd49 = {
    towgs84: "59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",
    ellipse: "intl",
    datumName: "New Zealand Geodetic Datum 1949"
  };
  exports$1.osgb36 = {
    towgs84: "446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",
    ellipse: "airy",
    datumName: "Airy 1830"
  };
  exports$1.s_jtsk = {
    towgs84: "589,76,480",
    ellipse: "bessel",
    datumName: "S-JTSK (Ferro)"
  };
  exports$1.beduaram = {
    towgs84: "-106,-87,188",
    ellipse: "clrk80",
    datumName: "Beduaram"
  };
  exports$1.gunung_segara = {
    towgs84: "-403,684,41",
    ellipse: "bessel",
    datumName: "Gunung Segara Jakarta"
  };
  exports$1.rnb72 = {
    towgs84: "106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",
    ellipse: "intl",
    datumName: "Reseau National Belge 1972"
  };
  function datum(datumCode, datum_params, a, b, es, ep2, nadgrids) {
    var out = {};
    if (datumCode === void 0 || datumCode === "none") {
      out.datum_type = PJD_NODATUM;
    } else {
      out.datum_type = PJD_WGS84;
    }
    if (datum_params) {
      out.datum_params = datum_params.map(parseFloat);
      if (out.datum_params[0] !== 0 || out.datum_params[1] !== 0 || out.datum_params[2] !== 0) {
        out.datum_type = PJD_3PARAM;
      }
      if (out.datum_params.length > 3) {
        if (out.datum_params[3] !== 0 || out.datum_params[4] !== 0 || out.datum_params[5] !== 0 || out.datum_params[6] !== 0) {
          out.datum_type = PJD_7PARAM;
          out.datum_params[3] *= SEC_TO_RAD;
          out.datum_params[4] *= SEC_TO_RAD;
          out.datum_params[5] *= SEC_TO_RAD;
          out.datum_params[6] = out.datum_params[6] / 1e6 + 1;
        }
      }
    }
    if (nadgrids) {
      out.datum_type = PJD_GRIDSHIFT;
      out.grids = nadgrids;
    }
    out.a = a;
    out.b = b;
    out.es = es;
    out.ep2 = ep2;
    return out;
  }
  var loadedNadgrids = {};
  function nadgrid(key, data) {
    var view = new DataView(data);
    var isLittleEndian = detectLittleEndian(view);
    var header = readHeader(view, isLittleEndian);
    if (header.nSubgrids > 1) {
      console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");
    }
    var subgrids = readSubgrids(view, header, isLittleEndian);
    var nadgrid2 = { header, subgrids };
    loadedNadgrids[key] = nadgrid2;
    return nadgrid2;
  }
  function getNadgrids(nadgrids) {
    if (nadgrids === void 0) {
      return null;
    }
    var grids = nadgrids.split(",");
    return grids.map(parseNadgridString);
  }
  function parseNadgridString(value) {
    if (value.length === 0) {
      return null;
    }
    var optional = value[0] === "@";
    if (optional) {
      value = value.slice(1);
    }
    if (value === "null") {
      return { name: "null", mandatory: !optional, grid: null, isNull: true };
    }
    return {
      name: value,
      mandatory: !optional,
      grid: loadedNadgrids[value] || null,
      isNull: false
    };
  }
  function secondsToRadians(seconds) {
    return seconds / 3600 * Math.PI / 180;
  }
  function detectLittleEndian(view) {
    var nFields = view.getInt32(8, false);
    if (nFields === 11) {
      return false;
    }
    nFields = view.getInt32(8, true);
    if (nFields !== 11) {
      console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian");
    }
    return true;
  }
  function readHeader(view, isLittleEndian) {
    return {
      nFields: view.getInt32(8, isLittleEndian),
      nSubgridFields: view.getInt32(24, isLittleEndian),
      nSubgrids: view.getInt32(40, isLittleEndian),
      shiftType: decodeString$1(view, 56, 56 + 8).trim(),
      fromSemiMajorAxis: view.getFloat64(120, isLittleEndian),
      fromSemiMinorAxis: view.getFloat64(136, isLittleEndian),
      toSemiMajorAxis: view.getFloat64(152, isLittleEndian),
      toSemiMinorAxis: view.getFloat64(168, isLittleEndian)
    };
  }
  function decodeString$1(view, start2, end) {
    return String.fromCharCode.apply(null, new Uint8Array(view.buffer.slice(start2, end)));
  }
  function readSubgrids(view, header, isLittleEndian) {
    var gridOffset = 176;
    var grids = [];
    for (var i = 0; i < header.nSubgrids; i++) {
      var subHeader = readGridHeader(view, gridOffset, isLittleEndian);
      var nodes = readGridNodes(view, gridOffset, subHeader, isLittleEndian);
      var lngColumnCount = Math.round(
        1 + (subHeader.upperLongitude - subHeader.lowerLongitude) / subHeader.longitudeInterval
      );
      var latColumnCount = Math.round(
        1 + (subHeader.upperLatitude - subHeader.lowerLatitude) / subHeader.latitudeInterval
      );
      grids.push({
        ll: [secondsToRadians(subHeader.lowerLongitude), secondsToRadians(subHeader.lowerLatitude)],
        del: [secondsToRadians(subHeader.longitudeInterval), secondsToRadians(subHeader.latitudeInterval)],
        lim: [lngColumnCount, latColumnCount],
        count: subHeader.gridNodeCount,
        cvs: mapNodes(nodes)
      });
    }
    return grids;
  }
  function mapNodes(nodes) {
    return nodes.map(function(r) {
      return [secondsToRadians(r.longitudeShift), secondsToRadians(r.latitudeShift)];
    });
  }
  function readGridHeader(view, offset, isLittleEndian) {
    return {
      name: decodeString$1(view, offset + 8, offset + 16).trim(),
      parent: decodeString$1(view, offset + 24, offset + 24 + 8).trim(),
      lowerLatitude: view.getFloat64(offset + 72, isLittleEndian),
      upperLatitude: view.getFloat64(offset + 88, isLittleEndian),
      lowerLongitude: view.getFloat64(offset + 104, isLittleEndian),
      upperLongitude: view.getFloat64(offset + 120, isLittleEndian),
      latitudeInterval: view.getFloat64(offset + 136, isLittleEndian),
      longitudeInterval: view.getFloat64(offset + 152, isLittleEndian),
      gridNodeCount: view.getInt32(offset + 168, isLittleEndian)
    };
  }
  function readGridNodes(view, offset, gridHeader, isLittleEndian) {
    var nodesOffset = offset + 176;
    var gridRecordLength = 16;
    var gridShiftRecords = [];
    for (var i = 0; i < gridHeader.gridNodeCount; i++) {
      var record = {
        latitudeShift: view.getFloat32(nodesOffset + i * gridRecordLength, isLittleEndian),
        longitudeShift: view.getFloat32(nodesOffset + i * gridRecordLength + 4, isLittleEndian),
        latitudeAccuracy: view.getFloat32(nodesOffset + i * gridRecordLength + 8, isLittleEndian),
        longitudeAccuracy: view.getFloat32(nodesOffset + i * gridRecordLength + 12, isLittleEndian)
      };
      gridShiftRecords.push(record);
    }
    return gridShiftRecords;
  }
  function Projection(srsCode, callback) {
    if (!(this instanceof Projection)) {
      return new Projection(srsCode);
    }
    callback = callback || function(error) {
      if (error) {
        throw error;
      }
    };
    var json = parse$1(srsCode);
    if (typeof json !== "object") {
      callback(srsCode);
      return;
    }
    var ourProj = Projection.projections.get(json.projName);
    if (!ourProj) {
      callback(srsCode);
      return;
    }
    if (json.datumCode && json.datumCode !== "none") {
      var datumDef = match(exports$1, json.datumCode);
      if (datumDef) {
        json.datum_params = json.datum_params || (datumDef.towgs84 ? datumDef.towgs84.split(",") : null);
        json.ellps = datumDef.ellipse;
        json.datumName = datumDef.datumName ? datumDef.datumName : json.datumCode;
      }
    }
    json.k0 = json.k0 || 1;
    json.axis = json.axis || "enu";
    json.ellps = json.ellps || "wgs84";
    json.lat1 = json.lat1 || json.lat0;
    var sphere_ = sphere(json.a, json.b, json.rf, json.ellps, json.sphere);
    var ecc = eccentricity(sphere_.a, sphere_.b, sphere_.rf, json.R_A);
    var nadgrids = getNadgrids(json.nadgrids);
    var datumObj = json.datum || datum(
      json.datumCode,
      json.datum_params,
      sphere_.a,
      sphere_.b,
      ecc.es,
      ecc.ep2,
      nadgrids
    );
    extend$2(this, json);
    extend$2(this, ourProj);
    this.a = sphere_.a;
    this.b = sphere_.b;
    this.rf = sphere_.rf;
    this.sphere = sphere_.sphere;
    this.es = ecc.es;
    this.e = ecc.e;
    this.ep2 = ecc.ep2;
    this.datum = datumObj;
    this.init();
    callback(null, this);
  }
  Projection.projections = projections;
  Projection.projections.start();
  function compareDatums(source, dest) {
    if (source.datum_type !== dest.datum_type) {
      return false;
    } else if (source.a !== dest.a || Math.abs(source.es - dest.es) > 5e-11) {
      return false;
    } else if (source.datum_type === PJD_3PARAM) {
      return source.datum_params[0] === dest.datum_params[0] && source.datum_params[1] === dest.datum_params[1] && source.datum_params[2] === dest.datum_params[2];
    } else if (source.datum_type === PJD_7PARAM) {
      return source.datum_params[0] === dest.datum_params[0] && source.datum_params[1] === dest.datum_params[1] && source.datum_params[2] === dest.datum_params[2] && source.datum_params[3] === dest.datum_params[3] && source.datum_params[4] === dest.datum_params[4] && source.datum_params[5] === dest.datum_params[5] && source.datum_params[6] === dest.datum_params[6];
    } else {
      return true;
    }
  }
  function geodeticToGeocentric(p2, es, a) {
    var Longitude = p2.x;
    var Latitude = p2.y;
    var Height = p2.z ? p2.z : 0;
    var Rn;
    var Sin_Lat;
    var Sin2_Lat;
    var Cos_Lat;
    if (Latitude < -HALF_PI && Latitude > -1.001 * HALF_PI) {
      Latitude = -HALF_PI;
    } else if (Latitude > HALF_PI && Latitude < 1.001 * HALF_PI) {
      Latitude = HALF_PI;
    } else if (Latitude < -HALF_PI) {
      return { x: -Infinity, y: -Infinity, z: p2.z };
    } else if (Latitude > HALF_PI) {
      return { x: Infinity, y: Infinity, z: p2.z };
    }
    if (Longitude > Math.PI) {
      Longitude -= 2 * Math.PI;
    }
    Sin_Lat = Math.sin(Latitude);
    Cos_Lat = Math.cos(Latitude);
    Sin2_Lat = Sin_Lat * Sin_Lat;
    Rn = a / Math.sqrt(1 - es * Sin2_Lat);
    return {
      x: (Rn + Height) * Cos_Lat * Math.cos(Longitude),
      y: (Rn + Height) * Cos_Lat * Math.sin(Longitude),
      z: (Rn * (1 - es) + Height) * Sin_Lat
    };
  }
  function geocentricToGeodetic(p2, es, a, b) {
    var genau = 1e-12;
    var genau2 = genau * genau;
    var maxiter = 30;
    var P;
    var RR;
    var CT;
    var ST;
    var RX;
    var RK;
    var RN;
    var CPHI0;
    var SPHI0;
    var CPHI;
    var SPHI;
    var SDPHI;
    var iter;
    var X = p2.x;
    var Y = p2.y;
    var Z2 = p2.z ? p2.z : 0;
    var Longitude;
    var Latitude;
    var Height;
    P = Math.sqrt(X * X + Y * Y);
    RR = Math.sqrt(X * X + Y * Y + Z2 * Z2);
    if (P / a < genau) {
      Longitude = 0;
      if (RR / a < genau) {
        Latitude = HALF_PI;
        Height = -b;
        return {
          x: p2.x,
          y: p2.y,
          z: p2.z
        };
      }
    } else {
      Longitude = Math.atan2(Y, X);
    }
    CT = Z2 / RR;
    ST = P / RR;
    RX = 1 / Math.sqrt(1 - es * (2 - es) * ST * ST);
    CPHI0 = ST * (1 - es) * RX;
    SPHI0 = CT * RX;
    iter = 0;
    do {
      iter++;
      RN = a / Math.sqrt(1 - es * SPHI0 * SPHI0);
      Height = P * CPHI0 + Z2 * SPHI0 - RN * (1 - es * SPHI0 * SPHI0);
      RK = es * RN / (RN + Height);
      RX = 1 / Math.sqrt(1 - RK * (2 - RK) * ST * ST);
      CPHI = ST * (1 - RK) * RX;
      SPHI = CT * RX;
      SDPHI = SPHI * CPHI0 - CPHI * SPHI0;
      CPHI0 = CPHI;
      SPHI0 = SPHI;
    } while (SDPHI * SDPHI > genau2 && iter < maxiter);
    Latitude = Math.atan(SPHI / Math.abs(CPHI));
    return {
      x: Longitude,
      y: Latitude,
      z: Height
    };
  }
  function geocentricToWgs84(p2, datum_type, datum_params) {
    if (datum_type === PJD_3PARAM) {
      return {
        x: p2.x + datum_params[0],
        y: p2.y + datum_params[1],
        z: p2.z + datum_params[2]
      };
    } else if (datum_type === PJD_7PARAM) {
      var Dx_BF = datum_params[0];
      var Dy_BF = datum_params[1];
      var Dz_BF = datum_params[2];
      var Rx_BF = datum_params[3];
      var Ry_BF = datum_params[4];
      var Rz_BF = datum_params[5];
      var M_BF = datum_params[6];
      return {
        x: M_BF * (p2.x - Rz_BF * p2.y + Ry_BF * p2.z) + Dx_BF,
        y: M_BF * (Rz_BF * p2.x + p2.y - Rx_BF * p2.z) + Dy_BF,
        z: M_BF * (-Ry_BF * p2.x + Rx_BF * p2.y + p2.z) + Dz_BF
      };
    }
  }
  function geocentricFromWgs84(p2, datum_type, datum_params) {
    if (datum_type === PJD_3PARAM) {
      return {
        x: p2.x - datum_params[0],
        y: p2.y - datum_params[1],
        z: p2.z - datum_params[2]
      };
    } else if (datum_type === PJD_7PARAM) {
      var Dx_BF = datum_params[0];
      var Dy_BF = datum_params[1];
      var Dz_BF = datum_params[2];
      var Rx_BF = datum_params[3];
      var Ry_BF = datum_params[4];
      var Rz_BF = datum_params[5];
      var M_BF = datum_params[6];
      var x_tmp = (p2.x - Dx_BF) / M_BF;
      var y_tmp = (p2.y - Dy_BF) / M_BF;
      var z_tmp = (p2.z - Dz_BF) / M_BF;
      return {
        x: x_tmp + Rz_BF * y_tmp - Ry_BF * z_tmp,
        y: -Rz_BF * x_tmp + y_tmp + Rx_BF * z_tmp,
        z: Ry_BF * x_tmp - Rx_BF * y_tmp + z_tmp
      };
    }
  }
  function checkParams(type) {
    return type === PJD_3PARAM || type === PJD_7PARAM;
  }
  function datum_transform(source, dest, point) {
    if (compareDatums(source, dest)) {
      return point;
    }
    if (source.datum_type === PJD_NODATUM || dest.datum_type === PJD_NODATUM) {
      return point;
    }
    var source_a = source.a;
    var source_es = source.es;
    if (source.datum_type === PJD_GRIDSHIFT) {
      var gridShiftCode = applyGridShift(source, false, point);
      if (gridShiftCode !== 0) {
        return void 0;
      }
      source_a = SRS_WGS84_SEMIMAJOR;
      source_es = SRS_WGS84_ESQUARED;
    }
    var dest_a = dest.a;
    var dest_b = dest.b;
    var dest_es = dest.es;
    if (dest.datum_type === PJD_GRIDSHIFT) {
      dest_a = SRS_WGS84_SEMIMAJOR;
      dest_b = SRS_WGS84_SEMIMINOR;
      dest_es = SRS_WGS84_ESQUARED;
    }
    if (source_es === dest_es && source_a === dest_a && !checkParams(source.datum_type) && !checkParams(dest.datum_type)) {
      return point;
    }
    point = geodeticToGeocentric(point, source_es, source_a);
    if (checkParams(source.datum_type)) {
      point = geocentricToWgs84(point, source.datum_type, source.datum_params);
    }
    if (checkParams(dest.datum_type)) {
      point = geocentricFromWgs84(point, dest.datum_type, dest.datum_params);
    }
    point = geocentricToGeodetic(point, dest_es, dest_a, dest_b);
    if (dest.datum_type === PJD_GRIDSHIFT) {
      var destGridShiftResult = applyGridShift(dest, true, point);
      if (destGridShiftResult !== 0) {
        return void 0;
      }
    }
    return point;
  }
  function applyGridShift(source, inverse2, point) {
    if (source.grids === null || source.grids.length === 0) {
      console.log("Grid shift grids not found");
      return -1;
    }
    var input = { x: -point.x, y: point.y };
    var output = { x: Number.NaN, y: Number.NaN };
    var attemptedGrids = [];
    for (var i = 0; i < source.grids.length; i++) {
      var grid = source.grids[i];
      attemptedGrids.push(grid.name);
      if (grid.isNull) {
        output = input;
        break;
      }
      grid.mandatory;
      if (grid.grid === null) {
        if (grid.mandatory) {
          console.log("Unable to find mandatory grid '" + grid.name + "'");
          return -1;
        }
        continue;
      }
      var subgrid = grid.grid.subgrids[0];
      var epsilon = (Math.abs(subgrid.del[1]) + Math.abs(subgrid.del[0])) / 1e4;
      var minX = subgrid.ll[0] - epsilon;
      var minY = subgrid.ll[1] - epsilon;
      var maxX = subgrid.ll[0] + (subgrid.lim[0] - 1) * subgrid.del[0] + epsilon;
      var maxY = subgrid.ll[1] + (subgrid.lim[1] - 1) * subgrid.del[1] + epsilon;
      if (minY > input.y || minX > input.x || maxY < input.y || maxX < input.x) {
        continue;
      }
      output = applySubgridShift(input, inverse2, subgrid);
      if (!isNaN(output.x)) {
        break;
      }
    }
    if (isNaN(output.x)) {
      console.log("Failed to find a grid shift table for location '" + -input.x * R2D + " " + input.y * R2D + " tried: '" + attemptedGrids + "'");
      return -1;
    }
    point.x = -output.x;
    point.y = output.y;
    return 0;
  }
  function applySubgridShift(pin, inverse2, ct) {
    var val = { x: Number.NaN, y: Number.NaN };
    if (isNaN(pin.x)) {
      return val;
    }
    var tb = { x: pin.x, y: pin.y };
    tb.x -= ct.ll[0];
    tb.y -= ct.ll[1];
    tb.x = adjust_lon(tb.x - Math.PI) + Math.PI;
    var t = nadInterpolate(tb, ct);
    if (inverse2) {
      if (isNaN(t.x)) {
        return val;
      }
      t.x = tb.x - t.x;
      t.y = tb.y - t.y;
      var i = 9, tol = 1e-12;
      var dif, del2;
      do {
        del2 = nadInterpolate(t, ct);
        if (isNaN(del2.x)) {
          console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");
          break;
        }
        dif = { x: tb.x - (del2.x + t.x), y: tb.y - (del2.y + t.y) };
        t.x += dif.x;
        t.y += dif.y;
      } while (i-- && Math.abs(dif.x) > tol && Math.abs(dif.y) > tol);
      if (i < 0) {
        console.log("Inverse grid shift iterator failed to converge.");
        return val;
      }
      val.x = adjust_lon(t.x + ct.ll[0]);
      val.y = t.y + ct.ll[1];
    } else {
      if (!isNaN(t.x)) {
        val.x = pin.x + t.x;
        val.y = pin.y + t.y;
      }
    }
    return val;
  }
  function nadInterpolate(pin, ct) {
    var t = { x: pin.x / ct.del[0], y: pin.y / ct.del[1] };
    var indx = { x: Math.floor(t.x), y: Math.floor(t.y) };
    var frct = { x: t.x - 1 * indx.x, y: t.y - 1 * indx.y };
    var val = { x: Number.NaN, y: Number.NaN };
    var inx;
    if (indx.x < 0 || indx.x >= ct.lim[0]) {
      return val;
    }
    if (indx.y < 0 || indx.y >= ct.lim[1]) {
      return val;
    }
    inx = indx.y * ct.lim[0] + indx.x;
    var f00 = { x: ct.cvs[inx][0], y: ct.cvs[inx][1] };
    inx++;
    var f10 = { x: ct.cvs[inx][0], y: ct.cvs[inx][1] };
    inx += ct.lim[0];
    var f11 = { x: ct.cvs[inx][0], y: ct.cvs[inx][1] };
    inx--;
    var f01 = { x: ct.cvs[inx][0], y: ct.cvs[inx][1] };
    var m11 = frct.x * frct.y, m10 = frct.x * (1 - frct.y), m00 = (1 - frct.x) * (1 - frct.y), m01 = (1 - frct.x) * frct.y;
    val.x = m00 * f00.x + m10 * f10.x + m01 * f01.x + m11 * f11.x;
    val.y = m00 * f00.y + m10 * f10.y + m01 * f01.y + m11 * f11.y;
    return val;
  }
  function adjust_axis(crs, denorm, point) {
    var xin = point.x, yin = point.y, zin = point.z || 0;
    var v2, t, i;
    var out = {};
    for (i = 0; i < 3; i++) {
      if (denorm && i === 2 && point.z === void 0) {
        continue;
      }
      if (i === 0) {
        v2 = xin;
        if ("ew".indexOf(crs.axis[i]) !== -1) {
          t = "x";
        } else {
          t = "y";
        }
      } else if (i === 1) {
        v2 = yin;
        if ("ns".indexOf(crs.axis[i]) !== -1) {
          t = "y";
        } else {
          t = "x";
        }
      } else {
        v2 = zin;
        t = "z";
      }
      switch (crs.axis[i]) {
        case "e":
          out[t] = v2;
          break;
        case "w":
          out[t] = -v2;
          break;
        case "n":
          out[t] = v2;
          break;
        case "s":
          out[t] = -v2;
          break;
        case "u":
          if (point[t] !== void 0) {
            out.z = v2;
          }
          break;
        case "d":
          if (point[t] !== void 0) {
            out.z = -v2;
          }
          break;
        default:
          return null;
      }
    }
    return out;
  }
  function common(array) {
    var out = {
      x: array[0],
      y: array[1]
    };
    if (array.length > 2) {
      out.z = array[2];
    }
    if (array.length > 3) {
      out.m = array[3];
    }
    return out;
  }
  function checkSanity(point) {
    checkCoord(point.x);
    checkCoord(point.y);
  }
  function checkCoord(num) {
    if (typeof Number.isFinite === "function") {
      if (Number.isFinite(num)) {
        return;
      }
      throw new TypeError("coordinates must be finite numbers");
    }
    if (typeof num !== "number" || num !== num || !isFinite(num)) {
      throw new TypeError("coordinates must be finite numbers");
    }
  }
  function checkNotWGS(source, dest) {
    return (source.datum.datum_type === PJD_3PARAM || source.datum.datum_type === PJD_7PARAM || source.datum.datum_type === PJD_GRIDSHIFT) && dest.datumCode !== "WGS84" || (dest.datum.datum_type === PJD_3PARAM || dest.datum.datum_type === PJD_7PARAM || dest.datum.datum_type === PJD_GRIDSHIFT) && source.datumCode !== "WGS84";
  }
  function transform(source, dest, point, enforceAxis) {
    var wgs842;
    if (Array.isArray(point)) {
      point = common(point);
    } else {
      point = {
        x: point.x,
        y: point.y,
        z: point.z,
        m: point.m
      };
    }
    var hasZ = point.z !== void 0;
    checkSanity(point);
    if (source.datum && dest.datum && checkNotWGS(source, dest)) {
      wgs842 = new Projection("WGS84");
      point = transform(source, wgs842, point, enforceAxis);
      source = wgs842;
    }
    if (enforceAxis && source.axis !== "enu") {
      point = adjust_axis(source, false, point);
    }
    if (source.projName === "longlat") {
      point = {
        x: point.x * D2R$1,
        y: point.y * D2R$1,
        z: point.z || 0
      };
    } else {
      if (source.to_meter) {
        point = {
          x: point.x * source.to_meter,
          y: point.y * source.to_meter,
          z: point.z || 0
        };
      }
      point = source.inverse(point);
      if (!point) {
        return;
      }
    }
    if (source.from_greenwich) {
      point.x += source.from_greenwich;
    }
    point = datum_transform(source.datum, dest.datum, point);
    if (!point) {
      return;
    }
    if (dest.from_greenwich) {
      point = {
        x: point.x - dest.from_greenwich,
        y: point.y,
        z: point.z || 0
      };
    }
    if (dest.projName === "longlat") {
      point = {
        x: point.x * R2D,
        y: point.y * R2D,
        z: point.z || 0
      };
    } else {
      point = dest.forward(point);
      if (dest.to_meter) {
        point = {
          x: point.x / dest.to_meter,
          y: point.y / dest.to_meter,
          z: point.z || 0
        };
      }
    }
    if (enforceAxis && dest.axis !== "enu") {
      return adjust_axis(dest, true, point);
    }
    if (!hasZ) {
      delete point.z;
    }
    return point;
  }
  var wgs84 = Projection("WGS84");
  function transformer(from, to, coords, enforceAxis) {
    var transformedArray, out, keys;
    if (Array.isArray(coords)) {
      transformedArray = transform(from, to, coords, enforceAxis) || { x: NaN, y: NaN };
      if (coords.length > 2) {
        if (typeof from.name !== "undefined" && from.name === "geocent" || typeof to.name !== "undefined" && to.name === "geocent") {
          if (typeof transformedArray.z === "number") {
            return [transformedArray.x, transformedArray.y, transformedArray.z].concat(coords.splice(3));
          } else {
            return [transformedArray.x, transformedArray.y, coords[2]].concat(coords.splice(3));
          }
        } else {
          return [transformedArray.x, transformedArray.y].concat(coords.splice(2));
        }
      } else {
        return [transformedArray.x, transformedArray.y];
      }
    } else {
      out = transform(from, to, coords, enforceAxis);
      keys = Object.keys(coords);
      if (keys.length === 2) {
        return out;
      }
      keys.forEach(function(key) {
        if (typeof from.name !== "undefined" && from.name === "geocent" || typeof to.name !== "undefined" && to.name === "geocent") {
          if (key === "x" || key === "y" || key === "z") {
            return;
          }
        } else {
          if (key === "x" || key === "y") {
            return;
          }
        }
        out[key] = coords[key];
      });
      return out;
    }
  }
  function checkProj(item) {
    if (item instanceof Projection) {
      return item;
    }
    if (item.oProj) {
      return item.oProj;
    }
    return Projection(item);
  }
  function proj4(fromProj, toProj, coord) {
    fromProj = checkProj(fromProj);
    var single = false;
    var obj;
    if (typeof toProj === "undefined") {
      toProj = fromProj;
      fromProj = wgs84;
      single = true;
    } else if (typeof toProj.x !== "undefined" || Array.isArray(toProj)) {
      coord = toProj;
      toProj = fromProj;
      fromProj = wgs84;
      single = true;
    }
    toProj = checkProj(toProj);
    if (coord) {
      return transformer(fromProj, toProj, coord);
    } else {
      obj = {
        forward: function(coords, enforceAxis) {
          return transformer(fromProj, toProj, coords, enforceAxis);
        },
        inverse: function(coords, enforceAxis) {
          return transformer(toProj, fromProj, coords, enforceAxis);
        }
      };
      if (single) {
        obj.oProj = toProj;
      }
      return obj;
    }
  }
  var NUM_100K_SETS = 6;
  var SET_ORIGIN_COLUMN_LETTERS = "AJSAJS";
  var SET_ORIGIN_ROW_LETTERS = "AFAFAF";
  var A = 65;
  var I = 73;
  var O = 79;
  var V = 86;
  var Z = 90;
  const mgrs = {
    forward: forward$t,
    inverse: inverse$t,
    toPoint
  };
  function forward$t(ll, accuracy) {
    accuracy = accuracy || 5;
    return encode(LLtoUTM({
      lat: ll[1],
      lon: ll[0]
    }), accuracy);
  }
  function inverse$t(mgrs2) {
    var bbox = UTMtoLL(decode(mgrs2.toUpperCase()));
    if (bbox.lat && bbox.lon) {
      return [bbox.lon, bbox.lat, bbox.lon, bbox.lat];
    }
    return [bbox.left, bbox.bottom, bbox.right, bbox.top];
  }
  function toPoint(mgrs2) {
    var bbox = UTMtoLL(decode(mgrs2.toUpperCase()));
    if (bbox.lat && bbox.lon) {
      return [bbox.lon, bbox.lat];
    }
    return [(bbox.left + bbox.right) / 2, (bbox.top + bbox.bottom) / 2];
  }
  function degToRad(deg) {
    return deg * (Math.PI / 180);
  }
  function radToDeg(rad) {
    return 180 * (rad / Math.PI);
  }
  function LLtoUTM(ll) {
    var Lat = ll.lat;
    var Long = ll.lon;
    var a = 6378137;
    var eccSquared = 669438e-8;
    var k0 = 0.9996;
    var LongOrigin;
    var eccPrimeSquared;
    var N, T, C, A2, M;
    var LatRad = degToRad(Lat);
    var LongRad = degToRad(Long);
    var LongOriginRad;
    var ZoneNumber;
    ZoneNumber = Math.floor((Long + 180) / 6) + 1;
    if (Long === 180) {
      ZoneNumber = 60;
    }
    if (Lat >= 56 && Lat < 64 && Long >= 3 && Long < 12) {
      ZoneNumber = 32;
    }
    if (Lat >= 72 && Lat < 84) {
      if (Long >= 0 && Long < 9) {
        ZoneNumber = 31;
      } else if (Long >= 9 && Long < 21) {
        ZoneNumber = 33;
      } else if (Long >= 21 && Long < 33) {
        ZoneNumber = 35;
      } else if (Long >= 33 && Long < 42) {
        ZoneNumber = 37;
      }
    }
    LongOrigin = (ZoneNumber - 1) * 6 - 180 + 3;
    LongOriginRad = degToRad(LongOrigin);
    eccPrimeSquared = eccSquared / (1 - eccSquared);
    N = a / Math.sqrt(1 - eccSquared * Math.sin(LatRad) * Math.sin(LatRad));
    T = Math.tan(LatRad) * Math.tan(LatRad);
    C = eccPrimeSquared * Math.cos(LatRad) * Math.cos(LatRad);
    A2 = Math.cos(LatRad) * (LongRad - LongOriginRad);
    M = a * ((1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256) * LatRad - (3 * eccSquared / 8 + 3 * eccSquared * eccSquared / 32 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(2 * LatRad) + (15 * eccSquared * eccSquared / 256 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(4 * LatRad) - 35 * eccSquared * eccSquared * eccSquared / 3072 * Math.sin(6 * LatRad));
    var UTMEasting = k0 * N * (A2 + (1 - T + C) * A2 * A2 * A2 / 6 + (5 - 18 * T + T * T + 72 * C - 58 * eccPrimeSquared) * A2 * A2 * A2 * A2 * A2 / 120) + 5e5;
    var UTMNorthing = k0 * (M + N * Math.tan(LatRad) * (A2 * A2 / 2 + (5 - T + 9 * C + 4 * C * C) * A2 * A2 * A2 * A2 / 24 + (61 - 58 * T + T * T + 600 * C - 330 * eccPrimeSquared) * A2 * A2 * A2 * A2 * A2 * A2 / 720));
    if (Lat < 0) {
      UTMNorthing += 1e7;
    }
    return {
      northing: Math.round(UTMNorthing),
      easting: Math.round(UTMEasting),
      zoneNumber: ZoneNumber,
      zoneLetter: getLetterDesignator(Lat)
    };
  }
  function UTMtoLL(utm2) {
    var UTMNorthing = utm2.northing;
    var UTMEasting = utm2.easting;
    var zoneLetter = utm2.zoneLetter;
    var zoneNumber = utm2.zoneNumber;
    if (zoneNumber < 0 || zoneNumber > 60) {
      return null;
    }
    var k0 = 0.9996;
    var a = 6378137;
    var eccSquared = 669438e-8;
    var eccPrimeSquared;
    var e1 = (1 - Math.sqrt(1 - eccSquared)) / (1 + Math.sqrt(1 - eccSquared));
    var N1, T1, C12, R1, D, M;
    var LongOrigin;
    var mu, phi1Rad;
    var x = UTMEasting - 5e5;
    var y2 = UTMNorthing;
    if (zoneLetter < "N") {
      y2 -= 1e7;
    }
    LongOrigin = (zoneNumber - 1) * 6 - 180 + 3;
    eccPrimeSquared = eccSquared / (1 - eccSquared);
    M = y2 / k0;
    mu = M / (a * (1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256));
    phi1Rad = mu + (3 * e1 / 2 - 27 * e1 * e1 * e1 / 32) * Math.sin(2 * mu) + (21 * e1 * e1 / 16 - 55 * e1 * e1 * e1 * e1 / 32) * Math.sin(4 * mu) + 151 * e1 * e1 * e1 / 96 * Math.sin(6 * mu);
    N1 = a / Math.sqrt(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad));
    T1 = Math.tan(phi1Rad) * Math.tan(phi1Rad);
    C12 = eccPrimeSquared * Math.cos(phi1Rad) * Math.cos(phi1Rad);
    R1 = a * (1 - eccSquared) / Math.pow(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad), 1.5);
    D = x / (N1 * k0);
    var lat = phi1Rad - N1 * Math.tan(phi1Rad) / R1 * (D * D / 2 - (5 + 3 * T1 + 10 * C12 - 4 * C12 * C12 - 9 * eccPrimeSquared) * D * D * D * D / 24 + (61 + 90 * T1 + 298 * C12 + 45 * T1 * T1 - 252 * eccPrimeSquared - 3 * C12 * C12) * D * D * D * D * D * D / 720);
    lat = radToDeg(lat);
    var lon = (D - (1 + 2 * T1 + C12) * D * D * D / 6 + (5 - 2 * C12 + 28 * T1 - 3 * C12 * C12 + 8 * eccPrimeSquared + 24 * T1 * T1) * D * D * D * D * D / 120) / Math.cos(phi1Rad);
    lon = LongOrigin + radToDeg(lon);
    var result;
    if (utm2.accuracy) {
      var topRight = UTMtoLL({
        northing: utm2.northing + utm2.accuracy,
        easting: utm2.easting + utm2.accuracy,
        zoneLetter: utm2.zoneLetter,
        zoneNumber: utm2.zoneNumber
      });
      result = {
        top: topRight.lat,
        right: topRight.lon,
        bottom: lat,
        left: lon
      };
    } else {
      result = {
        lat,
        lon
      };
    }
    return result;
  }
  function getLetterDesignator(lat) {
    var LetterDesignator = "Z";
    if (84 >= lat && lat >= 72) {
      LetterDesignator = "X";
    } else if (72 > lat && lat >= 64) {
      LetterDesignator = "W";
    } else if (64 > lat && lat >= 56) {
      LetterDesignator = "V";
    } else if (56 > lat && lat >= 48) {
      LetterDesignator = "U";
    } else if (48 > lat && lat >= 40) {
      LetterDesignator = "T";
    } else if (40 > lat && lat >= 32) {
      LetterDesignator = "S";
    } else if (32 > lat && lat >= 24) {
      LetterDesignator = "R";
    } else if (24 > lat && lat >= 16) {
      LetterDesignator = "Q";
    } else if (16 > lat && lat >= 8) {
      LetterDesignator = "P";
    } else if (8 > lat && lat >= 0) {
      LetterDesignator = "N";
    } else if (0 > lat && lat >= -8) {
      LetterDesignator = "M";
    } else if (-8 > lat && lat >= -16) {
      LetterDesignator = "L";
    } else if (-16 > lat && lat >= -24) {
      LetterDesignator = "K";
    } else if (-24 > lat && lat >= -32) {
      LetterDesignator = "J";
    } else if (-32 > lat && lat >= -40) {
      LetterDesignator = "H";
    } else if (-40 > lat && lat >= -48) {
      LetterDesignator = "G";
    } else if (-48 > lat && lat >= -56) {
      LetterDesignator = "F";
    } else if (-56 > lat && lat >= -64) {
      LetterDesignator = "E";
    } else if (-64 > lat && lat >= -72) {
      LetterDesignator = "D";
    } else if (-72 > lat && lat >= -80) {
      LetterDesignator = "C";
    }
    return LetterDesignator;
  }
  function encode(utm2, accuracy) {
    var seasting = "00000" + utm2.easting, snorthing = "00000" + utm2.northing;
    return utm2.zoneNumber + utm2.zoneLetter + get100kID(utm2.easting, utm2.northing, utm2.zoneNumber) + seasting.substr(seasting.length - 5, accuracy) + snorthing.substr(snorthing.length - 5, accuracy);
  }
  function get100kID(easting, northing, zoneNumber) {
    var setParm = get100kSetForZone(zoneNumber);
    var setColumn = Math.floor(easting / 1e5);
    var setRow = Math.floor(northing / 1e5) % 20;
    return getLetter100kID(setColumn, setRow, setParm);
  }
  function get100kSetForZone(i) {
    var setParm = i % NUM_100K_SETS;
    if (setParm === 0) {
      setParm = NUM_100K_SETS;
    }
    return setParm;
  }
  function getLetter100kID(column, row, parm) {
    var index2 = parm - 1;
    var colOrigin = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(index2);
    var rowOrigin = SET_ORIGIN_ROW_LETTERS.charCodeAt(index2);
    var colInt = colOrigin + column - 1;
    var rowInt = rowOrigin + row;
    var rollover = false;
    if (colInt > Z) {
      colInt = colInt - Z + A - 1;
      rollover = true;
    }
    if (colInt === I || colOrigin < I && colInt > I || (colInt > I || colOrigin < I) && rollover) {
      colInt++;
    }
    if (colInt === O || colOrigin < O && colInt > O || (colInt > O || colOrigin < O) && rollover) {
      colInt++;
      if (colInt === I) {
        colInt++;
      }
    }
    if (colInt > Z) {
      colInt = colInt - Z + A - 1;
    }
    if (rowInt > V) {
      rowInt = rowInt - V + A - 1;
      rollover = true;
    } else {
      rollover = false;
    }
    if (rowInt === I || rowOrigin < I && rowInt > I || (rowInt > I || rowOrigin < I) && rollover) {
      rowInt++;
    }
    if (rowInt === O || rowOrigin < O && rowInt > O || (rowInt > O || rowOrigin < O) && rollover) {
      rowInt++;
      if (rowInt === I) {
        rowInt++;
      }
    }
    if (rowInt > V) {
      rowInt = rowInt - V + A - 1;
    }
    var twoLetter = String.fromCharCode(colInt) + String.fromCharCode(rowInt);
    return twoLetter;
  }
  function decode(mgrsString) {
    if (mgrsString && mgrsString.length === 0) {
      throw "MGRSPoint coverting from nothing";
    }
    var length = mgrsString.length;
    var hunK = null;
    var sb = "";
    var testChar;
    var i = 0;
    while (!/[A-Z]/.test(testChar = mgrsString.charAt(i))) {
      if (i >= 2) {
        throw "MGRSPoint bad conversion from: " + mgrsString;
      }
      sb += testChar;
      i++;
    }
    var zoneNumber = parseInt(sb, 10);
    if (i === 0 || i + 3 > length) {
      throw "MGRSPoint bad conversion from: " + mgrsString;
    }
    var zoneLetter = mgrsString.charAt(i++);
    if (zoneLetter <= "A" || zoneLetter === "B" || zoneLetter === "Y" || zoneLetter >= "Z" || zoneLetter === "I" || zoneLetter === "O") {
      throw "MGRSPoint zone letter " + zoneLetter + " not handled: " + mgrsString;
    }
    hunK = mgrsString.substring(i, i += 2);
    var set2 = get100kSetForZone(zoneNumber);
    var east100k = getEastingFromChar(hunK.charAt(0), set2);
    var north100k = getNorthingFromChar(hunK.charAt(1), set2);
    while (north100k < getMinNorthing(zoneLetter)) {
      north100k += 2e6;
    }
    var remainder = length - i;
    if (remainder % 2 !== 0) {
      throw "MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters" + mgrsString;
    }
    var sep = remainder / 2;
    var sepEasting = 0;
    var sepNorthing = 0;
    var accuracyBonus, sepEastingString, sepNorthingString, easting, northing;
    if (sep > 0) {
      accuracyBonus = 1e5 / Math.pow(10, sep);
      sepEastingString = mgrsString.substring(i, i + sep);
      sepEasting = parseFloat(sepEastingString) * accuracyBonus;
      sepNorthingString = mgrsString.substring(i + sep);
      sepNorthing = parseFloat(sepNorthingString) * accuracyBonus;
    }
    easting = sepEasting + east100k;
    northing = sepNorthing + north100k;
    return {
      easting,
      northing,
      zoneLetter,
      zoneNumber,
      accuracy: accuracyBonus
    };
  }
  function getEastingFromChar(e, set2) {
    var curCol = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(set2 - 1);
    var eastingValue = 1e5;
    var rewindMarker = false;
    while (curCol !== e.charCodeAt(0)) {
      curCol++;
      if (curCol === I) {
        curCol++;
      }
      if (curCol === O) {
        curCol++;
      }
      if (curCol > Z) {
        if (rewindMarker) {
          throw "Bad character: " + e;
        }
        curCol = A;
        rewindMarker = true;
      }
      eastingValue += 1e5;
    }
    return eastingValue;
  }
  function getNorthingFromChar(n, set2) {
    if (n > "V") {
      throw "MGRSPoint given invalid Northing " + n;
    }
    var curRow = SET_ORIGIN_ROW_LETTERS.charCodeAt(set2 - 1);
    var northingValue = 0;
    var rewindMarker = false;
    while (curRow !== n.charCodeAt(0)) {
      curRow++;
      if (curRow === I) {
        curRow++;
      }
      if (curRow === O) {
        curRow++;
      }
      if (curRow > V) {
        if (rewindMarker) {
          throw "Bad character: " + n;
        }
        curRow = A;
        rewindMarker = true;
      }
      northingValue += 1e5;
    }
    return northingValue;
  }
  function getMinNorthing(zoneLetter) {
    var northing;
    switch (zoneLetter) {
      case "C":
        northing = 11e5;
        break;
      case "D":
        northing = 2e6;
        break;
      case "E":
        northing = 28e5;
        break;
      case "F":
        northing = 37e5;
        break;
      case "G":
        northing = 46e5;
        break;
      case "H":
        northing = 55e5;
        break;
      case "J":
        northing = 64e5;
        break;
      case "K":
        northing = 73e5;
        break;
      case "L":
        northing = 82e5;
        break;
      case "M":
        northing = 91e5;
        break;
      case "N":
        northing = 0;
        break;
      case "P":
        northing = 8e5;
        break;
      case "Q":
        northing = 17e5;
        break;
      case "R":
        northing = 26e5;
        break;
      case "S":
        northing = 35e5;
        break;
      case "T":
        northing = 44e5;
        break;
      case "U":
        northing = 53e5;
        break;
      case "V":
        northing = 62e5;
        break;
      case "W":
        northing = 7e6;
        break;
      case "X":
        northing = 79e5;
        break;
      default:
        northing = -1;
    }
    if (northing >= 0) {
      return northing;
    } else {
      throw "Invalid zone letter: " + zoneLetter;
    }
  }
  function Point$2(x, y2, z) {
    if (!(this instanceof Point$2)) {
      return new Point$2(x, y2, z);
    }
    if (Array.isArray(x)) {
      this.x = x[0];
      this.y = x[1];
      this.z = x[2] || 0;
    } else if (typeof x === "object") {
      this.x = x.x;
      this.y = x.y;
      this.z = x.z || 0;
    } else if (typeof x === "string" && typeof y2 === "undefined") {
      var coords = x.split(",");
      this.x = parseFloat(coords[0], 10);
      this.y = parseFloat(coords[1], 10);
      this.z = parseFloat(coords[2], 10) || 0;
    } else {
      this.x = x;
      this.y = y2;
      this.z = z || 0;
    }
    console.warn("proj4.Point will be removed in version 3, use proj4.toPoint");
  }
  Point$2.fromMGRS = function(mgrsStr) {
    return new Point$2(toPoint(mgrsStr));
  };
  Point$2.prototype.toMGRS = function(accuracy) {
    return forward$t([this.x, this.y], accuracy);
  };
  var C00 = 1;
  var C02 = 0.25;
  var C04 = 0.046875;
  var C06 = 0.01953125;
  var C08 = 0.01068115234375;
  var C22 = 0.75;
  var C44 = 0.46875;
  var C46 = 0.013020833333333334;
  var C48 = 0.007120768229166667;
  var C66 = 0.3645833333333333;
  var C68 = 0.005696614583333333;
  var C88 = 0.3076171875;
  function pj_enfn(es) {
    var en = [];
    en[0] = C00 - es * (C02 + es * (C04 + es * (C06 + es * C08)));
    en[1] = es * (C22 - es * (C04 + es * (C06 + es * C08)));
    var t = es * es;
    en[2] = t * (C44 - es * (C46 + es * C48));
    t *= es;
    en[3] = t * (C66 - es * C68);
    en[4] = t * es * C88;
    return en;
  }
  function pj_mlfn(phi, sphi, cphi, en) {
    cphi *= sphi;
    sphi *= sphi;
    return en[0] * phi - cphi * (en[1] + sphi * (en[2] + sphi * (en[3] + sphi * en[4])));
  }
  var MAX_ITER$3 = 20;
  function pj_inv_mlfn(arg, es, en) {
    var k = 1 / (1 - es);
    var phi = arg;
    for (var i = MAX_ITER$3; i; --i) {
      var s = Math.sin(phi);
      var t = 1 - es * s * s;
      t = (pj_mlfn(phi, s, Math.cos(phi), en) - arg) * (t * Math.sqrt(t)) * k;
      phi -= t;
      if (Math.abs(t) < EPSLN) {
        return phi;
      }
    }
    return phi;
  }
  function init$t() {
    this.x0 = this.x0 !== void 0 ? this.x0 : 0;
    this.y0 = this.y0 !== void 0 ? this.y0 : 0;
    this.long0 = this.long0 !== void 0 ? this.long0 : 0;
    this.lat0 = this.lat0 !== void 0 ? this.lat0 : 0;
    if (this.es) {
      this.en = pj_enfn(this.es);
      this.ml0 = pj_mlfn(this.lat0, Math.sin(this.lat0), Math.cos(this.lat0), this.en);
    }
  }
  function forward$s(p2) {
    var lon = p2.x;
    var lat = p2.y;
    var delta_lon = adjust_lon(lon - this.long0);
    var con;
    var x, y2;
    var sin_phi = Math.sin(lat);
    var cos_phi = Math.cos(lat);
    if (!this.es) {
      var b = cos_phi * Math.sin(delta_lon);
      if (Math.abs(Math.abs(b) - 1) < EPSLN) {
        return 93;
      } else {
        x = 0.5 * this.a * this.k0 * Math.log((1 + b) / (1 - b)) + this.x0;
        y2 = cos_phi * Math.cos(delta_lon) / Math.sqrt(1 - Math.pow(b, 2));
        b = Math.abs(y2);
        if (b >= 1) {
          if (b - 1 > EPSLN) {
            return 93;
          } else {
            y2 = 0;
          }
        } else {
          y2 = Math.acos(y2);
        }
        if (lat < 0) {
          y2 = -y2;
        }
        y2 = this.a * this.k0 * (y2 - this.lat0) + this.y0;
      }
    } else {
      var al = cos_phi * delta_lon;
      var als = Math.pow(al, 2);
      var c2 = this.ep2 * Math.pow(cos_phi, 2);
      var cs = Math.pow(c2, 2);
      var tq = Math.abs(cos_phi) > EPSLN ? Math.tan(lat) : 0;
      var t = Math.pow(tq, 2);
      var ts = Math.pow(t, 2);
      con = 1 - this.es * Math.pow(sin_phi, 2);
      al = al / Math.sqrt(con);
      var ml = pj_mlfn(lat, sin_phi, cos_phi, this.en);
      x = this.a * (this.k0 * al * (1 + als / 6 * (1 - t + c2 + als / 20 * (5 - 18 * t + ts + 14 * c2 - 58 * t * c2 + als / 42 * (61 + 179 * ts - ts * t - 479 * t))))) + this.x0;
      y2 = this.a * (this.k0 * (ml - this.ml0 + sin_phi * delta_lon * al / 2 * (1 + als / 12 * (5 - t + 9 * c2 + 4 * cs + als / 30 * (61 + ts - 58 * t + 270 * c2 - 330 * t * c2 + als / 56 * (1385 + 543 * ts - ts * t - 3111 * t)))))) + this.y0;
    }
    p2.x = x;
    p2.y = y2;
    return p2;
  }
  function inverse$s(p2) {
    var con, phi;
    var lat, lon;
    var x = (p2.x - this.x0) * (1 / this.a);
    var y2 = (p2.y - this.y0) * (1 / this.a);
    if (!this.es) {
      var f = Math.exp(x / this.k0);
      var g = 0.5 * (f - 1 / f);
      var temp = this.lat0 + y2 / this.k0;
      var h = Math.cos(temp);
      con = Math.sqrt((1 - Math.pow(h, 2)) / (1 + Math.pow(g, 2)));
      lat = Math.asin(con);
      if (y2 < 0) {
        lat = -lat;
      }
      if (g === 0 && h === 0) {
        lon = 0;
      } else {
        lon = adjust_lon(Math.atan2(g, h) + this.long0);
      }
    } else {
      con = this.ml0 + y2 / this.k0;
      phi = pj_inv_mlfn(con, this.es, this.en);
      if (Math.abs(phi) < HALF_PI) {
        var sin_phi = Math.sin(phi);
        var cos_phi = Math.cos(phi);
        var tan_phi = Math.abs(cos_phi) > EPSLN ? Math.tan(phi) : 0;
        var c2 = this.ep2 * Math.pow(cos_phi, 2);
        var cs = Math.pow(c2, 2);
        var t = Math.pow(tan_phi, 2);
        var ts = Math.pow(t, 2);
        con = 1 - this.es * Math.pow(sin_phi, 2);
        var d = x * Math.sqrt(con) / this.k0;
        var ds = Math.pow(d, 2);
        con = con * tan_phi;
        lat = phi - con * ds / (1 - this.es) * 0.5 * (1 - ds / 12 * (5 + 3 * t - 9 * c2 * t + c2 - 4 * cs - ds / 30 * (61 + 90 * t - 252 * c2 * t + 45 * ts + 46 * c2 - ds / 56 * (1385 + 3633 * t + 4095 * ts + 1574 * ts * t))));
        lon = adjust_lon(this.long0 + d * (1 - ds / 6 * (1 + 2 * t + c2 - ds / 20 * (5 + 28 * t + 24 * ts + 8 * c2 * t + 6 * c2 - ds / 42 * (61 + 662 * t + 1320 * ts + 720 * ts * t)))) / cos_phi);
      } else {
        lat = HALF_PI * sign(y2);
        lon = 0;
      }
    }
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  var names$t = ["Fast_Transverse_Mercator", "Fast Transverse Mercator"];
  const tmerc = {
    init: init$t,
    forward: forward$s,
    inverse: inverse$s,
    names: names$t
  };
  function sinh(x) {
    var r = Math.exp(x);
    r = (r - 1 / r) / 2;
    return r;
  }
  function hypot(x, y2) {
    x = Math.abs(x);
    y2 = Math.abs(y2);
    var a = Math.max(x, y2);
    var b = Math.min(x, y2) / (a ? a : 1);
    return a * Math.sqrt(1 + Math.pow(b, 2));
  }
  function log1py(x) {
    var y2 = 1 + x;
    var z = y2 - 1;
    return z === 0 ? x : x * Math.log(y2) / z;
  }
  function asinhy(x) {
    var y2 = Math.abs(x);
    y2 = log1py(y2 * (1 + y2 / (hypot(1, y2) + 1)));
    return x < 0 ? -y2 : y2;
  }
  function gatg(pp, B) {
    var cos_2B = 2 * Math.cos(2 * B);
    var i = pp.length - 1;
    var h1 = pp[i];
    var h2 = 0;
    var h;
    while (--i >= 0) {
      h = -h2 + cos_2B * h1 + pp[i];
      h2 = h1;
      h1 = h;
    }
    return B + h * Math.sin(2 * B);
  }
  function clens(pp, arg_r) {
    var r = 2 * Math.cos(arg_r);
    var i = pp.length - 1;
    var hr1 = pp[i];
    var hr2 = 0;
    var hr;
    while (--i >= 0) {
      hr = -hr2 + r * hr1 + pp[i];
      hr2 = hr1;
      hr1 = hr;
    }
    return Math.sin(arg_r) * hr;
  }
  function cosh(x) {
    var r = Math.exp(x);
    r = (r + 1 / r) / 2;
    return r;
  }
  function clens_cmplx(pp, arg_r, arg_i) {
    var sin_arg_r = Math.sin(arg_r);
    var cos_arg_r = Math.cos(arg_r);
    var sinh_arg_i = sinh(arg_i);
    var cosh_arg_i = cosh(arg_i);
    var r = 2 * cos_arg_r * cosh_arg_i;
    var i = -2 * sin_arg_r * sinh_arg_i;
    var j = pp.length - 1;
    var hr = pp[j];
    var hi1 = 0;
    var hr1 = 0;
    var hi = 0;
    var hr2;
    var hi2;
    while (--j >= 0) {
      hr2 = hr1;
      hi2 = hi1;
      hr1 = hr;
      hi1 = hi;
      hr = -hr2 + r * hr1 - i * hi1 + pp[j];
      hi = -hi2 + i * hr1 + r * hi1;
    }
    r = sin_arg_r * cosh_arg_i;
    i = cos_arg_r * sinh_arg_i;
    return [r * hr - i * hi, r * hi + i * hr];
  }
  function init$s() {
    if (!this.approx && (isNaN(this.es) || this.es <= 0)) {
      throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');
    }
    if (this.approx) {
      tmerc.init.apply(this);
      this.forward = tmerc.forward;
      this.inverse = tmerc.inverse;
    }
    this.x0 = this.x0 !== void 0 ? this.x0 : 0;
    this.y0 = this.y0 !== void 0 ? this.y0 : 0;
    this.long0 = this.long0 !== void 0 ? this.long0 : 0;
    this.lat0 = this.lat0 !== void 0 ? this.lat0 : 0;
    this.cgb = [];
    this.cbg = [];
    this.utg = [];
    this.gtu = [];
    var f = this.es / (1 + Math.sqrt(1 - this.es));
    var n = f / (2 - f);
    var np = n;
    this.cgb[0] = n * (2 + n * (-2 / 3 + n * (-2 + n * (116 / 45 + n * (26 / 45 + n * (-2854 / 675))))));
    this.cbg[0] = n * (-2 + n * (2 / 3 + n * (4 / 3 + n * (-82 / 45 + n * (32 / 45 + n * (4642 / 4725))))));
    np = np * n;
    this.cgb[1] = np * (7 / 3 + n * (-8 / 5 + n * (-227 / 45 + n * (2704 / 315 + n * (2323 / 945)))));
    this.cbg[1] = np * (5 / 3 + n * (-16 / 15 + n * (-13 / 9 + n * (904 / 315 + n * (-1522 / 945)))));
    np = np * n;
    this.cgb[2] = np * (56 / 15 + n * (-136 / 35 + n * (-1262 / 105 + n * (73814 / 2835))));
    this.cbg[2] = np * (-26 / 15 + n * (34 / 21 + n * (8 / 5 + n * (-12686 / 2835))));
    np = np * n;
    this.cgb[3] = np * (4279 / 630 + n * (-332 / 35 + n * (-399572 / 14175)));
    this.cbg[3] = np * (1237 / 630 + n * (-12 / 5 + n * (-24832 / 14175)));
    np = np * n;
    this.cgb[4] = np * (4174 / 315 + n * (-144838 / 6237));
    this.cbg[4] = np * (-734 / 315 + n * (109598 / 31185));
    np = np * n;
    this.cgb[5] = np * (601676 / 22275);
    this.cbg[5] = np * (444337 / 155925);
    np = Math.pow(n, 2);
    this.Qn = this.k0 / (1 + n) * (1 + np * (1 / 4 + np * (1 / 64 + np / 256)));
    this.utg[0] = n * (-0.5 + n * (2 / 3 + n * (-37 / 96 + n * (1 / 360 + n * (81 / 512 + n * (-96199 / 604800))))));
    this.gtu[0] = n * (0.5 + n * (-2 / 3 + n * (5 / 16 + n * (41 / 180 + n * (-127 / 288 + n * (7891 / 37800))))));
    this.utg[1] = np * (-1 / 48 + n * (-1 / 15 + n * (437 / 1440 + n * (-46 / 105 + n * (1118711 / 3870720)))));
    this.gtu[1] = np * (13 / 48 + n * (-3 / 5 + n * (557 / 1440 + n * (281 / 630 + n * (-1983433 / 1935360)))));
    np = np * n;
    this.utg[2] = np * (-17 / 480 + n * (37 / 840 + n * (209 / 4480 + n * (-5569 / 90720))));
    this.gtu[2] = np * (61 / 240 + n * (-103 / 140 + n * (15061 / 26880 + n * (167603 / 181440))));
    np = np * n;
    this.utg[3] = np * (-4397 / 161280 + n * (11 / 504 + n * (830251 / 7257600)));
    this.gtu[3] = np * (49561 / 161280 + n * (-179 / 168 + n * (6601661 / 7257600)));
    np = np * n;
    this.utg[4] = np * (-4583 / 161280 + n * (108847 / 3991680));
    this.gtu[4] = np * (34729 / 80640 + n * (-3418889 / 1995840));
    np = np * n;
    this.utg[5] = np * (-20648693 / 638668800);
    this.gtu[5] = np * (212378941 / 319334400);
    var Z2 = gatg(this.cbg, this.lat0);
    this.Zb = -this.Qn * (Z2 + clens(this.gtu, 2 * Z2));
  }
  function forward$r(p2) {
    var Ce = adjust_lon(p2.x - this.long0);
    var Cn = p2.y;
    Cn = gatg(this.cbg, Cn);
    var sin_Cn = Math.sin(Cn);
    var cos_Cn = Math.cos(Cn);
    var sin_Ce = Math.sin(Ce);
    var cos_Ce = Math.cos(Ce);
    Cn = Math.atan2(sin_Cn, cos_Ce * cos_Cn);
    Ce = Math.atan2(sin_Ce * cos_Cn, hypot(sin_Cn, cos_Cn * cos_Ce));
    Ce = asinhy(Math.tan(Ce));
    var tmp = clens_cmplx(this.gtu, 2 * Cn, 2 * Ce);
    Cn = Cn + tmp[0];
    Ce = Ce + tmp[1];
    var x;
    var y2;
    if (Math.abs(Ce) <= 2.623395162778) {
      x = this.a * (this.Qn * Ce) + this.x0;
      y2 = this.a * (this.Qn * Cn + this.Zb) + this.y0;
    } else {
      x = Infinity;
      y2 = Infinity;
    }
    p2.x = x;
    p2.y = y2;
    return p2;
  }
  function inverse$r(p2) {
    var Ce = (p2.x - this.x0) * (1 / this.a);
    var Cn = (p2.y - this.y0) * (1 / this.a);
    Cn = (Cn - this.Zb) / this.Qn;
    Ce = Ce / this.Qn;
    var lon;
    var lat;
    if (Math.abs(Ce) <= 2.623395162778) {
      var tmp = clens_cmplx(this.utg, 2 * Cn, 2 * Ce);
      Cn = Cn + tmp[0];
      Ce = Ce + tmp[1];
      Ce = Math.atan(sinh(Ce));
      var sin_Cn = Math.sin(Cn);
      var cos_Cn = Math.cos(Cn);
      var sin_Ce = Math.sin(Ce);
      var cos_Ce = Math.cos(Ce);
      Cn = Math.atan2(sin_Cn * cos_Ce, hypot(sin_Ce, cos_Ce * cos_Cn));
      Ce = Math.atan2(sin_Ce, cos_Ce * cos_Cn);
      lon = adjust_lon(Ce + this.long0);
      lat = gatg(this.cgb, Cn);
    } else {
      lon = Infinity;
      lat = Infinity;
    }
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  var names$s = ["Extended_Transverse_Mercator", "Extended Transverse Mercator", "etmerc", "Transverse_Mercator", "Transverse Mercator", "tmerc"];
  const etmerc = {
    init: init$s,
    forward: forward$r,
    inverse: inverse$r,
    names: names$s
  };
  function adjust_zone(zone, lon) {
    if (zone === void 0) {
      zone = Math.floor((adjust_lon(lon) + Math.PI) * 30 / Math.PI) + 1;
      if (zone < 0) {
        return 0;
      } else if (zone > 60) {
        return 60;
      }
    }
    return zone;
  }
  var dependsOn = "etmerc";
  function init$r() {
    var zone = adjust_zone(this.zone, this.long0);
    if (zone === void 0) {
      throw new Error("unknown utm zone");
    }
    this.lat0 = 0;
    this.long0 = (6 * Math.abs(zone) - 183) * D2R$1;
    this.x0 = 5e5;
    this.y0 = this.utmSouth ? 1e7 : 0;
    this.k0 = 0.9996;
    etmerc.init.apply(this);
    this.forward = etmerc.forward;
    this.inverse = etmerc.inverse;
  }
  var names$r = ["Universal Transverse Mercator System", "utm"];
  const utm = {
    init: init$r,
    names: names$r,
    dependsOn
  };
  function srat(esinp, exp) {
    return Math.pow((1 - esinp) / (1 + esinp), exp);
  }
  var MAX_ITER$2 = 20;
  function init$q() {
    var sphi = Math.sin(this.lat0);
    var cphi = Math.cos(this.lat0);
    cphi *= cphi;
    this.rc = Math.sqrt(1 - this.es) / (1 - this.es * sphi * sphi);
    this.C = Math.sqrt(1 + this.es * cphi * cphi / (1 - this.es));
    this.phic0 = Math.asin(sphi / this.C);
    this.ratexp = 0.5 * this.C * this.e;
    this.K = Math.tan(0.5 * this.phic0 + FORTPI) / (Math.pow(Math.tan(0.5 * this.lat0 + FORTPI), this.C) * srat(this.e * sphi, this.ratexp));
  }
  function forward$q(p2) {
    var lon = p2.x;
    var lat = p2.y;
    p2.y = 2 * Math.atan(this.K * Math.pow(Math.tan(0.5 * lat + FORTPI), this.C) * srat(this.e * Math.sin(lat), this.ratexp)) - HALF_PI;
    p2.x = this.C * lon;
    return p2;
  }
  function inverse$q(p2) {
    var DEL_TOL = 1e-14;
    var lon = p2.x / this.C;
    var lat = p2.y;
    var num = Math.pow(Math.tan(0.5 * lat + FORTPI) / this.K, 1 / this.C);
    for (var i = MAX_ITER$2; i > 0; --i) {
      lat = 2 * Math.atan(num * srat(this.e * Math.sin(p2.y), -0.5 * this.e)) - HALF_PI;
      if (Math.abs(lat - p2.y) < DEL_TOL) {
        break;
      }
      p2.y = lat;
    }
    if (!i) {
      return null;
    }
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  var names$q = ["gauss"];
  const gauss = {
    init: init$q,
    forward: forward$q,
    inverse: inverse$q,
    names: names$q
  };
  function init$p() {
    gauss.init.apply(this);
    if (!this.rc) {
      return;
    }
    this.sinc0 = Math.sin(this.phic0);
    this.cosc0 = Math.cos(this.phic0);
    this.R2 = 2 * this.rc;
    if (!this.title) {
      this.title = "Oblique Stereographic Alternative";
    }
  }
  function forward$p(p2) {
    var sinc, cosc, cosl, k;
    p2.x = adjust_lon(p2.x - this.long0);
    gauss.forward.apply(this, [p2]);
    sinc = Math.sin(p2.y);
    cosc = Math.cos(p2.y);
    cosl = Math.cos(p2.x);
    k = this.k0 * this.R2 / (1 + this.sinc0 * sinc + this.cosc0 * cosc * cosl);
    p2.x = k * cosc * Math.sin(p2.x);
    p2.y = k * (this.cosc0 * sinc - this.sinc0 * cosc * cosl);
    p2.x = this.a * p2.x + this.x0;
    p2.y = this.a * p2.y + this.y0;
    return p2;
  }
  function inverse$p(p2) {
    var sinc, cosc, lon, lat, rho;
    p2.x = (p2.x - this.x0) / this.a;
    p2.y = (p2.y - this.y0) / this.a;
    p2.x /= this.k0;
    p2.y /= this.k0;
    if (rho = Math.sqrt(p2.x * p2.x + p2.y * p2.y)) {
      var c2 = 2 * Math.atan2(rho, this.R2);
      sinc = Math.sin(c2);
      cosc = Math.cos(c2);
      lat = Math.asin(cosc * this.sinc0 + p2.y * sinc * this.cosc0 / rho);
      lon = Math.atan2(p2.x * sinc, rho * this.cosc0 * cosc - p2.y * this.sinc0 * sinc);
    } else {
      lat = this.phic0;
      lon = 0;
    }
    p2.x = lon;
    p2.y = lat;
    gauss.inverse.apply(this, [p2]);
    p2.x = adjust_lon(p2.x + this.long0);
    return p2;
  }
  var names$p = ["Stereographic_North_Pole", "Oblique_Stereographic", "Polar_Stereographic", "sterea", "Oblique Stereographic Alternative", "Double_Stereographic"];
  const sterea = {
    init: init$p,
    forward: forward$p,
    inverse: inverse$p,
    names: names$p
  };
  function ssfn_(phit, sinphi, eccen) {
    sinphi *= eccen;
    return Math.tan(0.5 * (HALF_PI + phit)) * Math.pow((1 - sinphi) / (1 + sinphi), 0.5 * eccen);
  }
  function init$o() {
    this.coslat0 = Math.cos(this.lat0);
    this.sinlat0 = Math.sin(this.lat0);
    if (this.sphere) {
      if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN) {
        this.k0 = 0.5 * (1 + sign(this.lat0) * Math.sin(this.lat_ts));
      }
    } else {
      if (Math.abs(this.coslat0) <= EPSLN) {
        if (this.lat0 > 0) {
          this.con = 1;
        } else {
          this.con = -1;
        }
      }
      this.cons = Math.sqrt(Math.pow(1 + this.e, 1 + this.e) * Math.pow(1 - this.e, 1 - this.e));
      if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN) {
        this.k0 = 0.5 * this.cons * msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) / tsfnz(this.e, this.con * this.lat_ts, this.con * Math.sin(this.lat_ts));
      }
      this.ms1 = msfnz(this.e, this.sinlat0, this.coslat0);
      this.X0 = 2 * Math.atan(this.ssfn_(this.lat0, this.sinlat0, this.e)) - HALF_PI;
      this.cosX0 = Math.cos(this.X0);
      this.sinX0 = Math.sin(this.X0);
    }
  }
  function forward$o(p2) {
    var lon = p2.x;
    var lat = p2.y;
    var sinlat = Math.sin(lat);
    var coslat = Math.cos(lat);
    var A2, X, sinX, cosX, ts, rh;
    var dlon = adjust_lon(lon - this.long0);
    if (Math.abs(Math.abs(lon - this.long0) - Math.PI) <= EPSLN && Math.abs(lat + this.lat0) <= EPSLN) {
      p2.x = NaN;
      p2.y = NaN;
      return p2;
    }
    if (this.sphere) {
      A2 = 2 * this.k0 / (1 + this.sinlat0 * sinlat + this.coslat0 * coslat * Math.cos(dlon));
      p2.x = this.a * A2 * coslat * Math.sin(dlon) + this.x0;
      p2.y = this.a * A2 * (this.coslat0 * sinlat - this.sinlat0 * coslat * Math.cos(dlon)) + this.y0;
      return p2;
    } else {
      X = 2 * Math.atan(this.ssfn_(lat, sinlat, this.e)) - HALF_PI;
      cosX = Math.cos(X);
      sinX = Math.sin(X);
      if (Math.abs(this.coslat0) <= EPSLN) {
        ts = tsfnz(this.e, lat * this.con, this.con * sinlat);
        rh = 2 * this.a * this.k0 * ts / this.cons;
        p2.x = this.x0 + rh * Math.sin(lon - this.long0);
        p2.y = this.y0 - this.con * rh * Math.cos(lon - this.long0);
        return p2;
      } else if (Math.abs(this.sinlat0) < EPSLN) {
        A2 = 2 * this.a * this.k0 / (1 + cosX * Math.cos(dlon));
        p2.y = A2 * sinX;
      } else {
        A2 = 2 * this.a * this.k0 * this.ms1 / (this.cosX0 * (1 + this.sinX0 * sinX + this.cosX0 * cosX * Math.cos(dlon)));
        p2.y = A2 * (this.cosX0 * sinX - this.sinX0 * cosX * Math.cos(dlon)) + this.y0;
      }
      p2.x = A2 * cosX * Math.sin(dlon) + this.x0;
    }
    return p2;
  }
  function inverse$o(p2) {
    p2.x -= this.x0;
    p2.y -= this.y0;
    var lon, lat, ts, ce, Chi;
    var rh = Math.sqrt(p2.x * p2.x + p2.y * p2.y);
    if (this.sphere) {
      var c2 = 2 * Math.atan(rh / (2 * this.a * this.k0));
      lon = this.long0;
      lat = this.lat0;
      if (rh <= EPSLN) {
        p2.x = lon;
        p2.y = lat;
        return p2;
      }
      lat = Math.asin(Math.cos(c2) * this.sinlat0 + p2.y * Math.sin(c2) * this.coslat0 / rh);
      if (Math.abs(this.coslat0) < EPSLN) {
        if (this.lat0 > 0) {
          lon = adjust_lon(this.long0 + Math.atan2(p2.x, -1 * p2.y));
        } else {
          lon = adjust_lon(this.long0 + Math.atan2(p2.x, p2.y));
        }
      } else {
        lon = adjust_lon(this.long0 + Math.atan2(p2.x * Math.sin(c2), rh * this.coslat0 * Math.cos(c2) - p2.y * this.sinlat0 * Math.sin(c2)));
      }
      p2.x = lon;
      p2.y = lat;
      return p2;
    } else {
      if (Math.abs(this.coslat0) <= EPSLN) {
        if (rh <= EPSLN) {
          lat = this.lat0;
          lon = this.long0;
          p2.x = lon;
          p2.y = lat;
          return p2;
        }
        p2.x *= this.con;
        p2.y *= this.con;
        ts = rh * this.cons / (2 * this.a * this.k0);
        lat = this.con * phi2z(this.e, ts);
        lon = this.con * adjust_lon(this.con * this.long0 + Math.atan2(p2.x, -1 * p2.y));
      } else {
        ce = 2 * Math.atan(rh * this.cosX0 / (2 * this.a * this.k0 * this.ms1));
        lon = this.long0;
        if (rh <= EPSLN) {
          Chi = this.X0;
        } else {
          Chi = Math.asin(Math.cos(ce) * this.sinX0 + p2.y * Math.sin(ce) * this.cosX0 / rh);
          lon = adjust_lon(this.long0 + Math.atan2(p2.x * Math.sin(ce), rh * this.cosX0 * Math.cos(ce) - p2.y * this.sinX0 * Math.sin(ce)));
        }
        lat = -1 * phi2z(this.e, Math.tan(0.5 * (HALF_PI + Chi)));
      }
    }
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  var names$o = ["stere", "Stereographic_South_Pole", "Polar Stereographic (variant B)"];
  const stere = {
    init: init$o,
    forward: forward$o,
    inverse: inverse$o,
    names: names$o,
    ssfn_
  };
  function init$n() {
    var phy0 = this.lat0;
    this.lambda0 = this.long0;
    var sinPhy0 = Math.sin(phy0);
    var semiMajorAxis = this.a;
    var invF = this.rf;
    var flattening = 1 / invF;
    var e2 = 2 * flattening - Math.pow(flattening, 2);
    var e = this.e = Math.sqrt(e2);
    this.R = this.k0 * semiMajorAxis * Math.sqrt(1 - e2) / (1 - e2 * Math.pow(sinPhy0, 2));
    this.alpha = Math.sqrt(1 + e2 / (1 - e2) * Math.pow(Math.cos(phy0), 4));
    this.b0 = Math.asin(sinPhy0 / this.alpha);
    var k1 = Math.log(Math.tan(Math.PI / 4 + this.b0 / 2));
    var k2 = Math.log(Math.tan(Math.PI / 4 + phy0 / 2));
    var k3 = Math.log((1 + e * sinPhy0) / (1 - e * sinPhy0));
    this.K = k1 - this.alpha * k2 + this.alpha * e / 2 * k3;
  }
  function forward$n(p2) {
    var Sa1 = Math.log(Math.tan(Math.PI / 4 - p2.y / 2));
    var Sa2 = this.e / 2 * Math.log((1 + this.e * Math.sin(p2.y)) / (1 - this.e * Math.sin(p2.y)));
    var S = -this.alpha * (Sa1 + Sa2) + this.K;
    var b = 2 * (Math.atan(Math.exp(S)) - Math.PI / 4);
    var I2 = this.alpha * (p2.x - this.lambda0);
    var rotI = Math.atan(Math.sin(I2) / (Math.sin(this.b0) * Math.tan(b) + Math.cos(this.b0) * Math.cos(I2)));
    var rotB = Math.asin(Math.cos(this.b0) * Math.sin(b) - Math.sin(this.b0) * Math.cos(b) * Math.cos(I2));
    p2.y = this.R / 2 * Math.log((1 + Math.sin(rotB)) / (1 - Math.sin(rotB))) + this.y0;
    p2.x = this.R * rotI + this.x0;
    return p2;
  }
  function inverse$n(p2) {
    var Y = p2.x - this.x0;
    var X = p2.y - this.y0;
    var rotI = Y / this.R;
    var rotB = 2 * (Math.atan(Math.exp(X / this.R)) - Math.PI / 4);
    var b = Math.asin(Math.cos(this.b0) * Math.sin(rotB) + Math.sin(this.b0) * Math.cos(rotB) * Math.cos(rotI));
    var I2 = Math.atan(Math.sin(rotI) / (Math.cos(this.b0) * Math.cos(rotI) - Math.sin(this.b0) * Math.tan(rotB)));
    var lambda = this.lambda0 + I2 / this.alpha;
    var S = 0;
    var phy = b;
    var prevPhy = -1e3;
    var iteration = 0;
    while (Math.abs(phy - prevPhy) > 1e-7) {
      if (++iteration > 20) {
        return;
      }
      S = 1 / this.alpha * (Math.log(Math.tan(Math.PI / 4 + b / 2)) - this.K) + this.e * Math.log(Math.tan(Math.PI / 4 + Math.asin(this.e * Math.sin(phy)) / 2));
      prevPhy = phy;
      phy = 2 * Math.atan(Math.exp(S)) - Math.PI / 2;
    }
    p2.x = lambda;
    p2.y = phy;
    return p2;
  }
  var names$n = ["somerc"];
  const somerc = {
    init: init$n,
    forward: forward$n,
    inverse: inverse$n,
    names: names$n
  };
  var TOL = 1e-7;
  function isTypeA(P) {
    var typeAProjections = ["Hotine_Oblique_Mercator", "Hotine_Oblique_Mercator_Azimuth_Natural_Origin"];
    var projectionName = typeof P.PROJECTION === "object" ? Object.keys(P.PROJECTION)[0] : P.PROJECTION;
    return "no_uoff" in P || "no_off" in P || typeAProjections.indexOf(projectionName) !== -1;
  }
  function init$m() {
    var con, com, cosph0, D, F, H, L, sinph0, p2, J, gamma = 0, gamma0, lamc = 0, lam1 = 0, lam2 = 0, phi1 = 0, phi2 = 0, alpha_c = 0;
    this.no_off = isTypeA(this);
    this.no_rot = "no_rot" in this;
    var alp = false;
    if ("alpha" in this) {
      alp = true;
    }
    var gam = false;
    if ("rectified_grid_angle" in this) {
      gam = true;
    }
    if (alp) {
      alpha_c = this.alpha;
    }
    if (gam) {
      gamma = this.rectified_grid_angle * D2R$1;
    }
    if (alp || gam) {
      lamc = this.longc;
    } else {
      lam1 = this.long1;
      phi1 = this.lat1;
      lam2 = this.long2;
      phi2 = this.lat2;
      if (Math.abs(phi1 - phi2) <= TOL || (con = Math.abs(phi1)) <= TOL || Math.abs(con - HALF_PI) <= TOL || Math.abs(Math.abs(this.lat0) - HALF_PI) <= TOL || Math.abs(Math.abs(phi2) - HALF_PI) <= TOL) {
        throw new Error();
      }
    }
    var one_es = 1 - this.es;
    com = Math.sqrt(one_es);
    if (Math.abs(this.lat0) > EPSLN) {
      sinph0 = Math.sin(this.lat0);
      cosph0 = Math.cos(this.lat0);
      con = 1 - this.es * sinph0 * sinph0;
      this.B = cosph0 * cosph0;
      this.B = Math.sqrt(1 + this.es * this.B * this.B / one_es);
      this.A = this.B * this.k0 * com / con;
      D = this.B * com / (cosph0 * Math.sqrt(con));
      F = D * D - 1;
      if (F <= 0) {
        F = 0;
      } else {
        F = Math.sqrt(F);
        if (this.lat0 < 0) {
          F = -F;
        }
      }
      this.E = F += D;
      this.E *= Math.pow(tsfnz(this.e, this.lat0, sinph0), this.B);
    } else {
      this.B = 1 / com;
      this.A = this.k0;
      this.E = D = F = 1;
    }
    if (alp || gam) {
      if (alp) {
        gamma0 = Math.asin(Math.sin(alpha_c) / D);
        if (!gam) {
          gamma = alpha_c;
        }
      } else {
        gamma0 = gamma;
        alpha_c = Math.asin(D * Math.sin(gamma0));
      }
      this.lam0 = lamc - Math.asin(0.5 * (F - 1 / F) * Math.tan(gamma0)) / this.B;
    } else {
      H = Math.pow(tsfnz(this.e, phi1, Math.sin(phi1)), this.B);
      L = Math.pow(tsfnz(this.e, phi2, Math.sin(phi2)), this.B);
      F = this.E / H;
      p2 = (L - H) / (L + H);
      J = this.E * this.E;
      J = (J - L * H) / (J + L * H);
      con = lam1 - lam2;
      if (con < -Math.pi) {
        lam2 -= TWO_PI;
      } else if (con > Math.pi) {
        lam2 += TWO_PI;
      }
      this.lam0 = adjust_lon(0.5 * (lam1 + lam2) - Math.atan(J * Math.tan(0.5 * this.B * (lam1 - lam2)) / p2) / this.B);
      gamma0 = Math.atan(2 * Math.sin(this.B * adjust_lon(lam1 - this.lam0)) / (F - 1 / F));
      gamma = alpha_c = Math.asin(D * Math.sin(gamma0));
    }
    this.singam = Math.sin(gamma0);
    this.cosgam = Math.cos(gamma0);
    this.sinrot = Math.sin(gamma);
    this.cosrot = Math.cos(gamma);
    this.rB = 1 / this.B;
    this.ArB = this.A * this.rB;
    this.BrA = 1 / this.ArB;
    this.A * this.B;
    if (this.no_off) {
      this.u_0 = 0;
    } else {
      this.u_0 = Math.abs(this.ArB * Math.atan(Math.sqrt(D * D - 1) / Math.cos(alpha_c)));
      if (this.lat0 < 0) {
        this.u_0 = -this.u_0;
      }
    }
    F = 0.5 * gamma0;
    this.v_pole_n = this.ArB * Math.log(Math.tan(FORTPI - F));
    this.v_pole_s = this.ArB * Math.log(Math.tan(FORTPI + F));
  }
  function forward$m(p2) {
    var coords = {};
    var S, T, U, V2, W, temp, u, v2;
    p2.x = p2.x - this.lam0;
    if (Math.abs(Math.abs(p2.y) - HALF_PI) > EPSLN) {
      W = this.E / Math.pow(tsfnz(this.e, p2.y, Math.sin(p2.y)), this.B);
      temp = 1 / W;
      S = 0.5 * (W - temp);
      T = 0.5 * (W + temp);
      V2 = Math.sin(this.B * p2.x);
      U = (S * this.singam - V2 * this.cosgam) / T;
      if (Math.abs(Math.abs(U) - 1) < EPSLN) {
        throw new Error();
      }
      v2 = 0.5 * this.ArB * Math.log((1 - U) / (1 + U));
      temp = Math.cos(this.B * p2.x);
      if (Math.abs(temp) < TOL) {
        u = this.A * p2.x;
      } else {
        u = this.ArB * Math.atan2(S * this.cosgam + V2 * this.singam, temp);
      }
    } else {
      v2 = p2.y > 0 ? this.v_pole_n : this.v_pole_s;
      u = this.ArB * p2.y;
    }
    if (this.no_rot) {
      coords.x = u;
      coords.y = v2;
    } else {
      u -= this.u_0;
      coords.x = v2 * this.cosrot + u * this.sinrot;
      coords.y = u * this.cosrot - v2 * this.sinrot;
    }
    coords.x = this.a * coords.x + this.x0;
    coords.y = this.a * coords.y + this.y0;
    return coords;
  }
  function inverse$m(p2) {
    var u, v2, Qp, Sp, Tp, Vp, Up;
    var coords = {};
    p2.x = (p2.x - this.x0) * (1 / this.a);
    p2.y = (p2.y - this.y0) * (1 / this.a);
    if (this.no_rot) {
      v2 = p2.y;
      u = p2.x;
    } else {
      v2 = p2.x * this.cosrot - p2.y * this.sinrot;
      u = p2.y * this.cosrot + p2.x * this.sinrot + this.u_0;
    }
    Qp = Math.exp(-this.BrA * v2);
    Sp = 0.5 * (Qp - 1 / Qp);
    Tp = 0.5 * (Qp + 1 / Qp);
    Vp = Math.sin(this.BrA * u);
    Up = (Vp * this.cosgam + Sp * this.singam) / Tp;
    if (Math.abs(Math.abs(Up) - 1) < EPSLN) {
      coords.x = 0;
      coords.y = Up < 0 ? -HALF_PI : HALF_PI;
    } else {
      coords.y = this.E / Math.sqrt((1 + Up) / (1 - Up));
      coords.y = phi2z(this.e, Math.pow(coords.y, 1 / this.B));
      if (coords.y === Infinity) {
        throw new Error();
      }
      coords.x = -this.rB * Math.atan2(Sp * this.cosgam - Vp * this.singam, Math.cos(this.BrA * u));
    }
    coords.x += this.lam0;
    return coords;
  }
  var names$m = ["Hotine_Oblique_Mercator", "Hotine Oblique Mercator", "Hotine_Oblique_Mercator_Azimuth_Natural_Origin", "Hotine_Oblique_Mercator_Two_Point_Natural_Origin", "Hotine_Oblique_Mercator_Azimuth_Center", "Oblique_Mercator", "omerc"];
  const omerc = {
    init: init$m,
    forward: forward$m,
    inverse: inverse$m,
    names: names$m
  };
  function init$l() {
    if (!this.lat2) {
      this.lat2 = this.lat1;
    }
    if (!this.k0) {
      this.k0 = 1;
    }
    this.x0 = this.x0 || 0;
    this.y0 = this.y0 || 0;
    if (Math.abs(this.lat1 + this.lat2) < EPSLN) {
      return;
    }
    var temp = this.b / this.a;
    this.e = Math.sqrt(1 - temp * temp);
    var sin1 = Math.sin(this.lat1);
    var cos1 = Math.cos(this.lat1);
    var ms1 = msfnz(this.e, sin1, cos1);
    var ts1 = tsfnz(this.e, this.lat1, sin1);
    var sin2 = Math.sin(this.lat2);
    var cos2 = Math.cos(this.lat2);
    var ms2 = msfnz(this.e, sin2, cos2);
    var ts2 = tsfnz(this.e, this.lat2, sin2);
    var ts0 = tsfnz(this.e, this.lat0, Math.sin(this.lat0));
    if (Math.abs(this.lat1 - this.lat2) > EPSLN) {
      this.ns = Math.log(ms1 / ms2) / Math.log(ts1 / ts2);
    } else {
      this.ns = sin1;
    }
    if (isNaN(this.ns)) {
      this.ns = sin1;
    }
    this.f0 = ms1 / (this.ns * Math.pow(ts1, this.ns));
    this.rh = this.a * this.f0 * Math.pow(ts0, this.ns);
    if (!this.title) {
      this.title = "Lambert Conformal Conic";
    }
  }
  function forward$l(p2) {
    var lon = p2.x;
    var lat = p2.y;
    if (Math.abs(2 * Math.abs(lat) - Math.PI) <= EPSLN) {
      lat = sign(lat) * (HALF_PI - 2 * EPSLN);
    }
    var con = Math.abs(Math.abs(lat) - HALF_PI);
    var ts, rh1;
    if (con > EPSLN) {
      ts = tsfnz(this.e, lat, Math.sin(lat));
      rh1 = this.a * this.f0 * Math.pow(ts, this.ns);
    } else {
      con = lat * this.ns;
      if (con <= 0) {
        return null;
      }
      rh1 = 0;
    }
    var theta = this.ns * adjust_lon(lon - this.long0);
    p2.x = this.k0 * (rh1 * Math.sin(theta)) + this.x0;
    p2.y = this.k0 * (this.rh - rh1 * Math.cos(theta)) + this.y0;
    return p2;
  }
  function inverse$l(p2) {
    var rh1, con, ts;
    var lat, lon;
    var x = (p2.x - this.x0) / this.k0;
    var y2 = this.rh - (p2.y - this.y0) / this.k0;
    if (this.ns > 0) {
      rh1 = Math.sqrt(x * x + y2 * y2);
      con = 1;
    } else {
      rh1 = -Math.sqrt(x * x + y2 * y2);
      con = -1;
    }
    var theta = 0;
    if (rh1 !== 0) {
      theta = Math.atan2(con * x, con * y2);
    }
    if (rh1 !== 0 || this.ns > 0) {
      con = 1 / this.ns;
      ts = Math.pow(rh1 / (this.a * this.f0), con);
      lat = phi2z(this.e, ts);
      if (lat === -9999) {
        return null;
      }
    } else {
      lat = -HALF_PI;
    }
    lon = adjust_lon(theta / this.ns + this.long0);
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  var names$l = [
    "Lambert Tangential Conformal Conic Projection",
    "Lambert_Conformal_Conic",
    "Lambert_Conformal_Conic_1SP",
    "Lambert_Conformal_Conic_2SP",
    "lcc",
    "Lambert Conic Conformal (1SP)",
    "Lambert Conic Conformal (2SP)"
  ];
  const lcc = {
    init: init$l,
    forward: forward$l,
    inverse: inverse$l,
    names: names$l
  };
  function init$k() {
    this.a = 6377397155e-3;
    this.es = 0.006674372230614;
    this.e = Math.sqrt(this.es);
    if (!this.lat0) {
      this.lat0 = 0.863937979737193;
    }
    if (!this.long0) {
      this.long0 = 0.7417649320975901 - 0.308341501185665;
    }
    if (!this.k0) {
      this.k0 = 0.9999;
    }
    this.s45 = 0.785398163397448;
    this.s90 = 2 * this.s45;
    this.fi0 = this.lat0;
    this.e2 = this.es;
    this.e = Math.sqrt(this.e2);
    this.alfa = Math.sqrt(1 + this.e2 * Math.pow(Math.cos(this.fi0), 4) / (1 - this.e2));
    this.uq = 1.04216856380474;
    this.u0 = Math.asin(Math.sin(this.fi0) / this.alfa);
    this.g = Math.pow((1 + this.e * Math.sin(this.fi0)) / (1 - this.e * Math.sin(this.fi0)), this.alfa * this.e / 2);
    this.k = Math.tan(this.u0 / 2 + this.s45) / Math.pow(Math.tan(this.fi0 / 2 + this.s45), this.alfa) * this.g;
    this.k1 = this.k0;
    this.n0 = this.a * Math.sqrt(1 - this.e2) / (1 - this.e2 * Math.pow(Math.sin(this.fi0), 2));
    this.s0 = 1.37008346281555;
    this.n = Math.sin(this.s0);
    this.ro0 = this.k1 * this.n0 / Math.tan(this.s0);
    this.ad = this.s90 - this.uq;
  }
  function forward$k(p2) {
    var gfi, u, deltav, s, d, eps, ro;
    var lon = p2.x;
    var lat = p2.y;
    var delta_lon = adjust_lon(lon - this.long0);
    gfi = Math.pow((1 + this.e * Math.sin(lat)) / (1 - this.e * Math.sin(lat)), this.alfa * this.e / 2);
    u = 2 * (Math.atan(this.k * Math.pow(Math.tan(lat / 2 + this.s45), this.alfa) / gfi) - this.s45);
    deltav = -delta_lon * this.alfa;
    s = Math.asin(Math.cos(this.ad) * Math.sin(u) + Math.sin(this.ad) * Math.cos(u) * Math.cos(deltav));
    d = Math.asin(Math.cos(u) * Math.sin(deltav) / Math.cos(s));
    eps = this.n * d;
    ro = this.ro0 * Math.pow(Math.tan(this.s0 / 2 + this.s45), this.n) / Math.pow(Math.tan(s / 2 + this.s45), this.n);
    p2.y = ro * Math.cos(eps) / 1;
    p2.x = ro * Math.sin(eps) / 1;
    if (!this.czech) {
      p2.y *= -1;
      p2.x *= -1;
    }
    return p2;
  }
  function inverse$k(p2) {
    var u, deltav, s, d, eps, ro, fi1;
    var ok;
    var tmp = p2.x;
    p2.x = p2.y;
    p2.y = tmp;
    if (!this.czech) {
      p2.y *= -1;
      p2.x *= -1;
    }
    ro = Math.sqrt(p2.x * p2.x + p2.y * p2.y);
    eps = Math.atan2(p2.y, p2.x);
    d = eps / Math.sin(this.s0);
    s = 2 * (Math.atan(Math.pow(this.ro0 / ro, 1 / this.n) * Math.tan(this.s0 / 2 + this.s45)) - this.s45);
    u = Math.asin(Math.cos(this.ad) * Math.sin(s) - Math.sin(this.ad) * Math.cos(s) * Math.cos(d));
    deltav = Math.asin(Math.cos(s) * Math.sin(d) / Math.cos(u));
    p2.x = this.long0 - deltav / this.alfa;
    fi1 = u;
    ok = 0;
    var iter = 0;
    do {
      p2.y = 2 * (Math.atan(Math.pow(this.k, -1 / this.alfa) * Math.pow(Math.tan(u / 2 + this.s45), 1 / this.alfa) * Math.pow((1 + this.e * Math.sin(fi1)) / (1 - this.e * Math.sin(fi1)), this.e / 2)) - this.s45);
      if (Math.abs(fi1 - p2.y) < 1e-10) {
        ok = 1;
      }
      fi1 = p2.y;
      iter += 1;
    } while (ok === 0 && iter < 15);
    if (iter >= 15) {
      return null;
    }
    return p2;
  }
  var names$k = ["Krovak", "krovak"];
  const krovak = {
    init: init$k,
    forward: forward$k,
    inverse: inverse$k,
    names: names$k
  };
  function mlfn(e0, e1, e2, e3, phi) {
    return e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi);
  }
  function e0fn(x) {
    return 1 - 0.25 * x * (1 + x / 16 * (3 + 1.25 * x));
  }
  function e1fn(x) {
    return 0.375 * x * (1 + 0.25 * x * (1 + 0.46875 * x));
  }
  function e2fn(x) {
    return 0.05859375 * x * x * (1 + 0.75 * x);
  }
  function e3fn(x) {
    return x * x * x * (35 / 3072);
  }
  function gN(a, e, sinphi) {
    var temp = e * sinphi;
    return a / Math.sqrt(1 - temp * temp);
  }
  function adjust_lat(x) {
    return Math.abs(x) < HALF_PI ? x : x - sign(x) * Math.PI;
  }
  function imlfn(ml, e0, e1, e2, e3) {
    var phi;
    var dphi;
    phi = ml / e0;
    for (var i = 0; i < 15; i++) {
      dphi = (ml - (e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi))) / (e0 - 2 * e1 * Math.cos(2 * phi) + 4 * e2 * Math.cos(4 * phi) - 6 * e3 * Math.cos(6 * phi));
      phi += dphi;
      if (Math.abs(dphi) <= 1e-10) {
        return phi;
      }
    }
    return NaN;
  }
  function init$j() {
    if (!this.sphere) {
      this.e0 = e0fn(this.es);
      this.e1 = e1fn(this.es);
      this.e2 = e2fn(this.es);
      this.e3 = e3fn(this.es);
      this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);
    }
  }
  function forward$j(p2) {
    var x, y2;
    var lam = p2.x;
    var phi = p2.y;
    lam = adjust_lon(lam - this.long0);
    if (this.sphere) {
      x = this.a * Math.asin(Math.cos(phi) * Math.sin(lam));
      y2 = this.a * (Math.atan2(Math.tan(phi), Math.cos(lam)) - this.lat0);
    } else {
      var sinphi = Math.sin(phi);
      var cosphi = Math.cos(phi);
      var nl = gN(this.a, this.e, sinphi);
      var tl = Math.tan(phi) * Math.tan(phi);
      var al = lam * Math.cos(phi);
      var asq = al * al;
      var cl = this.es * cosphi * cosphi / (1 - this.es);
      var ml = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi);
      x = nl * al * (1 - asq * tl * (1 / 6 - (8 - tl + 8 * cl) * asq / 120));
      y2 = ml - this.ml0 + nl * sinphi / cosphi * asq * (0.5 + (5 - tl + 6 * cl) * asq / 24);
    }
    p2.x = x + this.x0;
    p2.y = y2 + this.y0;
    return p2;
  }
  function inverse$j(p2) {
    p2.x -= this.x0;
    p2.y -= this.y0;
    var x = p2.x / this.a;
    var y2 = p2.y / this.a;
    var phi, lam;
    if (this.sphere) {
      var dd = y2 + this.lat0;
      phi = Math.asin(Math.sin(dd) * Math.cos(x));
      lam = Math.atan2(Math.tan(x), Math.cos(dd));
    } else {
      var ml1 = this.ml0 / this.a + y2;
      var phi1 = imlfn(ml1, this.e0, this.e1, this.e2, this.e3);
      if (Math.abs(Math.abs(phi1) - HALF_PI) <= EPSLN) {
        p2.x = this.long0;
        p2.y = HALF_PI;
        if (y2 < 0) {
          p2.y *= -1;
        }
        return p2;
      }
      var nl1 = gN(this.a, this.e, Math.sin(phi1));
      var rl1 = nl1 * nl1 * nl1 / this.a / this.a * (1 - this.es);
      var tl1 = Math.pow(Math.tan(phi1), 2);
      var dl = x * this.a / nl1;
      var dsq = dl * dl;
      phi = phi1 - nl1 * Math.tan(phi1) / rl1 * dl * dl * (0.5 - (1 + 3 * tl1) * dl * dl / 24);
      lam = dl * (1 - dsq * (tl1 / 3 + (1 + 3 * tl1) * tl1 * dsq / 15)) / Math.cos(phi1);
    }
    p2.x = adjust_lon(lam + this.long0);
    p2.y = adjust_lat(phi);
    return p2;
  }
  var names$j = ["Cassini", "Cassini_Soldner", "cass"];
  const cass = {
    init: init$j,
    forward: forward$j,
    inverse: inverse$j,
    names: names$j
  };
  function qsfnz(eccent, sinphi) {
    var con;
    if (eccent > 1e-7) {
      con = eccent * sinphi;
      return (1 - eccent * eccent) * (sinphi / (1 - con * con) - 0.5 / eccent * Math.log((1 - con) / (1 + con)));
    } else {
      return 2 * sinphi;
    }
  }
  var S_POLE = 1;
  var N_POLE = 2;
  var EQUIT = 3;
  var OBLIQ = 4;
  function init$i() {
    var t = Math.abs(this.lat0);
    if (Math.abs(t - HALF_PI) < EPSLN) {
      this.mode = this.lat0 < 0 ? this.S_POLE : this.N_POLE;
    } else if (Math.abs(t) < EPSLN) {
      this.mode = this.EQUIT;
    } else {
      this.mode = this.OBLIQ;
    }
    if (this.es > 0) {
      var sinphi;
      this.qp = qsfnz(this.e, 1);
      this.mmf = 0.5 / (1 - this.es);
      this.apa = authset(this.es);
      switch (this.mode) {
        case this.N_POLE:
          this.dd = 1;
          break;
        case this.S_POLE:
          this.dd = 1;
          break;
        case this.EQUIT:
          this.rq = Math.sqrt(0.5 * this.qp);
          this.dd = 1 / this.rq;
          this.xmf = 1;
          this.ymf = 0.5 * this.qp;
          break;
        case this.OBLIQ:
          this.rq = Math.sqrt(0.5 * this.qp);
          sinphi = Math.sin(this.lat0);
          this.sinb1 = qsfnz(this.e, sinphi) / this.qp;
          this.cosb1 = Math.sqrt(1 - this.sinb1 * this.sinb1);
          this.dd = Math.cos(this.lat0) / (Math.sqrt(1 - this.es * sinphi * sinphi) * this.rq * this.cosb1);
          this.ymf = (this.xmf = this.rq) / this.dd;
          this.xmf *= this.dd;
          break;
      }
    } else {
      if (this.mode === this.OBLIQ) {
        this.sinph0 = Math.sin(this.lat0);
        this.cosph0 = Math.cos(this.lat0);
      }
    }
  }
  function forward$i(p2) {
    var x, y2, coslam, sinlam, sinphi, q, sinb, cosb, b, cosphi;
    var lam = p2.x;
    var phi = p2.y;
    lam = adjust_lon(lam - this.long0);
    if (this.sphere) {
      sinphi = Math.sin(phi);
      cosphi = Math.cos(phi);
      coslam = Math.cos(lam);
      if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
        y2 = this.mode === this.EQUIT ? 1 + cosphi * coslam : 1 + this.sinph0 * sinphi + this.cosph0 * cosphi * coslam;
        if (y2 <= EPSLN) {
          return null;
        }
        y2 = Math.sqrt(2 / y2);
        x = y2 * cosphi * Math.sin(lam);
        y2 *= this.mode === this.EQUIT ? sinphi : this.cosph0 * sinphi - this.sinph0 * cosphi * coslam;
      } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
        if (this.mode === this.N_POLE) {
          coslam = -coslam;
        }
        if (Math.abs(phi + this.lat0) < EPSLN) {
          return null;
        }
        y2 = FORTPI - phi * 0.5;
        y2 = 2 * (this.mode === this.S_POLE ? Math.cos(y2) : Math.sin(y2));
        x = y2 * Math.sin(lam);
        y2 *= coslam;
      }
    } else {
      sinb = 0;
      cosb = 0;
      b = 0;
      coslam = Math.cos(lam);
      sinlam = Math.sin(lam);
      sinphi = Math.sin(phi);
      q = qsfnz(this.e, sinphi);
      if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
        sinb = q / this.qp;
        cosb = Math.sqrt(1 - sinb * sinb);
      }
      switch (this.mode) {
        case this.OBLIQ:
          b = 1 + this.sinb1 * sinb + this.cosb1 * cosb * coslam;
          break;
        case this.EQUIT:
          b = 1 + cosb * coslam;
          break;
        case this.N_POLE:
          b = HALF_PI + phi;
          q = this.qp - q;
          break;
        case this.S_POLE:
          b = phi - HALF_PI;
          q = this.qp + q;
          break;
      }
      if (Math.abs(b) < EPSLN) {
        return null;
      }
      switch (this.mode) {
        case this.OBLIQ:
        case this.EQUIT:
          b = Math.sqrt(2 / b);
          if (this.mode === this.OBLIQ) {
            y2 = this.ymf * b * (this.cosb1 * sinb - this.sinb1 * cosb * coslam);
          } else {
            y2 = (b = Math.sqrt(2 / (1 + cosb * coslam))) * sinb * this.ymf;
          }
          x = this.xmf * b * cosb * sinlam;
          break;
        case this.N_POLE:
        case this.S_POLE:
          if (q >= 0) {
            x = (b = Math.sqrt(q)) * sinlam;
            y2 = coslam * (this.mode === this.S_POLE ? b : -b);
          } else {
            x = y2 = 0;
          }
          break;
      }
    }
    p2.x = this.a * x + this.x0;
    p2.y = this.a * y2 + this.y0;
    return p2;
  }
  function inverse$i(p2) {
    p2.x -= this.x0;
    p2.y -= this.y0;
    var x = p2.x / this.a;
    var y2 = p2.y / this.a;
    var lam, phi, cCe, sCe, q, rho, ab;
    if (this.sphere) {
      var cosz = 0, rh, sinz = 0;
      rh = Math.sqrt(x * x + y2 * y2);
      phi = rh * 0.5;
      if (phi > 1) {
        return null;
      }
      phi = 2 * Math.asin(phi);
      if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
        sinz = Math.sin(phi);
        cosz = Math.cos(phi);
      }
      switch (this.mode) {
        case this.EQUIT:
          phi = Math.abs(rh) <= EPSLN ? 0 : Math.asin(y2 * sinz / rh);
          x *= sinz;
          y2 = cosz * rh;
          break;
        case this.OBLIQ:
          phi = Math.abs(rh) <= EPSLN ? this.lat0 : Math.asin(cosz * this.sinph0 + y2 * sinz * this.cosph0 / rh);
          x *= sinz * this.cosph0;
          y2 = (cosz - Math.sin(phi) * this.sinph0) * rh;
          break;
        case this.N_POLE:
          y2 = -y2;
          phi = HALF_PI - phi;
          break;
        case this.S_POLE:
          phi -= HALF_PI;
          break;
      }
      lam = y2 === 0 && (this.mode === this.EQUIT || this.mode === this.OBLIQ) ? 0 : Math.atan2(x, y2);
    } else {
      ab = 0;
      if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
        x /= this.dd;
        y2 *= this.dd;
        rho = Math.sqrt(x * x + y2 * y2);
        if (rho < EPSLN) {
          p2.x = this.long0;
          p2.y = this.lat0;
          return p2;
        }
        sCe = 2 * Math.asin(0.5 * rho / this.rq);
        cCe = Math.cos(sCe);
        x *= sCe = Math.sin(sCe);
        if (this.mode === this.OBLIQ) {
          ab = cCe * this.sinb1 + y2 * sCe * this.cosb1 / rho;
          q = this.qp * ab;
          y2 = rho * this.cosb1 * cCe - y2 * this.sinb1 * sCe;
        } else {
          ab = y2 * sCe / rho;
          q = this.qp * ab;
          y2 = rho * cCe;
        }
      } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
        if (this.mode === this.N_POLE) {
          y2 = -y2;
        }
        q = x * x + y2 * y2;
        if (!q) {
          p2.x = this.long0;
          p2.y = this.lat0;
          return p2;
        }
        ab = 1 - q / this.qp;
        if (this.mode === this.S_POLE) {
          ab = -ab;
        }
      }
      lam = Math.atan2(x, y2);
      phi = authlat(Math.asin(ab), this.apa);
    }
    p2.x = adjust_lon(this.long0 + lam);
    p2.y = phi;
    return p2;
  }
  var P00 = 0.3333333333333333;
  var P01 = 0.17222222222222222;
  var P02 = 0.10257936507936508;
  var P10 = 0.06388888888888888;
  var P11 = 0.0664021164021164;
  var P20 = 0.016415012942191543;
  function authset(es) {
    var t;
    var APA = [];
    APA[0] = es * P00;
    t = es * es;
    APA[0] += t * P01;
    APA[1] = t * P10;
    t *= es;
    APA[0] += t * P02;
    APA[1] += t * P11;
    APA[2] = t * P20;
    return APA;
  }
  function authlat(beta, APA) {
    var t = beta + beta;
    return beta + APA[0] * Math.sin(t) + APA[1] * Math.sin(t + t) + APA[2] * Math.sin(t + t + t);
  }
  var names$i = ["Lambert Azimuthal Equal Area", "Lambert_Azimuthal_Equal_Area", "laea"];
  const laea = {
    init: init$i,
    forward: forward$i,
    inverse: inverse$i,
    names: names$i,
    S_POLE,
    N_POLE,
    EQUIT,
    OBLIQ
  };
  function asinz(x) {
    if (Math.abs(x) > 1) {
      x = x > 1 ? 1 : -1;
    }
    return Math.asin(x);
  }
  function init$h() {
    if (Math.abs(this.lat1 + this.lat2) < EPSLN) {
      return;
    }
    this.temp = this.b / this.a;
    this.es = 1 - Math.pow(this.temp, 2);
    this.e3 = Math.sqrt(this.es);
    this.sin_po = Math.sin(this.lat1);
    this.cos_po = Math.cos(this.lat1);
    this.t1 = this.sin_po;
    this.con = this.sin_po;
    this.ms1 = msfnz(this.e3, this.sin_po, this.cos_po);
    this.qs1 = qsfnz(this.e3, this.sin_po);
    this.sin_po = Math.sin(this.lat2);
    this.cos_po = Math.cos(this.lat2);
    this.t2 = this.sin_po;
    this.ms2 = msfnz(this.e3, this.sin_po, this.cos_po);
    this.qs2 = qsfnz(this.e3, this.sin_po);
    this.sin_po = Math.sin(this.lat0);
    this.cos_po = Math.cos(this.lat0);
    this.t3 = this.sin_po;
    this.qs0 = qsfnz(this.e3, this.sin_po);
    if (Math.abs(this.lat1 - this.lat2) > EPSLN) {
      this.ns0 = (this.ms1 * this.ms1 - this.ms2 * this.ms2) / (this.qs2 - this.qs1);
    } else {
      this.ns0 = this.con;
    }
    this.c = this.ms1 * this.ms1 + this.ns0 * this.qs1;
    this.rh = this.a * Math.sqrt(this.c - this.ns0 * this.qs0) / this.ns0;
  }
  function forward$h(p2) {
    var lon = p2.x;
    var lat = p2.y;
    this.sin_phi = Math.sin(lat);
    this.cos_phi = Math.cos(lat);
    var qs = qsfnz(this.e3, this.sin_phi);
    var rh1 = this.a * Math.sqrt(this.c - this.ns0 * qs) / this.ns0;
    var theta = this.ns0 * adjust_lon(lon - this.long0);
    var x = rh1 * Math.sin(theta) + this.x0;
    var y2 = this.rh - rh1 * Math.cos(theta) + this.y0;
    p2.x = x;
    p2.y = y2;
    return p2;
  }
  function inverse$h(p2) {
    var rh1, qs, con, theta, lon, lat;
    p2.x -= this.x0;
    p2.y = this.rh - p2.y + this.y0;
    if (this.ns0 >= 0) {
      rh1 = Math.sqrt(p2.x * p2.x + p2.y * p2.y);
      con = 1;
    } else {
      rh1 = -Math.sqrt(p2.x * p2.x + p2.y * p2.y);
      con = -1;
    }
    theta = 0;
    if (rh1 !== 0) {
      theta = Math.atan2(con * p2.x, con * p2.y);
    }
    con = rh1 * this.ns0 / this.a;
    if (this.sphere) {
      lat = Math.asin((this.c - con * con) / (2 * this.ns0));
    } else {
      qs = (this.c - con * con) / this.ns0;
      lat = this.phi1z(this.e3, qs);
    }
    lon = adjust_lon(theta / this.ns0 + this.long0);
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  function phi1z(eccent, qs) {
    var sinphi, cosphi, con, com, dphi;
    var phi = asinz(0.5 * qs);
    if (eccent < EPSLN) {
      return phi;
    }
    var eccnts = eccent * eccent;
    for (var i = 1; i <= 25; i++) {
      sinphi = Math.sin(phi);
      cosphi = Math.cos(phi);
      con = eccent * sinphi;
      com = 1 - con * con;
      dphi = 0.5 * com * com / cosphi * (qs / (1 - eccnts) - sinphi / com + 0.5 / eccent * Math.log((1 - con) / (1 + con)));
      phi = phi + dphi;
      if (Math.abs(dphi) <= 1e-7) {
        return phi;
      }
    }
    return null;
  }
  var names$h = ["Albers_Conic_Equal_Area", "Albers", "aea"];
  const aea = {
    init: init$h,
    forward: forward$h,
    inverse: inverse$h,
    names: names$h,
    phi1z
  };
  function init$g() {
    this.sin_p14 = Math.sin(this.lat0);
    this.cos_p14 = Math.cos(this.lat0);
    this.infinity_dist = 1e3 * this.a;
    this.rc = 1;
  }
  function forward$g(p2) {
    var sinphi, cosphi;
    var dlon;
    var coslon;
    var ksp;
    var g;
    var x, y2;
    var lon = p2.x;
    var lat = p2.y;
    dlon = adjust_lon(lon - this.long0);
    sinphi = Math.sin(lat);
    cosphi = Math.cos(lat);
    coslon = Math.cos(dlon);
    g = this.sin_p14 * sinphi + this.cos_p14 * cosphi * coslon;
    ksp = 1;
    if (g > 0 || Math.abs(g) <= EPSLN) {
      x = this.x0 + this.a * ksp * cosphi * Math.sin(dlon) / g;
      y2 = this.y0 + this.a * ksp * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon) / g;
    } else {
      x = this.x0 + this.infinity_dist * cosphi * Math.sin(dlon);
      y2 = this.y0 + this.infinity_dist * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon);
    }
    p2.x = x;
    p2.y = y2;
    return p2;
  }
  function inverse$g(p2) {
    var rh;
    var sinc, cosc;
    var c2;
    var lon, lat;
    p2.x = (p2.x - this.x0) / this.a;
    p2.y = (p2.y - this.y0) / this.a;
    p2.x /= this.k0;
    p2.y /= this.k0;
    if (rh = Math.sqrt(p2.x * p2.x + p2.y * p2.y)) {
      c2 = Math.atan2(rh, this.rc);
      sinc = Math.sin(c2);
      cosc = Math.cos(c2);
      lat = asinz(cosc * this.sin_p14 + p2.y * sinc * this.cos_p14 / rh);
      lon = Math.atan2(p2.x * sinc, rh * this.cos_p14 * cosc - p2.y * this.sin_p14 * sinc);
      lon = adjust_lon(this.long0 + lon);
    } else {
      lat = this.phic0;
      lon = 0;
    }
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  var names$g = ["gnom"];
  const gnom = {
    init: init$g,
    forward: forward$g,
    inverse: inverse$g,
    names: names$g
  };
  function iqsfnz(eccent, q) {
    var temp = 1 - (1 - eccent * eccent) / (2 * eccent) * Math.log((1 - eccent) / (1 + eccent));
    if (Math.abs(Math.abs(q) - temp) < 1e-6) {
      if (q < 0) {
        return -1 * HALF_PI;
      } else {
        return HALF_PI;
      }
    }
    var phi = Math.asin(0.5 * q);
    var dphi;
    var sin_phi;
    var cos_phi;
    var con;
    for (var i = 0; i < 30; i++) {
      sin_phi = Math.sin(phi);
      cos_phi = Math.cos(phi);
      con = eccent * sin_phi;
      dphi = Math.pow(1 - con * con, 2) / (2 * cos_phi) * (q / (1 - eccent * eccent) - sin_phi / (1 - con * con) + 0.5 / eccent * Math.log((1 - con) / (1 + con)));
      phi += dphi;
      if (Math.abs(dphi) <= 1e-10) {
        return phi;
      }
    }
    return NaN;
  }
  function init$f() {
    if (!this.sphere) {
      this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));
    }
  }
  function forward$f(p2) {
    var lon = p2.x;
    var lat = p2.y;
    var x, y2;
    var dlon = adjust_lon(lon - this.long0);
    if (this.sphere) {
      x = this.x0 + this.a * dlon * Math.cos(this.lat_ts);
      y2 = this.y0 + this.a * Math.sin(lat) / Math.cos(this.lat_ts);
    } else {
      var qs = qsfnz(this.e, Math.sin(lat));
      x = this.x0 + this.a * this.k0 * dlon;
      y2 = this.y0 + this.a * qs * 0.5 / this.k0;
    }
    p2.x = x;
    p2.y = y2;
    return p2;
  }
  function inverse$f(p2) {
    p2.x -= this.x0;
    p2.y -= this.y0;
    var lon, lat;
    if (this.sphere) {
      lon = adjust_lon(this.long0 + p2.x / this.a / Math.cos(this.lat_ts));
      lat = Math.asin(p2.y / this.a * Math.cos(this.lat_ts));
    } else {
      lat = iqsfnz(this.e, 2 * p2.y * this.k0 / this.a);
      lon = adjust_lon(this.long0 + p2.x / (this.a * this.k0));
    }
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  var names$f = ["cea"];
  const cea = {
    init: init$f,
    forward: forward$f,
    inverse: inverse$f,
    names: names$f
  };
  function init$e() {
    this.x0 = this.x0 || 0;
    this.y0 = this.y0 || 0;
    this.lat0 = this.lat0 || 0;
    this.long0 = this.long0 || 0;
    this.lat_ts = this.lat_ts || 0;
    this.title = this.title || "Equidistant Cylindrical (Plate Carre)";
    this.rc = Math.cos(this.lat_ts);
  }
  function forward$e(p2) {
    var lon = p2.x;
    var lat = p2.y;
    var dlon = adjust_lon(lon - this.long0);
    var dlat = adjust_lat(lat - this.lat0);
    p2.x = this.x0 + this.a * dlon * this.rc;
    p2.y = this.y0 + this.a * dlat;
    return p2;
  }
  function inverse$e(p2) {
    var x = p2.x;
    var y2 = p2.y;
    p2.x = adjust_lon(this.long0 + (x - this.x0) / (this.a * this.rc));
    p2.y = adjust_lat(this.lat0 + (y2 - this.y0) / this.a);
    return p2;
  }
  var names$e = ["Equirectangular", "Equidistant_Cylindrical", "eqc"];
  const eqc = {
    init: init$e,
    forward: forward$e,
    inverse: inverse$e,
    names: names$e
  };
  var MAX_ITER$1 = 20;
  function init$d() {
    this.temp = this.b / this.a;
    this.es = 1 - Math.pow(this.temp, 2);
    this.e = Math.sqrt(this.es);
    this.e0 = e0fn(this.es);
    this.e1 = e1fn(this.es);
    this.e2 = e2fn(this.es);
    this.e3 = e3fn(this.es);
    this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);
  }
  function forward$d(p2) {
    var lon = p2.x;
    var lat = p2.y;
    var x, y2, el;
    var dlon = adjust_lon(lon - this.long0);
    el = dlon * Math.sin(lat);
    if (this.sphere) {
      if (Math.abs(lat) <= EPSLN) {
        x = this.a * dlon;
        y2 = -1 * this.a * this.lat0;
      } else {
        x = this.a * Math.sin(el) / Math.tan(lat);
        y2 = this.a * (adjust_lat(lat - this.lat0) + (1 - Math.cos(el)) / Math.tan(lat));
      }
    } else {
      if (Math.abs(lat) <= EPSLN) {
        x = this.a * dlon;
        y2 = -1 * this.ml0;
      } else {
        var nl = gN(this.a, this.e, Math.sin(lat)) / Math.tan(lat);
        x = nl * Math.sin(el);
        y2 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, lat) - this.ml0 + nl * (1 - Math.cos(el));
      }
    }
    p2.x = x + this.x0;
    p2.y = y2 + this.y0;
    return p2;
  }
  function inverse$d(p2) {
    var lon, lat, x, y2, i;
    var al, bl;
    var phi, dphi;
    x = p2.x - this.x0;
    y2 = p2.y - this.y0;
    if (this.sphere) {
      if (Math.abs(y2 + this.a * this.lat0) <= EPSLN) {
        lon = adjust_lon(x / this.a + this.long0);
        lat = 0;
      } else {
        al = this.lat0 + y2 / this.a;
        bl = x * x / this.a / this.a + al * al;
        phi = al;
        var tanphi;
        for (i = MAX_ITER$1; i; --i) {
          tanphi = Math.tan(phi);
          dphi = -1 * (al * (phi * tanphi + 1) - phi - 0.5 * (phi * phi + bl) * tanphi) / ((phi - al) / tanphi - 1);
          phi += dphi;
          if (Math.abs(dphi) <= EPSLN) {
            lat = phi;
            break;
          }
        }
        lon = adjust_lon(this.long0 + Math.asin(x * Math.tan(phi) / this.a) / Math.sin(lat));
      }
    } else {
      if (Math.abs(y2 + this.ml0) <= EPSLN) {
        lat = 0;
        lon = adjust_lon(this.long0 + x / this.a);
      } else {
        al = (this.ml0 + y2) / this.a;
        bl = x * x / this.a / this.a + al * al;
        phi = al;
        var cl, mln, mlnp, ma;
        var con;
        for (i = MAX_ITER$1; i; --i) {
          con = this.e * Math.sin(phi);
          cl = Math.sqrt(1 - con * con) * Math.tan(phi);
          mln = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi);
          mlnp = this.e0 - 2 * this.e1 * Math.cos(2 * phi) + 4 * this.e2 * Math.cos(4 * phi) - 6 * this.e3 * Math.cos(6 * phi);
          ma = mln / this.a;
          dphi = (al * (cl * ma + 1) - ma - 0.5 * cl * (ma * ma + bl)) / (this.es * Math.sin(2 * phi) * (ma * ma + bl - 2 * al * ma) / (4 * cl) + (al - ma) * (cl * mlnp - 2 / Math.sin(2 * phi)) - mlnp);
          phi -= dphi;
          if (Math.abs(dphi) <= EPSLN) {
            lat = phi;
            break;
          }
        }
        cl = Math.sqrt(1 - this.es * Math.pow(Math.sin(lat), 2)) * Math.tan(lat);
        lon = adjust_lon(this.long0 + Math.asin(x * cl / this.a) / Math.sin(lat));
      }
    }
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  var names$d = ["Polyconic", "poly"];
  const poly = {
    init: init$d,
    forward: forward$d,
    inverse: inverse$d,
    names: names$d
  };
  function init$c() {
    this.A = [];
    this.A[1] = 0.6399175073;
    this.A[2] = -0.1358797613;
    this.A[3] = 0.063294409;
    this.A[4] = -0.02526853;
    this.A[5] = 0.0117879;
    this.A[6] = -55161e-7;
    this.A[7] = 26906e-7;
    this.A[8] = -1333e-6;
    this.A[9] = 67e-5;
    this.A[10] = -34e-5;
    this.B_re = [];
    this.B_im = [];
    this.B_re[1] = 0.7557853228;
    this.B_im[1] = 0;
    this.B_re[2] = 0.249204646;
    this.B_im[2] = 3371507e-9;
    this.B_re[3] = -1541739e-9;
    this.B_im[3] = 0.04105856;
    this.B_re[4] = -0.10162907;
    this.B_im[4] = 0.01727609;
    this.B_re[5] = -0.26623489;
    this.B_im[5] = -0.36249218;
    this.B_re[6] = -0.6870983;
    this.B_im[6] = -1.1651967;
    this.C_re = [];
    this.C_im = [];
    this.C_re[1] = 1.3231270439;
    this.C_im[1] = 0;
    this.C_re[2] = -0.577245789;
    this.C_im[2] = -7809598e-9;
    this.C_re[3] = 0.508307513;
    this.C_im[3] = -0.112208952;
    this.C_re[4] = -0.15094762;
    this.C_im[4] = 0.18200602;
    this.C_re[5] = 1.01418179;
    this.C_im[5] = 1.64497696;
    this.C_re[6] = 1.9660549;
    this.C_im[6] = 2.5127645;
    this.D = [];
    this.D[1] = 1.5627014243;
    this.D[2] = 0.5185406398;
    this.D[3] = -0.03333098;
    this.D[4] = -0.1052906;
    this.D[5] = -0.0368594;
    this.D[6] = 7317e-6;
    this.D[7] = 0.0122;
    this.D[8] = 394e-5;
    this.D[9] = -13e-4;
  }
  function forward$c(p2) {
    var n;
    var lon = p2.x;
    var lat = p2.y;
    var delta_lat = lat - this.lat0;
    var delta_lon = lon - this.long0;
    var d_phi = delta_lat / SEC_TO_RAD * 1e-5;
    var d_lambda = delta_lon;
    var d_phi_n = 1;
    var d_psi = 0;
    for (n = 1; n <= 10; n++) {
      d_phi_n = d_phi_n * d_phi;
      d_psi = d_psi + this.A[n] * d_phi_n;
    }
    var th_re = d_psi;
    var th_im = d_lambda;
    var th_n_re = 1;
    var th_n_im = 0;
    var th_n_re1;
    var th_n_im1;
    var z_re = 0;
    var z_im = 0;
    for (n = 1; n <= 6; n++) {
      th_n_re1 = th_n_re * th_re - th_n_im * th_im;
      th_n_im1 = th_n_im * th_re + th_n_re * th_im;
      th_n_re = th_n_re1;
      th_n_im = th_n_im1;
      z_re = z_re + this.B_re[n] * th_n_re - this.B_im[n] * th_n_im;
      z_im = z_im + this.B_im[n] * th_n_re + this.B_re[n] * th_n_im;
    }
    p2.x = z_im * this.a + this.x0;
    p2.y = z_re * this.a + this.y0;
    return p2;
  }
  function inverse$c(p2) {
    var n;
    var x = p2.x;
    var y2 = p2.y;
    var delta_x = x - this.x0;
    var delta_y = y2 - this.y0;
    var z_re = delta_y / this.a;
    var z_im = delta_x / this.a;
    var z_n_re = 1;
    var z_n_im = 0;
    var z_n_re1;
    var z_n_im1;
    var th_re = 0;
    var th_im = 0;
    for (n = 1; n <= 6; n++) {
      z_n_re1 = z_n_re * z_re - z_n_im * z_im;
      z_n_im1 = z_n_im * z_re + z_n_re * z_im;
      z_n_re = z_n_re1;
      z_n_im = z_n_im1;
      th_re = th_re + this.C_re[n] * z_n_re - this.C_im[n] * z_n_im;
      th_im = th_im + this.C_im[n] * z_n_re + this.C_re[n] * z_n_im;
    }
    for (var i = 0; i < this.iterations; i++) {
      var th_n_re = th_re;
      var th_n_im = th_im;
      var th_n_re1;
      var th_n_im1;
      var num_re = z_re;
      var num_im = z_im;
      for (n = 2; n <= 6; n++) {
        th_n_re1 = th_n_re * th_re - th_n_im * th_im;
        th_n_im1 = th_n_im * th_re + th_n_re * th_im;
        th_n_re = th_n_re1;
        th_n_im = th_n_im1;
        num_re = num_re + (n - 1) * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im);
        num_im = num_im + (n - 1) * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);
      }
      th_n_re = 1;
      th_n_im = 0;
      var den_re = this.B_re[1];
      var den_im = this.B_im[1];
      for (n = 2; n <= 6; n++) {
        th_n_re1 = th_n_re * th_re - th_n_im * th_im;
        th_n_im1 = th_n_im * th_re + th_n_re * th_im;
        th_n_re = th_n_re1;
        th_n_im = th_n_im1;
        den_re = den_re + n * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im);
        den_im = den_im + n * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);
      }
      var den2 = den_re * den_re + den_im * den_im;
      th_re = (num_re * den_re + num_im * den_im) / den2;
      th_im = (num_im * den_re - num_re * den_im) / den2;
    }
    var d_psi = th_re;
    var d_lambda = th_im;
    var d_psi_n = 1;
    var d_phi = 0;
    for (n = 1; n <= 9; n++) {
      d_psi_n = d_psi_n * d_psi;
      d_phi = d_phi + this.D[n] * d_psi_n;
    }
    var lat = this.lat0 + d_phi * SEC_TO_RAD * 1e5;
    var lon = this.long0 + d_lambda;
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  var names$c = ["New_Zealand_Map_Grid", "nzmg"];
  const nzmg = {
    init: init$c,
    forward: forward$c,
    inverse: inverse$c,
    names: names$c
  };
  function init$b() {
  }
  function forward$b(p2) {
    var lon = p2.x;
    var lat = p2.y;
    var dlon = adjust_lon(lon - this.long0);
    var x = this.x0 + this.a * dlon;
    var y2 = this.y0 + this.a * Math.log(Math.tan(Math.PI / 4 + lat / 2.5)) * 1.25;
    p2.x = x;
    p2.y = y2;
    return p2;
  }
  function inverse$b(p2) {
    p2.x -= this.x0;
    p2.y -= this.y0;
    var lon = adjust_lon(this.long0 + p2.x / this.a);
    var lat = 2.5 * (Math.atan(Math.exp(0.8 * p2.y / this.a)) - Math.PI / 4);
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  var names$b = ["Miller_Cylindrical", "mill"];
  const mill = {
    init: init$b,
    forward: forward$b,
    inverse: inverse$b,
    names: names$b
  };
  var MAX_ITER = 20;
  function init$a() {
    if (!this.sphere) {
      this.en = pj_enfn(this.es);
    } else {
      this.n = 1;
      this.m = 0;
      this.es = 0;
      this.C_y = Math.sqrt((this.m + 1) / this.n);
      this.C_x = this.C_y / (this.m + 1);
    }
  }
  function forward$a(p2) {
    var x, y2;
    var lon = p2.x;
    var lat = p2.y;
    lon = adjust_lon(lon - this.long0);
    if (this.sphere) {
      if (!this.m) {
        lat = this.n !== 1 ? Math.asin(this.n * Math.sin(lat)) : lat;
      } else {
        var k = this.n * Math.sin(lat);
        for (var i = MAX_ITER; i; --i) {
          var V2 = (this.m * lat + Math.sin(lat) - k) / (this.m + Math.cos(lat));
          lat -= V2;
          if (Math.abs(V2) < EPSLN) {
            break;
          }
        }
      }
      x = this.a * this.C_x * lon * (this.m + Math.cos(lat));
      y2 = this.a * this.C_y * lat;
    } else {
      var s = Math.sin(lat);
      var c2 = Math.cos(lat);
      y2 = this.a * pj_mlfn(lat, s, c2, this.en);
      x = this.a * lon * c2 / Math.sqrt(1 - this.es * s * s);
    }
    p2.x = x;
    p2.y = y2;
    return p2;
  }
  function inverse$a(p2) {
    var lat, temp, lon, s;
    p2.x -= this.x0;
    lon = p2.x / this.a;
    p2.y -= this.y0;
    lat = p2.y / this.a;
    if (this.sphere) {
      lat /= this.C_y;
      lon = lon / (this.C_x * (this.m + Math.cos(lat)));
      if (this.m) {
        lat = asinz((this.m * lat + Math.sin(lat)) / this.n);
      } else if (this.n !== 1) {
        lat = asinz(Math.sin(lat) / this.n);
      }
      lon = adjust_lon(lon + this.long0);
      lat = adjust_lat(lat);
    } else {
      lat = pj_inv_mlfn(p2.y / this.a, this.es, this.en);
      s = Math.abs(lat);
      if (s < HALF_PI) {
        s = Math.sin(lat);
        temp = this.long0 + p2.x * Math.sqrt(1 - this.es * s * s) / (this.a * Math.cos(lat));
        lon = adjust_lon(temp);
      } else if (s - EPSLN < HALF_PI) {
        lon = this.long0;
      }
    }
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  var names$a = ["Sinusoidal", "sinu"];
  const sinu = {
    init: init$a,
    forward: forward$a,
    inverse: inverse$a,
    names: names$a
  };
  function init$9() {
  }
  function forward$9(p2) {
    var lon = p2.x;
    var lat = p2.y;
    var delta_lon = adjust_lon(lon - this.long0);
    var theta = lat;
    var con = Math.PI * Math.sin(lat);
    while (true) {
      var delta_theta = -(theta + Math.sin(theta) - con) / (1 + Math.cos(theta));
      theta += delta_theta;
      if (Math.abs(delta_theta) < EPSLN) {
        break;
      }
    }
    theta /= 2;
    if (Math.PI / 2 - Math.abs(lat) < EPSLN) {
      delta_lon = 0;
    }
    var x = 0.900316316158 * this.a * delta_lon * Math.cos(theta) + this.x0;
    var y2 = 1.4142135623731 * this.a * Math.sin(theta) + this.y0;
    p2.x = x;
    p2.y = y2;
    return p2;
  }
  function inverse$9(p2) {
    var theta;
    var arg;
    p2.x -= this.x0;
    p2.y -= this.y0;
    arg = p2.y / (1.4142135623731 * this.a);
    if (Math.abs(arg) > 0.999999999999) {
      arg = 0.999999999999;
    }
    theta = Math.asin(arg);
    var lon = adjust_lon(this.long0 + p2.x / (0.900316316158 * this.a * Math.cos(theta)));
    if (lon < -Math.PI) {
      lon = -Math.PI;
    }
    if (lon > Math.PI) {
      lon = Math.PI;
    }
    arg = (2 * theta + Math.sin(2 * theta)) / Math.PI;
    if (Math.abs(arg) > 1) {
      arg = 1;
    }
    var lat = Math.asin(arg);
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  var names$9 = ["Mollweide", "moll"];
  const moll = {
    init: init$9,
    forward: forward$9,
    inverse: inverse$9,
    names: names$9
  };
  function init$8() {
    if (Math.abs(this.lat1 + this.lat2) < EPSLN) {
      return;
    }
    this.lat2 = this.lat2 || this.lat1;
    this.temp = this.b / this.a;
    this.es = 1 - Math.pow(this.temp, 2);
    this.e = Math.sqrt(this.es);
    this.e0 = e0fn(this.es);
    this.e1 = e1fn(this.es);
    this.e2 = e2fn(this.es);
    this.e3 = e3fn(this.es);
    this.sinphi = Math.sin(this.lat1);
    this.cosphi = Math.cos(this.lat1);
    this.ms1 = msfnz(this.e, this.sinphi, this.cosphi);
    this.ml1 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat1);
    if (Math.abs(this.lat1 - this.lat2) < EPSLN) {
      this.ns = this.sinphi;
    } else {
      this.sinphi = Math.sin(this.lat2);
      this.cosphi = Math.cos(this.lat2);
      this.ms2 = msfnz(this.e, this.sinphi, this.cosphi);
      this.ml2 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat2);
      this.ns = (this.ms1 - this.ms2) / (this.ml2 - this.ml1);
    }
    this.g = this.ml1 + this.ms1 / this.ns;
    this.ml0 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);
    this.rh = this.a * (this.g - this.ml0);
  }
  function forward$8(p2) {
    var lon = p2.x;
    var lat = p2.y;
    var rh1;
    if (this.sphere) {
      rh1 = this.a * (this.g - lat);
    } else {
      var ml = mlfn(this.e0, this.e1, this.e2, this.e3, lat);
      rh1 = this.a * (this.g - ml);
    }
    var theta = this.ns * adjust_lon(lon - this.long0);
    var x = this.x0 + rh1 * Math.sin(theta);
    var y2 = this.y0 + this.rh - rh1 * Math.cos(theta);
    p2.x = x;
    p2.y = y2;
    return p2;
  }
  function inverse$8(p2) {
    p2.x -= this.x0;
    p2.y = this.rh - p2.y + this.y0;
    var con, rh1, lat, lon;
    if (this.ns >= 0) {
      rh1 = Math.sqrt(p2.x * p2.x + p2.y * p2.y);
      con = 1;
    } else {
      rh1 = -Math.sqrt(p2.x * p2.x + p2.y * p2.y);
      con = -1;
    }
    var theta = 0;
    if (rh1 !== 0) {
      theta = Math.atan2(con * p2.x, con * p2.y);
    }
    if (this.sphere) {
      lon = adjust_lon(this.long0 + theta / this.ns);
      lat = adjust_lat(this.g - rh1 / this.a);
      p2.x = lon;
      p2.y = lat;
      return p2;
    } else {
      var ml = this.g - rh1 / this.a;
      lat = imlfn(ml, this.e0, this.e1, this.e2, this.e3);
      lon = adjust_lon(this.long0 + theta / this.ns);
      p2.x = lon;
      p2.y = lat;
      return p2;
    }
  }
  var names$8 = ["Equidistant_Conic", "eqdc"];
  const eqdc = {
    init: init$8,
    forward: forward$8,
    inverse: inverse$8,
    names: names$8
  };
  function init$7() {
    this.R = this.a;
  }
  function forward$7(p2) {
    var lon = p2.x;
    var lat = p2.y;
    var dlon = adjust_lon(lon - this.long0);
    var x, y2;
    if (Math.abs(lat) <= EPSLN) {
      x = this.x0 + this.R * dlon;
      y2 = this.y0;
    }
    var theta = asinz(2 * Math.abs(lat / Math.PI));
    if (Math.abs(dlon) <= EPSLN || Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {
      x = this.x0;
      if (lat >= 0) {
        y2 = this.y0 + Math.PI * this.R * Math.tan(0.5 * theta);
      } else {
        y2 = this.y0 + Math.PI * this.R * -Math.tan(0.5 * theta);
      }
    }
    var al = 0.5 * Math.abs(Math.PI / dlon - dlon / Math.PI);
    var asq = al * al;
    var sinth = Math.sin(theta);
    var costh = Math.cos(theta);
    var g = costh / (sinth + costh - 1);
    var gsq = g * g;
    var m = g * (2 / sinth - 1);
    var msq = m * m;
    var con = Math.PI * this.R * (al * (g - msq) + Math.sqrt(asq * (g - msq) * (g - msq) - (msq + asq) * (gsq - msq))) / (msq + asq);
    if (dlon < 0) {
      con = -con;
    }
    x = this.x0 + con;
    var q = asq + g;
    con = Math.PI * this.R * (m * q - al * Math.sqrt((msq + asq) * (asq + 1) - q * q)) / (msq + asq);
    if (lat >= 0) {
      y2 = this.y0 + con;
    } else {
      y2 = this.y0 - con;
    }
    p2.x = x;
    p2.y = y2;
    return p2;
  }
  function inverse$7(p2) {
    var lon, lat;
    var xx, yy, xys, c1, c2, c3;
    var a1;
    var m1;
    var con;
    var th1;
    var d;
    p2.x -= this.x0;
    p2.y -= this.y0;
    con = Math.PI * this.R;
    xx = p2.x / con;
    yy = p2.y / con;
    xys = xx * xx + yy * yy;
    c1 = -Math.abs(yy) * (1 + xys);
    c2 = c1 - 2 * yy * yy + xx * xx;
    c3 = -2 * c1 + 1 + 2 * yy * yy + xys * xys;
    d = yy * yy / c3 + (2 * c2 * c2 * c2 / c3 / c3 / c3 - 9 * c1 * c2 / c3 / c3) / 27;
    a1 = (c1 - c2 * c2 / 3 / c3) / c3;
    m1 = 2 * Math.sqrt(-a1 / 3);
    con = 3 * d / a1 / m1;
    if (Math.abs(con) > 1) {
      if (con >= 0) {
        con = 1;
      } else {
        con = -1;
      }
    }
    th1 = Math.acos(con) / 3;
    if (p2.y >= 0) {
      lat = (-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;
    } else {
      lat = -(-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;
    }
    if (Math.abs(xx) < EPSLN) {
      lon = this.long0;
    } else {
      lon = adjust_lon(this.long0 + Math.PI * (xys - 1 + Math.sqrt(1 + 2 * (xx * xx - yy * yy) + xys * xys)) / 2 / xx);
    }
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  var names$7 = ["Van_der_Grinten_I", "VanDerGrinten", "vandg"];
  const vandg = {
    init: init$7,
    forward: forward$7,
    inverse: inverse$7,
    names: names$7
  };
  function init$6() {
    this.sin_p12 = Math.sin(this.lat0);
    this.cos_p12 = Math.cos(this.lat0);
  }
  function forward$6(p2) {
    var lon = p2.x;
    var lat = p2.y;
    var sinphi = Math.sin(p2.y);
    var cosphi = Math.cos(p2.y);
    var dlon = adjust_lon(lon - this.long0);
    var e0, e1, e2, e3, Mlp, Ml, tanphi, Nl1, Nl, psi, Az, G, H, GH, Hs, c2, kp, cos_c, s, s2, s3, s4, s5;
    if (this.sphere) {
      if (Math.abs(this.sin_p12 - 1) <= EPSLN) {
        p2.x = this.x0 + this.a * (HALF_PI - lat) * Math.sin(dlon);
        p2.y = this.y0 - this.a * (HALF_PI - lat) * Math.cos(dlon);
        return p2;
      } else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {
        p2.x = this.x0 + this.a * (HALF_PI + lat) * Math.sin(dlon);
        p2.y = this.y0 + this.a * (HALF_PI + lat) * Math.cos(dlon);
        return p2;
      } else {
        cos_c = this.sin_p12 * sinphi + this.cos_p12 * cosphi * Math.cos(dlon);
        c2 = Math.acos(cos_c);
        kp = c2 ? c2 / Math.sin(c2) : 1;
        p2.x = this.x0 + this.a * kp * cosphi * Math.sin(dlon);
        p2.y = this.y0 + this.a * kp * (this.cos_p12 * sinphi - this.sin_p12 * cosphi * Math.cos(dlon));
        return p2;
      }
    } else {
      e0 = e0fn(this.es);
      e1 = e1fn(this.es);
      e2 = e2fn(this.es);
      e3 = e3fn(this.es);
      if (Math.abs(this.sin_p12 - 1) <= EPSLN) {
        Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);
        Ml = this.a * mlfn(e0, e1, e2, e3, lat);
        p2.x = this.x0 + (Mlp - Ml) * Math.sin(dlon);
        p2.y = this.y0 - (Mlp - Ml) * Math.cos(dlon);
        return p2;
      } else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {
        Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);
        Ml = this.a * mlfn(e0, e1, e2, e3, lat);
        p2.x = this.x0 + (Mlp + Ml) * Math.sin(dlon);
        p2.y = this.y0 + (Mlp + Ml) * Math.cos(dlon);
        return p2;
      } else {
        tanphi = sinphi / cosphi;
        Nl1 = gN(this.a, this.e, this.sin_p12);
        Nl = gN(this.a, this.e, sinphi);
        psi = Math.atan((1 - this.es) * tanphi + this.es * Nl1 * this.sin_p12 / (Nl * cosphi));
        Az = Math.atan2(Math.sin(dlon), this.cos_p12 * Math.tan(psi) - this.sin_p12 * Math.cos(dlon));
        if (Az === 0) {
          s = Math.asin(this.cos_p12 * Math.sin(psi) - this.sin_p12 * Math.cos(psi));
        } else if (Math.abs(Math.abs(Az) - Math.PI) <= EPSLN) {
          s = -Math.asin(this.cos_p12 * Math.sin(psi) - this.sin_p12 * Math.cos(psi));
        } else {
          s = Math.asin(Math.sin(dlon) * Math.cos(psi) / Math.sin(Az));
        }
        G = this.e * this.sin_p12 / Math.sqrt(1 - this.es);
        H = this.e * this.cos_p12 * Math.cos(Az) / Math.sqrt(1 - this.es);
        GH = G * H;
        Hs = H * H;
        s2 = s * s;
        s3 = s2 * s;
        s4 = s3 * s;
        s5 = s4 * s;
        c2 = Nl1 * s * (1 - s2 * Hs * (1 - Hs) / 6 + s3 / 8 * GH * (1 - 2 * Hs) + s4 / 120 * (Hs * (4 - 7 * Hs) - 3 * G * G * (1 - 7 * Hs)) - s5 / 48 * GH);
        p2.x = this.x0 + c2 * Math.sin(Az);
        p2.y = this.y0 + c2 * Math.cos(Az);
        return p2;
      }
    }
  }
  function inverse$6(p2) {
    p2.x -= this.x0;
    p2.y -= this.y0;
    var rh, z, sinz, cosz, lon, lat, con, e0, e1, e2, e3, Mlp, M, N1, psi, Az, cosAz, tmp, A2, B, D, Ee, F, sinpsi;
    if (this.sphere) {
      rh = Math.sqrt(p2.x * p2.x + p2.y * p2.y);
      if (rh > 2 * HALF_PI * this.a) {
        return;
      }
      z = rh / this.a;
      sinz = Math.sin(z);
      cosz = Math.cos(z);
      lon = this.long0;
      if (Math.abs(rh) <= EPSLN) {
        lat = this.lat0;
      } else {
        lat = asinz(cosz * this.sin_p12 + p2.y * sinz * this.cos_p12 / rh);
        con = Math.abs(this.lat0) - HALF_PI;
        if (Math.abs(con) <= EPSLN) {
          if (this.lat0 >= 0) {
            lon = adjust_lon(this.long0 + Math.atan2(p2.x, -p2.y));
          } else {
            lon = adjust_lon(this.long0 - Math.atan2(-p2.x, p2.y));
          }
        } else {
          lon = adjust_lon(this.long0 + Math.atan2(p2.x * sinz, rh * this.cos_p12 * cosz - p2.y * this.sin_p12 * sinz));
        }
      }
      p2.x = lon;
      p2.y = lat;
      return p2;
    } else {
      e0 = e0fn(this.es);
      e1 = e1fn(this.es);
      e2 = e2fn(this.es);
      e3 = e3fn(this.es);
      if (Math.abs(this.sin_p12 - 1) <= EPSLN) {
        Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);
        rh = Math.sqrt(p2.x * p2.x + p2.y * p2.y);
        M = Mlp - rh;
        lat = imlfn(M / this.a, e0, e1, e2, e3);
        lon = adjust_lon(this.long0 + Math.atan2(p2.x, -1 * p2.y));
        p2.x = lon;
        p2.y = lat;
        return p2;
      } else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {
        Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);
        rh = Math.sqrt(p2.x * p2.x + p2.y * p2.y);
        M = rh - Mlp;
        lat = imlfn(M / this.a, e0, e1, e2, e3);
        lon = adjust_lon(this.long0 + Math.atan2(p2.x, p2.y));
        p2.x = lon;
        p2.y = lat;
        return p2;
      } else {
        rh = Math.sqrt(p2.x * p2.x + p2.y * p2.y);
        Az = Math.atan2(p2.x, p2.y);
        N1 = gN(this.a, this.e, this.sin_p12);
        cosAz = Math.cos(Az);
        tmp = this.e * this.cos_p12 * cosAz;
        A2 = -tmp * tmp / (1 - this.es);
        B = 3 * this.es * (1 - A2) * this.sin_p12 * this.cos_p12 * cosAz / (1 - this.es);
        D = rh / N1;
        Ee = D - A2 * (1 + A2) * Math.pow(D, 3) / 6 - B * (1 + 3 * A2) * Math.pow(D, 4) / 24;
        F = 1 - A2 * Ee * Ee / 2 - D * Ee * Ee * Ee / 6;
        psi = Math.asin(this.sin_p12 * Math.cos(Ee) + this.cos_p12 * Math.sin(Ee) * cosAz);
        lon = adjust_lon(this.long0 + Math.asin(Math.sin(Az) * Math.sin(Ee) / Math.cos(psi)));
        sinpsi = Math.sin(psi);
        lat = Math.atan2((sinpsi - this.es * F * this.sin_p12) * Math.tan(psi), sinpsi * (1 - this.es));
        p2.x = lon;
        p2.y = lat;
        return p2;
      }
    }
  }
  var names$6 = ["Azimuthal_Equidistant", "aeqd"];
  const aeqd = {
    init: init$6,
    forward: forward$6,
    inverse: inverse$6,
    names: names$6
  };
  function init$5() {
    this.sin_p14 = Math.sin(this.lat0);
    this.cos_p14 = Math.cos(this.lat0);
  }
  function forward$5(p2) {
    var sinphi, cosphi;
    var dlon;
    var coslon;
    var ksp;
    var g, x, y2;
    var lon = p2.x;
    var lat = p2.y;
    dlon = adjust_lon(lon - this.long0);
    sinphi = Math.sin(lat);
    cosphi = Math.cos(lat);
    coslon = Math.cos(dlon);
    g = this.sin_p14 * sinphi + this.cos_p14 * cosphi * coslon;
    ksp = 1;
    if (g > 0 || Math.abs(g) <= EPSLN) {
      x = this.a * ksp * cosphi * Math.sin(dlon);
      y2 = this.y0 + this.a * ksp * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon);
    }
    p2.x = x;
    p2.y = y2;
    return p2;
  }
  function inverse$5(p2) {
    var rh;
    var z;
    var sinz, cosz;
    var con;
    var lon, lat;
    p2.x -= this.x0;
    p2.y -= this.y0;
    rh = Math.sqrt(p2.x * p2.x + p2.y * p2.y);
    z = asinz(rh / this.a);
    sinz = Math.sin(z);
    cosz = Math.cos(z);
    lon = this.long0;
    if (Math.abs(rh) <= EPSLN) {
      lat = this.lat0;
      p2.x = lon;
      p2.y = lat;
      return p2;
    }
    lat = asinz(cosz * this.sin_p14 + p2.y * sinz * this.cos_p14 / rh);
    con = Math.abs(this.lat0) - HALF_PI;
    if (Math.abs(con) <= EPSLN) {
      if (this.lat0 >= 0) {
        lon = adjust_lon(this.long0 + Math.atan2(p2.x, -p2.y));
      } else {
        lon = adjust_lon(this.long0 - Math.atan2(-p2.x, p2.y));
      }
      p2.x = lon;
      p2.y = lat;
      return p2;
    }
    lon = adjust_lon(this.long0 + Math.atan2(p2.x * sinz, rh * this.cos_p14 * cosz - p2.y * this.sin_p14 * sinz));
    p2.x = lon;
    p2.y = lat;
    return p2;
  }
  var names$5 = ["ortho"];
  const ortho = {
    init: init$5,
    forward: forward$5,
    inverse: inverse$5,
    names: names$5
  };
  var FACE_ENUM = {
    FRONT: 1,
    RIGHT: 2,
    BACK: 3,
    LEFT: 4,
    TOP: 5,
    BOTTOM: 6
  };
  var AREA_ENUM = {
    AREA_0: 1,
    AREA_1: 2,
    AREA_2: 3,
    AREA_3: 4
  };
  function init$4() {
    this.x0 = this.x0 || 0;
    this.y0 = this.y0 || 0;
    this.lat0 = this.lat0 || 0;
    this.long0 = this.long0 || 0;
    this.lat_ts = this.lat_ts || 0;
    this.title = this.title || "Quadrilateralized Spherical Cube";
    if (this.lat0 >= HALF_PI - FORTPI / 2) {
      this.face = FACE_ENUM.TOP;
    } else if (this.lat0 <= -(HALF_PI - FORTPI / 2)) {
      this.face = FACE_ENUM.BOTTOM;
    } else if (Math.abs(this.long0) <= FORTPI) {
      this.face = FACE_ENUM.FRONT;
    } else if (Math.abs(this.long0) <= HALF_PI + FORTPI) {
      this.face = this.long0 > 0 ? FACE_ENUM.RIGHT : FACE_ENUM.LEFT;
    } else {
      this.face = FACE_ENUM.BACK;
    }
    if (this.es !== 0) {
      this.one_minus_f = 1 - (this.a - this.b) / this.a;
      this.one_minus_f_squared = this.one_minus_f * this.one_minus_f;
    }
  }
  function forward$4(p2) {
    var xy = { x: 0, y: 0 };
    var lat, lon;
    var theta, phi;
    var t, mu;
    var area = { value: 0 };
    p2.x -= this.long0;
    if (this.es !== 0) {
      lat = Math.atan(this.one_minus_f_squared * Math.tan(p2.y));
    } else {
      lat = p2.y;
    }
    lon = p2.x;
    if (this.face === FACE_ENUM.TOP) {
      phi = HALF_PI - lat;
      if (lon >= FORTPI && lon <= HALF_PI + FORTPI) {
        area.value = AREA_ENUM.AREA_0;
        theta = lon - HALF_PI;
      } else if (lon > HALF_PI + FORTPI || lon <= -(HALF_PI + FORTPI)) {
        area.value = AREA_ENUM.AREA_1;
        theta = lon > 0 ? lon - SPI : lon + SPI;
      } else if (lon > -(HALF_PI + FORTPI) && lon <= -FORTPI) {
        area.value = AREA_ENUM.AREA_2;
        theta = lon + HALF_PI;
      } else {
        area.value = AREA_ENUM.AREA_3;
        theta = lon;
      }
    } else if (this.face === FACE_ENUM.BOTTOM) {
      phi = HALF_PI + lat;
      if (lon >= FORTPI && lon <= HALF_PI + FORTPI) {
        area.value = AREA_ENUM.AREA_0;
        theta = -lon + HALF_PI;
      } else if (lon < FORTPI && lon >= -FORTPI) {
        area.value = AREA_ENUM.AREA_1;
        theta = -lon;
      } else if (lon < -FORTPI && lon >= -(HALF_PI + FORTPI)) {
        area.value = AREA_ENUM.AREA_2;
        theta = -lon - HALF_PI;
      } else {
        area.value = AREA_ENUM.AREA_3;
        theta = lon > 0 ? -lon + SPI : -lon - SPI;
      }
    } else {
      var q, r, s;
      var sinlat, coslat;
      var sinlon, coslon;
      if (this.face === FACE_ENUM.RIGHT) {
        lon = qsc_shift_lon_origin(lon, +HALF_PI);
      } else if (this.face === FACE_ENUM.BACK) {
        lon = qsc_shift_lon_origin(lon, +SPI);
      } else if (this.face === FACE_ENUM.LEFT) {
        lon = qsc_shift_lon_origin(lon, -HALF_PI);
      }
      sinlat = Math.sin(lat);
      coslat = Math.cos(lat);
      sinlon = Math.sin(lon);
      coslon = Math.cos(lon);
      q = coslat * coslon;
      r = coslat * sinlon;
      s = sinlat;
      if (this.face === FACE_ENUM.FRONT) {
        phi = Math.acos(q);
        theta = qsc_fwd_equat_face_theta(phi, s, r, area);
      } else if (this.face === FACE_ENUM.RIGHT) {
        phi = Math.acos(r);
        theta = qsc_fwd_equat_face_theta(phi, s, -q, area);
      } else if (this.face === FACE_ENUM.BACK) {
        phi = Math.acos(-q);
        theta = qsc_fwd_equat_face_theta(phi, s, -r, area);
      } else if (this.face === FACE_ENUM.LEFT) {
        phi = Math.acos(-r);
        theta = qsc_fwd_equat_face_theta(phi, s, q, area);
      } else {
        phi = theta = 0;
        area.value = AREA_ENUM.AREA_0;
      }
    }
    mu = Math.atan(12 / SPI * (theta + Math.acos(Math.sin(theta) * Math.cos(FORTPI)) - HALF_PI));
    t = Math.sqrt((1 - Math.cos(phi)) / (Math.cos(mu) * Math.cos(mu)) / (1 - Math.cos(Math.atan(1 / Math.cos(theta)))));
    if (area.value === AREA_ENUM.AREA_1) {
      mu += HALF_PI;
    } else if (area.value === AREA_ENUM.AREA_2) {
      mu += SPI;
    } else if (area.value === AREA_ENUM.AREA_3) {
      mu += 1.5 * SPI;
    }
    xy.x = t * Math.cos(mu);
    xy.y = t * Math.sin(mu);
    xy.x = xy.x * this.a + this.x0;
    xy.y = xy.y * this.a + this.y0;
    p2.x = xy.x;
    p2.y = xy.y;
    return p2;
  }
  function inverse$4(p2) {
    var lp = { lam: 0, phi: 0 };
    var mu, nu, cosmu, tannu;
    var tantheta, theta, cosphi, phi;
    var t;
    var area = { value: 0 };
    p2.x = (p2.x - this.x0) / this.a;
    p2.y = (p2.y - this.y0) / this.a;
    nu = Math.atan(Math.sqrt(p2.x * p2.x + p2.y * p2.y));
    mu = Math.atan2(p2.y, p2.x);
    if (p2.x >= 0 && p2.x >= Math.abs(p2.y)) {
      area.value = AREA_ENUM.AREA_0;
    } else if (p2.y >= 0 && p2.y >= Math.abs(p2.x)) {
      area.value = AREA_ENUM.AREA_1;
      mu -= HALF_PI;
    } else if (p2.x < 0 && -p2.x >= Math.abs(p2.y)) {
      area.value = AREA_ENUM.AREA_2;
      mu = mu < 0 ? mu + SPI : mu - SPI;
    } else {
      area.value = AREA_ENUM.AREA_3;
      mu += HALF_PI;
    }
    t = SPI / 12 * Math.tan(mu);
    tantheta = Math.sin(t) / (Math.cos(t) - 1 / Math.sqrt(2));
    theta = Math.atan(tantheta);
    cosmu = Math.cos(mu);
    tannu = Math.tan(nu);
    cosphi = 1 - cosmu * cosmu * tannu * tannu * (1 - Math.cos(Math.atan(1 / Math.cos(theta))));
    if (cosphi < -1) {
      cosphi = -1;
    } else if (cosphi > 1) {
      cosphi = 1;
    }
    if (this.face === FACE_ENUM.TOP) {
      phi = Math.acos(cosphi);
      lp.phi = HALF_PI - phi;
      if (area.value === AREA_ENUM.AREA_0) {
        lp.lam = theta + HALF_PI;
      } else if (area.value === AREA_ENUM.AREA_1) {
        lp.lam = theta < 0 ? theta + SPI : theta - SPI;
      } else if (area.value === AREA_ENUM.AREA_2) {
        lp.lam = theta - HALF_PI;
      } else {
        lp.lam = theta;
      }
    } else if (this.face === FACE_ENUM.BOTTOM) {
      phi = Math.acos(cosphi);
      lp.phi = phi - HALF_PI;
      if (area.value === AREA_ENUM.AREA_0) {
        lp.lam = -theta + HALF_PI;
      } else if (area.value === AREA_ENUM.AREA_1) {
        lp.lam = -theta;
      } else if (area.value === AREA_ENUM.AREA_2) {
        lp.lam = -theta - HALF_PI;
      } else {
        lp.lam = theta < 0 ? -theta - SPI : -theta + SPI;
      }
    } else {
      var q, r, s;
      q = cosphi;
      t = q * q;
      if (t >= 1) {
        s = 0;
      } else {
        s = Math.sqrt(1 - t) * Math.sin(theta);
      }
      t += s * s;
      if (t >= 1) {
        r = 0;
      } else {
        r = Math.sqrt(1 - t);
      }
      if (area.value === AREA_ENUM.AREA_1) {
        t = r;
        r = -s;
        s = t;
      } else if (area.value === AREA_ENUM.AREA_2) {
        r = -r;
        s = -s;
      } else if (area.value === AREA_ENUM.AREA_3) {
        t = r;
        r = s;
        s = -t;
      }
      if (this.face === FACE_ENUM.RIGHT) {
        t = q;
        q = -r;
        r = t;
      } else if (this.face === FACE_ENUM.BACK) {
        q = -q;
        r = -r;
      } else if (this.face === FACE_ENUM.LEFT) {
        t = q;
        q = r;
        r = -t;
      }
      lp.phi = Math.acos(-s) - HALF_PI;
      lp.lam = Math.atan2(r, q);
      if (this.face === FACE_ENUM.RIGHT) {
        lp.lam = qsc_shift_lon_origin(lp.lam, -HALF_PI);
      } else if (this.face === FACE_ENUM.BACK) {
        lp.lam = qsc_shift_lon_origin(lp.lam, -SPI);
      } else if (this.face === FACE_ENUM.LEFT) {
        lp.lam = qsc_shift_lon_origin(lp.lam, +HALF_PI);
      }
    }
    if (this.es !== 0) {
      var invert_sign;
      var tanphi, xa;
      invert_sign = lp.phi < 0 ? 1 : 0;
      tanphi = Math.tan(lp.phi);
      xa = this.b / Math.sqrt(tanphi * tanphi + this.one_minus_f_squared);
      lp.phi = Math.atan(Math.sqrt(this.a * this.a - xa * xa) / (this.one_minus_f * xa));
      if (invert_sign) {
        lp.phi = -lp.phi;
      }
    }
    lp.lam += this.long0;
    p2.x = lp.lam;
    p2.y = lp.phi;
    return p2;
  }
  function qsc_fwd_equat_face_theta(phi, y2, x, area) {
    var theta;
    if (phi < EPSLN) {
      area.value = AREA_ENUM.AREA_0;
      theta = 0;
    } else {
      theta = Math.atan2(y2, x);
      if (Math.abs(theta) <= FORTPI) {
        area.value = AREA_ENUM.AREA_0;
      } else if (theta > FORTPI && theta <= HALF_PI + FORTPI) {
        area.value = AREA_ENUM.AREA_1;
        theta -= HALF_PI;
      } else if (theta > HALF_PI + FORTPI || theta <= -(HALF_PI + FORTPI)) {
        area.value = AREA_ENUM.AREA_2;
        theta = theta >= 0 ? theta - SPI : theta + SPI;
      } else {
        area.value = AREA_ENUM.AREA_3;
        theta += HALF_PI;
      }
    }
    return theta;
  }
  function qsc_shift_lon_origin(lon, offset) {
    var slon = lon + offset;
    if (slon < -SPI) {
      slon += TWO_PI;
    } else if (slon > +SPI) {
      slon -= TWO_PI;
    }
    return slon;
  }
  var names$4 = ["Quadrilateralized Spherical Cube", "Quadrilateralized_Spherical_Cube", "qsc"];
  const qsc = {
    init: init$4,
    forward: forward$4,
    inverse: inverse$4,
    names: names$4
  };
  var COEFS_X = [
    [1, 22199e-21, -715515e-10, 31103e-10],
    [0.9986, -482243e-9, -24897e-9, -13309e-10],
    [0.9954, -83103e-8, -448605e-10, -986701e-12],
    [0.99, -135364e-8, -59661e-9, 36777e-10],
    [0.9822, -167442e-8, -449547e-11, -572411e-11],
    [0.973, -214868e-8, -903571e-10, 18736e-12],
    [0.96, -305085e-8, -900761e-10, 164917e-11],
    [0.9427, -382792e-8, -653386e-10, -26154e-10],
    [0.9216, -467746e-8, -10457e-8, 481243e-11],
    [0.8962, -536223e-8, -323831e-10, -543432e-11],
    [0.8679, -609363e-8, -113898e-9, 332484e-11],
    [0.835, -698325e-8, -640253e-10, 934959e-12],
    [0.7986, -755338e-8, -500009e-10, 935324e-12],
    [0.7597, -798324e-8, -35971e-9, -227626e-11],
    [0.7186, -851367e-8, -701149e-10, -86303e-10],
    [0.6732, -986209e-8, -199569e-9, 191974e-10],
    [0.6213, -0.010418, 883923e-10, 624051e-11],
    [0.5722, -906601e-8, 182e-6, 624051e-11],
    [0.5322, -677797e-8, 275608e-9, 624051e-11]
  ];
  var COEFS_Y = [
    [-520417e-23, 0.0124, 121431e-23, -845284e-16],
    [0.062, 0.0124, -126793e-14, 422642e-15],
    [0.124, 0.0124, 507171e-14, -160604e-14],
    [0.186, 0.0123999, -190189e-13, 600152e-14],
    [0.248, 0.0124002, 710039e-13, -224e-10],
    [0.31, 0.0123992, -264997e-12, 835986e-13],
    [0.372, 0.0124029, 988983e-12, -311994e-12],
    [0.434, 0.0123893, -369093e-11, -435621e-12],
    [0.4958, 0.0123198, -102252e-10, -345523e-12],
    [0.5571, 0.0121916, -154081e-10, -582288e-12],
    [0.6176, 0.0119938, -241424e-10, -525327e-12],
    [0.6769, 0.011713, -320223e-10, -516405e-12],
    [0.7346, 0.0113541, -397684e-10, -609052e-12],
    [0.7903, 0.0109107, -489042e-10, -104739e-11],
    [0.8435, 0.0103431, -64615e-9, -140374e-14],
    [0.8936, 969686e-8, -64636e-9, -8547e-9],
    [0.9394, 840947e-8, -192841e-9, -42106e-10],
    [0.9761, 616527e-8, -256e-6, -42106e-10],
    [1, 328947e-8, -319159e-9, -42106e-10]
  ];
  var FXC = 0.8487;
  var FYC = 1.3523;
  var C1 = R2D / 5;
  var RC1 = 1 / C1;
  var NODES = 18;
  var poly3_val = function(coefs, x) {
    return coefs[0] + x * (coefs[1] + x * (coefs[2] + x * coefs[3]));
  };
  var poly3_der = function(coefs, x) {
    return coefs[1] + x * (2 * coefs[2] + x * 3 * coefs[3]);
  };
  function newton_rapshon(f_df, start2, max_err, iters) {
    var x = start2;
    for (; iters; --iters) {
      var upd = f_df(x);
      x -= upd;
      if (Math.abs(upd) < max_err) {
        break;
      }
    }
    return x;
  }
  function init$3() {
    this.x0 = this.x0 || 0;
    this.y0 = this.y0 || 0;
    this.long0 = this.long0 || 0;
    this.es = 0;
    this.title = this.title || "Robinson";
  }
  function forward$3(ll) {
    var lon = adjust_lon(ll.x - this.long0);
    var dphi = Math.abs(ll.y);
    var i = Math.floor(dphi * C1);
    if (i < 0) {
      i = 0;
    } else if (i >= NODES) {
      i = NODES - 1;
    }
    dphi = R2D * (dphi - RC1 * i);
    var xy = {
      x: poly3_val(COEFS_X[i], dphi) * lon,
      y: poly3_val(COEFS_Y[i], dphi)
    };
    if (ll.y < 0) {
      xy.y = -xy.y;
    }
    xy.x = xy.x * this.a * FXC + this.x0;
    xy.y = xy.y * this.a * FYC + this.y0;
    return xy;
  }
  function inverse$3(xy) {
    var ll = {
      x: (xy.x - this.x0) / (this.a * FXC),
      y: Math.abs(xy.y - this.y0) / (this.a * FYC)
    };
    if (ll.y >= 1) {
      ll.x /= COEFS_X[NODES][0];
      ll.y = xy.y < 0 ? -HALF_PI : HALF_PI;
    } else {
      var i = Math.floor(ll.y * NODES);
      if (i < 0) {
        i = 0;
      } else if (i >= NODES) {
        i = NODES - 1;
      }
      for (; ; ) {
        if (COEFS_Y[i][0] > ll.y) {
          --i;
        } else if (COEFS_Y[i + 1][0] <= ll.y) {
          ++i;
        } else {
          break;
        }
      }
      var coefs = COEFS_Y[i];
      var t = 5 * (ll.y - coefs[0]) / (COEFS_Y[i + 1][0] - coefs[0]);
      t = newton_rapshon(function(x) {
        return (poly3_val(coefs, x) - ll.y) / poly3_der(coefs, x);
      }, t, EPSLN, 100);
      ll.x /= poly3_val(COEFS_X[i], t);
      ll.y = (5 * i + t) * D2R$1;
      if (xy.y < 0) {
        ll.y = -ll.y;
      }
    }
    ll.x = adjust_lon(ll.x + this.long0);
    return ll;
  }
  var names$3 = ["Robinson", "robin"];
  const robin = {
    init: init$3,
    forward: forward$3,
    inverse: inverse$3,
    names: names$3
  };
  function init$2() {
    this.name = "geocent";
  }
  function forward$2(p2) {
    var point = geodeticToGeocentric(p2, this.es, this.a);
    return point;
  }
  function inverse$2(p2) {
    var point = geocentricToGeodetic(p2, this.es, this.a, this.b);
    return point;
  }
  var names$2 = ["Geocentric", "geocentric", "geocent", "Geocent"];
  const geocent = {
    init: init$2,
    forward: forward$2,
    inverse: inverse$2,
    names: names$2
  };
  var mode = {
    N_POLE: 0,
    S_POLE: 1,
    EQUIT: 2,
    OBLIQ: 3
  };
  var params = {
    h: { def: 1e5, num: true },
    azi: { def: 0, num: true, degrees: true },
    tilt: { def: 0, num: true, degrees: true },
    long0: { def: 0, num: true },
    lat0: { def: 0, num: true }
  };
  function init$1() {
    Object.keys(params).forEach(function(p2) {
      if (typeof this[p2] === "undefined") {
        this[p2] = params[p2].def;
      } else if (params[p2].num && isNaN(this[p2])) {
        throw new Error("Invalid parameter value, must be numeric " + p2 + " = " + this[p2]);
      } else if (params[p2].num) {
        this[p2] = parseFloat(this[p2]);
      }
      if (params[p2].degrees) {
        this[p2] = this[p2] * D2R$1;
      }
    }.bind(this));
    if (Math.abs(Math.abs(this.lat0) - HALF_PI) < EPSLN) {
      this.mode = this.lat0 < 0 ? mode.S_POLE : mode.N_POLE;
    } else if (Math.abs(this.lat0) < EPSLN) {
      this.mode = mode.EQUIT;
    } else {
      this.mode = mode.OBLIQ;
      this.sinph0 = Math.sin(this.lat0);
      this.cosph0 = Math.cos(this.lat0);
    }
    this.pn1 = this.h / this.a;
    if (this.pn1 <= 0 || this.pn1 > 1e10) {
      throw new Error("Invalid height");
    }
    this.p = 1 + this.pn1;
    this.rp = 1 / this.p;
    this.h1 = 1 / this.pn1;
    this.pfact = (this.p + 1) * this.h1;
    this.es = 0;
    var omega = this.tilt;
    var gamma = this.azi;
    this.cg = Math.cos(gamma);
    this.sg = Math.sin(gamma);
    this.cw = Math.cos(omega);
    this.sw = Math.sin(omega);
  }
  function forward$1(p2) {
    p2.x -= this.long0;
    var sinphi = Math.sin(p2.y);
    var cosphi = Math.cos(p2.y);
    var coslam = Math.cos(p2.x);
    var x, y2;
    switch (this.mode) {
      case mode.OBLIQ:
        y2 = this.sinph0 * sinphi + this.cosph0 * cosphi * coslam;
        break;
      case mode.EQUIT:
        y2 = cosphi * coslam;
        break;
      case mode.S_POLE:
        y2 = -sinphi;
        break;
      case mode.N_POLE:
        y2 = sinphi;
        break;
    }
    y2 = this.pn1 / (this.p - y2);
    x = y2 * cosphi * Math.sin(p2.x);
    switch (this.mode) {
      case mode.OBLIQ:
        y2 *= this.cosph0 * sinphi - this.sinph0 * cosphi * coslam;
        break;
      case mode.EQUIT:
        y2 *= sinphi;
        break;
      case mode.N_POLE:
        y2 *= -(cosphi * coslam);
        break;
      case mode.S_POLE:
        y2 *= cosphi * coslam;
        break;
    }
    var yt, ba;
    yt = y2 * this.cg + x * this.sg;
    ba = 1 / (yt * this.sw * this.h1 + this.cw);
    x = (x * this.cg - y2 * this.sg) * this.cw * ba;
    y2 = yt * ba;
    p2.x = x * this.a;
    p2.y = y2 * this.a;
    return p2;
  }
  function inverse$1(p2) {
    p2.x /= this.a;
    p2.y /= this.a;
    var r = { x: p2.x, y: p2.y };
    var bm, bq, yt;
    yt = 1 / (this.pn1 - p2.y * this.sw);
    bm = this.pn1 * p2.x * yt;
    bq = this.pn1 * p2.y * this.cw * yt;
    p2.x = bm * this.cg + bq * this.sg;
    p2.y = bq * this.cg - bm * this.sg;
    var rh = hypot(p2.x, p2.y);
    if (Math.abs(rh) < EPSLN) {
      r.x = 0;
      r.y = p2.y;
    } else {
      var cosz, sinz;
      sinz = 1 - rh * rh * this.pfact;
      sinz = (this.p - Math.sqrt(sinz)) / (this.pn1 / rh + rh / this.pn1);
      cosz = Math.sqrt(1 - sinz * sinz);
      switch (this.mode) {
        case mode.OBLIQ:
          r.y = Math.asin(cosz * this.sinph0 + p2.y * sinz * this.cosph0 / rh);
          p2.y = (cosz - this.sinph0 * Math.sin(r.y)) * rh;
          p2.x *= sinz * this.cosph0;
          break;
        case mode.EQUIT:
          r.y = Math.asin(p2.y * sinz / rh);
          p2.y = cosz * rh;
          p2.x *= sinz;
          break;
        case mode.N_POLE:
          r.y = Math.asin(cosz);
          p2.y = -p2.y;
          break;
        case mode.S_POLE:
          r.y = -Math.asin(cosz);
          break;
      }
      r.x = Math.atan2(p2.x, p2.y);
    }
    p2.x = r.x + this.long0;
    p2.y = r.y;
    return p2;
  }
  var names$1 = ["Tilted_Perspective", "tpers"];
  const tpers = {
    init: init$1,
    forward: forward$1,
    inverse: inverse$1,
    names: names$1
  };
  function init() {
    this.flip_axis = this.sweep === "x" ? 1 : 0;
    this.h = Number(this.h);
    this.radius_g_1 = this.h / this.a;
    if (this.radius_g_1 <= 0 || this.radius_g_1 > 1e10) {
      throw new Error();
    }
    this.radius_g = 1 + this.radius_g_1;
    this.C = this.radius_g * this.radius_g - 1;
    if (this.es !== 0) {
      var one_es = 1 - this.es;
      var rone_es = 1 / one_es;
      this.radius_p = Math.sqrt(one_es);
      this.radius_p2 = one_es;
      this.radius_p_inv2 = rone_es;
      this.shape = "ellipse";
    } else {
      this.radius_p = 1;
      this.radius_p2 = 1;
      this.radius_p_inv2 = 1;
      this.shape = "sphere";
    }
    if (!this.title) {
      this.title = "Geostationary Satellite View";
    }
  }
  function forward(p2) {
    var lon = p2.x;
    var lat = p2.y;
    var tmp, v_x, v_y, v_z;
    lon = lon - this.long0;
    if (this.shape === "ellipse") {
      lat = Math.atan(this.radius_p2 * Math.tan(lat));
      var r = this.radius_p / hypot(this.radius_p * Math.cos(lat), Math.sin(lat));
      v_x = r * Math.cos(lon) * Math.cos(lat);
      v_y = r * Math.sin(lon) * Math.cos(lat);
      v_z = r * Math.sin(lat);
      if ((this.radius_g - v_x) * v_x - v_y * v_y - v_z * v_z * this.radius_p_inv2 < 0) {
        p2.x = Number.NaN;
        p2.y = Number.NaN;
        return p2;
      }
      tmp = this.radius_g - v_x;
      if (this.flip_axis) {
        p2.x = this.radius_g_1 * Math.atan(v_y / hypot(v_z, tmp));
        p2.y = this.radius_g_1 * Math.atan(v_z / tmp);
      } else {
        p2.x = this.radius_g_1 * Math.atan(v_y / tmp);
        p2.y = this.radius_g_1 * Math.atan(v_z / hypot(v_y, tmp));
      }
    } else if (this.shape === "sphere") {
      tmp = Math.cos(lat);
      v_x = Math.cos(lon) * tmp;
      v_y = Math.sin(lon) * tmp;
      v_z = Math.sin(lat);
      tmp = this.radius_g - v_x;
      if (this.flip_axis) {
        p2.x = this.radius_g_1 * Math.atan(v_y / hypot(v_z, tmp));
        p2.y = this.radius_g_1 * Math.atan(v_z / tmp);
      } else {
        p2.x = this.radius_g_1 * Math.atan(v_y / tmp);
        p2.y = this.radius_g_1 * Math.atan(v_z / hypot(v_y, tmp));
      }
    }
    p2.x = p2.x * this.a;
    p2.y = p2.y * this.a;
    return p2;
  }
  function inverse(p2) {
    var v_x = -1;
    var v_y = 0;
    var v_z = 0;
    var a, b, det, k;
    p2.x = p2.x / this.a;
    p2.y = p2.y / this.a;
    if (this.shape === "ellipse") {
      if (this.flip_axis) {
        v_z = Math.tan(p2.y / this.radius_g_1);
        v_y = Math.tan(p2.x / this.radius_g_1) * hypot(1, v_z);
      } else {
        v_y = Math.tan(p2.x / this.radius_g_1);
        v_z = Math.tan(p2.y / this.radius_g_1) * hypot(1, v_y);
      }
      var v_zp = v_z / this.radius_p;
      a = v_y * v_y + v_zp * v_zp + v_x * v_x;
      b = 2 * this.radius_g * v_x;
      det = b * b - 4 * a * this.C;
      if (det < 0) {
        p2.x = Number.NaN;
        p2.y = Number.NaN;
        return p2;
      }
      k = (-b - Math.sqrt(det)) / (2 * a);
      v_x = this.radius_g + k * v_x;
      v_y *= k;
      v_z *= k;
      p2.x = Math.atan2(v_y, v_x);
      p2.y = Math.atan(v_z * Math.cos(p2.x) / v_x);
      p2.y = Math.atan(this.radius_p_inv2 * Math.tan(p2.y));
    } else if (this.shape === "sphere") {
      if (this.flip_axis) {
        v_z = Math.tan(p2.y / this.radius_g_1);
        v_y = Math.tan(p2.x / this.radius_g_1) * Math.sqrt(1 + v_z * v_z);
      } else {
        v_y = Math.tan(p2.x / this.radius_g_1);
        v_z = Math.tan(p2.y / this.radius_g_1) * Math.sqrt(1 + v_y * v_y);
      }
      a = v_y * v_y + v_z * v_z + v_x * v_x;
      b = 2 * this.radius_g * v_x;
      det = b * b - 4 * a * this.C;
      if (det < 0) {
        p2.x = Number.NaN;
        p2.y = Number.NaN;
        return p2;
      }
      k = (-b - Math.sqrt(det)) / (2 * a);
      v_x = this.radius_g + k * v_x;
      v_y *= k;
      v_z *= k;
      p2.x = Math.atan2(v_y, v_x);
      p2.y = Math.atan(v_z * Math.cos(p2.x) / v_x);
    }
    p2.x = p2.x + this.long0;
    return p2;
  }
  var names = ["Geostationary Satellite View", "Geostationary_Satellite", "geos"];
  const geos = {
    init,
    forward,
    inverse,
    names
  };
  function includedProjections(proj42) {
    proj42.Proj.projections.add(tmerc);
    proj42.Proj.projections.add(etmerc);
    proj42.Proj.projections.add(utm);
    proj42.Proj.projections.add(sterea);
    proj42.Proj.projections.add(stere);
    proj42.Proj.projections.add(somerc);
    proj42.Proj.projections.add(omerc);
    proj42.Proj.projections.add(lcc);
    proj42.Proj.projections.add(krovak);
    proj42.Proj.projections.add(cass);
    proj42.Proj.projections.add(laea);
    proj42.Proj.projections.add(aea);
    proj42.Proj.projections.add(gnom);
    proj42.Proj.projections.add(cea);
    proj42.Proj.projections.add(eqc);
    proj42.Proj.projections.add(poly);
    proj42.Proj.projections.add(nzmg);
    proj42.Proj.projections.add(mill);
    proj42.Proj.projections.add(sinu);
    proj42.Proj.projections.add(moll);
    proj42.Proj.projections.add(eqdc);
    proj42.Proj.projections.add(vandg);
    proj42.Proj.projections.add(aeqd);
    proj42.Proj.projections.add(ortho);
    proj42.Proj.projections.add(qsc);
    proj42.Proj.projections.add(robin);
    proj42.Proj.projections.add(geocent);
    proj42.Proj.projections.add(tpers);
    proj42.Proj.projections.add(geos);
  }
  proj4.defaultDatum = "WGS84";
  proj4.Proj = Projection;
  proj4.WGS84 = new proj4.Proj("WGS84");
  proj4.Point = Point$2;
  proj4.toPoint = common;
  proj4.defs = defs;
  proj4.nadgrid = nadgrid;
  proj4.transform = transform;
  proj4.mgrs = mgrs;
  proj4.version = "__VERSION__";
  includedProjections(proj4);
  function initProjections() {
    var _a, _b, _c;
    proj4.defs("EPSG:32632", "+proj=utm +zone=32 +datum=WGS84 +units=m +no_defs");
    proj4.defs("EPSG:32631", "+proj=utm +zone=31 +datum=WGS84 +units=m +no_defs");
    proj4.defs(
      "EPSG:2169",
      "+proj=tmerc +lat_0=49.83333333333334 +lon_0=6.166666666666667 +k=1 +x_0=80000 +y_0=100000 +ellps=intl +towgs84=-189.681,18.3463,-42.7695,-0.33746,-3.09264,2.53861,0.4598 +units=m +no_defs"
    );
    register(proj4);
    (_a = get$2("EPSG:32632")) == null ? void 0 : _a.setExtent([
      166021.44,
      0,
      833978.55,
      932900518e-2
    ]);
    (_b = get$2("EPSG:32631")) == null ? void 0 : _b.setExtent([
      166021.44,
      0,
      833978.55,
      932900518e-2
    ]);
    (_c = get$2("EPSG:2169")) == null ? void 0 : _c.setExtent([
      48225.17,
      56225.6,
      105842.04,
      139616.4
    ]);
  }
  function defineCustomElement(options, config, hydrate2) {
    const Comp = runtimeCore.defineComponent(options);
    class VueCustomElement extends VueElement {
      constructor(initialProps) {
        super(Comp, initialProps, config, hydrate2);
      }
    }
    __publicField(VueCustomElement, "def", Comp);
    return VueCustomElement;
  }
  const BaseClass = typeof HTMLElement !== "undefined" ? HTMLElement : class {
  };
  class VueElement extends BaseClass {
    constructor(_def, _props = {}, _config = {}, hydrate2) {
      super();
      __publicField(this, "_instance", null);
      __publicField(this, "_connected", false);
      __publicField(this, "_resolved", false);
      __publicField(this, "_numberProps", null);
      __publicField(this, "_styles");
      __publicField(this, "_slots");
      this._def = _def;
      this._props = _props;
      this._config = _config;
      this._config = shared$1.extend(
        {
          shadowRoot: true
        },
        this._config
      );
      if (this._config.shadowRoot) {
        if (this.shadowRoot && hydrate2) {
          hydrate2(this._createVNode(), this.shadowRoot);
        } else {
          this.attachShadow({ mode: "open" });
          if (!this._def.__asyncLoader) {
            this._resolveProps(this._def);
          }
        }
      } else {
        if (hydrate2) {
          hydrate2(this._createVNode(), this._root);
        }
      }
    }
    get _root() {
      return this._config.shadowRoot ? this.shadowRoot : this;
    }
    connectedCallback() {
      this._connected = true;
      if (!this._instance) {
        if (this._resolved) {
          this._update();
        } else {
          this._resolveDef();
        }
      }
    }
    disconnectedCallback() {
      this._connected = false;
      runtimeCore.nextTick(() => {
        if (!this._connected) {
          runtimeDom.render(null, this._root);
          this._instance = null;
        }
      });
    }
    _resolveDef() {
      this._resolved = true;
      for (let i = 0; i < this.attributes.length; i++) {
        this._setAttr(this.attributes[i].name);
      }
      new MutationObserver((mutations) => {
        for (const m of mutations) {
          this._setAttr(m.attributeName);
        }
      }).observe(this, { attributes: true });
      const resolve = (def, isAsync = false) => {
        const { props, styles } = def;
        let numberProps;
        if (props && !shared$1.isArray(props)) {
          for (const key in props) {
            const opt = props[key];
            if (opt === Number || opt && opt.type === Number) {
              if (key in this._props) {
                this._props[key] = shared$1.toNumber(this._props[key]);
              }
              (numberProps || (numberProps = /* @__PURE__ */ Object.create(null)))[shared$1.camelize(key)] = true;
            }
          }
        }
        this._numberProps = numberProps;
        if (isAsync) {
          this._resolveProps(def);
        }
        this._applyStyles(styles);
        this._update();
      };
      const asyncDef = this._def.__asyncLoader;
      if (asyncDef) {
        asyncDef().then((def) => resolve(def, true));
      } else {
        resolve(this._def);
      }
    }
    _resolveProps(def) {
      const { props } = def;
      const declaredPropKeys = shared$1.isArray(props) ? props : Object.keys(props || {});
      for (const key of Object.keys(this)) {
        if (key[0] !== "_" && declaredPropKeys.includes(key)) {
          this._setProp(key, this[key], true, false);
        }
      }
      for (const key of declaredPropKeys.map(shared$1.camelize)) {
        Object.defineProperty(this, key, {
          get() {
            return this._getProp(key);
          },
          set(val) {
            this._setProp(key, val);
          }
        });
      }
    }
    _setAttr(key) {
      let value = this.getAttribute(key);
      const camelKey = shared$1.camelize(key);
      if (this._numberProps && this._numberProps[camelKey]) {
        value = shared$1.toNumber(value);
      }
      this._setProp(camelKey, value, false);
    }
    _getProp(key) {
      return this._props[key];
    }
    _setProp(key, val, shouldReflect = true, shouldUpdate = true) {
      if (val !== this._props[key]) {
        this._props[key] = val;
        if (shouldUpdate && this._instance) {
          this._update();
        }
        if (shouldReflect) {
          if (val === true) {
            this.setAttribute(shared$1.hyphenate(key), "");
          } else if (typeof val === "string" || typeof val === "number") {
            this.setAttribute(shared$1.hyphenate(key), val + "");
          } else if (!val) {
            this.removeAttribute(shared$1.hyphenate(key));
          }
        }
      }
    }
    _update() {
      runtimeDom.render(this._createVNode(), this._root);
    }
    _createVNode() {
      const vnode = runtimeCore.createVNode(this._def, shared$1.extend({}, this._props));
      if (!this._instance) {
        vnode.ce = (instance2) => {
          this._instance = instance2;
          instance2.isCE = true;
          const dispatch = (event, args) => {
            this.dispatchEvent(
              new CustomEvent(event, {
                detail: args
              })
            );
          };
          instance2.emit = (event, ...args) => {
            dispatch(event, args);
            if (shared$1.hyphenate(event) !== event) {
              dispatch(shared$1.hyphenate(event), args);
            }
          };
          let parent = this;
          while (parent = parent && (parent.parentNode || parent.host)) {
            if (parent instanceof VueElement) {
              instance2.parent = parent._instance;
              instance2.provides = parent._instance.provides;
              break;
            }
          }
        };
      }
      return vnode;
    }
    _applyStyles(styles) {
      if (styles) {
        styles.forEach((css2) => {
          const s = document.createElement("style");
          s.textContent = css2;
          this._root.appendChild(s);
        });
      }
    }
  }
  const main = "";
  const _hoisted_1$k = { class: "lux-dropdown" };
  const _hoisted_2$f = { class: "h-full" };
  const _hoisted_3$c = ["aria-expanded"];
  const _hoisted_4$b = /* @__PURE__ */ vue.createElementVNode("span", { class: "lux-caret" }, null, -1);
  const _hoisted_5$9 = { class: "lux-dropdown-wrapper" };
  const _hoisted_6$6 = ["aria-label", "data-value"];
  const _sfc_main$o = /* @__PURE__ */ vue.defineComponent({
    __name: "dropdown-list",
    props: {
      placeholder: null,
      options: { default: () => [{ label: "Default label", value: "Default value" }] },
      modelValue: null
    },
    emits: ["change"],
    setup(__props, { emit }) {
      const props = __props;
      const isOpen = vue.shallowRef(false);
      const selectedValue = vue.shallowRef();
      function toggleDropdown(forceOpen) {
        isOpen.value = forceOpen === void 0 ? !isOpen.value : forceOpen;
      }
      function onClickOpenBtn(event) {
        event.stopImmediatePropagation();
        toggleDropdown();
      }
      function onClickItem(event) {
        selectedValue.value = event.target.dataset.value;
        emit("change", selectedValue.value);
      }
      function onClickOutsideOpenBtn() {
        toggleDropdown(false);
      }
      vue.onMounted(() => document.addEventListener("click", onClickOutsideOpenBtn));
      vue.onUnmounted(() => document.removeEventListener("click", onClickOutsideOpenBtn));
      return (_ctx, _cache) => {
        var _a, _b;
        return vue.openBlock(), vue.createElementBlock("div", _hoisted_1$k, [
          vue.createElementVNode("div", _hoisted_2$f, [
            vue.createElementVNode("button", {
              type: "button",
              class: vue.normalizeClass(["lux-btn lux-dropdown-btn", vue.unref(isOpen) ? "expanded" : ""]),
              "aria-expanded": vue.unref(isOpen),
              "aria-haspopup": "true",
              onClick: onClickOpenBtn
            }, [
              vue.createElementVNode("span", null, vue.toDisplayString((_b = props.placeholder) != null ? _b : (_a = props.options[0]) == null ? void 0 : _a.label), 1),
              _hoisted_4$b
            ], 10, _hoisted_3$c)
          ]),
          vue.createElementVNode("div", _hoisted_5$9, [
            vue.createElementVNode("ul", {
              class: vue.normalizeClass(["lux-dropdown-list", vue.unref(isOpen) ? "" : "hidden"]),
              tabindex: "-1"
            }, [
              (vue.openBlock(true), vue.createElementBlock(vue.Fragment, null, vue.renderList(props.options, (option) => {
                return vue.openBlock(), vue.createElementBlock("li", {
                  key: option.value,
                  class: vue.normalizeClass(__props.modelValue === option.value ? "selected" : "")
                }, [
                  vue.createElementVNode("button", {
                    class: "lux-dropdown-list-item",
                    "aria-label": option.ariaLabel,
                    "data-value": option.value,
                    onClick: onClickItem
                  }, vue.toDisplayString(option.label), 9, _hoisted_6$6)
                ], 2);
              }), 128))
            ], 2)
          ])
        ]);
      };
    }
  });
  /**!
   * Sortable 1.15.0
   * @author	RubaXa   <trash@rubaxa.org>
   * @author	owenm    <owen23355@gmail.com>
   * @license MIT
   */
  function ownKeys$7(object, enumerableOnly) {
    var keys = Object.keys(object);
    if (Object.getOwnPropertySymbols) {
      var symbols = Object.getOwnPropertySymbols(object);
      if (enumerableOnly) {
        symbols = symbols.filter(function(sym) {
          return Object.getOwnPropertyDescriptor(object, sym).enumerable;
        });
      }
      keys.push.apply(keys, symbols);
    }
    return keys;
  }
  function _objectSpread2(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i] != null ? arguments[i] : {};
      if (i % 2) {
        ownKeys$7(Object(source), true).forEach(function(key) {
          _defineProperty$2(target, key, source[key]);
        });
      } else if (Object.getOwnPropertyDescriptors) {
        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
      } else {
        ownKeys$7(Object(source)).forEach(function(key) {
          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
        });
      }
    }
    return target;
  }
  function _typeof$4(obj) {
    "@babel/helpers - typeof";
    if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
      _typeof$4 = function(obj2) {
        return typeof obj2;
      };
    } else {
      _typeof$4 = function(obj2) {
        return obj2 && typeof Symbol === "function" && obj2.constructor === Symbol && obj2 !== Symbol.prototype ? "symbol" : typeof obj2;
      };
    }
    return _typeof$4(obj);
  }
  function _defineProperty$2(obj, key, value) {
    if (key in obj) {
      Object.defineProperty(obj, key, {
        value,
        enumerable: true,
        configurable: true,
        writable: true
      });
    } else {
      obj[key] = value;
    }
    return obj;
  }
  function _extends() {
    _extends = Object.assign || function(target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i];
        for (var key in source) {
          if (Object.prototype.hasOwnProperty.call(source, key)) {
            target[key] = source[key];
          }
        }
      }
      return target;
    };
    return _extends.apply(this, arguments);
  }
  function _objectWithoutPropertiesLoose(source, excluded) {
    if (source == null)
      return {};
    var target = {};
    var sourceKeys = Object.keys(source);
    var key, i;
    for (i = 0; i < sourceKeys.length; i++) {
      key = sourceKeys[i];
      if (excluded.indexOf(key) >= 0)
        continue;
      target[key] = source[key];
    }
    return target;
  }
  function _objectWithoutProperties(source, excluded) {
    if (source == null)
      return {};
    var target = _objectWithoutPropertiesLoose(source, excluded);
    var key, i;
    if (Object.getOwnPropertySymbols) {
      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);
      for (i = 0; i < sourceSymbolKeys.length; i++) {
        key = sourceSymbolKeys[i];
        if (excluded.indexOf(key) >= 0)
          continue;
        if (!Object.prototype.propertyIsEnumerable.call(source, key))
          continue;
        target[key] = source[key];
      }
    }
    return target;
  }
  var version = "1.15.0";
  function userAgent(pattern) {
    if (typeof window !== "undefined" && window.navigator) {
      return !!/* @__PURE__ */ navigator.userAgent.match(pattern);
    }
  }
  var IE11OrLess = userAgent(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i);
  var Edge = userAgent(/Edge/i);
  var FireFox = userAgent(/firefox/i);
  var Safari = userAgent(/safari/i) && !userAgent(/chrome/i) && !userAgent(/android/i);
  var IOS = userAgent(/iP(ad|od|hone)/i);
  var ChromeForAndroid = userAgent(/chrome/i) && userAgent(/android/i);
  var captureMode = {
    capture: false,
    passive: false
  };
  function on(el, event, fn) {
    el.addEventListener(event, fn, !IE11OrLess && captureMode);
  }
  function off(el, event, fn) {
    el.removeEventListener(event, fn, !IE11OrLess && captureMode);
  }
  function matches(el, selector) {
    if (!selector)
      return;
    selector[0] === ">" && (selector = selector.substring(1));
    if (el) {
      try {
        if (el.matches) {
          return el.matches(selector);
        } else if (el.msMatchesSelector) {
          return el.msMatchesSelector(selector);
        } else if (el.webkitMatchesSelector) {
          return el.webkitMatchesSelector(selector);
        }
      } catch (_) {
        return false;
      }
    }
    return false;
  }
  function getParentOrHost(el) {
    return el.host && el !== document && el.host.nodeType ? el.host : el.parentNode;
  }
  function closest(el, selector, ctx, includeCTX) {
    if (el) {
      ctx = ctx || document;
      do {
        if (selector != null && (selector[0] === ">" ? el.parentNode === ctx && matches(el, selector) : matches(el, selector)) || includeCTX && el === ctx) {
          return el;
        }
        if (el === ctx)
          break;
      } while (el = getParentOrHost(el));
    }
    return null;
  }
  var R_SPACE = /\s+/g;
  function toggleClass(el, name, state) {
    if (el && name) {
      if (el.classList) {
        el.classList[state ? "add" : "remove"](name);
      } else {
        var className = (" " + el.className + " ").replace(R_SPACE, " ").replace(" " + name + " ", " ");
        el.className = (className + (state ? " " + name : "")).replace(R_SPACE, " ");
      }
    }
  }
  function css(el, prop, val) {
    var style = el && el.style;
    if (style) {
      if (val === void 0) {
        if (document.defaultView && document.defaultView.getComputedStyle) {
          val = document.defaultView.getComputedStyle(el, "");
        } else if (el.currentStyle) {
          val = el.currentStyle;
        }
        return prop === void 0 ? val : val[prop];
      } else {
        if (!(prop in style) && prop.indexOf("webkit") === -1) {
          prop = "-webkit-" + prop;
        }
        style[prop] = val + (typeof val === "string" ? "" : "px");
      }
    }
  }
  function matrix(el, selfOnly) {
    var appliedTransforms = "";
    if (typeof el === "string") {
      appliedTransforms = el;
    } else {
      do {
        var transform2 = css(el, "transform");
        if (transform2 && transform2 !== "none") {
          appliedTransforms = transform2 + " " + appliedTransforms;
        }
      } while (!selfOnly && (el = el.parentNode));
    }
    var matrixFn = window.DOMMatrix || window.WebKitCSSMatrix || window.CSSMatrix || window.MSCSSMatrix;
    return matrixFn && new matrixFn(appliedTransforms);
  }
  function find(ctx, tagName, iterator) {
    if (ctx) {
      var list = ctx.getElementsByTagName(tagName), i = 0, n = list.length;
      if (iterator) {
        for (; i < n; i++) {
          iterator(list[i], i);
        }
      }
      return list;
    }
    return [];
  }
  function getWindowScrollingElement() {
    var scrollingElement = document.scrollingElement;
    if (scrollingElement) {
      return scrollingElement;
    } else {
      return document.documentElement;
    }
  }
  function getRect(el, relativeToContainingBlock, relativeToNonStaticParent, undoScale, container) {
    if (!el.getBoundingClientRect && el !== window)
      return;
    var elRect, top, left, bottom, right, height, width;
    if (el !== window && el.parentNode && el !== getWindowScrollingElement()) {
      elRect = el.getBoundingClientRect();
      top = elRect.top;
      left = elRect.left;
      bottom = elRect.bottom;
      right = elRect.right;
      height = elRect.height;
      width = elRect.width;
    } else {
      top = 0;
      left = 0;
      bottom = window.innerHeight;
      right = window.innerWidth;
      height = window.innerHeight;
      width = window.innerWidth;
    }
    if ((relativeToContainingBlock || relativeToNonStaticParent) && el !== window) {
      container = container || el.parentNode;
      if (!IE11OrLess) {
        do {
          if (container && container.getBoundingClientRect && (css(container, "transform") !== "none" || relativeToNonStaticParent && css(container, "position") !== "static")) {
            var containerRect = container.getBoundingClientRect();
            top -= containerRect.top + parseInt(css(container, "border-top-width"));
            left -= containerRect.left + parseInt(css(container, "border-left-width"));
            bottom = top + elRect.height;
            right = left + elRect.width;
            break;
          }
        } while (container = container.parentNode);
      }
    }
    if (undoScale && el !== window) {
      var elMatrix = matrix(container || el), scaleX = elMatrix && elMatrix.a, scaleY = elMatrix && elMatrix.d;
      if (elMatrix) {
        top /= scaleY;
        left /= scaleX;
        width /= scaleX;
        height /= scaleY;
        bottom = top + height;
        right = left + width;
      }
    }
    return {
      top,
      left,
      bottom,
      right,
      width,
      height
    };
  }
  function isScrolledPast(el, elSide, parentSide) {
    var parent = getParentAutoScrollElement(el, true), elSideVal = getRect(el)[elSide];
    while (parent) {
      var parentSideVal = getRect(parent)[parentSide], visible = void 0;
      if (parentSide === "top" || parentSide === "left") {
        visible = elSideVal >= parentSideVal;
      } else {
        visible = elSideVal <= parentSideVal;
      }
      if (!visible)
        return parent;
      if (parent === getWindowScrollingElement())
        break;
      parent = getParentAutoScrollElement(parent, false);
    }
    return false;
  }
  function getChild(el, childNum, options, includeDragEl) {
    var currentChild = 0, i = 0, children = el.children;
    while (i < children.length) {
      if (children[i].style.display !== "none" && children[i] !== Sortable.ghost && (includeDragEl || children[i] !== Sortable.dragged) && closest(children[i], options.draggable, el, false)) {
        if (currentChild === childNum) {
          return children[i];
        }
        currentChild++;
      }
      i++;
    }
    return null;
  }
  function lastChild(el, selector) {
    var last = el.lastElementChild;
    while (last && (last === Sortable.ghost || css(last, "display") === "none" || selector && !matches(last, selector))) {
      last = last.previousElementSibling;
    }
    return last || null;
  }
  function index(el, selector) {
    var index2 = 0;
    if (!el || !el.parentNode) {
      return -1;
    }
    while (el = el.previousElementSibling) {
      if (el.nodeName.toUpperCase() !== "TEMPLATE" && el !== Sortable.clone && (!selector || matches(el, selector))) {
        index2++;
      }
    }
    return index2;
  }
  function getRelativeScrollOffset(el) {
    var offsetLeft = 0, offsetTop = 0, winScroller = getWindowScrollingElement();
    if (el) {
      do {
        var elMatrix = matrix(el), scaleX = elMatrix.a, scaleY = elMatrix.d;
        offsetLeft += el.scrollLeft * scaleX;
        offsetTop += el.scrollTop * scaleY;
      } while (el !== winScroller && (el = el.parentNode));
    }
    return [offsetLeft, offsetTop];
  }
  function indexOfObject(arr2, obj) {
    for (var i in arr2) {
      if (!arr2.hasOwnProperty(i))
        continue;
      for (var key in obj) {
        if (obj.hasOwnProperty(key) && obj[key] === arr2[i][key])
          return Number(i);
      }
    }
    return -1;
  }
  function getParentAutoScrollElement(el, includeSelf) {
    if (!el || !el.getBoundingClientRect)
      return getWindowScrollingElement();
    var elem = el;
    var gotSelf = false;
    do {
      if (elem.clientWidth < elem.scrollWidth || elem.clientHeight < elem.scrollHeight) {
        var elemCSS = css(elem);
        if (elem.clientWidth < elem.scrollWidth && (elemCSS.overflowX == "auto" || elemCSS.overflowX == "scroll") || elem.clientHeight < elem.scrollHeight && (elemCSS.overflowY == "auto" || elemCSS.overflowY == "scroll")) {
          if (!elem.getBoundingClientRect || elem === document.body)
            return getWindowScrollingElement();
          if (gotSelf || includeSelf)
            return elem;
          gotSelf = true;
        }
      }
    } while (elem = elem.parentNode);
    return getWindowScrollingElement();
  }
  function extend$1(dst, src2) {
    if (dst && src2) {
      for (var key in src2) {
        if (src2.hasOwnProperty(key)) {
          dst[key] = src2[key];
        }
      }
    }
    return dst;
  }
  function isRectEqual(rect1, rect2) {
    return Math.round(rect1.top) === Math.round(rect2.top) && Math.round(rect1.left) === Math.round(rect2.left) && Math.round(rect1.height) === Math.round(rect2.height) && Math.round(rect1.width) === Math.round(rect2.width);
  }
  var _throttleTimeout;
  function throttle(callback, ms) {
    return function() {
      if (!_throttleTimeout) {
        var args = arguments, _this = this;
        if (args.length === 1) {
          callback.call(_this, args[0]);
        } else {
          callback.apply(_this, args);
        }
        _throttleTimeout = setTimeout(function() {
          _throttleTimeout = void 0;
        }, ms);
      }
    };
  }
  function cancelThrottle() {
    clearTimeout(_throttleTimeout);
    _throttleTimeout = void 0;
  }
  function scrollBy(el, x, y2) {
    el.scrollLeft += x;
    el.scrollTop += y2;
  }
  function clone(el) {
    var Polymer = window.Polymer;
    var $ = window.jQuery || window.Zepto;
    if (Polymer && Polymer.dom) {
      return Polymer.dom(el).cloneNode(true);
    } else if ($) {
      return $(el).clone(true)[0];
    } else {
      return el.cloneNode(true);
    }
  }
  var expando = "Sortable" + new Date().getTime();
  function AnimationStateManager() {
    var animationStates = [], animationCallbackId;
    return {
      captureAnimationState: function captureAnimationState() {
        animationStates = [];
        if (!this.options.animation)
          return;
        var children = [].slice.call(this.el.children);
        children.forEach(function(child) {
          if (css(child, "display") === "none" || child === Sortable.ghost)
            return;
          animationStates.push({
            target: child,
            rect: getRect(child)
          });
          var fromRect = _objectSpread2({}, animationStates[animationStates.length - 1].rect);
          if (child.thisAnimationDuration) {
            var childMatrix = matrix(child, true);
            if (childMatrix) {
              fromRect.top -= childMatrix.f;
              fromRect.left -= childMatrix.e;
            }
          }
          child.fromRect = fromRect;
        });
      },
      addAnimationState: function addAnimationState(state) {
        animationStates.push(state);
      },
      removeAnimationState: function removeAnimationState(target) {
        animationStates.splice(indexOfObject(animationStates, {
          target
        }), 1);
      },
      animateAll: function animateAll(callback) {
        var _this = this;
        if (!this.options.animation) {
          clearTimeout(animationCallbackId);
          if (typeof callback === "function")
            callback();
          return;
        }
        var animating = false, animationTime = 0;
        animationStates.forEach(function(state) {
          var time = 0, target = state.target, fromRect = target.fromRect, toRect = getRect(target), prevFromRect = target.prevFromRect, prevToRect = target.prevToRect, animatingRect = state.rect, targetMatrix = matrix(target, true);
          if (targetMatrix) {
            toRect.top -= targetMatrix.f;
            toRect.left -= targetMatrix.e;
          }
          target.toRect = toRect;
          if (target.thisAnimationDuration) {
            if (isRectEqual(prevFromRect, toRect) && !isRectEqual(fromRect, toRect) && (animatingRect.top - toRect.top) / (animatingRect.left - toRect.left) === (fromRect.top - toRect.top) / (fromRect.left - toRect.left)) {
              time = calculateRealTime(animatingRect, prevFromRect, prevToRect, _this.options);
            }
          }
          if (!isRectEqual(toRect, fromRect)) {
            target.prevFromRect = fromRect;
            target.prevToRect = toRect;
            if (!time) {
              time = _this.options.animation;
            }
            _this.animate(target, animatingRect, toRect, time);
          }
          if (time) {
            animating = true;
            animationTime = Math.max(animationTime, time);
            clearTimeout(target.animationResetTimer);
            target.animationResetTimer = setTimeout(function() {
              target.animationTime = 0;
              target.prevFromRect = null;
              target.fromRect = null;
              target.prevToRect = null;
              target.thisAnimationDuration = null;
            }, time);
            target.thisAnimationDuration = time;
          }
        });
        clearTimeout(animationCallbackId);
        if (!animating) {
          if (typeof callback === "function")
            callback();
        } else {
          animationCallbackId = setTimeout(function() {
            if (typeof callback === "function")
              callback();
          }, animationTime);
        }
        animationStates = [];
      },
      animate: function animate(target, currentRect, toRect, duration) {
        if (duration) {
          css(target, "transition", "");
          css(target, "transform", "");
          var elMatrix = matrix(this.el), scaleX = elMatrix && elMatrix.a, scaleY = elMatrix && elMatrix.d, translateX = (currentRect.left - toRect.left) / (scaleX || 1), translateY = (currentRect.top - toRect.top) / (scaleY || 1);
          target.animatingX = !!translateX;
          target.animatingY = !!translateY;
          css(target, "transform", "translate3d(" + translateX + "px," + translateY + "px,0)");
          this.forRepaintDummy = repaint(target);
          css(target, "transition", "transform " + duration + "ms" + (this.options.easing ? " " + this.options.easing : ""));
          css(target, "transform", "translate3d(0,0,0)");
          typeof target.animated === "number" && clearTimeout(target.animated);
          target.animated = setTimeout(function() {
            css(target, "transition", "");
            css(target, "transform", "");
            target.animated = false;
            target.animatingX = false;
            target.animatingY = false;
          }, duration);
        }
      }
    };
  }
  function repaint(target) {
    return target.offsetWidth;
  }
  function calculateRealTime(animatingRect, fromRect, toRect, options) {
    return Math.sqrt(Math.pow(fromRect.top - animatingRect.top, 2) + Math.pow(fromRect.left - animatingRect.left, 2)) / Math.sqrt(Math.pow(fromRect.top - toRect.top, 2) + Math.pow(fromRect.left - toRect.left, 2)) * options.animation;
  }
  var plugins = [];
  var defaults$3 = {
    initializeByDefault: true
  };
  var PluginManager = {
    mount: function mount(plugin) {
      for (var option in defaults$3) {
        if (defaults$3.hasOwnProperty(option) && !(option in plugin)) {
          plugin[option] = defaults$3[option];
        }
      }
      plugins.forEach(function(p2) {
        if (p2.pluginName === plugin.pluginName) {
          throw "Sortable: Cannot mount plugin ".concat(plugin.pluginName, " more than once");
        }
      });
      plugins.push(plugin);
    },
    pluginEvent: function pluginEvent2(eventName, sortable, evt) {
      var _this = this;
      this.eventCanceled = false;
      evt.cancel = function() {
        _this.eventCanceled = true;
      };
      var eventNameGlobal = eventName + "Global";
      plugins.forEach(function(plugin) {
        if (!sortable[plugin.pluginName])
          return;
        if (sortable[plugin.pluginName][eventNameGlobal]) {
          sortable[plugin.pluginName][eventNameGlobal](_objectSpread2({
            sortable
          }, evt));
        }
        if (sortable.options[plugin.pluginName] && sortable[plugin.pluginName][eventName]) {
          sortable[plugin.pluginName][eventName](_objectSpread2({
            sortable
          }, evt));
        }
      });
    },
    initializePlugins: function initializePlugins(sortable, el, defaults2, options) {
      plugins.forEach(function(plugin) {
        var pluginName = plugin.pluginName;
        if (!sortable.options[pluginName] && !plugin.initializeByDefault)
          return;
        var initialized = new plugin(sortable, el, sortable.options);
        initialized.sortable = sortable;
        initialized.options = sortable.options;
        sortable[pluginName] = initialized;
        _extends(defaults2, initialized.defaults);
      });
      for (var option in sortable.options) {
        if (!sortable.options.hasOwnProperty(option))
          continue;
        var modified = this.modifyOption(sortable, option, sortable.options[option]);
        if (typeof modified !== "undefined") {
          sortable.options[option] = modified;
        }
      }
    },
    getEventProperties: function getEventProperties(name, sortable) {
      var eventProperties = {};
      plugins.forEach(function(plugin) {
        if (typeof plugin.eventProperties !== "function")
          return;
        _extends(eventProperties, plugin.eventProperties.call(sortable[plugin.pluginName], name));
      });
      return eventProperties;
    },
    modifyOption: function modifyOption(sortable, name, value) {
      var modifiedValue;
      plugins.forEach(function(plugin) {
        if (!sortable[plugin.pluginName])
          return;
        if (plugin.optionListeners && typeof plugin.optionListeners[name] === "function") {
          modifiedValue = plugin.optionListeners[name].call(sortable[plugin.pluginName], value);
        }
      });
      return modifiedValue;
    }
  };
  function dispatchEvent(_ref2) {
    var sortable = _ref2.sortable, rootEl2 = _ref2.rootEl, name = _ref2.name, targetEl = _ref2.targetEl, cloneEl2 = _ref2.cloneEl, toEl = _ref2.toEl, fromEl = _ref2.fromEl, oldIndex2 = _ref2.oldIndex, newIndex2 = _ref2.newIndex, oldDraggableIndex2 = _ref2.oldDraggableIndex, newDraggableIndex2 = _ref2.newDraggableIndex, originalEvent = _ref2.originalEvent, putSortable2 = _ref2.putSortable, extraEventProperties = _ref2.extraEventProperties;
    sortable = sortable || rootEl2 && rootEl2[expando];
    if (!sortable)
      return;
    var evt, options = sortable.options, onName = "on" + name.charAt(0).toUpperCase() + name.substr(1);
    if (window.CustomEvent && !IE11OrLess && !Edge) {
      evt = new CustomEvent(name, {
        bubbles: true,
        cancelable: true
      });
    } else {
      evt = document.createEvent("Event");
      evt.initEvent(name, true, true);
    }
    evt.to = toEl || rootEl2;
    evt.from = fromEl || rootEl2;
    evt.item = targetEl || rootEl2;
    evt.clone = cloneEl2;
    evt.oldIndex = oldIndex2;
    evt.newIndex = newIndex2;
    evt.oldDraggableIndex = oldDraggableIndex2;
    evt.newDraggableIndex = newDraggableIndex2;
    evt.originalEvent = originalEvent;
    evt.pullMode = putSortable2 ? putSortable2.lastPutMode : void 0;
    var allEventProperties = _objectSpread2(_objectSpread2({}, extraEventProperties), PluginManager.getEventProperties(name, sortable));
    for (var option in allEventProperties) {
      evt[option] = allEventProperties[option];
    }
    if (rootEl2) {
      rootEl2.dispatchEvent(evt);
    }
    if (options[onName]) {
      options[onName].call(sortable, evt);
    }
  }
  var _excluded = ["evt"];
  var pluginEvent = function pluginEvent2(eventName, sortable) {
    var _ref2 = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {}, originalEvent = _ref2.evt, data = _objectWithoutProperties(_ref2, _excluded);
    PluginManager.pluginEvent.bind(Sortable)(eventName, sortable, _objectSpread2({
      dragEl,
      parentEl,
      ghostEl,
      rootEl,
      nextEl,
      lastDownEl,
      cloneEl,
      cloneHidden,
      dragStarted: moved,
      putSortable,
      activeSortable: Sortable.active,
      originalEvent,
      oldIndex,
      oldDraggableIndex,
      newIndex,
      newDraggableIndex,
      hideGhostForTarget: _hideGhostForTarget,
      unhideGhostForTarget: _unhideGhostForTarget,
      cloneNowHidden: function cloneNowHidden() {
        cloneHidden = true;
      },
      cloneNowShown: function cloneNowShown() {
        cloneHidden = false;
      },
      dispatchSortableEvent: function dispatchSortableEvent(name) {
        _dispatchEvent({
          sortable,
          name,
          originalEvent
        });
      }
    }, data));
  };
  function _dispatchEvent(info) {
    dispatchEvent(_objectSpread2({
      putSortable,
      cloneEl,
      targetEl: dragEl,
      rootEl,
      oldIndex,
      oldDraggableIndex,
      newIndex,
      newDraggableIndex
    }, info));
  }
  var dragEl, parentEl, ghostEl, rootEl, nextEl, lastDownEl, cloneEl, cloneHidden, oldIndex, newIndex, oldDraggableIndex, newDraggableIndex, activeGroup, putSortable, awaitingDragStarted = false, ignoreNextClick = false, sortables = [], tapEvt, touchEvt, lastDx, lastDy, tapDistanceLeft, tapDistanceTop, moved, lastTarget, lastDirection, pastFirstInvertThresh = false, isCircumstantialInvert = false, targetMoveDistance, ghostRelativeParent, ghostRelativeParentInitialScroll = [], _silent = false, savedInputChecked = [];
  var documentExists = typeof document !== "undefined", PositionGhostAbsolutely = IOS, CSSFloatProperty = Edge || IE11OrLess ? "cssFloat" : "float", supportDraggable = documentExists && !ChromeForAndroid && !IOS && "draggable" in document.createElement("div"), supportCssPointerEvents = function() {
    if (!documentExists)
      return;
    if (IE11OrLess) {
      return false;
    }
    var el = document.createElement("x");
    el.style.cssText = "pointer-events:auto";
    return el.style.pointerEvents === "auto";
  }(), _detectDirection = function _detectDirection2(el, options) {
    var elCSS = css(el), elWidth = parseInt(elCSS.width) - parseInt(elCSS.paddingLeft) - parseInt(elCSS.paddingRight) - parseInt(elCSS.borderLeftWidth) - parseInt(elCSS.borderRightWidth), child1 = getChild(el, 0, options), child2 = getChild(el, 1, options), firstChildCSS = child1 && css(child1), secondChildCSS = child2 && css(child2), firstChildWidth = firstChildCSS && parseInt(firstChildCSS.marginLeft) + parseInt(firstChildCSS.marginRight) + getRect(child1).width, secondChildWidth = secondChildCSS && parseInt(secondChildCSS.marginLeft) + parseInt(secondChildCSS.marginRight) + getRect(child2).width;
    if (elCSS.display === "flex") {
      return elCSS.flexDirection === "column" || elCSS.flexDirection === "column-reverse" ? "vertical" : "horizontal";
    }
    if (elCSS.display === "grid") {
      return elCSS.gridTemplateColumns.split(" ").length <= 1 ? "vertical" : "horizontal";
    }
    if (child1 && firstChildCSS["float"] && firstChildCSS["float"] !== "none") {
      var touchingSideChild2 = firstChildCSS["float"] === "left" ? "left" : "right";
      return child2 && (secondChildCSS.clear === "both" || secondChildCSS.clear === touchingSideChild2) ? "vertical" : "horizontal";
    }
    return child1 && (firstChildCSS.display === "block" || firstChildCSS.display === "flex" || firstChildCSS.display === "table" || firstChildCSS.display === "grid" || firstChildWidth >= elWidth && elCSS[CSSFloatProperty] === "none" || child2 && elCSS[CSSFloatProperty] === "none" && firstChildWidth + secondChildWidth > elWidth) ? "vertical" : "horizontal";
  }, _dragElInRowColumn = function _dragElInRowColumn2(dragRect, targetRect, vertical) {
    var dragElS1Opp = vertical ? dragRect.left : dragRect.top, dragElS2Opp = vertical ? dragRect.right : dragRect.bottom, dragElOppLength = vertical ? dragRect.width : dragRect.height, targetS1Opp = vertical ? targetRect.left : targetRect.top, targetS2Opp = vertical ? targetRect.right : targetRect.bottom, targetOppLength = vertical ? targetRect.width : targetRect.height;
    return dragElS1Opp === targetS1Opp || dragElS2Opp === targetS2Opp || dragElS1Opp + dragElOppLength / 2 === targetS1Opp + targetOppLength / 2;
  }, _detectNearestEmptySortable = function _detectNearestEmptySortable2(x, y2) {
    var ret;
    sortables.some(function(sortable) {
      var threshold = sortable[expando].options.emptyInsertThreshold;
      if (!threshold || lastChild(sortable))
        return;
      var rect = getRect(sortable), insideHorizontally = x >= rect.left - threshold && x <= rect.right + threshold, insideVertically = y2 >= rect.top - threshold && y2 <= rect.bottom + threshold;
      if (insideHorizontally && insideVertically) {
        return ret = sortable;
      }
    });
    return ret;
  }, _prepareGroup = function _prepareGroup2(options) {
    function toFn(value, pull) {
      return function(to, from, dragEl2, evt) {
        var sameGroup = to.options.group.name && from.options.group.name && to.options.group.name === from.options.group.name;
        if (value == null && (pull || sameGroup)) {
          return true;
        } else if (value == null || value === false) {
          return false;
        } else if (pull && value === "clone") {
          return value;
        } else if (typeof value === "function") {
          return toFn(value(to, from, dragEl2, evt), pull)(to, from, dragEl2, evt);
        } else {
          var otherGroup = (pull ? to : from).options.group.name;
          return value === true || typeof value === "string" && value === otherGroup || value.join && value.indexOf(otherGroup) > -1;
        }
      };
    }
    var group = {};
    var originalGroup = options.group;
    if (!originalGroup || _typeof$4(originalGroup) != "object") {
      originalGroup = {
        name: originalGroup
      };
    }
    group.name = originalGroup.name;
    group.checkPull = toFn(originalGroup.pull, true);
    group.checkPut = toFn(originalGroup.put);
    group.revertClone = originalGroup.revertClone;
    options.group = group;
  }, _hideGhostForTarget = function _hideGhostForTarget2() {
    if (!supportCssPointerEvents && ghostEl) {
      css(ghostEl, "display", "none");
    }
  }, _unhideGhostForTarget = function _unhideGhostForTarget2() {
    if (!supportCssPointerEvents && ghostEl) {
      css(ghostEl, "display", "");
    }
  };
  if (documentExists && !ChromeForAndroid) {
    document.addEventListener("click", function(evt) {
      if (ignoreNextClick) {
        evt.preventDefault();
        evt.stopPropagation && evt.stopPropagation();
        evt.stopImmediatePropagation && evt.stopImmediatePropagation();
        ignoreNextClick = false;
        return false;
      }
    }, true);
  }
  var nearestEmptyInsertDetectEvent = function nearestEmptyInsertDetectEvent2(evt) {
    if (dragEl) {
      evt = evt.touches ? evt.touches[0] : evt;
      var nearest = _detectNearestEmptySortable(evt.clientX, evt.clientY);
      if (nearest) {
        var event = {};
        for (var i in evt) {
          if (evt.hasOwnProperty(i)) {
            event[i] = evt[i];
          }
        }
        event.target = event.rootEl = nearest;
        event.preventDefault = void 0;
        event.stopPropagation = void 0;
        nearest[expando]._onDragOver(event);
      }
    }
  };
  var _checkOutsideTargetEl = function _checkOutsideTargetEl2(evt) {
    if (dragEl) {
      dragEl.parentNode[expando]._isOutsideThisEl(evt.target);
    }
  };
  function Sortable(el, options) {
    if (!(el && el.nodeType && el.nodeType === 1)) {
      throw "Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(el));
    }
    this.el = el;
    this.options = options = _extends({}, options);
    el[expando] = this;
    var defaults2 = {
      group: null,
      sort: true,
      disabled: false,
      store: null,
      handle: null,
      draggable: /^[uo]l$/i.test(el.nodeName) ? ">li" : ">*",
      swapThreshold: 1,
      invertSwap: false,
      invertedSwapThreshold: null,
      removeCloneOnHide: true,
      direction: function direction() {
        return _detectDirection(el, this.options);
      },
      ghostClass: "sortable-ghost",
      chosenClass: "sortable-chosen",
      dragClass: "sortable-drag",
      ignore: "a, img",
      filter: null,
      preventOnFilter: true,
      animation: 0,
      easing: null,
      setData: function setData(dataTransfer, dragEl2) {
        dataTransfer.setData("Text", dragEl2.textContent);
      },
      dropBubble: false,
      dragoverBubble: false,
      dataIdAttr: "data-id",
      delay: 0,
      delayOnTouchOnly: false,
      touchStartThreshold: (Number.parseInt ? Number : window).parseInt(window.devicePixelRatio, 10) || 1,
      forceFallback: false,
      fallbackClass: "sortable-fallback",
      fallbackOnBody: false,
      fallbackTolerance: 0,
      fallbackOffset: {
        x: 0,
        y: 0
      },
      supportPointer: Sortable.supportPointer !== false && "PointerEvent" in window && !Safari,
      emptyInsertThreshold: 5
    };
    PluginManager.initializePlugins(this, el, defaults2);
    for (var name in defaults2) {
      !(name in options) && (options[name] = defaults2[name]);
    }
    _prepareGroup(options);
    for (var fn in this) {
      if (fn.charAt(0) === "_" && typeof this[fn] === "function") {
        this[fn] = this[fn].bind(this);
      }
    }
    this.nativeDraggable = options.forceFallback ? false : supportDraggable;
    if (this.nativeDraggable) {
      this.options.touchStartThreshold = 1;
    }
    if (options.supportPointer) {
      on(el, "pointerdown", this._onTapStart);
    } else {
      on(el, "mousedown", this._onTapStart);
      on(el, "touchstart", this._onTapStart);
    }
    if (this.nativeDraggable) {
      on(el, "dragover", this);
      on(el, "dragenter", this);
    }
    sortables.push(this.el);
    options.store && options.store.get && this.sort(options.store.get(this) || []);
    _extends(this, AnimationStateManager());
  }
  Sortable.prototype = {
    constructor: Sortable,
    _isOutsideThisEl: function _isOutsideThisEl(target) {
      if (!this.el.contains(target) && target !== this.el) {
        lastTarget = null;
      }
    },
    _getDirection: function _getDirection(evt, target) {
      return typeof this.options.direction === "function" ? this.options.direction.call(this, evt, target, dragEl) : this.options.direction;
    },
    _onTapStart: function _onTapStart(evt) {
      if (!evt.cancelable)
        return;
      var _this = this, el = this.el, options = this.options, preventOnFilter = options.preventOnFilter, type = evt.type, touch = evt.touches && evt.touches[0] || evt.pointerType && evt.pointerType === "touch" && evt, target = (touch || evt).target, originalTarget = evt.target.shadowRoot && (evt.path && evt.path[0] || evt.composedPath && evt.composedPath()[0]) || target, filter = options.filter;
      _saveInputCheckedState(el);
      if (dragEl) {
        return;
      }
      if (/mousedown|pointerdown/.test(type) && evt.button !== 0 || options.disabled) {
        return;
      }
      if (originalTarget.isContentEditable) {
        return;
      }
      if (!this.nativeDraggable && Safari && target && target.tagName.toUpperCase() === "SELECT") {
        return;
      }
      target = closest(target, options.draggable, el, false);
      if (target && target.animated) {
        return;
      }
      if (lastDownEl === target) {
        return;
      }
      oldIndex = index(target);
      oldDraggableIndex = index(target, options.draggable);
      if (typeof filter === "function") {
        if (filter.call(this, evt, target, this)) {
          _dispatchEvent({
            sortable: _this,
            rootEl: originalTarget,
            name: "filter",
            targetEl: target,
            toEl: el,
            fromEl: el
          });
          pluginEvent("filter", _this, {
            evt
          });
          preventOnFilter && evt.cancelable && evt.preventDefault();
          return;
        }
      } else if (filter) {
        filter = filter.split(",").some(function(criteria) {
          criteria = closest(originalTarget, criteria.trim(), el, false);
          if (criteria) {
            _dispatchEvent({
              sortable: _this,
              rootEl: criteria,
              name: "filter",
              targetEl: target,
              fromEl: el,
              toEl: el
            });
            pluginEvent("filter", _this, {
              evt
            });
            return true;
          }
        });
        if (filter) {
          preventOnFilter && evt.cancelable && evt.preventDefault();
          return;
        }
      }
      if (options.handle && !closest(originalTarget, options.handle, el, false)) {
        return;
      }
      this._prepareDragStart(evt, touch, target);
    },
    _prepareDragStart: function _prepareDragStart(evt, touch, target) {
      var _this = this, el = _this.el, options = _this.options, ownerDocument = el.ownerDocument, dragStartFn;
      if (target && !dragEl && target.parentNode === el) {
        var dragRect = getRect(target);
        rootEl = el;
        dragEl = target;
        parentEl = dragEl.parentNode;
        nextEl = dragEl.nextSibling;
        lastDownEl = target;
        activeGroup = options.group;
        Sortable.dragged = dragEl;
        tapEvt = {
          target: dragEl,
          clientX: (touch || evt).clientX,
          clientY: (touch || evt).clientY
        };
        tapDistanceLeft = tapEvt.clientX - dragRect.left;
        tapDistanceTop = tapEvt.clientY - dragRect.top;
        this._lastX = (touch || evt).clientX;
        this._lastY = (touch || evt).clientY;
        dragEl.style["will-change"] = "all";
        dragStartFn = function dragStartFn2() {
          pluginEvent("delayEnded", _this, {
            evt
          });
          if (Sortable.eventCanceled) {
            _this._onDrop();
            return;
          }
          _this._disableDelayedDragEvents();
          if (!FireFox && _this.nativeDraggable) {
            dragEl.draggable = true;
          }
          _this._triggerDragStart(evt, touch);
          _dispatchEvent({
            sortable: _this,
            name: "choose",
            originalEvent: evt
          });
          toggleClass(dragEl, options.chosenClass, true);
        };
        options.ignore.split(",").forEach(function(criteria) {
          find(dragEl, criteria.trim(), _disableDraggable);
        });
        on(ownerDocument, "dragover", nearestEmptyInsertDetectEvent);
        on(ownerDocument, "mousemove", nearestEmptyInsertDetectEvent);
        on(ownerDocument, "touchmove", nearestEmptyInsertDetectEvent);
        on(ownerDocument, "mouseup", _this._onDrop);
        on(ownerDocument, "touchend", _this._onDrop);
        on(ownerDocument, "touchcancel", _this._onDrop);
        if (FireFox && this.nativeDraggable) {
          this.options.touchStartThreshold = 4;
          dragEl.draggable = true;
        }
        pluginEvent("delayStart", this, {
          evt
        });
        if (options.delay && (!options.delayOnTouchOnly || touch) && (!this.nativeDraggable || !(Edge || IE11OrLess))) {
          if (Sortable.eventCanceled) {
            this._onDrop();
            return;
          }
          on(ownerDocument, "mouseup", _this._disableDelayedDrag);
          on(ownerDocument, "touchend", _this._disableDelayedDrag);
          on(ownerDocument, "touchcancel", _this._disableDelayedDrag);
          on(ownerDocument, "mousemove", _this._delayedDragTouchMoveHandler);
          on(ownerDocument, "touchmove", _this._delayedDragTouchMoveHandler);
          options.supportPointer && on(ownerDocument, "pointermove", _this._delayedDragTouchMoveHandler);
          _this._dragStartTimer = setTimeout(dragStartFn, options.delay);
        } else {
          dragStartFn();
        }
      }
    },
    _delayedDragTouchMoveHandler: function _delayedDragTouchMoveHandler(e) {
      var touch = e.touches ? e.touches[0] : e;
      if (Math.max(Math.abs(touch.clientX - this._lastX), Math.abs(touch.clientY - this._lastY)) >= Math.floor(this.options.touchStartThreshold / (this.nativeDraggable && window.devicePixelRatio || 1))) {
        this._disableDelayedDrag();
      }
    },
    _disableDelayedDrag: function _disableDelayedDrag() {
      dragEl && _disableDraggable(dragEl);
      clearTimeout(this._dragStartTimer);
      this._disableDelayedDragEvents();
    },
    _disableDelayedDragEvents: function _disableDelayedDragEvents() {
      var ownerDocument = this.el.ownerDocument;
      off(ownerDocument, "mouseup", this._disableDelayedDrag);
      off(ownerDocument, "touchend", this._disableDelayedDrag);
      off(ownerDocument, "touchcancel", this._disableDelayedDrag);
      off(ownerDocument, "mousemove", this._delayedDragTouchMoveHandler);
      off(ownerDocument, "touchmove", this._delayedDragTouchMoveHandler);
      off(ownerDocument, "pointermove", this._delayedDragTouchMoveHandler);
    },
    _triggerDragStart: function _triggerDragStart(evt, touch) {
      touch = touch || evt.pointerType == "touch" && evt;
      if (!this.nativeDraggable || touch) {
        if (this.options.supportPointer) {
          on(document, "pointermove", this._onTouchMove);
        } else if (touch) {
          on(document, "touchmove", this._onTouchMove);
        } else {
          on(document, "mousemove", this._onTouchMove);
        }
      } else {
        on(dragEl, "dragend", this);
        on(rootEl, "dragstart", this._onDragStart);
      }
      try {
        if (document.selection) {
          _nextTick(function() {
            document.selection.empty();
          });
        } else {
          window.getSelection().removeAllRanges();
        }
      } catch (err) {
      }
    },
    _dragStarted: function _dragStarted(fallback, evt) {
      awaitingDragStarted = false;
      if (rootEl && dragEl) {
        pluginEvent("dragStarted", this, {
          evt
        });
        if (this.nativeDraggable) {
          on(document, "dragover", _checkOutsideTargetEl);
        }
        var options = this.options;
        !fallback && toggleClass(dragEl, options.dragClass, false);
        toggleClass(dragEl, options.ghostClass, true);
        Sortable.active = this;
        fallback && this._appendGhost();
        _dispatchEvent({
          sortable: this,
          name: "start",
          originalEvent: evt
        });
      } else {
        this._nulling();
      }
    },
    _emulateDragOver: function _emulateDragOver() {
      if (touchEvt) {
        this._lastX = touchEvt.clientX;
        this._lastY = touchEvt.clientY;
        _hideGhostForTarget();
        var target = document.elementFromPoint(touchEvt.clientX, touchEvt.clientY);
        var parent = target;
        while (target && target.shadowRoot) {
          target = target.shadowRoot.elementFromPoint(touchEvt.clientX, touchEvt.clientY);
          if (target === parent)
            break;
          parent = target;
        }
        dragEl.parentNode[expando]._isOutsideThisEl(target);
        if (parent) {
          do {
            if (parent[expando]) {
              var inserted = void 0;
              inserted = parent[expando]._onDragOver({
                clientX: touchEvt.clientX,
                clientY: touchEvt.clientY,
                target,
                rootEl: parent
              });
              if (inserted && !this.options.dragoverBubble) {
                break;
              }
            }
            target = parent;
          } while (parent = parent.parentNode);
        }
        _unhideGhostForTarget();
      }
    },
    _onTouchMove: function _onTouchMove(evt) {
      if (tapEvt) {
        var options = this.options, fallbackTolerance = options.fallbackTolerance, fallbackOffset = options.fallbackOffset, touch = evt.touches ? evt.touches[0] : evt, ghostMatrix = ghostEl && matrix(ghostEl, true), scaleX = ghostEl && ghostMatrix && ghostMatrix.a, scaleY = ghostEl && ghostMatrix && ghostMatrix.d, relativeScrollOffset = PositionGhostAbsolutely && ghostRelativeParent && getRelativeScrollOffset(ghostRelativeParent), dx = (touch.clientX - tapEvt.clientX + fallbackOffset.x) / (scaleX || 1) + (relativeScrollOffset ? relativeScrollOffset[0] - ghostRelativeParentInitialScroll[0] : 0) / (scaleX || 1), dy = (touch.clientY - tapEvt.clientY + fallbackOffset.y) / (scaleY || 1) + (relativeScrollOffset ? relativeScrollOffset[1] - ghostRelativeParentInitialScroll[1] : 0) / (scaleY || 1);
        if (!Sortable.active && !awaitingDragStarted) {
          if (fallbackTolerance && Math.max(Math.abs(touch.clientX - this._lastX), Math.abs(touch.clientY - this._lastY)) < fallbackTolerance) {
            return;
          }
          this._onDragStart(evt, true);
        }
        if (ghostEl) {
          if (ghostMatrix) {
            ghostMatrix.e += dx - (lastDx || 0);
            ghostMatrix.f += dy - (lastDy || 0);
          } else {
            ghostMatrix = {
              a: 1,
              b: 0,
              c: 0,
              d: 1,
              e: dx,
              f: dy
            };
          }
          var cssMatrix = "matrix(".concat(ghostMatrix.a, ",").concat(ghostMatrix.b, ",").concat(ghostMatrix.c, ",").concat(ghostMatrix.d, ",").concat(ghostMatrix.e, ",").concat(ghostMatrix.f, ")");
          css(ghostEl, "webkitTransform", cssMatrix);
          css(ghostEl, "mozTransform", cssMatrix);
          css(ghostEl, "msTransform", cssMatrix);
          css(ghostEl, "transform", cssMatrix);
          lastDx = dx;
          lastDy = dy;
          touchEvt = touch;
        }
        evt.cancelable && evt.preventDefault();
      }
    },
    _appendGhost: function _appendGhost() {
      if (!ghostEl) {
        var container = this.options.fallbackOnBody ? document.body : rootEl, rect = getRect(dragEl, true, PositionGhostAbsolutely, true, container), options = this.options;
        if (PositionGhostAbsolutely) {
          ghostRelativeParent = container;
          while (css(ghostRelativeParent, "position") === "static" && css(ghostRelativeParent, "transform") === "none" && ghostRelativeParent !== document) {
            ghostRelativeParent = ghostRelativeParent.parentNode;
          }
          if (ghostRelativeParent !== document.body && ghostRelativeParent !== document.documentElement) {
            if (ghostRelativeParent === document)
              ghostRelativeParent = getWindowScrollingElement();
            rect.top += ghostRelativeParent.scrollTop;
            rect.left += ghostRelativeParent.scrollLeft;
          } else {
            ghostRelativeParent = getWindowScrollingElement();
          }
          ghostRelativeParentInitialScroll = getRelativeScrollOffset(ghostRelativeParent);
        }
        ghostEl = dragEl.cloneNode(true);
        toggleClass(ghostEl, options.ghostClass, false);
        toggleClass(ghostEl, options.fallbackClass, true);
        toggleClass(ghostEl, options.dragClass, true);
        css(ghostEl, "transition", "");
        css(ghostEl, "transform", "");
        css(ghostEl, "box-sizing", "border-box");
        css(ghostEl, "margin", 0);
        css(ghostEl, "top", rect.top);
        css(ghostEl, "left", rect.left);
        css(ghostEl, "width", rect.width);
        css(ghostEl, "height", rect.height);
        css(ghostEl, "opacity", "0.8");
        css(ghostEl, "position", PositionGhostAbsolutely ? "absolute" : "fixed");
        css(ghostEl, "zIndex", "100000");
        css(ghostEl, "pointerEvents", "none");
        Sortable.ghost = ghostEl;
        container.appendChild(ghostEl);
        css(ghostEl, "transform-origin", tapDistanceLeft / parseInt(ghostEl.style.width) * 100 + "% " + tapDistanceTop / parseInt(ghostEl.style.height) * 100 + "%");
      }
    },
    _onDragStart: function _onDragStart(evt, fallback) {
      var _this = this;
      var dataTransfer = evt.dataTransfer;
      var options = _this.options;
      pluginEvent("dragStart", this, {
        evt
      });
      if (Sortable.eventCanceled) {
        this._onDrop();
        return;
      }
      pluginEvent("setupClone", this);
      if (!Sortable.eventCanceled) {
        cloneEl = clone(dragEl);
        cloneEl.removeAttribute("id");
        cloneEl.draggable = false;
        cloneEl.style["will-change"] = "";
        this._hideClone();
        toggleClass(cloneEl, this.options.chosenClass, false);
        Sortable.clone = cloneEl;
      }
      _this.cloneId = _nextTick(function() {
        pluginEvent("clone", _this);
        if (Sortable.eventCanceled)
          return;
        if (!_this.options.removeCloneOnHide) {
          rootEl.insertBefore(cloneEl, dragEl);
        }
        _this._hideClone();
        _dispatchEvent({
          sortable: _this,
          name: "clone"
        });
      });
      !fallback && toggleClass(dragEl, options.dragClass, true);
      if (fallback) {
        ignoreNextClick = true;
        _this._loopId = setInterval(_this._emulateDragOver, 50);
      } else {
        off(document, "mouseup", _this._onDrop);
        off(document, "touchend", _this._onDrop);
        off(document, "touchcancel", _this._onDrop);
        if (dataTransfer) {
          dataTransfer.effectAllowed = "move";
          options.setData && options.setData.call(_this, dataTransfer, dragEl);
        }
        on(document, "drop", _this);
        css(dragEl, "transform", "translateZ(0)");
      }
      awaitingDragStarted = true;
      _this._dragStartId = _nextTick(_this._dragStarted.bind(_this, fallback, evt));
      on(document, "selectstart", _this);
      moved = true;
      if (Safari) {
        css(document.body, "user-select", "none");
      }
    },
    _onDragOver: function _onDragOver(evt) {
      var el = this.el, target = evt.target, dragRect, targetRect, revert, options = this.options, group = options.group, activeSortable = Sortable.active, isOwner = activeGroup === group, canSort = options.sort, fromSortable = putSortable || activeSortable, vertical, _this = this, completedFired = false;
      if (_silent)
        return;
      function dragOverEvent(name, extra) {
        pluginEvent(name, _this, _objectSpread2({
          evt,
          isOwner,
          axis: vertical ? "vertical" : "horizontal",
          revert,
          dragRect,
          targetRect,
          canSort,
          fromSortable,
          target,
          completed,
          onMove: function onMove(target2, after2) {
            return _onMove(rootEl, el, dragEl, dragRect, target2, getRect(target2), evt, after2);
          },
          changed
        }, extra));
      }
      function capture() {
        dragOverEvent("dragOverAnimationCapture");
        _this.captureAnimationState();
        if (_this !== fromSortable) {
          fromSortable.captureAnimationState();
        }
      }
      function completed(insertion) {
        dragOverEvent("dragOverCompleted", {
          insertion
        });
        if (insertion) {
          if (isOwner) {
            activeSortable._hideClone();
          } else {
            activeSortable._showClone(_this);
          }
          if (_this !== fromSortable) {
            toggleClass(dragEl, putSortable ? putSortable.options.ghostClass : activeSortable.options.ghostClass, false);
            toggleClass(dragEl, options.ghostClass, true);
          }
          if (putSortable !== _this && _this !== Sortable.active) {
            putSortable = _this;
          } else if (_this === Sortable.active && putSortable) {
            putSortable = null;
          }
          if (fromSortable === _this) {
            _this._ignoreWhileAnimating = target;
          }
          _this.animateAll(function() {
            dragOverEvent("dragOverAnimationComplete");
            _this._ignoreWhileAnimating = null;
          });
          if (_this !== fromSortable) {
            fromSortable.animateAll();
            fromSortable._ignoreWhileAnimating = null;
          }
        }
        if (target === dragEl && !dragEl.animated || target === el && !target.animated) {
          lastTarget = null;
        }
        if (!options.dragoverBubble && !evt.rootEl && target !== document) {
          dragEl.parentNode[expando]._isOutsideThisEl(evt.target);
          !insertion && nearestEmptyInsertDetectEvent(evt);
        }
        !options.dragoverBubble && evt.stopPropagation && evt.stopPropagation();
        return completedFired = true;
      }
      function changed() {
        newIndex = index(dragEl);
        newDraggableIndex = index(dragEl, options.draggable);
        _dispatchEvent({
          sortable: _this,
          name: "change",
          toEl: el,
          newIndex,
          newDraggableIndex,
          originalEvent: evt
        });
      }
      if (evt.preventDefault !== void 0) {
        evt.cancelable && evt.preventDefault();
      }
      target = closest(target, options.draggable, el, true);
      dragOverEvent("dragOver");
      if (Sortable.eventCanceled)
        return completedFired;
      if (dragEl.contains(evt.target) || target.animated && target.animatingX && target.animatingY || _this._ignoreWhileAnimating === target) {
        return completed(false);
      }
      ignoreNextClick = false;
      if (activeSortable && !options.disabled && (isOwner ? canSort || (revert = parentEl !== rootEl) : putSortable === this || (this.lastPutMode = activeGroup.checkPull(this, activeSortable, dragEl, evt)) && group.checkPut(this, activeSortable, dragEl, evt))) {
        vertical = this._getDirection(evt, target) === "vertical";
        dragRect = getRect(dragEl);
        dragOverEvent("dragOverValid");
        if (Sortable.eventCanceled)
          return completedFired;
        if (revert) {
          parentEl = rootEl;
          capture();
          this._hideClone();
          dragOverEvent("revert");
          if (!Sortable.eventCanceled) {
            if (nextEl) {
              rootEl.insertBefore(dragEl, nextEl);
            } else {
              rootEl.appendChild(dragEl);
            }
          }
          return completed(true);
        }
        var elLastChild = lastChild(el, options.draggable);
        if (!elLastChild || _ghostIsLast(evt, vertical, this) && !elLastChild.animated) {
          if (elLastChild === dragEl) {
            return completed(false);
          }
          if (elLastChild && el === evt.target) {
            target = elLastChild;
          }
          if (target) {
            targetRect = getRect(target);
          }
          if (_onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, !!target) !== false) {
            capture();
            if (elLastChild && elLastChild.nextSibling) {
              el.insertBefore(dragEl, elLastChild.nextSibling);
            } else {
              el.appendChild(dragEl);
            }
            parentEl = el;
            changed();
            return completed(true);
          }
        } else if (elLastChild && _ghostIsFirst(evt, vertical, this)) {
          var firstChild = getChild(el, 0, options, true);
          if (firstChild === dragEl) {
            return completed(false);
          }
          target = firstChild;
          targetRect = getRect(target);
          if (_onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, false) !== false) {
            capture();
            el.insertBefore(dragEl, firstChild);
            parentEl = el;
            changed();
            return completed(true);
          }
        } else if (target.parentNode === el) {
          targetRect = getRect(target);
          var direction = 0, targetBeforeFirstSwap, differentLevel = dragEl.parentNode !== el, differentRowCol = !_dragElInRowColumn(dragEl.animated && dragEl.toRect || dragRect, target.animated && target.toRect || targetRect, vertical), side1 = vertical ? "top" : "left", scrolledPastTop = isScrolledPast(target, "top", "top") || isScrolledPast(dragEl, "top", "top"), scrollBefore = scrolledPastTop ? scrolledPastTop.scrollTop : void 0;
          if (lastTarget !== target) {
            targetBeforeFirstSwap = targetRect[side1];
            pastFirstInvertThresh = false;
            isCircumstantialInvert = !differentRowCol && options.invertSwap || differentLevel;
          }
          direction = _getSwapDirection(evt, target, targetRect, vertical, differentRowCol ? 1 : options.swapThreshold, options.invertedSwapThreshold == null ? options.swapThreshold : options.invertedSwapThreshold, isCircumstantialInvert, lastTarget === target);
          var sibling;
          if (direction !== 0) {
            var dragIndex = index(dragEl);
            do {
              dragIndex -= direction;
              sibling = parentEl.children[dragIndex];
            } while (sibling && (css(sibling, "display") === "none" || sibling === ghostEl));
          }
          if (direction === 0 || sibling === target) {
            return completed(false);
          }
          lastTarget = target;
          lastDirection = direction;
          var nextSibling = target.nextElementSibling, after = false;
          after = direction === 1;
          var moveVector = _onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, after);
          if (moveVector !== false) {
            if (moveVector === 1 || moveVector === -1) {
              after = moveVector === 1;
            }
            _silent = true;
            setTimeout(_unsilent, 30);
            capture();
            if (after && !nextSibling) {
              el.appendChild(dragEl);
            } else {
              target.parentNode.insertBefore(dragEl, after ? nextSibling : target);
            }
            if (scrolledPastTop) {
              scrollBy(scrolledPastTop, 0, scrollBefore - scrolledPastTop.scrollTop);
            }
            parentEl = dragEl.parentNode;
            if (targetBeforeFirstSwap !== void 0 && !isCircumstantialInvert) {
              targetMoveDistance = Math.abs(targetBeforeFirstSwap - getRect(target)[side1]);
            }
            changed();
            return completed(true);
          }
        }
        if (el.contains(dragEl)) {
          return completed(false);
        }
      }
      return false;
    },
    _ignoreWhileAnimating: null,
    _offMoveEvents: function _offMoveEvents() {
      off(document, "mousemove", this._onTouchMove);
      off(document, "touchmove", this._onTouchMove);
      off(document, "pointermove", this._onTouchMove);
      off(document, "dragover", nearestEmptyInsertDetectEvent);
      off(document, "mousemove", nearestEmptyInsertDetectEvent);
      off(document, "touchmove", nearestEmptyInsertDetectEvent);
    },
    _offUpEvents: function _offUpEvents() {
      var ownerDocument = this.el.ownerDocument;
      off(ownerDocument, "mouseup", this._onDrop);
      off(ownerDocument, "touchend", this._onDrop);
      off(ownerDocument, "pointerup", this._onDrop);
      off(ownerDocument, "touchcancel", this._onDrop);
      off(document, "selectstart", this);
    },
    _onDrop: function _onDrop(evt) {
      var el = this.el, options = this.options;
      newIndex = index(dragEl);
      newDraggableIndex = index(dragEl, options.draggable);
      pluginEvent("drop", this, {
        evt
      });
      parentEl = dragEl && dragEl.parentNode;
      newIndex = index(dragEl);
      newDraggableIndex = index(dragEl, options.draggable);
      if (Sortable.eventCanceled) {
        this._nulling();
        return;
      }
      awaitingDragStarted = false;
      isCircumstantialInvert = false;
      pastFirstInvertThresh = false;
      clearInterval(this._loopId);
      clearTimeout(this._dragStartTimer);
      _cancelNextTick(this.cloneId);
      _cancelNextTick(this._dragStartId);
      if (this.nativeDraggable) {
        off(document, "drop", this);
        off(el, "dragstart", this._onDragStart);
      }
      this._offMoveEvents();
      this._offUpEvents();
      if (Safari) {
        css(document.body, "user-select", "");
      }
      css(dragEl, "transform", "");
      if (evt) {
        if (moved) {
          evt.cancelable && evt.preventDefault();
          !options.dropBubble && evt.stopPropagation();
        }
        ghostEl && ghostEl.parentNode && ghostEl.parentNode.removeChild(ghostEl);
        if (rootEl === parentEl || putSortable && putSortable.lastPutMode !== "clone") {
          cloneEl && cloneEl.parentNode && cloneEl.parentNode.removeChild(cloneEl);
        }
        if (dragEl) {
          if (this.nativeDraggable) {
            off(dragEl, "dragend", this);
          }
          _disableDraggable(dragEl);
          dragEl.style["will-change"] = "";
          if (moved && !awaitingDragStarted) {
            toggleClass(dragEl, putSortable ? putSortable.options.ghostClass : this.options.ghostClass, false);
          }
          toggleClass(dragEl, this.options.chosenClass, false);
          _dispatchEvent({
            sortable: this,
            name: "unchoose",
            toEl: parentEl,
            newIndex: null,
            newDraggableIndex: null,
            originalEvent: evt
          });
          if (rootEl !== parentEl) {
            if (newIndex >= 0) {
              _dispatchEvent({
                rootEl: parentEl,
                name: "add",
                toEl: parentEl,
                fromEl: rootEl,
                originalEvent: evt
              });
              _dispatchEvent({
                sortable: this,
                name: "remove",
                toEl: parentEl,
                originalEvent: evt
              });
              _dispatchEvent({
                rootEl: parentEl,
                name: "sort",
                toEl: parentEl,
                fromEl: rootEl,
                originalEvent: evt
              });
              _dispatchEvent({
                sortable: this,
                name: "sort",
                toEl: parentEl,
                originalEvent: evt
              });
            }
            putSortable && putSortable.save();
          } else {
            if (newIndex !== oldIndex) {
              if (newIndex >= 0) {
                _dispatchEvent({
                  sortable: this,
                  name: "update",
                  toEl: parentEl,
                  originalEvent: evt
                });
                _dispatchEvent({
                  sortable: this,
                  name: "sort",
                  toEl: parentEl,
                  originalEvent: evt
                });
              }
            }
          }
          if (Sortable.active) {
            if (newIndex == null || newIndex === -1) {
              newIndex = oldIndex;
              newDraggableIndex = oldDraggableIndex;
            }
            _dispatchEvent({
              sortable: this,
              name: "end",
              toEl: parentEl,
              originalEvent: evt
            });
            this.save();
          }
        }
      }
      this._nulling();
    },
    _nulling: function _nulling() {
      pluginEvent("nulling", this);
      rootEl = dragEl = parentEl = ghostEl = nextEl = cloneEl = lastDownEl = cloneHidden = tapEvt = touchEvt = moved = newIndex = newDraggableIndex = oldIndex = oldDraggableIndex = lastTarget = lastDirection = putSortable = activeGroup = Sortable.dragged = Sortable.ghost = Sortable.clone = Sortable.active = null;
      savedInputChecked.forEach(function(el) {
        el.checked = true;
      });
      savedInputChecked.length = lastDx = lastDy = 0;
    },
    handleEvent: function handleEvent(evt) {
      switch (evt.type) {
        case "drop":
        case "dragend":
          this._onDrop(evt);
          break;
        case "dragenter":
        case "dragover":
          if (dragEl) {
            this._onDragOver(evt);
            _globalDragOver(evt);
          }
          break;
        case "selectstart":
          evt.preventDefault();
          break;
      }
    },
    toArray: function toArray() {
      var order = [], el, children = this.el.children, i = 0, n = children.length, options = this.options;
      for (; i < n; i++) {
        el = children[i];
        if (closest(el, options.draggable, this.el, false)) {
          order.push(el.getAttribute(options.dataIdAttr) || _generateId(el));
        }
      }
      return order;
    },
    sort: function sort(order, useAnimation) {
      var items = {}, rootEl2 = this.el;
      this.toArray().forEach(function(id, i) {
        var el = rootEl2.children[i];
        if (closest(el, this.options.draggable, rootEl2, false)) {
          items[id] = el;
        }
      }, this);
      useAnimation && this.captureAnimationState();
      order.forEach(function(id) {
        if (items[id]) {
          rootEl2.removeChild(items[id]);
          rootEl2.appendChild(items[id]);
        }
      });
      useAnimation && this.animateAll();
    },
    save: function save() {
      var store = this.options.store;
      store && store.set && store.set(this);
    },
    closest: function closest$1(el, selector) {
      return closest(el, selector || this.options.draggable, this.el, false);
    },
    option: function option(name, value) {
      var options = this.options;
      if (value === void 0) {
        return options[name];
      } else {
        var modifiedValue = PluginManager.modifyOption(this, name, value);
        if (typeof modifiedValue !== "undefined") {
          options[name] = modifiedValue;
        } else {
          options[name] = value;
        }
        if (name === "group") {
          _prepareGroup(options);
        }
      }
    },
    destroy: function destroy() {
      pluginEvent("destroy", this);
      var el = this.el;
      el[expando] = null;
      off(el, "mousedown", this._onTapStart);
      off(el, "touchstart", this._onTapStart);
      off(el, "pointerdown", this._onTapStart);
      if (this.nativeDraggable) {
        off(el, "dragover", this);
        off(el, "dragenter", this);
      }
      Array.prototype.forEach.call(el.querySelectorAll("[draggable]"), function(el2) {
        el2.removeAttribute("draggable");
      });
      this._onDrop();
      this._disableDelayedDragEvents();
      sortables.splice(sortables.indexOf(this.el), 1);
      this.el = el = null;
    },
    _hideClone: function _hideClone() {
      if (!cloneHidden) {
        pluginEvent("hideClone", this);
        if (Sortable.eventCanceled)
          return;
        css(cloneEl, "display", "none");
        if (this.options.removeCloneOnHide && cloneEl.parentNode) {
          cloneEl.parentNode.removeChild(cloneEl);
        }
        cloneHidden = true;
      }
    },
    _showClone: function _showClone(putSortable2) {
      if (putSortable2.lastPutMode !== "clone") {
        this._hideClone();
        return;
      }
      if (cloneHidden) {
        pluginEvent("showClone", this);
        if (Sortable.eventCanceled)
          return;
        if (dragEl.parentNode == rootEl && !this.options.group.revertClone) {
          rootEl.insertBefore(cloneEl, dragEl);
        } else if (nextEl) {
          rootEl.insertBefore(cloneEl, nextEl);
        } else {
          rootEl.appendChild(cloneEl);
        }
        if (this.options.group.revertClone) {
          this.animate(dragEl, cloneEl);
        }
        css(cloneEl, "display", "");
        cloneHidden = false;
      }
    }
  };
  function _globalDragOver(evt) {
    if (evt.dataTransfer) {
      evt.dataTransfer.dropEffect = "move";
    }
    evt.cancelable && evt.preventDefault();
  }
  function _onMove(fromEl, toEl, dragEl2, dragRect, targetEl, targetRect, originalEvent, willInsertAfter) {
    var evt, sortable = fromEl[expando], onMoveFn = sortable.options.onMove, retVal;
    if (window.CustomEvent && !IE11OrLess && !Edge) {
      evt = new CustomEvent("move", {
        bubbles: true,
        cancelable: true
      });
    } else {
      evt = document.createEvent("Event");
      evt.initEvent("move", true, true);
    }
    evt.to = toEl;
    evt.from = fromEl;
    evt.dragged = dragEl2;
    evt.draggedRect = dragRect;
    evt.related = targetEl || toEl;
    evt.relatedRect = targetRect || getRect(toEl);
    evt.willInsertAfter = willInsertAfter;
    evt.originalEvent = originalEvent;
    fromEl.dispatchEvent(evt);
    if (onMoveFn) {
      retVal = onMoveFn.call(sortable, evt, originalEvent);
    }
    return retVal;
  }
  function _disableDraggable(el) {
    el.draggable = false;
  }
  function _unsilent() {
    _silent = false;
  }
  function _ghostIsFirst(evt, vertical, sortable) {
    var rect = getRect(getChild(sortable.el, 0, sortable.options, true));
    var spacer = 10;
    return vertical ? evt.clientX < rect.left - spacer || evt.clientY < rect.top && evt.clientX < rect.right : evt.clientY < rect.top - spacer || evt.clientY < rect.bottom && evt.clientX < rect.left;
  }
  function _ghostIsLast(evt, vertical, sortable) {
    var rect = getRect(lastChild(sortable.el, sortable.options.draggable));
    var spacer = 10;
    return vertical ? evt.clientX > rect.right + spacer || evt.clientX <= rect.right && evt.clientY > rect.bottom && evt.clientX >= rect.left : evt.clientX > rect.right && evt.clientY > rect.top || evt.clientX <= rect.right && evt.clientY > rect.bottom + spacer;
  }
  function _getSwapDirection(evt, target, targetRect, vertical, swapThreshold, invertedSwapThreshold, invertSwap, isLastTarget) {
    var mouseOnAxis = vertical ? evt.clientY : evt.clientX, targetLength = vertical ? targetRect.height : targetRect.width, targetS1 = vertical ? targetRect.top : targetRect.left, targetS2 = vertical ? targetRect.bottom : targetRect.right, invert = false;
    if (!invertSwap) {
      if (isLastTarget && targetMoveDistance < targetLength * swapThreshold) {
        if (!pastFirstInvertThresh && (lastDirection === 1 ? mouseOnAxis > targetS1 + targetLength * invertedSwapThreshold / 2 : mouseOnAxis < targetS2 - targetLength * invertedSwapThreshold / 2)) {
          pastFirstInvertThresh = true;
        }
        if (!pastFirstInvertThresh) {
          if (lastDirection === 1 ? mouseOnAxis < targetS1 + targetMoveDistance : mouseOnAxis > targetS2 - targetMoveDistance) {
            return -lastDirection;
          }
        } else {
          invert = true;
        }
      } else {
        if (mouseOnAxis > targetS1 + targetLength * (1 - swapThreshold) / 2 && mouseOnAxis < targetS2 - targetLength * (1 - swapThreshold) / 2) {
          return _getInsertDirection(target);
        }
      }
    }
    invert = invert || invertSwap;
    if (invert) {
      if (mouseOnAxis < targetS1 + targetLength * invertedSwapThreshold / 2 || mouseOnAxis > targetS2 - targetLength * invertedSwapThreshold / 2) {
        return mouseOnAxis > targetS1 + targetLength / 2 ? 1 : -1;
      }
    }
    return 0;
  }
  function _getInsertDirection(target) {
    if (index(dragEl) < index(target)) {
      return 1;
    } else {
      return -1;
    }
  }
  function _generateId(el) {
    var str = el.tagName + el.className + el.src + el.href + el.textContent, i = str.length, sum = 0;
    while (i--) {
      sum += str.charCodeAt(i);
    }
    return sum.toString(36);
  }
  function _saveInputCheckedState(root) {
    savedInputChecked.length = 0;
    var inputs = root.getElementsByTagName("input");
    var idx = inputs.length;
    while (idx--) {
      var el = inputs[idx];
      el.checked && savedInputChecked.push(el);
    }
  }
  function _nextTick(fn) {
    return setTimeout(fn, 0);
  }
  function _cancelNextTick(id) {
    return clearTimeout(id);
  }
  if (documentExists) {
    on(document, "touchmove", function(evt) {
      if ((Sortable.active || awaitingDragStarted) && evt.cancelable) {
        evt.preventDefault();
      }
    });
  }
  Sortable.utils = {
    on,
    off,
    css,
    find,
    is: function is(el, selector) {
      return !!closest(el, selector, el, false);
    },
    extend: extend$1,
    throttle,
    closest,
    toggleClass,
    clone,
    index,
    nextTick: _nextTick,
    cancelNextTick: _cancelNextTick,
    detectDirection: _detectDirection,
    getChild
  };
  Sortable.get = function(element) {
    return element[expando];
  };
  Sortable.mount = function() {
    for (var _len = arguments.length, plugins2 = new Array(_len), _key = 0; _key < _len; _key++) {
      plugins2[_key] = arguments[_key];
    }
    if (plugins2[0].constructor === Array)
      plugins2 = plugins2[0];
    plugins2.forEach(function(plugin) {
      if (!plugin.prototype || !plugin.prototype.constructor) {
        throw "Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(plugin));
      }
      if (plugin.utils)
        Sortable.utils = _objectSpread2(_objectSpread2({}, Sortable.utils), plugin.utils);
      PluginManager.mount(plugin);
    });
  };
  Sortable.create = function(el, options) {
    return new Sortable(el, options);
  };
  Sortable.version = version;
  var autoScrolls = [], scrollEl, scrollRootEl, scrolling = false, lastAutoScrollX, lastAutoScrollY, touchEvt$1, pointerElemChangedInterval;
  function AutoScrollPlugin() {
    function AutoScroll() {
      this.defaults = {
        scroll: true,
        forceAutoScrollFallback: false,
        scrollSensitivity: 30,
        scrollSpeed: 10,
        bubbleScroll: true
      };
      for (var fn in this) {
        if (fn.charAt(0) === "_" && typeof this[fn] === "function") {
          this[fn] = this[fn].bind(this);
        }
      }
    }
    AutoScroll.prototype = {
      dragStarted: function dragStarted(_ref2) {
        var originalEvent = _ref2.originalEvent;
        if (this.sortable.nativeDraggable) {
          on(document, "dragover", this._handleAutoScroll);
        } else {
          if (this.options.supportPointer) {
            on(document, "pointermove", this._handleFallbackAutoScroll);
          } else if (originalEvent.touches) {
            on(document, "touchmove", this._handleFallbackAutoScroll);
          } else {
            on(document, "mousemove", this._handleFallbackAutoScroll);
          }
        }
      },
      dragOverCompleted: function dragOverCompleted(_ref2) {
        var originalEvent = _ref2.originalEvent;
        if (!this.options.dragOverBubble && !originalEvent.rootEl) {
          this._handleAutoScroll(originalEvent);
        }
      },
      drop: function drop2() {
        if (this.sortable.nativeDraggable) {
          off(document, "dragover", this._handleAutoScroll);
        } else {
          off(document, "pointermove", this._handleFallbackAutoScroll);
          off(document, "touchmove", this._handleFallbackAutoScroll);
          off(document, "mousemove", this._handleFallbackAutoScroll);
        }
        clearPointerElemChangedInterval();
        clearAutoScrolls();
        cancelThrottle();
      },
      nulling: function nulling() {
        touchEvt$1 = scrollRootEl = scrollEl = scrolling = pointerElemChangedInterval = lastAutoScrollX = lastAutoScrollY = null;
        autoScrolls.length = 0;
      },
      _handleFallbackAutoScroll: function _handleFallbackAutoScroll(evt) {
        this._handleAutoScroll(evt, true);
      },
      _handleAutoScroll: function _handleAutoScroll(evt, fallback) {
        var _this = this;
        var x = (evt.touches ? evt.touches[0] : evt).clientX, y2 = (evt.touches ? evt.touches[0] : evt).clientY, elem = document.elementFromPoint(x, y2);
        touchEvt$1 = evt;
        if (fallback || this.options.forceAutoScrollFallback || Edge || IE11OrLess || Safari) {
          autoScroll(evt, this.options, elem, fallback);
          var ogElemScroller = getParentAutoScrollElement(elem, true);
          if (scrolling && (!pointerElemChangedInterval || x !== lastAutoScrollX || y2 !== lastAutoScrollY)) {
            pointerElemChangedInterval && clearPointerElemChangedInterval();
            pointerElemChangedInterval = setInterval(function() {
              var newElem = getParentAutoScrollElement(document.elementFromPoint(x, y2), true);
              if (newElem !== ogElemScroller) {
                ogElemScroller = newElem;
                clearAutoScrolls();
              }
              autoScroll(evt, _this.options, newElem, fallback);
            }, 10);
            lastAutoScrollX = x;
            lastAutoScrollY = y2;
          }
        } else {
          if (!this.options.bubbleScroll || getParentAutoScrollElement(elem, true) === getWindowScrollingElement()) {
            clearAutoScrolls();
            return;
          }
          autoScroll(evt, this.options, getParentAutoScrollElement(elem, false), false);
        }
      }
    };
    return _extends(AutoScroll, {
      pluginName: "scroll",
      initializeByDefault: true
    });
  }
  function clearAutoScrolls() {
    autoScrolls.forEach(function(autoScroll2) {
      clearInterval(autoScroll2.pid);
    });
    autoScrolls = [];
  }
  function clearPointerElemChangedInterval() {
    clearInterval(pointerElemChangedInterval);
  }
  var autoScroll = throttle(function(evt, options, rootEl2, isFallback) {
    if (!options.scroll)
      return;
    var x = (evt.touches ? evt.touches[0] : evt).clientX, y2 = (evt.touches ? evt.touches[0] : evt).clientY, sens = options.scrollSensitivity, speed = options.scrollSpeed, winScroller = getWindowScrollingElement();
    var scrollThisInstance = false, scrollCustomFn;
    if (scrollRootEl !== rootEl2) {
      scrollRootEl = rootEl2;
      clearAutoScrolls();
      scrollEl = options.scroll;
      scrollCustomFn = options.scrollFn;
      if (scrollEl === true) {
        scrollEl = getParentAutoScrollElement(rootEl2, true);
      }
    }
    var layersOut = 0;
    var currentParent = scrollEl;
    do {
      var el = currentParent, rect = getRect(el), top = rect.top, bottom = rect.bottom, left = rect.left, right = rect.right, width = rect.width, height = rect.height, canScrollX = void 0, canScrollY = void 0, scrollWidth = el.scrollWidth, scrollHeight = el.scrollHeight, elCSS = css(el), scrollPosX = el.scrollLeft, scrollPosY = el.scrollTop;
      if (el === winScroller) {
        canScrollX = width < scrollWidth && (elCSS.overflowX === "auto" || elCSS.overflowX === "scroll" || elCSS.overflowX === "visible");
        canScrollY = height < scrollHeight && (elCSS.overflowY === "auto" || elCSS.overflowY === "scroll" || elCSS.overflowY === "visible");
      } else {
        canScrollX = width < scrollWidth && (elCSS.overflowX === "auto" || elCSS.overflowX === "scroll");
        canScrollY = height < scrollHeight && (elCSS.overflowY === "auto" || elCSS.overflowY === "scroll");
      }
      var vx = canScrollX && (Math.abs(right - x) <= sens && scrollPosX + width < scrollWidth) - (Math.abs(left - x) <= sens && !!scrollPosX);
      var vy = canScrollY && (Math.abs(bottom - y2) <= sens && scrollPosY + height < scrollHeight) - (Math.abs(top - y2) <= sens && !!scrollPosY);
      if (!autoScrolls[layersOut]) {
        for (var i = 0; i <= layersOut; i++) {
          if (!autoScrolls[i]) {
            autoScrolls[i] = {};
          }
        }
      }
      if (autoScrolls[layersOut].vx != vx || autoScrolls[layersOut].vy != vy || autoScrolls[layersOut].el !== el) {
        autoScrolls[layersOut].el = el;
        autoScrolls[layersOut].vx = vx;
        autoScrolls[layersOut].vy = vy;
        clearInterval(autoScrolls[layersOut].pid);
        if (vx != 0 || vy != 0) {
          scrollThisInstance = true;
          autoScrolls[layersOut].pid = setInterval(function() {
            if (isFallback && this.layer === 0) {
              Sortable.active._onTouchMove(touchEvt$1);
            }
            var scrollOffsetY = autoScrolls[this.layer].vy ? autoScrolls[this.layer].vy * speed : 0;
            var scrollOffsetX = autoScrolls[this.layer].vx ? autoScrolls[this.layer].vx * speed : 0;
            if (typeof scrollCustomFn === "function") {
              if (scrollCustomFn.call(Sortable.dragged.parentNode[expando], scrollOffsetX, scrollOffsetY, evt, touchEvt$1, autoScrolls[this.layer].el) !== "continue") {
                return;
              }
            }
            scrollBy(autoScrolls[this.layer].el, scrollOffsetX, scrollOffsetY);
          }.bind({
            layer: layersOut
          }), 24);
        }
      }
      layersOut++;
    } while (options.bubbleScroll && currentParent !== winScroller && (currentParent = getParentAutoScrollElement(currentParent, false)));
    scrolling = scrollThisInstance;
  }, 30);
  var drop = function drop2(_ref2) {
    var originalEvent = _ref2.originalEvent, putSortable2 = _ref2.putSortable, dragEl2 = _ref2.dragEl, activeSortable = _ref2.activeSortable, dispatchSortableEvent = _ref2.dispatchSortableEvent, hideGhostForTarget = _ref2.hideGhostForTarget, unhideGhostForTarget = _ref2.unhideGhostForTarget;
    if (!originalEvent)
      return;
    var toSortable = putSortable2 || activeSortable;
    hideGhostForTarget();
    var touch = originalEvent.changedTouches && originalEvent.changedTouches.length ? originalEvent.changedTouches[0] : originalEvent;
    var target = document.elementFromPoint(touch.clientX, touch.clientY);
    unhideGhostForTarget();
    if (toSortable && !toSortable.el.contains(target)) {
      dispatchSortableEvent("spill");
      this.onSpill({
        dragEl: dragEl2,
        putSortable: putSortable2
      });
    }
  };
  function Revert() {
  }
  Revert.prototype = {
    startIndex: null,
    dragStart: function dragStart(_ref2) {
      var oldDraggableIndex2 = _ref2.oldDraggableIndex;
      this.startIndex = oldDraggableIndex2;
    },
    onSpill: function onSpill(_ref3) {
      var dragEl2 = _ref3.dragEl, putSortable2 = _ref3.putSortable;
      this.sortable.captureAnimationState();
      if (putSortable2) {
        putSortable2.captureAnimationState();
      }
      var nextSibling = getChild(this.sortable.el, this.startIndex, this.options);
      if (nextSibling) {
        this.sortable.el.insertBefore(dragEl2, nextSibling);
      } else {
        this.sortable.el.appendChild(dragEl2);
      }
      this.sortable.animateAll();
      if (putSortable2) {
        putSortable2.animateAll();
      }
    },
    drop
  };
  _extends(Revert, {
    pluginName: "revertOnSpill"
  });
  function Remove() {
  }
  Remove.prototype = {
    onSpill: function onSpill(_ref4) {
      var dragEl2 = _ref4.dragEl, putSortable2 = _ref4.putSortable;
      var parentSortable = putSortable2 || this.sortable;
      parentSortable.captureAnimationState();
      dragEl2.parentNode && dragEl2.parentNode.removeChild(dragEl2);
      parentSortable.animateAll();
    },
    drop
  };
  _extends(Remove, {
    pluginName: "removeOnSpill"
  });
  Sortable.mount(new AutoScrollPlugin());
  Sortable.mount(Remove, Revert);
  const useMapStore = defineStore("map", () => {
    const map2 = vue.ref({});
    const layers = vue.shallowRef([]);
    const bgLayer = vue.ref(void 0);
    function setBgLayer(layer) {
      bgLayer.value = layer;
    }
    function addLayers(...newLayers) {
      layers.value = [.../* @__PURE__ */ new Set([...layers.value, ...newLayers])];
    }
    function removeLayers(...layerIds) {
      layers.value = layers.value.filter(
        (layer) => layerIds.indexOf(layer.id) === -1
      );
    }
    function hasLayer(layerId) {
      var _a;
      return !!((_a = layers.value) == null ? void 0 : _a.find((layer) => layer.id === layerId));
    }
    function reorderLayers(layersId) {
      var _a;
      layers.value = [
        ...((_a = layers.value) == null ? void 0 : _a.sort(
          (a, b) => layersId.indexOf(a.id) - layersId.indexOf(b.id)
        )) || []
      ];
    }
    function setLayerOpacity(layerId, opacity) {
      layers.value = layers.value.map((elt) => {
        if (elt.id === layerId) {
          return { ...elt, opacity, previousOpacity: elt.opacity };
        }
        return elt;
      });
    }
    return {
      map: map2,
      layers,
      bgLayer,
      addLayers,
      removeLayers,
      reorderLayers,
      setLayerOpacity,
      setBgLayer,
      hasLayer
    };
  });
  const BLANK_BACKGROUNDLAYER = {
    name: "blank",
    id: 0
  };
  function install(app2, {
    i18next,
    rerenderOn = ["languageChanged", "loaded", "added", "removed"]
  }) {
    const genericT = i18next.t.bind(i18next);
    const lastI18nChange = vue.ref(new Date());
    const invalidate = () => lastI18nChange.value = new Date();
    const usingI18n = () => lastI18nChange.value;
    rerenderOn.forEach((event) => {
      var _a;
      switch (event) {
        case "added":
        case "removed":
          (_a = i18next.store) == null ? void 0 : _a.on(event, invalidate);
          break;
        default:
          i18next.on(event, invalidate);
          break;
      }
    });
    app2.component("i18next", TranslationComponent);
    app2.mixin({
      beforeCreate() {
        var _a, _b;
        const options = this.$options;
        if (!options.__i18n && !options.i18nOptions) {
          this.__translate = void 0;
          return;
        }
        const name = this.$options.name;
        const rand = (Math.random() * 10 ** 8 | 0).toString();
        const localNs = [name, rand].filter((x) => !!x).join("-");
        this.__bundles = [];
        const loadBundle = (bundle) => {
          Object.entries(bundle).forEach(([lng2, resources]) => {
            i18next.addResourceBundle(lng2, localNs, resources, true, false);
            this.__bundles.push([lng2, localNs]);
          });
        };
        (_a = options.__i18n) == null ? void 0 : _a.forEach((bundle) => {
          loadBundle(JSON.parse(bundle));
        });
        let { lng, ns, keyPrefix } = handleI18nOptions(options, loadBundle);
        if ((_b = this.__bundles) == null ? void 0 : _b.length) {
          ns = [localNs].concat(ns != null ? ns : []);
        }
        const t = getTranslationFunction(lng, ns);
        this.__translate = (key, options2) => {
          if (!keyPrefix || includesNs(key)) {
            return t(key, options2);
          } else {
            return t(keyPrefix + "." + key, options2);
          }
        };
      },
      unmounted() {
        var _a;
        (_a = this.__bundles) == null ? void 0 : _a.forEach(([lng, ns]) => i18next.removeResourceBundle(lng, ns));
      }
    });
    app2.config.globalProperties.$t = function(key, options) {
      var _a;
      usingI18n();
      if (i18next.isInitialized) {
        return ((_a = this == null ? void 0 : this.__translate) != null ? _a : genericT)(key, options);
      } else {
        return key;
      }
    };
    app2.config.globalProperties.$i18next = new Proxy(i18next, {
      get(target, prop) {
        usingI18n();
        return Reflect.get(target, prop);
      }
    });
    function getTranslationFunction(lng, ns) {
      if (lng) {
        return i18next.getFixedT(lng, ns);
      } else if (ns) {
        return i18next.getFixedT(null, ns);
      } else {
        return genericT;
      }
    }
    function includesNs(key) {
      const nsSeparator = i18next.options.nsSeparator;
      return typeof nsSeparator === "string" && key.includes(nsSeparator);
    }
    function handleI18nOptions(options, loadBundle) {
      let lng;
      let ns;
      let keyPrefix;
      if (options.i18nOptions) {
        let messages2;
        let namespaces;
        ({
          lng,
          namespaces = i18next.options.defaultNS,
          keyPrefix,
          messages: messages2
        } = options.i18nOptions);
        if (messages2) {
          loadBundle(messages2);
        }
        ns = typeof namespaces === "string" ? [namespaces] : namespaces;
        if (ns) {
          i18next.loadNamespaces(ns);
        }
      }
      return { lng, ns, keyPrefix };
    }
  }
  function useTranslation() {
    const instance2 = vue.getCurrentInstance();
    if (!instance2) {
      throw new Error("i18next-vue: No Vue instance in context. Make sure to register the i18next-vue plugin using app.use(...).");
    }
    const globalProps = instance2.appContext.config.globalProperties;
    return {
      i18next: globalProps.$i18next,
      t: globalProps.$t.bind(instance2.proxy)
    };
  }
  var slotNamePattern = new RegExp("{\\s*([a-z0-9\\-]+)\\s*}", "gi");
  var TranslationComponent = vue.defineComponent({
    props: {
      "translation": {
        type: String,
        required: true
      }
    },
    setup(props, { slots }) {
      return () => {
        const translation = props.translation;
        const result = [];
        let match2;
        let lastIndex = 0;
        while ((match2 = slotNamePattern.exec(translation)) !== null) {
          result.push(translation.substring(lastIndex, match2.index));
          const slot = slots[match2[1]];
          if (slot) {
            result.push(...slot());
          } else {
            result.push(match2[0]);
          }
          lastIndex = slotNamePattern.lastIndex;
        }
        result.push(translation.substring(lastIndex));
        return result;
      };
    }
  });
  function useLayer(layer, context) {
    const { t } = useTranslation();
    function getLabel() {
      return t(layer.name, { ns: "client" });
    }
    function onClickInfo() {
      context == null ? void 0 : context.emit("clickInfo", layer);
    }
    return {
      t,
      getLabel,
      onClickInfo
    };
  }
  const _hoisted_1$j = { class: "lux-layer-manager-item mt-2.5" };
  const _hoisted_2$e = ["title"];
  const _hoisted_3$b = { class: "flex-1 text-left cursor-default" };
  const _hoisted_4$a = ["title"];
  const _sfc_main$n = /* @__PURE__ */ vue.defineComponent({
    __name: "layer-item-background",
    props: {
      showEditButton: { type: Boolean },
      layer: null
    },
    emits: ["clickEdit", "clickInfo"],
    setup(__props, { emit }) {
      const props = __props;
      const { t, onClickInfo } = useLayer(props.layer, { emit });
      const txtTitleLabel = vue.computed(
        () => t('Display informations for "{{layerName}}"', {
          ns: "client",
          layerName: getLabel()
        })
      );
      function getLabel() {
        return t(props.layer.name, { ns: "client" });
      }
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock("div", _hoisted_1$j, [
          vue.createElementVNode("button", {
            class: "fa fa-info w-3",
            title: vue.unref(txtTitleLabel),
            onClick: _cache[0] || (_cache[0] = (...args) => vue.unref(onClickInfo) && vue.unref(onClickInfo)(...args))
          }, null, 8, _hoisted_2$e),
          vue.createElementVNode("span", _hoisted_3$b, vue.toDisplayString(getLabel()), 1),
          __props.showEditButton ? (vue.openBlock(), vue.createElementBlock("button", {
            key: 0,
            class: "fa fa-pencil",
            title: vue.unref(t)("Open editor panel", { ns: "client" }),
            onClick: _cache[1] || (_cache[1] = ($event) => _ctx.$emit("clickEdit"))
          }, null, 8, _hoisted_4$a)) : vue.createCommentVNode("", true)
        ]);
      };
    }
  });
  const _hoisted_1$i = { class: "lux-layer-manager-item relative" };
  const _hoisted_2$d = { class: "w-full flex flex-nowrap items-start gap-x-2" };
  const _hoisted_3$a = ["title"];
  const _hoisted_4$9 = ["title"];
  const _hoisted_5$8 = ["aria-expanded", "aria-controls"];
  const _hoisted_6$5 = ["aria-expanded", "aria-controls"];
  const _hoisted_7$3 = ["title"];
  const _hoisted_8$3 = ["id"];
  const _hoisted_9$3 = ["title"];
  const _hoisted_10$3 = ["id", "value", "aria-label"];
  const _sfc_main$m = /* @__PURE__ */ vue.defineComponent({
    __name: "layer-item",
    props: {
      layer: null,
      draggableClassName: null,
      isOpen: { type: Boolean }
    },
    emits: [
      "clickInfo",
      "clickEdit",
      "changeOpacity",
      "clickToggle",
      "clickRemove"
    ],
    setup(__props, { emit }) {
      var _a, _b, _c, _d;
      const props = __props;
      const { t, getLabel, onClickInfo } = useLayer(props.layer, { emit });
      const opacity = vue.shallowRef(
        ((_b = (_a = props.layer) == null ? void 0 : _a.opacity) != null ? _b : 1) * 100
      );
      const prevOpacity = vue.shallowRef(
        ((_d = (_c = props.layer) == null ? void 0 : _c.previousOpacity) != null ? _d : opacity.value) * 100
      );
      const txtDraggableLabel = vue.computed(
        () => t('Sort "{{layerName}}" in the list', {
          ns: "client",
          layerName: getLabel()
        })
      );
      const txtTitleLabel = vue.computed(
        () => t('Display informations for "{{layerName}}"', {
          ns: "client",
          layerName: getLabel()
        })
      );
      const txtRemoveLayer = vue.computed(
        () => t('Remove layer "{{layerName}}"', {
          ns: "client",
          layerName: getLabel()
        })
      );
      function onClickToggle() {
        emit("clickToggle", props.layer);
      }
      function onToggleVisibility() {
        if (opacity.value === 0) {
          opacity.value = prevOpacity.value;
        } else {
          prevOpacity.value = opacity.value;
          opacity.value = 0;
        }
        dispatchChangeOpacity();
      }
      function onClickRemove() {
        emit("clickRemove", props.layer);
      }
      function onChangeOpacity(event) {
        if (event.target) {
          opacity.value = parseInt(event.target.value);
          dispatchChangeOpacity();
        }
      }
      function dispatchChangeOpacity() {
        emit("changeOpacity", props.layer, opacity.value);
      }
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock("div", _hoisted_1$i, [
          vue.createElementVNode("div", _hoisted_2$d, [
            vue.createElementVNode("button", {
              class: vue.normalizeClass(["fa-solid fa-bars cursor-move mt-1", __props.draggableClassName]),
              title: vue.unref(txtDraggableLabel)
            }, null, 10, _hoisted_3$a),
            vue.createElementVNode("button", {
              class: "fa-solid fa-info mt-1",
              title: vue.unref(txtTitleLabel),
              onClick: _cache[0] || (_cache[0] = (...args) => vue.unref(onClickInfo) && vue.unref(onClickInfo)(...args))
            }, null, 8, _hoisted_4$9),
            vue.createElementVNode("button", {
              "aria-expanded": props.isOpen,
              "aria-controls": `layer-manager-item-content-${props.layer.id}`,
              class: "cursor-pointer grow text-left break-words w-[70%]",
              onClick: onClickToggle
            }, vue.toDisplayString(vue.unref(getLabel)()), 9, _hoisted_5$8),
            vue.createElementVNode("button", {
              class: vue.normalizeClass(["mt-1 w-3.5 fa-solid", props.isOpen ? "fa-xmark" : "fa-ellipsis"]),
              onClick: onClickToggle,
              "aria-expanded": props.isOpen,
              "aria-controls": `layer-manager-item-content-${props.layer.id}`
            }, null, 10, _hoisted_6$5),
            vue.createElementVNode("button", {
              class: "mt-1 fa-solid fa-trash",
              title: vue.unref(txtRemoveLayer),
              onClick: onClickRemove
            }, null, 8, _hoisted_7$3)
          ]),
          vue.createElementVNode("div", {
            class: vue.normalizeClass(["lux-layer-manager-item-content", props.isOpen ? "h-6" : "h-0"]),
            id: `layer-manager-item-content-${props.layer.id}`
          }, [
            vue.createElementVNode("button", {
              title: vue.unref(t)("Toggle layer opacity for {{layerName}}", {
                layerName: vue.unref(t)(props.layer.name)
              }),
              class: vue.normalizeClass(["w-5 fa-solid", vue.unref(opacity) === 0 ? "fa-eye-slash" : "fa-eye"]),
              onClick: onToggleVisibility
            }, null, 10, _hoisted_9$3),
            vue.createElementVNode("input", {
              id: `${props.layer.id}-steps-range`,
              type: "range",
              min: "0",
              max: "100",
              value: vue.unref(opacity),
              step: "25",
              onChange: onChangeOpacity,
              class: "m-2.5 w-16 h-[5px] rounded-lg appearance-none cursor-pointer",
              "aria-label": vue.unref(t)("Change opacity for {{ layerName }}", { layerName: vue.unref(getLabel)() })
            }, null, 40, _hoisted_10$3)
          ], 10, _hoisted_8$3)
        ]);
      };
    }
  });
  const stylePropertyTypeList = [
    "line",
    "fill",
    "symbol",
    "fill-extrusion",
    "background",
    "hillshade"
  ];
  const bgConfigFixture = () => ({
    bg_layers: [
      {
        icon_id: "route",
        vector_id: "roadmap",
        medium_style_class: "road",
        id: 556,
        is_default: true
      },
      {
        icon_id: "topo",
        vector_id: "topomap",
        medium_style_class: "topo",
        id: 529
      },
      {
        icon_id: "topo_bw",
        vector_id: "topomap_gray",
        medium_style_class: "topo",
        id: 502
      },
      {
        icon_id: "ortho",
        id: 530
      },
      {
        icon_id: "hybrid",
        id: 501
      },
      {
        icon_id: "blank",
        id: 0
      }
    ],
    bg_layer_theme_defaults: {
      tourisme: 502
    },
    simple_styles: [
      {
        unlocalized_label: "Light grey",
        hillshade: false,
        colors: [
          "#ffffff",
          "#ffffff",
          "#d6e0d7",
          "#e1e1e1",
          "#cccccc",
          "#f2f2f2"
        ],
        selected: false
      },
      {
        unlocalized_label: "Dark grey",
        hillshade: false,
        colors: [
          "#808080",
          "#808080",
          "#494b4a",
          "#505052",
          "#232426",
          "#454545"
        ],
        selected: false
      },
      {
        unlocalized_label: "Dark sand",
        hillshade: false,
        colors: [
          "#9e9375",
          "#9e9375",
          "#6b6249",
          "#403928",
          "#b8aa84",
          "#1a1814"
        ],
        selected: false
      },
      {
        unlocalized_label: "Kids",
        hillshade: false,
        colors: [
          "#f9c50d",
          "#ffffff",
          "#839836",
          "#d6d3ce",
          "#2a5ba8",
          "#eeeeee"
        ],
        selected: false
      },
      {
        unlocalized_label: "Light mauve",
        hillshade: false,
        colors: [
          "#f3edf5",
          "#f3edf5",
          "#9d7da8",
          "#caa9d1",
          "#613b5c",
          "#e5d3e6"
        ],
        selected: false
      },
      {
        unlocalized_label: "Light Blue",
        hillshade: false,
        colors: [
          "#dceaf5",
          "#dceaf5",
          "#5598cf",
          "#81b7e3",
          "#3b576e",
          "#b6cde0"
        ],
        selected: false
      }
    ],
    medium_default_styles: {
      road: [
        {
          label: "Roads primary",
          color: "#f7f7f7",
          lines: [
            "lu_road_trunk_primary",
            "lu_bridge_major",
            "lu_tunnel_major",
            "lu_road_major_motorway"
          ],
          visible: true
        },
        {
          label: "Roads secondary",
          color: "#f7f7f7",
          lines: [
            "lu_road_minor",
            "lu_road_secondary_tertiary",
            "lu_bridge_minor",
            "lu_road_path",
            "lu_bridge_path",
            "lu_bridge_railway case",
            "lu_bridge_path case"
          ],
          visible: true
        },
        {
          label: "Vegetation",
          color: "#B8D293",
          opacity: "1",
          fills: [
            "lu_landcover_wood",
            "lu_landcover_grass",
            "lu_landuse_stadium",
            "lu_landuse_cemetery"
          ],
          visible: true
        },
        {
          label: "Buildings",
          color: "#D6AA85",
          opacity: "1",
          fillExtrusions: ["lu_building-3d_public", "lu_building-3d"],
          fills: ["lu_building", "lu_building_public"],
          lines: ["lu_bridge_railway", "lu_railway", "lu_tunnel_railway"],
          visible: true
        },
        {
          label: "Water",
          color: "#94c1e1",
          lines: [
            "lu_waterway",
            "lu_waterway_tunnel",
            "lu_waterway_intermittent"
          ],
          fills: ["lu_water"],
          visible: true
        },
        {
          label: "Background",
          color: "#e7e7e7",
          backgrounds: ["background"],
          visible: true
        },
        {
          label: "Hillshade",
          hillshades: ["hillshade"],
          visible: true
        }
      ],
      topo: [
        {
          label: "Primary Names",
          symbols: [
            "lu_place-label_other",
            "lu_place-label_city",
            "lu_place-label_canton",
            "lu_country-label-other",
            "lu_country-label",
            "place_label_other",
            "place_label_city",
            "country_label-other",
            "country_label"
          ],
          visible: true
        },
        {
          label: "Secondary Names",
          symbols: [
            "lu_place-label_isolated",
            "lu_place-label_locality_forest",
            "lu_place-label_locality_lieudit"
          ],
          visible: true
        },
        {
          label: "Transport",
          lines: [
            "lu_tunnel_track-casing",
            "lu_tunnel_major_motorway-casing",
            "lu_tunnel_railway_transit",
            "lu_tunnel_railway",
            "lu_tunnel_railway-hatching",
            "lu_tunnel_path",
            "lu_tunnel_track",
            "lu_tunnel_minor",
            "lu_tunnel_major_motorway",
            "lu_tunnel_secondary_tertiary",
            "lu_tunnel_trunk_primary",
            "lu_road_track-casing",
            "lu_road_minor-casing",
            "lu_road_major_motorway-casing",
            "lu_road_secondary_tertiary-casing",
            "lu_road_trunk_primary-casing",
            "lu_road_pier",
            "lu_road_path",
            "lu_road_track",
            "lu_road_minor",
            "lu_road_major_motorway",
            "lu_road_secondary_tertiary",
            "lu_road_trunk_primary",
            "lu_tram",
            "lu_tram-hatching",
            "lu_railway_transit",
            "lu_railway",
            "lu_railway-hatching",
            "lu_bridge_railway-casing",
            "lu_bridge_track-casing",
            "lu_bridge_path-casing",
            "lu_bridge_minor-casing",
            "lu_bridge_major_motorway-casing",
            "lu_bridge_secondary_tertiary-casing",
            "lu_bridge_trunk_primary-casing",
            "lu_bridge_railway",
            "lu_bridge_path",
            "lu_bridge_track",
            "lu_bridge_minor",
            "lu_bridge_major_motorway",
            "lu_bridge_secondary_tertiary",
            "lu_bridge_trunk_primary",
            "tunnel_track-casing",
            "tunnel_major_motorway-casing",
            "tunnel_railway_transit",
            "tunnel_railway_transit-hatching",
            "tunnel_railway",
            "tunnel_railway-hatching",
            "tunnel_path",
            "tunnel_track",
            "tunnel_minor",
            "tunnel_major_motorway",
            "tunnel_secondary_tertiary",
            "tunnel_trunk_primary",
            "road_track-casing",
            "road_minor-casing",
            "road_major_motorway-casing",
            "road_secondary_tertiary-casing",
            "road_trunk_primary-casing",
            "road_pier",
            "road_path",
            "road_track",
            "road_minor",
            "road_major_motorway",
            "road_secondary_tertiary",
            "road_trunk_primary",
            "railway-transit",
            "railway-transit-hatching",
            "railway",
            "railway-hatching",
            "bridge_railway-casing",
            "bridge_path-casing",
            "bridge_track_casing",
            "bridge_minor-casing",
            "bridge_major_motorway-casing",
            "bridge_secondary_tertiary-casing",
            "bridge_trunk_primary-casing",
            "bridge_railway",
            "bridge_path",
            "bridge_track",
            "bridge_minor",
            "bridge_major_motorway",
            "bridge_secondary_tertiary",
            "bridge_trunk_primary"
          ],
          symbols: [
            "lu_road_major-label",
            "lu_motorway-shield",
            "lu_road-shield"
          ],
          visible: true
        },
        {
          label: "Vegetation",
          fills: [
            "lu_landuse_stadium",
            "lu_landuse_cemetery",
            "lu_landuse_gras",
            "lu_landuse_park",
            "lu_landuse_park-outline",
            "lu_landuse_vineyard",
            "lu_landuse_orchard",
            "lu_landuse_wood",
            "landcover_grass",
            "landcover_wood"
          ],
          visible: true
        },
        {
          label: "Electricity",
          fills: ["lu_power_station", "lu_power_pylone"],
          lines: ["lu_power_line", "lu_power_station-outline"],
          symbols: ["lu_power_station-label", "lu_eolienne"],
          visible: true
        },
        {
          label: "Contours and Height Points",
          lines: [
            "lu_contour-100",
            "lu_contour-50",
            "lu_contour-20",
            "lu_contour-10",
            "lu_contour"
          ],
          symbols: [
            "lu_contour-label-100",
            "lu_contour-label-20",
            "lu_apex-label"
          ],
          visible: true
        },
        {
          label: "Hillshade",
          hillshades: ["lu_hillshade"],
          visible: true
        }
      ]
    },
    http_bg_server: "wmts{1-2}",
    https_bg_server: "wmts{3-4}",
    bg_wmts_server_path: "mapproxy_4_v3/wmts/{Layer}",
    bg_wmts_tile_template: "{TileMatrixSet}/{TileMatrix}/{TileCol}/{TileRow}",
    bg_layer_projection: "EPSG:3857",
    olcs_extent: [5.31, 49.38, 6.64, 50.21],
    olcs_extent_projection: "EPSG:3857",
    bg_layer_resolutions: [
      156543.033928,
      78271.516964,
      39135.758482,
      19567.879241,
      9783.9396205,
      4891.96981025,
      2445.98490513,
      1222.99245256,
      611.496226281,
      305.748113141,
      152.87405657,
      76.4370282852,
      38.2185141426,
      19.1092570713,
      9.55462853565,
      4.77731426782,
      2.38865713391,
      1.19432856696,
      0.597164283478,
      0.298582141739,
      0.1492910708695,
      0.07464553543475
    ],
    bg_matrix_ids: [
      "00",
      "01",
      "02",
      "03",
      "04",
      "05",
      "06",
      "07",
      "08",
      "09",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15",
      "16",
      "17",
      "18",
      "19",
      "20",
      "21"
    ]
  });
  function useMvtStyles() {
    function getDefaultMapBoxStyleUrl(label) {
      const searchParams = new URLSearchParams(document.location.search);
      const server = searchParams.get("embeddedserver");
      const proto = searchParams.get("embeddedserverprotocol") || "http";
      const url = (server ? `${proto}://${server}` : "https://vectortiles.geoportail.lu") + `/styles/${label}/style.json`;
      return url;
    }
    function getDefaultMapBoxStyleXYZ(label) {
      return `https://vectortiles.geoportail.lu/styles/${label}/{z}/{x}/{y}.png`;
    }
    function isValidSerial(serial) {
      const isValidUUIDv4Regex = /^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/gi;
      return isValidUUIDv4Regex.test(serial);
    }
    function setConfigForLayer(label, keyword2, isAuthenticated = false) {
      const xyz_custom = "";
      const defaultMapBoxStyle = getDefaultMapBoxStyleUrl(keyword2);
      const defaultMapBoxStyleXYZ = getDefaultMapBoxStyleXYZ(keyword2);
      const config = {
        label,
        defaultMapBoxStyle,
        defaultMapBoxStyleXYZ,
        xyz: defaultMapBoxStyleXYZ,
        xyz_custom,
        style: defaultMapBoxStyle
      };
      const serial = new URLSearchParams(window.location.search).get("serial");
      const serialLayer = new URLSearchParams(window.location.search).get(
        "serialLayer"
      );
      if (serial) {
        if (isValidSerial(serial)) {
          console.log(serialLayer);
        }
      } else if (isAuthenticated)
        ;
      else {
        return Promise.resolve(config);
      }
      return Promise.resolve(config);
    }
    function getRoadStyleFromSimpleStyle(simpleStyle) {
      const med_road_style = bgConfigFixture().medium_default_styles.road;
      if (simpleStyle) {
        simpleStyle.colors.forEach((element, i) => {
          med_road_style[i].color = element;
        });
        const hillshadeIndex = med_road_style.findIndex(
          (el) => el.label === "Hillshade"
        );
        med_road_style[hillshadeIndex].visible = simpleStyle.hillshade;
      }
      return med_road_style;
    }
    function applyStyle(bgLayer, style) {
      const mbMap = bgLayer.maplibreMap;
      if (!mbMap)
        return;
      if (mbMap.loaded()) {
        applyStyleOnMap(style, mbMap);
      } else {
        new Promise((resolve) => mbMap.once("load", resolve)).then(
          () => applyStyleOnMap(style, mbMap)
        );
      }
    }
    function applyStyleOnMap(style, mbMap) {
      style.forEach((item) => applyItemToMap(item, mbMap));
    }
    function applyItemToMap(item, mbMap) {
      for (const styleProperty of stylePropertyTypeList) {
        const props = item[`${styleProperty}s`] || [];
        props.forEach((prop) => {
          if ([
            "lu_bridge_path case",
            "lu_landcover_wood",
            "lu_landcover_grass",
            "lu_waterway_tunnel"
          ].indexOf(prop) !== -1) {
            return;
          }
          if (item.color) {
            mbMap.setPaintProperty(prop, `${styleProperty}-color`, item.color);
            mbMap.setPaintProperty(prop, `${styleProperty}-opacity`, 1);
          }
          mbMap.setLayoutProperty(
            prop,
            "visibility",
            item.visible ? "visible" : "none"
          );
        });
      }
    }
    function checkSelection(bgStyle, simpleStyleConf) {
      return simpleStyleConf.map(
        (style) => Object.assign(style, {
          selected: style.colors.every(
            (element, i) => {
              var _a;
              return ((_a = bgStyle[i]) == null ? void 0 : _a.color) === element;
            }
          )
        })
      );
    }
    return {
      setConfigForLayer,
      getRoadStyleFromSimpleStyle,
      applyStyle,
      checkSelection
    };
  }
  const useStyleStore = defineStore(
    "style",
    () => {
      const styleService = useMvtStyles();
      const bgStyle = vue.shallowRef();
      const bgVectorSources = vue.shallowRef(/* @__PURE__ */ new Map());
      const promises = [];
      bgConfigFixture().bg_layers.forEach((bgLayer) => {
        if (bgLayer.vector_id) {
          const conf = styleService.setConfigForLayer(
            bgLayer.icon_id,
            bgLayer.vector_id
          );
          promises.push(
            conf.then((c2) => {
              return { id: bgLayer.id, config: c2 };
            })
          );
        }
      });
      Promise.all(promises).then((styleConfigs) => {
        const vectorDict = /* @__PURE__ */ new Map();
        styleConfigs.forEach((c2) => vectorDict.set(c2.id, c2.config));
        bgVectorSources.value = vectorDict;
      });
      function setSimpleStyle(simpleStyle) {
        bgStyle.value = styleService.getRoadStyleFromSimpleStyle(simpleStyle);
      }
      function setStyle(style) {
        bgStyle.value = style;
      }
      return { bgStyle, bgVectorSources, setSimpleStyle, setStyle };
    },
    {}
  );
  class StorageStyleMapper {
    styleSerialToStyle(styleText) {
      if (styleText) {
        return JSON.parse(decodeURIComponent(styleText)) || [];
      }
      return [];
    }
    styleLocalStorageToStyle(styleText) {
      if (styleText) {
        return JSON.parse(styleText).medium || [];
      }
      return [];
    }
    styleToSerial(style) {
      if (style && style.length > 0) {
        return JSON.stringify(style);
      }
      return "";
    }
    styleToLocalStorage(style) {
      if (style && style.length > 0) {
        return JSON.stringify({ medium: style });
      }
      return "";
    }
  }
  const storageStyleMapper = new StorageStyleMapper();
  function debounce(fn, delay) {
    let timeoutID;
    return (...args) => {
      clearTimeout(timeoutID);
      timeoutID = setTimeout(() => {
        fn.apply(args);
      }, delay);
    };
  }
  function stringToNumber(text2) {
    return (text2 == null ? void 0 : text2.trim()) && !isNaN(Number(text2)) ? Number(text2) : void 0;
  }
  function stringToNumbers(text2, separator) {
    return (text2 == null ? void 0 : text2.split(separator).map(
      (item) => item !== null && !isNaN(Number(item)) ? parseFloat(item) : void 0
    )) || [];
  }
  function stringToBooleans(text2, separator) {
    return (text2 == null ? void 0 : text2.split(separator).map(stringToBoolean)) || [];
  }
  function stringToBoolean(text2) {
    return (text2 == null ? void 0 : text2.trim()) === "true" ? true : (text2 == null ? void 0 : text2.trim()) === "false" ? false : void 0;
  }
  function isHiDpi() {
    return window.matchMedia(
      "(-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2), (min-resolution: 192dpi)"
    ).matches;
  }
  const SP_KEY_IPV6 = "ipv6";
  const SP_KEY_APPLOGIN = "applogin";
  const SP_KEY_LOCALFORAGE = "localforage";
  const SP_KEY_DEBUG = "debug";
  const SP_KEY_FID = "fid";
  const SP_KEY_LANG = "lang";
  const SP_KEY_LAYERS_OPEN = "layersOpen";
  const SP_KEY_ADDRESS = "address";
  const SP_KEY_VERSION = "version";
  const SP_KEY_LAYERS = "layers";
  const SP_KEY_BGLAYER = "bgLayer";
  const SP_KEY_OPACITIES = "opacities";
  const SP_KEY_THEME = "theme";
  const SP_KEY_ZOOM = "zoom";
  const SP_KEY_SRS = "SRS";
  const SP_KEY_X = "X";
  const SP_KEY_Y = "Y";
  const SP_KEY_SERIAL = "serial";
  const SP_KEYS_STYLE = [
    "basemap_2015_global",
    "topogr_global",
    "topo_bw_jpeg"
  ];
  const SP_KEY_V2_BGLAYEROPACITY = "bgOpacity";
  const SP_KEY_V2_LAYERSINDICIES = "layers_indices";
  const SP_KEY_V2_LAYERSOPACITIES = "layers_opacity";
  const SP_KEY_V2_LAYERSVISIBILITY = "layers_visibility";
  var SP_AVAILABLE_STORAGES = /* @__PURE__ */ ((SP_AVAILABLE_STORAGES2) => {
    SP_AVAILABLE_STORAGES2[SP_AVAILABLE_STORAGES2["localStorage"] = 0] = "localStorage";
    SP_AVAILABLE_STORAGES2[SP_AVAILABLE_STORAGES2["permalink"] = 1] = "permalink";
    SP_AVAILABLE_STORAGES2[SP_AVAILABLE_STORAGES2["permalinkAsPath"] = 2] = "permalinkAsPath";
    SP_AVAILABLE_STORAGES2[SP_AVAILABLE_STORAGES2["permalinkAndLocalStorage"] = 3] = "permalinkAndLocalStorage";
    return SP_AVAILABLE_STORAGES2;
  })(SP_AVAILABLE_STORAGES || {});
  class StatePersistorRulesHelper {
  }
  class RulesReadHelper extends StatePersistorRulesHelper {
    static processRules(paramKeys) {
      if (RulesReadHelper.ruleUseLocalStorage(paramKeys)) {
        return SP_AVAILABLE_STORAGES.localStorage;
      }
      return SP_AVAILABLE_STORAGES.permalink;
    }
    static processRulesForKey(key, paramKeys) {
      if (key === SP_KEY_THEME && {}.VITE_DEPLOY_GHPAGES !== "true")
        return SP_AVAILABLE_STORAGES.permalinkAsPath;
      if (SP_KEYS_STYLE.includes(key)) {
        return SP_AVAILABLE_STORAGES.localStorage;
      }
      if (key === SP_KEY_SERIAL) {
        return SP_AVAILABLE_STORAGES.permalink;
      }
      if (key === SP_KEY_LAYERS_OPEN) {
        return SP_AVAILABLE_STORAGES.localStorage;
      }
      return void 0;
    }
    static ruleUseLocalStorage(paramKeys) {
      return [ruleEmptyParams$1, ruleOneParamOnly, ruleThreeParams].reduce(
        (prevResult, currRule) => prevResult || currRule(paramKeys),
        false
      );
    }
  }
  const ruleEmptyParams$1 = (paramKeys) => {
    return Object.keys(paramKeys).length === 0;
  };
  const ruleOneParamOnly = (paramKeys) => {
    return Object.keys(paramKeys).length === 1 && (paramKeys.hasOwnProperty(SP_KEY_IPV6) || paramKeys.hasOwnProperty(SP_KEY_APPLOGIN) || paramKeys.hasOwnProperty(SP_KEY_LOCALFORAGE));
  };
  const ruleThreeParams = (paramKeys) => {
    return Object.keys(paramKeys).length === 3 && paramKeys.hasOwnProperty(SP_KEY_IPV6) && paramKeys.hasOwnProperty(SP_KEY_APPLOGIN) && paramKeys.hasOwnProperty(SP_KEY_LOCALFORAGE);
  };
  class RulesWriteHelper extends StatePersistorRulesHelper {
    static processRules() {
      return SP_AVAILABLE_STORAGES.permalinkAndLocalStorage;
    }
    static processRulesForKey(key, paramKeys) {
      if (RulesWriteHelper.ruleUsePermalink(key)) {
        return SP_AVAILABLE_STORAGES.permalink;
      }
      if (key === SP_KEY_LAYERS_OPEN) {
        return SP_AVAILABLE_STORAGES.localStorage;
      }
      if (SP_KEYS_STYLE.includes(key)) {
        return SP_AVAILABLE_STORAGES.localStorage;
      }
      if (key === SP_KEY_SERIAL) {
        return SP_AVAILABLE_STORAGES.permalink;
      }
      if (key === SP_KEY_THEME) {
        return SP_AVAILABLE_STORAGES.permalinkAsPath;
      }
      return void 0;
    }
    static ruleUsePermalink(currentKey) {
      return [ruleIsVersion, ruleIsThemeForGhPagesHACK].reduce(
        (prevResult, currRule) => prevResult || currRule(currentKey),
        false
      );
    }
  }
  const ruleIsVersion = (currentKey) => {
    return currentKey === SP_KEY_VERSION;
  };
  const ruleIsThemeForGhPagesHACK = (currentKey) => {
    return currentKey === SP_KEY_THEME && {}.VITE_DEPLOY_GHPAGES === "true";
  };
  class UrlStorage {
    constructor() {
      __publicField(this, "snappedUrl");
      this.snappedUrl = new URL(window.location.toString());
    }
    get length() {
      throw new Error("Method not implemented.");
    }
    clear() {
      throw new Error("Method not implemented.");
    }
    key(index2) {
      throw new Error("Method key() not implemented. " + index2);
    }
    getSnappedUrl() {
      return this.snappedUrl;
    }
    getSnappedParamsAsObj() {
      return this.getSnappedParams().reduce(
        (prevObj, currParam) => {
          const [currKey, currValue] = currParam.split("=");
          return { ...prevObj, [currKey]: currValue };
        },
        {}
      );
    }
    getSnappedParams() {
      return this.getSnappedUrl().search.replace("?", "").split("&").filter((val) => val.split("=")[1]);
    }
    setItem(key, value) {
      const params2 = new URLSearchParams(
        new URL(window.location.toString()).search
      );
      params2.set(encodeURIComponent(key), encodeURIComponent(value));
      try {
        window.history.replaceState(null, "", "?" + params2.toString());
      } catch (error) {
      }
    }
    getItem(key) {
      return this.getSnappedUrl().searchParams.get(key);
    }
    removeItem(key) {
      const params2 = new URLSearchParams(
        new URL(window.location.toString()).search
      );
      params2.delete(key);
      try {
        window.history.replaceState(null, "", "?" + params2.toString());
      } catch (error) {
      }
    }
    encodeQueryParam(key, value) {
      return `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;
    }
  }
  const urlStorage = new UrlStorage();
  class UrlStorageAsPath extends UrlStorage {
    getItem(key) {
      const paths = this.getSnappedUrl().pathname.split("/");
      const keyPathIndex = paths.findIndex((path) => path === key);
      return paths[keyPathIndex + 1];
    }
    setItem(key, value) {
      const queryParams = new URL(window.location.toString()).search;
      const url = `${"/"}${key}/${value}${queryParams}`;
      try {
        window.history.replaceState(null, "", url);
      } catch (error) {
      }
    }
  }
  const urlPathStorage = new UrlStorageAsPath();
  class StorageProxy {
    get length() {
      throw new Error("Method not implemented.");
    }
    clear() {
      throw new Error("Method not implemented.");
    }
    key(index2) {
      throw new Error("Method key() not implemented. " + index2);
    }
    removeItem(key) {
      const writeStorages = this.getWriteStorages(key);
      writeStorages == null ? void 0 : writeStorages.map(
        (storage) => storage.removeItem(key)
      );
    }
    setItem(key, value) {
      this.setValue(key, value);
    }
    getItem(key) {
      return this.getValue(key);
    }
    get paramKeys() {
      return urlStorage.getSnappedParamsAsObj();
    }
    getValue(key) {
      var _a;
      const readStorage = (_a = this.correspondingStorages(
        RulesReadHelper.processRules(this.paramKeys)
      )) == null ? void 0 : _a.pop();
      const storage = this.storageForKey(key, RulesReadHelper, readStorage);
      return storage ? storage.getItem(key) : null;
    }
    setValue(key, value) {
      const writeStorages = this.getWriteStorages(key);
      writeStorages == null ? void 0 : writeStorages.map(
        (storage) => storage.setItem(key, value)
      );
    }
    getWriteStorages(key) {
      const writeStorages = this.correspondingStorages(
        RulesWriteHelper.processRules()
      );
      const storage = this.storageForKey(key, RulesWriteHelper);
      return storage ? [storage] : writeStorages;
    }
    storageForKey(key, ruler, defaultStorage) {
      var _a;
      const overriddenStorage = (_a = this.correspondingStorages(
        ruler.processRulesForKey(key, this.paramKeys)
      )) == null ? void 0 : _a.pop();
      return overriddenStorage != null ? overriddenStorage : defaultStorage;
    }
    correspondingStorages(depositsKey) {
      if (depositsKey === SP_AVAILABLE_STORAGES.permalinkAndLocalStorage) {
        return [urlStorage, localStorage];
      } else if (depositsKey === SP_AVAILABLE_STORAGES.localStorage) {
        return [localStorage];
      } else if (depositsKey === SP_AVAILABLE_STORAGES.permalink) {
        return [urlStorage];
      } else if (depositsKey === SP_AVAILABLE_STORAGES.permalinkAsPath) {
        return [urlPathStorage];
      }
      return void 0;
    }
  }
  const storageProxy = new StorageProxy();
  function isV3(paramKeys) {
    return ruleEmptyParams(paramKeys) || ruleOneParamAmong(paramKeys) || ruleTwoParamsAmong(paramKeys) || ruleThreeParamsAmong(paramKeys);
  }
  const ruleEmptyParams = (paramKeys) => {
    return Object.keys(paramKeys).length === 0;
  };
  const ruleOneParamAmong = (paramKeys) => {
    const keys = Object.keys(paramKeys);
    return Object.keys(paramKeys).length === 1 && [
      SP_KEY_IPV6,
      SP_KEY_APPLOGIN,
      SP_KEY_LOCALFORAGE,
      SP_KEY_FID,
      SP_KEY_LANG,
      SP_KEY_ADDRESS,
      SP_KEY_DEBUG
    ].some((spKey) => keys.indexOf(spKey) !== -1);
  };
  const ruleTwoParamsAmong = (paramKeys) => {
    const keys = Object.keys(paramKeys);
    const fnEvery = (spKey) => keys.indexOf(spKey) !== -1;
    const tuples = [
      [SP_KEY_APPLOGIN, SP_KEY_LOCALFORAGE],
      [SP_KEY_DEBUG, SP_KEY_FID],
      [SP_KEY_LANG, SP_KEY_FID],
      [SP_KEY_DEBUG, SP_KEY_LANG],
      [SP_KEY_DEBUG, SP_KEY_ADDRESS],
      [SP_KEY_LANG, SP_KEY_ADDRESS]
    ];
    return Object.keys(paramKeys).length === 2 && tuples.reduce(
      (prevResult, currRule) => prevResult || currRule.every(fnEvery),
      false
    );
  };
  const ruleThreeParamsAmong = (paramKeys) => {
    const keys = Object.keys(paramKeys);
    const fnEvery = (spKey) => keys.indexOf(spKey) !== -1;
    const tuple1 = [SP_KEY_IPV6, SP_KEY_APPLOGIN, SP_KEY_LOCALFORAGE].every(
      fnEvery
    );
    const tuple2 = [SP_KEY_DEBUG, SP_KEY_FID, SP_KEY_LANG].every(fnEvery);
    const tuple3 = [SP_KEY_DEBUG, SP_KEY_ADDRESS, SP_KEY_LANG].every(fnEvery);
    return Object.keys(paramKeys).length === 3 && (tuple1 || tuple2 || tuple3);
  };
  class StorageHelper {
    constructor() {
      __publicField(this, "intialVersion");
      const paramKeys = storageProxy.paramKeys;
      const version2 = this.getValue(SP_KEY_VERSION, stringToNumber);
      this.intialVersion = version2 ? Math.max(2, Math.min(version2, 3)) : isV3(paramKeys) ? 3 : 2;
      this.setValue(SP_KEY_VERSION, 3);
    }
    getInitialVersion() {
      return this.intialVersion;
    }
    mapToEntity(value, mapper) {
      return mapper ? mapper(value) : value;
    }
    mapToStorage(value, mapper) {
      return mapper ? mapper(value) : String(value);
    }
    getValue(key, mapper) {
      return this.mapToEntity(storageProxy.getValue(key), mapper);
    }
    setValue(key, value, mapper) {
      storageProxy.setValue(key, this.mapToStorage(value, mapper));
    }
    removeItem(key) {
      storageProxy.removeItem(key);
    }
  }
  const storageHelper = new StorageHelper();
  class StatePersistorStyleService {
    constructor() {
      __publicField(this, "styleWatcher");
    }
    bootstrapStyle() {
      const styleStore = useStyleStore();
      let stop;
      let activatePersistance = false;
      stop = vue.watchEffect(() => {
        if (styleStore.bgVectorSources) {
          this.restoreStyle();
          if (activatePersistance)
            this.persistStyle();
          activatePersistance = true;
          stop && stop();
        }
      });
    }
    persistStyle() {
      const styleStore = useStyleStore();
      const { bgStyle } = storeToRefs(styleStore);
      if (!this.styleWatcher) {
        this.styleWatcher = vue.watch(
          bgStyle,
          (value, oldValue) => {
            if (oldValue !== value) {
              const mapStore = useMapStore();
              if (mapStore.bgLayer) {
                storageHelper.setValue(
                  mapStore.bgLayer.name,
                  value || [],
                  storageStyleMapper.styleToLocalStorage
                );
                storageHelper.setValue(
                  SP_KEY_SERIAL,
                  value || [],
                  storageStyleMapper.styleToSerial
                );
              }
            }
          },
          { immediate: true }
        );
      }
    }
    restoreStyle() {
      console.log("restoring style");
      const styleStore = useStyleStore();
      const mapStore = useMapStore();
      const bgLayer = mapStore.bgLayer;
      console.log(`restoring bg style ${bgLayer == null ? void 0 : bgLayer.name}`);
      if (bgLayer) {
        let bgStyle = storageHelper.getValue(
          SP_KEY_SERIAL,
          storageStyleMapper.styleSerialToStyle
        );
        if (bgStyle.length === 0) {
          bgStyle = storageHelper.getValue(
            bgLayer.name,
            storageStyleMapper.styleLocalStorageToStyle
          );
        }
        if (bgStyle && bgStyle.length > 0) {
          styleStore.setStyle(bgStyle);
        }
      }
    }
  }
  const statePersistorStyleService = new StatePersistorStyleService();
  const _sfc_main$l = /* @__PURE__ */ vue.defineComponent({
    __name: "simple-style-item",
    props: {
      styleName: null,
      colors: null
    },
    setup(__props) {
      const props = __props;
      return (_ctx, _cache) => {
        return vue.openBlock(true), vue.createElementBlock(vue.Fragment, null, vue.renderList(props.colors, (color, i) => {
          return vue.openBlock(), vue.createElementBlock("span", {
            key: `${__props.styleName}-${i}`,
            class: "grow m-px",
            style: vue.normalizeStyle(`background-color: ${color}`)
          }, " \xA0 ", 4);
        }), 128);
      };
    }
  });
  const _hoisted_1$h = ["title"];
  const _hoisted_2$c = { class: "w-full text-white text-lg text-center" };
  const _hoisted_3$9 = ["title"];
  const _hoisted_4$8 = { class: "text-white" };
  const _hoisted_5$7 = ["title", "onClick"];
  const _hoisted_6$4 = { class: "flex" };
  const _sfc_main$k = /* @__PURE__ */ vue.defineComponent({
    __name: "simple-style-selector",
    props: {
      isOpen: {
        type: Boolean,
        default: true
      }
    },
    setup(__props) {
      const props = __props;
      const { t } = useTranslation();
      const styleStore = useStyleStore();
      const styleService = useMvtStyles();
      const { bgStyle } = storeToRefs(styleStore);
      const simpleStyles = vue.ref(bgConfigFixture().simple_styles);
      statePersistorStyleService.bootstrapStyle();
      const simpleStyleConf = bgConfigFixture().simple_styles;
      vue.watch(
        bgStyle,
        (newBgStyle) => simpleStyles.value = styleService.checkSelection(
          newBgStyle || [],
          simpleStyleConf
        )
      );
      function onStylingSelected(item) {
        styleStore.setSimpleStyle(item);
      }
      function resetStyle() {
        styleStore.setSimpleStyle(null);
      }
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock("div", {
          title: vue.unref(t)("Simple style editor", { ns: "client" }),
          class: vue.normalizeClass(`border-2 p-[10px] ${props.isOpen ? "" : "hidden"}`)
        }, [
          vue.createElementVNode("div", _hoisted_2$c, vue.toDisplayString(vue.unref(t)("Select a style", { ns: "client" })), 1),
          (vue.openBlock(true), vue.createElementBlock(vue.Fragment, null, vue.renderList(simpleStyles.value, (item) => {
            return vue.openBlock(), vue.createElementBlock("div", {
              key: item.unlocalized_label,
              title: vue.unref(t)(item.unlocalized_label, { ns: "client" }),
              class: vue.normalizeClass(`${item.selected ? "border-dotted" : "border-hidden"} border-2 p-px`)
            }, [
              vue.createElementVNode("span", _hoisted_4$8, vue.toDisplayString(vue.unref(t)(item.unlocalized_label, { ns: "client" })) + " : ", 1),
              vue.createElementVNode("button", {
                title: vue.unref(t)("Select style: {{styleName}}", {
                  styleName: vue.unref(t)(item.unlocalized_label)
                }),
                onClick: ($event) => onStylingSelected(item),
                class: "w-full"
              }, [
                vue.createElementVNode("span", _hoisted_6$4, [
                  vue.createVNode(_sfc_main$l, {
                    colors: item.colors,
                    "style-name": item.unlocalized_label
                  }, null, 8, ["colors", "style-name"])
                ])
              ], 8, _hoisted_5$7)
            ], 10, _hoisted_3$9);
          }), 128)),
          vue.createElementVNode("button", {
            onClick: resetStyle,
            class: "lux-btn"
          }, vue.toDisplayString(vue.unref(t)("Reset style", { ns: "client" })), 1)
        ], 10, _hoisted_1$h);
      };
    }
  });
  const useMetadataStore = defineStore(
    "metadata",
    () => {
      const metadataId = vue.ref();
      function setMetadataId(id) {
        metadataId.value = id;
      }
      function clearMetadataId() {
        metadataId.value = void 0;
      }
      return {
        metadataId,
        setMetadataId,
        clearMetadataId
      };
    },
    {}
  );
  const _hoisted_1$g = { id: "sortable-layers" };
  const _hoisted_2$b = ["id"];
  const _sfc_main$j = /* @__PURE__ */ vue.defineComponent({
    __name: "layer-manager",
    setup(__props) {
      const ROAD_MAP_ID = 556;
      const { setMetadataId } = useMetadataStore();
      const mapStore = useMapStore();
      const { bgLayer } = storeToRefs(mapStore);
      const layers = vue.computed(() => [...mapStore.layers].reverse());
      const isLayerOpenId = vue.shallowRef();
      const isStyleEditorOpen = vue.shallowRef(false);
      const draggableClassName = "drag-handle";
      vue.onMounted(() => {
        const sortableLayers = document.getElementById("sortable-layers");
        if (sortableLayers) {
          Sortable.create(sortableLayers, {
            dataIdAttr: "data-id",
            dragClass: "lux-sortable-drag",
            ghostClass: "lux-sortable-ghost",
            sort: true,
            handle: `.${draggableClassName}`,
            onSort: sortMethod
          });
        }
      });
      function sortMethod(event) {
        const items = event.to.children;
        mapStore.reorderLayers([...items].map((val) => Number(val.id)).reverse());
      }
      function changeOpacityLayer(layer, opacity) {
        mapStore.setLayerOpacity(layer.id, opacity / 100);
      }
      function removeLayer(layer) {
        mapStore.removeLayers(layer.id);
      }
      function toggleAccordionItem(layer) {
        isLayerOpenId.value = isLayerOpenId.value !== layer.id ? layer.id : void 0;
      }
      function toggleEditionLayer() {
        isStyleEditorOpen.value = !isStyleEditorOpen.value;
      }
      return (_ctx, _cache) => {
        var _a, _b;
        return vue.openBlock(), vue.createElementBlock("ul", _hoisted_1$g, [
          (vue.openBlock(true), vue.createElementBlock(vue.Fragment, null, vue.renderList(vue.unref(layers), (layer) => {
            return vue.openBlock(), vue.createElementBlock("li", {
              key: layer.id,
              id: layer.id
            }, [
              vue.createVNode(_sfc_main$m, {
                draggableClassName,
                layer,
                isOpen: vue.unref(isLayerOpenId) === layer.id,
                onClickRemove: removeLayer,
                onClickToggle: toggleAccordionItem,
                onClickInfo: ($event) => vue.unref(setMetadataId)(layer.id),
                onChangeOpacity: changeOpacityLayer
              }, null, 8, ["layer", "isOpen", "onClickInfo"])
            ], 8, _hoisted_2$b);
          }), 128)),
          vue.createElementVNode("li", null, [
            vue.createVNode(_sfc_main$n, {
              layer: vue.unref(bgLayer) || vue.unref(BLANK_BACKGROUNDLAYER),
              showEditButton: ((_a = vue.unref(bgLayer)) == null ? void 0 : _a.id) === ROAD_MAP_ID,
              onClickInfo: _cache[0] || (_cache[0] = () => vue.unref(bgLayer) && vue.unref(setMetadataId)(vue.unref(bgLayer).id)),
              onClickEdit: toggleEditionLayer
            }, null, 8, ["layer", "showEditButton"]),
            vue.createVNode(_sfc_main$k, {
              "is-open": vue.unref(isStyleEditorOpen) && ((_b = vue.unref(bgLayer)) == null ? void 0 : _b.id) === ROAD_MAP_ID
            }, null, 8, ["is-open"])
          ])
        ]);
      };
    }
  });
  function _typeof$3(obj) {
    "@babel/helpers - typeof";
    return _typeof$3 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(obj2) {
      return typeof obj2;
    } : function(obj2) {
      return obj2 && "function" == typeof Symbol && obj2.constructor === Symbol && obj2 !== Symbol.prototype ? "symbol" : typeof obj2;
    }, _typeof$3(obj);
  }
  function _classCallCheck$1(instance2, Constructor) {
    if (!(instance2 instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }
  function _toPrimitive$1(input, hint) {
    if (_typeof$3(input) !== "object" || input === null)
      return input;
    var prim = input[Symbol.toPrimitive];
    if (prim !== void 0) {
      var res = prim.call(input, hint || "default");
      if (_typeof$3(res) !== "object")
        return res;
      throw new TypeError("@@toPrimitive must return a primitive value.");
    }
    return (hint === "string" ? String : Number)(input);
  }
  function _toPropertyKey$1(arg) {
    var key = _toPrimitive$1(arg, "string");
    return _typeof$3(key) === "symbol" ? key : String(key);
  }
  function _defineProperties$1(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor)
        descriptor.writable = true;
      Object.defineProperty(target, _toPropertyKey$1(descriptor.key), descriptor);
    }
  }
  function _createClass$1(Constructor, protoProps, staticProps) {
    if (protoProps)
      _defineProperties$1(Constructor.prototype, protoProps);
    if (staticProps)
      _defineProperties$1(Constructor, staticProps);
    Object.defineProperty(Constructor, "prototype", {
      writable: false
    });
    return Constructor;
  }
  function _assertThisInitialized(self2) {
    if (self2 === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }
    return self2;
  }
  function _setPrototypeOf(o, p2) {
    _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf2(o2, p3) {
      o2.__proto__ = p3;
      return o2;
    };
    return _setPrototypeOf(o, p2);
  }
  function _inherits(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }
    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    Object.defineProperty(subClass, "prototype", {
      writable: false
    });
    if (superClass)
      _setPrototypeOf(subClass, superClass);
  }
  function _possibleConstructorReturn(self2, call) {
    if (call && (_typeof$3(call) === "object" || typeof call === "function")) {
      return call;
    } else if (call !== void 0) {
      throw new TypeError("Derived constructors may only return object or undefined");
    }
    return _assertThisInitialized(self2);
  }
  function _getPrototypeOf(o) {
    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf2(o2) {
      return o2.__proto__ || Object.getPrototypeOf(o2);
    };
    return _getPrototypeOf(o);
  }
  function _defineProperty$1(obj, key, value) {
    key = _toPropertyKey$1(key);
    if (key in obj) {
      Object.defineProperty(obj, key, {
        value,
        enumerable: true,
        configurable: true,
        writable: true
      });
    } else {
      obj[key] = value;
    }
    return obj;
  }
  function _arrayWithHoles(arr2) {
    if (Array.isArray(arr2))
      return arr2;
  }
  function _iterableToArray(iter) {
    if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null)
      return Array.from(iter);
  }
  function _arrayLikeToArray(arr2, len) {
    if (len == null || len > arr2.length)
      len = arr2.length;
    for (var i = 0, arr22 = new Array(len); i < len; i++)
      arr22[i] = arr2[i];
    return arr22;
  }
  function _unsupportedIterableToArray(o, minLen) {
    if (!o)
      return;
    if (typeof o === "string")
      return _arrayLikeToArray(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor)
      n = o.constructor.name;
    if (n === "Map" || n === "Set")
      return Array.from(o);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))
      return _arrayLikeToArray(o, minLen);
  }
  function _nonIterableRest() {
    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }
  function _toArray(arr2) {
    return _arrayWithHoles(arr2) || _iterableToArray(arr2) || _unsupportedIterableToArray(arr2) || _nonIterableRest();
  }
  function ownKeys$6(object, enumerableOnly) {
    var keys = Object.keys(object);
    if (Object.getOwnPropertySymbols) {
      var symbols = Object.getOwnPropertySymbols(object);
      enumerableOnly && (symbols = symbols.filter(function(sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      })), keys.push.apply(keys, symbols);
    }
    return keys;
  }
  function _objectSpread$6(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = null != arguments[i] ? arguments[i] : {};
      i % 2 ? ownKeys$6(Object(source), true).forEach(function(key) {
        _defineProperty$1(target, key, source[key]);
      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$6(Object(source)).forEach(function(key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
    return target;
  }
  var consoleLogger = {
    type: "logger",
    log: function log(args) {
      this.output("log", args);
    },
    warn: function warn2(args) {
      this.output("warn", args);
    },
    error: function error(args) {
      this.output("error", args);
    },
    output: function output(type, args) {
      if (console && console[type])
        console[type].apply(console, args);
    }
  };
  var Logger = function() {
    function Logger2(concreteLogger) {
      var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
      _classCallCheck$1(this, Logger2);
      this.init(concreteLogger, options);
    }
    _createClass$1(Logger2, [{
      key: "init",
      value: function init2(concreteLogger) {
        var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        this.prefix = options.prefix || "i18next:";
        this.logger = concreteLogger || consoleLogger;
        this.options = options;
        this.debug = options.debug;
      }
    }, {
      key: "setDebug",
      value: function setDebug(bool) {
        this.debug = bool;
      }
    }, {
      key: "log",
      value: function log() {
        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }
        return this.forward(args, "log", "", true);
      }
    }, {
      key: "warn",
      value: function warn2() {
        for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
          args[_key2] = arguments[_key2];
        }
        return this.forward(args, "warn", "", true);
      }
    }, {
      key: "error",
      value: function error() {
        for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
          args[_key3] = arguments[_key3];
        }
        return this.forward(args, "error", "");
      }
    }, {
      key: "deprecate",
      value: function deprecate() {
        for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
          args[_key4] = arguments[_key4];
        }
        return this.forward(args, "warn", "WARNING DEPRECATED: ", true);
      }
    }, {
      key: "forward",
      value: function forward2(args, lvl, prefix, debugOnly) {
        if (debugOnly && !this.debug)
          return null;
        if (typeof args[0] === "string")
          args[0] = "".concat(prefix).concat(this.prefix, " ").concat(args[0]);
        return this.logger[lvl](args);
      }
    }, {
      key: "create",
      value: function create2(moduleName) {
        return new Logger2(this.logger, _objectSpread$6(_objectSpread$6({}, {
          prefix: "".concat(this.prefix, ":").concat(moduleName, ":")
        }), this.options));
      }
    }, {
      key: "clone",
      value: function clone2(options) {
        options = options || this.options;
        options.prefix = options.prefix || this.prefix;
        return new Logger2(this.logger, options);
      }
    }]);
    return Logger2;
  }();
  var baseLogger = new Logger();
  var EventEmitter = function() {
    function EventEmitter2() {
      _classCallCheck$1(this, EventEmitter2);
      this.observers = {};
    }
    _createClass$1(EventEmitter2, [{
      key: "on",
      value: function on2(events, listener) {
        var _this = this;
        events.split(" ").forEach(function(event) {
          _this.observers[event] = _this.observers[event] || [];
          _this.observers[event].push(listener);
        });
        return this;
      }
    }, {
      key: "off",
      value: function off2(event, listener) {
        if (!this.observers[event])
          return;
        if (!listener) {
          delete this.observers[event];
          return;
        }
        this.observers[event] = this.observers[event].filter(function(l) {
          return l !== listener;
        });
      }
    }, {
      key: "emit",
      value: function emit(event) {
        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
          args[_key - 1] = arguments[_key];
        }
        if (this.observers[event]) {
          var cloned = [].concat(this.observers[event]);
          cloned.forEach(function(observer) {
            observer.apply(void 0, args);
          });
        }
        if (this.observers["*"]) {
          var _cloned = [].concat(this.observers["*"]);
          _cloned.forEach(function(observer) {
            observer.apply(observer, [event].concat(args));
          });
        }
      }
    }]);
    return EventEmitter2;
  }();
  function defer() {
    var res;
    var rej;
    var promise = new Promise(function(resolve, reject) {
      res = resolve;
      rej = reject;
    });
    promise.resolve = res;
    promise.reject = rej;
    return promise;
  }
  function makeString(object) {
    if (object == null)
      return "";
    return "" + object;
  }
  function copy(a, s, t) {
    a.forEach(function(m) {
      if (s[m])
        t[m] = s[m];
    });
  }
  function getLastOfPath(object, path, Empty) {
    function cleanKey(key2) {
      return key2 && key2.indexOf("###") > -1 ? key2.replace(/###/g, ".") : key2;
    }
    function canNotTraverseDeeper() {
      return !object || typeof object === "string";
    }
    var stack = typeof path !== "string" ? [].concat(path) : path.split(".");
    while (stack.length > 1) {
      if (canNotTraverseDeeper())
        return {};
      var key = cleanKey(stack.shift());
      if (!object[key] && Empty)
        object[key] = new Empty();
      if (Object.prototype.hasOwnProperty.call(object, key)) {
        object = object[key];
      } else {
        object = {};
      }
    }
    if (canNotTraverseDeeper())
      return {};
    return {
      obj: object,
      k: cleanKey(stack.shift())
    };
  }
  function setPath(object, path, newValue) {
    var _getLastOfPath = getLastOfPath(object, path, Object), obj = _getLastOfPath.obj, k = _getLastOfPath.k;
    obj[k] = newValue;
  }
  function pushPath(object, path, newValue, concat) {
    var _getLastOfPath2 = getLastOfPath(object, path, Object), obj = _getLastOfPath2.obj, k = _getLastOfPath2.k;
    obj[k] = obj[k] || [];
    if (concat)
      obj[k] = obj[k].concat(newValue);
    if (!concat)
      obj[k].push(newValue);
  }
  function getPath(object, path) {
    var _getLastOfPath3 = getLastOfPath(object, path), obj = _getLastOfPath3.obj, k = _getLastOfPath3.k;
    if (!obj)
      return void 0;
    return obj[k];
  }
  function getPathWithDefaults(data, defaultData, key) {
    var value = getPath(data, key);
    if (value !== void 0) {
      return value;
    }
    return getPath(defaultData, key);
  }
  function deepExtend(target, source, overwrite) {
    for (var prop in source) {
      if (prop !== "__proto__" && prop !== "constructor") {
        if (prop in target) {
          if (typeof target[prop] === "string" || target[prop] instanceof String || typeof source[prop] === "string" || source[prop] instanceof String) {
            if (overwrite)
              target[prop] = source[prop];
          } else {
            deepExtend(target[prop], source[prop], overwrite);
          }
        } else {
          target[prop] = source[prop];
        }
      }
    }
    return target;
  }
  function regexEscape(str) {
    return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
  }
  var _entityMap = {
    "&": "&amp;",
    "<": "&lt;",
    ">": "&gt;",
    '"': "&quot;",
    "'": "&#39;",
    "/": "&#x2F;"
  };
  function escape(data) {
    if (typeof data === "string") {
      return data.replace(/[&<>"'\/]/g, function(s) {
        return _entityMap[s];
      });
    }
    return data;
  }
  var isIE10 = typeof window !== "undefined" && window.navigator && typeof window.navigator.userAgentData === "undefined" && window.navigator.userAgent && window.navigator.userAgent.indexOf("MSIE") > -1;
  var chars = [" ", ",", "?", "!", ";"];
  function looksLikeObjectPath(key, nsSeparator, keySeparator) {
    nsSeparator = nsSeparator || "";
    keySeparator = keySeparator || "";
    var possibleChars = chars.filter(function(c2) {
      return nsSeparator.indexOf(c2) < 0 && keySeparator.indexOf(c2) < 0;
    });
    if (possibleChars.length === 0)
      return true;
    var r = new RegExp("(".concat(possibleChars.map(function(c2) {
      return c2 === "?" ? "\\?" : c2;
    }).join("|"), ")"));
    var matched = !r.test(key);
    if (!matched) {
      var ki = key.indexOf(keySeparator);
      if (ki > 0 && !r.test(key.substring(0, ki))) {
        matched = true;
      }
    }
    return matched;
  }
  function ownKeys$5(object, enumerableOnly) {
    var keys = Object.keys(object);
    if (Object.getOwnPropertySymbols) {
      var symbols = Object.getOwnPropertySymbols(object);
      enumerableOnly && (symbols = symbols.filter(function(sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      })), keys.push.apply(keys, symbols);
    }
    return keys;
  }
  function _objectSpread$5(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = null != arguments[i] ? arguments[i] : {};
      i % 2 ? ownKeys$5(Object(source), true).forEach(function(key) {
        _defineProperty$1(target, key, source[key]);
      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$5(Object(source)).forEach(function(key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
    return target;
  }
  function _createSuper$3(Derived) {
    var hasNativeReflectConstruct = _isNativeReflectConstruct$3();
    return function _createSuperInternal() {
      var Super = _getPrototypeOf(Derived), result;
      if (hasNativeReflectConstruct) {
        var NewTarget = _getPrototypeOf(this).constructor;
        result = Reflect.construct(Super, arguments, NewTarget);
      } else {
        result = Super.apply(this, arguments);
      }
      return _possibleConstructorReturn(this, result);
    };
  }
  function _isNativeReflectConstruct$3() {
    if (typeof Reflect === "undefined" || !Reflect.construct)
      return false;
    if (Reflect.construct.sham)
      return false;
    if (typeof Proxy === "function")
      return true;
    try {
      Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
      }));
      return true;
    } catch (e) {
      return false;
    }
  }
  function deepFind(obj, path) {
    var keySeparator = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : ".";
    if (!obj)
      return void 0;
    if (obj[path])
      return obj[path];
    var paths = path.split(keySeparator);
    var current = obj;
    for (var i = 0; i < paths.length; ++i) {
      if (!current)
        return void 0;
      if (typeof current[paths[i]] === "string" && i + 1 < paths.length) {
        return void 0;
      }
      if (current[paths[i]] === void 0) {
        var j = 2;
        var p2 = paths.slice(i, i + j).join(keySeparator);
        var mix = current[p2];
        while (mix === void 0 && paths.length > i + j) {
          j++;
          p2 = paths.slice(i, i + j).join(keySeparator);
          mix = current[p2];
        }
        if (mix === void 0)
          return void 0;
        if (mix === null)
          return null;
        if (path.endsWith(p2)) {
          if (typeof mix === "string")
            return mix;
          if (p2 && typeof mix[p2] === "string")
            return mix[p2];
        }
        var joinedPath = paths.slice(i + j).join(keySeparator);
        if (joinedPath)
          return deepFind(mix, joinedPath, keySeparator);
        return void 0;
      }
      current = current[paths[i]];
    }
    return current;
  }
  var ResourceStore = function(_EventEmitter) {
    _inherits(ResourceStore2, _EventEmitter);
    var _super = _createSuper$3(ResourceStore2);
    function ResourceStore2(data) {
      var _this;
      var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {
        ns: ["translation"],
        defaultNS: "translation"
      };
      _classCallCheck$1(this, ResourceStore2);
      _this = _super.call(this);
      if (isIE10) {
        EventEmitter.call(_assertThisInitialized(_this));
      }
      _this.data = data || {};
      _this.options = options;
      if (_this.options.keySeparator === void 0) {
        _this.options.keySeparator = ".";
      }
      if (_this.options.ignoreJSONStructure === void 0) {
        _this.options.ignoreJSONStructure = true;
      }
      return _this;
    }
    _createClass$1(ResourceStore2, [{
      key: "addNamespaces",
      value: function addNamespaces(ns) {
        if (this.options.ns.indexOf(ns) < 0) {
          this.options.ns.push(ns);
        }
      }
    }, {
      key: "removeNamespaces",
      value: function removeNamespaces(ns) {
        var index2 = this.options.ns.indexOf(ns);
        if (index2 > -1) {
          this.options.ns.splice(index2, 1);
        }
      }
    }, {
      key: "getResource",
      value: function getResource(lng, ns, key) {
        var options = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : {};
        var keySeparator = options.keySeparator !== void 0 ? options.keySeparator : this.options.keySeparator;
        var ignoreJSONStructure = options.ignoreJSONStructure !== void 0 ? options.ignoreJSONStructure : this.options.ignoreJSONStructure;
        var path = [lng, ns];
        if (key && typeof key !== "string")
          path = path.concat(key);
        if (key && typeof key === "string")
          path = path.concat(keySeparator ? key.split(keySeparator) : key);
        if (lng.indexOf(".") > -1) {
          path = lng.split(".");
        }
        var result = getPath(this.data, path);
        if (result || !ignoreJSONStructure || typeof key !== "string")
          return result;
        return deepFind(this.data && this.data[lng] && this.data[lng][ns], key, keySeparator);
      }
    }, {
      key: "addResource",
      value: function addResource(lng, ns, key, value) {
        var options = arguments.length > 4 && arguments[4] !== void 0 ? arguments[4] : {
          silent: false
        };
        var keySeparator = this.options.keySeparator;
        if (keySeparator === void 0)
          keySeparator = ".";
        var path = [lng, ns];
        if (key)
          path = path.concat(keySeparator ? key.split(keySeparator) : key);
        if (lng.indexOf(".") > -1) {
          path = lng.split(".");
          value = ns;
          ns = path[1];
        }
        this.addNamespaces(ns);
        setPath(this.data, path, value);
        if (!options.silent)
          this.emit("added", lng, ns, key, value);
      }
    }, {
      key: "addResources",
      value: function addResources(lng, ns, resources) {
        var options = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : {
          silent: false
        };
        for (var m in resources) {
          if (typeof resources[m] === "string" || Object.prototype.toString.apply(resources[m]) === "[object Array]")
            this.addResource(lng, ns, m, resources[m], {
              silent: true
            });
        }
        if (!options.silent)
          this.emit("added", lng, ns, resources);
      }
    }, {
      key: "addResourceBundle",
      value: function addResourceBundle(lng, ns, resources, deep, overwrite) {
        var options = arguments.length > 5 && arguments[5] !== void 0 ? arguments[5] : {
          silent: false
        };
        var path = [lng, ns];
        if (lng.indexOf(".") > -1) {
          path = lng.split(".");
          deep = resources;
          resources = ns;
          ns = path[1];
        }
        this.addNamespaces(ns);
        var pack = getPath(this.data, path) || {};
        if (deep) {
          deepExtend(pack, resources, overwrite);
        } else {
          pack = _objectSpread$5(_objectSpread$5({}, pack), resources);
        }
        setPath(this.data, path, pack);
        if (!options.silent)
          this.emit("added", lng, ns, resources);
      }
    }, {
      key: "removeResourceBundle",
      value: function removeResourceBundle(lng, ns) {
        if (this.hasResourceBundle(lng, ns)) {
          delete this.data[lng][ns];
        }
        this.removeNamespaces(ns);
        this.emit("removed", lng, ns);
      }
    }, {
      key: "hasResourceBundle",
      value: function hasResourceBundle(lng, ns) {
        return this.getResource(lng, ns) !== void 0;
      }
    }, {
      key: "getResourceBundle",
      value: function getResourceBundle(lng, ns) {
        if (!ns)
          ns = this.options.defaultNS;
        if (this.options.compatibilityAPI === "v1")
          return _objectSpread$5(_objectSpread$5({}, {}), this.getResource(lng, ns));
        return this.getResource(lng, ns);
      }
    }, {
      key: "getDataByLanguage",
      value: function getDataByLanguage(lng) {
        return this.data[lng];
      }
    }, {
      key: "hasLanguageSomeTranslations",
      value: function hasLanguageSomeTranslations(lng) {
        var data = this.getDataByLanguage(lng);
        var n = data && Object.keys(data) || [];
        return !!n.find(function(v2) {
          return data[v2] && Object.keys(data[v2]).length > 0;
        });
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        return this.data;
      }
    }]);
    return ResourceStore2;
  }(EventEmitter);
  var postProcessor = {
    processors: {},
    addPostProcessor: function addPostProcessor(module2) {
      this.processors[module2.name] = module2;
    },
    handle: function handle(processors, value, key, options, translator) {
      var _this = this;
      processors.forEach(function(processor) {
        if (_this.processors[processor])
          value = _this.processors[processor].process(value, key, options, translator);
      });
      return value;
    }
  };
  function ownKeys$4(object, enumerableOnly) {
    var keys = Object.keys(object);
    if (Object.getOwnPropertySymbols) {
      var symbols = Object.getOwnPropertySymbols(object);
      enumerableOnly && (symbols = symbols.filter(function(sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      })), keys.push.apply(keys, symbols);
    }
    return keys;
  }
  function _objectSpread$4(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = null != arguments[i] ? arguments[i] : {};
      i % 2 ? ownKeys$4(Object(source), true).forEach(function(key) {
        _defineProperty$1(target, key, source[key]);
      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$4(Object(source)).forEach(function(key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
    return target;
  }
  function _createSuper$2(Derived) {
    var hasNativeReflectConstruct = _isNativeReflectConstruct$2();
    return function _createSuperInternal() {
      var Super = _getPrototypeOf(Derived), result;
      if (hasNativeReflectConstruct) {
        var NewTarget = _getPrototypeOf(this).constructor;
        result = Reflect.construct(Super, arguments, NewTarget);
      } else {
        result = Super.apply(this, arguments);
      }
      return _possibleConstructorReturn(this, result);
    };
  }
  function _isNativeReflectConstruct$2() {
    if (typeof Reflect === "undefined" || !Reflect.construct)
      return false;
    if (Reflect.construct.sham)
      return false;
    if (typeof Proxy === "function")
      return true;
    try {
      Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
      }));
      return true;
    } catch (e) {
      return false;
    }
  }
  var checkedLoadedFor = {};
  var Translator = function(_EventEmitter) {
    _inherits(Translator2, _EventEmitter);
    var _super = _createSuper$2(Translator2);
    function Translator2(services) {
      var _this;
      var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
      _classCallCheck$1(this, Translator2);
      _this = _super.call(this);
      if (isIE10) {
        EventEmitter.call(_assertThisInitialized(_this));
      }
      copy(["resourceStore", "languageUtils", "pluralResolver", "interpolator", "backendConnector", "i18nFormat", "utils"], services, _assertThisInitialized(_this));
      _this.options = options;
      if (_this.options.keySeparator === void 0) {
        _this.options.keySeparator = ".";
      }
      _this.logger = baseLogger.create("translator");
      return _this;
    }
    _createClass$1(Translator2, [{
      key: "changeLanguage",
      value: function changeLanguage(lng) {
        if (lng)
          this.language = lng;
      }
    }, {
      key: "exists",
      value: function exists(key) {
        var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {
          interpolation: {}
        };
        if (key === void 0 || key === null) {
          return false;
        }
        var resolved = this.resolve(key, options);
        return resolved && resolved.res !== void 0;
      }
    }, {
      key: "extractFromKey",
      value: function extractFromKey(key, options) {
        var nsSeparator = options.nsSeparator !== void 0 ? options.nsSeparator : this.options.nsSeparator;
        if (nsSeparator === void 0)
          nsSeparator = ":";
        var keySeparator = options.keySeparator !== void 0 ? options.keySeparator : this.options.keySeparator;
        var namespaces = options.ns || this.options.defaultNS || [];
        var wouldCheckForNsInKey = nsSeparator && key.indexOf(nsSeparator) > -1;
        var seemsNaturalLanguage = !this.options.userDefinedKeySeparator && !options.keySeparator && !this.options.userDefinedNsSeparator && !options.nsSeparator && !looksLikeObjectPath(key, nsSeparator, keySeparator);
        if (wouldCheckForNsInKey && !seemsNaturalLanguage) {
          var m = key.match(this.interpolator.nestingRegexp);
          if (m && m.length > 0) {
            return {
              key,
              namespaces
            };
          }
          var parts = key.split(nsSeparator);
          if (nsSeparator !== keySeparator || nsSeparator === keySeparator && this.options.ns.indexOf(parts[0]) > -1)
            namespaces = parts.shift();
          key = parts.join(keySeparator);
        }
        if (typeof namespaces === "string")
          namespaces = [namespaces];
        return {
          key,
          namespaces
        };
      }
    }, {
      key: "translate",
      value: function translate2(keys, options, lastKey) {
        var _this2 = this;
        if (_typeof$3(options) !== "object" && this.options.overloadTranslationOptionHandler) {
          options = this.options.overloadTranslationOptionHandler(arguments);
        }
        if (!options)
          options = {};
        if (keys === void 0 || keys === null)
          return "";
        if (!Array.isArray(keys))
          keys = [String(keys)];
        var returnDetails = options.returnDetails !== void 0 ? options.returnDetails : this.options.returnDetails;
        var keySeparator = options.keySeparator !== void 0 ? options.keySeparator : this.options.keySeparator;
        var _this$extractFromKey = this.extractFromKey(keys[keys.length - 1], options), key = _this$extractFromKey.key, namespaces = _this$extractFromKey.namespaces;
        var namespace = namespaces[namespaces.length - 1];
        var lng = options.lng || this.language;
        var appendNamespaceToCIMode = options.appendNamespaceToCIMode || this.options.appendNamespaceToCIMode;
        if (lng && lng.toLowerCase() === "cimode") {
          if (appendNamespaceToCIMode) {
            var nsSeparator = options.nsSeparator || this.options.nsSeparator;
            if (returnDetails) {
              return {
                res: "".concat(namespace).concat(nsSeparator).concat(key),
                usedKey: key,
                exactUsedKey: key,
                usedLng: lng,
                usedNS: namespace
              };
            }
            return "".concat(namespace).concat(nsSeparator).concat(key);
          }
          if (returnDetails) {
            return {
              res: key,
              usedKey: key,
              exactUsedKey: key,
              usedLng: lng,
              usedNS: namespace
            };
          }
          return key;
        }
        var resolved = this.resolve(keys, options);
        var res = resolved && resolved.res;
        var resUsedKey = resolved && resolved.usedKey || key;
        var resExactUsedKey = resolved && resolved.exactUsedKey || key;
        var resType = Object.prototype.toString.apply(res);
        var noObject = ["[object Number]", "[object Function]", "[object RegExp]"];
        var joinArrays = options.joinArrays !== void 0 ? options.joinArrays : this.options.joinArrays;
        var handleAsObjectInI18nFormat = !this.i18nFormat || this.i18nFormat.handleAsObject;
        var handleAsObject = typeof res !== "string" && typeof res !== "boolean" && typeof res !== "number";
        if (handleAsObjectInI18nFormat && res && handleAsObject && noObject.indexOf(resType) < 0 && !(typeof joinArrays === "string" && resType === "[object Array]")) {
          if (!options.returnObjects && !this.options.returnObjects) {
            if (!this.options.returnedObjectHandler) {
              this.logger.warn("accessing an object - but returnObjects options is not enabled!");
            }
            var r = this.options.returnedObjectHandler ? this.options.returnedObjectHandler(resUsedKey, res, _objectSpread$4(_objectSpread$4({}, options), {}, {
              ns: namespaces
            })) : "key '".concat(key, " (").concat(this.language, ")' returned an object instead of string.");
            if (returnDetails) {
              resolved.res = r;
              return resolved;
            }
            return r;
          }
          if (keySeparator) {
            var resTypeIsArray = resType === "[object Array]";
            var copy2 = resTypeIsArray ? [] : {};
            var newKeyToUse = resTypeIsArray ? resExactUsedKey : resUsedKey;
            for (var m in res) {
              if (Object.prototype.hasOwnProperty.call(res, m)) {
                var deepKey = "".concat(newKeyToUse).concat(keySeparator).concat(m);
                copy2[m] = this.translate(deepKey, _objectSpread$4(_objectSpread$4({}, options), {
                  joinArrays: false,
                  ns: namespaces
                }));
                if (copy2[m] === deepKey)
                  copy2[m] = res[m];
              }
            }
            res = copy2;
          }
        } else if (handleAsObjectInI18nFormat && typeof joinArrays === "string" && resType === "[object Array]") {
          res = res.join(joinArrays);
          if (res)
            res = this.extendTranslation(res, keys, options, lastKey);
        } else {
          var usedDefault = false;
          var usedKey = false;
          var needsPluralHandling = options.count !== void 0 && typeof options.count !== "string";
          var hasDefaultValue = Translator2.hasDefaultValue(options);
          var defaultValueSuffix = needsPluralHandling ? this.pluralResolver.getSuffix(lng, options.count, options) : "";
          var defaultValue = options["defaultValue".concat(defaultValueSuffix)] || options.defaultValue;
          if (!this.isValidLookup(res) && hasDefaultValue) {
            usedDefault = true;
            res = defaultValue;
          }
          if (!this.isValidLookup(res)) {
            usedKey = true;
            res = key;
          }
          var missingKeyNoValueFallbackToKey = options.missingKeyNoValueFallbackToKey || this.options.missingKeyNoValueFallbackToKey;
          var resForMissing = missingKeyNoValueFallbackToKey && usedKey ? void 0 : res;
          var updateMissing = hasDefaultValue && defaultValue !== res && this.options.updateMissing;
          if (usedKey || usedDefault || updateMissing) {
            this.logger.log(updateMissing ? "updateKey" : "missingKey", lng, namespace, key, updateMissing ? defaultValue : res);
            if (keySeparator) {
              var fk = this.resolve(key, _objectSpread$4(_objectSpread$4({}, options), {}, {
                keySeparator: false
              }));
              if (fk && fk.res)
                this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.");
            }
            var lngs = [];
            var fallbackLngs = this.languageUtils.getFallbackCodes(this.options.fallbackLng, options.lng || this.language);
            if (this.options.saveMissingTo === "fallback" && fallbackLngs && fallbackLngs[0]) {
              for (var i = 0; i < fallbackLngs.length; i++) {
                lngs.push(fallbackLngs[i]);
              }
            } else if (this.options.saveMissingTo === "all") {
              lngs = this.languageUtils.toResolveHierarchy(options.lng || this.language);
            } else {
              lngs.push(options.lng || this.language);
            }
            var send = function send2(l, k, specificDefaultValue) {
              var defaultForMissing = hasDefaultValue && specificDefaultValue !== res ? specificDefaultValue : resForMissing;
              if (_this2.options.missingKeyHandler) {
                _this2.options.missingKeyHandler(l, namespace, k, defaultForMissing, updateMissing, options);
              } else if (_this2.backendConnector && _this2.backendConnector.saveMissing) {
                _this2.backendConnector.saveMissing(l, namespace, k, defaultForMissing, updateMissing, options);
              }
              _this2.emit("missingKey", l, namespace, k, res);
            };
            if (this.options.saveMissing) {
              if (this.options.saveMissingPlurals && needsPluralHandling) {
                lngs.forEach(function(language) {
                  _this2.pluralResolver.getSuffixes(language, options).forEach(function(suffix) {
                    send([language], key + suffix, options["defaultValue".concat(suffix)] || defaultValue);
                  });
                });
              } else {
                send(lngs, key, defaultValue);
              }
            }
          }
          res = this.extendTranslation(res, keys, options, resolved, lastKey);
          if (usedKey && res === key && this.options.appendNamespaceToMissingKey)
            res = "".concat(namespace, ":").concat(key);
          if ((usedKey || usedDefault) && this.options.parseMissingKeyHandler) {
            if (this.options.compatibilityAPI !== "v1") {
              res = this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey ? "".concat(namespace, ":").concat(key) : key, usedDefault ? res : void 0);
            } else {
              res = this.options.parseMissingKeyHandler(res);
            }
          }
        }
        if (returnDetails) {
          resolved.res = res;
          return resolved;
        }
        return res;
      }
    }, {
      key: "extendTranslation",
      value: function extendTranslation(res, key, options, resolved, lastKey) {
        var _this3 = this;
        if (this.i18nFormat && this.i18nFormat.parse) {
          res = this.i18nFormat.parse(res, _objectSpread$4(_objectSpread$4({}, this.options.interpolation.defaultVariables), options), resolved.usedLng, resolved.usedNS, resolved.usedKey, {
            resolved
          });
        } else if (!options.skipInterpolation) {
          if (options.interpolation)
            this.interpolator.init(_objectSpread$4(_objectSpread$4({}, options), {
              interpolation: _objectSpread$4(_objectSpread$4({}, this.options.interpolation), options.interpolation)
            }));
          var skipOnVariables = typeof res === "string" && (options && options.interpolation && options.interpolation.skipOnVariables !== void 0 ? options.interpolation.skipOnVariables : this.options.interpolation.skipOnVariables);
          var nestBef;
          if (skipOnVariables) {
            var nb = res.match(this.interpolator.nestingRegexp);
            nestBef = nb && nb.length;
          }
          var data = options.replace && typeof options.replace !== "string" ? options.replace : options;
          if (this.options.interpolation.defaultVariables)
            data = _objectSpread$4(_objectSpread$4({}, this.options.interpolation.defaultVariables), data);
          res = this.interpolator.interpolate(res, data, options.lng || this.language, options);
          if (skipOnVariables) {
            var na = res.match(this.interpolator.nestingRegexp);
            var nestAft = na && na.length;
            if (nestBef < nestAft)
              options.nest = false;
          }
          if (options.nest !== false)
            res = this.interpolator.nest(res, function() {
              for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
                args[_key] = arguments[_key];
              }
              if (lastKey && lastKey[0] === args[0] && !options.context) {
                _this3.logger.warn("It seems you are nesting recursively key: ".concat(args[0], " in key: ").concat(key[0]));
                return null;
              }
              return _this3.translate.apply(_this3, args.concat([key]));
            }, options);
          if (options.interpolation)
            this.interpolator.reset();
        }
        var postProcess = options.postProcess || this.options.postProcess;
        var postProcessorNames = typeof postProcess === "string" ? [postProcess] : postProcess;
        if (res !== void 0 && res !== null && postProcessorNames && postProcessorNames.length && options.applyPostProcessor !== false) {
          res = postProcessor.handle(postProcessorNames, res, key, this.options && this.options.postProcessPassResolved ? _objectSpread$4({
            i18nResolved: resolved
          }, options) : options, this);
        }
        return res;
      }
    }, {
      key: "resolve",
      value: function resolve(keys) {
        var _this4 = this;
        var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        var found;
        var usedKey;
        var exactUsedKey;
        var usedLng;
        var usedNS;
        if (typeof keys === "string")
          keys = [keys];
        keys.forEach(function(k) {
          if (_this4.isValidLookup(found))
            return;
          var extracted = _this4.extractFromKey(k, options);
          var key = extracted.key;
          usedKey = key;
          var namespaces = extracted.namespaces;
          if (_this4.options.fallbackNS)
            namespaces = namespaces.concat(_this4.options.fallbackNS);
          var needsPluralHandling = options.count !== void 0 && typeof options.count !== "string";
          var needsZeroSuffixLookup = needsPluralHandling && !options.ordinal && options.count === 0 && _this4.pluralResolver.shouldUseIntlApi();
          var needsContextHandling = options.context !== void 0 && (typeof options.context === "string" || typeof options.context === "number") && options.context !== "";
          var codes2 = options.lngs ? options.lngs : _this4.languageUtils.toResolveHierarchy(options.lng || _this4.language, options.fallbackLng);
          namespaces.forEach(function(ns) {
            if (_this4.isValidLookup(found))
              return;
            usedNS = ns;
            if (!checkedLoadedFor["".concat(codes2[0], "-").concat(ns)] && _this4.utils && _this4.utils.hasLoadedNamespace && !_this4.utils.hasLoadedNamespace(usedNS)) {
              checkedLoadedFor["".concat(codes2[0], "-").concat(ns)] = true;
              _this4.logger.warn('key "'.concat(usedKey, '" for languages "').concat(codes2.join(", "), `" won't get resolved as namespace "`).concat(usedNS, '" was not yet loaded'), "This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");
            }
            codes2.forEach(function(code) {
              if (_this4.isValidLookup(found))
                return;
              usedLng = code;
              var finalKeys = [key];
              if (_this4.i18nFormat && _this4.i18nFormat.addLookupKeys) {
                _this4.i18nFormat.addLookupKeys(finalKeys, key, code, ns, options);
              } else {
                var pluralSuffix;
                if (needsPluralHandling)
                  pluralSuffix = _this4.pluralResolver.getSuffix(code, options.count, options);
                var zeroSuffix = "".concat(_this4.options.pluralSeparator, "zero");
                if (needsPluralHandling) {
                  finalKeys.push(key + pluralSuffix);
                  if (needsZeroSuffixLookup) {
                    finalKeys.push(key + zeroSuffix);
                  }
                }
                if (needsContextHandling) {
                  var contextKey = "".concat(key).concat(_this4.options.contextSeparator).concat(options.context);
                  finalKeys.push(contextKey);
                  if (needsPluralHandling) {
                    finalKeys.push(contextKey + pluralSuffix);
                    if (needsZeroSuffixLookup) {
                      finalKeys.push(contextKey + zeroSuffix);
                    }
                  }
                }
              }
              var possibleKey;
              while (possibleKey = finalKeys.pop()) {
                if (!_this4.isValidLookup(found)) {
                  exactUsedKey = possibleKey;
                  found = _this4.getResource(code, ns, possibleKey, options);
                }
              }
            });
          });
        });
        return {
          res: found,
          usedKey,
          exactUsedKey,
          usedLng,
          usedNS
        };
      }
    }, {
      key: "isValidLookup",
      value: function isValidLookup(res) {
        return res !== void 0 && !(!this.options.returnNull && res === null) && !(!this.options.returnEmptyString && res === "");
      }
    }, {
      key: "getResource",
      value: function getResource(code, ns, key) {
        var options = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : {};
        if (this.i18nFormat && this.i18nFormat.getResource)
          return this.i18nFormat.getResource(code, ns, key, options);
        return this.resourceStore.getResource(code, ns, key, options);
      }
    }], [{
      key: "hasDefaultValue",
      value: function hasDefaultValue(options) {
        var prefix = "defaultValue";
        for (var option in options) {
          if (Object.prototype.hasOwnProperty.call(options, option) && prefix === option.substring(0, prefix.length) && void 0 !== options[option]) {
            return true;
          }
        }
        return false;
      }
    }]);
    return Translator2;
  }(EventEmitter);
  function capitalize(string) {
    return string.charAt(0).toUpperCase() + string.slice(1);
  }
  var LanguageUtil = function() {
    function LanguageUtil2(options) {
      _classCallCheck$1(this, LanguageUtil2);
      this.options = options;
      this.supportedLngs = this.options.supportedLngs || false;
      this.logger = baseLogger.create("languageUtils");
    }
    _createClass$1(LanguageUtil2, [{
      key: "getScriptPartFromCode",
      value: function getScriptPartFromCode(code) {
        if (!code || code.indexOf("-") < 0)
          return null;
        var p2 = code.split("-");
        if (p2.length === 2)
          return null;
        p2.pop();
        if (p2[p2.length - 1].toLowerCase() === "x")
          return null;
        return this.formatLanguageCode(p2.join("-"));
      }
    }, {
      key: "getLanguagePartFromCode",
      value: function getLanguagePartFromCode(code) {
        if (!code || code.indexOf("-") < 0)
          return code;
        var p2 = code.split("-");
        return this.formatLanguageCode(p2[0]);
      }
    }, {
      key: "formatLanguageCode",
      value: function formatLanguageCode(code) {
        if (typeof code === "string" && code.indexOf("-") > -1) {
          var specialCases = ["hans", "hant", "latn", "cyrl", "cans", "mong", "arab"];
          var p2 = code.split("-");
          if (this.options.lowerCaseLng) {
            p2 = p2.map(function(part) {
              return part.toLowerCase();
            });
          } else if (p2.length === 2) {
            p2[0] = p2[0].toLowerCase();
            p2[1] = p2[1].toUpperCase();
            if (specialCases.indexOf(p2[1].toLowerCase()) > -1)
              p2[1] = capitalize(p2[1].toLowerCase());
          } else if (p2.length === 3) {
            p2[0] = p2[0].toLowerCase();
            if (p2[1].length === 2)
              p2[1] = p2[1].toUpperCase();
            if (p2[0] !== "sgn" && p2[2].length === 2)
              p2[2] = p2[2].toUpperCase();
            if (specialCases.indexOf(p2[1].toLowerCase()) > -1)
              p2[1] = capitalize(p2[1].toLowerCase());
            if (specialCases.indexOf(p2[2].toLowerCase()) > -1)
              p2[2] = capitalize(p2[2].toLowerCase());
          }
          return p2.join("-");
        }
        return this.options.cleanCode || this.options.lowerCaseLng ? code.toLowerCase() : code;
      }
    }, {
      key: "isSupportedCode",
      value: function isSupportedCode(code) {
        if (this.options.load === "languageOnly" || this.options.nonExplicitSupportedLngs) {
          code = this.getLanguagePartFromCode(code);
        }
        return !this.supportedLngs || !this.supportedLngs.length || this.supportedLngs.indexOf(code) > -1;
      }
    }, {
      key: "getBestMatchFromCodes",
      value: function getBestMatchFromCodes(codes2) {
        var _this = this;
        if (!codes2)
          return null;
        var found;
        codes2.forEach(function(code) {
          if (found)
            return;
          var cleanedLng = _this.formatLanguageCode(code);
          if (!_this.options.supportedLngs || _this.isSupportedCode(cleanedLng))
            found = cleanedLng;
        });
        if (!found && this.options.supportedLngs) {
          codes2.forEach(function(code) {
            if (found)
              return;
            var lngOnly = _this.getLanguagePartFromCode(code);
            if (_this.isSupportedCode(lngOnly))
              return found = lngOnly;
            found = _this.options.supportedLngs.find(function(supportedLng) {
              if (supportedLng.indexOf(lngOnly) === 0)
                return supportedLng;
            });
          });
        }
        if (!found)
          found = this.getFallbackCodes(this.options.fallbackLng)[0];
        return found;
      }
    }, {
      key: "getFallbackCodes",
      value: function getFallbackCodes(fallbacks, code) {
        if (!fallbacks)
          return [];
        if (typeof fallbacks === "function")
          fallbacks = fallbacks(code);
        if (typeof fallbacks === "string")
          fallbacks = [fallbacks];
        if (Object.prototype.toString.apply(fallbacks) === "[object Array]")
          return fallbacks;
        if (!code)
          return fallbacks["default"] || [];
        var found = fallbacks[code];
        if (!found)
          found = fallbacks[this.getScriptPartFromCode(code)];
        if (!found)
          found = fallbacks[this.formatLanguageCode(code)];
        if (!found)
          found = fallbacks[this.getLanguagePartFromCode(code)];
        if (!found)
          found = fallbacks["default"];
        return found || [];
      }
    }, {
      key: "toResolveHierarchy",
      value: function toResolveHierarchy(code, fallbackCode) {
        var _this2 = this;
        var fallbackCodes = this.getFallbackCodes(fallbackCode || this.options.fallbackLng || [], code);
        var codes2 = [];
        var addCode = function addCode2(c2) {
          if (!c2)
            return;
          if (_this2.isSupportedCode(c2)) {
            codes2.push(c2);
          } else {
            _this2.logger.warn("rejecting language code not found in supportedLngs: ".concat(c2));
          }
        };
        if (typeof code === "string" && code.indexOf("-") > -1) {
          if (this.options.load !== "languageOnly")
            addCode(this.formatLanguageCode(code));
          if (this.options.load !== "languageOnly" && this.options.load !== "currentOnly")
            addCode(this.getScriptPartFromCode(code));
          if (this.options.load !== "currentOnly")
            addCode(this.getLanguagePartFromCode(code));
        } else if (typeof code === "string") {
          addCode(this.formatLanguageCode(code));
        }
        fallbackCodes.forEach(function(fc) {
          if (codes2.indexOf(fc) < 0)
            addCode(_this2.formatLanguageCode(fc));
        });
        return codes2;
      }
    }]);
    return LanguageUtil2;
  }();
  var sets = [{
    lngs: ["ach", "ak", "am", "arn", "br", "fil", "gun", "ln", "mfe", "mg", "mi", "oc", "pt", "pt-BR", "tg", "tl", "ti", "tr", "uz", "wa"],
    nr: [1, 2],
    fc: 1
  }, {
    lngs: ["af", "an", "ast", "az", "bg", "bn", "ca", "da", "de", "dev", "el", "en", "eo", "es", "et", "eu", "fi", "fo", "fur", "fy", "gl", "gu", "ha", "hi", "hu", "hy", "ia", "it", "kk", "kn", "ku", "lb", "mai", "ml", "mn", "mr", "nah", "nap", "nb", "ne", "nl", "nn", "no", "nso", "pa", "pap", "pms", "ps", "pt-PT", "rm", "sco", "se", "si", "so", "son", "sq", "sv", "sw", "ta", "te", "tk", "ur", "yo"],
    nr: [1, 2],
    fc: 2
  }, {
    lngs: ["ay", "bo", "cgg", "fa", "ht", "id", "ja", "jbo", "ka", "km", "ko", "ky", "lo", "ms", "sah", "su", "th", "tt", "ug", "vi", "wo", "zh"],
    nr: [1],
    fc: 3
  }, {
    lngs: ["be", "bs", "cnr", "dz", "hr", "ru", "sr", "uk"],
    nr: [1, 2, 5],
    fc: 4
  }, {
    lngs: ["ar"],
    nr: [0, 1, 2, 3, 11, 100],
    fc: 5
  }, {
    lngs: ["cs", "sk"],
    nr: [1, 2, 5],
    fc: 6
  }, {
    lngs: ["csb", "pl"],
    nr: [1, 2, 5],
    fc: 7
  }, {
    lngs: ["cy"],
    nr: [1, 2, 3, 8],
    fc: 8
  }, {
    lngs: ["fr"],
    nr: [1, 2],
    fc: 9
  }, {
    lngs: ["ga"],
    nr: [1, 2, 3, 7, 11],
    fc: 10
  }, {
    lngs: ["gd"],
    nr: [1, 2, 3, 20],
    fc: 11
  }, {
    lngs: ["is"],
    nr: [1, 2],
    fc: 12
  }, {
    lngs: ["jv"],
    nr: [0, 1],
    fc: 13
  }, {
    lngs: ["kw"],
    nr: [1, 2, 3, 4],
    fc: 14
  }, {
    lngs: ["lt"],
    nr: [1, 2, 10],
    fc: 15
  }, {
    lngs: ["lv"],
    nr: [1, 2, 0],
    fc: 16
  }, {
    lngs: ["mk"],
    nr: [1, 2],
    fc: 17
  }, {
    lngs: ["mnk"],
    nr: [0, 1, 2],
    fc: 18
  }, {
    lngs: ["mt"],
    nr: [1, 2, 11, 20],
    fc: 19
  }, {
    lngs: ["or"],
    nr: [2, 1],
    fc: 2
  }, {
    lngs: ["ro"],
    nr: [1, 2, 20],
    fc: 20
  }, {
    lngs: ["sl"],
    nr: [5, 1, 2, 3],
    fc: 21
  }, {
    lngs: ["he", "iw"],
    nr: [1, 2, 20, 21],
    fc: 22
  }];
  var _rulesPluralsTypes = {
    1: function _(n) {
      return Number(n > 1);
    },
    2: function _(n) {
      return Number(n != 1);
    },
    3: function _(n) {
      return 0;
    },
    4: function _(n) {
      return Number(n % 10 == 1 && n % 100 != 11 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2);
    },
    5: function _(n) {
      return Number(n == 0 ? 0 : n == 1 ? 1 : n == 2 ? 2 : n % 100 >= 3 && n % 100 <= 10 ? 3 : n % 100 >= 11 ? 4 : 5);
    },
    6: function _(n) {
      return Number(n == 1 ? 0 : n >= 2 && n <= 4 ? 1 : 2);
    },
    7: function _(n) {
      return Number(n == 1 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2);
    },
    8: function _(n) {
      return Number(n == 1 ? 0 : n == 2 ? 1 : n != 8 && n != 11 ? 2 : 3);
    },
    9: function _(n) {
      return Number(n >= 2);
    },
    10: function _(n) {
      return Number(n == 1 ? 0 : n == 2 ? 1 : n < 7 ? 2 : n < 11 ? 3 : 4);
    },
    11: function _(n) {
      return Number(n == 1 || n == 11 ? 0 : n == 2 || n == 12 ? 1 : n > 2 && n < 20 ? 2 : 3);
    },
    12: function _(n) {
      return Number(n % 10 != 1 || n % 100 == 11);
    },
    13: function _(n) {
      return Number(n !== 0);
    },
    14: function _(n) {
      return Number(n == 1 ? 0 : n == 2 ? 1 : n == 3 ? 2 : 3);
    },
    15: function _(n) {
      return Number(n % 10 == 1 && n % 100 != 11 ? 0 : n % 10 >= 2 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2);
    },
    16: function _(n) {
      return Number(n % 10 == 1 && n % 100 != 11 ? 0 : n !== 0 ? 1 : 2);
    },
    17: function _(n) {
      return Number(n == 1 || n % 10 == 1 && n % 100 != 11 ? 0 : 1);
    },
    18: function _(n) {
      return Number(n == 0 ? 0 : n == 1 ? 1 : 2);
    },
    19: function _(n) {
      return Number(n == 1 ? 0 : n == 0 || n % 100 > 1 && n % 100 < 11 ? 1 : n % 100 > 10 && n % 100 < 20 ? 2 : 3);
    },
    20: function _(n) {
      return Number(n == 1 ? 0 : n == 0 || n % 100 > 0 && n % 100 < 20 ? 1 : 2);
    },
    21: function _(n) {
      return Number(n % 100 == 1 ? 1 : n % 100 == 2 ? 2 : n % 100 == 3 || n % 100 == 4 ? 3 : 0);
    },
    22: function _(n) {
      return Number(n == 1 ? 0 : n == 2 ? 1 : (n < 0 || n > 10) && n % 10 == 0 ? 2 : 3);
    }
  };
  var deprecatedJsonVersions = ["v1", "v2", "v3"];
  var suffixesOrder = {
    zero: 0,
    one: 1,
    two: 2,
    few: 3,
    many: 4,
    other: 5
  };
  function createRules() {
    var rules = {};
    sets.forEach(function(set2) {
      set2.lngs.forEach(function(l) {
        rules[l] = {
          numbers: set2.nr,
          plurals: _rulesPluralsTypes[set2.fc]
        };
      });
    });
    return rules;
  }
  var PluralResolver = function() {
    function PluralResolver2(languageUtils) {
      var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
      _classCallCheck$1(this, PluralResolver2);
      this.languageUtils = languageUtils;
      this.options = options;
      this.logger = baseLogger.create("pluralResolver");
      if ((!this.options.compatibilityJSON || this.options.compatibilityJSON === "v4") && (typeof Intl === "undefined" || !Intl.PluralRules)) {
        this.options.compatibilityJSON = "v3";
        this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.");
      }
      this.rules = createRules();
    }
    _createClass$1(PluralResolver2, [{
      key: "addRule",
      value: function addRule(lng, obj) {
        this.rules[lng] = obj;
      }
    }, {
      key: "getRule",
      value: function getRule(code) {
        var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        if (this.shouldUseIntlApi()) {
          try {
            return new Intl.PluralRules(code, {
              type: options.ordinal ? "ordinal" : "cardinal"
            });
          } catch (_unused) {
            return;
          }
        }
        return this.rules[code] || this.rules[this.languageUtils.getLanguagePartFromCode(code)];
      }
    }, {
      key: "needsPlural",
      value: function needsPlural(code) {
        var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        var rule = this.getRule(code, options);
        if (this.shouldUseIntlApi()) {
          return rule && rule.resolvedOptions().pluralCategories.length > 1;
        }
        return rule && rule.numbers.length > 1;
      }
    }, {
      key: "getPluralFormsOfKey",
      value: function getPluralFormsOfKey(code, key) {
        var options = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
        return this.getSuffixes(code, options).map(function(suffix) {
          return "".concat(key).concat(suffix);
        });
      }
    }, {
      key: "getSuffixes",
      value: function getSuffixes(code) {
        var _this = this;
        var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        var rule = this.getRule(code, options);
        if (!rule) {
          return [];
        }
        if (this.shouldUseIntlApi()) {
          return rule.resolvedOptions().pluralCategories.sort(function(pluralCategory1, pluralCategory2) {
            return suffixesOrder[pluralCategory1] - suffixesOrder[pluralCategory2];
          }).map(function(pluralCategory) {
            return "".concat(_this.options.prepend).concat(pluralCategory);
          });
        }
        return rule.numbers.map(function(number) {
          return _this.getSuffix(code, number, options);
        });
      }
    }, {
      key: "getSuffix",
      value: function getSuffix(code, count) {
        var options = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
        var rule = this.getRule(code, options);
        if (rule) {
          if (this.shouldUseIntlApi()) {
            return "".concat(this.options.prepend).concat(rule.select(count));
          }
          return this.getSuffixRetroCompatible(rule, count);
        }
        this.logger.warn("no plural rule found for: ".concat(code));
        return "";
      }
    }, {
      key: "getSuffixRetroCompatible",
      value: function getSuffixRetroCompatible(rule, count) {
        var _this2 = this;
        var idx = rule.noAbs ? rule.plurals(count) : rule.plurals(Math.abs(count));
        var suffix = rule.numbers[idx];
        if (this.options.simplifyPluralSuffix && rule.numbers.length === 2 && rule.numbers[0] === 1) {
          if (suffix === 2) {
            suffix = "plural";
          } else if (suffix === 1) {
            suffix = "";
          }
        }
        var returnSuffix = function returnSuffix2() {
          return _this2.options.prepend && suffix.toString() ? _this2.options.prepend + suffix.toString() : suffix.toString();
        };
        if (this.options.compatibilityJSON === "v1") {
          if (suffix === 1)
            return "";
          if (typeof suffix === "number")
            return "_plural_".concat(suffix.toString());
          return returnSuffix();
        } else if (this.options.compatibilityJSON === "v2") {
          return returnSuffix();
        } else if (this.options.simplifyPluralSuffix && rule.numbers.length === 2 && rule.numbers[0] === 1) {
          return returnSuffix();
        }
        return this.options.prepend && idx.toString() ? this.options.prepend + idx.toString() : idx.toString();
      }
    }, {
      key: "shouldUseIntlApi",
      value: function shouldUseIntlApi() {
        return !deprecatedJsonVersions.includes(this.options.compatibilityJSON);
      }
    }]);
    return PluralResolver2;
  }();
  function ownKeys$3(object, enumerableOnly) {
    var keys = Object.keys(object);
    if (Object.getOwnPropertySymbols) {
      var symbols = Object.getOwnPropertySymbols(object);
      enumerableOnly && (symbols = symbols.filter(function(sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      })), keys.push.apply(keys, symbols);
    }
    return keys;
  }
  function _objectSpread$3(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = null != arguments[i] ? arguments[i] : {};
      i % 2 ? ownKeys$3(Object(source), true).forEach(function(key) {
        _defineProperty$1(target, key, source[key]);
      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$3(Object(source)).forEach(function(key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
    return target;
  }
  var Interpolator = function() {
    function Interpolator2() {
      var options = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
      _classCallCheck$1(this, Interpolator2);
      this.logger = baseLogger.create("interpolator");
      this.options = options;
      this.format = options.interpolation && options.interpolation.format || function(value) {
        return value;
      };
      this.init(options);
    }
    _createClass$1(Interpolator2, [{
      key: "init",
      value: function init2() {
        var options = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
        if (!options.interpolation)
          options.interpolation = {
            escapeValue: true
          };
        var iOpts = options.interpolation;
        this.escape = iOpts.escape !== void 0 ? iOpts.escape : escape;
        this.escapeValue = iOpts.escapeValue !== void 0 ? iOpts.escapeValue : true;
        this.useRawValueToEscape = iOpts.useRawValueToEscape !== void 0 ? iOpts.useRawValueToEscape : false;
        this.prefix = iOpts.prefix ? regexEscape(iOpts.prefix) : iOpts.prefixEscaped || "{{";
        this.suffix = iOpts.suffix ? regexEscape(iOpts.suffix) : iOpts.suffixEscaped || "}}";
        this.formatSeparator = iOpts.formatSeparator ? iOpts.formatSeparator : iOpts.formatSeparator || ",";
        this.unescapePrefix = iOpts.unescapeSuffix ? "" : iOpts.unescapePrefix || "-";
        this.unescapeSuffix = this.unescapePrefix ? "" : iOpts.unescapeSuffix || "";
        this.nestingPrefix = iOpts.nestingPrefix ? regexEscape(iOpts.nestingPrefix) : iOpts.nestingPrefixEscaped || regexEscape("$t(");
        this.nestingSuffix = iOpts.nestingSuffix ? regexEscape(iOpts.nestingSuffix) : iOpts.nestingSuffixEscaped || regexEscape(")");
        this.nestingOptionsSeparator = iOpts.nestingOptionsSeparator ? iOpts.nestingOptionsSeparator : iOpts.nestingOptionsSeparator || ",";
        this.maxReplaces = iOpts.maxReplaces ? iOpts.maxReplaces : 1e3;
        this.alwaysFormat = iOpts.alwaysFormat !== void 0 ? iOpts.alwaysFormat : false;
        this.resetRegExp();
      }
    }, {
      key: "reset",
      value: function reset() {
        if (this.options)
          this.init(this.options);
      }
    }, {
      key: "resetRegExp",
      value: function resetRegExp() {
        var regexpStr = "".concat(this.prefix, "(.+?)").concat(this.suffix);
        this.regexp = new RegExp(regexpStr, "g");
        var regexpUnescapeStr = "".concat(this.prefix).concat(this.unescapePrefix, "(.+?)").concat(this.unescapeSuffix).concat(this.suffix);
        this.regexpUnescape = new RegExp(regexpUnescapeStr, "g");
        var nestingRegexpStr = "".concat(this.nestingPrefix, "(.+?)").concat(this.nestingSuffix);
        this.nestingRegexp = new RegExp(nestingRegexpStr, "g");
      }
    }, {
      key: "interpolate",
      value: function interpolate(str, data, lng, options) {
        var _this = this;
        var match2;
        var value;
        var replaces;
        var defaultData = this.options && this.options.interpolation && this.options.interpolation.defaultVariables || {};
        function regexSafe(val) {
          return val.replace(/\$/g, "$$$$");
        }
        var handleFormat = function handleFormat2(key) {
          if (key.indexOf(_this.formatSeparator) < 0) {
            var path = getPathWithDefaults(data, defaultData, key);
            return _this.alwaysFormat ? _this.format(path, void 0, lng, _objectSpread$3(_objectSpread$3(_objectSpread$3({}, options), data), {}, {
              interpolationkey: key
            })) : path;
          }
          var p2 = key.split(_this.formatSeparator);
          var k = p2.shift().trim();
          var f = p2.join(_this.formatSeparator).trim();
          return _this.format(getPathWithDefaults(data, defaultData, k), f, lng, _objectSpread$3(_objectSpread$3(_objectSpread$3({}, options), data), {}, {
            interpolationkey: k
          }));
        };
        this.resetRegExp();
        var missingInterpolationHandler = options && options.missingInterpolationHandler || this.options.missingInterpolationHandler;
        var skipOnVariables = options && options.interpolation && options.interpolation.skipOnVariables !== void 0 ? options.interpolation.skipOnVariables : this.options.interpolation.skipOnVariables;
        var todos = [{
          regex: this.regexpUnescape,
          safeValue: function safeValue(val) {
            return regexSafe(val);
          }
        }, {
          regex: this.regexp,
          safeValue: function safeValue(val) {
            return _this.escapeValue ? regexSafe(_this.escape(val)) : regexSafe(val);
          }
        }];
        todos.forEach(function(todo) {
          replaces = 0;
          while (match2 = todo.regex.exec(str)) {
            var matchedVar = match2[1].trim();
            value = handleFormat(matchedVar);
            if (value === void 0) {
              if (typeof missingInterpolationHandler === "function") {
                var temp = missingInterpolationHandler(str, match2, options);
                value = typeof temp === "string" ? temp : "";
              } else if (options && Object.prototype.hasOwnProperty.call(options, matchedVar)) {
                value = "";
              } else if (skipOnVariables) {
                value = match2[0];
                continue;
              } else {
                _this.logger.warn("missed to pass in variable ".concat(matchedVar, " for interpolating ").concat(str));
                value = "";
              }
            } else if (typeof value !== "string" && !_this.useRawValueToEscape) {
              value = makeString(value);
            }
            var safeValue = todo.safeValue(value);
            str = str.replace(match2[0], safeValue);
            if (skipOnVariables) {
              todo.regex.lastIndex += value.length;
              todo.regex.lastIndex -= match2[0].length;
            } else {
              todo.regex.lastIndex = 0;
            }
            replaces++;
            if (replaces >= _this.maxReplaces) {
              break;
            }
          }
        });
        return str;
      }
    }, {
      key: "nest",
      value: function nest(str, fc) {
        var _this2 = this;
        var options = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
        var match2;
        var value;
        var clonedOptions;
        function handleHasOptions(key, inheritedOptions) {
          var sep = this.nestingOptionsSeparator;
          if (key.indexOf(sep) < 0)
            return key;
          var c2 = key.split(new RegExp("".concat(sep, "[ ]*{")));
          var optionsString = "{".concat(c2[1]);
          key = c2[0];
          optionsString = this.interpolate(optionsString, clonedOptions);
          var matchedSingleQuotes = optionsString.match(/'/g);
          var matchedDoubleQuotes = optionsString.match(/"/g);
          if (matchedSingleQuotes && matchedSingleQuotes.length % 2 === 0 && !matchedDoubleQuotes || matchedDoubleQuotes.length % 2 !== 0) {
            optionsString = optionsString.replace(/'/g, '"');
          }
          try {
            clonedOptions = JSON.parse(optionsString);
            if (inheritedOptions)
              clonedOptions = _objectSpread$3(_objectSpread$3({}, inheritedOptions), clonedOptions);
          } catch (e) {
            this.logger.warn("failed parsing options string in nesting for key ".concat(key), e);
            return "".concat(key).concat(sep).concat(optionsString);
          }
          delete clonedOptions.defaultValue;
          return key;
        }
        while (match2 = this.nestingRegexp.exec(str)) {
          var formatters = [];
          clonedOptions = _objectSpread$3({}, options);
          clonedOptions = clonedOptions.replace && typeof clonedOptions.replace !== "string" ? clonedOptions.replace : clonedOptions;
          clonedOptions.applyPostProcessor = false;
          delete clonedOptions.defaultValue;
          var doReduce = false;
          if (match2[0].indexOf(this.formatSeparator) !== -1 && !/{.*}/.test(match2[1])) {
            var r = match2[1].split(this.formatSeparator).map(function(elem) {
              return elem.trim();
            });
            match2[1] = r.shift();
            formatters = r;
            doReduce = true;
          }
          value = fc(handleHasOptions.call(this, match2[1].trim(), clonedOptions), clonedOptions);
          if (value && match2[0] === str && typeof value !== "string")
            return value;
          if (typeof value !== "string")
            value = makeString(value);
          if (!value) {
            this.logger.warn("missed to resolve ".concat(match2[1], " for nesting ").concat(str));
            value = "";
          }
          if (doReduce) {
            value = formatters.reduce(function(v2, f) {
              return _this2.format(v2, f, options.lng, _objectSpread$3(_objectSpread$3({}, options), {}, {
                interpolationkey: match2[1].trim()
              }));
            }, value.trim());
          }
          str = str.replace(match2[0], value);
          this.regexp.lastIndex = 0;
        }
        return str;
      }
    }]);
    return Interpolator2;
  }();
  function ownKeys$2(object, enumerableOnly) {
    var keys = Object.keys(object);
    if (Object.getOwnPropertySymbols) {
      var symbols = Object.getOwnPropertySymbols(object);
      enumerableOnly && (symbols = symbols.filter(function(sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      })), keys.push.apply(keys, symbols);
    }
    return keys;
  }
  function _objectSpread$2(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = null != arguments[i] ? arguments[i] : {};
      i % 2 ? ownKeys$2(Object(source), true).forEach(function(key) {
        _defineProperty$1(target, key, source[key]);
      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$2(Object(source)).forEach(function(key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
    return target;
  }
  function parseFormatStr(formatStr) {
    var formatName = formatStr.toLowerCase().trim();
    var formatOptions = {};
    if (formatStr.indexOf("(") > -1) {
      var p2 = formatStr.split("(");
      formatName = p2[0].toLowerCase().trim();
      var optStr = p2[1].substring(0, p2[1].length - 1);
      if (formatName === "currency" && optStr.indexOf(":") < 0) {
        if (!formatOptions.currency)
          formatOptions.currency = optStr.trim();
      } else if (formatName === "relativetime" && optStr.indexOf(":") < 0) {
        if (!formatOptions.range)
          formatOptions.range = optStr.trim();
      } else {
        var opts = optStr.split(";");
        opts.forEach(function(opt) {
          if (!opt)
            return;
          var _opt$split = opt.split(":"), _opt$split2 = _toArray(_opt$split), key = _opt$split2[0], rest = _opt$split2.slice(1);
          var val = rest.join(":").trim().replace(/^'+|'+$/g, "");
          if (!formatOptions[key.trim()])
            formatOptions[key.trim()] = val;
          if (val === "false")
            formatOptions[key.trim()] = false;
          if (val === "true")
            formatOptions[key.trim()] = true;
          if (!isNaN(val))
            formatOptions[key.trim()] = parseInt(val, 10);
        });
      }
    }
    return {
      formatName,
      formatOptions
    };
  }
  function createCachedFormatter(fn) {
    var cache2 = {};
    return function invokeFormatter(val, lng, options) {
      var key = lng + JSON.stringify(options);
      var formatter = cache2[key];
      if (!formatter) {
        formatter = fn(lng, options);
        cache2[key] = formatter;
      }
      return formatter(val);
    };
  }
  var Formatter = function() {
    function Formatter2() {
      var options = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
      _classCallCheck$1(this, Formatter2);
      this.logger = baseLogger.create("formatter");
      this.options = options;
      this.formats = {
        number: createCachedFormatter(function(lng, opt) {
          var formatter = new Intl.NumberFormat(lng, _objectSpread$2({}, opt));
          return function(val) {
            return formatter.format(val);
          };
        }),
        currency: createCachedFormatter(function(lng, opt) {
          var formatter = new Intl.NumberFormat(lng, _objectSpread$2(_objectSpread$2({}, opt), {}, {
            style: "currency"
          }));
          return function(val) {
            return formatter.format(val);
          };
        }),
        datetime: createCachedFormatter(function(lng, opt) {
          var formatter = new Intl.DateTimeFormat(lng, _objectSpread$2({}, opt));
          return function(val) {
            return formatter.format(val);
          };
        }),
        relativetime: createCachedFormatter(function(lng, opt) {
          var formatter = new Intl.RelativeTimeFormat(lng, _objectSpread$2({}, opt));
          return function(val) {
            return formatter.format(val, opt.range || "day");
          };
        }),
        list: createCachedFormatter(function(lng, opt) {
          var formatter = new Intl.ListFormat(lng, _objectSpread$2({}, opt));
          return function(val) {
            return formatter.format(val);
          };
        })
      };
      this.init(options);
    }
    _createClass$1(Formatter2, [{
      key: "init",
      value: function init2(services) {
        var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {
          interpolation: {}
        };
        var iOpts = options.interpolation;
        this.formatSeparator = iOpts.formatSeparator ? iOpts.formatSeparator : iOpts.formatSeparator || ",";
      }
    }, {
      key: "add",
      value: function add2(name, fc) {
        this.formats[name.toLowerCase().trim()] = fc;
      }
    }, {
      key: "addCached",
      value: function addCached(name, fc) {
        this.formats[name.toLowerCase().trim()] = createCachedFormatter(fc);
      }
    }, {
      key: "format",
      value: function format(value, _format, lng) {
        var _this = this;
        var options = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : {};
        var formats = _format.split(this.formatSeparator);
        var result = formats.reduce(function(mem, f) {
          var _parseFormatStr = parseFormatStr(f), formatName = _parseFormatStr.formatName, formatOptions = _parseFormatStr.formatOptions;
          if (_this.formats[formatName]) {
            var formatted = mem;
            try {
              var valOptions = options && options.formatParams && options.formatParams[options.interpolationkey] || {};
              var l = valOptions.locale || valOptions.lng || options.locale || options.lng || lng;
              formatted = _this.formats[formatName](mem, l, _objectSpread$2(_objectSpread$2(_objectSpread$2({}, formatOptions), options), valOptions));
            } catch (error) {
              _this.logger.warn(error);
            }
            return formatted;
          } else {
            _this.logger.warn("there was no format function for ".concat(formatName));
          }
          return mem;
        }, value);
        return result;
      }
    }]);
    return Formatter2;
  }();
  function ownKeys$1(object, enumerableOnly) {
    var keys = Object.keys(object);
    if (Object.getOwnPropertySymbols) {
      var symbols = Object.getOwnPropertySymbols(object);
      enumerableOnly && (symbols = symbols.filter(function(sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      })), keys.push.apply(keys, symbols);
    }
    return keys;
  }
  function _objectSpread$1(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = null != arguments[i] ? arguments[i] : {};
      i % 2 ? ownKeys$1(Object(source), true).forEach(function(key) {
        _defineProperty$1(target, key, source[key]);
      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$1(Object(source)).forEach(function(key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
    return target;
  }
  function _createSuper$1(Derived) {
    var hasNativeReflectConstruct = _isNativeReflectConstruct$1();
    return function _createSuperInternal() {
      var Super = _getPrototypeOf(Derived), result;
      if (hasNativeReflectConstruct) {
        var NewTarget = _getPrototypeOf(this).constructor;
        result = Reflect.construct(Super, arguments, NewTarget);
      } else {
        result = Super.apply(this, arguments);
      }
      return _possibleConstructorReturn(this, result);
    };
  }
  function _isNativeReflectConstruct$1() {
    if (typeof Reflect === "undefined" || !Reflect.construct)
      return false;
    if (Reflect.construct.sham)
      return false;
    if (typeof Proxy === "function")
      return true;
    try {
      Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
      }));
      return true;
    } catch (e) {
      return false;
    }
  }
  function removePending(q, name) {
    if (q.pending[name] !== void 0) {
      delete q.pending[name];
      q.pendingCount--;
    }
  }
  var Connector = function(_EventEmitter) {
    _inherits(Connector2, _EventEmitter);
    var _super = _createSuper$1(Connector2);
    function Connector2(backend, store, services) {
      var _this;
      var options = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : {};
      _classCallCheck$1(this, Connector2);
      _this = _super.call(this);
      if (isIE10) {
        EventEmitter.call(_assertThisInitialized(_this));
      }
      _this.backend = backend;
      _this.store = store;
      _this.services = services;
      _this.languageUtils = services.languageUtils;
      _this.options = options;
      _this.logger = baseLogger.create("backendConnector");
      _this.waitingReads = [];
      _this.maxParallelReads = options.maxParallelReads || 10;
      _this.readingCalls = 0;
      _this.maxRetries = options.maxRetries >= 0 ? options.maxRetries : 5;
      _this.retryTimeout = options.retryTimeout >= 1 ? options.retryTimeout : 350;
      _this.state = {};
      _this.queue = [];
      if (_this.backend && _this.backend.init) {
        _this.backend.init(services, options.backend, options);
      }
      return _this;
    }
    _createClass$1(Connector2, [{
      key: "queueLoad",
      value: function queueLoad(languages, namespaces, options, callback) {
        var _this2 = this;
        var toLoad = {};
        var pending = {};
        var toLoadLanguages = {};
        var toLoadNamespaces = {};
        languages.forEach(function(lng) {
          var hasAllNamespaces = true;
          namespaces.forEach(function(ns) {
            var name = "".concat(lng, "|").concat(ns);
            if (!options.reload && _this2.store.hasResourceBundle(lng, ns)) {
              _this2.state[name] = 2;
            } else if (_this2.state[name] < 0)
              ;
            else if (_this2.state[name] === 1) {
              if (pending[name] === void 0)
                pending[name] = true;
            } else {
              _this2.state[name] = 1;
              hasAllNamespaces = false;
              if (pending[name] === void 0)
                pending[name] = true;
              if (toLoad[name] === void 0)
                toLoad[name] = true;
              if (toLoadNamespaces[ns] === void 0)
                toLoadNamespaces[ns] = true;
            }
          });
          if (!hasAllNamespaces)
            toLoadLanguages[lng] = true;
        });
        if (Object.keys(toLoad).length || Object.keys(pending).length) {
          this.queue.push({
            pending,
            pendingCount: Object.keys(pending).length,
            loaded: {},
            errors: [],
            callback
          });
        }
        return {
          toLoad: Object.keys(toLoad),
          pending: Object.keys(pending),
          toLoadLanguages: Object.keys(toLoadLanguages),
          toLoadNamespaces: Object.keys(toLoadNamespaces)
        };
      }
    }, {
      key: "loaded",
      value: function loaded(name, err, data) {
        var s = name.split("|");
        var lng = s[0];
        var ns = s[1];
        if (err)
          this.emit("failedLoading", lng, ns, err);
        if (data) {
          this.store.addResourceBundle(lng, ns, data);
        }
        this.state[name] = err ? -1 : 2;
        var loaded2 = {};
        this.queue.forEach(function(q) {
          pushPath(q.loaded, [lng], ns);
          removePending(q, name);
          if (err)
            q.errors.push(err);
          if (q.pendingCount === 0 && !q.done) {
            Object.keys(q.loaded).forEach(function(l) {
              if (!loaded2[l])
                loaded2[l] = {};
              var loadedKeys = q.loaded[l];
              if (loadedKeys.length) {
                loadedKeys.forEach(function(n) {
                  if (loaded2[l][n] === void 0)
                    loaded2[l][n] = true;
                });
              }
            });
            q.done = true;
            if (q.errors.length) {
              q.callback(q.errors);
            } else {
              q.callback();
            }
          }
        });
        this.emit("loaded", loaded2);
        this.queue = this.queue.filter(function(q) {
          return !q.done;
        });
      }
    }, {
      key: "read",
      value: function read(lng, ns, fcName) {
        var _this3 = this;
        var tried = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : 0;
        var wait = arguments.length > 4 && arguments[4] !== void 0 ? arguments[4] : this.retryTimeout;
        var callback = arguments.length > 5 ? arguments[5] : void 0;
        if (!lng.length)
          return callback(null, {});
        if (this.readingCalls >= this.maxParallelReads) {
          this.waitingReads.push({
            lng,
            ns,
            fcName,
            tried,
            wait,
            callback
          });
          return;
        }
        this.readingCalls++;
        var resolver = function resolver2(err, data) {
          _this3.readingCalls--;
          if (_this3.waitingReads.length > 0) {
            var next = _this3.waitingReads.shift();
            _this3.read(next.lng, next.ns, next.fcName, next.tried, next.wait, next.callback);
          }
          if (err && data && tried < _this3.maxRetries) {
            setTimeout(function() {
              _this3.read.call(_this3, lng, ns, fcName, tried + 1, wait * 2, callback);
            }, wait);
            return;
          }
          callback(err, data);
        };
        var fc = this.backend[fcName].bind(this.backend);
        if (fc.length === 2) {
          try {
            var r = fc(lng, ns);
            if (r && typeof r.then === "function") {
              r.then(function(data) {
                return resolver(null, data);
              })["catch"](resolver);
            } else {
              resolver(null, r);
            }
          } catch (err) {
            resolver(err);
          }
          return;
        }
        return fc(lng, ns, resolver);
      }
    }, {
      key: "prepareLoading",
      value: function prepareLoading(languages, namespaces) {
        var _this4 = this;
        var options = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
        var callback = arguments.length > 3 ? arguments[3] : void 0;
        if (!this.backend) {
          this.logger.warn("No backend was added via i18next.use. Will not load resources.");
          return callback && callback();
        }
        if (typeof languages === "string")
          languages = this.languageUtils.toResolveHierarchy(languages);
        if (typeof namespaces === "string")
          namespaces = [namespaces];
        var toLoad = this.queueLoad(languages, namespaces, options, callback);
        if (!toLoad.toLoad.length) {
          if (!toLoad.pending.length)
            callback();
          return null;
        }
        toLoad.toLoad.forEach(function(name) {
          _this4.loadOne(name);
        });
      }
    }, {
      key: "load",
      value: function load(languages, namespaces, callback) {
        this.prepareLoading(languages, namespaces, {}, callback);
      }
    }, {
      key: "reload",
      value: function reload(languages, namespaces, callback) {
        this.prepareLoading(languages, namespaces, {
          reload: true
        }, callback);
      }
    }, {
      key: "loadOne",
      value: function loadOne(name) {
        var _this5 = this;
        var prefix = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : "";
        var s = name.split("|");
        var lng = s[0];
        var ns = s[1];
        this.read(lng, ns, "read", void 0, void 0, function(err, data) {
          if (err)
            _this5.logger.warn("".concat(prefix, "loading namespace ").concat(ns, " for language ").concat(lng, " failed"), err);
          if (!err && data)
            _this5.logger.log("".concat(prefix, "loaded namespace ").concat(ns, " for language ").concat(lng), data);
          _this5.loaded(name, err, data);
        });
      }
    }, {
      key: "saveMissing",
      value: function saveMissing(languages, namespace, key, fallbackValue, isUpdate) {
        var options = arguments.length > 5 && arguments[5] !== void 0 ? arguments[5] : {};
        var clb = arguments.length > 6 && arguments[6] !== void 0 ? arguments[6] : function() {
        };
        if (this.services.utils && this.services.utils.hasLoadedNamespace && !this.services.utils.hasLoadedNamespace(namespace)) {
          this.logger.warn('did not save key "'.concat(key, '" as the namespace "').concat(namespace, '" was not yet loaded'), "This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");
          return;
        }
        if (key === void 0 || key === null || key === "")
          return;
        if (this.backend && this.backend.create) {
          var opts = _objectSpread$1(_objectSpread$1({}, options), {}, {
            isUpdate
          });
          var fc = this.backend.create.bind(this.backend);
          if (fc.length < 6) {
            try {
              var r;
              if (fc.length === 5) {
                r = fc(languages, namespace, key, fallbackValue, opts);
              } else {
                r = fc(languages, namespace, key, fallbackValue);
              }
              if (r && typeof r.then === "function") {
                r.then(function(data) {
                  return clb(null, data);
                })["catch"](clb);
              } else {
                clb(null, r);
              }
            } catch (err) {
              clb(err);
            }
          } else {
            fc(languages, namespace, key, fallbackValue, clb, opts);
          }
        }
        if (!languages || !languages[0])
          return;
        this.store.addResource(languages[0], namespace, key, fallbackValue);
      }
    }]);
    return Connector2;
  }(EventEmitter);
  function get() {
    return {
      debug: false,
      initImmediate: true,
      ns: ["translation"],
      defaultNS: ["translation"],
      fallbackLng: ["dev"],
      fallbackNS: false,
      supportedLngs: false,
      nonExplicitSupportedLngs: false,
      load: "all",
      preload: false,
      simplifyPluralSuffix: true,
      keySeparator: ".",
      nsSeparator: ":",
      pluralSeparator: "_",
      contextSeparator: "_",
      partialBundledLanguages: false,
      saveMissing: false,
      updateMissing: false,
      saveMissingTo: "fallback",
      saveMissingPlurals: true,
      missingKeyHandler: false,
      missingInterpolationHandler: false,
      postProcess: false,
      postProcessPassResolved: false,
      returnNull: true,
      returnEmptyString: true,
      returnObjects: false,
      joinArrays: false,
      returnedObjectHandler: false,
      parseMissingKeyHandler: false,
      appendNamespaceToMissingKey: false,
      appendNamespaceToCIMode: false,
      overloadTranslationOptionHandler: function handle(args) {
        var ret = {};
        if (_typeof$3(args[1]) === "object")
          ret = args[1];
        if (typeof args[1] === "string")
          ret.defaultValue = args[1];
        if (typeof args[2] === "string")
          ret.tDescription = args[2];
        if (_typeof$3(args[2]) === "object" || _typeof$3(args[3]) === "object") {
          var options = args[3] || args[2];
          Object.keys(options).forEach(function(key) {
            ret[key] = options[key];
          });
        }
        return ret;
      },
      interpolation: {
        escapeValue: true,
        format: function format(value, _format, lng, options) {
          return value;
        },
        prefix: "{{",
        suffix: "}}",
        formatSeparator: ",",
        unescapePrefix: "-",
        nestingPrefix: "$t(",
        nestingSuffix: ")",
        nestingOptionsSeparator: ",",
        maxReplaces: 1e3,
        skipOnVariables: true
      }
    };
  }
  function transformOptions(options) {
    if (typeof options.ns === "string")
      options.ns = [options.ns];
    if (typeof options.fallbackLng === "string")
      options.fallbackLng = [options.fallbackLng];
    if (typeof options.fallbackNS === "string")
      options.fallbackNS = [options.fallbackNS];
    if (options.supportedLngs && options.supportedLngs.indexOf("cimode") < 0) {
      options.supportedLngs = options.supportedLngs.concat(["cimode"]);
    }
    return options;
  }
  function ownKeys(object, enumerableOnly) {
    var keys = Object.keys(object);
    if (Object.getOwnPropertySymbols) {
      var symbols = Object.getOwnPropertySymbols(object);
      enumerableOnly && (symbols = symbols.filter(function(sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      })), keys.push.apply(keys, symbols);
    }
    return keys;
  }
  function _objectSpread(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = null != arguments[i] ? arguments[i] : {};
      i % 2 ? ownKeys(Object(source), true).forEach(function(key) {
        _defineProperty$1(target, key, source[key]);
      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function(key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
    return target;
  }
  function _createSuper(Derived) {
    var hasNativeReflectConstruct = _isNativeReflectConstruct();
    return function _createSuperInternal() {
      var Super = _getPrototypeOf(Derived), result;
      if (hasNativeReflectConstruct) {
        var NewTarget = _getPrototypeOf(this).constructor;
        result = Reflect.construct(Super, arguments, NewTarget);
      } else {
        result = Super.apply(this, arguments);
      }
      return _possibleConstructorReturn(this, result);
    };
  }
  function _isNativeReflectConstruct() {
    if (typeof Reflect === "undefined" || !Reflect.construct)
      return false;
    if (Reflect.construct.sham)
      return false;
    if (typeof Proxy === "function")
      return true;
    try {
      Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
      }));
      return true;
    } catch (e) {
      return false;
    }
  }
  function noop() {
  }
  function bindMemberFunctions(inst) {
    var mems = Object.getOwnPropertyNames(Object.getPrototypeOf(inst));
    mems.forEach(function(mem) {
      if (typeof inst[mem] === "function") {
        inst[mem] = inst[mem].bind(inst);
      }
    });
  }
  var I18n = function(_EventEmitter) {
    _inherits(I18n2, _EventEmitter);
    var _super = _createSuper(I18n2);
    function I18n2() {
      var _this;
      var options = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
      var callback = arguments.length > 1 ? arguments[1] : void 0;
      _classCallCheck$1(this, I18n2);
      _this = _super.call(this);
      if (isIE10) {
        EventEmitter.call(_assertThisInitialized(_this));
      }
      _this.options = transformOptions(options);
      _this.services = {};
      _this.logger = baseLogger;
      _this.modules = {
        external: []
      };
      bindMemberFunctions(_assertThisInitialized(_this));
      if (callback && !_this.isInitialized && !options.isClone) {
        if (!_this.options.initImmediate) {
          _this.init(options, callback);
          return _possibleConstructorReturn(_this, _assertThisInitialized(_this));
        }
        setTimeout(function() {
          _this.init(options, callback);
        }, 0);
      }
      return _this;
    }
    _createClass$1(I18n2, [{
      key: "init",
      value: function init2() {
        var _this2 = this;
        var options = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
        var callback = arguments.length > 1 ? arguments[1] : void 0;
        if (typeof options === "function") {
          callback = options;
          options = {};
        }
        if (!options.defaultNS && options.defaultNS !== false && options.ns) {
          if (typeof options.ns === "string") {
            options.defaultNS = options.ns;
          } else if (options.ns.indexOf("translation") < 0) {
            options.defaultNS = options.ns[0];
          }
        }
        var defOpts = get();
        this.options = _objectSpread(_objectSpread(_objectSpread({}, defOpts), this.options), transformOptions(options));
        if (this.options.compatibilityAPI !== "v1") {
          this.options.interpolation = _objectSpread(_objectSpread({}, defOpts.interpolation), this.options.interpolation);
        }
        if (options.keySeparator !== void 0) {
          this.options.userDefinedKeySeparator = options.keySeparator;
        }
        if (options.nsSeparator !== void 0) {
          this.options.userDefinedNsSeparator = options.nsSeparator;
        }
        function createClassOnDemand(ClassOrObject) {
          if (!ClassOrObject)
            return null;
          if (typeof ClassOrObject === "function")
            return new ClassOrObject();
          return ClassOrObject;
        }
        if (!this.options.isClone) {
          if (this.modules.logger) {
            baseLogger.init(createClassOnDemand(this.modules.logger), this.options);
          } else {
            baseLogger.init(null, this.options);
          }
          var formatter;
          if (this.modules.formatter) {
            formatter = this.modules.formatter;
          } else if (typeof Intl !== "undefined") {
            formatter = Formatter;
          }
          var lu = new LanguageUtil(this.options);
          this.store = new ResourceStore(this.options.resources, this.options);
          var s = this.services;
          s.logger = baseLogger;
          s.resourceStore = this.store;
          s.languageUtils = lu;
          s.pluralResolver = new PluralResolver(lu, {
            prepend: this.options.pluralSeparator,
            compatibilityJSON: this.options.compatibilityJSON,
            simplifyPluralSuffix: this.options.simplifyPluralSuffix
          });
          if (formatter && (!this.options.interpolation.format || this.options.interpolation.format === defOpts.interpolation.format)) {
            s.formatter = createClassOnDemand(formatter);
            s.formatter.init(s, this.options);
            this.options.interpolation.format = s.formatter.format.bind(s.formatter);
          }
          s.interpolator = new Interpolator(this.options);
          s.utils = {
            hasLoadedNamespace: this.hasLoadedNamespace.bind(this)
          };
          s.backendConnector = new Connector(createClassOnDemand(this.modules.backend), s.resourceStore, s, this.options);
          s.backendConnector.on("*", function(event) {
            for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
              args[_key - 1] = arguments[_key];
            }
            _this2.emit.apply(_this2, [event].concat(args));
          });
          if (this.modules.languageDetector) {
            s.languageDetector = createClassOnDemand(this.modules.languageDetector);
            if (s.languageDetector.init)
              s.languageDetector.init(s, this.options.detection, this.options);
          }
          if (this.modules.i18nFormat) {
            s.i18nFormat = createClassOnDemand(this.modules.i18nFormat);
            if (s.i18nFormat.init)
              s.i18nFormat.init(this);
          }
          this.translator = new Translator(this.services, this.options);
          this.translator.on("*", function(event) {
            for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
              args[_key2 - 1] = arguments[_key2];
            }
            _this2.emit.apply(_this2, [event].concat(args));
          });
          this.modules.external.forEach(function(m) {
            if (m.init)
              m.init(_this2);
          });
        }
        this.format = this.options.interpolation.format;
        if (!callback)
          callback = noop;
        if (this.options.fallbackLng && !this.services.languageDetector && !this.options.lng) {
          var codes2 = this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);
          if (codes2.length > 0 && codes2[0] !== "dev")
            this.options.lng = codes2[0];
        }
        if (!this.services.languageDetector && !this.options.lng) {
          this.logger.warn("init: no languageDetector is used and no lng is defined");
        }
        var storeApi = ["getResource", "hasResourceBundle", "getResourceBundle", "getDataByLanguage"];
        storeApi.forEach(function(fcName) {
          _this2[fcName] = function() {
            var _this2$store;
            return (_this2$store = _this2.store)[fcName].apply(_this2$store, arguments);
          };
        });
        var storeApiChained = ["addResource", "addResources", "addResourceBundle", "removeResourceBundle"];
        storeApiChained.forEach(function(fcName) {
          _this2[fcName] = function() {
            var _this2$store2;
            (_this2$store2 = _this2.store)[fcName].apply(_this2$store2, arguments);
            return _this2;
          };
        });
        var deferred = defer();
        var load = function load2() {
          var finish = function finish2(err, t) {
            if (_this2.isInitialized && !_this2.initializedStoreOnce)
              _this2.logger.warn("init: i18next is already initialized. You should call init just once!");
            _this2.isInitialized = true;
            if (!_this2.options.isClone)
              _this2.logger.log("initialized", _this2.options);
            _this2.emit("initialized", _this2.options);
            deferred.resolve(t);
            callback(err, t);
          };
          if (_this2.languages && _this2.options.compatibilityAPI !== "v1" && !_this2.isInitialized)
            return finish(null, _this2.t.bind(_this2));
          _this2.changeLanguage(_this2.options.lng, finish);
        };
        if (this.options.resources || !this.options.initImmediate) {
          load();
        } else {
          setTimeout(load, 0);
        }
        return deferred;
      }
    }, {
      key: "loadResources",
      value: function loadResources(language) {
        var _this3 = this;
        var callback = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : noop;
        var usedCallback = callback;
        var usedLng = typeof language === "string" ? language : this.language;
        if (typeof language === "function")
          usedCallback = language;
        if (!this.options.resources || this.options.partialBundledLanguages) {
          if (usedLng && usedLng.toLowerCase() === "cimode")
            return usedCallback();
          var toLoad = [];
          var append = function append2(lng) {
            if (!lng)
              return;
            var lngs = _this3.services.languageUtils.toResolveHierarchy(lng);
            lngs.forEach(function(l) {
              if (toLoad.indexOf(l) < 0)
                toLoad.push(l);
            });
          };
          if (!usedLng) {
            var fallbacks = this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);
            fallbacks.forEach(function(l) {
              return append(l);
            });
          } else {
            append(usedLng);
          }
          if (this.options.preload) {
            this.options.preload.forEach(function(l) {
              return append(l);
            });
          }
          this.services.backendConnector.load(toLoad, this.options.ns, function(e) {
            if (!e && !_this3.resolvedLanguage && _this3.language)
              _this3.setResolvedLanguage(_this3.language);
            usedCallback(e);
          });
        } else {
          usedCallback(null);
        }
      }
    }, {
      key: "reloadResources",
      value: function reloadResources(lngs, ns, callback) {
        var deferred = defer();
        if (!lngs)
          lngs = this.languages;
        if (!ns)
          ns = this.options.ns;
        if (!callback)
          callback = noop;
        this.services.backendConnector.reload(lngs, ns, function(err) {
          deferred.resolve();
          callback(err);
        });
        return deferred;
      }
    }, {
      key: "use",
      value: function use(module2) {
        if (!module2)
          throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");
        if (!module2.type)
          throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");
        if (module2.type === "backend") {
          this.modules.backend = module2;
        }
        if (module2.type === "logger" || module2.log && module2.warn && module2.error) {
          this.modules.logger = module2;
        }
        if (module2.type === "languageDetector") {
          this.modules.languageDetector = module2;
        }
        if (module2.type === "i18nFormat") {
          this.modules.i18nFormat = module2;
        }
        if (module2.type === "postProcessor") {
          postProcessor.addPostProcessor(module2);
        }
        if (module2.type === "formatter") {
          this.modules.formatter = module2;
        }
        if (module2.type === "3rdParty") {
          this.modules.external.push(module2);
        }
        return this;
      }
    }, {
      key: "setResolvedLanguage",
      value: function setResolvedLanguage(l) {
        if (!l || !this.languages)
          return;
        if (["cimode", "dev"].indexOf(l) > -1)
          return;
        for (var li = 0; li < this.languages.length; li++) {
          var lngInLngs = this.languages[li];
          if (["cimode", "dev"].indexOf(lngInLngs) > -1)
            continue;
          if (this.store.hasLanguageSomeTranslations(lngInLngs)) {
            this.resolvedLanguage = lngInLngs;
            break;
          }
        }
      }
    }, {
      key: "changeLanguage",
      value: function changeLanguage(lng, callback) {
        var _this4 = this;
        this.isLanguageChangingTo = lng;
        var deferred = defer();
        this.emit("languageChanging", lng);
        var setLngProps = function setLngProps2(l) {
          _this4.language = l;
          _this4.languages = _this4.services.languageUtils.toResolveHierarchy(l);
          _this4.resolvedLanguage = void 0;
          _this4.setResolvedLanguage(l);
        };
        var done = function done2(err, l) {
          if (l) {
            setLngProps(l);
            _this4.translator.changeLanguage(l);
            _this4.isLanguageChangingTo = void 0;
            _this4.emit("languageChanged", l);
            _this4.logger.log("languageChanged", l);
          } else {
            _this4.isLanguageChangingTo = void 0;
          }
          deferred.resolve(function() {
            return _this4.t.apply(_this4, arguments);
          });
          if (callback)
            callback(err, function() {
              return _this4.t.apply(_this4, arguments);
            });
        };
        var setLng = function setLng2(lngs) {
          if (!lng && !lngs && _this4.services.languageDetector)
            lngs = [];
          var l = typeof lngs === "string" ? lngs : _this4.services.languageUtils.getBestMatchFromCodes(lngs);
          if (l) {
            if (!_this4.language) {
              setLngProps(l);
            }
            if (!_this4.translator.language)
              _this4.translator.changeLanguage(l);
            if (_this4.services.languageDetector && _this4.services.languageDetector.cacheUserLanguage)
              _this4.services.languageDetector.cacheUserLanguage(l);
          }
          _this4.loadResources(l, function(err) {
            done(err, l);
          });
        };
        if (!lng && this.services.languageDetector && !this.services.languageDetector.async) {
          setLng(this.services.languageDetector.detect());
        } else if (!lng && this.services.languageDetector && this.services.languageDetector.async) {
          if (this.services.languageDetector.detect.length === 0) {
            this.services.languageDetector.detect().then(setLng);
          } else {
            this.services.languageDetector.detect(setLng);
          }
        } else {
          setLng(lng);
        }
        return deferred;
      }
    }, {
      key: "getFixedT",
      value: function getFixedT(lng, ns, keyPrefix) {
        var _this5 = this;
        var fixedT = function fixedT2(key, opts) {
          var options;
          if (_typeof$3(opts) !== "object") {
            for (var _len3 = arguments.length, rest = new Array(_len3 > 2 ? _len3 - 2 : 0), _key3 = 2; _key3 < _len3; _key3++) {
              rest[_key3 - 2] = arguments[_key3];
            }
            options = _this5.options.overloadTranslationOptionHandler([key, opts].concat(rest));
          } else {
            options = _objectSpread({}, opts);
          }
          options.lng = options.lng || fixedT2.lng;
          options.lngs = options.lngs || fixedT2.lngs;
          options.ns = options.ns || fixedT2.ns;
          options.keyPrefix = options.keyPrefix || keyPrefix || fixedT2.keyPrefix;
          var keySeparator = _this5.options.keySeparator || ".";
          var resultKey;
          if (options.keyPrefix && Array.isArray(key)) {
            resultKey = key.map(function(k) {
              return "".concat(options.keyPrefix).concat(keySeparator).concat(k);
            });
          } else {
            resultKey = options.keyPrefix ? "".concat(options.keyPrefix).concat(keySeparator).concat(key) : key;
          }
          return _this5.t(resultKey, options);
        };
        if (typeof lng === "string") {
          fixedT.lng = lng;
        } else {
          fixedT.lngs = lng;
        }
        fixedT.ns = ns;
        fixedT.keyPrefix = keyPrefix;
        return fixedT;
      }
    }, {
      key: "t",
      value: function t() {
        var _this$translator;
        return this.translator && (_this$translator = this.translator).translate.apply(_this$translator, arguments);
      }
    }, {
      key: "exists",
      value: function exists() {
        var _this$translator2;
        return this.translator && (_this$translator2 = this.translator).exists.apply(_this$translator2, arguments);
      }
    }, {
      key: "setDefaultNamespace",
      value: function setDefaultNamespace(ns) {
        this.options.defaultNS = ns;
      }
    }, {
      key: "hasLoadedNamespace",
      value: function hasLoadedNamespace(ns) {
        var _this6 = this;
        var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        if (!this.isInitialized) {
          this.logger.warn("hasLoadedNamespace: i18next was not initialized", this.languages);
          return false;
        }
        if (!this.languages || !this.languages.length) {
          this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty", this.languages);
          return false;
        }
        var lng = this.resolvedLanguage || this.languages[0];
        var fallbackLng = this.options ? this.options.fallbackLng : false;
        var lastLng = this.languages[this.languages.length - 1];
        if (lng.toLowerCase() === "cimode")
          return true;
        var loadNotPending = function loadNotPending2(l, n) {
          var loadState = _this6.services.backendConnector.state["".concat(l, "|").concat(n)];
          return loadState === -1 || loadState === 2;
        };
        if (options.precheck) {
          var preResult = options.precheck(this, loadNotPending);
          if (preResult !== void 0)
            return preResult;
        }
        if (this.hasResourceBundle(lng, ns))
          return true;
        if (!this.services.backendConnector.backend || this.options.resources && !this.options.partialBundledLanguages)
          return true;
        if (loadNotPending(lng, ns) && (!fallbackLng || loadNotPending(lastLng, ns)))
          return true;
        return false;
      }
    }, {
      key: "loadNamespaces",
      value: function loadNamespaces(ns, callback) {
        var _this7 = this;
        var deferred = defer();
        if (!this.options.ns) {
          if (callback)
            callback();
          return Promise.resolve();
        }
        if (typeof ns === "string")
          ns = [ns];
        ns.forEach(function(n) {
          if (_this7.options.ns.indexOf(n) < 0)
            _this7.options.ns.push(n);
        });
        this.loadResources(function(err) {
          deferred.resolve();
          if (callback)
            callback(err);
        });
        return deferred;
      }
    }, {
      key: "loadLanguages",
      value: function loadLanguages(lngs, callback) {
        var deferred = defer();
        if (typeof lngs === "string")
          lngs = [lngs];
        var preloaded = this.options.preload || [];
        var newLngs = lngs.filter(function(lng) {
          return preloaded.indexOf(lng) < 0;
        });
        if (!newLngs.length) {
          if (callback)
            callback();
          return Promise.resolve();
        }
        this.options.preload = preloaded.concat(newLngs);
        this.loadResources(function(err) {
          deferred.resolve();
          if (callback)
            callback(err);
        });
        return deferred;
      }
    }, {
      key: "dir",
      value: function dir(lng) {
        if (!lng)
          lng = this.resolvedLanguage || (this.languages && this.languages.length > 0 ? this.languages[0] : this.language);
        if (!lng)
          return "rtl";
        var rtlLngs = ["ar", "shu", "sqr", "ssh", "xaa", "yhd", "yud", "aao", "abh", "abv", "acm", "acq", "acw", "acx", "acy", "adf", "ads", "aeb", "aec", "afb", "ajp", "apc", "apd", "arb", "arq", "ars", "ary", "arz", "auz", "avl", "ayh", "ayl", "ayn", "ayp", "bbz", "pga", "he", "iw", "ps", "pbt", "pbu", "pst", "prp", "prd", "ug", "ur", "ydd", "yds", "yih", "ji", "yi", "hbo", "men", "xmn", "fa", "jpr", "peo", "pes", "prs", "dv", "sam", "ckb"];
        var languageUtils = this.services && this.services.languageUtils || new LanguageUtil(get());
        return rtlLngs.indexOf(languageUtils.getLanguagePartFromCode(lng)) > -1 || lng.toLowerCase().indexOf("-arab") > 1 ? "rtl" : "ltr";
      }
    }, {
      key: "cloneInstance",
      value: function cloneInstance() {
        var _this8 = this;
        var options = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
        var callback = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : noop;
        var mergedOptions = _objectSpread(_objectSpread(_objectSpread({}, this.options), options), {
          isClone: true
        });
        var clone2 = new I18n2(mergedOptions);
        if (options.debug !== void 0 || options.prefix !== void 0) {
          clone2.logger = clone2.logger.clone(options);
        }
        var membersToCopy = ["store", "services", "language"];
        membersToCopy.forEach(function(m) {
          clone2[m] = _this8[m];
        });
        clone2.services = _objectSpread({}, this.services);
        clone2.services.utils = {
          hasLoadedNamespace: clone2.hasLoadedNamespace.bind(clone2)
        };
        clone2.translator = new Translator(clone2.services, clone2.options);
        clone2.translator.on("*", function(event) {
          for (var _len4 = arguments.length, args = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {
            args[_key4 - 1] = arguments[_key4];
          }
          clone2.emit.apply(clone2, [event].concat(args));
        });
        clone2.init(mergedOptions, callback);
        clone2.translator.options = clone2.options;
        clone2.translator.backendConnector.services.utils = {
          hasLoadedNamespace: clone2.hasLoadedNamespace.bind(clone2)
        };
        return clone2;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        return {
          options: this.options,
          store: this.store,
          language: this.language,
          languages: this.languages,
          resolvedLanguage: this.resolvedLanguage
        };
      }
    }]);
    return I18n2;
  }(EventEmitter);
  _defineProperty$1(I18n, "createInstance", function() {
    var options = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
    var callback = arguments.length > 1 ? arguments[1] : void 0;
    return new I18n(options, callback);
  });
  var instance = I18n.createInstance();
  instance.createInstance = I18n.createInstance;
  instance.createInstance;
  instance.dir;
  instance.init;
  instance.loadResources;
  instance.reloadResources;
  instance.use;
  instance.changeLanguage;
  instance.getFixedT;
  instance.t;
  instance.exists;
  instance.setDefaultNamespace;
  instance.hasLoadedNamespace;
  instance.loadNamespaces;
  instance.loadLanguages;
  const themesApiFixture = () => ({
    ogcServers: {
      "source for config://my_maps?category_id=106": {
        url: "https://ws.geoportail.lu/mymaps?category_id=106",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=106",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=501": {
        url: "https://ws.geoportail.lu/mymaps?category_id=501",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=501",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=302": {
        url: "https://ws.geoportail.lu/mymaps?category_id=302",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=302",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=81": {
        url: "https://ws.geoportail.lu/mymaps?category_id=81",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=81",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=160": {
        url: "https://ws.geoportail.lu/mymaps?category_id=160",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=160",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=172": {
        url: "https://ws.geoportail.lu/mymaps?category_id=172",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=172",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=990": {
        url: "https://ws.geoportail.lu/mymaps?category_id=990",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=990",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=170": {
        url: "https://ws.geoportail.lu/mymaps?category_id=170",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=170",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=71": {
        url: "https://ws.geoportail.lu/mymaps?category_id=71",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=71",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=23": {
        url: "https://ws.geoportail.lu/mymaps?category_id=23",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=23",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=165": {
        url: "https://ws.geoportail.lu/mymaps?category_id=165",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=165",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=154": {
        url: "https://ws.geoportail.lu/mymaps?category_id=154",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=154",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=250": {
        url: "https://ws.geoportail.lu/mymaps?category_id=250",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=250",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=994": {
        url: "https://ws.geoportail.lu/mymaps?category_id=994",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=994",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=158": {
        url: "https://ws.geoportail.lu/mymaps?category_id=158",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=158",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=161": {
        url: "https://ws.geoportail.lu/mymaps?category_id=161",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=161",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=173": {
        url: "https://ws.geoportail.lu/mymaps?category_id=173",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=173",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=183": {
        url: "https://ws.geoportail.lu/mymaps?category_id=183",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=183",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=999": {
        url: "https://ws.geoportail.lu/mymaps?category_id=999",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=999",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=164": {
        url: "https://ws.geoportail.lu/mymaps?category_id=164",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=164",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=108": {
        url: "https://ws.geoportail.lu/mymaps?category_id=108",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=108",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=251": {
        url: "https://ws.geoportail.lu/mymaps?category_id=251",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=251",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=24": {
        url: "https://ws.geoportail.lu/mymaps?category_id=24",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=24",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=79": {
        url: "https://ws.geoportail.lu/mymaps?category_id=79",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=79",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=152": {
        url: "https://ws.geoportail.lu/mymaps?category_id=152",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=152",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=73": {
        url: "https://ws.geoportail.lu/mymaps?category_id=73",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=73",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=80": {
        url: "https://ws.geoportail.lu/mymaps?category_id=80",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=80",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=156": {
        url: "https://ws.geoportail.lu/mymaps?category_id=156",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=156",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=157": {
        url: "https://ws.geoportail.lu/mymaps?category_id=157",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=157",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=109": {
        url: "https://ws.geoportail.lu/mymaps?category_id=109",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=109",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=503": {
        url: "https://ws.geoportail.lu/mymaps?category_id=503",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=503",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=117": {
        url: "https://ws.geoportail.lu/mymaps?category_id=117",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=117",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=506": {
        url: "https://ws.geoportail.lu/mymaps?category_id=506",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=506",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=301": {
        url: "https://ws.geoportail.lu/mymaps?category_id=301",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=301",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=168": {
        url: "https://ws.geoportail.lu/mymaps?category_id=168",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=168",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=500": {
        url: "https://ws.geoportail.lu/mymaps?category_id=500",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=500",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=159": {
        url: "https://ws.geoportail.lu/mymaps?category_id=159",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=159",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=504": {
        url: "https://ws.geoportail.lu/mymaps?category_id=504",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=504",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=260": {
        url: "https://ws.geoportail.lu/mymaps?category_id=260",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=260",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=171": {
        url: "https://ws.geoportail.lu/mymaps?category_id=171",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=171",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=30": {
        url: "https://ws.geoportail.lu/mymaps?category_id=30",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=30",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=9": {
        url: "https://ws.geoportail.lu/mymaps?category_id=9",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=9",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=270": {
        url: "https://ws.geoportail.lu/mymaps?category_id=270",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=270",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=8": {
        url: "https://ws.geoportail.lu/mymaps?category_id=8",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=8",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=502": {
        url: "https://ws.geoportail.lu/mymaps?category_id=502",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=502",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=33": {
        url: "https://ws.geoportail.lu/mymaps?category_id=33",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=33",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=167": {
        url: "https://ws.geoportail.lu/mymaps?category_id=167",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=167",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=184": {
        url: "https://ws.geoportail.lu/mymaps?category_id=184",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=184",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=510": {
        url: "https://ws.geoportail.lu/mymaps?category_id=510",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=510",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=120": {
        url: "https://ws.geoportail.lu/mymaps?category_id=120",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=120",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=186": {
        url: "https://ws.geoportail.lu/mymaps?category_id=186",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=186",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=187": {
        url: "https://ws.geoportail.lu/mymaps?category_id=187",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=187",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=188": {
        url: "https://ws.geoportail.lu/mymaps?category_id=188",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=188",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=185": {
        url: "https://ws.geoportail.lu/mymaps?category_id=185",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=185",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=992": {
        url: "https://ws.geoportail.lu/mymaps?category_id=992",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=992",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=150": {
        url: "https://ws.geoportail.lu/mymaps?category_id=150",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=150",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=31": {
        url: "https://ws.geoportail.lu/mymaps?category_id=31",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=31",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=153": {
        url: "https://ws.geoportail.lu/mymaps?category_id=153",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=153",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=72": {
        url: "https://ws.geoportail.lu/mymaps?category_id=72",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=72",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=505": {
        url: "https://ws.geoportail.lu/mymaps?category_id=505",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=505",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=162": {
        url: "https://ws.geoportail.lu/mymaps?category_id=162",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=162",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=77": {
        url: "https://ws.geoportail.lu/mymaps?category_id=77",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=77",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=155": {
        url: "https://ws.geoportail.lu/mymaps?category_id=155",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=155",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=402": {
        url: "https://ws.geoportail.lu/mymaps?category_id=402",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=402",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=151": {
        url: "https://ws.geoportail.lu/mymaps?category_id=151",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=151",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=70": {
        url: "https://ws.geoportail.lu/mymaps?category_id=70",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=70",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=300": {
        url: "https://ws.geoportail.lu/mymaps?category_id=300",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=300",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=74": {
        url: "https://ws.geoportail.lu/mymaps?category_id=74",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=74",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=182": {
        url: "https://ws.geoportail.lu/mymaps?category_id=182",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=182",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=78": {
        url: "https://ws.geoportail.lu/mymaps?category_id=78",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=78",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=20": {
        url: "https://ws.geoportail.lu/mymaps?category_id=20",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=20",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=180": {
        url: "https://ws.geoportail.lu/mymaps?category_id=180",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=180",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=110": {
        url: "https://ws.geoportail.lu/mymaps?category_id=110",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=110",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=169": {
        url: "https://ws.geoportail.lu/mymaps?category_id=169",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=169",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=181": {
        url: "https://ws.geoportail.lu/mymaps?category_id=181",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=181",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=993": {
        url: "https://ws.geoportail.lu/mymaps?category_id=993",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=993",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=163": {
        url: "https://ws.geoportail.lu/mymaps?category_id=163",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=163",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=76": {
        url: "https://ws.geoportail.lu/mymaps?category_id=76",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=76",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for https://wmts3.geoportail.lu/mapproxy_4_v3/service": {
        url: "https://wmts3.geoportail.lu/mapproxy_4_v3/service",
        urlWfs: "https://wmts3.geoportail.lu/mapproxy_4_v3/service",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=403": {
        url: "https://ws.geoportail.lu/mymaps?category_id=403",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=403",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=404": {
        url: "https://ws.geoportail.lu/mymaps?category_id=404",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=404",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=32": {
        url: "https://ws.geoportail.lu/mymaps?category_id=32",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=32",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=991": {
        url: "https://ws.geoportail.lu/mymaps?category_id=991",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=991",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=400": {
        url: "https://ws.geoportail.lu/mymaps?category_id=400",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=400",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=401": {
        url: "https://ws.geoportail.lu/mymaps?category_id=401",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=401",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=166": {
        url: "https://ws.geoportail.lu/mymaps?category_id=166",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=166",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=19": {
        url: "https://ws.geoportail.lu/mymaps?category_id=19",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=19",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=107": {
        url: "https://ws.geoportail.lu/mymaps?category_id=107",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=107",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=6": {
        url: "https://ws.geoportail.lu/mymaps?category_id=6",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=6",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=4": {
        url: "https://ws.geoportail.lu/mymaps?category_id=4",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=4",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=18": {
        url: "https://ws.geoportail.lu/mymaps?category_id=18",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=18",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=13": {
        url: "https://ws.geoportail.lu/mymaps?category_id=13",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=13",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=12": {
        url: "https://ws.geoportail.lu/mymaps?category_id=12",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=12",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=10": {
        url: "https://ws.geoportail.lu/mymaps?category_id=10",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=10",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=7": {
        url: "https://ws.geoportail.lu/mymaps?category_id=7",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=7",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=22": {
        url: "https://ws.geoportail.lu/mymaps?category_id=22",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=22",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=16": {
        url: "https://ws.geoportail.lu/mymaps?category_id=16",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=16",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=17": {
        url: "https://ws.geoportail.lu/mymaps?category_id=17",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=17",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=41": {
        url: "https://ws.geoportail.lu/mymaps?category_id=41",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=41",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=121": {
        url: "https://ws.geoportail.lu/mymaps?category_id=121",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=121",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=122": {
        url: "https://ws.geoportail.lu/mymaps?category_id=122",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=122",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=123": {
        url: "https://ws.geoportail.lu/mymaps?category_id=123",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=123",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=124": {
        url: "https://ws.geoportail.lu/mymaps?category_id=124",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=124",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=125": {
        url: "https://ws.geoportail.lu/mymaps?category_id=125",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=125",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=126": {
        url: "https://ws.geoportail.lu/mymaps?category_id=126",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=126",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=127": {
        url: "https://ws.geoportail.lu/mymaps?category_id=127",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=127",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for image/jpeg": {
        url: "https://map.geoportail.lu/mapserv_proxy?ogcserver=source+for+image%2Fjpeg&cache_version=0b3affb2592f45f6a379cac74b45a07e",
        urlWfs: "https://map.geoportail.lu/mapserv_proxy?ogcserver=source+for+image%2Fjpeg&cache_version=0b3affb2592f45f6a379cac74b45a07e",
        type: "mapserver",
        credential: true,
        imageType: "image/jpeg",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=128": {
        url: "https://ws.geoportail.lu/mymaps?category_id=128",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=128",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=129": {
        url: "https://ws.geoportail.lu/mymaps?category_id=129",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=129",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=130": {
        url: "https://ws.geoportail.lu/mymaps?category_id=130",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=130",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=131": {
        url: "https://ws.geoportail.lu/mymaps?category_id=131",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=131",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=18,19": {
        url: "https://ws.geoportail.lu/mymaps?category_id=18,19",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=18,19",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=117,501": {
        url: "https://ws.geoportail.lu/mymaps?category_id=117,501",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=117,501",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=189": {
        url: "https://ws.geoportail.lu/mymaps?category_id=189",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=189",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "Internal WMS Geoserver": {
        url: "https://map.geoportail.lu/ogcproxywms",
        urlWfs: "https://map.geoportail.lu/ogcproxywms",
        type: "geoserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "Internal WMS": {
        url: "https://map.geoportail.lu/ogcproxywms",
        urlWfs: "https://map.geoportail.lu/ogcproxywms",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=700": {
        url: "https://ws.geoportail.lu/mymaps?category_id=700",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=700",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=25": {
        url: "https://ws.geoportail.lu/mymaps?category_id=25",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=25",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=42": {
        url: "https://ws.geoportail.lu/mymaps?category_id=42",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=42",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=43": {
        url: "https://ws.geoportail.lu/mymaps?category_id=43",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=43",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=11,43": {
        url: "https://ws.geoportail.lu/mymaps?category_id=11,43",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=11,43",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: true,
        namespace: null,
        attributes: null
      },
      "source for image/png": {
        url: "https://map.geoportail.lu/mapserv_proxy?ogcserver=source+for+image%2Fpng&cache_version=0b3affb2592f45f6a379cac74b45a07e",
        urlWfs: "https://map.geoportail.lu/mapserv_proxy?ogcserver=source+for+image%2Fpng&cache_version=0b3affb2592f45f6a379cac74b45a07e",
        type: "mapserver",
        credential: true,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      },
      "source for config://my_maps?category_id=132": {
        url: "https://ws.geoportail.lu/mymaps?category_id=132",
        urlWfs: "https://ws.geoportail.lu/mymaps?category_id=132",
        type: "mapserver",
        credential: false,
        imageType: "image/png",
        wfsSupport: false,
        isSingleTile: false,
        namespace: null,
        attributes: null
      }
    },
    themes: [
      {
        id: 116,
        name: "main",
        icon: "main",
        children: [
          {
            id: 242,
            name: "basisden",
            children: [
              {
                id: 309,
                name: "administrative_einheiten",
                children: [
                  {
                    id: 269,
                    name: "communes_labels",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "17c7d883-ff7f-4b48-a894-46bea40d2e49"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "communes_labels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "communes_labels__COMMUNES_LABELS"
                      }
                    ]
                  },
                  {
                    id: 302,
                    name: "communes",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "de5373d6-340f-4203-a065-da7550a03cc4_2049"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "communes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "communes__COMMUNES"
                      }
                    ]
                  },
                  {
                    id: 346,
                    name: "cantons_labels",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "3af20a80-be4a-4819-a42b-18e49af799aa"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "cantons_labels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cantons_labels__CANTONS_LABELS"
                      }
                    ]
                  },
                  {
                    id: 329,
                    name: "cantons",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "e8a034e8-f986-4745-a848-b7ef30ce2740"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "CANTONS",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cantons__CANTONS"
                      }
                    ]
                  },
                  {
                    id: 268,
                    name: "districts_labels",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "c42842e2-834a-427a-99f6-eb8cb79d1db4"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "districts_labels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "districts_labels__DISTRICTS_LABELS"
                      }
                    ]
                  },
                  {
                    id: 354,
                    name: "districts",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "b9edd03f-3aef-4fd6-a3d9-db076b1cf237"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "districts",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "districts__DISTRICTS"
                      }
                    ]
                  },
                  {
                    id: 349,
                    name: "country",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "4c9b3c0b-85d4-447d-a68c-7416869f8d9b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "country",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "country__PAYS"
                      }
                    ]
                  },
                  {
                    id: 732,
                    name: "limadmin_judiciaire",
                    metadata: {
                      metadata_id: "235c0ac9-5bf6-45b6-9ceb-8680a07944ec"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "limadmin_judiciaire",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "limadmin_judiciaire__ARRONDISSEMENTS JUDICIAIRES"
                      }
                    ]
                  },
                  {
                    id: 733,
                    name: "limadmin_legislatif",
                    metadata: {
                      metadata_id: "627b78d9-ae18-4be2-9a69-02aa6d4e38bb"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "limadmin_legislatif",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "limadmin_legislatif__CIRCONSCRIPTIONS LEGISLATIVES"
                      }
                    ]
                  },
                  {
                    id: 744,
                    name: "tour_ort",
                    metadata: {
                      legend_name: "ort",
                      metadata_id: "44dbfde5-664e-4e45-8802-3d60b52eb9cb"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_ort",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_ort__0"
                      },
                      {
                        name: "tour_ort__1"
                      }
                    ]
                  },
                  {
                    id: 746,
                    name: "tour_leader",
                    metadata: {
                      legend_name: "leader",
                      metadata_id: "a48aec89-7341-459e-a7d3-0e572982b255"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_leader",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_leader__0"
                      },
                      {
                        name: "tour_leader__1"
                      },
                      {
                        name: "tour_leader__2"
                      }
                    ]
                  },
                  {
                    id: 747,
                    name: "tour_parcsnaturels",
                    metadata: {
                      is_queryable: true,
                      legend_name: "parcnaturel",
                      metadata_id: "f519c4e7-4459-49b5-b8c1-569328252d44"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_parcnaturels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_parcsnaturels__0"
                      },
                      {
                        name: "tour_parcsnaturels__1"
                      }
                    ]
                  },
                  {
                    id: 678,
                    name: "anf_stations_biologiques",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "05e497fc-625d-4701-90af-dbe8813201ab"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_stations_biologiques",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_stations_biologiques__STATIONS_BIOLOGIQUES"
                      }
                    ]
                  },
                  {
                    id: 1364,
                    name: "act_frontieres_isodistances",
                    metadata: {
                      metadata_id: "09318d11-a908-4dea-a8f9-0558d20b980f",
                      start_opacity: 0.5
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "act_frontieres_isodistances",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "act_frontieres_isodistances__0"
                      },
                      {
                        name: "act_frontieres_isodistances__1"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 248,
                name: "flurstucke_grundstucke",
                children: [
                  {
                    id: 359,
                    name: "parcels",
                    metadata: {
                      exclusion: "[1,11,21,31,32,33,34,35,36,37,38,39,51,52,53,54,55,56,57,58,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122]",
                      is_queryable: true,
                      legend_name: "pcn_parcelles:show",
                      metadata_id: "de5373d6-340f-4203-a065-da7550a03cc4_2050"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "parcels",
                    imageType: "image/png"
                  },
                  {
                    id: 353,
                    name: "parcels_labels",
                    metadata: {
                      metadata_id: "a65629c7-ddd6-43de-b0c3-c49647d8fd2b"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "parcels_labels",
                    imageType: "image/png"
                  },
                  {
                    id: 199,
                    name: "buildings",
                    metadata: {
                      exclusion: "[2,12,22,41,42,43,44,45,46,47,48,49,61,62,63,64,65,66,67,68,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222]",
                      is_queryable: true,
                      legend_name: "pcn_batiments:show",
                      metadata_id: "5d0efc9d-a05a-4964-9f9d-a0ab9932af04"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "buildings",
                    imageType: "image/png"
                  },
                  {
                    id: 320,
                    name: "toponymes",
                    metadata: {
                      metadata_id: "ffa537f7-a438-47da-9e0c-8e32260646a9"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "toponymes",
                    imageType: "image/png"
                  },
                  {
                    id: 350,
                    name: "communes_cadastrales_labels",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "5ae8fdfb-bb8f-4f72-b7ee-36c7664fe4b5"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "communes_cadastrales_labels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "communes_cadastrales_labels__COMMUNES_CADASTRALES_LABELS"
                      }
                    ]
                  },
                  {
                    id: 153,
                    name: "communes_cadastrales",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "8a95f8b2-2cfb-42e7-a51c-02084228b364"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "communes_cadastrales",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "communes_cadastrales__COMMUNES_CADASTRALES"
                      }
                    ]
                  },
                  {
                    id: 266,
                    name: "sections_cadastrales_labels",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "69d1b609-11f7-4587-872a-508ee98ea76c"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "sections_cadastrales_labels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "sections_cadastrales_labels__SECTIONS_CADASTRALES_LABELS"
                      }
                    ]
                  },
                  {
                    id: 355,
                    name: "sections_cadastrales",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "c9122320-8f06-4499-ac86-eb469e911369"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "sections_cadastrales",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "sections_cadastrales__SECTIONS_CADASTRALES"
                      }
                    ]
                  },
                  {
                    id: 256,
                    name: "feuilles_cadastrales",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "51333029-c8cf-490f-b4a6-80ba239f0cb4"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "feuilles_cadastrales",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "feuilles_cadastrales__FEUILLES_CADASTRALES"
                      }
                    ]
                  },
                  {
                    id: 417,
                    name: "remembrements",
                    metadata: {
                      exclusion: "[301,302,303,304,305,306,307,308,309,310]",
                      is_queryable: true,
                      max_dpi: 128,
                      metadata_id: "03d079f3-61fb-48bc-ab39-f3427b208702",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "remembrements",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "remembrements__0"
                      },
                      {
                        name: "remembrements__1"
                      }
                    ]
                  },
                  {
                    id: 1643,
                    name: "act_grid_land_tenure",
                    children: [
                      {
                        id: 1644,
                        name: "act_privately_owned_land",
                        metadata: {
                          is_queryable: true,
                          legend_name: "act:privately",
                          metadata_id: "75cb5ae7-7c48-478f-b2a6-1e5bfbdd5958"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "act_privately_owned_land",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "act_privately_owned_land__0"
                          }
                        ]
                      },
                      {
                        id: 1645,
                        name: "act_state_owned_land",
                        metadata: {
                          is_queryable: true,
                          legend_name: "act:stateowned",
                          metadata_id: "e8813b4e-43c4-4a72-853e-bd7c06fd1111"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "act_state_owned_land",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "act_state_owned_land__1"
                          }
                        ]
                      },
                      {
                        id: 1646,
                        name: "act_municipality_owned_land",
                        metadata: {
                          is_queryable: true,
                          legend_name: "act:municipality",
                          metadata_id: "89d42e03-93ae-444f-a49e-eb869b30071e"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "act_municipality_owned_land",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "act_municipality_owned_land__2"
                          }
                        ]
                      },
                      {
                        id: 1647,
                        name: "act_domainepublic_owned_land",
                        metadata: {
                          is_queryable: true,
                          legend_name: "act:domainepublic",
                          metadata_id: "ac32c380-37df-4594-bbf2-0fd394482fd9"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "act_domainepublic_owned_land",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "act_domainepublic_owned_land__5"
                          }
                        ]
                      },
                      {
                        id: 1648,
                        name: "act_publicly_owned_land",
                        metadata: {
                          is_queryable: true,
                          legend_name: "act:publicly",
                          metadata_id: "0a1852f5-1f32-4bdc-8bbc-d6103921d862"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "act_publicly_owned_land",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "act_publicly_owned_land__6"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 165,
                name: "adressen",
                children: [
                  {
                    id: 152,
                    name: "addresses",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "28b310e4-b9e1-467c-a28d-fce2e9a96548"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "addresses",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 291,
                name: "topographische_karten",
                children: [
                  {
                    id: 295,
                    name: "topo",
                    metadata: {
                      exclusion: "[33,43]",
                      metadata_id: "fe530846-9991-455e-a036-edcde4c3c566"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "topo",
                    imageType: "image/png"
                  },
                  {
                    id: 223,
                    name: "topo_250k",
                    metadata: {
                      metadata_id: "e1f601a5-ed8f-4043-8719-0cad50cbb483"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "topo_250k",
                    imageType: "image/png"
                  },
                  {
                    id: 1730,
                    name: "topo_100k_2019",
                    metadata: {
                      legend_name: "topo_100k_sans_tour",
                      metadata_id: "ce051f08-bca6-43c0-af7b-5fcf3e02376e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "topo_100k_2019",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "topo_100k_2019__topo_100k"
                      }
                    ]
                  },
                  {
                    id: 1729,
                    name: "topo_100k_BW_2019",
                    metadata: {
                      legend_name: "topo_100k_sans_tour",
                      metadata_id: "8d02ddc3-8482-4e47-8ee0-520af99d4966"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "topo_100k_BW_2019",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "topo_100k_BW_2019__topo_100k_bw"
                      }
                    ]
                  },
                  {
                    id: 1727,
                    name: "topo_50k_2019",
                    metadata: {
                      legend_name: "topo_50k_sans_tour",
                      metadata_id: "abc505e1-224c-455e-9e7f-4f094eb4e7b0"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "topo_50k_2019",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "topo_50k_2019__50K-2019-LUX_avec_ETRANGER"
                      }
                    ]
                  },
                  {
                    id: 1728,
                    name: "topo_50k_BW_2019",
                    metadata: {
                      legend_name: "topo_50k_sans_tour",
                      metadata_id: "b8ccc3e8-fcf0-479c-b322-c0aee5a480e5"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "topo_50k_BW_2019",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "topo_50k_BW_2019__50K-2019-LUX_avec_ETRANGER-BW"
                      }
                    ]
                  },
                  {
                    id: 206,
                    name: "topo_20k",
                    metadata: {
                      legend_name: "topo_20k",
                      metadata_id: "ea998ae8-731a-43bc-aa9f-171684f97602"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "topo_20k",
                    imageType: "image/png"
                  },
                  {
                    id: 149,
                    name: "topo_tour_20k",
                    metadata: {
                      legend_name: "topo_tour_20k",
                      metadata_id: "1173_"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "topo_tour_20k",
                    imageType: "image/png"
                  },
                  {
                    id: 265,
                    name: "topo_decoupage_r",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "3a35eb1a-9eaa-4f90-927f-2891d5e865f7"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "topo_decoupage_r",
                    imageType: "image/png"
                  },
                  {
                    id: 195,
                    name: "topo_5k",
                    metadata: {
                      exclusion: "[32,42]",
                      legend_name: "topo_5k",
                      metadata_id: "270_2012"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "topo_5k",
                    imageType: "image/png"
                  },
                  {
                    id: 313,
                    name: "topo_carteshisto",
                    children: [
                      {
                        id: 358,
                        name: "FERRARIS",
                        metadata: {
                          legend_name: "ferraris",
                          metadata_id: "783cb2a8-a143-4263-aaf0-b4f032835e0c"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "FERRARIS",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "FERRARIS__ALL"
                          }
                        ]
                      },
                      {
                        id: 328,
                        name: "1907_CAHANSEN",
                        metadata: {
                          metadata_id: "b88e6524-67d3-4e34-b998-6f30120e3718"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "1907_CAHANSEN",
                        imageType: "image/png"
                      },
                      {
                        id: 252,
                        name: "1927_CAHANSEN",
                        metadata: {
                          metadata_id: "90750f9f-856d-41ac-a90f-a8befbd75434"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "1927_CAHANSEN",
                        imageType: "image/png"
                      },
                      {
                        id: 220,
                        name: "TOPO_CARTES_1944",
                        metadata: {
                          metadata_id: "e78c1d0a-ef3d-4552-9bba-f72a1d1d3173"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "TOPO_CARTES_1944",
                        imageType: "image/png"
                      },
                      {
                        id: 810,
                        name: "TOPO_CARTEHISTO_1950",
                        metadata: {
                          legend_name: "carte_scolaire",
                          metadata_id: "f29901f2-c4b0-4250-a332-640e25a84d2e"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "TOPO_CARTEHISTO_1950",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "TOPO_CARTEHISTO_1950__0"
                          }
                        ]
                      },
                      {
                        id: 274,
                        name: "TOPO25K1954C24",
                        metadata: {
                          metadata_id: "7a8bc9a4-e7c7-4584-bc4f-03deaf7b69b2"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "TOPO25K1954C24",
                        imageType: "image/png"
                      },
                      {
                        id: 201,
                        name: "TOPO_CARTESHISTO_1964",
                        metadata: {
                          metadata_id: "58bec8c3-c9f1-44ba-ab3a-860122694952"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "TOPO_CARTESHISTO_1964",
                        imageType: "image/png"
                      },
                      {
                        id: 173,
                        name: "TOPO_CARTESHISTO_1964_RGB",
                        metadata: {
                          metadata_id: "27818c9d-19f1-4c3c-bcf6-0856d766d27d"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "TOPO_CARTESHISTO_1964_RGB",
                        imageType: "image/png"
                      },
                      {
                        id: 217,
                        name: "TOPO_CARTESHISTO_1966-74_50k",
                        metadata: {
                          metadata_id: "0cda7940-0268-4595-97ed-ae5854da628b"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "TOPO_CARTESHISTO_1966-74_50k",
                        imageType: "image/png"
                      },
                      {
                        id: 156,
                        name: "TOPO_CARTESHISTO_1979",
                        metadata: {
                          metadata_id: "6c2b8b34-0eb8-4b2c-8586-e8a515ad1860"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "TOPO_CARTESHISTO_1979",
                        imageType: "image/png"
                      },
                      {
                        id: 191,
                        name: "TOPO_CARTESHISTO_1979_RGB",
                        metadata: {
                          metadata_id: "44675358-e65a-4e3b-ac6f-e4f19fd7bfb5"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "TOPO_CARTESHISTO_1979_RGB",
                        imageType: "image/png"
                      },
                      {
                        id: 285,
                        name: "TOPO_CARTESHISTO_1989",
                        metadata: {
                          metadata_id: "d3e2a6d0-52b6-4f06-b833-021647f6de4c"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "TOPO_CARTESHISTO_1989",
                        imageType: "image/png"
                      },
                      {
                        id: 185,
                        name: "TOPO_CARTESHISTO_1990_50k",
                        metadata: {
                          metadata_id: "b68a8131-2e42-40de-99ce-5a1433d80cbf"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "TOPO_CARTESHISTO_1990_50k",
                        imageType: "image/png"
                      },
                      {
                        id: 299,
                        name: "TOPO_CARTESHISTO_1993_50k",
                        metadata: {
                          metadata_id: "f15bf68d-593f-422a-b855-2e05dfb34fcc"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "TOPO_CARTESHISTO_1993_50k",
                        imageType: "image/png"
                      },
                      {
                        id: 278,
                        name: "TOPO_CARTESHISTO_2000_50k",
                        metadata: {
                          metadata_id: "ccdd1b07-401d-48cb-821d-1ae51d489f36"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "TOPO_CARTESHISTO_2000_50k",
                        imageType: "image/png"
                      },
                      {
                        id: 237,
                        name: "TOPO_CARTESHISTO_2000",
                        metadata: {
                          metadata_id: "21a56aff-4a9e-4be5-9ed8-cd60dd56d5a1"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "TOPO_CARTESHISTO_2000",
                        imageType: "image/png"
                      },
                      {
                        id: 155,
                        name: "topo_50k",
                        metadata: {
                          legend_name: "topo_50k",
                          metadata_id: "262"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "topo_50k",
                        imageType: "image/png"
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 734,
                    name: "utm_grid",
                    metadata: {
                      max_dpi: 128,
                      metadata_id: "84f59e51-2772-4b6d-8c5b-3ec19aa7d8f2"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "utm_grid",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "utm_grid__0"
                      },
                      {
                        name: "utm_grid__1"
                      }
                    ]
                  },
                  {
                    id: 738,
                    name: "luref_graticules",
                    metadata: {
                      max_dpi: 128,
                      metadata_id: "0d1a431c-36b0-406f-8cfd-d264d4949bf0"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "luref_graticules",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "luref_graticules__2"
                      },
                      {
                        name: "luref_graticules__3"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 330,
                name: "geodesy",
                children: [
                  {
                    id: 1831,
                    name: "ng_new",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "3119179b-56bb-459d-8904-1e0a2bfb6bc7"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ng_new",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ng_new__0"
                      }
                    ]
                  },
                  {
                    id: 411,
                    name: "ng",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "3119179b-56bb-459d-8904-1e0a2bfb6bc7"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ng",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ng__POINT_NG"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 555,
            name: "editus_pois",
            children: [
              {
                id: 542,
                name: "editus_poi_299",
                metadata: {
                  is_queryable: true,
                  legend_name: "editus_1",
                  metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                  start_opacity: 0.9
                },
                dimensions: {},
                type: "WMS",
                layers: "542",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "editus_poi_299__POI"
                  }
                ]
              },
              {
                id: 543,
                name: "editus_poi_286",
                metadata: {
                  is_queryable: true,
                  legend_name: "editus_2",
                  metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                  start_opacity: 0.9
                },
                dimensions: {},
                type: "WMS",
                layers: "543",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "editus_poi_286__POI"
                  }
                ]
              },
              {
                id: 544,
                name: "editus_poi_285",
                metadata: {
                  is_queryable: true,
                  legend_name: "editus_3",
                  metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                  start_opacity: 0.9
                },
                dimensions: {},
                type: "WMS",
                layers: "544",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "editus_poi_285__POI"
                  }
                ]
              },
              {
                id: 545,
                name: "editus_poi_287",
                metadata: {
                  is_queryable: true,
                  legend_name: "editus_4",
                  metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                  start_opacity: 0.9
                },
                dimensions: {},
                type: "WMS",
                layers: "545",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "editus_poi_287__POI"
                  }
                ]
              },
              {
                id: 546,
                name: "editus_poi_289",
                metadata: {
                  is_queryable: true,
                  legend_name: "editus_5",
                  metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                  start_opacity: 0.9
                },
                dimensions: {},
                type: "WMS",
                layers: "546",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "editus_poi_289__POI"
                  }
                ]
              },
              {
                id: 547,
                name: "editus_poi_290",
                metadata: {
                  is_queryable: true,
                  legend_name: "editus_6",
                  metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                  start_opacity: 0.9
                },
                dimensions: {},
                type: "WMS",
                layers: "547",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "editus_poi_290__POI"
                  }
                ]
              },
              {
                id: 549,
                name: "editus_poi_291",
                metadata: {
                  is_queryable: true,
                  legend_name: "editus_7",
                  metadata_id: "4a04ebff-4954-4c4d-9387-46d3587eccef",
                  start_opacity: 0.9
                },
                dimensions: {},
                type: "WMS",
                layers: "549",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "editus_poi_291__POI"
                  }
                ]
              },
              {
                id: 550,
                name: "editus_poi_292",
                metadata: {
                  is_queryable: true,
                  legend_name: "editus_8",
                  metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                  start_opacity: 0.9
                },
                dimensions: {},
                type: "WMS",
                layers: "550",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "editus_poi_292__POI"
                  }
                ]
              },
              {
                id: 551,
                name: "editus_poi_293",
                metadata: {
                  is_queryable: true,
                  legend_name: "editus_9",
                  metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                  start_opacity: 0.9
                },
                dimensions: {},
                type: "WMS",
                layers: "551",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "editus_poi_293__POI"
                  }
                ]
              },
              {
                id: 548,
                name: "editus_poi_294",
                metadata: {
                  is_queryable: true,
                  legend_name: "editus_10",
                  metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                  start_opacity: 0.9
                },
                dimensions: {},
                type: "WMS",
                layers: "548",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "editus_poi_294__POI"
                  }
                ]
              },
              {
                id: 552,
                name: "editus_poi_295",
                metadata: {
                  is_queryable: true,
                  legend_name: "editus_11",
                  metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                  start_opacity: 0.9
                },
                dimensions: {},
                type: "WMS",
                layers: "552",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "editus_poi_295__POI"
                  }
                ]
              },
              {
                id: 553,
                name: "editus_poi_296",
                metadata: {
                  is_queryable: true,
                  legend_name: "editus_12",
                  metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                  start_opacity: 0.9
                },
                dimensions: {},
                type: "WMS",
                layers: "553",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "editus_poi_296__POI"
                  }
                ]
              },
              {
                id: 554,
                name: "editus_poi_298",
                metadata: {
                  is_queryable: true,
                  legend_name: "editus_13",
                  metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                  start_opacity: 0.9
                },
                dimensions: {},
                type: "WMS",
                layers: "554",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "editus_poi_298__POI"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 194,
            name: "infrastrucktur_une_kommunikation",
            children: [
              {
                id: 339,
                name: "gebaude",
                children: [
                  {
                    id: 199,
                    name: "buildings",
                    metadata: {
                      exclusion: "[2,12,22,41,42,43,44,45,46,47,48,49,61,62,63,64,65,66,67,68,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222]",
                      is_queryable: true,
                      legend_name: "pcn_batiments:show",
                      metadata_id: "5d0efc9d-a05a-4964-9f9d-a0ab9932af04"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "buildings",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 196,
                name: "verkehrsnetze",
                children: [
                  {
                    id: 181,
                    name: "roads",
                    metadata: {
                      legend_name: "road_network:show",
                      metadata_id: "12627f90-f0f8-41b3-a56a-2e11a232ba59"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "roads",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "roads__ROADS_NOLABELS"
                      }
                    ]
                  },
                  {
                    id: 351,
                    name: "roads_labels",
                    metadata: {
                      metadata_id: "5d606cae-cbc6-44c3-a465-edb981e44a39"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "roads_labels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "roads_labels__ROADS_LABELS"
                      }
                    ]
                  },
                  {
                    id: 147,
                    name: "arrets_bus",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:arrets_de_bus",
                      metadata_id: "7318c6e8-bb63-40e0-9e40-46ae7b0dc266"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "arrets_bus",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "arrets_bus__0"
                      },
                      {
                        name: "arrets_bus__1"
                      }
                    ]
                  },
                  {
                    id: 813,
                    name: "cdt_lignes_all",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "bbe0523f-374d-4c94-a27d-7ce81d8bae3b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "cdt_lignes_all",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cdt_lignes_all__lignes_de_bus"
                      }
                    ]
                  },
                  {
                    id: 812,
                    name: "cdt_lignes_bus_par_operateur",
                    children: [
                      {
                        id: 814,
                        name: "cdt_lignes_avl",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "1e6f614b-e347-4115-82d7-74a72f51389f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "category",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [],
                        ogcServer: "source for config://my_maps?category_id=400"
                      },
                      {
                        id: 815,
                        name: "cdt_lignes_rgtr",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "eae3ed54-d2ae-45ae-a62c-0dec4d44acdf"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "category",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [],
                        ogcServer: "source for config://my_maps?category_id=401"
                      },
                      {
                        id: 816,
                        name: "cdt_lignes_tice",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "a3cb973c-12b0-4e41-bfc0-b2fb67637513"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "category",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [],
                        ogcServer: "source for config://my_maps?category_id=402"
                      },
                      {
                        id: 817,
                        name: "cdt_lignes_cfl",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "84ebdfbc-ba25-464c-af86-e74e588978ef"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "category",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [],
                        ogcServer: "source for config://my_maps?category_id=403"
                      },
                      {
                        id: 1374,
                        name: "cdt_lignes_tram",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "0f46c673-d4b4-4c25-8d9a-fca41035f587"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "category",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [],
                        ogcServer: "source for config://my_maps?category_id=404"
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1381,
                    name: "chargy",
                    metadata: {
                      is_queryable: true,
                      legend_name: "chargy",
                      metadata_id: "801d732a-c285-4fcd-a043-c5220d6d7eef"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "chargy",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "chargy__chargy"
                      }
                    ]
                  },
                  {
                    id: 423,
                    name: "mobiliteit_cfl",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:cfl",
                      max_dpi: 128,
                      metadata_id: "0b3c42a2-275e-4519-b228-f407d46b8350"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobiliteit_cfl",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobiliteit_cfl__1"
                      }
                    ]
                  },
                  {
                    id: 377,
                    name: "mobiliteit_pr",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:pr",
                      max_dpi: 128,
                      metadata_id: "9e0c97ae-aff9-41fc-9489-bbf97999163d"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobiliteit_pr",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobiliteit_pr__2"
                      }
                    ]
                  },
                  {
                    id: 368,
                    name: "mobiliteit_bikeshare",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:bikeshare",
                      max_dpi: 128,
                      metadata_id: "e9fbbdff-2f8f-422b-b6ae-5cc69f73bb4b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobiliteit_bikeshare",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobiliteit_bikeshare__0"
                      }
                    ]
                  },
                  {
                    id: 1386,
                    name: "mobiliteit_livebikes",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "fc0168f8-2d8b-4bba-8da8-6edd6edd94cc"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobiliteit_livebikes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobiliteit_livebikes__bikes"
                      }
                    ]
                  },
                  {
                    id: 808,
                    name: "velo_by_pch",
                    metadata: {
                      is_queryable: true,
                      legend_name: "tour_velo_national",
                      metadata_id: "387f6949-0fc4-43a5-b0e6-4e09bdf65225"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "velo_by_pch",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "velo_by_pch__1"
                      },
                      {
                        name: "velo_by_pch__0"
                      }
                    ]
                  },
                  {
                    id: 512,
                    name: "tour_pistes_velo_mymaps2",
                    metadata: {
                      is_queryable: true,
                      legend_name: "tour_velo_national",
                      metadata_id: "8e3c102a-393e-4d48-a321-9f8957ff49cf"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=106"
                  },
                  {
                    id: 352,
                    name: "cfl_hecto",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "938f9e8e-071c-4e6b-940f-64b2a60eca74"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "cfl_hecto",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cfl_hecto__points_hecto"
                      }
                    ]
                  },
                  {
                    id: 685,
                    name: "cita_chantiers_actuel",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "9c823038-5965-47cc-8dad-21496e57e3f2",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "cita_chantiers_actuel",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cita_chantiers_actuel__CHANTIERS_ACTUEL"
                      }
                    ]
                  },
                  {
                    id: 686,
                    name: "cita_chantiers_futur",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "063cb796-640f-4ab0-8430-955983a00e3b",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "cita_chantiers_futur",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cita_chantiers_futur__CHANTIERS_FUTUR"
                      }
                    ]
                  },
                  {
                    id: 1713,
                    name: "chantiers_actuels_pc",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "7d59f3a6-e8d8-464b-bbf9-73c6ca358a51",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "chantiers_actuels_pc",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "chantiers_actuels_pc__CHANTIERS_ACTUEL_PC"
                      }
                    ]
                  },
                  {
                    id: 1714,
                    name: "chantiers_futurs_pc",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "f6b9df36-5e62-46d1-ae91-c7c58c7e2e45",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "chantiers_futurs_pc",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "chantiers_futurs_pc__CHANTIERS_FUTUR_PC"
                      }
                    ]
                  },
                  {
                    id: 682,
                    name: "mobi_mbox",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:mbox",
                      max_dpi: 128,
                      metadata_id: "77780c80-a2dc-4dc2-96ac-c29e2ad15495"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobi_mbox",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobi_mbox__0"
                      }
                    ]
                  },
                  {
                    id: 713,
                    name: "pch_radars",
                    metadata: {
                      is_queryable: true,
                      max_dpi: 128,
                      metadata_id: "385180ba-a9bc-49d4-8858-ba5f19942a66",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "pch_radars",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "pch_radars__0"
                      },
                      {
                        name: "pch_radars__1"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1495,
                name: "fourniture_energie",
                children: [
                  {
                    id: 1494,
                    name: "gaz_naturel",
                    metadata: {
                      is_queryable: true,
                      legend_name: "gaz",
                      metadata_id: "9e04e366-fcb7-4836-8d09-41b20f280cb0",
                      start_opacity: 0.75
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "gaz_naturel",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "gaz_naturel__0"
                      },
                      {
                        name: "gaz_naturel__2"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 666,
                name: "uhd",
                children: [
                  {
                    id: 670,
                    name: "uhd1",
                    metadata: {
                      exclusion: "[350]",
                      is_queryable: true,
                      legend_name: "uhd",
                      max_dpi: 128,
                      metadata_id: "9fd891d4-d62c-4f7c-83bb-d08833caa888",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "uhd1",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "uhd1__0"
                      },
                      {
                        name: "uhd1__3"
                      }
                    ]
                  },
                  {
                    id: 669,
                    name: "uhd2",
                    metadata: {
                      exclusion: "[350]",
                      is_queryable: true,
                      legend_name: "uhd",
                      max_dpi: 128,
                      metadata_id: "ad74e4da-3b37-4379-83d8-16a6de4677c7",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "uhd2",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "uhd2__1"
                      },
                      {
                        name: "uhd2__3"
                      }
                    ]
                  },
                  {
                    id: 671,
                    name: "uhd3",
                    metadata: {
                      exclusion: "[350]",
                      is_queryable: true,
                      legend_name: "uhd",
                      max_dpi: 128,
                      metadata_id: "5203f02c-1b44-4af4-be08-d35d19ef033a",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "uhd3",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "uhd3__2"
                      },
                      {
                        name: "uhd3__3"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2438,
                name: "seveso_group",
                children: [
                  {
                    id: 798,
                    name: "seveso",
                    metadata: {
                      is_queryable: true,
                      legend_name: "seveso",
                      metadata_id: "b9ab14d8-4e51-4146-b019-3937715a8fe8"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "seveso",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "seveso__POI"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2276,
                name: "radio_group",
                children: [
                  {
                    id: 2275,
                    name: "smc_radio_haute_puissance",
                    metadata: {
                      is_queryable: true,
                      legend_name: "smc_radio",
                      metadata_id: "ebfdb83f-dbc6-44fb-973d-5a782eed32e2"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "2275",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "smc_radio_haute_puissance__POI"
                      }
                    ]
                  },
                  {
                    id: 2278,
                    name: "smc_radio_reseau_emission",
                    metadata: {
                      is_queryable: true,
                      legend_name: "smc_radio",
                      metadata_id: "ebfdb83f-dbc6-44fb-973d-5a782eed32e2"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "2278",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "smc_radio_reseau_emission__POI"
                      }
                    ]
                  },
                  {
                    id: 2277,
                    name: "smc_radio_locale",
                    metadata: {
                      is_queryable: true,
                      legend_name: "smc_radio",
                      metadata_id: "ebfdb83f-dbc6-44fb-973d-5a782eed32e2"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "2277",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "smc_radio_locale__POI"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1832,
                name: "sante_group",
                children: [
                  {
                    id: 1810,
                    name: "sante_covid_altersheemer",
                    metadata: {
                      is_queryable: true,
                      legend_name: "structures_acceuil",
                      metadata_id: "0019f21d-e492-42ce-83a9-f4212c43e2c6",
                      start_opacity: 0.9
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "1810",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "sante_covid_altersheemer__POI"
                      }
                    ]
                  },
                  {
                    id: 2004,
                    name: "pharmacies",
                    metadata: {
                      is_queryable: true,
                      legend_name: "pharmacies",
                      metadata_id: "4fed0407-cb2b-4c75-982a-e96f926d6b0d"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "2004",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "pharmacies__POI"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 324,
            name: "oberflachendarstellung",
            children: [
              {
                id: 178,
                name: "luft_und_satellitenbilder",
                children: [
                  {
                    id: 2272,
                    name: "ortho_2021",
                    metadata: {
                      exclusion: "[121,221]",
                      metadata_id: "ea0bd2ff-b743-4f3a-bd9b-450976563de9"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR_4_V3",
                    layer: "ortho_2021",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 2056,
                    name: "ortho_2020",
                    metadata: {
                      exclusion: "[119,219]",
                      metadata_id: "87870b8a-10a1-4c33-bf50-7efe851fd450"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR_4_V3",
                    layer: "ortho_2020",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 1784,
                    name: "ortho_2019",
                    metadata: {
                      exclusion: "[116,216]",
                      metadata_id: "97c88ef6-6c64-4cb0-a134-06bb42b2b448"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2019",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 1789,
                    name: "ortho_2019_winter",
                    metadata: {
                      exclusion: "[118,218]",
                      metadata_id: "d6cc500f-b802-4be2-a49c-73f3eb2d131e"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2019_winter",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 1527,
                    name: "ortho_2018",
                    metadata: {
                      exclusion: "[113,213]",
                      metadata_id: "6fde72c4-802f-4663-be74-5fa5901cb4f0"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2018",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 1371,
                    name: "ortho_2017",
                    metadata: {
                      exclusion: "[111,211]",
                      metadata_id: "1cdae616-1a7a-49d5-b35d-05864891641f"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2017",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 745,
                    name: "ortho_2016",
                    metadata: {
                      exclusion: "[107,207]",
                      metadata_id: "bba79b6d-4205-4ce4-98e4-7b7922afcd55"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2016",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 360,
                    name: "ortho_2013",
                    metadata: {
                      exclusion: "[106,206]",
                      metadata_id: "ced4a3dd-135e-43d0-86b9-2318982581f7"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2013",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 342,
                    name: "ortho_2010",
                    metadata: {
                      exclusion: "[105,205]",
                      metadata_id: "0faf4bdb-a54b-42d7-942c-4e52fa66e963"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2010",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 231,
                    name: "ortho_2007",
                    metadata: {
                      exclusion: "[101,201]",
                      metadata_id: "3be3d98e-7997-4ff6-8d77-e393a5fc4fdd"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2007",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 224,
                    name: "ortho_2004",
                    metadata: {
                      exclusion: "[103,203]",
                      metadata_id: "a185f78a-ca9c-43f8-8d06-b1abba8ff056"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2004",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 225,
                    name: "ortho_2001",
                    metadata: {
                      exclusion: "[104,204]",
                      metadata_id: "e6ff269c-1c7c-401f-a90b-b805e80a046e"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2001",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 345,
                    name: "topo_decoupage_ortho",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "3a35eb1a-9eaa-4f90-927f-2891d5e865f7"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "topo_decoupage_ortho",
                    imageType: "image/png"
                  },
                  {
                    id: 292,
                    name: "wg_ikonos_satellitendaten",
                    metadata: {
                      legend_name: "wg:ikonos_satellitendaten",
                      metadata_id: "db0eea79-114a-4e61-a1f2-7e064f92cdd3"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "wg_ikonos_satellitendaten",
                    imageType: "image/png"
                  },
                  {
                    id: 341,
                    name: "aero_1951_10k",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "16586649-8e46-4b04-b75c-5537a4bf214e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aero_1951_10k",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aero_1951_10k__1951_10k"
                      }
                    ]
                  },
                  {
                    id: 229,
                    name: "aero_1951_25k",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "b3b5fc05-323c-4f0b-804c-a4c186d62a96"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aero_1951_25k",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aero_1951_25k__1951_25k"
                      }
                    ]
                  },
                  {
                    id: 140,
                    name: "aero_1963_20k",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "56b65f04-d3ab-45b6-9e93-95c8c9524c3e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aero_1963_20k",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aero_1963_20k__1963_20k"
                      }
                    ]
                  },
                  {
                    id: 665,
                    name: "aero_1977_30k",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "d9dd951e-7345-4ba2-9a76-ce54305edf2f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aero_1977_30k",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aero_1977_30k__1977_30k"
                      }
                    ]
                  },
                  {
                    id: 743,
                    name: "aero_1987_30k",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "98b63794-8cb1-42ff-9872-214f990ec8cd"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aero_1987_30k",
                    imageType: "image/png",
                    style: "defaults",
                    childLayers: [
                      {
                        name: "aero_1987_30k__1987_30k"
                      }
                    ]
                  },
                  {
                    id: 748,
                    name: "aero_1994_30k",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "abf7f6f5-8647-4317-98f6-8d4f5cd38585"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aero_1994_30k",
                    imageType: "image/png",
                    style: "defaults",
                    childLayers: [
                      {
                        name: "aero_1994_30k__1994_30k"
                      }
                    ]
                  },
                  {
                    id: 790,
                    name: "Orthophotos Infrarouge",
                    children: [
                      {
                        id: 2283,
                        name: "ortho2021_IR",
                        metadata: {
                          exclusion: "[122,222]",
                          metadata_id: "067dc519-f507-45db-8e7a-f3ccc9125bc5"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ortho2021_IR",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ortho2021_IR__ortho2021_10cm_ir_EPSG2169"
                          }
                        ]
                      },
                      {
                        id: 2089,
                        name: "ortho2020_IR",
                        metadata: {
                          exclusion: "[120,220]",
                          metadata_id: "134fb490-c022-476d-b484-dc652ae8c626"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ortho2020_IR",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ortho2020_IR__Luxembourg-2020_ortho10cm_PIR_LUREF"
                          }
                        ]
                      },
                      {
                        id: 1785,
                        name: "ortho2019_IR",
                        metadata: {
                          exclusion: "[117,217]",
                          metadata_id: "3dfd031a-1721-4f35-b358-25062d5d4c26"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ortho2019_IR",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ortho2019_IR__ortho_2019_20cm_ir"
                          }
                        ]
                      },
                      {
                        id: 1529,
                        name: "ortho2018_IR",
                        metadata: {
                          exclusion: "[114,214]",
                          metadata_id: "2edf6bcb-2a1c-4b8c-8488-56000133abb4"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ortho2018_IR",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ortho2018_IR__4"
                          }
                        ]
                      },
                      {
                        id: 1372,
                        name: "ortho_2017_irc",
                        metadata: {
                          exclusion: "[112,212]",
                          metadata_id: "659a3236-a22e-44ae-9fa3-025cdf5d0043"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "ortho_2017_irc",
                        imageType: "image/jpeg"
                      },
                      {
                        id: 793,
                        name: "ortho_2016_irc",
                        metadata: {
                          exclusion: "[110,210]",
                          is_queryable: true,
                          metadata_id: "c313da75-7d8b-4570-9db5-bb6add56309e"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "ortho_2016_irc",
                        imageType: "image/jpeg"
                      },
                      {
                        id: 792,
                        name: "ortho_2013_irc",
                        metadata: {
                          exclusion: "[109,209]",
                          is_queryable: true,
                          metadata_id: "649b34a1-a195-40b4-81c9-0100343b9661"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "ortho_2013_irc",
                        imageType: "image/jpeg"
                      },
                      {
                        id: 791,
                        name: "ortho_2010_irc",
                        metadata: {
                          exclusion: "[108,208]",
                          is_queryable: true,
                          metadata_id: "728ffc2a-9062-4822-8596-01f0e93f6b40"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "ortho_2010_irc",
                        imageType: "image/jpeg"
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 161,
                name: "env_obs",
                children: [
                  {
                    id: 1963,
                    name: "env_couverture_sol",
                    children: [
                      {
                        id: 1951,
                        name: "LISL_Landcover_2018",
                        metadata: {
                          is_queryable: true,
                          legend_name: "lisl:lc2018",
                          metadata_id: "6142a6a6-9356-47ac-babe-eaa2ae3628b6"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "LISL_Landcover_2018",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "LISL_Landcover_2018__0"
                          },
                          {
                            name: "LISL_Landcover_2018__1"
                          }
                        ]
                      },
                      {
                        id: 1950,
                        name: "LISL_Landcover_2015_v2",
                        metadata: {
                          is_queryable: true,
                          legend_name: "lisl:lc2015_2",
                          metadata_id: "67f4ecb8-5d4b-4a9e-a60b-239fc92b25a7"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "LISL_Landcover_2015_v2",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "LISL_Landcover_2015_v2__0"
                          },
                          {
                            name: "LISL_Landcover_2015_v2__1"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1964,
                    name: "env_utilisation_sol",
                    children: [
                      {
                        id: 1970,
                        name: "LISL_Landuse_2018",
                        metadata: {
                          is_queryable: true,
                          legend_name: "lisl_landuse_2018",
                          metadata_id: "e4572e0b-1b40-4834-b6c3-ccab83f75f57"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "LISL_Landuse_2018",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "LISL_Landuse_2018__0"
                          }
                        ]
                      },
                      {
                        id: 2054,
                        name: "LISL_Landuse_2015_v3",
                        metadata: {
                          is_queryable: true,
                          legend_name: "lisl_landuse_2015_v3",
                          metadata_id: "65e04718-1890-4c5e-8be7-08a73f69c0cc"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "LISL_Landuse_2015_v3",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "LISL_Landuse_2015_v3__0"
                          }
                        ]
                      },
                      {
                        id: 1969,
                        name: "LISL_Landuse_2007",
                        metadata: {
                          is_queryable: true,
                          legend_name: "lisl_landuse_2007",
                          metadata_id: "257556b9-560b-4193-b773-e16a9137a690"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "LISL_Landuse_2007",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "LISL_Landuse_2007__0"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1965,
                    name: "env_impermeabilisation",
                    children: [
                      {
                        id: 1952,
                        name: "LISL_taux_impermeabilisation_2018",
                        metadata: {
                          is_queryable: true,
                          legend_name: "lisl_taux_impermeabilisation_2018",
                          metadata_id: "5b40c571-dd3c-4e76-8f4f-b54746799688"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "LISL_taux_impermeabilisation_2018",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "LISL_taux_impermeabilisation_2018__0"
                          },
                          {
                            name: "LISL_taux_impermeabilisation_2018__1"
                          }
                        ]
                      },
                      {
                        id: 2216,
                        name: "at_impermeabilisation_grid_2018_100m",
                        metadata: {
                          is_queryable: true,
                          legend_name: "at:impermeabilisation_grid_2018_100m",
                          metadata_id: "210db74a-e33a-401b-9e17-2cd966cdcd1f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "at_impermeabilisation_grid_2018_100m",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "at_impermeabilisation_grid_2018_100m__0"
                          }
                        ]
                      },
                      {
                        id: 2215,
                        name: "at_impermeabilisation_grid_2018_1km",
                        metadata: {
                          is_queryable: true,
                          legend_name: "at:impermeabilisation_grid_2018_1km",
                          metadata_id: "8dc777d0-f910-4c69-a476-85a73dcd8474"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "at_impermeabilisation_grid_2018_1km",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "at_impermeabilisation_grid_2018_1km__0"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 2212,
                    name: "at_batiments_group",
                    children: [
                      {
                        id: 2214,
                        name: "at_batiments_periode_construction",
                        metadata: {
                          is_queryable: true,
                          legend_name: "at:periode_construction_batiments",
                          metadata_id: "7c138282-86de-4adb-91c2-467b06786821"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "at_batiments_periode_construction",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "at_batiments_periode_construction__0"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1966,
                    name: "env_occupation_biophysique",
                    children: [
                      {
                        id: 215,
                        name: "env_obs2007",
                        metadata: {
                          is_queryable: true,
                          max_dpi: 128,
                          metadata_id: "bd672300-0851-4901-82c4-6099aff1fcf7"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_obs2007",
                        imageType: "image/png"
                      },
                      {
                        id: 163,
                        name: "env_obs1999",
                        metadata: {
                          is_queryable: true,
                          max_dpi: 128,
                          metadata_id: "b4836d86-2803-4dcf-a991-7e78ab9c41b6"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_obs1999",
                        imageType: "image/png"
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1967,
                    name: "env_corine_landcover",
                    children: [
                      {
                        id: 167,
                        name: "env_corine",
                        metadata: {
                          is_queryable: true,
                          max_dpi: 128,
                          metadata_id: "0098c72d-490e-4b03-91f6-f844502883a0"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_corine",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_corine__0"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 416,
                name: "map_morphometrie",
                children: [
                  {
                    id: 415,
                    name: "wg_hohenlinien_10m_map",
                    metadata: {
                      is_queryable: true,
                      legend_name: "wg:hohenlinien_10m",
                      metadata_id: "012801f3-5d2b-4ab7-ae58-1da1b3256390"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "wg_hohenlinien_10m_map",
                    imageType: "image/png"
                  },
                  {
                    id: 1461,
                    name: "wg_hangneigung_map",
                    metadata: {
                      legend_name: "wg:hangneigung",
                      metadata_id: "6ffa94a4-af02-43ec-82e0-6796cd01a948"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "wg_hangneigung_map",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "wg_hangneigung_map__0"
                      }
                    ]
                  },
                  {
                    id: 1462,
                    name: "wg_exposition_map",
                    metadata: {
                      legend_name: "wg:exposition",
                      metadata_id: "7a42e4c5-6f3c-45ea-a909-3f8f28874fde"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "wg_exposition_map",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "wg_exposition_map__0"
                      }
                    ]
                  },
                  {
                    id: 1460,
                    name: "wg_relief_map",
                    metadata: {
                      metadata_id: "7d195815-23c2-4963-863c-60e3a39ab8af"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "wg_relief_map",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "wg_relief_map__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1380,
                name: "lidar_group",
                children: [
                  {
                    id: 1792,
                    name: "act_lidar_2019_group",
                    children: [
                      {
                        id: 1794,
                        name: "lidar_2019_mns_public",
                        metadata: {
                          legend_name: "lidar:mns2019",
                          metadata_id: "30f3dc03-7b04-4938-95c4-f0e219ce65c8"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR_4_V3",
                        layer: "lidar_2019_mns_public",
                        imageType: "image/png"
                      },
                      {
                        id: 1795,
                        name: "lidar_2019_mnt_public",
                        metadata: {
                          legend_name: "lidar:mnt2019",
                          metadata_id: "ba62d5be-9c71-406a-8b46-a36bfaa36357"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR_4_V3",
                        layer: "lidar_2019_mnt_public",
                        imageType: "image/png"
                      },
                      {
                        id: 1789,
                        name: "ortho_2019_winter",
                        metadata: {
                          exclusion: "[118,218]",
                          metadata_id: "d6cc500f-b802-4be2-a49c-73f3eb2d131e"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "ortho_2019_winter",
                        imageType: "image/jpeg"
                      },
                      {
                        id: 1788,
                        name: "lidar_tiles_2019",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "b19a500a-b8d5-4a87-a8f3-00f58c3dffcd",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lidar_tiles_2019",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lidar_tiles_2019__LIDAR2019_tiles_500x500m_grid"
                          },
                          {
                            name: "lidar_tiles_2019__LIDAR2019_parent_tiles_1500x1500_grid"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1791,
                    name: "act_lidar_2017_group",
                    children: [
                      {
                        id: 1377,
                        name: "lidar_mns",
                        metadata: {
                          legend_name: "lidar:mns2017",
                          metadata_id: "e7184a37-7a6a-4e07-ae8d-ff06d9969da0"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lidar_mns",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lidar_mns__0"
                          }
                        ]
                      },
                      {
                        id: 1378,
                        name: "lidar_mnt",
                        metadata: {
                          legend_name: "lidar:mnt2017",
                          metadata_id: "1adab94e-d80a-4e19-a808-28f52f633186"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lidar_mnt",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lidar_mnt__0"
                          }
                        ]
                      },
                      {
                        id: 1379,
                        name: "lidar_ortho_2017_winter",
                        metadata: {
                          exclusion: "[115,215]",
                          metadata_id: "a2f1a418-6b8b-44e3-9982-1f37d2dbda7e"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lidar_ortho_2017_winter",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lidar_ortho_2017_winter__0"
                          }
                        ]
                      },
                      {
                        id: 1463,
                        name: "lidar_mnh",
                        metadata: {
                          legend_name: "lidar:mnh",
                          metadata_id: "5f189f5b-08f9-4abc-b3f0-78c37ddf0db1"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lidar_mnh",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lidar_mnh__0"
                          }
                        ]
                      },
                      {
                        id: 1787,
                        name: "lidar_tiles_2017",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "3c565aff-7394-4d51-915c-0e06dde7765a",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lidar_tiles_2017",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lidar_tiles_2017__LIDAR2017_tiles_500x500m_grid"
                          },
                          {
                            name: "lidar_tiles_2017__LIDAR2017_parent_tiles_1500x1500_grid"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 484,
                name: "eau_new_Hydrografie",
                children: [
                  {
                    id: 450,
                    name: "eau_new_Gewaessernetz",
                    children: [
                      {
                        id: 749,
                        name: "eau_new_Gew\xE4sser",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:primaere_gewaesser_sekundaere_gewaesser_temporaer_fliessende_baeche",
                          metadata_id: "9da34ec3-89d5-4731-b927-e38ed8088571"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Gew\xE4sser",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Gew\xE4sser__Prim\xE4re Gew\xE4sser"
                          },
                          {
                            name: "eau_new_Gew\xE4sser__Sekund\xE4re Gew\xE4sser"
                          },
                          {
                            name: "eau_new_Gew\xE4sser__Tempor\xE4r fliessende B\xE4che"
                          }
                        ]
                      },
                      {
                        id: 651,
                        name: "eau_new_Kanal_-__Muehlgraben",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:kanal_-__muehlgraben",
                          max_dpi: 128,
                          metadata_id: "909501fc-a0a9-4af8-8e82-f2a8d7f2fe2f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Kanal_-__Muehlgraben",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Kanal_-__Muehlgraben__Kanal -  M\xFChlgraben"
                          }
                        ]
                      },
                      {
                        id: 750,
                        name: "eau_new_Kilometrierung der Gew\xE4sser",
                        metadata: {
                          legend_name: "eau:kilometrierung_primaere_gewaesser_kilometrierung_sekundaere_gewaesser",
                          metadata_id: "4002b1cf-08b5-421a-bc92-40271d62f03c"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Kilometrierung der Gew\xE4sser",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Kilometrierung der Gew\xE4sser__Kilometrierung prim\xE4re Gew\xE4sser"
                          },
                          {
                            name: "eau_new_Kilometrierung der Gew\xE4sser__Kilometrierung sekund\xE4re Gew\xE4sser"
                          }
                        ]
                      },
                      {
                        id: 636,
                        name: "eau_new_Einzugsgebiete",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:einzugsgebiete",
                          max_dpi: 128,
                          metadata_id: "a295a30a-f819-400c-842c-d0ccc695bea5"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Einzugsgebiete",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Einzugsgebiete__Einzugsgebiete"
                          }
                        ]
                      },
                      {
                        id: 569,
                        name: "eau_new_Stausee_Sauer",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:stausee_sauer",
                          max_dpi: 128,
                          metadata_id: "119ad2e3-b44f-4777-883d-d2d522bafeca"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Stausee_Sauer",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Stausee_Sauer__Stausee Sauer"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 451,
                    name: "eau_new_Fischerei",
                    children: [
                      {
                        id: 626,
                        name: "eau_new_Fischereiabschnitte",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:fischereiabschnitte",
                          max_dpi: 128,
                          metadata_id: "bd6be85a-cec4-4e4d-9657-cffa242db28f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Fischereiabschnitte",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Fischereiabschnitte__Fischereiabschnitte"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 187,
            name: "unwelt_biologie_geologie",
            children: [
              {
                id: 338,
                name: "lebensraume_une_biotope",
                children: [
                  {
                    id: 146,
                    name: "env_natura2000",
                    children: [
                      {
                        id: 1915,
                        name: "anf_communes_copil_2020",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "e0369dfa-0219-4a60-84c4-4ce60cec0a02"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "anf_communes_copil_2020",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "anf_communes_copil_2020__COMMUNES_COPIL_2020"
                          }
                        ]
                      },
                      {
                        id: 540,
                        name: "natura2000_habitats",
                        metadata: {
                          is_queryable: true,
                          max_dpi: 128,
                          metadata_id: "080b7d2e-f8d5-4943-8dbf-04d3dfd4fe09"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "natura2000_habitats",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "natura2000_habitats__2"
                          },
                          {
                            name: "natura2000_habitats__0"
                          }
                        ]
                      },
                      {
                        id: 533,
                        name: "natura2000_oiseaux",
                        metadata: {
                          is_queryable: true,
                          max_dpi: 128,
                          metadata_id: "080b7d2e-f8d5-4943-8dbf-04d3dfd4fe09"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "natura2000_oiseaux",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "natura2000_oiseaux__1"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 366,
                    name: "emwelt_biotop_kadaster",
                    children: [
                      {
                        id: 1367,
                        name: "anf_biotopes_points",
                        metadata: {
                          is_queryable: true,
                          legend_name: "env:btk_p",
                          metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "anf_biotopes_points",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "anf_biotopes_points__BIOTOPES_MO_EL_PONCTUELS"
                          }
                        ]
                      },
                      {
                        id: 1368,
                        name: "anf_biotopes_vergers",
                        metadata: {
                          is_queryable: true,
                          legend_name: "env:btk_s",
                          metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "anf_biotopes_vergers",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "anf_biotopes_vergers__BIOTOPES_MO_VERGERS"
                          }
                        ]
                      },
                      {
                        id: 1369,
                        name: "anf_biotopes_surfaces",
                        metadata: {
                          is_queryable: true,
                          legend_name: "env:btk_f",
                          metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "anf_biotopes_surfaces",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "anf_biotopes_surfaces__BIOTOPES_MO_SURFACES"
                          }
                        ]
                      },
                      {
                        id: 1370,
                        name: "anf_biotopes_tampons",
                        metadata: {
                          is_queryable: true,
                          legend_name: "env:btk_b",
                          metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "anf_biotopes_tampons",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "anf_biotopes_tampons__BIOTOPES_MO_ZONES_TAMPONS"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 335,
                name: "weinbau",
                children: [
                  {
                    id: 297,
                    name: "ivv_flik_parcels",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "884ed54c-3b36-417e-b44b-ed7f3283302c"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ivv_flik_parcels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ivv_flik_parcels__0"
                      }
                    ]
                  },
                  {
                    id: 510,
                    name: "ivv_parcels",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "7d372c69-4144-43bf-9622-70dcdc7bbf0b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ivv_parcels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ivv_parcels__0"
                      }
                    ]
                  },
                  {
                    id: 175,
                    name: "ivv_grosslagen",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "89274b7e-4742-4673-b254-9105a4a066b7",
                      start_opacity: 0.5
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ivv_grosslagen",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ivv_grosslagen__lagen"
                      },
                      {
                        name: "ivv_grosslagen__lagen_labels"
                      }
                    ]
                  },
                  {
                    id: 240,
                    name: "ivv_kleinlagen",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "a040071a-3a72-4d69-93e0-c06d4d4c3bd1"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ivv_kleinlagen",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ivv_kleinlagen__0"
                      }
                    ]
                  },
                  {
                    id: 221,
                    name: "ivv_klimakarte",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ivv_klimakarte",
                      metadata_id: "6d989c64-998c-499f-a196-1032e9470666",
                      start_opacity: 0.5
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ivv_klimakarte",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ivv_klimakarte__klimakarte"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 233,
                name: "geologie_",
                children: [
                  {
                    id: 2167,
                    name: "geo_carte_geol_harmonisee",
                    metadata: {
                      is_queryable: true,
                      legend_name: "geol:geologie_harmonisee",
                      metadata_id: "542a0caa-4b33-4019-8ce7-b8541b436106"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "geo_carte_geol_harmonisee",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "geo_carte_geol_harmonisee__Unit\xE9s_g\xE9ologiques2495"
                      },
                      {
                        name: "geo_carte_geol_harmonisee__Symbole"
                      },
                      {
                        name: "geo_carte_geol_harmonisee__Failles"
                      },
                      {
                        name: "geo_carte_geol_harmonisee__Contours"
                      }
                    ]
                  },
                  {
                    id: 2168,
                    name: "geo_carte_geol_harmonisee_decouverte",
                    metadata: {
                      is_queryable: true,
                      legend_name: "geol:geologie_harmonisee_decouverte",
                      metadata_id: "d03be720-e33c-4bd4-8829-559dc951dc2d"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "geo_carte_geol_harmonisee_decouverte",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "geo_carte_geol_harmonisee_decouverte__Unit\xE9s_g\xE9ologiques:_Substratum_rocheux9983"
                      },
                      {
                        name: "geo_carte_geol_harmonisee_decouverte__Symbole"
                      },
                      {
                        name: "geo_carte_geol_harmonisee_decouverte__Failles"
                      },
                      {
                        name: "geo_carte_geol_harmonisee_decouverte__Contours"
                      }
                    ]
                  },
                  {
                    id: 2169,
                    name: "geo_carte_geol_simplifiee",
                    metadata: {
                      is_queryable: true,
                      legend_name: "geol:geologie_simplifiee",
                      metadata_id: "d5235bf1-96c8-4fc8-8d6d-2a0cde246aad"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "geo_carte_geol_simplifiee",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "geo_carte_geol_simplifiee__geologie_simplifiee_substratum"
                      },
                      {
                        name: "geo_carte_geol_simplifiee__geologie_simplifiee_form_sup"
                      },
                      {
                        name: "geo_carte_geol_simplifiee__geologie_simplifiee_failles"
                      }
                    ]
                  },
                  {
                    id: 2170,
                    name: "geo_carte_geol_simplifiee_decouverte",
                    metadata: {
                      is_queryable: true,
                      legend_name: "geol:geologie_simplifiee_decouverte",
                      metadata_id: "d8d627ee-ec11-4054-8a05-f4cd98adbd72"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "geo_carte_geol_simplifiee_decouverte",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "geo_carte_geol_simplifiee_decouverte__geologie_simplifiee_failles"
                      },
                      {
                        name: "geo_carte_geol_simplifiee_decouverte__geologie_simplifiee_substratum"
                      }
                    ]
                  },
                  {
                    id: 2173,
                    name: "geo_coupes_geologiques",
                    metadata: {
                      is_queryable: true,
                      legend_name: "geol:coupes_geologiques",
                      metadata_id: "8a35490a-8dc8-4dfd-9136-edfdd6d08281"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "geo_coupes_geologiques",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "geo_coupes_geologiques__coupes_geologiques"
                      }
                    ]
                  },
                  {
                    id: 2175,
                    name: "geo_epaisseurs_unites",
                    metadata: {
                      is_queryable: true,
                      legend_name: "geol:epaisseurs_unites",
                      metadata_id: "3fab8010-2f8b-43e2-96a7-155a24233db4"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "geo_epaisseurs_unites",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "geo_epaisseurs_unites__epaisseurs_unites"
                      }
                    ]
                  },
                  {
                    id: 2266,
                    name: "forages_grand_public_group",
                    children: [
                      {
                        id: 2176,
                        name: "geo_forages_ref",
                        metadata: {
                          is_queryable: true,
                          legend_name: "geol:forages_ref",
                          metadata_id: "0564eda7-c92d-4a80-b3c7-be94f5d67186"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "geo_forages_ref",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "geo_forages_ref__forages_ref"
                          }
                        ]
                      },
                      {
                        id: 2265,
                        name: "eau_new_Bohrungen_grand_public",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:bohrungen",
                          max_dpi: 128,
                          metadata_id: "4ab49f17-a50e-4439-9a9e-01ec93421aec"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Bohrungen_grand_public",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Bohrungen_grand_public__39"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 2267,
                    name: "eaux_souterraines_grand_public_group",
                    children: [
                      {
                        id: 631,
                        name: "eau_new_Grundwasserleiter",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:grundwasserleiter",
                          max_dpi: 128,
                          metadata_id: "783a8608-e4b3-44ed-8864-68525da33760"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Grundwasserleiter",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Grundwasserleiter__Grundwasserleiter"
                          }
                        ]
                      },
                      {
                        id: 629,
                        name: "eau_new_Quellen",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:quellen",
                          max_dpi: 128,
                          metadata_id: "58fa573a-a0c3-474d-9e74-c277cf90b135"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Quellen",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Quellen__Quellen"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 2191,
                    name: "geo_geomorphologie_carte100K",
                    metadata: {
                      is_queryable: true,
                      legend_name: "geol:geomorphologie100k",
                      metadata_id: "3fd5088b-021d-4207-9d4b-4040e1ccfe22"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "geo_geomorphologie_carte100K",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "geo_geomorphologie_carte100K__geomorphologie100k"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 321,
                name: "pedologie",
                children: [
                  {
                    id: 272,
                    name: "pedologie_100k",
                    metadata: {
                      legend_name: "pedologie",
                      metadata_id: "2d712a34-ce79-426d-a57b-b7cadf97b80f"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "pedologie_100k",
                    imageType: "image/png"
                  },
                  {
                    id: 702,
                    name: "asta_pedologie_new",
                    metadata: {
                      legend_name: "pedologie_new",
                      max_dpi: 128,
                      metadata_id: "37686d89-0173-4040-88c7-be84a3648d01"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "asta_pedologie_new",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "asta_pedologie_new__1"
                      },
                      {
                        name: "asta_pedologie_new__2"
                      },
                      {
                        name: "asta_pedologie_new__3"
                      },
                      {
                        name: "asta_pedologie_new__4"
                      },
                      {
                        name: "asta_pedologie_new__5"
                      },
                      {
                        name: "asta_pedologie_new__6"
                      },
                      {
                        name: "asta_pedologie_new__7"
                      }
                    ]
                  },
                  {
                    id: 704,
                    name: "asta_pedologie_humus",
                    metadata: {
                      legend_name: "asta_corg",
                      max_dpi: 128,
                      metadata_id: "a1b0807c-9bff-4f6a-a5e7-130316742f56"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "asta_pedologie_humus",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "asta_pedologie_humus__0"
                      }
                    ]
                  },
                  {
                    id: 703,
                    name: "asta_pedologie_ph",
                    metadata: {
                      legend_name: "asta_ph",
                      max_dpi: 128,
                      metadata_id: "628ee73f-4c37-4689-bc4c-1fd9f6bd2663"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "asta_pedologie_ph",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "asta_pedologie_ph__0"
                      }
                    ]
                  },
                  {
                    id: 2408,
                    name: "asta_erosion_group",
                    children: [
                      {
                        id: 2407,
                        name: "asta_erosion_2023",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "427aff9b-b988-455c-8cd9-1c029cfd6b6e"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "asta_erosion_2023",
                        imageType: "image/png",
                        childLayers: [
                          {
                            name: "asta_erosion_2023__0"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 486,
                name: "eau_new_Hochwasserrisikomanagement-Richtlinie [HWRM-RL]",
                children: [
                  {
                    id: 1696,
                    name: "eau_new_Risikogewaesser_2019_group",
                    children: [
                      {
                        id: 1703,
                        name: "eau_Risikogewaesser_2019",
                        metadata: {
                          legend_name: "eau:risikogewaesser_2019",
                          metadata_id: "762cd956-9733-4855-afa7-38768a38e8a1"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_Risikogewaesser_2019",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_Risikogewaesser_2019__0"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 2114,
                    name: "eau_Hochwassergefahrenkarten_2021",
                    children: [
                      {
                        id: 2117,
                        name: "eau_Hochwassergefahrenkarten_HQ10_2021",
                        metadata: {
                          legend_name: "eau:inondations_2019",
                          metadata_id: "153130ef-8255-4bce-bca0-d2359d277995"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "eau_Hochwassergefahrenkarten_HQ10_2021",
                        imageType: "image/png"
                      },
                      {
                        id: 2118,
                        name: "eau_Hochwassergefahrenkarten_HQ100_2021",
                        metadata: {
                          legend_name: "eau:inondations_2019",
                          metadata_id: "cdb4137d-822f-4888-8a51-4596480970fe"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "eau_Hochwassergefahrenkarten_HQ100_2021",
                        imageType: "image/png"
                      },
                      {
                        id: 2119,
                        name: "eau_Hochwassergefahrenkarten_HQext_2021",
                        metadata: {
                          legend_name: "eau:inondations_2019",
                          metadata_id: "cd0f52f7-7226-4748-95e0-b77025284423"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "eau_Hochwassergefahrenkarten_HQext_2021",
                        imageType: "image/png"
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 2115,
                    name: "eau_Hochwasserrisikokarten_2021",
                    children: [
                      {
                        id: 2120,
                        name: "eau_Hochwasserrisikokarten_HQ10_2021",
                        metadata: {
                          legend_name: "eau:risque_inondations_2019",
                          metadata_id: "4a428832-16cf-4861-a1da-78a1f0a8c194"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "eau_Hochwasserrisikokarten_HQ10_2021",
                        imageType: "image/png"
                      },
                      {
                        id: 2121,
                        name: "eau_Hochwasserrisikokarten_HQ100_2021",
                        metadata: {
                          legend_name: "eau:risque_inondations_2019",
                          metadata_id: "ccb959ef-0ad6-47ec-ade9-45021912353f"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "eau_Hochwasserrisikokarten_HQ100_2021",
                        imageType: "image/png"
                      },
                      {
                        id: 2122,
                        name: "eau_Hochwasserrisikokarten_HQext_2021",
                        metadata: {
                          legend_name: "eau:risque_inondations_2019",
                          metadata_id: "f803b49a-336a-4bb7-acd9-5cbf508a731f"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "eau_Hochwasserrisikokarten_HQext_2021",
                        imageType: "image/png"
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1711,
                    name: "eau_atlas_crues_subites",
                    children: [
                      {
                        id: 2045,
                        name: "age_dangers_fortes",
                        metadata: {
                          legend_name: "age_dangers_fortes",
                          metadata_id: "55dbe91c-f1e5-4c56-b0b9-4590988e23e5"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "age_dangers_fortes",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "age_dangers_fortes__0"
                          },
                          {
                            name: "age_dangers_fortes__1"
                          }
                        ]
                      },
                      {
                        id: 2046,
                        name: "age_risques_fortes",
                        metadata: {
                          legend_name: "age_risques_fortes",
                          metadata_id: "f1d9b1cd-ad78-44df-89ac-ad591138243f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "age_risques_fortes",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "age_risques_fortes__0"
                          },
                          {
                            name: "age_risques_fortes__1"
                          },
                          {
                            name: "age_risques_fortes__2"
                          },
                          {
                            name: "age_risques_fortes__3"
                          },
                          {
                            name: "age_risques_fortes__4"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 461,
                    name: "eau_new_Historische_Ueberschwemmungsgebiete",
                    children: [
                      {
                        id: 637,
                        name: "eau_new_UESG_1983_-_Mosel",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:uesg_1983_-_mosel",
                          max_dpi: 128,
                          metadata_id: "e6896207-c0f9-417e-9661-119128628e8e"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_UESG_1983_-_Mosel",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_UESG_1983_-_Mosel__UESG 1983 - Mosel"
                          }
                        ]
                      },
                      {
                        id: 641,
                        name: "eau_new_UESG_1993_(ausser_Mosel)",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:uesg_1993_ausser_mosel",
                          max_dpi: 128,
                          metadata_id: "78c692f3-ad20-467b-b03a-0d020a821647"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_UESG_1993_(ausser_Mosel)",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_UESG_1993_(ausser_Mosel)__UESG 1993 [ausser Mosel]"
                          }
                        ]
                      },
                      {
                        id: 642,
                        name: "eau_new_UESG_Alzette_1995",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:uesg_alzette_1995",
                          max_dpi: 128,
                          metadata_id: "aaf81780-df85-4580-a890-fded8ae03db7"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_UESG_Alzette_1995",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_UESG_Alzette_1995__UESG Alzette 1995"
                          }
                        ]
                      },
                      {
                        id: 633,
                        name: "eau_new_UESG_Sauer_1995",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:uesg_sauer_1995",
                          max_dpi: 128,
                          metadata_id: "f01f7be2-0423-4571-8fff-57dd617ae632"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_UESG_Sauer_1995",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_UESG_Sauer_1995__UESG Sauer 1995"
                          }
                        ]
                      },
                      {
                        id: 2116,
                        name: "eau_Hochwasserkarten_2021",
                        children: [
                          {
                            id: 2114,
                            name: "eau_Hochwassergefahrenkarten_2021",
                            children: [
                              {
                                id: 2117,
                                name: "eau_Hochwassergefahrenkarten_HQ10_2021",
                                metadata: {
                                  legend_name: "eau:inondations_2019",
                                  metadata_id: "153130ef-8255-4bce-bca0-d2359d277995"
                                },
                                dimensions: {},
                                type: "WMTS",
                                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                                style: "default",
                                matrixSet: "GLOBAL_WEBMERCATOR",
                                layer: "eau_Hochwassergefahrenkarten_HQ10_2021",
                                imageType: "image/png"
                              },
                              {
                                id: 2118,
                                name: "eau_Hochwassergefahrenkarten_HQ100_2021",
                                metadata: {
                                  legend_name: "eau:inondations_2019",
                                  metadata_id: "cdb4137d-822f-4888-8a51-4596480970fe"
                                },
                                dimensions: {},
                                type: "WMTS",
                                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                                style: "default",
                                matrixSet: "GLOBAL_WEBMERCATOR",
                                layer: "eau_Hochwassergefahrenkarten_HQ100_2021",
                                imageType: "image/png"
                              },
                              {
                                id: 2119,
                                name: "eau_Hochwassergefahrenkarten_HQext_2021",
                                metadata: {
                                  legend_name: "eau:inondations_2019",
                                  metadata_id: "cd0f52f7-7226-4748-95e0-b77025284423"
                                },
                                dimensions: {},
                                type: "WMTS",
                                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                                style: "default",
                                matrixSet: "GLOBAL_WEBMERCATOR",
                                layer: "eau_Hochwassergefahrenkarten_HQext_2021",
                                imageType: "image/png"
                              }
                            ],
                            metadata: {},
                            mixed: true
                          },
                          {
                            id: 2115,
                            name: "eau_Hochwasserrisikokarten_2021",
                            children: [
                              {
                                id: 2120,
                                name: "eau_Hochwasserrisikokarten_HQ10_2021",
                                metadata: {
                                  legend_name: "eau:risque_inondations_2019",
                                  metadata_id: "4a428832-16cf-4861-a1da-78a1f0a8c194"
                                },
                                dimensions: {},
                                type: "WMTS",
                                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                                style: "default",
                                matrixSet: "GLOBAL_WEBMERCATOR",
                                layer: "eau_Hochwasserrisikokarten_HQ10_2021",
                                imageType: "image/png"
                              },
                              {
                                id: 2121,
                                name: "eau_Hochwasserrisikokarten_HQ100_2021",
                                metadata: {
                                  legend_name: "eau:risque_inondations_2019",
                                  metadata_id: "ccb959ef-0ad6-47ec-ade9-45021912353f"
                                },
                                dimensions: {},
                                type: "WMTS",
                                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                                style: "default",
                                matrixSet: "GLOBAL_WEBMERCATOR",
                                layer: "eau_Hochwasserrisikokarten_HQ100_2021",
                                imageType: "image/png"
                              },
                              {
                                id: 2122,
                                name: "eau_Hochwasserrisikokarten_HQext_2021",
                                metadata: {
                                  legend_name: "eau:risque_inondations_2019",
                                  metadata_id: "f803b49a-336a-4bb7-acd9-5cbf508a731f"
                                },
                                dimensions: {},
                                type: "WMTS",
                                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                                style: "default",
                                matrixSet: "GLOBAL_WEBMERCATOR",
                                layer: "eau_Hochwasserrisikokarten_HQext_2021",
                                imageType: "image/png"
                              }
                            ],
                            metadata: {},
                            mixed: true
                          }
                        ],
                        metadata: {},
                        mixed: true
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 463,
                    name: "eau_new_Zusaetzliche_Informationen",
                    children: [
                      {
                        id: 755,
                        name: "eau_new_Gew\xE4sser mit einem signifikanten Hochwasserrisiko",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:gewaesser_mit_einem_signifikanten_hochwasserrisiko",
                          metadata_id: "2006081e-2818-4f2b-978a-8ba505d840a8"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Gew\xE4sser mit einem signifikanten Hochwasserrisiko",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Gew\xE4sser mit einem signifikanten Hochwasserrisiko__Gew\xE4sser mit einem signifikanten Hochwasserrisiko"
                          }
                        ]
                      },
                      {
                        id: 756,
                        name: "eau_new_Hochwasser Brennpunkte",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:hochwasser_brennpunkte",
                          metadata_id: "b2bfd06d-5f05-4abf-8f41-103d40a380e7"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Hochwasser Brennpunkte",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Hochwasser Brennpunkte__Hochwasser Brennpunkte"
                          }
                        ]
                      },
                      {
                        id: 758,
                        name: "eau_new_Ma\xDFnahmens des Hochwasserrisikomanagementplans",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:massnahmens_des_hochwasserrisikomanagementplans",
                          metadata_id: "4326fea6-7ec4-4bb9-861f-4476b0d4ceac"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Ma\xDFnahmens des Hochwasserrisikomanagementplans",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Ma\xDFnahmens des Hochwasserrisikomanagementplans__Ma\xDFnahmens des Hochwasserrisikomanagementplans"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 373,
                name: "eau_new_Trinkwasser_Schutzzonen_(ZPS)",
                children: [
                  {
                    id: 214,
                    name: "eau_new_Provisorische_ZPS",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:provisorische_zps",
                      max_dpi: 128,
                      metadata_id: "ddc51f25-2fb7-4d14-866a-a08f8af8ef03"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Provisorische_ZPS",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Provisorische_ZPS__Provisorische ZPS"
                      }
                    ]
                  },
                  {
                    id: 664,
                    name: "eau_new_ZPS_laufende_oeffentliche_Verfahrungsweise",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:zps_laufende_oeffentliche_verfahrungsweise",
                      max_dpi: 128,
                      metadata_id: "87beb1ac-7496-48f6-b5a9-8666e3897523"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_ZPS_laufende_oeffentliche_Verfahrungsweise",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_ZPS_laufende_oeffentliche_Verfahrungsweise__ZPS laufende \xF6ffentliche Verfahrungsweise"
                      }
                    ]
                  },
                  {
                    id: 573,
                    name: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:zps_durch_grosshrzgl._verordnung_festgelegt",
                      max_dpi: 128,
                      metadata_id: "d70f99e0-6032-4a4b-b516-5dfdfce33b26"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt__ZPS durch grosshrzgl. Verordnung festgelegt"
                      }
                    ]
                  },
                  {
                    id: 1464,
                    name: "eau_prgd_zones_protection_lac",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:prgd_stausee",
                      metadata_id: "eab29425-71cc-4610-b48e-8d848d0a8431"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_prgd_zones_protection_lac",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_prgd_zones_protection_lac__PRGD Schutzzonen Stausee"
                      }
                    ]
                  },
                  {
                    id: 490,
                    name: "eau_new_Sanitaere_Schutzzonen_Stausee_EschSauer",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:sanitaere_schutzzonen_stausee",
                      max_dpi: 128,
                      metadata_id: "e34de488-68ea-48a8-9e92-f67bb209508e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Sanitaere_Schutzzonen_Stausee_EschSauer",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Sanitaere_Schutzzonen_Stausee_EschSauer__Sanit\xE4re Schutzzonen Stausee"
                      }
                    ]
                  },
                  {
                    id: 559,
                    name: "eau_new_Zones_interdiction_utilisation_metazachlore",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau_new:metazachlore",
                      max_dpi: 128,
                      metadata_id: "803e93f8-588f-4697-8d76-972be1ad3531",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Zones_interdiction_utilisation_metazachlore",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Zones_interdiction_utilisation_metazachlore__Zones interdiction utilisation metazachlore"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 469,
                name: "eau_new_Schutzgebiete",
                children: [
                  {
                    id: 656,
                    name: "eau_new_Badegewaesser",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:badegewaesser",
                      max_dpi: 128,
                      metadata_id: "72f770ee-7290-4ecb-9358-580b7cfcadf7"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Badegewaesser",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Badegewaesser__Badegew\xE4sser"
                      }
                    ]
                  },
                  {
                    id: 581,
                    name: "eau_new_Badegewaesser_-_Qualitaet",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:badegewaesser_-_qualitaet",
                      max_dpi: 128,
                      metadata_id: "c0c9c705-8b26-4a0b-b9bb-e2243cd5386a"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Badegewaesser_-_Qualitaet",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Badegewaesser_-_Qualitaet__Badegew\xE4sser - Qualit\xE4t"
                      }
                    ]
                  },
                  {
                    id: 612,
                    name: "eau_new_Empfindliche_Gebiete_(Kommunalabwasserrichtlinie)",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:empfindliche_gebiete_kommunalabwasserrichtlinie",
                      max_dpi: 128,
                      metadata_id: "39952e6c-8e73-4a23-a19c-78c4f06c84d9"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Empfindliche_Gebiete_(Kommunalabwasserrichtlinie)",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Empfindliche_Gebiete_(Kommunalabwasserrichtlinie)__Empfindliche Gebiete [Kommunalabwasserrichtlinie]"
                      }
                    ]
                  },
                  {
                    id: 492,
                    name: "eau_new_Gefaehrdete_Gebiete_(Nitratrichtlinie)",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:gefaehrdete_gebiete_nitratrichtlinie",
                      max_dpi: 128,
                      metadata_id: "9426a9a6-7cb1-4c1a-a504-40dabc4429c0"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Gefaehrdete_Gebiete_(Nitratrichtlinie)",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Gefaehrdete_Gebiete_(Nitratrichtlinie)__Gef\xE4hrdete Gebiete [Nitratrichtlinie]"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 807,
                name: "zpin_group",
                children: [
                  {
                    id: 804,
                    name: "anf_zpin_declarees",
                    metadata: {
                      is_queryable: true,
                      legend_name: "anf:zpin_declarees",
                      metadata_id: "9439d9b1-eff6-47b5-a4c7-4c5bde2744f4"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_zpin_declarees",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_zpin_declarees__ZPIN_DECLAREES"
                      }
                    ]
                  },
                  {
                    id: 805,
                    name: "anf_zpin_a_declarer",
                    metadata: {
                      is_queryable: true,
                      legend_name: "anf:zpin_a_declarer",
                      metadata_id: "db53336b-1a33-4b1a-94a8-42a29b55ce45"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_zpin_a_declarer",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_zpin_a_declarer__ZPIN_A_DECLARER"
                      }
                    ]
                  },
                  {
                    id: 806,
                    name: "anf_zpin_en_procedure",
                    metadata: {
                      is_queryable: true,
                      legend_name: "anf:zpin_en_procedure_reglementaire",
                      metadata_id: "74499cf0-ab69-48bd-a357-8c151dd3d5c9"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_zpin_en_procedure",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_zpin_en_procedure__ZPIN_EN_PROCEDURE_REGLEMENTAIRE"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 470,
                name: "eau_new_Gewaesserschutz",
                children: [
                  {
                    id: 643,
                    name: "eau_new_Abwassersyndikate",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:abwassersyndikate",
                      max_dpi: 128,
                      metadata_id: "4b5e384c-5603-4cf4-9bd5-6e520df5c375"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Abwassersyndikate",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Abwassersyndikate__Abwassersyndikate"
                      }
                    ]
                  },
                  {
                    id: 645,
                    name: "eau_new_Klaeranlagen",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:klaeranlagen",
                      max_dpi: 128,
                      metadata_id: "53e55765-90eb-438f-a744-3ac878b06334"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Klaeranlagen",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Klaeranlagen__Kl\xE4ranlagen"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 474,
                name: "eau_new_Wasserrahmenrichtlinie",
                children: [
                  {
                    id: 1469,
                    name: "eau_strahlwirkungskonzept",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:strahlwirkungskonzept",
                      metadata_id: "e1744b8e-101e-406d-b742-776d488a00b5"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_strahlwirkungskonzept",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_strahlwirkungskonzept__Funktionselemente [Funktionale Verbindungsstrecken]"
                      },
                      {
                        name: "eau_strahlwirkungskonzept__Funktionselemente [Grenzen]"
                      }
                    ]
                  },
                  {
                    id: 475,
                    name: "eau_new_Bewirtschaftungsplan_2009",
                    children: [
                      {
                        id: 644,
                        name: "eau_new_Betrachtungsraeume_2009",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:betrachtungsraeume_2009",
                          max_dpi: 128,
                          metadata_id: "be15dd7d-df57-44e1-b724-0929cf05eef9"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Betrachtungsraeume_2009",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Betrachtungsraeume_2009__Betrachtungsr\xE4ume 2009"
                          }
                        ]
                      },
                      {
                        id: 607,
                        name: "eau_new_Typologie_Oberflaechengewasser_2009",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:typologie_oberflaechengewasser_2009",
                          max_dpi: 128,
                          metadata_id: "0d1d73f0-7644-4217-a0df-b6c497508592"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Typologie_Oberflaechengewasser_2009",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Typologie_Oberflaechengewasser_2009__Typologie Oberfl\xE4chengewasser 2009"
                          }
                        ]
                      },
                      {
                        id: 601,
                        name: "eau_new_Oberflaechenwasserkoerper_2009",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:oberflaechenwasserkoerper_2009",
                          max_dpi: 128,
                          metadata_id: "404cf7b4-f70b-4c2c-a44b-89e297fab0f8"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Oberflaechenwasserkoerper_2009",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Oberflaechenwasserkoerper_2009__Oberfl\xE4chenwasserk\xF6rper 2009"
                          }
                        ]
                      },
                      {
                        id: 634,
                        name: "eau_new_Erheblich ver\xE4nderte Wasserk\xF6rper 2009",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:erheblich_veraenderte_owk_2009",
                          max_dpi: 128,
                          metadata_id: "78da31c2-55eb-40c9-99fe-22ff409468c2"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Erheblich ver\xE4nderte Wasserk\xF6rper 2009",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Erheblich ver\xE4nderte Wasserk\xF6rper 2009__Erheblich ver\xE4nderte OWK 2009"
                          }
                        ]
                      },
                      {
                        id: 603,
                        name: "eau_new_Grundwasserkoerper_2009",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:grundwasserkoerper_2009",
                          max_dpi: 128,
                          metadata_id: "f23ca424-ec87-4c53-929c-7e627a8e06af"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Grundwasserkoerper_2009",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Grundwasserkoerper_2009__Grundwasserk\xF6rper 2009"
                          }
                        ]
                      },
                      {
                        id: 468,
                        name: "eau_new_Zustand_der_Wasserkoerper_(WK)_2009",
                        children: [
                          {
                            id: 464,
                            name: "eau_new_Oberflaechengewaesser_2009",
                            children: [
                              {
                                id: 585,
                                name: "eau_new_Gesamtzustand_2009",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:gesamtzustand_2009",
                                  max_dpi: 128,
                                  metadata_id: "44862c13-7006-44a4-99e6-2877ea512714"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Gesamtzustand_2009",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Gesamtzustand_2009__Gesamtzustand 2009"
                                  }
                                ]
                              },
                              {
                                id: 586,
                                name: "eau_new_Chemischer_Zustand_2009",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:chemischer_zustand_2009",
                                  max_dpi: 128,
                                  metadata_id: "d934fbcc-02c6-47fa-a23d-cfbe49214709"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Chemischer_Zustand_2009",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Chemischer_Zustand_2009__Chemischer Zustand 2009"
                                  }
                                ]
                              },
                              {
                                id: 614,
                                name: "eau_new_Oekologischer_Zustand_2009",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:oekologischer_zustand_2009",
                                  max_dpi: 128,
                                  metadata_id: "92d28c19-ed51-4e9e-8a80-831144fe3553"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Oekologischer_Zustand_2009",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Oekologischer_Zustand_2009__\xD6kologischer Zustand 2009"
                                  }
                                ]
                              },
                              {
                                id: 593,
                                name: "eau_new_Hydromorphologischer_Zustand_2009",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:hydromorphologischer_zustand_2009",
                                  max_dpi: 128,
                                  metadata_id: "0227e64f-11ef-4f0a-8853-48fd7385f2b1"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Hydromorphologischer_Zustand_2009",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Hydromorphologischer_Zustand_2009__Hydromorphologischer Zustand 2009"
                                  }
                                ]
                              }
                            ],
                            metadata: {},
                            mixed: true
                          },
                          {
                            id: 435,
                            name: "eau_new_Grundwasser_2009",
                            children: [
                              {
                                id: 657,
                                name: "eau_new_Zustand_der_WK_2009",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:zustand_der_wk_2009",
                                  max_dpi: 128,
                                  metadata_id: "2df25c38-15d5-447f-a269-4184ce781050"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Zustand_der_WK_2009",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Zustand_der_WK_2009__Zustand der WK 2009"
                                  }
                                ]
                              },
                              {
                                id: 605,
                                name: "eau_new_Quantitativer_Zustand_der_WK_2009",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:quantitativer_zustand_der_wk_2009",
                                  max_dpi: 128,
                                  metadata_id: "a9ebce38-6c8b-447e-9d22-46ba333fa63c"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Quantitativer_Zustand_der_WK_2009",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Quantitativer_Zustand_der_WK_2009__Quantitativer Zustand der WK 2009"
                                  }
                                ]
                              },
                              {
                                id: 441,
                                name: "eau_new_Chemischer_Zustand_der_WK_2009",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:chemischer_zustand_der_wk_2009",
                                  max_dpi: 128,
                                  metadata_id: "e9a72fec-29a0-4183-9e3a-6d4f49c9fea7"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Chemischer_Zustand_der_WK_2009",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Chemischer_Zustand_der_WK_2009__Chemischer Zustand der WK 2009"
                                  }
                                ]
                              }
                            ],
                            metadata: {},
                            mixed: true
                          }
                        ],
                        metadata: {},
                        mixed: true
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 480,
                    name: "eau_new_Bewirtschaftungsplan_2015",
                    children: [
                      {
                        id: 536,
                        name: "eau_new_Oberflaechenwasserkoerper_2015",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:oberflaechenwasserkoerper_2015",
                          max_dpi: 128,
                          metadata_id: "ead261ed-7be1-4435-9cf5-d1527a18bd19"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Oberflaechenwasserkoerper_2015",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Oberflaechenwasserkoerper_2015__Oberfl\xE4chenwasserk\xF6rper 2015"
                          }
                        ]
                      },
                      {
                        id: 658,
                        name: "eau_new_Erheblich ver\xE4nderte Wasserk\xF6rper 2015",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:erheblich_veraenderte_wk_2015",
                          max_dpi: 128,
                          metadata_id: "78da31c2-55eb-40c9-99fe-22ff409468c2"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Erheblich ver\xE4nderte Wasserk\xF6rper 2015",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Erheblich ver\xE4nderte Wasserk\xF6rper 2015__Erheblich ver\xE4nderte WK 2015"
                          }
                        ]
                      },
                      {
                        id: 619,
                        name: "eau_new_Betrachtungsraeume_2015",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:betrachtungsraeume_2015",
                          max_dpi: 128,
                          metadata_id: "be15dd7d-df57-44e1-b724-0929cf05eef9"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Betrachtungsraeume_2015",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Betrachtungsraeume_2015__Betrachtungsr\xE4ume 2015"
                          }
                        ]
                      },
                      {
                        id: 588,
                        name: "eau_new_Typologie_Gewaesser_2015",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:typologie_gewaesser_2015",
                          max_dpi: 128,
                          metadata_id: "c7eea236-ad59-47fc-8c02-630fee3292dc"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Typologie_Gewaesser_2015",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Typologie_Gewaesser_2015__Typologie Gew\xE4sser 2015"
                          }
                        ]
                      },
                      {
                        id: 1470,
                        name: "eau_fliessgewaessertypen_2015",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:fliessgewaessertypen_2015_lawa",
                          metadata_id: "79f4588f-a264-4921-a382-d1f83cf48da3"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_fliessgewaessertypen_2015",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_fliessgewaessertypen_2015__Flie\xDFgew\xE4ssertypen 2015 [LAWA]"
                          }
                        ]
                      },
                      {
                        id: 759,
                        name: "eau_new_Strukturg\xFCtekartierung 2015 [7-stufige Bewertung]",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:strukturguetekartierung_2015_7-stufige_bewertung",
                          metadata_id: "dd28de7b-6182-4054-89a6-dd92b80b565f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Strukturg\xFCtekartierung 2015 [7-stufige Bewertung]",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Strukturg\xFCtekartierung 2015 [7-stufige Bewertung]__Strukturg\xFCtekartierung 2015 [7-stufige Bewertung]"
                          }
                        ]
                      },
                      {
                        id: 760,
                        name: "eau_new_Strukturg\xFCtekartierung 2015 [5-stufige Bewertung]",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:strukturguetekartierung_2015_5-stufige_bewertung",
                          metadata_id: "ff70c904-a6b9-4989-88c0-8359ff52e57e"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Strukturg\xFCtekartierung 2015 [5-stufige Bewertung]",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Strukturg\xFCtekartierung 2015 [5-stufige Bewertung]__Strukturg\xFCtekartierung 2015 [5-stufige Bewertung]"
                          }
                        ]
                      },
                      {
                        id: 761,
                        name: "eau_new_Struktukartierung 2015 in 5 Band [7-stufige Bewertung]",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:5-band_sohle_7-stufige_bewertung_5-band_ufer_links_7-stufige_bewertung_5-band_ufer_rechts_7-stufige_bewertung_5-band_umfeld_links_7-stufige_bewertung_5-band_umfeld_rechts_7-stufige_bewertung",
                          metadata_id: "429d3552-5f72-4be6-9c03-95c76f0a6c07"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Struktukartierung 2015 in 5 Band [7-stufige Bewertung]",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Struktukartierung 2015 in 5 Band [7-stufige Bewertung]__5-Band Sohle [7-stufige Bewertung]"
                          },
                          {
                            name: "eau_new_Struktukartierung 2015 in 5 Band [7-stufige Bewertung]__5-Band Ufer Links [7-stufige Bewertung]"
                          },
                          {
                            name: "eau_new_Struktukartierung 2015 in 5 Band [7-stufige Bewertung]__5-Band Ufer rechts [7-stufige Bewertung]"
                          },
                          {
                            name: "eau_new_Struktukartierung 2015 in 5 Band [7-stufige Bewertung]__5-Band Umfeld links [7-stufige Bewertung]"
                          },
                          {
                            name: "eau_new_Struktukartierung 2015 in 5 Band [7-stufige Bewertung]__5-Band Umfeld rechts [7-stufige Bewertung]"
                          }
                        ]
                      },
                      {
                        id: 763,
                        name: "eau_new_Struktukartierung 2015 in 5 Band [5-stufige Bewertung]",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:5-band_sohle_5-stufige_bewertung_5-band_ufer_links_5-stufige_bewertung_5-band_ufer_rechts_5-stufige_bewertung_5-band_umfeld_links_5-stufige_bewertung_5-band_umfeld_rechts_5-stufige_bewertung",
                          metadata_id: "4c64f3a4-627f-4aa7-9e0c-d3ad003d9afe"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Struktukartierung 2015 in 5 Band [5-stufige Bewertung]",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Struktukartierung 2015 in 5 Band [5-stufige Bewertung]__5-Band Sohle [5-stufige Bewertung]"
                          },
                          {
                            name: "eau_new_Struktukartierung 2015 in 5 Band [5-stufige Bewertung]__5-Band Ufer Links [5-stufige Bewertung]"
                          },
                          {
                            name: "eau_new_Struktukartierung 2015 in 5 Band [5-stufige Bewertung]__5-Band Ufer rechts [5-stufige Bewertung]"
                          },
                          {
                            name: "eau_new_Struktukartierung 2015 in 5 Band [5-stufige Bewertung]__5-Band Umfeld links [5-stufige Bewertung]"
                          },
                          {
                            name: "eau_new_Struktukartierung 2015 in 5 Band [5-stufige Bewertung]__5-Band Umfeld rechts [5-stufige Bewertung]"
                          }
                        ]
                      },
                      {
                        id: 785,
                        name: "eau_new_WRRL und HWRM-RL Massnahmen",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:wrrl_und_hwrm-rl_-_massnahmen",
                          metadata_id: "9a339e4e-eb04-42a0-ac0d-5a5f354c9548"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_WRRL und HWRM-RL Massnahmen",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_WRRL und HWRM-RL Massnahmen__WRRL und HWRM-RL - Massnahmen"
                          }
                        ]
                      },
                      {
                        id: 1471,
                        name: "eau_detailliertes_massnahmenprogramm_sww",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:detailliertes_massnahmenprogramm_sww",
                          metadata_id: "5b9d1544-da64-4a58-b519-9a03e5491e07"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_detailliertes_massnahmenprogramm_sww",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_detailliertes_massnahmenprogramm_sww__Detailliertes Ma\xDFnahmenprogramm SWW"
                          }
                        ]
                      },
                      {
                        id: 659,
                        name: "eau_new_Grundwasserkoerper_2015",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:grundwasserkoerper_2015",
                          max_dpi: 128,
                          metadata_id: "bb5f17b7-ddac-46cc-a59d-25f82d422b5b"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_new_Grundwasserkoerper_2015",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_new_Grundwasserkoerper_2015__Grundwasserk\xF6rper 2015"
                          }
                        ]
                      },
                      {
                        id: 476,
                        name: "eau_new_Zustand_der_Wasserkoerper_(WK)_2015",
                        children: [
                          {
                            id: 479,
                            name: "eau_new_Oberflaechengewaesser_2015",
                            children: [
                              {
                                id: 622,
                                name: "eau_new_Oekologischer_Zustand_2015",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:oekologischer_zustand_2015",
                                  max_dpi: 128,
                                  metadata_id: "5b78d0a5-1984-4efc-9e7d-0cb9d7ca829d"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Oekologischer_Zustand_2015",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Oekologischer_Zustand_2015__\xD6kologischer Zustand 2015"
                                  }
                                ]
                              },
                              {
                                id: 663,
                                name: "eau_new_Gesamtzustand_2015",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:gesamtzustand_2015",
                                  max_dpi: 128,
                                  metadata_id: "bea7140f-b938-4494-ac14-a2252a1d0fcb"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Gesamtzustand_2015",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Gesamtzustand_2015__Gesamtzustand 2015"
                                  }
                                ]
                              },
                              {
                                id: 621,
                                name: "eau_new_Chemischer Zustand 2015_Richtlinie 2008_105_EG",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:chemischer_zustand_2015",
                                  max_dpi: 128,
                                  metadata_id: "7df87ec3-bfad-4d1b-a10b-68670c8073f4"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "621",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Chemischer Zustand 2015_Richtlinie 2008_105_EG__172"
                                  }
                                ]
                              },
                              {
                                id: 764,
                                name: "eau_new_Chemischer_Zustand_ohne_ubiquitaere_Stoffe 2015_Richtlinie_2008_105_EG",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:chemischer_zustand_ohne_ubiquitaere_stoffe_2015_richtlinie_2008_105_eg",
                                  metadata_id: "68f761b4-e1d1-4cda-b4aa-1e61fc812588"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "764",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Chemischer_Zustand_ohne_ubiquitaere_Stoffe 2015_Richtlinie_2008_105_EG__318"
                                  }
                                ]
                              },
                              {
                                id: 765,
                                name: "eau_new_Chemischer_Zustand_2015_Richtlinie 2013_39_EU",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:chemischer_zustand_2015_richtlinie_2013_39_eu",
                                  metadata_id: "7df87ec3-bfad-4d1b-a10b-68670c8073f4"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "765",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Chemischer_Zustand_2015_Richtlinie 2013_39_EU__319"
                                  }
                                ]
                              },
                              {
                                id: 766,
                                name: "eau_new_Chemischer_Zustand_ohne_ubiquitaere_Stoffe_2015_Richtlinie 2013_39_EU",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:chemischer_zustand_ohne_ubiquitaere_stoffe_2015_richtlinie_2013_39_eu",
                                  metadata_id: "d78ac813-7ab3-4162-945a-f87512e66654"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "766",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Chemischer_Zustand_ohne_ubiquitaere_Stoffe_2015_Richtlinie 2013_39_EU__320"
                                  }
                                ]
                              },
                              {
                                id: 466,
                                name: "eau_new_Qualitaetskomponenten_des_oekologischen_Zustands_2015",
                                children: [
                                  {
                                    id: 767,
                                    name: "eau_new_Hydromorphologische Gesamtbewertung 2015",
                                    metadata: {
                                      is_queryable: true,
                                      legend_name: "eau:hydromorphologischer_zustand_2015",
                                      metadata_id: "767e0a8a-31e0-4a53-913f-6ab1c76ca27c"
                                    },
                                    dimensions: {},
                                    type: "WMS",
                                    layers: "eau_new_Hydromorphologische Gesamtbewertung 2015",
                                    imageType: "image/png",
                                    style: "default",
                                    childLayers: [
                                      {
                                        name: "eau_new_Hydromorphologische Gesamtbewertung 2015__Hydromorphologischer Zustand 2015"
                                      }
                                    ]
                                  },
                                  {
                                    id: 769,
                                    name: "eau_new_Morphologie 2015",
                                    metadata: {
                                      is_queryable: true,
                                      legend_name: "eau:morphologie_2015",
                                      metadata_id: "b7812f62-a8b5-4ef4-bbb8-c2e3a9688c93"
                                    },
                                    dimensions: {},
                                    type: "WMS",
                                    layers: "eau_new_Morphologie 2015",
                                    imageType: "image/png",
                                    style: "default",
                                    childLayers: [
                                      {
                                        name: "eau_new_Morphologie 2015__Morphologie 2015"
                                      }
                                    ]
                                  },
                                  {
                                    id: 770,
                                    name: "eau_new_Durchg\xE4ngigkeit 2015",
                                    metadata: {
                                      is_queryable: true,
                                      legend_name: "eau:durchgaengigkeit_2015",
                                      metadata_id: "4983c058-3d33-4b6f-b801-de1113a11f27"
                                    },
                                    dimensions: {},
                                    type: "WMS",
                                    layers: "eau_new_Durchg\xE4ngigkeit 2015",
                                    imageType: "image/png",
                                    style: "default",
                                    childLayers: [
                                      {
                                        name: "eau_new_Durchg\xE4ngigkeit 2015__Durchg\xE4ngigkeit 2015"
                                      }
                                    ]
                                  },
                                  {
                                    id: 583,
                                    name: "eau_new_Physiko-Chemie_2015",
                                    metadata: {
                                      is_queryable: true,
                                      legend_name: "eau:physiko-chemie_2015",
                                      max_dpi: 128,
                                      metadata_id: "45702d13-2608-4300-ba54-0e078c96386c"
                                    },
                                    dimensions: {},
                                    type: "WMS",
                                    layers: "eau_new_Physiko-Chemie_2015",
                                    imageType: "image/png",
                                    style: "default",
                                    childLayers: [
                                      {
                                        name: "eau_new_Physiko-Chemie_2015__Physiko-Chemie 2015"
                                      }
                                    ]
                                  },
                                  {
                                    id: 771,
                                    name: "eau_new_Phytoplankton 2015",
                                    metadata: {
                                      is_queryable: true,
                                      legend_name: "eau:phytoplankton_2015",
                                      metadata_id: "e5d8434c-c367-4a56-a7d1-aa60f70a301f"
                                    },
                                    dimensions: {},
                                    type: "WMS",
                                    layers: "eau_new_Phytoplankton 2015",
                                    imageType: "image/png",
                                    style: "default",
                                    childLayers: [
                                      {
                                        name: "eau_new_Phytoplankton 2015__Phytoplankton 2015"
                                      }
                                    ]
                                  },
                                  {
                                    id: 662,
                                    name: "eau_new_Makrophyten_2015",
                                    metadata: {
                                      is_queryable: true,
                                      legend_name: "eau:aquatische_flora_2015",
                                      max_dpi: 128,
                                      metadata_id: "fe673001-2447-4e3c-bce6-4606b6bf222d"
                                    },
                                    dimensions: {},
                                    type: "WMS",
                                    layers: "eau_new_Makrophyten_2015",
                                    imageType: "image/png",
                                    style: "default",
                                    childLayers: [
                                      {
                                        name: "eau_new_Makrophyten_2015__aquatische Flora 2015"
                                      }
                                    ]
                                  },
                                  {
                                    id: 600,
                                    name: "eau_new_Makro-Invertebraten_2015",
                                    metadata: {
                                      is_queryable: true,
                                      legend_name: "eau:makro-invertebraten_2015",
                                      max_dpi: 128,
                                      metadata_id: "b8a59482-2696-4b9a-a527-3201597a4caf"
                                    },
                                    dimensions: {},
                                    type: "WMS",
                                    layers: "eau_new_Makro-Invertebraten_2015",
                                    imageType: "image/png",
                                    style: "default",
                                    childLayers: [
                                      {
                                        name: "eau_new_Makro-Invertebraten_2015__Makro-Invertebraten 2015"
                                      }
                                    ]
                                  },
                                  {
                                    id: 646,
                                    name: "eau_new_Fische_2015",
                                    metadata: {
                                      is_queryable: true,
                                      legend_name: "eau:fische_2015",
                                      max_dpi: 128,
                                      metadata_id: "f44a6aa7-6dcc-4d99-9033-c13ef23ebef4"
                                    },
                                    dimensions: {},
                                    type: "WMS",
                                    layers: "eau_new_Fische_2015",
                                    imageType: "image/png",
                                    style: "default",
                                    childLayers: [
                                      {
                                        name: "eau_new_Fische_2015__Fische 2015"
                                      }
                                    ]
                                  }
                                ],
                                metadata: {},
                                mixed: true
                              }
                            ],
                            metadata: {},
                            mixed: true
                          },
                          {
                            id: 471,
                            name: "eau_new_Grundwasser_2015",
                            children: [
                              {
                                id: 591,
                                name: "eau_new_Zustand_der_WK_2015",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:zustand_der_wk_2015",
                                  max_dpi: 128,
                                  metadata_id: "489c9b85-6c3c-4019-b3ee-096936b2683c"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Zustand_der_WK_2015",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Zustand_der_WK_2015__Zustand der WK 2015"
                                  }
                                ]
                              },
                              {
                                id: 592,
                                name: "eau_new_Quantitativer_Zustand_der_WK_2015",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:quantitativer_zustand_der_wk_2015",
                                  max_dpi: 128,
                                  metadata_id: "333c7e4f-cdc3-439a-aa13-ca0f9138c764"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Quantitativer_Zustand_der_WK_2015",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Quantitativer_Zustand_der_WK_2015__Quantitativer Zustand der WK 2015"
                                  }
                                ]
                              },
                              {
                                id: 632,
                                name: "eau_new_Chemischer_Zustand_der_WK_2015",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:chemischer_zustand_der_wk_2015",
                                  max_dpi: 128,
                                  metadata_id: "ddd64c4a-f5af-4bbb-a7d3-3db1016ee541"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Chemischer_Zustand_der_WK_2015",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Chemischer_Zustand_der_WK_2015__Chemischer Zustand der WK 2015"
                                  }
                                ]
                              }
                            ],
                            metadata: {},
                            mixed: true
                          }
                        ],
                        metadata: {},
                        mixed: true
                      },
                      {
                        id: 458,
                        name: "eau_new_Risikobeurteilung",
                        children: [
                          {
                            id: 467,
                            name: "eau_new_Grundwasser_2021",
                            children: [
                              {
                                id: 773,
                                name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2021",
                                metadata: {
                                  legend_name: "eau:risikobeurteilung_des_wk_hinsichtlich_der_verfehlung_des_guten_zustandes_2021",
                                  metadata_id: "be59d518-15cb-4417-a6ba-e8f5b61ea76a"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2021",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2021__Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2021"
                                  }
                                ]
                              },
                              {
                                id: 661,
                                name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4\xDFigen Zustandes 2021",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:risikobeurteilung_des_wk_hinsichtlich_der_verfehlung_des_guten_mengenmaessigen_zustandes",
                                  max_dpi: 128,
                                  metadata_id: "f9420947-188b-498a-97aa-98d30601995a"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4\xDFigen Zustandes 2021",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4\xDFigen Zustandes 2021__Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4ssigen Zustandes"
                                  }
                                ]
                              },
                              {
                                id: 660,
                                name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes 2021",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:risikobeurteilung_des_wk_hinsichtlich_der_verfehlung_des_guten_chemischen_zustandes",
                                  max_dpi: 128,
                                  metadata_id: "1070a8cd-4ee7-4865-8e0c-e2c31d09ab68"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes 2021",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes 2021__Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes"
                                  }
                                ]
                              }
                            ],
                            metadata: {},
                            mixed: true
                          },
                          {
                            id: 772,
                            name: "eau_new_Grundwasser 2027",
                            children: [
                              {
                                id: 774,
                                name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2027",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:risikobeurteilung_des_wk_hinsichtlich_der_verfehlung_des_guten_zustandes_2027",
                                  metadata_id: "019a4e7d-4ddf-492a-a11d-1e5e36793842"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2027",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2027__Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2027"
                                  }
                                ]
                              },
                              {
                                id: 776,
                                name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4\xDFigen Zustandes 2027",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:risikobeurteilung_des_wk_hinsichtlich_der_verfehlung_des_guten_mengenmaessigen_zustandes_2027",
                                  metadata_id: "199d0bbb-5ed1-4c94-b92b-e30edc57bbb0"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4\xDFigen Zustandes 2027",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4\xDFigen Zustandes 2027__Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4ssigen Zustandes 2027"
                                  }
                                ]
                              },
                              {
                                id: 777,
                                name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes 2027",
                                metadata: {
                                  legend_name: "eau:risikobeurteilung_des_wk_hinsichtlich_der_verfehlung_des_guten_chemischen_zustandes_2027",
                                  metadata_id: "2cba7832-6e24-4ebe-b65c-6119c6c3b287"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes 2027",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes 2027__Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes 2027"
                                  }
                                ]
                              }
                            ],
                            metadata: {},
                            mixed: true
                          }
                        ],
                        metadata: {},
                        mixed: true
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 2085,
                    name: "eau_Bewirtschaftungsplan_2021",
                    children: [
                      {
                        id: 2090,
                        name: "eau_Oberflaechenwasserkoerper_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:oberflaechenwasserkoerper_2021",
                          max_dpi: 128,
                          metadata_id: "c50b2bc7-aeb7-4d3e-9349-09eb3ec0f927"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_Oberflaechenwasserkoerper_2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_Oberflaechenwasserkoerper_2021__386"
                          }
                        ]
                      },
                      {
                        id: 2091,
                        name: "eau_Erheblich ver\xE4nderte Wasserk\xF6rper 2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:erheblich_veraenderte_wk_2021",
                          max_dpi: 128,
                          metadata_id: "311cc30b-8092-4816-9f86-87d5f2995706"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_Erheblich ver\xE4nderte Wasserk\xF6rper 2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_Erheblich ver\xE4nderte Wasserk\xF6rper 2021__387"
                          }
                        ]
                      },
                      {
                        id: 2086,
                        name: "eau_Entwurf_Massnahmenprogramm_HY_2021",
                        children: [
                          {
                            id: 2092,
                            name: "eau_Weiderherstellung_Durchgaengigkeit_Querbauwerk_2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:wiederherstellung_der_oekologischen_durchgaengigkeit",
                              metadata_id: "c150f6a5-41c7-477a-9d44-c0a26a502d85"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_Weiderherstellung_Durchgaengigkeit_Querbauwerk",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_Weiderherstellung_Durchgaengigkeit_Querbauwerk_2021__389"
                              }
                            ]
                          },
                          {
                            id: 2093,
                            name: "eau_Weiderherstellung_Durchgaengigkeit_Verrohrung_2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:wiederherstellung_der_oekologischen_durchgaengigkeit_durchlass",
                              metadata_id: "569bf0ea-c428-4171-aba6-8f2ace180a10"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_Weiderherstellung_Durchgaengigkeit_Verrohrung_2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_Weiderherstellung_Durchgaengigkeit_Verrohrung_2021__390"
                              }
                            ]
                          },
                          {
                            id: 2094,
                            name: "eau_Strukturelemente_Sohle_2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:einbau_von_strukturelementen_in_sohle",
                              metadata_id: "2d233ca6-553e-43bf-ba25-f46b88f63710"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_Strukturelemente_Sohle_2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_Strukturelemente_Sohle_2021__391"
                              }
                            ]
                          },
                          {
                            id: 2095,
                            name: "eau_Umgestalten_Sohlverbau_2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:entfernen_umgestalten_von_sohlverbau",
                              metadata_id: "0d30a3ee-e860-4816-b5c8-9f43e93020e3"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_Umgestalten_Sohlverbau_2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_Umgestalten_Sohlverbau_2021__392"
                              }
                            ]
                          },
                          {
                            id: 2096,
                            name: "eau_Stroemungslenkern_2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:einbau_von_stroemungslenkern_fuer_eigendynamik",
                              metadata_id: "b86c62a9-0ec8-4d35-878f-b275e74ff02e"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_Stroemungslenkern_2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_Stroemungslenkern_2021__393"
                              }
                            ]
                          },
                          {
                            id: 2097,
                            name: "eau_Umgestalten_Uferverbau_2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:entfernen_umgestalten_von_uferverbau",
                              metadata_id: "bec0ccbc-09b5-4351-8b72-f0e458fc7d19"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_Umgestalten_Uferverbau_2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_Umgestalten_Uferverbau_2021__394"
                              }
                            ]
                          },
                          {
                            id: 2098,
                            name: "eau_naturnah_Gewaesserbett_2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:wiederherstellung_von_naturnaher_laufentwicklung_und_gewaesserbett",
                              metadata_id: "3ddf627c-90ae-4b58-a05e-20925493dcf9"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_naturnah_Gewaesserbett_2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_naturnah_Gewaesserbett_2021__395"
                              }
                            ]
                          },
                          {
                            id: 2099,
                            name: "eau_Gewaesserrandstreifen_2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:anlage_eines_gewaesserrandstreifens",
                              metadata_id: "3bc0e52d-954b-47d3-8905-1ecfe7108ce0"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_Gewaesserrandstreifen_2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_Gewaesserrandstreifen_2021__396"
                              }
                            ]
                          },
                          {
                            id: 2100,
                            name: "eau_Gewaesserentwicklungskorridor_2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:anlage_eines_gewaesser_entwicklungskorridors",
                              metadata_id: "13299bf5-57ca-4538-993e-7c00f6247722"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_Gewaesserentwicklungskorridor_2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_Gewaesserentwicklungskorridor_2021__397"
                              }
                            ]
                          },
                          {
                            id: 2101,
                            name: "eau_natuerlich_Ueberflutungsraeume_2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:sicherung_und_erweiterung_natuerlicher_ueberflutungsraeume_und_augewaesser",
                              metadata_id: "7fb0080e-d178-401d-83de-7595ef1885b5"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_natuerlich_Ueberflutungsraeume_2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_natuerlich_Ueberflutungsraeume_2021__398"
                              }
                            ]
                          },
                          {
                            id: 2102,
                            name: "eau_eigendynamische_Entwicklung_2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:zulassen_von_eigendynamischer_entwicklung",
                              metadata_id: "d13e22e9-d22a-48a0-838d-3d7c914ccfe3"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_eigendynamische_Entwicklung_2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_eigendynamische_Entwicklung_2021__399"
                              }
                            ]
                          },
                          {
                            id: 2103,
                            name: "eau_naturnahe_Abflussverhaeltnisse_2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:widerherstellung_und_sicherung_naturnaher_abflussverhaeltnisse",
                              metadata_id: "b3f8a9e0-17f7-4b64-a34b-6ee6de972b52"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_naturnahe_Abflussverhaeltnisse_2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_naturnahe_Abflussverhaeltnisse_2021__400"
                              }
                            ]
                          },
                          {
                            id: 2104,
                            name: "eau_naturnaher_Wasserhaushalt_2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:wiederherstellung_und_sicherung_naturnahem_wasserhaushalt",
                              metadata_id: "91008390-557e-4db3-8d7c-e608a5478edb"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_naturnaher_Wasserhaushalt_2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_naturnaher_Wasserhaushalt_2021__401"
                              }
                            ]
                          },
                          {
                            id: 2105,
                            name: "eau_Abflussregulierung_2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:abflussregulierung",
                              metadata_id: "393be87d-44ce-42e1-9b81-9585aa2d7678"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_Abflussregulierung_2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_Abflussregulierung_2021__402"
                              }
                            ]
                          }
                        ],
                        metadata: {},
                        mixed: true
                      },
                      {
                        id: 2106,
                        name: "eau_Masssnahmenprogramm_SWW_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:detailliertes_massnahmenprogramm_sww_2021",
                          metadata_id: "10f4a12e-1a67-42d5-b575-8993e2f3aa68"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_Masssnahmenprogramm_SWW_2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_Masssnahmenprogramm_SWW_2021__403"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 312,
                name: "umweltuberwachung",
                children: [
                  {
                    id: 283,
                    name: "asta_meteo",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "23e4b02d-a93d-47a4-8597-060319ae2af5"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "asta_meteo",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "asta_meteo__meteo"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 273,
                name: "anf_data_map",
                children: [
                  {
                    id: 427,
                    name: "anf_arrondissements",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "0ed72c13-1975-4cef-90de-1e4b737f5fbd"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_arrondissements",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_arrondissements__ARRONDISSEMENTS"
                      }
                    ]
                  },
                  {
                    id: 428,
                    name: "anf_triages",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "d4bb012a-73ab-4d3c-ac0c-f31e9df07d34"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_triages",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_triages__TRIAGES"
                      }
                    ]
                  },
                  {
                    id: 1783,
                    name: "anf_lots_chasse_2021",
                    metadata: {
                      exclusion: "[340]",
                      is_queryable: true,
                      metadata_id: "a8d8f46d-f6b1-4bb0-9935-be825cffab3f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_lots_chasse_2021",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_lots_chasse_2021__LOTS_CHASSE_2021"
                      }
                    ]
                  },
                  {
                    id: 1786,
                    name: "anf_chasse_assemblees",
                    metadata: {
                      exclusion: "[340]",
                      is_queryable: true,
                      metadata_id: "83cfd21b-dad7-4df5-88a9-a98a07f2a228"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_chasse_assemblees",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_chasse_assemblees__0"
                      }
                    ]
                  },
                  {
                    id: 444,
                    name: "anf_dates_battues",
                    metadata: {
                      exclusion: "[340]",
                      metadata_id: "cd5c65e3-ce29-4317-bc07-127bc679861f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_dates_battues",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_dates_battues__BATTUES_CHASSE"
                      }
                    ]
                  },
                  {
                    id: 677,
                    name: "anf_proprietes_forestieres",
                    metadata: {
                      is_queryable: true,
                      legend_name: "anf:proprietes_forestieres",
                      metadata_id: "fa6d38c7-263c-4349-b208-45652f9b98ca"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_proprietes_forestieres",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_proprietes_forestieres__PROPRIETES_FORESTIERES"
                      }
                    ]
                  },
                  {
                    id: 419,
                    name: "anf_arbres_remarquables",
                    metadata: {
                      is_queryable: true,
                      legend_name: "anf:arbres_remarquables",
                      metadata_id: "373df6df-a91c-4e66-b211-ac2bc1675d56"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_arbres_remarquables",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_arbres_remarquables__ARBRES_REMARQUABLES"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1657,
            name: "main_culture",
            children: [
              {
                id: 1656,
                name: "unesco_patrimoine",
                children: [
                  {
                    id: 1651,
                    name: "unesco_city_boundary",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "50b22938-4d06-48de-9ff0-d1b7f5f6f39d"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=502"
                  },
                  {
                    id: 1655,
                    name: "unesco_city_bufferzone",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "39935dc9-9529-4adb-8cd4-97f9c9600c63"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=506"
                  },
                  {
                    id: 1652,
                    name: "unesco_city_old_quarters",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "168b93e8-7bc4-451c-a642-e2c788e1cc59"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=503"
                  },
                  {
                    id: 1653,
                    name: "unesco_city_other_quarters",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "1d4e8d00-541a-4600-931d-b768b7a42fdb"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=504"
                  },
                  {
                    id: 1654,
                    name: "unesco_city_fortress",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "bc00d9de-4a11-4375-ae74-2f46fb6f7359"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=505"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1811,
                name: "culture_institutions",
                children: [
                  {
                    id: 1800,
                    name: "sip_theatres",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "6745d7eb-93e3-4f55-be5f-2286903e46f0",
                      start_opacity: 0.9
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "1800",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "sip_theatres__POI"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1380,
            name: "lidar_group",
            children: [
              {
                id: 1792,
                name: "act_lidar_2019_group",
                children: [
                  {
                    id: 1794,
                    name: "lidar_2019_mns_public",
                    metadata: {
                      legend_name: "lidar:mns2019",
                      metadata_id: "30f3dc03-7b04-4938-95c4-f0e219ce65c8"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR_4_V3",
                    layer: "lidar_2019_mns_public",
                    imageType: "image/png"
                  },
                  {
                    id: 1795,
                    name: "lidar_2019_mnt_public",
                    metadata: {
                      legend_name: "lidar:mnt2019",
                      metadata_id: "ba62d5be-9c71-406a-8b46-a36bfaa36357"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR_4_V3",
                    layer: "lidar_2019_mnt_public",
                    imageType: "image/png"
                  },
                  {
                    id: 1789,
                    name: "ortho_2019_winter",
                    metadata: {
                      exclusion: "[118,218]",
                      metadata_id: "d6cc500f-b802-4be2-a49c-73f3eb2d131e"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2019_winter",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 1788,
                    name: "lidar_tiles_2019",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "b19a500a-b8d5-4a87-a8f3-00f58c3dffcd",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "lidar_tiles_2019",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "lidar_tiles_2019__LIDAR2019_tiles_500x500m_grid"
                      },
                      {
                        name: "lidar_tiles_2019__LIDAR2019_parent_tiles_1500x1500_grid"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1791,
                name: "act_lidar_2017_group",
                children: [
                  {
                    id: 1377,
                    name: "lidar_mns",
                    metadata: {
                      legend_name: "lidar:mns2017",
                      metadata_id: "e7184a37-7a6a-4e07-ae8d-ff06d9969da0"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "lidar_mns",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "lidar_mns__0"
                      }
                    ]
                  },
                  {
                    id: 1378,
                    name: "lidar_mnt",
                    metadata: {
                      legend_name: "lidar:mnt2017",
                      metadata_id: "1adab94e-d80a-4e19-a808-28f52f633186"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "lidar_mnt",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "lidar_mnt__0"
                      }
                    ]
                  },
                  {
                    id: 1379,
                    name: "lidar_ortho_2017_winter",
                    metadata: {
                      exclusion: "[115,215]",
                      metadata_id: "a2f1a418-6b8b-44e3-9982-1f37d2dbda7e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "lidar_ortho_2017_winter",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "lidar_ortho_2017_winter__0"
                      }
                    ]
                  },
                  {
                    id: 1463,
                    name: "lidar_mnh",
                    metadata: {
                      legend_name: "lidar:mnh",
                      metadata_id: "5f189f5b-08f9-4abc-b3f0-78c37ddf0db1"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "lidar_mnh",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "lidar_mnh__0"
                      }
                    ]
                  },
                  {
                    id: 1787,
                    name: "lidar_tiles_2017",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "3c565aff-7394-4d51-915c-0e06dde7765a",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "lidar_tiles_2017",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "lidar_tiles_2017__LIDAR2017_tiles_500x500m_grid"
                      },
                      {
                        name: "lidar_tiles_2017__LIDAR2017_parent_tiles_1500x1500_grid"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1929,
            name: "zones_UAS",
            children: [
              {
                id: 1927,
                name: "zones_UAS_0_50m",
                metadata: {
                  is_queryable: true,
                  legend_name: "drones",
                  metadata_id: "5589a912-bfa0-4b57-a560-b67e5ff342b9",
                  start_opacity: 0.6
                },
                dimensions: {},
                type: "WMS",
                layers: "zones_UAS_0_50m",
                imageType: "image/png",
                childLayers: [
                  {
                    name: "zones_UAS_0_50m__Zone_UAS_0_to_50_m"
                  }
                ]
              },
              {
                id: 1928,
                name: "zones_UAS_50_120m",
                metadata: {
                  is_queryable: true,
                  legend_name: "drones",
                  metadata_id: "9e5b263b-4a81-4841-824c-8c44e6261470",
                  start_opacity: 0.6
                },
                dimensions: {},
                type: "WMS",
                layers: "zones_UAS_50_120m",
                imageType: "image/png",
                childLayers: [
                  {
                    name: "zones_UAS_50_120m__Zones_UAS_50_to_120m"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1835,
            name: "ilr_energie_group",
            children: [
              {
                id: 1946,
                name: "ilr_energie_canton",
                children: [
                  {
                    id: 1934,
                    name: "ilr_energie_cantons_biogas",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:biogaz",
                      metadata_id: "3caf3f4a-f492-4635-8c8e-b1b7ad37ae24-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_cantons_biogas",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_cantons_biogas__11"
                      },
                      {
                        name: "ilr_energie_cantons_biogas__12"
                      }
                    ]
                  },
                  {
                    id: 1935,
                    name: "ilr_energie_cantons_biomasse",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:biomasse",
                      metadata_id: "021ba8d1-2af9-45b7-8e30-c461ae56416a"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_cantons_biomasse",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_cantons_biomasse__9"
                      },
                      {
                        name: "ilr_energie_cantons_biomasse__12"
                      }
                    ]
                  },
                  {
                    id: 1936,
                    name: "ilr_energie_cantons_cogeneration",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:cogeneration",
                      metadata_id: "71a854b4-010d-48a4-acc1-8eddc2bb87c1-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_cantons_cogeneration",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_cantons_cogeneration__7"
                      },
                      {
                        name: "ilr_energie_cantons_cogeneration__12"
                      }
                    ]
                  },
                  {
                    id: 1937,
                    name: "ilr_energie_cantons_eolienne",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:eolienne",
                      metadata_id: "97ce42fc-848c-4c1c-a361-61a9736ae97f-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_cantons_eolienne",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_cantons_eolienne__5"
                      },
                      {
                        name: "ilr_energie_cantons_eolienne__12"
                      }
                    ]
                  },
                  {
                    id: 1938,
                    name: "ilr_energie_cantons_hydroelectrique",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:hydroelectrique",
                      metadata_id: "a96e0c84-8dcc-49af-a753-7321072aa198-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_cantons_hydroelectrique",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_cantons_hydroelectrique__3"
                      },
                      {
                        name: "ilr_energie_cantons_hydroelectrique__12"
                      }
                    ]
                  },
                  {
                    id: 1939,
                    name: "ilr_energie_cantons_photovoltaique",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:solaire",
                      metadata_id: "1bd8193e-5728-4020-be60-9677f3a2c2d6-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_cantons_photovoltaique",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_cantons_photovoltaique__1"
                      },
                      {
                        name: "ilr_energie_cantons_photovoltaique__12"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1947,
                name: "ilr_energie_commune",
                children: [
                  {
                    id: 1940,
                    name: "ilr_energie_communes_biogas",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:biogaz",
                      metadata_id: "3caf3f4a-f492-4635-8c8e-b1b7ad37ae24-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_communes_biogas",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_communes_biogas__10"
                      },
                      {
                        name: "ilr_energie_communes_biogas__12"
                      }
                    ]
                  },
                  {
                    id: 1941,
                    name: "ilr_energie_communes_biomasse",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:biomasse",
                      metadata_id: "021ba8d1-2af9-45b7-8e30-c461ae56416a"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_communes_biomasse",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_communes_biomasse__8"
                      },
                      {
                        name: "ilr_energie_communes_biomasse__12"
                      }
                    ]
                  },
                  {
                    id: 1942,
                    name: "ilr_energie_communes_cogeneration",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:cogeneration",
                      metadata_id: "71a854b4-010d-48a4-acc1-8eddc2bb87c1-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_communes_cogeneration",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_communes_cogeneration__6"
                      },
                      {
                        name: "ilr_energie_communes_cogeneration__12"
                      }
                    ]
                  },
                  {
                    id: 1943,
                    name: "ilr_energie_communes_eolienne",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:eolienne",
                      metadata_id: "97ce42fc-848c-4c1c-a361-61a9736ae97f-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_communes_eolienne",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_communes_eolienne__4"
                      },
                      {
                        name: "ilr_energie_communes_eolienne__12"
                      }
                    ]
                  },
                  {
                    id: 1944,
                    name: "ilr_energie_communes_hydroelectrique",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:hydroelectrique",
                      metadata_id: "a96e0c84-8dcc-49af-a753-7321072aa198-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_communes_hydroelectrique",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_communes_hydroelectrique__2"
                      },
                      {
                        name: "ilr_energie_communes_hydroelectrique__12"
                      }
                    ]
                  },
                  {
                    id: 1945,
                    name: "ilr_energie_communes_photovoltaique",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:solaire",
                      metadata_id: "1bd8193e-5728-4020-be60-9677f3a2c2d6-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_communes_photovoltaique",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_communes_photovoltaique__0"
                      },
                      {
                        name: "ilr_energie_communes_photovoltaique__12"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 2132,
            name: "meteo_live",
            children: [
              {
                id: 2133,
                name: "meteo_live_temp",
                metadata: {
                  metadata_id: "60fd8ad2-e4aa-45c7-80a7-62b7551e0c6b"
                },
                dimensions: {},
                type: "WMS",
                layers: "meteo_live_temp",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "meteo_live_temp__MF.PointTimeSeriesObservation_Live_ASTA_avg_ta200"
                  }
                ]
              },
              {
                id: 2139,
                name: "meteo_live_precipitation_sum",
                metadata: {
                  metadata_id: "cd98c205-6413-49f0-88dd-8c68b02bb68c"
                },
                dimensions: {},
                type: "WMS",
                layers: "meteo_live_precipitation_sum",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "meteo_live_precipitation_sum__MF.PointTimeSeriesObservation_Live_ASTA_sum_nn050"
                  }
                ]
              },
              {
                id: 2135,
                name: "meteo_live_humidity",
                metadata: {
                  metadata_id: "7b09bc66-20a9-4d8b-9ae9-0c89f4fddcdf"
                },
                dimensions: {},
                type: "WMS",
                layers: "meteo_live_humidity",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "meteo_live_humidity__MF.PointTimeSeriesObservation_Live_ASTA_avg_rh200"
                  }
                ]
              },
              {
                id: 2136,
                name: "meteo_live_windspeed",
                metadata: {
                  metadata_id: "8f12d598-539c-4f58-a401-4422a392f995"
                },
                dimensions: {},
                type: "WMS",
                layers: "meteo_live_windspeed",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "meteo_live_windspeed__MF.PointTimeSeriesObservation_Live_ASTA_avg_wv1000"
                  }
                ]
              },
              {
                id: 2138,
                name: "meteo_live_sunshine",
                metadata: {
                  metadata_id: "b05144c8-f416-4bd7-96fe-2d992650db9f"
                },
                dimensions: {},
                type: "WMS",
                layers: "meteo_live_sunshine",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "meteo_live_sunshine__MF.PointTimeSeriesObservation_Live_ASTA_sum_ssd"
                  }
                ]
              },
              {
                id: 2137,
                name: "meteo_live_irradiation",
                metadata: {
                  metadata_id: "f1fb363e-1d4e-4fba-9c05-82ddcc8f1e72"
                },
                dimensions: {},
                type: "WMS",
                layers: "meteo_live_irradiation",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "meteo_live_irradiation__MF.PointTimeSeriesObservation_Live_ASTA_sum_gs200"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          css: "main.css",
          display_in_switcher: true,
          fake_scales: [
            "750",
            "1500",
            "3000",
            "6000",
            "15000",
            "30000",
            "60000",
            "150000",
            "300000",
            "450000",
            "700000",
            "1500000"
          ],
          page_title: "map.geoportail.lu",
          print_img: "bandeau.jpg",
          print_long_txt_de: "Das \xF6ffentliche Geoportal des Grossherzogtums Luxemburg",
          print_long_txt_en: "The official geoportal for the Grand-Duchy of Luxembourg",
          print_long_txt_fr: "Le g\xE9oportail officiel du Grand-Duch\xE9 de Luxembourg",
          print_long_txt_lu: "Den offizielle Geoportal vu L\xEBtzebuerg",
          print_scales: [
            "1000",
            "1500",
            "2500",
            "5000",
            "10000",
            "15000",
            "20000",
            "25000",
            "50000",
            "80000",
            "100000",
            "125000",
            "200000",
            "250000",
            "400000"
          ],
          print_short_txt_de: "map.geoportal.lu",
          print_short_txt_en: "map.geoportal.lu",
          print_short_txt_fr: "map.geoportal.lu",
          print_short_txt_lu: "map.geoportal.lu",
          resolutions: [
            "500.0",
            "250.0",
            "150.0",
            "100.0",
            "50.0",
            "20.0",
            "10.0",
            "5.0",
            "2.0",
            "1.0",
            "0.5",
            "0.25"
          ],
          show_in_mobile: true
        }
      },
      {
        id: 122,
        name: "tourisme",
        icon: "tourisme",
        children: [
          {
            id: 2005,
            name: "tour_rando_new",
            children: [
              {
                id: 2006,
                name: "tour_rando_highlights_new",
                children: [
                  {
                    id: 189,
                    name: "tour_mullerthal_trail",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "543f42ef-8aaf-47e3-8a3a-c694c05cbf67"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=7"
                  },
                  {
                    id: 205,
                    name: "tour_escape_ardenne",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "ecd56a00-be39-424f-a240-aab88ac680ef"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=16"
                  },
                  {
                    id: 1518,
                    name: "tour_rando_eislekpied_new",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "8a0a0701-8dd9-4aaa-b03e-77e7bf9e0b81"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=152"
                  },
                  {
                    id: 2019,
                    name: "tour_rando_guttlandtrails_new",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "b5600f62-490b-4382-8d43-566e0b3f2249"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=121"
                  },
                  {
                    id: 168,
                    name: "tour_rando_traumschleifen_new",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "5ef27e69-57e1-4d76-9332-bfa268196ce0"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=22"
                  },
                  {
                    id: 250,
                    name: "tour_DeLux",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "dde68324-501b-4fdd-972a-c6fef3f1c3d1"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=13"
                  },
                  {
                    id: 2020,
                    name: "tour_rando_minetttrail_new",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "676ef2d6-3361-47ab-b630-7b79ac57dee4"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=122"
                  },
                  {
                    id: 2141,
                    name: "tour_circuit_du_lac",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "61ae77c3-9a90-429c-9590-60b0f616d447"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=700"
                  },
                  {
                    id: 2142,
                    name: "tour_sentier_adrien_ries",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "91563b6c-a5d1-4583-9633-9554e5bbda49"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=25"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2007,
                name: "tour_rando_rundwege_new",
                children: [
                  {
                    id: 176,
                    name: "tour_autopedestre",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "aa1953b8-f97a-4871-bcd8-eb27e98098df"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=11,43"
                  },
                  {
                    id: 2048,
                    name: "tour_rando_lokale_wanderwege_new",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"]
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=18,19"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2008,
                name: "tour_rando_streckenwanderwege_new",
                children: [
                  {
                    id: 235,
                    name: "tour_sentiers_gr",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "6e9e8843-e20b-4b20-9ee3-53f6b0d06e8e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=9"
                  },
                  {
                    id: 227,
                    name: "tour_sentiers_nationaux",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "04188aad-5a70-4b9c-a478-64d4899e0a86"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=4"
                  },
                  {
                    id: 158,
                    name: "tour_cfl",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "c4ac0376-8958-497c-a8d0-197d723df82c"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=12"
                  },
                  {
                    id: 197,
                    name: "tour_sentiers_ajl",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "bf8fcfc4-8b94-4fb8-a419-321d5d6a8f3f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=10"
                  },
                  {
                    id: 218,
                    name: "tour_saint_jacques",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "210bf21c-6e3d-4555-907c-bb29c963b6e3"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=6"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2009,
                name: "tour_rando_thematique_new",
                children: [
                  {
                    id: 2021,
                    name: "tour_rando_natur_geologie_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=123"
                  },
                  {
                    id: 316,
                    name: "env_sentiersnature",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "cfc8de82-e187-4547-a1da-83385f86c786"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "env_sentiersnature",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "env_sentiersnature__sentiers_nature"
                      }
                    ]
                  },
                  {
                    id: 2022,
                    name: "tour_rando_kunst_kultur_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=124"
                  },
                  {
                    id: 2023,
                    name: "tour_rando_geschichte_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=125"
                  },
                  {
                    id: 2028,
                    name: "tour_rando_wein_genuss_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=126"
                  },
                  {
                    id: 2024,
                    name: "tour_rando_barrierefrei_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=127"
                  },
                  {
                    id: 2029,
                    name: "tour_rando_fitness_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=128"
                  },
                  {
                    id: 2025,
                    name: "tour_rando_kinder_familie_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=129"
                  },
                  {
                    id: 370,
                    name: "luxembourg_on_horse",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "02ae1931-7075-44e1-923d-86ee3f5a3ca5"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=30"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 692,
                name: "tour_ivv",
                children: [
                  {
                    id: 688,
                    name: "tour_ivv_perm",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "c8953f2f-8e11-4914-97bd-242af64402d0"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=31"
                  },
                  {
                    id: 693,
                    name: "tour_ivv_temp",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "b1396cbc-dc22-4473-a468-7439c2847d15"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=32"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 668,
                name: "tour_restrictions",
                children: [
                  {
                    id: 667,
                    name: "tour_restrictions_autre",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "d55caa92-3ecf-4964-88c6-0f5088964482"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=23"
                  },
                  {
                    id: 444,
                    name: "anf_dates_battues",
                    metadata: {
                      exclusion: "[340]",
                      metadata_id: "cd5c65e3-ce29-4317-bc07-127bc679861f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_dates_battues",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_dates_battues__BATTUES_CHASSE"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 2010,
            name: "tour_velo_new",
            children: [
              {
                id: 2011,
                name: "tour_velo_radwege_new",
                children: [
                  {
                    id: 808,
                    name: "velo_by_pch",
                    metadata: {
                      is_queryable: true,
                      legend_name: "tour_velo_national",
                      metadata_id: "387f6949-0fc4-43a5-b0e6-4e09bdf65225"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "velo_by_pch",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "velo_by_pch__1"
                      },
                      {
                        name: "velo_by_pch__0"
                      }
                    ]
                  },
                  {
                    id: 512,
                    name: "tour_pistes_velo_mymaps2",
                    metadata: {
                      is_queryable: true,
                      legend_name: "tour_velo_national",
                      metadata_id: "8e3c102a-393e-4d48-a321-9f8957ff49cf"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=106"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2012,
                name: "tour_velo_radtouren_new",
                children: [
                  {
                    id: 809,
                    name: "lvi_circuits_cyclables",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "8ae3eb00-4f7d-40e7-b7e0-c913fb70b2b9"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=117,501"
                  },
                  {
                    id: 676,
                    name: "tour_velo_route",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667", "444"],
                      metadata_id: "b2e4a860-73cf-455c-95ff-2ccdf69186ed"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=107"
                  },
                  {
                    id: 293,
                    name: "tour_pistes_vtt",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "fbc9cdfe-c3f4-4f75-960e-169973fb020c"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=8"
                  },
                  {
                    id: 2314,
                    name: "tour_velosummer_2022",
                    metadata: {
                      is_queryable: true,
                      legend_name: "tourisme:velosummer2021",
                      metadata_id: "910a66f7-acbd-4d7d-b531-47a80a06687c"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=132"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2013,
                name: "tour_fahrradstationen_new",
                children: [
                  {
                    id: 1386,
                    name: "mobiliteit_livebikes",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "fc0168f8-2d8b-4bba-8da8-6edd6edd94cc"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobiliteit_livebikes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobiliteit_livebikes__bikes"
                      }
                    ]
                  },
                  {
                    id: 2040,
                    name: "tour_ebike_ladestationen",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_ebike_ladestationen",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_ebike_ladestationen__10"
                      }
                    ]
                  },
                  {
                    id: 2039,
                    name: "tour_fahrradstationen_reparatur_wasch_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_fahrradstationen_reparatur_wasch_new",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_fahrradstationen_reparatur_wasch_new__9"
                      }
                    ]
                  },
                  {
                    id: 368,
                    name: "mobiliteit_bikeshare",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:bikeshare",
                      max_dpi: 128,
                      metadata_id: "e9fbbdff-2f8f-422b-b6ae-5cc69f73bb4b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobiliteit_bikeshare",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobiliteit_bikeshare__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2014,
                name: "tour_restrictions_velo_new",
                children: [
                  {
                    id: 1713,
                    name: "chantiers_actuels_pc",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "7d59f3a6-e8d8-464b-bbf9-73c6ca358a51",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "chantiers_actuels_pc",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "chantiers_actuels_pc__CHANTIERS_ACTUEL_PC"
                      }
                    ]
                  },
                  {
                    id: 1714,
                    name: "chantiers_futurs_pc",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "f6b9df36-5e62-46d1-ae91-c7c58c7e2e45",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "chantiers_futurs_pc",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "chantiers_futurs_pc__CHANTIERS_FUTUR_PC"
                      }
                    ]
                  },
                  {
                    id: 2026,
                    name: "tour_restrictions_MTB_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=130"
                  },
                  {
                    id: 444,
                    name: "anf_dates_battues",
                    metadata: {
                      exclusion: "[340]",
                      metadata_id: "cd5c65e3-ce29-4317-bc07-127bc679861f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_dates_battues",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_dates_battues__BATTUES_CHASSE"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 725,
                name: "tour_tdl",
                metadata: {
                  is_queryable: true,
                  metadata_id: "35226642-3f09-4f98-86b6-6e55316bce53"
                },
                dimensions: {},
                type: "WMS",
                layers: "category",
                imageType: "image/png",
                style: "default",
                childLayers: [],
                ogcServer: "source for config://my_maps?category_id=33"
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 336,
            name: "tour_auto_moto_v2",
            children: [
              {
                id: 681,
                name: "tour_moto",
                metadata: {
                  is_queryable: true,
                  metadata_id: "5256618e-6c50-4044-84cb-ce5740abe508"
                },
                dimensions: {},
                type: "WMS",
                layers: "category",
                imageType: "image/png",
                style: "default",
                childLayers: [],
                ogcServer: "source for config://my_maps?category_id=20"
              },
              {
                id: 254,
                name: "tour_touring",
                metadata: {
                  is_queryable: true,
                  metadata_id: "89e49996-258f-4a7e-86a3-80e2e9af51c9"
                },
                dimensions: {},
                type: "WMS",
                layers: "category",
                imageType: "image/png",
                style: "default",
                childLayers: [],
                ogcServer: "source for config://my_maps?category_id=108"
              },
              {
                id: 685,
                name: "cita_chantiers_actuel",
                metadata: {
                  is_queryable: true,
                  metadata_id: "9c823038-5965-47cc-8dad-21496e57e3f2",
                  start_opacity: 1
                },
                dimensions: {},
                type: "WMS",
                layers: "cita_chantiers_actuel",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "cita_chantiers_actuel__CHANTIERS_ACTUEL"
                  }
                ]
              },
              {
                id: 2058,
                name: "grand_tour_luxembourg",
                metadata: {
                  is_queryable: true,
                  metadata_id: "d0157590-ddaf-487a-8994-d7142fd07ed8"
                },
                dimensions: {},
                type: "WMS",
                layers: "category",
                imageType: "image/png",
                style: "default",
                childLayers: [],
                ogcServer: "source for config://my_maps?category_id=189"
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 2015,
            name: "tour_mobilite_new",
            children: [
              {
                id: 2016,
                name: "tour_bus_bahn_new",
                children: [
                  {
                    id: 423,
                    name: "mobiliteit_cfl",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:cfl",
                      max_dpi: 128,
                      metadata_id: "0b3c42a2-275e-4519-b228-f407d46b8350"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobiliteit_cfl",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobiliteit_cfl__1"
                      }
                    ]
                  },
                  {
                    id: 817,
                    name: "cdt_lignes_cfl",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "84ebdfbc-ba25-464c-af86-e74e588978ef"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=403"
                  },
                  {
                    id: 147,
                    name: "arrets_bus",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:arrets_de_bus",
                      metadata_id: "7318c6e8-bb63-40e0-9e40-46ae7b0dc266"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "arrets_bus",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "arrets_bus__0"
                      },
                      {
                        name: "arrets_bus__1"
                      }
                    ]
                  },
                  {
                    id: 813,
                    name: "cdt_lignes_all",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "bbe0523f-374d-4c94-a27d-7ce81d8bae3b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "cdt_lignes_all",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cdt_lignes_all__lignes_de_bus"
                      }
                    ]
                  },
                  {
                    id: 1374,
                    name: "cdt_lignes_tram",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "0f46c673-d4b4-4c25-8d9a-fca41035f587"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=404"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2017,
                name: "tour_auto_new",
                children: [
                  {
                    id: 377,
                    name: "mobiliteit_pr",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:pr",
                      max_dpi: 128,
                      metadata_id: "9e0c97ae-aff9-41fc-9489-bbf97999163d"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobiliteit_pr",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobiliteit_pr__2"
                      }
                    ]
                  },
                  {
                    id: 1381,
                    name: "chargy",
                    metadata: {
                      is_queryable: true,
                      legend_name: "chargy",
                      metadata_id: "801d732a-c285-4fcd-a043-c5220d6d7eef"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "chargy",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "chargy__chargy"
                      }
                    ]
                  },
                  {
                    id: 713,
                    name: "pch_radars",
                    metadata: {
                      is_queryable: true,
                      max_dpi: 128,
                      metadata_id: "385180ba-a9bc-49d4-8858-ba5f19942a66",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "pch_radars",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "pch_radars__0"
                      },
                      {
                        name: "pch_radars__1"
                      }
                    ]
                  },
                  {
                    id: 685,
                    name: "cita_chantiers_actuel",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "9c823038-5965-47cc-8dad-21496e57e3f2",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "cita_chantiers_actuel",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cita_chantiers_actuel__CHANTIERS_ACTUEL"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 2018,
            name: "tour_erleben_new",
            children: [
              {
                id: 2042,
                name: "tour_tourist_info_new",
                metadata: {
                  is_queryable: true
                },
                dimensions: {},
                type: "WMS",
                layers: "tour_tourist_info_new",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "tour_tourist_info_new__0"
                  }
                ]
              },
              {
                id: 2030,
                name: "tour_essen_uebernachten_new",
                children: [
                  {
                    id: 2038,
                    name: "tour_hotels_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_hotels_new",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_hotels_new__8"
                      }
                    ]
                  },
                  {
                    id: 2037,
                    name: "tour_camping_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_camping_new",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_camping_new__7"
                      }
                    ]
                  },
                  {
                    id: 2036,
                    name: "tour_jugendherberge_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_jugendherberge_new",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_jugendherberge_new__6"
                      }
                    ]
                  },
                  {
                    id: 2035,
                    name: "tour_fewo_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_fewo_new",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_fewo_new__5"
                      }
                    ]
                  },
                  {
                    id: 2034,
                    name: "tour_bb_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_bb_new",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_bb_new__4"
                      }
                    ]
                  },
                  {
                    id: 2033,
                    name: "tour_restaurants_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_restaurants_new",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_restaurants_new__3"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2031,
                name: "tour_kultur_new",
                children: [
                  {
                    id: 2044,
                    name: "tour_burgen_schloesser_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_burgen_schloesser_new",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_burgen_schloesser_new__2"
                      }
                    ]
                  },
                  {
                    id: 2043,
                    name: "tour_museen_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_museen_new",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_museen_new__1"
                      }
                    ]
                  },
                  {
                    id: 2027,
                    name: "tour_unesco_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=131"
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 2032,
            name: "tour_erste_hilfe_new",
            children: [
              {
                id: 2047,
                name: "hopitaux",
                metadata: {
                  is_queryable: true
                },
                dimensions: {},
                type: "WMS",
                layers: "2047",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "hopitaux__POI"
                  }
                ]
              },
              {
                id: 1621,
                name: "points_sauvetage_vdl",
                metadata: {
                  is_queryable: true,
                  metadata_id: "f8938381-7f09-45d1-becd-506b76327562"
                },
                dimensions: {},
                type: "WMS",
                layers: "points_sauvetage_vdl",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "points_sauvetage_vdl__0"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 309,
            name: "administrative_einheiten",
            children: [
              {
                id: 269,
                name: "communes_labels",
                metadata: {
                  is_queryable: true,
                  metadata_id: "17c7d883-ff7f-4b48-a894-46bea40d2e49"
                },
                dimensions: {},
                type: "WMS",
                layers: "communes_labels",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "communes_labels__COMMUNES_LABELS"
                  }
                ]
              },
              {
                id: 302,
                name: "communes",
                metadata: {
                  is_queryable: true,
                  metadata_id: "de5373d6-340f-4203-a065-da7550a03cc4_2049"
                },
                dimensions: {},
                type: "WMS",
                layers: "communes",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "communes__COMMUNES"
                  }
                ]
              },
              {
                id: 346,
                name: "cantons_labels",
                metadata: {
                  is_queryable: true,
                  metadata_id: "3af20a80-be4a-4819-a42b-18e49af799aa"
                },
                dimensions: {},
                type: "WMS",
                layers: "cantons_labels",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "cantons_labels__CANTONS_LABELS"
                  }
                ]
              },
              {
                id: 329,
                name: "cantons",
                metadata: {
                  is_queryable: true,
                  metadata_id: "e8a034e8-f986-4745-a848-b7ef30ce2740"
                },
                dimensions: {},
                type: "WMS",
                layers: "CANTONS",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "cantons__CANTONS"
                  }
                ]
              },
              {
                id: 268,
                name: "districts_labels",
                metadata: {
                  is_queryable: true,
                  metadata_id: "c42842e2-834a-427a-99f6-eb8cb79d1db4"
                },
                dimensions: {},
                type: "WMS",
                layers: "districts_labels",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "districts_labels__DISTRICTS_LABELS"
                  }
                ]
              },
              {
                id: 354,
                name: "districts",
                metadata: {
                  is_queryable: true,
                  metadata_id: "b9edd03f-3aef-4fd6-a3d9-db076b1cf237"
                },
                dimensions: {},
                type: "WMS",
                layers: "districts",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "districts__DISTRICTS"
                  }
                ]
              },
              {
                id: 349,
                name: "country",
                metadata: {
                  is_queryable: true,
                  metadata_id: "4c9b3c0b-85d4-447d-a68c-7416869f8d9b"
                },
                dimensions: {},
                type: "WMS",
                layers: "country",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "country__PAYS"
                  }
                ]
              },
              {
                id: 732,
                name: "limadmin_judiciaire",
                metadata: {
                  metadata_id: "235c0ac9-5bf6-45b6-9ceb-8680a07944ec"
                },
                dimensions: {},
                type: "WMS",
                layers: "limadmin_judiciaire",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "limadmin_judiciaire__ARRONDISSEMENTS JUDICIAIRES"
                  }
                ]
              },
              {
                id: 733,
                name: "limadmin_legislatif",
                metadata: {
                  metadata_id: "627b78d9-ae18-4be2-9a69-02aa6d4e38bb"
                },
                dimensions: {},
                type: "WMS",
                layers: "limadmin_legislatif",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "limadmin_legislatif__CIRCONSCRIPTIONS LEGISLATIVES"
                  }
                ]
              },
              {
                id: 744,
                name: "tour_ort",
                metadata: {
                  legend_name: "ort",
                  metadata_id: "44dbfde5-664e-4e45-8802-3d60b52eb9cb"
                },
                dimensions: {},
                type: "WMS",
                layers: "tour_ort",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "tour_ort__0"
                  },
                  {
                    name: "tour_ort__1"
                  }
                ]
              },
              {
                id: 746,
                name: "tour_leader",
                metadata: {
                  legend_name: "leader",
                  metadata_id: "a48aec89-7341-459e-a7d3-0e572982b255"
                },
                dimensions: {},
                type: "WMS",
                layers: "tour_leader",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "tour_leader__0"
                  },
                  {
                    name: "tour_leader__1"
                  },
                  {
                    name: "tour_leader__2"
                  }
                ]
              },
              {
                id: 747,
                name: "tour_parcsnaturels",
                metadata: {
                  is_queryable: true,
                  legend_name: "parcnaturel",
                  metadata_id: "f519c4e7-4459-49b5-b8c1-569328252d44"
                },
                dimensions: {},
                type: "WMS",
                layers: "tour_parcnaturels",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "tour_parcsnaturels__0"
                  },
                  {
                    name: "tour_parcsnaturels__1"
                  }
                ]
              },
              {
                id: 678,
                name: "anf_stations_biologiques",
                metadata: {
                  is_queryable: true,
                  metadata_id: "05e497fc-625d-4701-90af-dbe8813201ab"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_stations_biologiques",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_stations_biologiques__STATIONS_BIOLOGIQUES"
                  }
                ]
              },
              {
                id: 1364,
                name: "act_frontieres_isodistances",
                metadata: {
                  metadata_id: "09318d11-a908-4dea-a8f9-0558d20b980f",
                  start_opacity: 0.5
                },
                dimensions: {},
                type: "WMS",
                layers: "act_frontieres_isodistances",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "act_frontieres_isodistances__0"
                  },
                  {
                    name: "act_frontieres_isodistances__1"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          bg_layer: "pixelmaps-gray",
          css: "tourisme.css",
          display_in_switcher: true,
          link_title: "Send email",
          page_title: "tourisme.geoportail.lu",
          print_img: "bandeautourisme.png",
          print_long_txt_de: "Das \xF6ffentliche Geoportal des Grossherzogtums Luxemburg",
          print_long_txt_en: "The official geoportal for the Grand-Duchy of Luxembourg",
          print_long_txt_fr: "Le g\xE9oportail officiel du Grand-Duch\xE9 de Luxembourg",
          print_long_txt_lu: "Den offizielle Geoportal vu L\xEBtzebuerg",
          print_scales: [
            "1000",
            "1500",
            "2500",
            "5000",
            "10000",
            "15000",
            "20000",
            "25000",
            "50000",
            "80000",
            "100000",
            "125000",
            "200000",
            "250000",
            "400000"
          ],
          print_short_txt_de: "tourisme.geoportal.lu",
          print_short_txt_en: "tourisme.geoportal.lu",
          print_short_txt_fr: "tourisme.geoportail.lu",
          print_short_txt_lu: "tourisme.geoportal.lu",
          show_in_mobile: true
        }
      },
      {
        id: 105,
        name: "emwelt",
        icon: "emwelt",
        children: [
          {
            id: 309,
            name: "administrative_einheiten",
            children: [
              {
                id: 269,
                name: "communes_labels",
                metadata: {
                  is_queryable: true,
                  metadata_id: "17c7d883-ff7f-4b48-a894-46bea40d2e49"
                },
                dimensions: {},
                type: "WMS",
                layers: "communes_labels",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "communes_labels__COMMUNES_LABELS"
                  }
                ]
              },
              {
                id: 302,
                name: "communes",
                metadata: {
                  is_queryable: true,
                  metadata_id: "de5373d6-340f-4203-a065-da7550a03cc4_2049"
                },
                dimensions: {},
                type: "WMS",
                layers: "communes",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "communes__COMMUNES"
                  }
                ]
              },
              {
                id: 346,
                name: "cantons_labels",
                metadata: {
                  is_queryable: true,
                  metadata_id: "3af20a80-be4a-4819-a42b-18e49af799aa"
                },
                dimensions: {},
                type: "WMS",
                layers: "cantons_labels",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "cantons_labels__CANTONS_LABELS"
                  }
                ]
              },
              {
                id: 329,
                name: "cantons",
                metadata: {
                  is_queryable: true,
                  metadata_id: "e8a034e8-f986-4745-a848-b7ef30ce2740"
                },
                dimensions: {},
                type: "WMS",
                layers: "CANTONS",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "cantons__CANTONS"
                  }
                ]
              },
              {
                id: 268,
                name: "districts_labels",
                metadata: {
                  is_queryable: true,
                  metadata_id: "c42842e2-834a-427a-99f6-eb8cb79d1db4"
                },
                dimensions: {},
                type: "WMS",
                layers: "districts_labels",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "districts_labels__DISTRICTS_LABELS"
                  }
                ]
              },
              {
                id: 354,
                name: "districts",
                metadata: {
                  is_queryable: true,
                  metadata_id: "b9edd03f-3aef-4fd6-a3d9-db076b1cf237"
                },
                dimensions: {},
                type: "WMS",
                layers: "districts",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "districts__DISTRICTS"
                  }
                ]
              },
              {
                id: 349,
                name: "country",
                metadata: {
                  is_queryable: true,
                  metadata_id: "4c9b3c0b-85d4-447d-a68c-7416869f8d9b"
                },
                dimensions: {},
                type: "WMS",
                layers: "country",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "country__PAYS"
                  }
                ]
              },
              {
                id: 732,
                name: "limadmin_judiciaire",
                metadata: {
                  metadata_id: "235c0ac9-5bf6-45b6-9ceb-8680a07944ec"
                },
                dimensions: {},
                type: "WMS",
                layers: "limadmin_judiciaire",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "limadmin_judiciaire__ARRONDISSEMENTS JUDICIAIRES"
                  }
                ]
              },
              {
                id: 733,
                name: "limadmin_legislatif",
                metadata: {
                  metadata_id: "627b78d9-ae18-4be2-9a69-02aa6d4e38bb"
                },
                dimensions: {},
                type: "WMS",
                layers: "limadmin_legislatif",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "limadmin_legislatif__CIRCONSCRIPTIONS LEGISLATIVES"
                  }
                ]
              },
              {
                id: 744,
                name: "tour_ort",
                metadata: {
                  legend_name: "ort",
                  metadata_id: "44dbfde5-664e-4e45-8802-3d60b52eb9cb"
                },
                dimensions: {},
                type: "WMS",
                layers: "tour_ort",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "tour_ort__0"
                  },
                  {
                    name: "tour_ort__1"
                  }
                ]
              },
              {
                id: 746,
                name: "tour_leader",
                metadata: {
                  legend_name: "leader",
                  metadata_id: "a48aec89-7341-459e-a7d3-0e572982b255"
                },
                dimensions: {},
                type: "WMS",
                layers: "tour_leader",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "tour_leader__0"
                  },
                  {
                    name: "tour_leader__1"
                  },
                  {
                    name: "tour_leader__2"
                  }
                ]
              },
              {
                id: 747,
                name: "tour_parcsnaturels",
                metadata: {
                  is_queryable: true,
                  legend_name: "parcnaturel",
                  metadata_id: "f519c4e7-4459-49b5-b8c1-569328252d44"
                },
                dimensions: {},
                type: "WMS",
                layers: "tour_parcnaturels",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "tour_parcsnaturels__0"
                  },
                  {
                    name: "tour_parcsnaturels__1"
                  }
                ]
              },
              {
                id: 678,
                name: "anf_stations_biologiques",
                metadata: {
                  is_queryable: true,
                  metadata_id: "05e497fc-625d-4701-90af-dbe8813201ab"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_stations_biologiques",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_stations_biologiques__STATIONS_BIOLOGIQUES"
                  }
                ]
              },
              {
                id: 1364,
                name: "act_frontieres_isodistances",
                metadata: {
                  metadata_id: "09318d11-a908-4dea-a8f9-0558d20b980f",
                  start_opacity: 0.5
                },
                dimensions: {},
                type: "WMS",
                layers: "act_frontieres_isodistances",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "act_frontieres_isodistances__0"
                  },
                  {
                    name: "act_frontieres_isodistances__1"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 245,
            name: "env_zones_protegees",
            children: [
              {
                id: 807,
                name: "zpin_group",
                children: [
                  {
                    id: 804,
                    name: "anf_zpin_declarees",
                    metadata: {
                      is_queryable: true,
                      legend_name: "anf:zpin_declarees",
                      metadata_id: "9439d9b1-eff6-47b5-a4c7-4c5bde2744f4"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_zpin_declarees",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_zpin_declarees__ZPIN_DECLAREES"
                      }
                    ]
                  },
                  {
                    id: 805,
                    name: "anf_zpin_a_declarer",
                    metadata: {
                      is_queryable: true,
                      legend_name: "anf:zpin_a_declarer",
                      metadata_id: "db53336b-1a33-4b1a-94a8-42a29b55ce45"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_zpin_a_declarer",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_zpin_a_declarer__ZPIN_A_DECLARER"
                      }
                    ]
                  },
                  {
                    id: 806,
                    name: "anf_zpin_en_procedure",
                    metadata: {
                      is_queryable: true,
                      legend_name: "anf:zpin_en_procedure_reglementaire",
                      metadata_id: "74499cf0-ab69-48bd-a357-8c151dd3d5c9"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_zpin_en_procedure",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_zpin_en_procedure__ZPIN_EN_PROCEDURE_REGLEMENTAIRE"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 334,
                name: "env_zones_protegees_communautaires",
                children: [
                  {
                    id: 146,
                    name: "env_natura2000",
                    children: [
                      {
                        id: 1915,
                        name: "anf_communes_copil_2020",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "e0369dfa-0219-4a60-84c4-4ce60cec0a02"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "anf_communes_copil_2020",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "anf_communes_copil_2020__COMMUNES_COPIL_2020"
                          }
                        ]
                      },
                      {
                        id: 540,
                        name: "natura2000_habitats",
                        metadata: {
                          is_queryable: true,
                          max_dpi: 128,
                          metadata_id: "080b7d2e-f8d5-4943-8dbf-04d3dfd4fe09"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "natura2000_habitats",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "natura2000_habitats__2"
                          },
                          {
                            name: "natura2000_habitats__0"
                          }
                        ]
                      },
                      {
                        id: 533,
                        name: "natura2000_oiseaux",
                        metadata: {
                          is_queryable: true,
                          max_dpi: 128,
                          metadata_id: "080b7d2e-f8d5-4943-8dbf-04d3dfd4fe09"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "natura2000_oiseaux",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "natura2000_oiseaux__1"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1823,
            name: "anf_mesures_compensatoires_group",
            children: [
              {
                id: 1827,
                name: "anf_secteurs_ecologiques_compensation_ecopoint",
                metadata: {
                  is_queryable: true,
                  metadata_id: "22033820-7317-4bcc-9c4c-df5b9ca80550"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_secteurs_ecologiques_compensation_ecopoint",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_secteurs_ecologiques_compensation_ecopoint__SECTEURS_COMPENSATION"
                  }
                ]
              },
              {
                id: 1822,
                name: "anf_projets_compensation_approuves",
                metadata: {
                  is_queryable: true,
                  metadata_id: "03aafc0c-c443-42ea-963a-8538a3f089d4"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_projets_compensation_approuves",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_projets_compensation_approuves__ZONES_COMPENSATION_APPROUVEES"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 161,
            name: "env_obs",
            children: [
              {
                id: 1963,
                name: "env_couverture_sol",
                children: [
                  {
                    id: 1951,
                    name: "LISL_Landcover_2018",
                    metadata: {
                      is_queryable: true,
                      legend_name: "lisl:lc2018",
                      metadata_id: "6142a6a6-9356-47ac-babe-eaa2ae3628b6"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "LISL_Landcover_2018",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "LISL_Landcover_2018__0"
                      },
                      {
                        name: "LISL_Landcover_2018__1"
                      }
                    ]
                  },
                  {
                    id: 1950,
                    name: "LISL_Landcover_2015_v2",
                    metadata: {
                      is_queryable: true,
                      legend_name: "lisl:lc2015_2",
                      metadata_id: "67f4ecb8-5d4b-4a9e-a60b-239fc92b25a7"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "LISL_Landcover_2015_v2",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "LISL_Landcover_2015_v2__0"
                      },
                      {
                        name: "LISL_Landcover_2015_v2__1"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1964,
                name: "env_utilisation_sol",
                children: [
                  {
                    id: 1970,
                    name: "LISL_Landuse_2018",
                    metadata: {
                      is_queryable: true,
                      legend_name: "lisl_landuse_2018",
                      metadata_id: "e4572e0b-1b40-4834-b6c3-ccab83f75f57"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "LISL_Landuse_2018",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "LISL_Landuse_2018__0"
                      }
                    ]
                  },
                  {
                    id: 2054,
                    name: "LISL_Landuse_2015_v3",
                    metadata: {
                      is_queryable: true,
                      legend_name: "lisl_landuse_2015_v3",
                      metadata_id: "65e04718-1890-4c5e-8be7-08a73f69c0cc"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "LISL_Landuse_2015_v3",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "LISL_Landuse_2015_v3__0"
                      }
                    ]
                  },
                  {
                    id: 1969,
                    name: "LISL_Landuse_2007",
                    metadata: {
                      is_queryable: true,
                      legend_name: "lisl_landuse_2007",
                      metadata_id: "257556b9-560b-4193-b773-e16a9137a690"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "LISL_Landuse_2007",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "LISL_Landuse_2007__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1965,
                name: "env_impermeabilisation",
                children: [
                  {
                    id: 1952,
                    name: "LISL_taux_impermeabilisation_2018",
                    metadata: {
                      is_queryable: true,
                      legend_name: "lisl_taux_impermeabilisation_2018",
                      metadata_id: "5b40c571-dd3c-4e76-8f4f-b54746799688"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "LISL_taux_impermeabilisation_2018",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "LISL_taux_impermeabilisation_2018__0"
                      },
                      {
                        name: "LISL_taux_impermeabilisation_2018__1"
                      }
                    ]
                  },
                  {
                    id: 2216,
                    name: "at_impermeabilisation_grid_2018_100m",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:impermeabilisation_grid_2018_100m",
                      metadata_id: "210db74a-e33a-401b-9e17-2cd966cdcd1f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_impermeabilisation_grid_2018_100m",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_impermeabilisation_grid_2018_100m__0"
                      }
                    ]
                  },
                  {
                    id: 2215,
                    name: "at_impermeabilisation_grid_2018_1km",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:impermeabilisation_grid_2018_1km",
                      metadata_id: "8dc777d0-f910-4c69-a476-85a73dcd8474"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_impermeabilisation_grid_2018_1km",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_impermeabilisation_grid_2018_1km__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2212,
                name: "at_batiments_group",
                children: [
                  {
                    id: 2214,
                    name: "at_batiments_periode_construction",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:periode_construction_batiments",
                      metadata_id: "7c138282-86de-4adb-91c2-467b06786821"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_batiments_periode_construction",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_batiments_periode_construction__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1966,
                name: "env_occupation_biophysique",
                children: [
                  {
                    id: 215,
                    name: "env_obs2007",
                    metadata: {
                      is_queryable: true,
                      max_dpi: 128,
                      metadata_id: "bd672300-0851-4901-82c4-6099aff1fcf7"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "env_obs2007",
                    imageType: "image/png"
                  },
                  {
                    id: 163,
                    name: "env_obs1999",
                    metadata: {
                      is_queryable: true,
                      max_dpi: 128,
                      metadata_id: "b4836d86-2803-4dcf-a991-7e78ab9c41b6"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "env_obs1999",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1967,
                name: "env_corine_landcover",
                children: [
                  {
                    id: 167,
                    name: "env_corine",
                    metadata: {
                      is_queryable: true,
                      max_dpi: 128,
                      metadata_id: "0098c72d-490e-4b03-91f6-f844502883a0"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "env_corine",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "env_corine__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 276,
            name: "env_sentiers",
            children: [
              {
                id: 316,
                name: "env_sentiersnature",
                metadata: {
                  is_queryable: true,
                  metadata_id: "cfc8de82-e187-4547-a1da-83385f86c786"
                },
                dimensions: {},
                type: "WMS",
                layers: "env_sentiersnature",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "env_sentiersnature__sentiers_nature"
                  }
                ]
              },
              {
                id: 1857,
                name: "anf_itineraire_nature",
                metadata: {
                  is_queryable: true,
                  legend_name: "anf:vakanz_doheem",
                  metadata_id: "fb71d4b6-b11a-4bf0-9b23-cddaa17e058c"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_itineraire_nature",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_itineraire_nature__0"
                  }
                ]
              },
              {
                id: 1968,
                name: "np_uewersauer_randonnee_eau",
                metadata: {
                  is_queryable: true,
                  metadata_id: "2bfd404c-1734-491d-94c3-59a16a3edf2c"
                },
                dimensions: {},
                type: "WMS",
                layers: "category",
                imageType: "image/png",
                style: "default",
                childLayers: [],
                ogcServer: "source for config://my_maps?category_id=41"
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 280,
            name: "anf_unites_admin",
            children: [
              {
                id: 427,
                name: "anf_arrondissements",
                metadata: {
                  is_queryable: true,
                  metadata_id: "0ed72c13-1975-4cef-90de-1e4b737f5fbd"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_arrondissements",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_arrondissements__ARRONDISSEMENTS"
                  }
                ]
              },
              {
                id: 428,
                name: "anf_triages",
                metadata: {
                  is_queryable: true,
                  metadata_id: "d4bb012a-73ab-4d3c-ac0c-f31e9df07d34"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_triages",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_triages__TRIAGES"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 241,
            name: "anf_forets",
            children: [
              {
                id: 677,
                name: "anf_proprietes_forestieres",
                metadata: {
                  is_queryable: true,
                  legend_name: "anf:proprietes_forestieres",
                  metadata_id: "fa6d38c7-263c-4349-b208-45652f9b98ca"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_proprietes_forestieres",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_proprietes_forestieres__PROPRIETES_FORESTIERES"
                  }
                ]
              },
              {
                id: 1514,
                name: "anf_forets_publiques_fsc_pefc",
                metadata: {
                  is_queryable: true,
                  legend_name: "anf:proprietes_forestieres",
                  metadata_id: "ad654091-a8b2-45db-91ff-f3eef50bbe38"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_forets_publiques_fsc_pefc",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_forets_publiques_fsc_pefc__PROPRIETES_FORESTIERES_CERTIFIEES"
                  }
                ]
              },
              {
                id: 524,
                name: "anf_carte_simpl_forets",
                metadata: {
                  is_queryable: true,
                  legend_name: "anf:vegetation_forestiere_naturelle",
                  metadata_id: "9eac63ee-39b0-4794-81b4-dd2b4819dd39"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_carte_simpl_forets",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_carte_simpl_forets__PHYTOSOCIO_S_2014"
                  }
                ]
              },
              {
                id: 389,
                name: "anf_peuplements_semenciers",
                metadata: {
                  is_queryable: true,
                  metadata_id: "5d2b9400-3f94-4962-ad67-8b7e923d6d8b"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_peuplements_semenciers",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_peuplements_semenciers__PEUPLEMENTS_SEMENCIERS"
                  }
                ]
              },
              {
                id: 419,
                name: "anf_arbres_remarquables",
                metadata: {
                  is_queryable: true,
                  legend_name: "anf:arbres_remarquables",
                  metadata_id: "373df6df-a91c-4e66-b211-ac2bc1675d56"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_arbres_remarquables",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_arbres_remarquables__ARBRES_REMARQUABLES"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1953,
            name: "anf_especes",
            children: [
              {
                id: 1961,
                name: "anf_amphibiens",
                children: [
                  {
                    id: 1962,
                    name: "anf_amphibiens_sauvetage",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "348a241e-27c4-4d31-8cf0-e99626efa6a1"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_amphibiens_sauvetage",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_amphibiens_sauvetage__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 180,
            name: "anf_secteurs_ecologiques_group",
            children: [
              {
                id: 690,
                name: "anf_secteurs_ecologiques",
                metadata: {
                  is_queryable: true,
                  metadata_id: "8afa4162-c23b-4001-b737-4074d4f5360f"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_secteurs_ecologiques",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_secteurs_ecologiques__SECTEURS_ECOLOGIQUES"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 322,
            name: "anf_chasse",
            children: [
              {
                id: 1783,
                name: "anf_lots_chasse_2021",
                metadata: {
                  exclusion: "[340]",
                  is_queryable: true,
                  metadata_id: "a8d8f46d-f6b1-4bb0-9935-be825cffab3f"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_lots_chasse_2021",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_lots_chasse_2021__LOTS_CHASSE_2021"
                  }
                ]
              },
              {
                id: 444,
                name: "anf_dates_battues",
                metadata: {
                  exclusion: "[340]",
                  metadata_id: "cd5c65e3-ce29-4317-bc07-127bc679861f"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_dates_battues",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_dates_battues__BATTUES_CHASSE"
                  }
                ]
              },
              {
                id: 1496,
                name: "anf_centre_ramassage",
                metadata: {
                  is_queryable: true,
                  metadata_id: "44f25bb0-6b7d-46fa-8388-ccdf682797ce"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_centre_ramassage",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_centre_ramassage__RAMASSAGE_GIBIER"
                  }
                ]
              },
              {
                id: 1658,
                name: "anf_zone_prevention_ppa",
                metadata: {
                  is_queryable: true,
                  metadata_id: "62f2a3ed-5893-4ed2-aba7-77159b10fb2e"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_zone_prevention_ppa",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_zone_prevention_ppa__0"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 366,
            name: "emwelt_biotop_kadaster",
            children: [
              {
                id: 1367,
                name: "anf_biotopes_points",
                metadata: {
                  is_queryable: true,
                  legend_name: "env:btk_p",
                  metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_biotopes_points",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_biotopes_points__BIOTOPES_MO_EL_PONCTUELS"
                  }
                ]
              },
              {
                id: 1368,
                name: "anf_biotopes_vergers",
                metadata: {
                  is_queryable: true,
                  legend_name: "env:btk_s",
                  metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_biotopes_vergers",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_biotopes_vergers__BIOTOPES_MO_VERGERS"
                  }
                ]
              },
              {
                id: 1369,
                name: "anf_biotopes_surfaces",
                metadata: {
                  is_queryable: true,
                  legend_name: "env:btk_f",
                  metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_biotopes_surfaces",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_biotopes_surfaces__BIOTOPES_MO_SURFACES"
                  }
                ]
              },
              {
                id: 1370,
                name: "anf_biotopes_tampons",
                metadata: {
                  is_queryable: true,
                  legend_name: "env:btk_b",
                  metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_biotopes_tampons",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_biotopes_tampons__BIOTOPES_MO_ZONES_TAMPONS"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1361,
            name: "aev_casipo_group",
            children: [
              {
                id: 1362,
                name: "aev_casipo",
                metadata: {
                  is_queryable: true,
                  metadata_id: "974688ed-130e-4704-ba2c-72154ed0cecb"
                },
                dimensions: {},
                type: "WMS",
                layers: "aev_casipo",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "aev_casipo__PARCELLES"
                  }
                ]
              },
              {
                id: 1858,
                name: "aev_anciennes_decharges",
                metadata: {
                  is_queryable: true,
                  metadata_id: "ec1a8607-5f8d-4baa-9b14-1aa8ed0a828a"
                },
                dimensions: {},
                type: "WMS",
                layers: "aev_anciennes_decharges",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "aev_anciennes_decharges__1"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1355,
            name: "aev_qualite_air",
            children: [
              {
                id: 1472,
                name: "aev_modelisation",
                children: [
                  {
                    id: 1430,
                    name: "air_quality_o3",
                    metadata: {
                      is_queryable: true,
                      legend_name: "aev:air_quality_o3",
                      metadata_id: "4ebe5c4d-2318-4caa-bace-3e3784a41509",
                      start_opacity: 0.75
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "air_quality_no2",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "air_quality_o3__2"
                      },
                      {
                        name: "air_quality_o3__5"
                      }
                    ]
                  },
                  {
                    id: 1429,
                    name: "air_quality_no2",
                    metadata: {
                      is_queryable: true,
                      legend_name: "aev:air_quality",
                      metadata_id: "d405406f-c1c7-4f47-ae40-e76008a91c4a",
                      start_opacity: 0.75
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "air_quality_o3",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "air_quality_no2__3"
                      },
                      {
                        name: "air_quality_no2__5"
                      }
                    ]
                  },
                  {
                    id: 1425,
                    name: "air_quality_pm10",
                    metadata: {
                      is_queryable: true,
                      legend_name: "aev:air_quality_pm10",
                      metadata_id: "94d2f0ea-f0ce-4a79-be7f-1d018deffb61",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "air_quality_pm10",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "air_quality_pm10__1"
                      },
                      {
                        name: "air_quality_pm10__5"
                      }
                    ]
                  },
                  {
                    id: 1480,
                    name: "air_quality_pm2_5",
                    metadata: {
                      is_queryable: true,
                      legend_name: "aev:air_quality_pm2_5",
                      metadata_id: "5b62c615-448c-4d74-8914-3275e64fbc1e",
                      start_opacity: 0.75
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "air_quality_pm2_5",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "air_quality_pm2_5__0"
                      },
                      {
                        name: "air_quality_pm2_5__5"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1473,
                name: "aev_air_mesures",
                children: [
                  {
                    id: 1357,
                    name: "aev_reseau_telemetrique",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "1be21b78-5824-47d6-87c1-db60c5e3d856"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aev_reseau_telemetrique",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aev_reseau_telemetrique__3"
                      }
                    ]
                  },
                  {
                    id: 1358,
                    name: "aev_poussieres_fines",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "5e6fa76e-d6d7-41d8-b88f-9ae00e3222d5"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aev_poussieres_fines",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aev_poussieres_fines__2"
                      }
                    ]
                  },
                  {
                    id: 1359,
                    name: "aev_reseau_bergerhoff",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "735a1453-00f3-402e-91b0-2cd9e677cd2c"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aev_reseau_bergerhoff",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aev_reseau_bergerhoff__0"
                      }
                    ]
                  },
                  {
                    id: 1426,
                    name: "aev_reseau_biosurveillance",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "68871fde-72b1-45e6-b891-14a8746264ea"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aev_reseau_biosurveillance",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aev_reseau_biosurveillance__4"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1704,
                name: "aev_mesurage_no2",
                children: [
                  {
                    id: 2400,
                    name: "aev_pacte_climat_2021",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "4ce0368e-af4e-456f-9dd1-7969b73360d7"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aev_pacte_climat_2021",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aev_pacte_climat_2021__0"
                      }
                    ]
                  },
                  {
                    id: 2088,
                    name: "aev_pacte_climat_2020",
                    metadata: {
                      is_queryable: true,
                      legend_name: "aev:pacte_climat_2020",
                      metadata_id: "805db173-9621-4b9a-ae8a-a8fae34a791b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aev_pacte_climat_2020",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aev_pacte_climat_2020__7"
                      }
                    ]
                  },
                  {
                    id: 1848,
                    name: "aev_pacte_climat_2019",
                    metadata: {
                      is_queryable: true,
                      legend_name: "aev:pacte_climat_2019",
                      metadata_id: "aff9f715-babc-4f0b-a86b-16651d626bde"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aev_pacte_climat_2019",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aev_pacte_climat_2019__5"
                      },
                      {
                        name: "aev_pacte_climat_2019__6"
                      }
                    ]
                  },
                  {
                    id: 1477,
                    name: "aev_pacte_climat_2018",
                    metadata: {
                      is_queryable: true,
                      legend_name: "aev:pacte_climat",
                      metadata_id: "bb5aa932-2669-4802-9c34-c370addbc798"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aev_pacte_climat_2018",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aev_pacte_climat_2018__2"
                      },
                      {
                        name: "aev_pacte_climat_2018__3"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2172,
                name: "env_air_installations_tegistres",
                children: [
                  {
                    id: 1465,
                    name: "aev_medium_combustion_plants",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "1c8dc7c5-f94f-49f6-9d96-3a129b28a922"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aev_medium_combustion_plants",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aev_medium_combustion_plants__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 166,
            name: "env_bruit",
            children: [
              {
                id: 2123,
                name: "env_bruit_modelisation",
                children: [
                  {
                    id: 232,
                    name: "env_bruit_axes_routiers",
                    children: [
                      {
                        id: 1497,
                        name: "env_bruit2016_axes_routiers_lden",
                        metadata: {
                          exclusion: "[336,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          metadata_id: "cf1a21cc-8208-420e-bd7e-091d755b6ace",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_routiers_lden",
                        imageType: "image/png"
                      },
                      {
                        id: 1500,
                        name: "env_bruit2016_axes_routiers_lngt",
                        metadata: {
                          exclusion: "[336,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          metadata_id: "83ae2d3b-f0d9-4584-8c48-f6722bd4f517",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_routiers_lngt",
                        imageType: "image/png"
                      },
                      {
                        id: 1504,
                        name: "env_bruit_axes_routiers_hotspots_2016",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "c5a6e3c5-6bef-4ff9-ac3e-aa494a34e602"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_routiers_hotspots_2016",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_routiers_hotspots_2016__0"
                          },
                          {
                            name: "env_bruit_axes_routiers_hotspots_2016__11"
                          }
                        ]
                      },
                      {
                        id: 1505,
                        name: "env_bruit_axes_routiers_agglomeration_2016",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "a6c63355-6e42-4795-9d72-8744b907b151"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_routiers_agglomeration_2016",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_routiers_agglomeration_2016__0"
                          },
                          {
                            name: "env_bruit_axes_routiers_agglomeration_2016__8"
                          }
                        ]
                      },
                      {
                        id: 326,
                        name: "env_bruit_axes_routiers_lden",
                        metadata: {
                          exclusion: "[333,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          max_dpi: 128,
                          metadata_id: "3e3aa044-89e0-4676-9404-744f64dd7ba0",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit_axes_routiers_lden",
                        imageType: "image/png"
                      },
                      {
                        id: 255,
                        name: "env_bruit_axes_routiers_lngt",
                        metadata: {
                          exclusion: "[333,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          max_dpi: 128,
                          metadata_id: "5e4f2607-b114-4884-8e48-8e1faa997eb4",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit_axes_routiers_lngt",
                        imageType: "image/png"
                      },
                      {
                        id: 1475,
                        name: "env_bruit_axes_routiers_hotspots",
                        metadata: {
                          exclusion: "[332,336]",
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "ff6b3d63-871c-4e88-8fc0-0f276abe259a"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_routiers_hotspots",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_routiers_hotspots__0"
                          },
                          {
                            name: "env_bruit_axes_routiers_hotspots__4"
                          }
                        ]
                      },
                      {
                        id: 1485,
                        name: "env_bruit_axes_routiers_agglomeration",
                        metadata: {
                          exclusion: "[332,336]",
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "f1dd0dd5-4dd5-4d88-b556-af39a20ab137",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_routiers_agglomeration",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_routiers_agglomeration__0"
                          },
                          {
                            name: "env_bruit_axes_routiers_agglomeration__2"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 183,
                    name: "env_bruit_axes_ferroviaires",
                    children: [
                      {
                        id: 1498,
                        name: "env_bruit2016_axes_ferroviaires_lden",
                        metadata: {
                          exclusion: "[336,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          metadata_id: "7975b71b-2fd4-45e6-8c0a-306671d665c6",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_ferroviaires_lden",
                        imageType: "image/png"
                      },
                      {
                        id: 1502,
                        name: "env_bruit2016_axes_ferroviaires_lngt",
                        metadata: {
                          exclusion: "[336,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          metadata_id: "170143ce-53ef-4b2b-997c-a2ccb1b84477",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_ferroviaires_lngt",
                        imageType: "image/png"
                      },
                      {
                        id: 1503,
                        name: "env_bruit_axes_ferroviaires_hotspots_2016",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "29ef44c6-f357-4d21-829c-f2fdd5fe1149"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_ferroviaires_hotspots_2016",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_ferroviaires_hotspots_2016__13"
                          },
                          {
                            name: "env_bruit_axes_ferroviaires_hotspots_2016__0"
                          }
                        ]
                      },
                      {
                        id: 310,
                        name: "env_bruit_axes_ferroviaires_lden",
                        metadata: {
                          exclusion: "[334,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          max_dpi: 128,
                          metadata_id: "32b40d1c-111e-4eed-91c7-61d61ef27b8d",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit_axes_ferroviaires_lden",
                        imageType: "image/png"
                      },
                      {
                        id: 259,
                        name: "env_bruit_axes_ferroviaires_lngt",
                        metadata: {
                          exclusion: "[334,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          max_dpi: 128,
                          metadata_id: "2d7e26ad-e448-45a2-9045-3dfb3e3ec15b",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit_axes_ferroviaires_lngt",
                        imageType: "image/png"
                      },
                      {
                        id: 1476,
                        name: "env_bruit_axes_ferroviaires_hotspots",
                        metadata: {
                          exclusion: "[332,336]",
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "d3b30653-d0bf-4924-96b2-251e9f61c979"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_ferroviaires_hotspots",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_ferroviaires_hotspots__6"
                          },
                          {
                            name: "env_bruit_axes_ferroviaires_hotspots__0"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 190,
                    name: "env_bruit_air",
                    children: [
                      {
                        id: 1501,
                        name: "env_bruit2016_axes_aeroport_lden",
                        metadata: {
                          exclusion: "[332,336]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          metadata_id: "26e208ff-39a3-4cf6-92db-4c6707fe972a",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_aeroport_lden",
                        imageType: "image/png"
                      },
                      {
                        id: 1499,
                        name: "env_bruit2016_axes_aeroport_lngt",
                        metadata: {
                          exclusion: "[332,336]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          metadata_id: "2aa6f79d-74cc-4f22-bedd-748f8e8e30b9",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_aeroport_lngt",
                        imageType: "image/png"
                      },
                      {
                        id: 157,
                        name: "env_bruit_air_lden",
                        metadata: {
                          exclusion: "[335,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          max_dpi: 128,
                          metadata_id: "0f4dcfc5-e947-4e5c-9460-702b8e1a572f",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_air_lden",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_air_lden__1"
                          }
                        ]
                      },
                      {
                        id: 327,
                        name: "env_bruit_air_lngt",
                        metadata: {
                          exclusion: "[335,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          max_dpi: 128,
                          metadata_id: "6b031060-1f82-467d-af86-afe02a3f04fa",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_air_lngt",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_air_lngt__0"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 2124,
                    name: "env_bruit_multiexposition",
                    children: [
                      {
                        id: 2125,
                        name: "aev_multiexposition_Lden",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "37c1c1a2-1926-4c92-8c2a-b9ce0ac6cfef"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "aev_multiexposition_Lden",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "aev_multiexposition_Lden__1"
                          }
                        ]
                      },
                      {
                        id: 2126,
                        name: "aev_multiexposition_Lnight",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "a536e129-3c0f-4a6c-a767-0519eec880c1"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "aev_multiexposition_Lnight",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "aev_multiexposition_Lnight__2"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1641,
                name: "aev_campagne_mesure_bruit",
                children: [
                  {
                    id: 1916,
                    name: "aev_silent_cities_2020",
                    children: [
                      {
                        id: 1917,
                        name: "aev_silent_cities_2020_phase1",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:silent_cities",
                          metadata_id: "58cd0d5a-e69a-4381-8d1c-7cdfd7d98272"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "aev_silent_cities_2020_phase1",
                        imageType: "image/png",
                        childLayers: [
                          {
                            name: "aev_silent_cities_2020_phase1__2"
                          }
                        ]
                      },
                      {
                        id: 1918,
                        name: "aev_silent_cities_2020_phase2",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:silent_cities",
                          metadata_id: "58cd0d5a-e69a-4381-8d1c-7cdfd7d98272"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "aev_silent_cities_2020_phase2",
                        imageType: "image/png",
                        childLayers: [
                          {
                            name: "aev_silent_cities_2020_phase2__3"
                          }
                        ]
                      },
                      {
                        id: 1919,
                        name: "aev_silent_cities_2020_phase3",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:silent_cities",
                          metadata_id: "58cd0d5a-e69a-4381-8d1c-7cdfd7d98272"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "aev_silent_cities_2020_phase3",
                        imageType: "image/png",
                        childLayers: [
                          {
                            name: "aev_silent_cities_2020_phase3__4"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1921,
                    name: "env_bruit_routes_hotspots_2019_group",
                    children: [
                      {
                        id: 1642,
                        name: "env_bruit_routes_hotspots_2019",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:hotspots_rail",
                          metadata_id: "f898e289-c5dd-432b-b3e6-de4c3681b77a"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_routes_hotspots_2019",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_routes_hotspots_2019__0"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1382,
            name: "aev_zones_calmes",
            children: [
              {
                id: 1383,
                name: "aev_zones_calmes_rurales",
                metadata: {
                  is_queryable: true,
                  legend_name: "aev:zones_calmes",
                  metadata_id: "49cfe40d-b006-4aaa-831b-11d1e19e1411"
                },
                dimensions: {},
                type: "WMS",
                layers: "aev_zones_calmes_rurales",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "aev_zones_calmes_rurales__2"
                  }
                ]
              },
              {
                id: 1384,
                name: "aev_zones_calmes_urbaines",
                metadata: {
                  is_queryable: true,
                  legend_name: "aev:zones_calmes",
                  metadata_id: "82ba068d-81c3-41d3-a24a-f5dc2545d005"
                },
                dimensions: {},
                type: "WMS",
                layers: "aev_zones_calmes_urbaines",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "aev_zones_calmes_urbaines__4"
                  },
                  {
                    name: "aev_zones_calmes_urbaines__7"
                  }
                ]
              },
              {
                id: 1385,
                name: "aev_oases_urbaines",
                metadata: {
                  is_queryable: true,
                  legend_name: "aev:zones_calmes",
                  metadata_id: "655d2f1e-c4b6-4f33-a4d1-4171d64bc3b1"
                },
                dimensions: {},
                type: "WMS",
                layers: "aev_oases_urbaines",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "aev_oases_urbaines__3"
                  },
                  {
                    name: "aev_oases_urbaines__6"
                  }
                ]
              },
              {
                id: 1828,
                name: "aev_zones_calmes_campagne_groupe",
                children: [
                  {
                    id: 1829,
                    name: "aev_zones_calmes_camp2020_ZCP",
                    metadata: {
                      is_queryable: true,
                      legend_name: "aev:zones_calmes_20",
                      metadata_id: "d6f1740a-4c8a-40aa-a564-ddb6735f5a34"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aev_zones_calmes_camp2020_ZCP",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aev_zones_calmes_camp2020_ZCP__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 2131,
            name: "env_esch22",
            children: [
              {
                id: 2130,
                name: "env_esch22_soundwalks",
                children: [
                  {
                    id: 2127,
                    name: "aev_soundwalks_fading_thunders",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "1374bb36-c9c4-4be0-b81c-d7d1d7ae9684"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aev_soundwalks_fading_thunders",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aev_soundwalks_fading_thunders__1"
                      },
                      {
                        name: "aev_soundwalks_fading_thunders__2"
                      }
                    ]
                  },
                  {
                    id: 2128,
                    name: "aev_soundwalks_city_stories",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "0e47e8c5-1a26-4928-9a94-d26eba39c738"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aev_soundwalks_city_stories",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aev_soundwalks_city_stories__4"
                      },
                      {
                        name: "aev_soundwalks_city_stories__5"
                      }
                    ]
                  },
                  {
                    id: 2129,
                    name: "aev_soundwalks_blue_noise",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "3e7eea7f-c751-4c7a-9abb-7bdda313628c"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aev_soundwalks_blue_noise",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aev_soundwalks_blue_noise__7"
                      },
                      {
                        name: "aev_soundwalks_blue_noise__8"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1510,
            name: "aev_dechets",
            children: [
              {
                id: 1509,
                name: "aev_dechets_biogas",
                metadata: {
                  is_queryable: true,
                  metadata_id: "2f4a0025-33a4-4015-9acd-4660cef27129"
                },
                dimensions: {},
                type: "WMS",
                layers: "aev_dechets_biogas",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "aev_dechets_biogas__1"
                  }
                ]
              },
              {
                id: 1506,
                name: "aev_dechets_composting",
                metadata: {
                  is_queryable: true,
                  metadata_id: "fe751427-564d-44b3-9d06-90a5d1a5054c"
                },
                dimensions: {},
                type: "WMS",
                layers: "aev_dechets_composting",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "aev_dechets_composting__0"
                  }
                ]
              },
              {
                id: 1507,
                name: "aev_dechets_inert_waste",
                metadata: {
                  is_queryable: true,
                  metadata_id: "e17908a0-c45d-4312-bc8b-fdde4b5c5d83"
                },
                dimensions: {},
                type: "WMS",
                layers: "aev_dechets_inert_waste",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "aev_dechets_inert_waste__2"
                  }
                ]
              },
              {
                id: 1508,
                name: "aev_dechets_recycling",
                metadata: {
                  is_queryable: true,
                  metadata_id: "7dc38059-fbac-4287-99aa-4d04bb7dd761"
                },
                dimensions: {},
                type: "WMS",
                layers: "aev_dechets_recycling",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "aev_dechets_recycling__3"
                  }
                ]
              },
              {
                id: 1802,
                name: "aev_dechets_entrepots",
                metadata: {
                  is_queryable: true,
                  metadata_id: "18d151a7-febc-4290-9b13-219fd183b75d"
                },
                dimensions: {},
                type: "WMS",
                layers: "aev_dechets_entrepots",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "aev_dechets_entrepots__4"
                  }
                ]
              },
              {
                id: 1801,
                name: "aev_dechets_menager",
                metadata: {
                  is_queryable: true,
                  metadata_id: "8e63ec89-7d10-4374-88bc-580caabf9783"
                },
                dimensions: {},
                type: "WMS",
                layers: "aev_dechets_menager",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "aev_dechets_menager__5"
                  }
                ]
              },
              {
                id: 1933,
                name: "aev_dechets_stations_epuration",
                metadata: {
                  is_queryable: true,
                  metadata_id: "b821085f-91a1-431e-a385-2f9e0dfef43d"
                },
                dimensions: {},
                type: "WMS",
                layers: "aev_dechets_stations_epuration",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "aev_dechets_stations_epuration__6"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1466,
            name: "aev_facilities_registers",
            children: [
              {
                id: 803,
                name: "cadastre_hertzien_group",
                children: [
                  {
                    id: 811,
                    name: "mat_antennes_moins_50_watt",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:antennesbelow50w",
                      metadata_id: "cbf57825-26ba-4e36-98e8-083c1945066c"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mat_antennes_moins_50_watt",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mat_antennes_moins_50_watt__0"
                      }
                    ]
                  },
                  {
                    id: 1930,
                    name: "mat_5G_antennes_plus_50_watt",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "76e25a5d-8e78-40cb-a54b-9cfc27b16e60"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mat_5G_antennes_plus_50_watt",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mat_5G_antennes_plus_50_watt__0"
                      }
                    ]
                  },
                  {
                    id: 2053,
                    name: "mat_5G-3.6GHZ_antennes_plus_50_watt",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "e048acda-0ec7-4f52-8221-613d9312c28b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mat_5G-3.6GHZ_antennes_plus_50_watt",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mat_5G-3.6GHZ_antennes_plus_50_watt__0"
                      }
                    ]
                  },
                  {
                    id: 801,
                    name: "mat_antennes_plus_50_watt",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:antennes",
                      metadata_id: "e4a24392-591c-4d20-a62b-f75a9191488d"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mat_antennes_plus_50_watt",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mat_antennes_plus_50_watt__0"
                      }
                    ]
                  },
                  {
                    id: 802,
                    name: "mat_points_mesure",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:pointmesure",
                      metadata_id: "f8f71353-40b8-4e10-b72c-85d8fe9e0577"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mat_points_mesure",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mat_points_mesure__0"
                      }
                    ]
                  }
                ],
                metadata: {
                  is_expanded: true
                },
                mixed: true
              },
              {
                id: 1360,
                name: "aev_emplacements_eoliennes",
                metadata: {
                  is_queryable: true,
                  legend_name: "aev:eoliennes",
                  metadata_id: "354c5313-a733-4121-8f0d-5e0932d563b7"
                },
                dimensions: {},
                type: "WMS",
                layers: "aev_emplacements_eoliennes",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "aev_emplacements_eoliennes__0"
                  },
                  {
                    name: "aev_emplacements_eoliennes__1"
                  }
                ]
              },
              {
                id: 1826,
                name: "aev_facilities_ied",
                metadata: {
                  is_queryable: true,
                  legend_name: "aev_facilities_ied",
                  metadata_id: "2606152c-0169-41a2-843e-861e15e9024c"
                },
                dimensions: {},
                type: "WMS",
                layers: "aev_facilities_ied",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "aev_facilities_ied__0"
                  }
                ]
              },
              {
                id: 798,
                name: "seveso",
                metadata: {
                  is_queryable: true,
                  legend_name: "seveso",
                  metadata_id: "b9ab14d8-4e51-4146-b019-3937715a8fe8"
                },
                dimensions: {},
                type: "WMS",
                layers: "seveso",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "seveso__POI"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1467,
            name: "radon",
            children: [
              {
                id: 1468,
                name: "carte_radon_communes",
                metadata: {
                  is_queryable: true,
                  legend_name: "radon",
                  metadata_id: "80309cdb-b664-4ea8-a3a4-c602f5814f79"
                },
                dimensions: {},
                type: "WMS",
                layers: "carte_radon_communes",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "carte_radon_communes__0"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          bg_layer: "pixelmaps-gray",
          css: "anf.css",
          display_in_switcher: true,
          link_title: "Portail Environnement",
          page_title: "emwelt.geoportail.lu",
          print_img: "anf_right.jpg",
          print_long_txt_de: "Das \xF6ffentliche Geoportal des Grossherzogtums Luxemburg",
          print_long_txt_en: "The official geoportal for the Grand-Duchy of Luxembourg",
          print_long_txt_fr: "Le g\xE9oportail officiel du Grand-Duch\xE9 de Luxembourg",
          print_long_txt_lu: "Den offizielle Geoportal vu L\xEBtzebuerg",
          print_scales: [
            "1000",
            "1500",
            "2500",
            "5000",
            "10000",
            "15000",
            "20000",
            "25000",
            "50000",
            "80000",
            "100000",
            "125000",
            "200000",
            "250000",
            "400000"
          ],
          print_short_txt_de: "emwelt.geoportal.lu",
          print_short_txt_en: "emwelt.geoportal.lu",
          print_short_txt_fr: "emwelt.geoportail.lu",
          print_short_txt_lu: "emwelt.geoportal.lu",
          show_in_mobile: true
        }
      },
      {
        id: 128,
        name: "eau",
        icon: "eau",
        children: [
          {
            id: 234,
            name: "eau_basisdaten",
            children: [
              {
                id: 317,
                name: "eau_topographie",
                children: [
                  {
                    id: 206,
                    name: "topo_20k",
                    metadata: {
                      legend_name: "topo_20k",
                      metadata_id: "ea998ae8-731a-43bc-aa9f-171684f97602"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "topo_20k",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 160,
                name: "eau_luft_sat_bilder",
                children: [
                  {
                    id: 2056,
                    name: "ortho_2020",
                    metadata: {
                      exclusion: "[119,219]",
                      metadata_id: "87870b8a-10a1-4c33-bf50-7efe851fd450"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR_4_V3",
                    layer: "ortho_2020",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 1789,
                    name: "ortho_2019_winter",
                    metadata: {
                      exclusion: "[118,218]",
                      metadata_id: "d6cc500f-b802-4be2-a49c-73f3eb2d131e"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2019_winter",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 1784,
                    name: "ortho_2019",
                    metadata: {
                      exclusion: "[116,216]",
                      metadata_id: "97c88ef6-6c64-4cb0-a134-06bb42b2b448"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2019",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 1527,
                    name: "ortho_2018",
                    metadata: {
                      exclusion: "[113,213]",
                      metadata_id: "6fde72c4-802f-4663-be74-5fa5901cb4f0"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2018",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 1371,
                    name: "ortho_2017",
                    metadata: {
                      exclusion: "[111,211]",
                      metadata_id: "1cdae616-1a7a-49d5-b35d-05864891641f"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2017",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 745,
                    name: "ortho_2016",
                    metadata: {
                      exclusion: "[107,207]",
                      metadata_id: "bba79b6d-4205-4ce4-98e4-7b7922afcd55"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2016",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 343,
                    name: "ortho",
                    metadata: {
                      exclusion: "[34,44]",
                      metadata_id: "0faf4bdb-a54b-42d7-942c-4e52fa66e963"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 311,
                    name: "ortho_irc",
                    metadata: {
                      exclusion: "[102,202]",
                      metadata_id: "9848c7ac-0c12-430d-a05f-62dda9e234a0"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_irc",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 224,
                    name: "ortho_2004",
                    metadata: {
                      exclusion: "[103,203]",
                      metadata_id: "a185f78a-ca9c-43f8-8d06-b1abba8ff056"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2004",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 225,
                    name: "ortho_2001",
                    metadata: {
                      exclusion: "[104,204]",
                      metadata_id: "e6ff269c-1c7c-401f-a90b-b805e80a046e"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2001",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 292,
                    name: "wg_ikonos_satellitendaten",
                    metadata: {
                      legend_name: "wg:ikonos_satellitendaten",
                      metadata_id: "db0eea79-114a-4e61-a1f2-7e064f92cdd3"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "wg_ikonos_satellitendaten",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 318,
                name: "eau_landnutzung",
                children: [
                  {
                    id: 301,
                    name: "wg_landnutzung",
                    metadata: {
                      is_queryable: true,
                      legend_name: "wg:landnutzung",
                      metadata_id: "f53e9c0b-a269-48e6-b77c-061e7ac2e116",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "wg_landnutzung",
                    imageType: "image/png"
                  },
                  {
                    id: 308,
                    name: "wg_versiegelungsklassen",
                    metadata: {
                      legend_name: "wg:versiegelungsklassen",
                      metadata_id: "7e48b187-3080-4bf6-aaa8-6a58fe513380",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "wg_versiegelungsklassen",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 186,
                name: "eau_grenzen",
                children: [
                  {
                    id: 349,
                    name: "country",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "4c9b3c0b-85d4-447d-a68c-7416869f8d9b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "country",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "country__PAYS"
                      }
                    ]
                  },
                  {
                    id: 346,
                    name: "cantons_labels",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "3af20a80-be4a-4819-a42b-18e49af799aa"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "cantons_labels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cantons_labels__CANTONS_LABELS"
                      }
                    ]
                  },
                  {
                    id: 329,
                    name: "cantons",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "e8a034e8-f986-4745-a848-b7ef30ce2740"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "CANTONS",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cantons__CANTONS"
                      }
                    ]
                  },
                  {
                    id: 269,
                    name: "communes_labels",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "17c7d883-ff7f-4b48-a894-46bea40d2e49"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "communes_labels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "communes_labels__COMMUNES_LABELS"
                      }
                    ]
                  },
                  {
                    id: 302,
                    name: "communes",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "de5373d6-340f-4203-a065-da7550a03cc4_2049"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "communes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "communes__COMMUNES"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 165,
                name: "adressen",
                children: [
                  {
                    id: 152,
                    name: "addresses",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "28b310e4-b9e1-467c-a28d-fce2e9a96548"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "addresses",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 169,
                name: "eau_zones_protegees",
                children: [
                  {
                    id: 207,
                    name: "eau_zones_protegees_nationales",
                    children: [
                      {
                        id: 319,
                        name: "eau_anf_reserves",
                        children: [
                          {
                            id: 804,
                            name: "anf_zpin_declarees",
                            metadata: {
                              is_queryable: true,
                              legend_name: "anf:zpin_declarees",
                              metadata_id: "9439d9b1-eff6-47b5-a4c7-4c5bde2744f4"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "anf_zpin_declarees",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "anf_zpin_declarees__ZPIN_DECLAREES"
                              }
                            ]
                          },
                          {
                            id: 805,
                            name: "anf_zpin_a_declarer",
                            metadata: {
                              is_queryable: true,
                              legend_name: "anf:zpin_a_declarer",
                              metadata_id: "db53336b-1a33-4b1a-94a8-42a29b55ce45"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "anf_zpin_a_declarer",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "anf_zpin_a_declarer__ZPIN_A_DECLARER"
                              }
                            ]
                          },
                          {
                            id: 806,
                            name: "anf_zpin_en_procedure",
                            metadata: {
                              is_queryable: true,
                              legend_name: "anf:zpin_en_procedure_reglementaire",
                              metadata_id: "74499cf0-ab69-48bd-a357-8c151dd3d5c9"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "anf_zpin_en_procedure",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "anf_zpin_en_procedure__ZPIN_EN_PROCEDURE_REGLEMENTAIRE"
                              }
                            ]
                          }
                        ],
                        metadata: {},
                        mixed: true
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 330,
                name: "geodesy",
                children: [
                  {
                    id: 1831,
                    name: "ng_new",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "3119179b-56bb-459d-8904-1e0a2bfb6bc7"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ng_new",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ng_new__0"
                      }
                    ]
                  },
                  {
                    id: 411,
                    name: "ng",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "3119179b-56bb-459d-8904-1e0a2bfb6bc7"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ng",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ng__POINT_NG"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 453,
            name: "eau_new_Messstationen",
            children: [
              {
                id: 485,
                name: "eau_new_Hydrologische_Messstationen",
                children: [
                  {
                    id: 655,
                    name: "eau_new_Wasserstand",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:wasserstand",
                      max_dpi: 128,
                      metadata_id: "124abb10-1d87-4449-912b-06fbf307a95f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Wasserstand",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Wasserstand__Wasserstand"
                      }
                    ]
                  },
                  {
                    id: 653,
                    name: "eau_new_Alluvialer_Grundwasserspiegel",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:alluvialer_grundwasserspiegel",
                      max_dpi: 128,
                      metadata_id: "4d328b62-5df3-4205-a45a-4d3d36dc0fa8"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Alluvialer_Grundwasserspiegel",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Alluvialer_Grundwasserspiegel__Alluvialer Grundwasserspiegel"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 460,
                name: "eau_new_Klimatologische_Messstationen",
                children: [
                  {
                    id: 609,
                    name: "eau_new_Niederschlag",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:niederschlag",
                      max_dpi: 128,
                      metadata_id: "288300c6-5d83-45a6-98ef-4146f37129e2"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Niederschlag",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Niederschlag__Niederschlag"
                      }
                    ]
                  },
                  {
                    id: 595,
                    name: "eau_new_Lufttemperatur",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:lufttemperatur",
                      max_dpi: 128,
                      metadata_id: "6d73e310-0ef2-4e19-863d-387a90405e78"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Lufttemperatur",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Lufttemperatur__Lufttemperatur"
                      }
                    ]
                  },
                  {
                    id: 620,
                    name: "eau_new_Bodentemperatur",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:bodentemperatur",
                      max_dpi: 128,
                      metadata_id: "ebded1e9-613e-4f58-a47f-386676a0a39f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Bodentemperatur",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Bodentemperatur__Bodentemperatur"
                      }
                    ]
                  },
                  {
                    id: 610,
                    name: "eau_new_Schneehoehe",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:schneehoehe",
                      max_dpi: 128,
                      metadata_id: "60c9ec41-6fa8-4aed-8822-bfdad9ab755d"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Schneehoehe",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Schneehoehe__Schneeh\xF6he"
                      }
                    ]
                  },
                  {
                    id: 615,
                    name: "eau_new_Luftfeucht",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:luftfeucht",
                      max_dpi: 128,
                      metadata_id: "bbb784cd-a8f2-4f60-8d2d-8a7bd341ac73"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Luftfeucht",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Luftfeucht__Luftfeucht"
                      }
                    ]
                  },
                  {
                    id: 563,
                    name: "eau_new_Luftdruck",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:luftdruck",
                      max_dpi: 128,
                      metadata_id: "1ebc644b-0643-495f-84ed-c820459920cc"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Luftdruck",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Luftdruck__Luftdruck"
                      }
                    ]
                  },
                  {
                    id: 616,
                    name: "eau_new_Globalstrahlung",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:globalstrahlung",
                      max_dpi: 128,
                      metadata_id: "f5d2d484-adb2-46fc-95f0-9a94c85db5de"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Globalstrahlung",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Globalstrahlung__Globalstrahlung"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 473,
                name: "eau_new_Grundwasser_Messstationen",
                children: [
                  {
                    id: 649,
                    name: "eau_new_Grundwasser_(WRRL)_-_Ueberwachung_der_Quantitaet",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:grundwasser_wrrl_-_ueberwachung_der_quantitaet",
                      max_dpi: 128,
                      metadata_id: "df313a40-1cab-4774-971d-41cd0cd17356"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Grundwasser_(WRRL)_-_Ueberwachung_der_Quantitaet",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Grundwasser_(WRRL)_-_Ueberwachung_der_Quantitaet__Grundwasser [WRRL] - \xDCberwachung der Quantit\xE4t"
                      }
                    ]
                  },
                  {
                    id: 650,
                    name: "eau_new_Grundwasser_(WRRL)_-_Ueberwachung_der_Qualitaet",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:grundwasser_wrrl_-_ueberwachung_der_qualitaet",
                      max_dpi: 128,
                      metadata_id: "2a564018-2c6e-4d3c-bb0c-68489980cfc0"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Grundwasser_(WRRL)_-_Ueberwachung_der_Qualitaet",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Grundwasser_(WRRL)_-_Ueberwachung_der_Qualitaet__Grundwasser [WRRL] - \xDCberwachung der Qualit\xE4t"
                      }
                    ]
                  },
                  {
                    id: 570,
                    name: "eau_new_Grundwasser_Nitratrichtlinie_91_676_CEE",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:grundwasser_nitratrichtlinie",
                      max_dpi: 128,
                      metadata_id: "9b358488-a605-46af-81eb-90c4ab7c9931"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "570",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Grundwasser_Nitratrichtlinie_91_676_CEE__320"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 472,
                name: "eau_new_Oberflaechengewaesser_Messstationen",
                children: [
                  {
                    id: 627,
                    name: "eau_new_WRRL_-_Ueberblicksueberwachung",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:wrrl_-_ueberblicksueberwachung",
                      max_dpi: 128,
                      metadata_id: "7d186827-29a6-4907-89a7-070c025fbb99"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_WRRL_-_Ueberblicksueberwachung",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_WRRL_-_Ueberblicksueberwachung__WRRL - \xDCberblicks\xFCberwachung"
                      }
                    ]
                  },
                  {
                    id: 768,
                    name: "eau_new_\xDCberwachungsprogramme - Resultate",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:wrrl_-_messstationen_resultate",
                      metadata_id: "84221daf-0a56-4312-bf56-fc9d1f869a05"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_\xDCberwachungsprogramme - Resultate",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_\xDCberwachungsprogramme - Resultate__WRRL - Messstationen Resultate"
                      }
                    ]
                  },
                  {
                    id: 654,
                    name: "eau_new_Oberfl\xE4chengew\xE4sser_Nitratrichtlinie_91_676_CEE",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:nitratrichtlinie_messstationen",
                      max_dpi: 128,
                      metadata_id: "dc7d9871-2693-4714-b1f6-ab202a59d28b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "654",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Oberfl\xE4chengew\xE4sser_Nitratrichtlinie_91_676_CEE__16"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 484,
            name: "eau_new_Hydrografie",
            children: [
              {
                id: 450,
                name: "eau_new_Gewaessernetz",
                children: [
                  {
                    id: 749,
                    name: "eau_new_Gew\xE4sser",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:primaere_gewaesser_sekundaere_gewaesser_temporaer_fliessende_baeche",
                      metadata_id: "9da34ec3-89d5-4731-b927-e38ed8088571"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Gew\xE4sser",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Gew\xE4sser__Prim\xE4re Gew\xE4sser"
                      },
                      {
                        name: "eau_new_Gew\xE4sser__Sekund\xE4re Gew\xE4sser"
                      },
                      {
                        name: "eau_new_Gew\xE4sser__Tempor\xE4r fliessende B\xE4che"
                      }
                    ]
                  },
                  {
                    id: 651,
                    name: "eau_new_Kanal_-__Muehlgraben",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:kanal_-__muehlgraben",
                      max_dpi: 128,
                      metadata_id: "909501fc-a0a9-4af8-8e82-f2a8d7f2fe2f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Kanal_-__Muehlgraben",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Kanal_-__Muehlgraben__Kanal -  M\xFChlgraben"
                      }
                    ]
                  },
                  {
                    id: 750,
                    name: "eau_new_Kilometrierung der Gew\xE4sser",
                    metadata: {
                      legend_name: "eau:kilometrierung_primaere_gewaesser_kilometrierung_sekundaere_gewaesser",
                      metadata_id: "4002b1cf-08b5-421a-bc92-40271d62f03c"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Kilometrierung der Gew\xE4sser",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Kilometrierung der Gew\xE4sser__Kilometrierung prim\xE4re Gew\xE4sser"
                      },
                      {
                        name: "eau_new_Kilometrierung der Gew\xE4sser__Kilometrierung sekund\xE4re Gew\xE4sser"
                      }
                    ]
                  },
                  {
                    id: 636,
                    name: "eau_new_Einzugsgebiete",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:einzugsgebiete",
                      max_dpi: 128,
                      metadata_id: "a295a30a-f819-400c-842c-d0ccc695bea5"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Einzugsgebiete",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Einzugsgebiete__Einzugsgebiete"
                      }
                    ]
                  },
                  {
                    id: 569,
                    name: "eau_new_Stausee_Sauer",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:stausee_sauer",
                      max_dpi: 128,
                      metadata_id: "119ad2e3-b44f-4777-883d-d2d522bafeca"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Stausee_Sauer",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Stausee_Sauer__Stausee Sauer"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 451,
                name: "eau_new_Fischerei",
                children: [
                  {
                    id: 626,
                    name: "eau_new_Fischereiabschnitte",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:fischereiabschnitte",
                      max_dpi: 128,
                      metadata_id: "bd6be85a-cec4-4e4d-9657-cffa242db28f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Fischereiabschnitte",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Fischereiabschnitte__Fischereiabschnitte"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 483,
            name: "eau_new_Grundwasser",
            children: [
              {
                id: 628,
                name: "eau_new_Bohrungen",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:bohrungen",
                  max_dpi: 128,
                  metadata_id: "4ab49f17-a50e-4439-9a9e-01ec93421aec"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Bohrungen",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Bohrungen__39"
                  }
                ]
              },
              {
                id: 629,
                name: "eau_new_Quellen",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:quellen",
                  max_dpi: 128,
                  metadata_id: "58fa573a-a0c3-474d-9e74-c277cf90b135"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Quellen",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Quellen__Quellen"
                  }
                ]
              },
              {
                id: 631,
                name: "eau_new_Grundwasserleiter",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:grundwasserleiter",
                  max_dpi: 128,
                  metadata_id: "783a8608-e4b3-44ed-8864-68525da33760"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Grundwasserleiter",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Grundwasserleiter__Grundwasserleiter"
                  }
                ]
              },
              {
                id: 2396,
                name: "eau_new_Einschraenkung_Waermepumpe_(public)",
                metadata: {
                  legend_name: "eau:einschraenkung_waermepumpe",
                  max_dpi: 128,
                  metadata_id: "ed3ff125-47cc-4247-abaf-77e05cf60984"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Einschraenkung_Waermepumpe_(public)",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Einschraenkung_Waermepumpe_(public)__Einschr\xE4nkung W\xE4rmepumpe"
                  }
                ]
              },
              {
                id: 2288,
                name: "eau_new_Einschraenkung_Waermepumpe_nouvelle_couche",
                metadata: {
                  legend_name: "eau:einschraenkung_waermepumpe_15m",
                  max_dpi: 128,
                  metadata_id: "b2d715ed-660e-46e6-8c5f-ee3327e0fcb9"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Einschraenkung_Waermepumpe_nouvelle_couche",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Einschraenkung_Waermepumpe_nouvelle_couche__Einschr\xE4nkung W\xE4rmepumpen 15m"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 448,
            name: "eau_new_Trinkwasser",
            children: [
              {
                id: 567,
                name: "eau_new_Trinkwasserentnahmepunkte",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:trinkwasserentnahmepunkte",
                  max_dpi: 128,
                  metadata_id: "a049086b-9c17-4ba6-b9bf-78cb4af8ee68"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Trinkwasserentnahmepunkte",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Trinkwasserentnahmepunkte__Trinkwasserentnahmepunkte"
                  }
                ]
              },
              {
                id: 598,
                name: "eau_new_Trinkwasserbehaelter",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:trinkwasserbehaelter",
                  max_dpi: 128,
                  metadata_id: "abe5466d-e045-4872-a17c-7379adc497f5"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Trinkwasserbehaelter",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Trinkwasserbehaelter__Trinkwasserbeh\xE4lter"
                  }
                ]
              },
              {
                id: 538,
                name: "eau_new_Trinkwassersyndikate",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau_new:trinkwassersyndikate",
                  max_dpi: 128,
                  metadata_id: "63ecd69e-5714-4311-b05a-5bfa191ac546"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Trinkwassersyndikate",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Trinkwassersyndikate__Trinkwassersyndikate"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 373,
            name: "eau_new_Trinkwasser_Schutzzonen_(ZPS)",
            children: [
              {
                id: 214,
                name: "eau_new_Provisorische_ZPS",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:provisorische_zps",
                  max_dpi: 128,
                  metadata_id: "ddc51f25-2fb7-4d14-866a-a08f8af8ef03"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Provisorische_ZPS",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Provisorische_ZPS__Provisorische ZPS"
                  }
                ]
              },
              {
                id: 664,
                name: "eau_new_ZPS_laufende_oeffentliche_Verfahrungsweise",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:zps_laufende_oeffentliche_verfahrungsweise",
                  max_dpi: 128,
                  metadata_id: "87beb1ac-7496-48f6-b5a9-8666e3897523"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_ZPS_laufende_oeffentliche_Verfahrungsweise",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_ZPS_laufende_oeffentliche_Verfahrungsweise__ZPS laufende \xF6ffentliche Verfahrungsweise"
                  }
                ]
              },
              {
                id: 573,
                name: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:zps_durch_grosshrzgl._verordnung_festgelegt",
                  max_dpi: 128,
                  metadata_id: "d70f99e0-6032-4a4b-b516-5dfdfce33b26"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt__ZPS durch grosshrzgl. Verordnung festgelegt"
                  }
                ]
              },
              {
                id: 1464,
                name: "eau_prgd_zones_protection_lac",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:prgd_stausee",
                  metadata_id: "eab29425-71cc-4610-b48e-8d848d0a8431"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_prgd_zones_protection_lac",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_prgd_zones_protection_lac__PRGD Schutzzonen Stausee"
                  }
                ]
              },
              {
                id: 490,
                name: "eau_new_Sanitaere_Schutzzonen_Stausee_EschSauer",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:sanitaere_schutzzonen_stausee",
                  max_dpi: 128,
                  metadata_id: "e34de488-68ea-48a8-9e92-f67bb209508e"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Sanitaere_Schutzzonen_Stausee_EschSauer",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Sanitaere_Schutzzonen_Stausee_EschSauer__Sanit\xE4re Schutzzonen Stausee"
                  }
                ]
              },
              {
                id: 559,
                name: "eau_new_Zones_interdiction_utilisation_metazachlore",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau_new:metazachlore",
                  max_dpi: 128,
                  metadata_id: "803e93f8-588f-4697-8d76-972be1ad3531",
                  start_opacity: 0.7
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Zones_interdiction_utilisation_metazachlore",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Zones_interdiction_utilisation_metazachlore__Zones interdiction utilisation metazachlore"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 469,
            name: "eau_new_Schutzgebiete",
            children: [
              {
                id: 656,
                name: "eau_new_Badegewaesser",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:badegewaesser",
                  max_dpi: 128,
                  metadata_id: "72f770ee-7290-4ecb-9358-580b7cfcadf7"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Badegewaesser",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Badegewaesser__Badegew\xE4sser"
                  }
                ]
              },
              {
                id: 581,
                name: "eau_new_Badegewaesser_-_Qualitaet",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:badegewaesser_-_qualitaet",
                  max_dpi: 128,
                  metadata_id: "c0c9c705-8b26-4a0b-b9bb-e2243cd5386a"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Badegewaesser_-_Qualitaet",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Badegewaesser_-_Qualitaet__Badegew\xE4sser - Qualit\xE4t"
                  }
                ]
              },
              {
                id: 612,
                name: "eau_new_Empfindliche_Gebiete_(Kommunalabwasserrichtlinie)",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:empfindliche_gebiete_kommunalabwasserrichtlinie",
                  max_dpi: 128,
                  metadata_id: "39952e6c-8e73-4a23-a19c-78c4f06c84d9"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Empfindliche_Gebiete_(Kommunalabwasserrichtlinie)",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Empfindliche_Gebiete_(Kommunalabwasserrichtlinie)__Empfindliche Gebiete [Kommunalabwasserrichtlinie]"
                  }
                ]
              },
              {
                id: 492,
                name: "eau_new_Gefaehrdete_Gebiete_(Nitratrichtlinie)",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:gefaehrdete_gebiete_nitratrichtlinie",
                  max_dpi: 128,
                  metadata_id: "9426a9a6-7cb1-4c1a-a504-40dabc4429c0"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Gefaehrdete_Gebiete_(Nitratrichtlinie)",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Gefaehrdete_Gebiete_(Nitratrichtlinie)__Gef\xE4hrdete Gebiete [Nitratrichtlinie]"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 470,
            name: "eau_new_Gewaesserschutz",
            children: [
              {
                id: 643,
                name: "eau_new_Abwassersyndikate",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:abwassersyndikate",
                  max_dpi: 128,
                  metadata_id: "4b5e384c-5603-4cf4-9bd5-6e520df5c375"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Abwassersyndikate",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Abwassersyndikate__Abwassersyndikate"
                  }
                ]
              },
              {
                id: 645,
                name: "eau_new_Klaeranlagen",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:klaeranlagen",
                  max_dpi: 128,
                  metadata_id: "53e55765-90eb-438f-a744-3ac878b06334"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Klaeranlagen",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Klaeranlagen__Kl\xE4ranlagen"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 486,
            name: "eau_new_Hochwasserrisikomanagement-Richtlinie [HWRM-RL]",
            children: [
              {
                id: 1696,
                name: "eau_new_Risikogewaesser_2019_group",
                children: [
                  {
                    id: 1703,
                    name: "eau_Risikogewaesser_2019",
                    metadata: {
                      legend_name: "eau:risikogewaesser_2019",
                      metadata_id: "762cd956-9733-4855-afa7-38768a38e8a1"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_Risikogewaesser_2019",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_Risikogewaesser_2019__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2114,
                name: "eau_Hochwassergefahrenkarten_2021",
                children: [
                  {
                    id: 2117,
                    name: "eau_Hochwassergefahrenkarten_HQ10_2021",
                    metadata: {
                      legend_name: "eau:inondations_2019",
                      metadata_id: "153130ef-8255-4bce-bca0-d2359d277995"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "eau_Hochwassergefahrenkarten_HQ10_2021",
                    imageType: "image/png"
                  },
                  {
                    id: 2118,
                    name: "eau_Hochwassergefahrenkarten_HQ100_2021",
                    metadata: {
                      legend_name: "eau:inondations_2019",
                      metadata_id: "cdb4137d-822f-4888-8a51-4596480970fe"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "eau_Hochwassergefahrenkarten_HQ100_2021",
                    imageType: "image/png"
                  },
                  {
                    id: 2119,
                    name: "eau_Hochwassergefahrenkarten_HQext_2021",
                    metadata: {
                      legend_name: "eau:inondations_2019",
                      metadata_id: "cd0f52f7-7226-4748-95e0-b77025284423"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "eau_Hochwassergefahrenkarten_HQext_2021",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2115,
                name: "eau_Hochwasserrisikokarten_2021",
                children: [
                  {
                    id: 2120,
                    name: "eau_Hochwasserrisikokarten_HQ10_2021",
                    metadata: {
                      legend_name: "eau:risque_inondations_2019",
                      metadata_id: "4a428832-16cf-4861-a1da-78a1f0a8c194"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "eau_Hochwasserrisikokarten_HQ10_2021",
                    imageType: "image/png"
                  },
                  {
                    id: 2121,
                    name: "eau_Hochwasserrisikokarten_HQ100_2021",
                    metadata: {
                      legend_name: "eau:risque_inondations_2019",
                      metadata_id: "ccb959ef-0ad6-47ec-ade9-45021912353f"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "eau_Hochwasserrisikokarten_HQ100_2021",
                    imageType: "image/png"
                  },
                  {
                    id: 2122,
                    name: "eau_Hochwasserrisikokarten_HQext_2021",
                    metadata: {
                      legend_name: "eau:risque_inondations_2019",
                      metadata_id: "f803b49a-336a-4bb7-acd9-5cbf508a731f"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "eau_Hochwasserrisikokarten_HQext_2021",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1711,
                name: "eau_atlas_crues_subites",
                children: [
                  {
                    id: 2045,
                    name: "age_dangers_fortes",
                    metadata: {
                      legend_name: "age_dangers_fortes",
                      metadata_id: "55dbe91c-f1e5-4c56-b0b9-4590988e23e5"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "age_dangers_fortes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "age_dangers_fortes__0"
                      },
                      {
                        name: "age_dangers_fortes__1"
                      }
                    ]
                  },
                  {
                    id: 2046,
                    name: "age_risques_fortes",
                    metadata: {
                      legend_name: "age_risques_fortes",
                      metadata_id: "f1d9b1cd-ad78-44df-89ac-ad591138243f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "age_risques_fortes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "age_risques_fortes__0"
                      },
                      {
                        name: "age_risques_fortes__1"
                      },
                      {
                        name: "age_risques_fortes__2"
                      },
                      {
                        name: "age_risques_fortes__3"
                      },
                      {
                        name: "age_risques_fortes__4"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 461,
                name: "eau_new_Historische_Ueberschwemmungsgebiete",
                children: [
                  {
                    id: 637,
                    name: "eau_new_UESG_1983_-_Mosel",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:uesg_1983_-_mosel",
                      max_dpi: 128,
                      metadata_id: "e6896207-c0f9-417e-9661-119128628e8e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_UESG_1983_-_Mosel",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_UESG_1983_-_Mosel__UESG 1983 - Mosel"
                      }
                    ]
                  },
                  {
                    id: 641,
                    name: "eau_new_UESG_1993_(ausser_Mosel)",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:uesg_1993_ausser_mosel",
                      max_dpi: 128,
                      metadata_id: "78c692f3-ad20-467b-b03a-0d020a821647"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_UESG_1993_(ausser_Mosel)",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_UESG_1993_(ausser_Mosel)__UESG 1993 [ausser Mosel]"
                      }
                    ]
                  },
                  {
                    id: 642,
                    name: "eau_new_UESG_Alzette_1995",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:uesg_alzette_1995",
                      max_dpi: 128,
                      metadata_id: "aaf81780-df85-4580-a890-fded8ae03db7"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_UESG_Alzette_1995",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_UESG_Alzette_1995__UESG Alzette 1995"
                      }
                    ]
                  },
                  {
                    id: 633,
                    name: "eau_new_UESG_Sauer_1995",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:uesg_sauer_1995",
                      max_dpi: 128,
                      metadata_id: "f01f7be2-0423-4571-8fff-57dd617ae632"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_UESG_Sauer_1995",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_UESG_Sauer_1995__UESG Sauer 1995"
                      }
                    ]
                  },
                  {
                    id: 2116,
                    name: "eau_Hochwasserkarten_2021",
                    children: [
                      {
                        id: 2114,
                        name: "eau_Hochwassergefahrenkarten_2021",
                        children: [
                          {
                            id: 2117,
                            name: "eau_Hochwassergefahrenkarten_HQ10_2021",
                            metadata: {
                              legend_name: "eau:inondations_2019",
                              metadata_id: "153130ef-8255-4bce-bca0-d2359d277995"
                            },
                            dimensions: {},
                            type: "WMTS",
                            url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                            style: "default",
                            matrixSet: "GLOBAL_WEBMERCATOR",
                            layer: "eau_Hochwassergefahrenkarten_HQ10_2021",
                            imageType: "image/png"
                          },
                          {
                            id: 2118,
                            name: "eau_Hochwassergefahrenkarten_HQ100_2021",
                            metadata: {
                              legend_name: "eau:inondations_2019",
                              metadata_id: "cdb4137d-822f-4888-8a51-4596480970fe"
                            },
                            dimensions: {},
                            type: "WMTS",
                            url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                            style: "default",
                            matrixSet: "GLOBAL_WEBMERCATOR",
                            layer: "eau_Hochwassergefahrenkarten_HQ100_2021",
                            imageType: "image/png"
                          },
                          {
                            id: 2119,
                            name: "eau_Hochwassergefahrenkarten_HQext_2021",
                            metadata: {
                              legend_name: "eau:inondations_2019",
                              metadata_id: "cd0f52f7-7226-4748-95e0-b77025284423"
                            },
                            dimensions: {},
                            type: "WMTS",
                            url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                            style: "default",
                            matrixSet: "GLOBAL_WEBMERCATOR",
                            layer: "eau_Hochwassergefahrenkarten_HQext_2021",
                            imageType: "image/png"
                          }
                        ],
                        metadata: {},
                        mixed: true
                      },
                      {
                        id: 2115,
                        name: "eau_Hochwasserrisikokarten_2021",
                        children: [
                          {
                            id: 2120,
                            name: "eau_Hochwasserrisikokarten_HQ10_2021",
                            metadata: {
                              legend_name: "eau:risque_inondations_2019",
                              metadata_id: "4a428832-16cf-4861-a1da-78a1f0a8c194"
                            },
                            dimensions: {},
                            type: "WMTS",
                            url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                            style: "default",
                            matrixSet: "GLOBAL_WEBMERCATOR",
                            layer: "eau_Hochwasserrisikokarten_HQ10_2021",
                            imageType: "image/png"
                          },
                          {
                            id: 2121,
                            name: "eau_Hochwasserrisikokarten_HQ100_2021",
                            metadata: {
                              legend_name: "eau:risque_inondations_2019",
                              metadata_id: "ccb959ef-0ad6-47ec-ade9-45021912353f"
                            },
                            dimensions: {},
                            type: "WMTS",
                            url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                            style: "default",
                            matrixSet: "GLOBAL_WEBMERCATOR",
                            layer: "eau_Hochwasserrisikokarten_HQ100_2021",
                            imageType: "image/png"
                          },
                          {
                            id: 2122,
                            name: "eau_Hochwasserrisikokarten_HQext_2021",
                            metadata: {
                              legend_name: "eau:risque_inondations_2019",
                              metadata_id: "f803b49a-336a-4bb7-acd9-5cbf508a731f"
                            },
                            dimensions: {},
                            type: "WMTS",
                            url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                            style: "default",
                            matrixSet: "GLOBAL_WEBMERCATOR",
                            layer: "eau_Hochwasserrisikokarten_HQext_2021",
                            imageType: "image/png"
                          }
                        ],
                        metadata: {},
                        mixed: true
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 463,
                name: "eau_new_Zusaetzliche_Informationen",
                children: [
                  {
                    id: 755,
                    name: "eau_new_Gew\xE4sser mit einem signifikanten Hochwasserrisiko",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:gewaesser_mit_einem_signifikanten_hochwasserrisiko",
                      metadata_id: "2006081e-2818-4f2b-978a-8ba505d840a8"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Gew\xE4sser mit einem signifikanten Hochwasserrisiko",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Gew\xE4sser mit einem signifikanten Hochwasserrisiko__Gew\xE4sser mit einem signifikanten Hochwasserrisiko"
                      }
                    ]
                  },
                  {
                    id: 756,
                    name: "eau_new_Hochwasser Brennpunkte",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:hochwasser_brennpunkte",
                      metadata_id: "b2bfd06d-5f05-4abf-8f41-103d40a380e7"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Hochwasser Brennpunkte",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Hochwasser Brennpunkte__Hochwasser Brennpunkte"
                      }
                    ]
                  },
                  {
                    id: 758,
                    name: "eau_new_Ma\xDFnahmens des Hochwasserrisikomanagementplans",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:massnahmens_des_hochwasserrisikomanagementplans",
                      metadata_id: "4326fea6-7ec4-4bb9-861f-4476b0d4ceac"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Ma\xDFnahmens des Hochwasserrisikomanagementplans",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Ma\xDFnahmens des Hochwasserrisikomanagementplans__Ma\xDFnahmens des Hochwasserrisikomanagementplans"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 474,
            name: "eau_new_Wasserrahmenrichtlinie",
            children: [
              {
                id: 1469,
                name: "eau_strahlwirkungskonzept",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:strahlwirkungskonzept",
                  metadata_id: "e1744b8e-101e-406d-b742-776d488a00b5"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_strahlwirkungskonzept",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_strahlwirkungskonzept__Funktionselemente [Funktionale Verbindungsstrecken]"
                  },
                  {
                    name: "eau_strahlwirkungskonzept__Funktionselemente [Grenzen]"
                  }
                ]
              },
              {
                id: 475,
                name: "eau_new_Bewirtschaftungsplan_2009",
                children: [
                  {
                    id: 644,
                    name: "eau_new_Betrachtungsraeume_2009",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:betrachtungsraeume_2009",
                      max_dpi: 128,
                      metadata_id: "be15dd7d-df57-44e1-b724-0929cf05eef9"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Betrachtungsraeume_2009",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Betrachtungsraeume_2009__Betrachtungsr\xE4ume 2009"
                      }
                    ]
                  },
                  {
                    id: 607,
                    name: "eau_new_Typologie_Oberflaechengewasser_2009",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:typologie_oberflaechengewasser_2009",
                      max_dpi: 128,
                      metadata_id: "0d1d73f0-7644-4217-a0df-b6c497508592"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Typologie_Oberflaechengewasser_2009",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Typologie_Oberflaechengewasser_2009__Typologie Oberfl\xE4chengewasser 2009"
                      }
                    ]
                  },
                  {
                    id: 601,
                    name: "eau_new_Oberflaechenwasserkoerper_2009",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:oberflaechenwasserkoerper_2009",
                      max_dpi: 128,
                      metadata_id: "404cf7b4-f70b-4c2c-a44b-89e297fab0f8"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Oberflaechenwasserkoerper_2009",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Oberflaechenwasserkoerper_2009__Oberfl\xE4chenwasserk\xF6rper 2009"
                      }
                    ]
                  },
                  {
                    id: 634,
                    name: "eau_new_Erheblich ver\xE4nderte Wasserk\xF6rper 2009",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:erheblich_veraenderte_owk_2009",
                      max_dpi: 128,
                      metadata_id: "78da31c2-55eb-40c9-99fe-22ff409468c2"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Erheblich ver\xE4nderte Wasserk\xF6rper 2009",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Erheblich ver\xE4nderte Wasserk\xF6rper 2009__Erheblich ver\xE4nderte OWK 2009"
                      }
                    ]
                  },
                  {
                    id: 603,
                    name: "eau_new_Grundwasserkoerper_2009",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:grundwasserkoerper_2009",
                      max_dpi: 128,
                      metadata_id: "f23ca424-ec87-4c53-929c-7e627a8e06af"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Grundwasserkoerper_2009",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Grundwasserkoerper_2009__Grundwasserk\xF6rper 2009"
                      }
                    ]
                  },
                  {
                    id: 468,
                    name: "eau_new_Zustand_der_Wasserkoerper_(WK)_2009",
                    children: [
                      {
                        id: 464,
                        name: "eau_new_Oberflaechengewaesser_2009",
                        children: [
                          {
                            id: 585,
                            name: "eau_new_Gesamtzustand_2009",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:gesamtzustand_2009",
                              max_dpi: 128,
                              metadata_id: "44862c13-7006-44a4-99e6-2877ea512714"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Gesamtzustand_2009",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Gesamtzustand_2009__Gesamtzustand 2009"
                              }
                            ]
                          },
                          {
                            id: 586,
                            name: "eau_new_Chemischer_Zustand_2009",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:chemischer_zustand_2009",
                              max_dpi: 128,
                              metadata_id: "d934fbcc-02c6-47fa-a23d-cfbe49214709"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Chemischer_Zustand_2009",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Chemischer_Zustand_2009__Chemischer Zustand 2009"
                              }
                            ]
                          },
                          {
                            id: 614,
                            name: "eau_new_Oekologischer_Zustand_2009",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:oekologischer_zustand_2009",
                              max_dpi: 128,
                              metadata_id: "92d28c19-ed51-4e9e-8a80-831144fe3553"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Oekologischer_Zustand_2009",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Oekologischer_Zustand_2009__\xD6kologischer Zustand 2009"
                              }
                            ]
                          },
                          {
                            id: 593,
                            name: "eau_new_Hydromorphologischer_Zustand_2009",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:hydromorphologischer_zustand_2009",
                              max_dpi: 128,
                              metadata_id: "0227e64f-11ef-4f0a-8853-48fd7385f2b1"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Hydromorphologischer_Zustand_2009",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Hydromorphologischer_Zustand_2009__Hydromorphologischer Zustand 2009"
                              }
                            ]
                          }
                        ],
                        metadata: {},
                        mixed: true
                      },
                      {
                        id: 435,
                        name: "eau_new_Grundwasser_2009",
                        children: [
                          {
                            id: 657,
                            name: "eau_new_Zustand_der_WK_2009",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:zustand_der_wk_2009",
                              max_dpi: 128,
                              metadata_id: "2df25c38-15d5-447f-a269-4184ce781050"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Zustand_der_WK_2009",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Zustand_der_WK_2009__Zustand der WK 2009"
                              }
                            ]
                          },
                          {
                            id: 605,
                            name: "eau_new_Quantitativer_Zustand_der_WK_2009",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:quantitativer_zustand_der_wk_2009",
                              max_dpi: 128,
                              metadata_id: "a9ebce38-6c8b-447e-9d22-46ba333fa63c"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Quantitativer_Zustand_der_WK_2009",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Quantitativer_Zustand_der_WK_2009__Quantitativer Zustand der WK 2009"
                              }
                            ]
                          },
                          {
                            id: 441,
                            name: "eau_new_Chemischer_Zustand_der_WK_2009",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:chemischer_zustand_der_wk_2009",
                              max_dpi: 128,
                              metadata_id: "e9a72fec-29a0-4183-9e3a-6d4f49c9fea7"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Chemischer_Zustand_der_WK_2009",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Chemischer_Zustand_der_WK_2009__Chemischer Zustand der WK 2009"
                              }
                            ]
                          }
                        ],
                        metadata: {},
                        mixed: true
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 480,
                name: "eau_new_Bewirtschaftungsplan_2015",
                children: [
                  {
                    id: 536,
                    name: "eau_new_Oberflaechenwasserkoerper_2015",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:oberflaechenwasserkoerper_2015",
                      max_dpi: 128,
                      metadata_id: "ead261ed-7be1-4435-9cf5-d1527a18bd19"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Oberflaechenwasserkoerper_2015",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Oberflaechenwasserkoerper_2015__Oberfl\xE4chenwasserk\xF6rper 2015"
                      }
                    ]
                  },
                  {
                    id: 658,
                    name: "eau_new_Erheblich ver\xE4nderte Wasserk\xF6rper 2015",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:erheblich_veraenderte_wk_2015",
                      max_dpi: 128,
                      metadata_id: "78da31c2-55eb-40c9-99fe-22ff409468c2"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Erheblich ver\xE4nderte Wasserk\xF6rper 2015",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Erheblich ver\xE4nderte Wasserk\xF6rper 2015__Erheblich ver\xE4nderte WK 2015"
                      }
                    ]
                  },
                  {
                    id: 619,
                    name: "eau_new_Betrachtungsraeume_2015",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:betrachtungsraeume_2015",
                      max_dpi: 128,
                      metadata_id: "be15dd7d-df57-44e1-b724-0929cf05eef9"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Betrachtungsraeume_2015",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Betrachtungsraeume_2015__Betrachtungsr\xE4ume 2015"
                      }
                    ]
                  },
                  {
                    id: 588,
                    name: "eau_new_Typologie_Gewaesser_2015",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:typologie_gewaesser_2015",
                      max_dpi: 128,
                      metadata_id: "c7eea236-ad59-47fc-8c02-630fee3292dc"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Typologie_Gewaesser_2015",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Typologie_Gewaesser_2015__Typologie Gew\xE4sser 2015"
                      }
                    ]
                  },
                  {
                    id: 1470,
                    name: "eau_fliessgewaessertypen_2015",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:fliessgewaessertypen_2015_lawa",
                      metadata_id: "79f4588f-a264-4921-a382-d1f83cf48da3"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_fliessgewaessertypen_2015",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_fliessgewaessertypen_2015__Flie\xDFgew\xE4ssertypen 2015 [LAWA]"
                      }
                    ]
                  },
                  {
                    id: 759,
                    name: "eau_new_Strukturg\xFCtekartierung 2015 [7-stufige Bewertung]",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:strukturguetekartierung_2015_7-stufige_bewertung",
                      metadata_id: "dd28de7b-6182-4054-89a6-dd92b80b565f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Strukturg\xFCtekartierung 2015 [7-stufige Bewertung]",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Strukturg\xFCtekartierung 2015 [7-stufige Bewertung]__Strukturg\xFCtekartierung 2015 [7-stufige Bewertung]"
                      }
                    ]
                  },
                  {
                    id: 760,
                    name: "eau_new_Strukturg\xFCtekartierung 2015 [5-stufige Bewertung]",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:strukturguetekartierung_2015_5-stufige_bewertung",
                      metadata_id: "ff70c904-a6b9-4989-88c0-8359ff52e57e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Strukturg\xFCtekartierung 2015 [5-stufige Bewertung]",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Strukturg\xFCtekartierung 2015 [5-stufige Bewertung]__Strukturg\xFCtekartierung 2015 [5-stufige Bewertung]"
                      }
                    ]
                  },
                  {
                    id: 761,
                    name: "eau_new_Struktukartierung 2015 in 5 Band [7-stufige Bewertung]",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:5-band_sohle_7-stufige_bewertung_5-band_ufer_links_7-stufige_bewertung_5-band_ufer_rechts_7-stufige_bewertung_5-band_umfeld_links_7-stufige_bewertung_5-band_umfeld_rechts_7-stufige_bewertung",
                      metadata_id: "429d3552-5f72-4be6-9c03-95c76f0a6c07"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Struktukartierung 2015 in 5 Band [7-stufige Bewertung]",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Struktukartierung 2015 in 5 Band [7-stufige Bewertung]__5-Band Sohle [7-stufige Bewertung]"
                      },
                      {
                        name: "eau_new_Struktukartierung 2015 in 5 Band [7-stufige Bewertung]__5-Band Ufer Links [7-stufige Bewertung]"
                      },
                      {
                        name: "eau_new_Struktukartierung 2015 in 5 Band [7-stufige Bewertung]__5-Band Ufer rechts [7-stufige Bewertung]"
                      },
                      {
                        name: "eau_new_Struktukartierung 2015 in 5 Band [7-stufige Bewertung]__5-Band Umfeld links [7-stufige Bewertung]"
                      },
                      {
                        name: "eau_new_Struktukartierung 2015 in 5 Band [7-stufige Bewertung]__5-Band Umfeld rechts [7-stufige Bewertung]"
                      }
                    ]
                  },
                  {
                    id: 763,
                    name: "eau_new_Struktukartierung 2015 in 5 Band [5-stufige Bewertung]",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:5-band_sohle_5-stufige_bewertung_5-band_ufer_links_5-stufige_bewertung_5-band_ufer_rechts_5-stufige_bewertung_5-band_umfeld_links_5-stufige_bewertung_5-band_umfeld_rechts_5-stufige_bewertung",
                      metadata_id: "4c64f3a4-627f-4aa7-9e0c-d3ad003d9afe"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Struktukartierung 2015 in 5 Band [5-stufige Bewertung]",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Struktukartierung 2015 in 5 Band [5-stufige Bewertung]__5-Band Sohle [5-stufige Bewertung]"
                      },
                      {
                        name: "eau_new_Struktukartierung 2015 in 5 Band [5-stufige Bewertung]__5-Band Ufer Links [5-stufige Bewertung]"
                      },
                      {
                        name: "eau_new_Struktukartierung 2015 in 5 Band [5-stufige Bewertung]__5-Band Ufer rechts [5-stufige Bewertung]"
                      },
                      {
                        name: "eau_new_Struktukartierung 2015 in 5 Band [5-stufige Bewertung]__5-Band Umfeld links [5-stufige Bewertung]"
                      },
                      {
                        name: "eau_new_Struktukartierung 2015 in 5 Band [5-stufige Bewertung]__5-Band Umfeld rechts [5-stufige Bewertung]"
                      }
                    ]
                  },
                  {
                    id: 785,
                    name: "eau_new_WRRL und HWRM-RL Massnahmen",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:wrrl_und_hwrm-rl_-_massnahmen",
                      metadata_id: "9a339e4e-eb04-42a0-ac0d-5a5f354c9548"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_WRRL und HWRM-RL Massnahmen",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_WRRL und HWRM-RL Massnahmen__WRRL und HWRM-RL - Massnahmen"
                      }
                    ]
                  },
                  {
                    id: 1471,
                    name: "eau_detailliertes_massnahmenprogramm_sww",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:detailliertes_massnahmenprogramm_sww",
                      metadata_id: "5b9d1544-da64-4a58-b519-9a03e5491e07"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_detailliertes_massnahmenprogramm_sww",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_detailliertes_massnahmenprogramm_sww__Detailliertes Ma\xDFnahmenprogramm SWW"
                      }
                    ]
                  },
                  {
                    id: 659,
                    name: "eau_new_Grundwasserkoerper_2015",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:grundwasserkoerper_2015",
                      max_dpi: 128,
                      metadata_id: "bb5f17b7-ddac-46cc-a59d-25f82d422b5b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Grundwasserkoerper_2015",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Grundwasserkoerper_2015__Grundwasserk\xF6rper 2015"
                      }
                    ]
                  },
                  {
                    id: 476,
                    name: "eau_new_Zustand_der_Wasserkoerper_(WK)_2015",
                    children: [
                      {
                        id: 479,
                        name: "eau_new_Oberflaechengewaesser_2015",
                        children: [
                          {
                            id: 622,
                            name: "eau_new_Oekologischer_Zustand_2015",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:oekologischer_zustand_2015",
                              max_dpi: 128,
                              metadata_id: "5b78d0a5-1984-4efc-9e7d-0cb9d7ca829d"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Oekologischer_Zustand_2015",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Oekologischer_Zustand_2015__\xD6kologischer Zustand 2015"
                              }
                            ]
                          },
                          {
                            id: 663,
                            name: "eau_new_Gesamtzustand_2015",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:gesamtzustand_2015",
                              max_dpi: 128,
                              metadata_id: "bea7140f-b938-4494-ac14-a2252a1d0fcb"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Gesamtzustand_2015",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Gesamtzustand_2015__Gesamtzustand 2015"
                              }
                            ]
                          },
                          {
                            id: 621,
                            name: "eau_new_Chemischer Zustand 2015_Richtlinie 2008_105_EG",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:chemischer_zustand_2015",
                              max_dpi: 128,
                              metadata_id: "7df87ec3-bfad-4d1b-a10b-68670c8073f4"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "621",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Chemischer Zustand 2015_Richtlinie 2008_105_EG__172"
                              }
                            ]
                          },
                          {
                            id: 764,
                            name: "eau_new_Chemischer_Zustand_ohne_ubiquitaere_Stoffe 2015_Richtlinie_2008_105_EG",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:chemischer_zustand_ohne_ubiquitaere_stoffe_2015_richtlinie_2008_105_eg",
                              metadata_id: "68f761b4-e1d1-4cda-b4aa-1e61fc812588"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "764",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Chemischer_Zustand_ohne_ubiquitaere_Stoffe 2015_Richtlinie_2008_105_EG__318"
                              }
                            ]
                          },
                          {
                            id: 765,
                            name: "eau_new_Chemischer_Zustand_2015_Richtlinie 2013_39_EU",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:chemischer_zustand_2015_richtlinie_2013_39_eu",
                              metadata_id: "7df87ec3-bfad-4d1b-a10b-68670c8073f4"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "765",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Chemischer_Zustand_2015_Richtlinie 2013_39_EU__319"
                              }
                            ]
                          },
                          {
                            id: 766,
                            name: "eau_new_Chemischer_Zustand_ohne_ubiquitaere_Stoffe_2015_Richtlinie 2013_39_EU",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:chemischer_zustand_ohne_ubiquitaere_stoffe_2015_richtlinie_2013_39_eu",
                              metadata_id: "d78ac813-7ab3-4162-945a-f87512e66654"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "766",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Chemischer_Zustand_ohne_ubiquitaere_Stoffe_2015_Richtlinie 2013_39_EU__320"
                              }
                            ]
                          },
                          {
                            id: 466,
                            name: "eau_new_Qualitaetskomponenten_des_oekologischen_Zustands_2015",
                            children: [
                              {
                                id: 767,
                                name: "eau_new_Hydromorphologische Gesamtbewertung 2015",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:hydromorphologischer_zustand_2015",
                                  metadata_id: "767e0a8a-31e0-4a53-913f-6ab1c76ca27c"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Hydromorphologische Gesamtbewertung 2015",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Hydromorphologische Gesamtbewertung 2015__Hydromorphologischer Zustand 2015"
                                  }
                                ]
                              },
                              {
                                id: 769,
                                name: "eau_new_Morphologie 2015",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:morphologie_2015",
                                  metadata_id: "b7812f62-a8b5-4ef4-bbb8-c2e3a9688c93"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Morphologie 2015",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Morphologie 2015__Morphologie 2015"
                                  }
                                ]
                              },
                              {
                                id: 770,
                                name: "eau_new_Durchg\xE4ngigkeit 2015",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:durchgaengigkeit_2015",
                                  metadata_id: "4983c058-3d33-4b6f-b801-de1113a11f27"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Durchg\xE4ngigkeit 2015",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Durchg\xE4ngigkeit 2015__Durchg\xE4ngigkeit 2015"
                                  }
                                ]
                              },
                              {
                                id: 583,
                                name: "eau_new_Physiko-Chemie_2015",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:physiko-chemie_2015",
                                  max_dpi: 128,
                                  metadata_id: "45702d13-2608-4300-ba54-0e078c96386c"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Physiko-Chemie_2015",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Physiko-Chemie_2015__Physiko-Chemie 2015"
                                  }
                                ]
                              },
                              {
                                id: 771,
                                name: "eau_new_Phytoplankton 2015",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:phytoplankton_2015",
                                  metadata_id: "e5d8434c-c367-4a56-a7d1-aa60f70a301f"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Phytoplankton 2015",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Phytoplankton 2015__Phytoplankton 2015"
                                  }
                                ]
                              },
                              {
                                id: 662,
                                name: "eau_new_Makrophyten_2015",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:aquatische_flora_2015",
                                  max_dpi: 128,
                                  metadata_id: "fe673001-2447-4e3c-bce6-4606b6bf222d"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Makrophyten_2015",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Makrophyten_2015__aquatische Flora 2015"
                                  }
                                ]
                              },
                              {
                                id: 600,
                                name: "eau_new_Makro-Invertebraten_2015",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:makro-invertebraten_2015",
                                  max_dpi: 128,
                                  metadata_id: "b8a59482-2696-4b9a-a527-3201597a4caf"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Makro-Invertebraten_2015",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Makro-Invertebraten_2015__Makro-Invertebraten 2015"
                                  }
                                ]
                              },
                              {
                                id: 646,
                                name: "eau_new_Fische_2015",
                                metadata: {
                                  is_queryable: true,
                                  legend_name: "eau:fische_2015",
                                  max_dpi: 128,
                                  metadata_id: "f44a6aa7-6dcc-4d99-9033-c13ef23ebef4"
                                },
                                dimensions: {},
                                type: "WMS",
                                layers: "eau_new_Fische_2015",
                                imageType: "image/png",
                                style: "default",
                                childLayers: [
                                  {
                                    name: "eau_new_Fische_2015__Fische 2015"
                                  }
                                ]
                              }
                            ],
                            metadata: {},
                            mixed: true
                          }
                        ],
                        metadata: {},
                        mixed: true
                      },
                      {
                        id: 471,
                        name: "eau_new_Grundwasser_2015",
                        children: [
                          {
                            id: 591,
                            name: "eau_new_Zustand_der_WK_2015",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:zustand_der_wk_2015",
                              max_dpi: 128,
                              metadata_id: "489c9b85-6c3c-4019-b3ee-096936b2683c"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Zustand_der_WK_2015",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Zustand_der_WK_2015__Zustand der WK 2015"
                              }
                            ]
                          },
                          {
                            id: 592,
                            name: "eau_new_Quantitativer_Zustand_der_WK_2015",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:quantitativer_zustand_der_wk_2015",
                              max_dpi: 128,
                              metadata_id: "333c7e4f-cdc3-439a-aa13-ca0f9138c764"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Quantitativer_Zustand_der_WK_2015",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Quantitativer_Zustand_der_WK_2015__Quantitativer Zustand der WK 2015"
                              }
                            ]
                          },
                          {
                            id: 632,
                            name: "eau_new_Chemischer_Zustand_der_WK_2015",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:chemischer_zustand_der_wk_2015",
                              max_dpi: 128,
                              metadata_id: "ddd64c4a-f5af-4bbb-a7d3-3db1016ee541"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Chemischer_Zustand_der_WK_2015",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Chemischer_Zustand_der_WK_2015__Chemischer Zustand der WK 2015"
                              }
                            ]
                          }
                        ],
                        metadata: {},
                        mixed: true
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 458,
                    name: "eau_new_Risikobeurteilung",
                    children: [
                      {
                        id: 467,
                        name: "eau_new_Grundwasser_2021",
                        children: [
                          {
                            id: 773,
                            name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2021",
                            metadata: {
                              legend_name: "eau:risikobeurteilung_des_wk_hinsichtlich_der_verfehlung_des_guten_zustandes_2021",
                              metadata_id: "be59d518-15cb-4417-a6ba-e8f5b61ea76a"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2021__Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2021"
                              }
                            ]
                          },
                          {
                            id: 661,
                            name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4\xDFigen Zustandes 2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:risikobeurteilung_des_wk_hinsichtlich_der_verfehlung_des_guten_mengenmaessigen_zustandes",
                              max_dpi: 128,
                              metadata_id: "f9420947-188b-498a-97aa-98d30601995a"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4\xDFigen Zustandes 2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4\xDFigen Zustandes 2021__Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4ssigen Zustandes"
                              }
                            ]
                          },
                          {
                            id: 660,
                            name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes 2021",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:risikobeurteilung_des_wk_hinsichtlich_der_verfehlung_des_guten_chemischen_zustandes",
                              max_dpi: 128,
                              metadata_id: "1070a8cd-4ee7-4865-8e0c-e2c31d09ab68"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes 2021",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes 2021__Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes"
                              }
                            ]
                          }
                        ],
                        metadata: {},
                        mixed: true
                      },
                      {
                        id: 772,
                        name: "eau_new_Grundwasser 2027",
                        children: [
                          {
                            id: 774,
                            name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2027",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:risikobeurteilung_des_wk_hinsichtlich_der_verfehlung_des_guten_zustandes_2027",
                              metadata_id: "019a4e7d-4ddf-492a-a11d-1e5e36793842"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2027",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2027__Risikobeurteilung des WK hinsichtlich der Verfehlung des guten Zustandes 2027"
                              }
                            ]
                          },
                          {
                            id: 776,
                            name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4\xDFigen Zustandes 2027",
                            metadata: {
                              is_queryable: true,
                              legend_name: "eau:risikobeurteilung_des_wk_hinsichtlich_der_verfehlung_des_guten_mengenmaessigen_zustandes_2027",
                              metadata_id: "199d0bbb-5ed1-4c94-b92b-e30edc57bbb0"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4\xDFigen Zustandes 2027",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4\xDFigen Zustandes 2027__Risikobeurteilung des WK hinsichtlich der Verfehlung des guten mengenm\xE4ssigen Zustandes 2027"
                              }
                            ]
                          },
                          {
                            id: 777,
                            name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes 2027",
                            metadata: {
                              legend_name: "eau:risikobeurteilung_des_wk_hinsichtlich_der_verfehlung_des_guten_chemischen_zustandes_2027",
                              metadata_id: "2cba7832-6e24-4ebe-b65c-6119c6c3b287"
                            },
                            dimensions: {},
                            type: "WMS",
                            layers: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes 2027",
                            imageType: "image/png",
                            style: "default",
                            childLayers: [
                              {
                                name: "eau_new_Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes 2027__Risikobeurteilung des WK hinsichtlich der Verfehlung des guten chemischen Zustandes 2027"
                              }
                            ]
                          }
                        ],
                        metadata: {},
                        mixed: true
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2085,
                name: "eau_Bewirtschaftungsplan_2021",
                children: [
                  {
                    id: 2090,
                    name: "eau_Oberflaechenwasserkoerper_2021",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:oberflaechenwasserkoerper_2021",
                      max_dpi: 128,
                      metadata_id: "c50b2bc7-aeb7-4d3e-9349-09eb3ec0f927"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_Oberflaechenwasserkoerper_2021",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_Oberflaechenwasserkoerper_2021__386"
                      }
                    ]
                  },
                  {
                    id: 2091,
                    name: "eau_Erheblich ver\xE4nderte Wasserk\xF6rper 2021",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:erheblich_veraenderte_wk_2021",
                      max_dpi: 128,
                      metadata_id: "311cc30b-8092-4816-9f86-87d5f2995706"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_Erheblich ver\xE4nderte Wasserk\xF6rper 2021",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_Erheblich ver\xE4nderte Wasserk\xF6rper 2021__387"
                      }
                    ]
                  },
                  {
                    id: 2086,
                    name: "eau_Entwurf_Massnahmenprogramm_HY_2021",
                    children: [
                      {
                        id: 2092,
                        name: "eau_Weiderherstellung_Durchgaengigkeit_Querbauwerk_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:wiederherstellung_der_oekologischen_durchgaengigkeit",
                          metadata_id: "c150f6a5-41c7-477a-9d44-c0a26a502d85"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_Weiderherstellung_Durchgaengigkeit_Querbauwerk",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_Weiderherstellung_Durchgaengigkeit_Querbauwerk_2021__389"
                          }
                        ]
                      },
                      {
                        id: 2093,
                        name: "eau_Weiderherstellung_Durchgaengigkeit_Verrohrung_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:wiederherstellung_der_oekologischen_durchgaengigkeit_durchlass",
                          metadata_id: "569bf0ea-c428-4171-aba6-8f2ace180a10"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_Weiderherstellung_Durchgaengigkeit_Verrohrung_2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_Weiderherstellung_Durchgaengigkeit_Verrohrung_2021__390"
                          }
                        ]
                      },
                      {
                        id: 2094,
                        name: "eau_Strukturelemente_Sohle_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:einbau_von_strukturelementen_in_sohle",
                          metadata_id: "2d233ca6-553e-43bf-ba25-f46b88f63710"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_Strukturelemente_Sohle_2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_Strukturelemente_Sohle_2021__391"
                          }
                        ]
                      },
                      {
                        id: 2095,
                        name: "eau_Umgestalten_Sohlverbau_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:entfernen_umgestalten_von_sohlverbau",
                          metadata_id: "0d30a3ee-e860-4816-b5c8-9f43e93020e3"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_Umgestalten_Sohlverbau_2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_Umgestalten_Sohlverbau_2021__392"
                          }
                        ]
                      },
                      {
                        id: 2096,
                        name: "eau_Stroemungslenkern_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:einbau_von_stroemungslenkern_fuer_eigendynamik",
                          metadata_id: "b86c62a9-0ec8-4d35-878f-b275e74ff02e"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_Stroemungslenkern_2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_Stroemungslenkern_2021__393"
                          }
                        ]
                      },
                      {
                        id: 2097,
                        name: "eau_Umgestalten_Uferverbau_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:entfernen_umgestalten_von_uferverbau",
                          metadata_id: "bec0ccbc-09b5-4351-8b72-f0e458fc7d19"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_Umgestalten_Uferverbau_2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_Umgestalten_Uferverbau_2021__394"
                          }
                        ]
                      },
                      {
                        id: 2098,
                        name: "eau_naturnah_Gewaesserbett_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:wiederherstellung_von_naturnaher_laufentwicklung_und_gewaesserbett",
                          metadata_id: "3ddf627c-90ae-4b58-a05e-20925493dcf9"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_naturnah_Gewaesserbett_2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_naturnah_Gewaesserbett_2021__395"
                          }
                        ]
                      },
                      {
                        id: 2099,
                        name: "eau_Gewaesserrandstreifen_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:anlage_eines_gewaesserrandstreifens",
                          metadata_id: "3bc0e52d-954b-47d3-8905-1ecfe7108ce0"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_Gewaesserrandstreifen_2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_Gewaesserrandstreifen_2021__396"
                          }
                        ]
                      },
                      {
                        id: 2100,
                        name: "eau_Gewaesserentwicklungskorridor_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:anlage_eines_gewaesser_entwicklungskorridors",
                          metadata_id: "13299bf5-57ca-4538-993e-7c00f6247722"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_Gewaesserentwicklungskorridor_2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_Gewaesserentwicklungskorridor_2021__397"
                          }
                        ]
                      },
                      {
                        id: 2101,
                        name: "eau_natuerlich_Ueberflutungsraeume_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:sicherung_und_erweiterung_natuerlicher_ueberflutungsraeume_und_augewaesser",
                          metadata_id: "7fb0080e-d178-401d-83de-7595ef1885b5"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_natuerlich_Ueberflutungsraeume_2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_natuerlich_Ueberflutungsraeume_2021__398"
                          }
                        ]
                      },
                      {
                        id: 2102,
                        name: "eau_eigendynamische_Entwicklung_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:zulassen_von_eigendynamischer_entwicklung",
                          metadata_id: "d13e22e9-d22a-48a0-838d-3d7c914ccfe3"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_eigendynamische_Entwicklung_2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_eigendynamische_Entwicklung_2021__399"
                          }
                        ]
                      },
                      {
                        id: 2103,
                        name: "eau_naturnahe_Abflussverhaeltnisse_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:widerherstellung_und_sicherung_naturnaher_abflussverhaeltnisse",
                          metadata_id: "b3f8a9e0-17f7-4b64-a34b-6ee6de972b52"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_naturnahe_Abflussverhaeltnisse_2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_naturnahe_Abflussverhaeltnisse_2021__400"
                          }
                        ]
                      },
                      {
                        id: 2104,
                        name: "eau_naturnaher_Wasserhaushalt_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:wiederherstellung_und_sicherung_naturnahem_wasserhaushalt",
                          metadata_id: "91008390-557e-4db3-8d7c-e608a5478edb"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_naturnaher_Wasserhaushalt_2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_naturnaher_Wasserhaushalt_2021__401"
                          }
                        ]
                      },
                      {
                        id: 2105,
                        name: "eau_Abflussregulierung_2021",
                        metadata: {
                          is_queryable: true,
                          legend_name: "eau:abflussregulierung",
                          metadata_id: "393be87d-44ce-42e1-9b81-9585aa2d7678"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "eau_Abflussregulierung_2021",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "eau_Abflussregulierung_2021__402"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 2106,
                    name: "eau_Masssnahmenprogramm_SWW_2021",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:detailliertes_massnahmenprogramm_sww_2021",
                      metadata_id: "10f4a12e-1a67-42d5-b575-8993e2f3aa68"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_Masssnahmenprogramm_SWW_2021",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_Masssnahmenprogramm_SWW_2021__403"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 482,
            name: "eau_new_Nitratrichtlinie",
            children: [
              {
                id: 589,
                name: "eau_new_Messstationen_Oberflaechengewaesser_-_Nitratrichtlinie",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:messstationen_oberflaechengewaesser_-_nitratrichtlinie",
                  max_dpi: 128,
                  metadata_id: "e3d8df5f-eb08-4e11-831f-ae2a90294ccf"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Messstationen_Oberflaechengewaesser_-_Nitratrichtlinie",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Messstationen_Oberflaechengewaesser_-_Nitratrichtlinie__Messstationen Oberfl\xE4chengew\xE4sser - Nitratrichtlinie"
                  }
                ]
              },
              {
                id: 582,
                name: "eau_new_Messstationen_Grundwasser_-_Nitratrichtlinie",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:messstationen_grundwasser_-_nitratrichtlinie",
                  max_dpi: 128,
                  metadata_id: "e15fcc8c-217c-4577-b5a0-e62f08e480c1"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Messstationen_Grundwasser_-_Nitratrichtlinie",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Messstationen_Grundwasser_-_Nitratrichtlinie__Messstationen Grundwasser - Nitratrichtlinie"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 478,
            name: "eau_new_Plan_im_Fall_einer_Trockenheit",
            children: [
              {
                id: 797,
                name: "eau_new_trockenheit_gelb",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:vorbeugungsphase_phase_gelb",
                  metadata_id: "2ec1e46e-2411-4828-b702-cc3f41b3ad04"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_trockenheit_gelb",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_trockenheit_gelb__Vorbeugungsphase [Phase gelb]"
                  }
                ]
              },
              {
                id: 617,
                name: "eau_new_Trinkwasserknappheit_(Zustand_orange)",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:trinkwasserknappheit_zustand_orange",
                  max_dpi: 128,
                  metadata_id: "c5a93247-af34-494d-bce2-9bc112fa50d8"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Trinkwasserknappheit_(Zustand_orange)",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Trinkwasserknappheit_(Zustand_orange)__Trinkwasserknappheit [Zustand orange]"
                  }
                ]
              },
              {
                id: 481,
                name: "eau_new_Erhoehte_Trinkwasserknappheit_(Zustand_rot)",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:erhoehte_trinkwasserknappheit_zustand_rot",
                  max_dpi: 128,
                  metadata_id: "620eea7b-266a-4ba5-9646-8006ff5915d4"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Erhoehte_Trinkwasserknappheit_(Zustand_rot)",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Erhoehte_Trinkwasserknappheit_(Zustand_rot)__Erh\xF6hte Trinkwasserknappheit [Zustand rot]"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          bg_layer: "pixelmaps-gray",
          css: "eau.css",
          display_in_switcher: true,
          link_title: "Administration de la gestion d'eau",
          page_title: "eau.geoportail.lu",
          print_img: "bandeauEau.png",
          print_long_txt_de: "Das \xF6ffentliche Geoportal des Grossherzogtums Luxemburg",
          print_long_txt_en: "The official geoportal for the Grand-Duchy of Luxembourg",
          print_long_txt_fr: "Le g\xE9oportail officiel du Grand-Duch\xE9 de Luxembourg",
          print_long_txt_lu: "Den offizielle Geoportal vu L\xEBtzebuerg",
          print_scales: [
            "1000",
            "1500",
            "2500",
            "5000",
            "10000",
            "15000",
            "20000",
            "25000",
            "50000",
            "80000",
            "100000",
            "125000",
            "200000",
            "250000",
            "400000"
          ],
          print_short_txt_de: "eau.geoportal.lu",
          print_short_txt_en: "eau.geoportal.lu",
          print_short_txt_fr: "eau.geoportail.lu",
          print_short_txt_lu: "eau.geoportal.lu"
        }
      },
      {
        id: 130,
        name: "pag",
        icon: "pag",
        children: [
          {
            id: 706,
            name: "basisden_pag",
            children: [
              {
                id: 309,
                name: "administrative_einheiten",
                children: [
                  {
                    id: 269,
                    name: "communes_labels",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "17c7d883-ff7f-4b48-a894-46bea40d2e49"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "communes_labels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "communes_labels__COMMUNES_LABELS"
                      }
                    ]
                  },
                  {
                    id: 302,
                    name: "communes",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "de5373d6-340f-4203-a065-da7550a03cc4_2049"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "communes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "communes__COMMUNES"
                      }
                    ]
                  },
                  {
                    id: 346,
                    name: "cantons_labels",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "3af20a80-be4a-4819-a42b-18e49af799aa"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "cantons_labels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cantons_labels__CANTONS_LABELS"
                      }
                    ]
                  },
                  {
                    id: 329,
                    name: "cantons",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "e8a034e8-f986-4745-a848-b7ef30ce2740"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "CANTONS",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cantons__CANTONS"
                      }
                    ]
                  },
                  {
                    id: 268,
                    name: "districts_labels",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "c42842e2-834a-427a-99f6-eb8cb79d1db4"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "districts_labels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "districts_labels__DISTRICTS_LABELS"
                      }
                    ]
                  },
                  {
                    id: 354,
                    name: "districts",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "b9edd03f-3aef-4fd6-a3d9-db076b1cf237"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "districts",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "districts__DISTRICTS"
                      }
                    ]
                  },
                  {
                    id: 349,
                    name: "country",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "4c9b3c0b-85d4-447d-a68c-7416869f8d9b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "country",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "country__PAYS"
                      }
                    ]
                  },
                  {
                    id: 732,
                    name: "limadmin_judiciaire",
                    metadata: {
                      metadata_id: "235c0ac9-5bf6-45b6-9ceb-8680a07944ec"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "limadmin_judiciaire",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "limadmin_judiciaire__ARRONDISSEMENTS JUDICIAIRES"
                      }
                    ]
                  },
                  {
                    id: 733,
                    name: "limadmin_legislatif",
                    metadata: {
                      metadata_id: "627b78d9-ae18-4be2-9a69-02aa6d4e38bb"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "limadmin_legislatif",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "limadmin_legislatif__CIRCONSCRIPTIONS LEGISLATIVES"
                      }
                    ]
                  },
                  {
                    id: 744,
                    name: "tour_ort",
                    metadata: {
                      legend_name: "ort",
                      metadata_id: "44dbfde5-664e-4e45-8802-3d60b52eb9cb"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_ort",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_ort__0"
                      },
                      {
                        name: "tour_ort__1"
                      }
                    ]
                  },
                  {
                    id: 746,
                    name: "tour_leader",
                    metadata: {
                      legend_name: "leader",
                      metadata_id: "a48aec89-7341-459e-a7d3-0e572982b255"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_leader",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_leader__0"
                      },
                      {
                        name: "tour_leader__1"
                      },
                      {
                        name: "tour_leader__2"
                      }
                    ]
                  },
                  {
                    id: 747,
                    name: "tour_parcsnaturels",
                    metadata: {
                      is_queryable: true,
                      legend_name: "parcnaturel",
                      metadata_id: "f519c4e7-4459-49b5-b8c1-569328252d44"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_parcnaturels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_parcsnaturels__0"
                      },
                      {
                        name: "tour_parcsnaturels__1"
                      }
                    ]
                  },
                  {
                    id: 678,
                    name: "anf_stations_biologiques",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "05e497fc-625d-4701-90af-dbe8813201ab"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_stations_biologiques",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_stations_biologiques__STATIONS_BIOLOGIQUES"
                      }
                    ]
                  },
                  {
                    id: 1364,
                    name: "act_frontieres_isodistances",
                    metadata: {
                      metadata_id: "09318d11-a908-4dea-a8f9-0558d20b980f",
                      start_opacity: 0.5
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "act_frontieres_isodistances",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "act_frontieres_isodistances__0"
                      },
                      {
                        name: "act_frontieres_isodistances__1"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 165,
                name: "adressen",
                children: [
                  {
                    id: 152,
                    name: "addresses",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "28b310e4-b9e1-467c-a28d-fce2e9a96548"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "addresses",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 694,
            name: "pag_group",
            children: [
              {
                id: 698,
                name: "pag_pag",
                metadata: {
                  is_queryable: true,
                  legend_name: "pag",
                  max_dpi: 128,
                  metadata_id: "12c67295-d150-430f-aa28-fa004ecba3c7",
                  start_opacity: 0.7
                },
                dimensions: {},
                type: "WMS",
                layers: "pag_pag",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "pag_pag__1"
                  },
                  {
                    name: "pag_pag__2"
                  },
                  {
                    name: "pag_pag__3"
                  },
                  {
                    name: "pag_pag__4"
                  },
                  {
                    name: "pag_pag__5"
                  },
                  {
                    name: "pag_pag__6"
                  },
                  {
                    name: "pag_pag__7"
                  },
                  {
                    name: "pag_pag__8"
                  },
                  {
                    name: "pag_pag__9"
                  },
                  {
                    name: "pag_pag__10"
                  },
                  {
                    name: "pag_pag__11"
                  },
                  {
                    name: "pag_pag__12"
                  },
                  {
                    name: "pag_pag__13"
                  },
                  {
                    name: "pag_pag__14"
                  },
                  {
                    name: "pag_pag__15"
                  },
                  {
                    name: "pag_pag__16"
                  },
                  {
                    name: "pag_pag__17"
                  },
                  {
                    name: "pag_pag__18"
                  },
                  {
                    name: "pag_pag__20"
                  },
                  {
                    name: "pag_pag__21"
                  },
                  {
                    name: "pag_pag__22"
                  },
                  {
                    name: "pag_pag__23"
                  },
                  {
                    name: "pag_pag__24"
                  },
                  {
                    name: "pag_pag__25"
                  },
                  {
                    name: "pag_pag__31"
                  }
                ]
              },
              {
                id: 696,
                name: "pag_pap_approuves",
                metadata: {
                  is_queryable: false,
                  max_dpi: 128,
                  metadata_id: "7fd67f56-d2f6-4697-9d3b-5d9a6be770c9",
                  start_opacity: 1
                },
                dimensions: {},
                type: "WMS",
                layers: "pag_pap_approuves",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "pag_pap_approuves__27"
                  }
                ]
              },
              {
                id: 1366,
                name: "pag_infos_supp",
                metadata: {
                  metadata_id: "5ab48871-aa35-4b74-ada2-3033c6666748"
                },
                dimensions: {},
                type: "WMS",
                layers: "pag_infos_supp",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "pag_infos_supp__30"
                  },
                  {
                    name: "pag_infos_supp__32"
                  },
                  {
                    name: "pag_infos_supp__33"
                  }
                ]
              },
              {
                id: 697,
                name: "pag_pcn",
                metadata: {
                  is_queryable: true,
                  max_dpi: 128,
                  metadata_id: "672e2e56-b888-45bb-b665-1b8132a0e147",
                  start_opacity: 1
                },
                dimensions: {},
                type: "WMS",
                layers: "pag_pcn",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "pag_pcn__pag_fonds"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 695,
            name: "pag_addtional_layers",
            children: [
              {
                id: 716,
                name: "pag_at",
                children: [
                  {
                    id: 710,
                    name: "pag_pos",
                    metadata: {
                      is_queryable: true,
                      max_dpi: 128,
                      metadata_id: "a5f51e0e-c737-44e6-b0e0-7a0016d87707",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "pag_pos",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "pag_pos__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 717,
                name: "pag_env",
                children: [
                  {
                    id: 533,
                    name: "natura2000_oiseaux",
                    metadata: {
                      is_queryable: true,
                      max_dpi: 128,
                      metadata_id: "080b7d2e-f8d5-4943-8dbf-04d3dfd4fe09"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "natura2000_oiseaux",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "natura2000_oiseaux__1"
                      }
                    ]
                  },
                  {
                    id: 540,
                    name: "natura2000_habitats",
                    metadata: {
                      is_queryable: true,
                      max_dpi: 128,
                      metadata_id: "080b7d2e-f8d5-4943-8dbf-04d3dfd4fe09"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "natura2000_habitats",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "natura2000_habitats__2"
                      },
                      {
                        name: "natura2000_habitats__0"
                      }
                    ]
                  },
                  {
                    id: 804,
                    name: "anf_zpin_declarees",
                    metadata: {
                      is_queryable: true,
                      legend_name: "anf:zpin_declarees",
                      metadata_id: "9439d9b1-eff6-47b5-a4c7-4c5bde2744f4"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_zpin_declarees",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_zpin_declarees__ZPIN_DECLAREES"
                      }
                    ]
                  },
                  {
                    id: 419,
                    name: "anf_arbres_remarquables",
                    metadata: {
                      is_queryable: true,
                      legend_name: "anf:arbres_remarquables",
                      metadata_id: "373df6df-a91c-4e66-b211-ac2bc1675d56"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_arbres_remarquables",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_arbres_remarquables__ARBRES_REMARQUABLES"
                      }
                    ]
                  },
                  {
                    id: 366,
                    name: "emwelt_biotop_kadaster",
                    children: [
                      {
                        id: 1367,
                        name: "anf_biotopes_points",
                        metadata: {
                          is_queryable: true,
                          legend_name: "env:btk_p",
                          metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "anf_biotopes_points",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "anf_biotopes_points__BIOTOPES_MO_EL_PONCTUELS"
                          }
                        ]
                      },
                      {
                        id: 1368,
                        name: "anf_biotopes_vergers",
                        metadata: {
                          is_queryable: true,
                          legend_name: "env:btk_s",
                          metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "anf_biotopes_vergers",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "anf_biotopes_vergers__BIOTOPES_MO_VERGERS"
                          }
                        ]
                      },
                      {
                        id: 1369,
                        name: "anf_biotopes_surfaces",
                        metadata: {
                          is_queryable: true,
                          legend_name: "env:btk_f",
                          metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "anf_biotopes_surfaces",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "anf_biotopes_surfaces__BIOTOPES_MO_SURFACES"
                          }
                        ]
                      },
                      {
                        id: 1370,
                        name: "anf_biotopes_tampons",
                        metadata: {
                          is_queryable: true,
                          legend_name: "env:btk_b",
                          metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "anf_biotopes_tampons",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "anf_biotopes_tampons__BIOTOPES_MO_ZONES_TAMPONS"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 720,
                name: "pag_eau",
                children: [
                  {
                    id: 573,
                    name: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:zps_durch_grosshrzgl._verordnung_festgelegt",
                      max_dpi: 128,
                      metadata_id: "d70f99e0-6032-4a4b-b516-5dfdfce33b26"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt__ZPS durch grosshrzgl. Verordnung festgelegt"
                      }
                    ]
                  },
                  {
                    id: 664,
                    name: "eau_new_ZPS_laufende_oeffentliche_Verfahrungsweise",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:zps_laufende_oeffentliche_verfahrungsweise",
                      max_dpi: 128,
                      metadata_id: "87beb1ac-7496-48f6-b5a9-8666e3897523"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_ZPS_laufende_oeffentliche_Verfahrungsweise",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_ZPS_laufende_oeffentliche_Verfahrungsweise__ZPS laufende \xF6ffentliche Verfahrungsweise"
                      }
                    ]
                  },
                  {
                    id: 490,
                    name: "eau_new_Sanitaere_Schutzzonen_Stausee_EschSauer",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:sanitaere_schutzzonen_stausee",
                      max_dpi: 128,
                      metadata_id: "e34de488-68ea-48a8-9e92-f67bb209508e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Sanitaere_Schutzzonen_Stausee_EschSauer",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Sanitaere_Schutzzonen_Stausee_EschSauer__Sanit\xE4re Schutzzonen Stausee"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 718,
                name: "pag_hum",
                children: [
                  {
                    id: 232,
                    name: "env_bruit_axes_routiers",
                    children: [
                      {
                        id: 1497,
                        name: "env_bruit2016_axes_routiers_lden",
                        metadata: {
                          exclusion: "[336,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          metadata_id: "cf1a21cc-8208-420e-bd7e-091d755b6ace",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_routiers_lden",
                        imageType: "image/png"
                      },
                      {
                        id: 1500,
                        name: "env_bruit2016_axes_routiers_lngt",
                        metadata: {
                          exclusion: "[336,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          metadata_id: "83ae2d3b-f0d9-4584-8c48-f6722bd4f517",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_routiers_lngt",
                        imageType: "image/png"
                      },
                      {
                        id: 1504,
                        name: "env_bruit_axes_routiers_hotspots_2016",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "c5a6e3c5-6bef-4ff9-ac3e-aa494a34e602"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_routiers_hotspots_2016",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_routiers_hotspots_2016__0"
                          },
                          {
                            name: "env_bruit_axes_routiers_hotspots_2016__11"
                          }
                        ]
                      },
                      {
                        id: 1505,
                        name: "env_bruit_axes_routiers_agglomeration_2016",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "a6c63355-6e42-4795-9d72-8744b907b151"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_routiers_agglomeration_2016",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_routiers_agglomeration_2016__0"
                          },
                          {
                            name: "env_bruit_axes_routiers_agglomeration_2016__8"
                          }
                        ]
                      },
                      {
                        id: 326,
                        name: "env_bruit_axes_routiers_lden",
                        metadata: {
                          exclusion: "[333,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          max_dpi: 128,
                          metadata_id: "3e3aa044-89e0-4676-9404-744f64dd7ba0",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit_axes_routiers_lden",
                        imageType: "image/png"
                      },
                      {
                        id: 255,
                        name: "env_bruit_axes_routiers_lngt",
                        metadata: {
                          exclusion: "[333,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          max_dpi: 128,
                          metadata_id: "5e4f2607-b114-4884-8e48-8e1faa997eb4",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit_axes_routiers_lngt",
                        imageType: "image/png"
                      },
                      {
                        id: 1475,
                        name: "env_bruit_axes_routiers_hotspots",
                        metadata: {
                          exclusion: "[332,336]",
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "ff6b3d63-871c-4e88-8fc0-0f276abe259a"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_routiers_hotspots",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_routiers_hotspots__0"
                          },
                          {
                            name: "env_bruit_axes_routiers_hotspots__4"
                          }
                        ]
                      },
                      {
                        id: 1485,
                        name: "env_bruit_axes_routiers_agglomeration",
                        metadata: {
                          exclusion: "[332,336]",
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "f1dd0dd5-4dd5-4d88-b556-af39a20ab137",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_routiers_agglomeration",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_routiers_agglomeration__0"
                          },
                          {
                            name: "env_bruit_axes_routiers_agglomeration__2"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 183,
                    name: "env_bruit_axes_ferroviaires",
                    children: [
                      {
                        id: 1498,
                        name: "env_bruit2016_axes_ferroviaires_lden",
                        metadata: {
                          exclusion: "[336,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          metadata_id: "7975b71b-2fd4-45e6-8c0a-306671d665c6",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_ferroviaires_lden",
                        imageType: "image/png"
                      },
                      {
                        id: 1502,
                        name: "env_bruit2016_axes_ferroviaires_lngt",
                        metadata: {
                          exclusion: "[336,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          metadata_id: "170143ce-53ef-4b2b-997c-a2ccb1b84477",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_ferroviaires_lngt",
                        imageType: "image/png"
                      },
                      {
                        id: 1503,
                        name: "env_bruit_axes_ferroviaires_hotspots_2016",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "29ef44c6-f357-4d21-829c-f2fdd5fe1149"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_ferroviaires_hotspots_2016",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_ferroviaires_hotspots_2016__13"
                          },
                          {
                            name: "env_bruit_axes_ferroviaires_hotspots_2016__0"
                          }
                        ]
                      },
                      {
                        id: 310,
                        name: "env_bruit_axes_ferroviaires_lden",
                        metadata: {
                          exclusion: "[334,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          max_dpi: 128,
                          metadata_id: "32b40d1c-111e-4eed-91c7-61d61ef27b8d",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit_axes_ferroviaires_lden",
                        imageType: "image/png"
                      },
                      {
                        id: 259,
                        name: "env_bruit_axes_ferroviaires_lngt",
                        metadata: {
                          exclusion: "[334,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          max_dpi: 128,
                          metadata_id: "2d7e26ad-e448-45a2-9045-3dfb3e3ec15b",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit_axes_ferroviaires_lngt",
                        imageType: "image/png"
                      },
                      {
                        id: 1476,
                        name: "env_bruit_axes_ferroviaires_hotspots",
                        metadata: {
                          exclusion: "[332,336]",
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "d3b30653-d0bf-4924-96b2-251e9f61c979"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_ferroviaires_hotspots",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_ferroviaires_hotspots__6"
                          },
                          {
                            name: "env_bruit_axes_ferroviaires_hotspots__0"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 190,
                    name: "env_bruit_air",
                    children: [
                      {
                        id: 1501,
                        name: "env_bruit2016_axes_aeroport_lden",
                        metadata: {
                          exclusion: "[332,336]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          metadata_id: "26e208ff-39a3-4cf6-92db-4c6707fe972a",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_aeroport_lden",
                        imageType: "image/png"
                      },
                      {
                        id: 1499,
                        name: "env_bruit2016_axes_aeroport_lngt",
                        metadata: {
                          exclusion: "[332,336]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          metadata_id: "2aa6f79d-74cc-4f22-bedd-748f8e8e30b9",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_aeroport_lngt",
                        imageType: "image/png"
                      },
                      {
                        id: 157,
                        name: "env_bruit_air_lden",
                        metadata: {
                          exclusion: "[335,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          max_dpi: 128,
                          metadata_id: "0f4dcfc5-e947-4e5c-9460-702b8e1a572f",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_air_lden",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_air_lden__1"
                          }
                        ]
                      },
                      {
                        id: 327,
                        name: "env_bruit_air_lngt",
                        metadata: {
                          exclusion: "[335,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          max_dpi: 128,
                          metadata_id: "6b031060-1f82-467d-af86-afe02a3f04fa",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_air_lngt",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_air_lngt__0"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 719,
                name: "pag_sites_et_monuments",
                children: [
                  {
                    id: 709,
                    name: "pag_ssmn",
                    metadata: {
                      is_queryable: false,
                      max_dpi: 128,
                      metadata_id: "ab8bba00-fe68-4e1f-8fad-9dbd2f8c7809",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "pag_ssmn",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "pag_ssmn__0"
                      },
                      {
                        name: "pag_ssmn__1"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 196,
                name: "verkehrsnetze",
                children: [
                  {
                    id: 181,
                    name: "roads",
                    metadata: {
                      legend_name: "road_network:show",
                      metadata_id: "12627f90-f0f8-41b3-a56a-2e11a232ba59"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "roads",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "roads__ROADS_NOLABELS"
                      }
                    ]
                  },
                  {
                    id: 351,
                    name: "roads_labels",
                    metadata: {
                      metadata_id: "5d606cae-cbc6-44c3-a465-edb981e44a39"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "roads_labels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "roads_labels__ROADS_LABELS"
                      }
                    ]
                  },
                  {
                    id: 147,
                    name: "arrets_bus",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:arrets_de_bus",
                      metadata_id: "7318c6e8-bb63-40e0-9e40-46ae7b0dc266"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "arrets_bus",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "arrets_bus__0"
                      },
                      {
                        name: "arrets_bus__1"
                      }
                    ]
                  },
                  {
                    id: 813,
                    name: "cdt_lignes_all",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "bbe0523f-374d-4c94-a27d-7ce81d8bae3b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "cdt_lignes_all",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cdt_lignes_all__lignes_de_bus"
                      }
                    ]
                  },
                  {
                    id: 812,
                    name: "cdt_lignes_bus_par_operateur",
                    children: [
                      {
                        id: 814,
                        name: "cdt_lignes_avl",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "1e6f614b-e347-4115-82d7-74a72f51389f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "category",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [],
                        ogcServer: "source for config://my_maps?category_id=400"
                      },
                      {
                        id: 815,
                        name: "cdt_lignes_rgtr",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "eae3ed54-d2ae-45ae-a62c-0dec4d44acdf"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "category",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [],
                        ogcServer: "source for config://my_maps?category_id=401"
                      },
                      {
                        id: 816,
                        name: "cdt_lignes_tice",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "a3cb973c-12b0-4e41-bfc0-b2fb67637513"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "category",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [],
                        ogcServer: "source for config://my_maps?category_id=402"
                      },
                      {
                        id: 817,
                        name: "cdt_lignes_cfl",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "84ebdfbc-ba25-464c-af86-e74e588978ef"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "category",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [],
                        ogcServer: "source for config://my_maps?category_id=403"
                      },
                      {
                        id: 1374,
                        name: "cdt_lignes_tram",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "0f46c673-d4b4-4c25-8d9a-fca41035f587"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "category",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [],
                        ogcServer: "source for config://my_maps?category_id=404"
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1381,
                    name: "chargy",
                    metadata: {
                      is_queryable: true,
                      legend_name: "chargy",
                      metadata_id: "801d732a-c285-4fcd-a043-c5220d6d7eef"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "chargy",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "chargy__chargy"
                      }
                    ]
                  },
                  {
                    id: 423,
                    name: "mobiliteit_cfl",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:cfl",
                      max_dpi: 128,
                      metadata_id: "0b3c42a2-275e-4519-b228-f407d46b8350"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobiliteit_cfl",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobiliteit_cfl__1"
                      }
                    ]
                  },
                  {
                    id: 377,
                    name: "mobiliteit_pr",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:pr",
                      max_dpi: 128,
                      metadata_id: "9e0c97ae-aff9-41fc-9489-bbf97999163d"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobiliteit_pr",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobiliteit_pr__2"
                      }
                    ]
                  },
                  {
                    id: 368,
                    name: "mobiliteit_bikeshare",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:bikeshare",
                      max_dpi: 128,
                      metadata_id: "e9fbbdff-2f8f-422b-b6ae-5cc69f73bb4b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobiliteit_bikeshare",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobiliteit_bikeshare__0"
                      }
                    ]
                  },
                  {
                    id: 1386,
                    name: "mobiliteit_livebikes",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "fc0168f8-2d8b-4bba-8da8-6edd6edd94cc"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobiliteit_livebikes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobiliteit_livebikes__bikes"
                      }
                    ]
                  },
                  {
                    id: 808,
                    name: "velo_by_pch",
                    metadata: {
                      is_queryable: true,
                      legend_name: "tour_velo_national",
                      metadata_id: "387f6949-0fc4-43a5-b0e6-4e09bdf65225"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "velo_by_pch",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "velo_by_pch__1"
                      },
                      {
                        name: "velo_by_pch__0"
                      }
                    ]
                  },
                  {
                    id: 512,
                    name: "tour_pistes_velo_mymaps2",
                    metadata: {
                      is_queryable: true,
                      legend_name: "tour_velo_national",
                      metadata_id: "8e3c102a-393e-4d48-a321-9f8957ff49cf"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=106"
                  },
                  {
                    id: 352,
                    name: "cfl_hecto",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "938f9e8e-071c-4e6b-940f-64b2a60eca74"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "cfl_hecto",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cfl_hecto__points_hecto"
                      }
                    ]
                  },
                  {
                    id: 685,
                    name: "cita_chantiers_actuel",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "9c823038-5965-47cc-8dad-21496e57e3f2",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "cita_chantiers_actuel",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cita_chantiers_actuel__CHANTIERS_ACTUEL"
                      }
                    ]
                  },
                  {
                    id: 686,
                    name: "cita_chantiers_futur",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "063cb796-640f-4ab0-8430-955983a00e3b",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "cita_chantiers_futur",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cita_chantiers_futur__CHANTIERS_FUTUR"
                      }
                    ]
                  },
                  {
                    id: 1713,
                    name: "chantiers_actuels_pc",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "7d59f3a6-e8d8-464b-bbf9-73c6ca358a51",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "chantiers_actuels_pc",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "chantiers_actuels_pc__CHANTIERS_ACTUEL_PC"
                      }
                    ]
                  },
                  {
                    id: 1714,
                    name: "chantiers_futurs_pc",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "f6b9df36-5e62-46d1-ae91-c7c58c7e2e45",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "chantiers_futurs_pc",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "chantiers_futurs_pc__CHANTIERS_FUTUR_PC"
                      }
                    ]
                  },
                  {
                    id: 682,
                    name: "mobi_mbox",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:mbox",
                      max_dpi: 128,
                      metadata_id: "77780c80-a2dc-4dc2-96ac-c29e2ad15495"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobi_mbox",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobi_mbox__0"
                      }
                    ]
                  },
                  {
                    id: 713,
                    name: "pch_radars",
                    metadata: {
                      is_queryable: true,
                      max_dpi: 128,
                      metadata_id: "385180ba-a9bc-49d4-8858-ba5f19942a66",
                      start_opacity: 1
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "pch_radars",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "pch_radars__0"
                      },
                      {
                        name: "pch_radars__1"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          bg_layer: "pixelmaps-gray",
          bg_opacity: 0.01,
          css: "pag.css",
          display_in_switcher: true,
          page_title: "pag.geoportail.lu",
          print_img: "PAG.png",
          print_long_txt_de: "Das \xF6ffentliche Geoportal des Grossherzogtums Luxemburg",
          print_long_txt_en: "The official geoportal for the Grand-Duchy of Luxembourg",
          print_long_txt_fr: "Le g\xE9oportail officiel du Grand-Duch\xE9 de Luxembourg",
          print_long_txt_lu: "Den offizielle Geoportal vu L\xEBtzebuerg",
          print_scales: [
            "2500",
            "5000",
            "10000",
            "15000",
            "20000",
            "25000",
            "50000",
            "100000",
            "200000",
            "250000",
            "400000"
          ],
          print_short_txt_de: "pag.geoportal.lu",
          print_short_txt_en: "pag.geoportal.lu",
          print_short_txt_fr: "pag.geoportail.lu",
          print_short_txt_lu: "pag.geoportal.lu",
          show_in_mobile: false,
          start_layers: [
            "pag_pag",
            "pag_pcn",
            "pag_pap_approuves",
            "pag_ssmn",
            "pag_pos"
          ]
        }
      },
      {
        id: 126,
        name: "agriculture",
        icon: "agriculture",
        children: [
          {
            id: 307,
            name: "asta",
            children: [
              {
                id: 1637,
                name: "asta_flik_parcels",
                metadata: {
                  is_queryable: true,
                  metadata_id: "f511a4ee-928a-4900-ac05-52aa0ce03bba"
                },
                dimensions: {},
                type: "WMS",
                layers: "asta_flik_parcels",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "asta_flik_parcels__3"
                  }
                ]
              },
              {
                id: 1511,
                name: "asta_prairies_permanentes",
                metadata: {
                  is_queryable: true,
                  metadata_id: "f6f493c2-f57b-419d-8953-ab8018576ac7"
                },
                dimensions: {},
                type: "WMS",
                layers: "asta_prairies_permanentes",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "asta_prairies_permanentes__0"
                  }
                ]
              },
              {
                id: 740,
                name: "asta_herbages_sensibles",
                metadata: {
                  metadata_id: "e5d2717e-4541-43f1-b586-1b18cdf11827"
                },
                dimensions: {},
                type: "WMS",
                layers: "asta_herbages_sensibles",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "asta_herbages_sensibles__gruenland"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 340,
            name: "asta_zones_prot",
            children: [
              {
                id: 540,
                name: "natura2000_habitats",
                metadata: {
                  is_queryable: true,
                  max_dpi: 128,
                  metadata_id: "080b7d2e-f8d5-4943-8dbf-04d3dfd4fe09"
                },
                dimensions: {},
                type: "WMS",
                layers: "natura2000_habitats",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "natura2000_habitats__2"
                  },
                  {
                    name: "natura2000_habitats__0"
                  }
                ]
              },
              {
                id: 533,
                name: "natura2000_oiseaux",
                metadata: {
                  is_queryable: true,
                  max_dpi: 128,
                  metadata_id: "080b7d2e-f8d5-4943-8dbf-04d3dfd4fe09"
                },
                dimensions: {},
                type: "WMS",
                layers: "natura2000_oiseaux",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "natura2000_oiseaux__1"
                  }
                ]
              },
              {
                id: 805,
                name: "anf_zpin_a_declarer",
                metadata: {
                  is_queryable: true,
                  legend_name: "anf:zpin_a_declarer",
                  metadata_id: "db53336b-1a33-4b1a-94a8-42a29b55ce45"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_zpin_a_declarer",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_zpin_a_declarer__ZPIN_A_DECLARER"
                  }
                ]
              },
              {
                id: 804,
                name: "anf_zpin_declarees",
                metadata: {
                  is_queryable: true,
                  legend_name: "anf:zpin_declarees",
                  metadata_id: "9439d9b1-eff6-47b5-a4c7-4c5bde2744f4"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_zpin_declarees",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_zpin_declarees__ZPIN_DECLAREES"
                  }
                ]
              },
              {
                id: 806,
                name: "anf_zpin_en_procedure",
                metadata: {
                  is_queryable: true,
                  legend_name: "anf:zpin_en_procedure_reglementaire",
                  metadata_id: "74499cf0-ab69-48bd-a357-8c151dd3d5c9"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_zpin_en_procedure",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_zpin_en_procedure__ZPIN_EN_PROCEDURE_REGLEMENTAIRE"
                  }
                ]
              },
              {
                id: 214,
                name: "eau_new_Provisorische_ZPS",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:provisorische_zps",
                  max_dpi: 128,
                  metadata_id: "ddc51f25-2fb7-4d14-866a-a08f8af8ef03"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Provisorische_ZPS",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Provisorische_ZPS__Provisorische ZPS"
                  }
                ]
              },
              {
                id: 664,
                name: "eau_new_ZPS_laufende_oeffentliche_Verfahrungsweise",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:zps_laufende_oeffentliche_verfahrungsweise",
                  max_dpi: 128,
                  metadata_id: "87beb1ac-7496-48f6-b5a9-8666e3897523"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_ZPS_laufende_oeffentliche_Verfahrungsweise",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_ZPS_laufende_oeffentliche_Verfahrungsweise__ZPS laufende \xF6ffentliche Verfahrungsweise"
                  }
                ]
              },
              {
                id: 1464,
                name: "eau_prgd_zones_protection_lac",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:prgd_stausee",
                  metadata_id: "eab29425-71cc-4610-b48e-8d848d0a8431"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_prgd_zones_protection_lac",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_prgd_zones_protection_lac__PRGD Schutzzonen Stausee"
                  }
                ]
              },
              {
                id: 573,
                name: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:zps_durch_grosshrzgl._verordnung_festgelegt",
                  max_dpi: 128,
                  metadata_id: "d70f99e0-6032-4a4b-b516-5dfdfce33b26"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt__ZPS durch grosshrzgl. Verordnung festgelegt"
                  }
                ]
              },
              {
                id: 490,
                name: "eau_new_Sanitaere_Schutzzonen_Stausee_EschSauer",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:sanitaere_schutzzonen_stausee",
                  max_dpi: 128,
                  metadata_id: "e34de488-68ea-48a8-9e92-f67bb209508e"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Sanitaere_Schutzzonen_Stausee_EschSauer",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Sanitaere_Schutzzonen_Stausee_EschSauer__Sanit\xE4re Schutzzonen Stausee"
                  }
                ]
              },
              {
                id: 559,
                name: "eau_new_Zones_interdiction_utilisation_metazachlore",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau_new:metazachlore",
                  max_dpi: 128,
                  metadata_id: "803e93f8-588f-4697-8d76-972be1ad3531",
                  start_opacity: 0.7
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Zones_interdiction_utilisation_metazachlore",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Zones_interdiction_utilisation_metazachlore__Zones interdiction utilisation metazachlore"
                  }
                ]
              },
              {
                id: 1481,
                name: "asta_projet_rgd",
                children: [
                  {
                    id: 1484,
                    name: "eau_asta_prgd_zones_protection_lac",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:prgd_stausee",
                      metadata_id: "eab29425-71cc-4610-b48e-8d848d0a8431"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_asta_prgd_zones_protection_lac",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_asta_prgd_zones_protection_lac__PRGD Schutzzonen Stausee"
                      }
                    ]
                  },
                  {
                    id: 1482,
                    name: "asta_contrainte_stockage_engrais",
                    metadata: {
                      legend_name: "asta:stockage_engrais",
                      metadata_id: "e94ac1bb-890b-412e-97e9-f71dbef88ab7"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "asta_contrainte_stockage_engrais",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "asta_contrainte_stockage_engrais__0"
                      }
                    ]
                  },
                  {
                    id: 1483,
                    name: "asta_contrainte_utilisation_engrais",
                    metadata: {
                      legend_name: "asta:utilisation_engrais",
                      metadata_id: "47f9de64-9636-4ce6-bf73-cb85cdd7b8d9"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "asta_contrainte_utilisation_engrais",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "asta_contrainte_utilisation_engrais__1"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 321,
            name: "pedologie",
            children: [
              {
                id: 272,
                name: "pedologie_100k",
                metadata: {
                  legend_name: "pedologie",
                  metadata_id: "2d712a34-ce79-426d-a57b-b7cadf97b80f"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "pedologie_100k",
                imageType: "image/png"
              },
              {
                id: 702,
                name: "asta_pedologie_new",
                metadata: {
                  legend_name: "pedologie_new",
                  max_dpi: 128,
                  metadata_id: "37686d89-0173-4040-88c7-be84a3648d01"
                },
                dimensions: {},
                type: "WMS",
                layers: "asta_pedologie_new",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "asta_pedologie_new__1"
                  },
                  {
                    name: "asta_pedologie_new__2"
                  },
                  {
                    name: "asta_pedologie_new__3"
                  },
                  {
                    name: "asta_pedologie_new__4"
                  },
                  {
                    name: "asta_pedologie_new__5"
                  },
                  {
                    name: "asta_pedologie_new__6"
                  },
                  {
                    name: "asta_pedologie_new__7"
                  }
                ]
              },
              {
                id: 704,
                name: "asta_pedologie_humus",
                metadata: {
                  legend_name: "asta_corg",
                  max_dpi: 128,
                  metadata_id: "a1b0807c-9bff-4f6a-a5e7-130316742f56"
                },
                dimensions: {},
                type: "WMS",
                layers: "asta_pedologie_humus",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "asta_pedologie_humus__0"
                  }
                ]
              },
              {
                id: 703,
                name: "asta_pedologie_ph",
                metadata: {
                  legend_name: "asta_ph",
                  max_dpi: 128,
                  metadata_id: "628ee73f-4c37-4689-bc4c-1fd9f6bd2663"
                },
                dimensions: {},
                type: "WMS",
                layers: "asta_pedologie_ph",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "asta_pedologie_ph__0"
                  }
                ]
              },
              {
                id: 2408,
                name: "asta_erosion_group",
                children: [
                  {
                    id: 2407,
                    name: "asta_erosion_2023",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "427aff9b-b988-455c-8cd9-1c029cfd6b6e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "asta_erosion_2023",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "asta_erosion_2023__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 204,
            name: "asta_meteo_group",
            children: [
              {
                id: 283,
                name: "asta_meteo",
                metadata: {
                  is_queryable: true,
                  metadata_id: "23e4b02d-a93d-47a4-8597-060319ae2af5"
                },
                dimensions: {},
                type: "WMS",
                layers: "asta_meteo",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "asta_meteo__meteo"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 309,
            name: "administrative_einheiten",
            children: [
              {
                id: 269,
                name: "communes_labels",
                metadata: {
                  is_queryable: true,
                  metadata_id: "17c7d883-ff7f-4b48-a894-46bea40d2e49"
                },
                dimensions: {},
                type: "WMS",
                layers: "communes_labels",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "communes_labels__COMMUNES_LABELS"
                  }
                ]
              },
              {
                id: 302,
                name: "communes",
                metadata: {
                  is_queryable: true,
                  metadata_id: "de5373d6-340f-4203-a065-da7550a03cc4_2049"
                },
                dimensions: {},
                type: "WMS",
                layers: "communes",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "communes__COMMUNES"
                  }
                ]
              },
              {
                id: 346,
                name: "cantons_labels",
                metadata: {
                  is_queryable: true,
                  metadata_id: "3af20a80-be4a-4819-a42b-18e49af799aa"
                },
                dimensions: {},
                type: "WMS",
                layers: "cantons_labels",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "cantons_labels__CANTONS_LABELS"
                  }
                ]
              },
              {
                id: 329,
                name: "cantons",
                metadata: {
                  is_queryable: true,
                  metadata_id: "e8a034e8-f986-4745-a848-b7ef30ce2740"
                },
                dimensions: {},
                type: "WMS",
                layers: "CANTONS",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "cantons__CANTONS"
                  }
                ]
              },
              {
                id: 268,
                name: "districts_labels",
                metadata: {
                  is_queryable: true,
                  metadata_id: "c42842e2-834a-427a-99f6-eb8cb79d1db4"
                },
                dimensions: {},
                type: "WMS",
                layers: "districts_labels",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "districts_labels__DISTRICTS_LABELS"
                  }
                ]
              },
              {
                id: 354,
                name: "districts",
                metadata: {
                  is_queryable: true,
                  metadata_id: "b9edd03f-3aef-4fd6-a3d9-db076b1cf237"
                },
                dimensions: {},
                type: "WMS",
                layers: "districts",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "districts__DISTRICTS"
                  }
                ]
              },
              {
                id: 349,
                name: "country",
                metadata: {
                  is_queryable: true,
                  metadata_id: "4c9b3c0b-85d4-447d-a68c-7416869f8d9b"
                },
                dimensions: {},
                type: "WMS",
                layers: "country",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "country__PAYS"
                  }
                ]
              },
              {
                id: 732,
                name: "limadmin_judiciaire",
                metadata: {
                  metadata_id: "235c0ac9-5bf6-45b6-9ceb-8680a07944ec"
                },
                dimensions: {},
                type: "WMS",
                layers: "limadmin_judiciaire",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "limadmin_judiciaire__ARRONDISSEMENTS JUDICIAIRES"
                  }
                ]
              },
              {
                id: 733,
                name: "limadmin_legislatif",
                metadata: {
                  metadata_id: "627b78d9-ae18-4be2-9a69-02aa6d4e38bb"
                },
                dimensions: {},
                type: "WMS",
                layers: "limadmin_legislatif",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "limadmin_legislatif__CIRCONSCRIPTIONS LEGISLATIVES"
                  }
                ]
              },
              {
                id: 744,
                name: "tour_ort",
                metadata: {
                  legend_name: "ort",
                  metadata_id: "44dbfde5-664e-4e45-8802-3d60b52eb9cb"
                },
                dimensions: {},
                type: "WMS",
                layers: "tour_ort",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "tour_ort__0"
                  },
                  {
                    name: "tour_ort__1"
                  }
                ]
              },
              {
                id: 746,
                name: "tour_leader",
                metadata: {
                  legend_name: "leader",
                  metadata_id: "a48aec89-7341-459e-a7d3-0e572982b255"
                },
                dimensions: {},
                type: "WMS",
                layers: "tour_leader",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "tour_leader__0"
                  },
                  {
                    name: "tour_leader__1"
                  },
                  {
                    name: "tour_leader__2"
                  }
                ]
              },
              {
                id: 747,
                name: "tour_parcsnaturels",
                metadata: {
                  is_queryable: true,
                  legend_name: "parcnaturel",
                  metadata_id: "f519c4e7-4459-49b5-b8c1-569328252d44"
                },
                dimensions: {},
                type: "WMS",
                layers: "tour_parcnaturels",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "tour_parcsnaturels__0"
                  },
                  {
                    name: "tour_parcsnaturels__1"
                  }
                ]
              },
              {
                id: 678,
                name: "anf_stations_biologiques",
                metadata: {
                  is_queryable: true,
                  metadata_id: "05e497fc-625d-4701-90af-dbe8813201ab"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_stations_biologiques",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_stations_biologiques__STATIONS_BIOLOGIQUES"
                  }
                ]
              },
              {
                id: 1364,
                name: "act_frontieres_isodistances",
                metadata: {
                  metadata_id: "09318d11-a908-4dea-a8f9-0558d20b980f",
                  start_opacity: 0.5
                },
                dimensions: {},
                type: "WMS",
                layers: "act_frontieres_isodistances",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "act_frontieres_isodistances__0"
                  },
                  {
                    name: "act_frontieres_isodistances__1"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 366,
            name: "emwelt_biotop_kadaster",
            children: [
              {
                id: 1367,
                name: "anf_biotopes_points",
                metadata: {
                  is_queryable: true,
                  legend_name: "env:btk_p",
                  metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_biotopes_points",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_biotopes_points__BIOTOPES_MO_EL_PONCTUELS"
                  }
                ]
              },
              {
                id: 1368,
                name: "anf_biotopes_vergers",
                metadata: {
                  is_queryable: true,
                  legend_name: "env:btk_s",
                  metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_biotopes_vergers",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_biotopes_vergers__BIOTOPES_MO_VERGERS"
                  }
                ]
              },
              {
                id: 1369,
                name: "anf_biotopes_surfaces",
                metadata: {
                  is_queryable: true,
                  legend_name: "env:btk_f",
                  metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_biotopes_surfaces",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_biotopes_surfaces__BIOTOPES_MO_SURFACES"
                  }
                ]
              },
              {
                id: 1370,
                name: "anf_biotopes_tampons",
                metadata: {
                  is_queryable: true,
                  legend_name: "env:btk_b",
                  metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                },
                dimensions: {},
                type: "WMS",
                layers: "anf_biotopes_tampons",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "anf_biotopes_tampons__BIOTOPES_MO_ZONES_TAMPONS"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 509,
            name: "asta_esp_group",
            children: [
              {
                id: 139,
                name: "asta_esp_esp",
                metadata: {
                  is_queryable: true,
                  max_dpi: 128,
                  metadata_id: "16f911c8-1008-4f86-b8c1-75584010f79b",
                  start_opacity: 0.75
                },
                dimensions: {},
                type: "WMS",
                layers: "asta_esp_esp",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "asta_esp_esp__0"
                  },
                  {
                    name: "asta_esp_esp__1"
                  }
                ]
              },
              {
                id: 138,
                name: "asta_esp_lisiere",
                metadata: {
                  is_queryable: true,
                  max_dpi: 128,
                  metadata_id: "e3dd4b8c-760b-44b3-887a-08c6be34c72d",
                  start_opacity: 0.5
                },
                dimensions: {},
                type: "WMS",
                layers: "asta_esp_lisiere",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "asta_esp_lisiere__2"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          bg_layer: "streets",
          bg_opacity: 0.01,
          css: "agriculture.css",
          display_in_switcher: true,
          link_title: "Administration des services techniques de l'agriculture",
          page_title: "agriculture.geoportail.lu",
          print_img: "bandeau_asta.png",
          print_long_txt_de: "Das \xF6ffentliche Geoportal des Grossherzogtums Luxemburg",
          print_long_txt_en: "The official geoportal for the Grand-Duchy of Luxembourg",
          print_long_txt_fr: "Le g\xE9oportail officiel du Grand-Duch\xE9 de Luxembourg",
          print_long_txt_lu: "Den offizielle Geoportal vu L\xEBtzebuerg",
          print_scales: [
            "1000",
            "1500",
            "2500",
            "5000",
            "10000",
            "15000",
            "20000",
            "25000",
            "50000",
            "80000",
            "100000",
            "125000",
            "200000",
            "250000",
            "400000"
          ],
          print_short_txt_de: "agriculture.geoportal.lu",
          print_short_txt_en: "agriculture.geoportal.lu",
          print_short_txt_fr: "agriculture.geoportail.lu",
          print_short_txt_lu: "agriculture.geoportal.lu",
          start_layers: ["asta_flik_parcels_2016"]
        }
      },
      {
        id: 132,
        name: "lenoz",
        icon: "lenoz",
        children: [
          {
            id: 429,
            name: "group_lenoz",
            children: [
              {
                id: 494,
                name: "lenoz_lmg",
                metadata: {
                  is_queryable: true,
                  metadata_id: "22d587f3-2b7d-4ebc-8564-7816cd3f2f13"
                },
                dimensions: {},
                type: "WMS",
                layers: "494",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "lenoz_lmg__POI"
                  }
                ]
              },
              {
                id: 496,
                name: "lenoz_creches",
                metadata: {
                  is_queryable: true,
                  metadata_id: "b355d9f7-174c-4349-b1c6-0e4d6f091ab3"
                },
                dimensions: {},
                type: "WMS",
                layers: "496",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "lenoz_creches__POI"
                  }
                ]
              },
              {
                id: 495,
                name: "lenoz_ecoles",
                metadata: {
                  is_queryable: true,
                  metadata_id: "f528b8f4-e84f-4e0c-9cf3-0b46c272f85d"
                },
                dimensions: {},
                type: "WMS",
                layers: "495",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "lenoz_ecoles__POI"
                  }
                ]
              },
              {
                id: 511,
                name: "lenoz_Post",
                metadata: {
                  is_queryable: true,
                  metadata_id: "efa463e0-9d5d-4120-9430-e1dd816c0ad2"
                },
                dimensions: {},
                type: "WMS",
                layers: "511",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "lenoz_Post__POI"
                  }
                ]
              },
              {
                id: 516,
                name: "lenoz_Banken",
                metadata: {
                  is_queryable: true,
                  metadata_id: "ccb93f63-b711-4113-9ffb-5ad40016ed05"
                },
                dimensions: {},
                type: "WMS",
                layers: "516",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "lenoz_Banken__POI"
                  }
                ]
              },
              {
                id: 504,
                name: "lenoz_\xC4rzte",
                metadata: {
                  is_queryable: true,
                  metadata_id: "7f97be71-db0c-4b2c-8b17-f5913d9b70aa"
                },
                dimensions: {},
                type: "WMS",
                layers: "504",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "lenoz_\xC4rzte__POI"
                  }
                ]
              },
              {
                id: 519,
                name: "lenoz_Restaurants",
                metadata: {
                  is_queryable: true,
                  metadata_id: "5fffa197-d8ba-43a2-9e6b-d4f593cb2f41"
                },
                dimensions: {},
                type: "WMS",
                layers: "519",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "lenoz_Restaurants__POI"
                  }
                ]
              },
              {
                id: 505,
                name: "lenoz_Lycees",
                metadata: {
                  is_queryable: true,
                  metadata_id: "35ffa708-81e1-48b8-814e-3a81647f108d"
                },
                dimensions: {},
                type: "WMS",
                layers: "505",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "lenoz_Lycees__POI"
                  }
                ]
              },
              {
                id: 506,
                name: "lenoz_Tankstelle",
                metadata: {
                  is_queryable: true,
                  metadata_id: "7301092d-ff3c-48a5-b3b7-d6a35ccab45f"
                },
                dimensions: {},
                type: "WMS",
                layers: "506",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "lenoz_Tankstelle__POI"
                  }
                ]
              },
              {
                id: 147,
                name: "arrets_bus",
                metadata: {
                  is_queryable: true,
                  legend_name: "mobiliteit:arrets_de_bus",
                  metadata_id: "7318c6e8-bb63-40e0-9e40-46ae7b0dc266"
                },
                dimensions: {},
                type: "WMS",
                layers: "arrets_bus",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "arrets_bus__0"
                  },
                  {
                    name: "arrets_bus__1"
                  }
                ]
              },
              {
                id: 423,
                name: "mobiliteit_cfl",
                metadata: {
                  is_queryable: true,
                  legend_name: "mobiliteit:cfl",
                  max_dpi: 128,
                  metadata_id: "0b3c42a2-275e-4519-b228-f407d46b8350"
                },
                dimensions: {},
                type: "WMS",
                layers: "mobiliteit_cfl",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "mobiliteit_cfl__1"
                  }
                ]
              },
              {
                id: 808,
                name: "velo_by_pch",
                metadata: {
                  is_queryable: true,
                  legend_name: "tour_velo_national",
                  metadata_id: "387f6949-0fc4-43a5-b0e6-4e09bdf65225"
                },
                dimensions: {},
                type: "WMS",
                layers: "velo_by_pch",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "velo_by_pch__1"
                  },
                  {
                    name: "velo_by_pch__0"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 486,
            name: "eau_new_Hochwasserrisikomanagement-Richtlinie [HWRM-RL]",
            children: [
              {
                id: 1696,
                name: "eau_new_Risikogewaesser_2019_group",
                children: [
                  {
                    id: 1703,
                    name: "eau_Risikogewaesser_2019",
                    metadata: {
                      legend_name: "eau:risikogewaesser_2019",
                      metadata_id: "762cd956-9733-4855-afa7-38768a38e8a1"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_Risikogewaesser_2019",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_Risikogewaesser_2019__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2114,
                name: "eau_Hochwassergefahrenkarten_2021",
                children: [
                  {
                    id: 2117,
                    name: "eau_Hochwassergefahrenkarten_HQ10_2021",
                    metadata: {
                      legend_name: "eau:inondations_2019",
                      metadata_id: "153130ef-8255-4bce-bca0-d2359d277995"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "eau_Hochwassergefahrenkarten_HQ10_2021",
                    imageType: "image/png"
                  },
                  {
                    id: 2118,
                    name: "eau_Hochwassergefahrenkarten_HQ100_2021",
                    metadata: {
                      legend_name: "eau:inondations_2019",
                      metadata_id: "cdb4137d-822f-4888-8a51-4596480970fe"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "eau_Hochwassergefahrenkarten_HQ100_2021",
                    imageType: "image/png"
                  },
                  {
                    id: 2119,
                    name: "eau_Hochwassergefahrenkarten_HQext_2021",
                    metadata: {
                      legend_name: "eau:inondations_2019",
                      metadata_id: "cd0f52f7-7226-4748-95e0-b77025284423"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "eau_Hochwassergefahrenkarten_HQext_2021",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2115,
                name: "eau_Hochwasserrisikokarten_2021",
                children: [
                  {
                    id: 2120,
                    name: "eau_Hochwasserrisikokarten_HQ10_2021",
                    metadata: {
                      legend_name: "eau:risque_inondations_2019",
                      metadata_id: "4a428832-16cf-4861-a1da-78a1f0a8c194"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "eau_Hochwasserrisikokarten_HQ10_2021",
                    imageType: "image/png"
                  },
                  {
                    id: 2121,
                    name: "eau_Hochwasserrisikokarten_HQ100_2021",
                    metadata: {
                      legend_name: "eau:risque_inondations_2019",
                      metadata_id: "ccb959ef-0ad6-47ec-ade9-45021912353f"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "eau_Hochwasserrisikokarten_HQ100_2021",
                    imageType: "image/png"
                  },
                  {
                    id: 2122,
                    name: "eau_Hochwasserrisikokarten_HQext_2021",
                    metadata: {
                      legend_name: "eau:risque_inondations_2019",
                      metadata_id: "f803b49a-336a-4bb7-acd9-5cbf508a731f"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "eau_Hochwasserrisikokarten_HQext_2021",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1711,
                name: "eau_atlas_crues_subites",
                children: [
                  {
                    id: 2045,
                    name: "age_dangers_fortes",
                    metadata: {
                      legend_name: "age_dangers_fortes",
                      metadata_id: "55dbe91c-f1e5-4c56-b0b9-4590988e23e5"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "age_dangers_fortes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "age_dangers_fortes__0"
                      },
                      {
                        name: "age_dangers_fortes__1"
                      }
                    ]
                  },
                  {
                    id: 2046,
                    name: "age_risques_fortes",
                    metadata: {
                      legend_name: "age_risques_fortes",
                      metadata_id: "f1d9b1cd-ad78-44df-89ac-ad591138243f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "age_risques_fortes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "age_risques_fortes__0"
                      },
                      {
                        name: "age_risques_fortes__1"
                      },
                      {
                        name: "age_risques_fortes__2"
                      },
                      {
                        name: "age_risques_fortes__3"
                      },
                      {
                        name: "age_risques_fortes__4"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 461,
                name: "eau_new_Historische_Ueberschwemmungsgebiete",
                children: [
                  {
                    id: 637,
                    name: "eau_new_UESG_1983_-_Mosel",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:uesg_1983_-_mosel",
                      max_dpi: 128,
                      metadata_id: "e6896207-c0f9-417e-9661-119128628e8e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_UESG_1983_-_Mosel",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_UESG_1983_-_Mosel__UESG 1983 - Mosel"
                      }
                    ]
                  },
                  {
                    id: 641,
                    name: "eau_new_UESG_1993_(ausser_Mosel)",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:uesg_1993_ausser_mosel",
                      max_dpi: 128,
                      metadata_id: "78c692f3-ad20-467b-b03a-0d020a821647"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_UESG_1993_(ausser_Mosel)",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_UESG_1993_(ausser_Mosel)__UESG 1993 [ausser Mosel]"
                      }
                    ]
                  },
                  {
                    id: 642,
                    name: "eau_new_UESG_Alzette_1995",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:uesg_alzette_1995",
                      max_dpi: 128,
                      metadata_id: "aaf81780-df85-4580-a890-fded8ae03db7"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_UESG_Alzette_1995",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_UESG_Alzette_1995__UESG Alzette 1995"
                      }
                    ]
                  },
                  {
                    id: 633,
                    name: "eau_new_UESG_Sauer_1995",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:uesg_sauer_1995",
                      max_dpi: 128,
                      metadata_id: "f01f7be2-0423-4571-8fff-57dd617ae632"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_UESG_Sauer_1995",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_UESG_Sauer_1995__UESG Sauer 1995"
                      }
                    ]
                  },
                  {
                    id: 2116,
                    name: "eau_Hochwasserkarten_2021",
                    children: [
                      {
                        id: 2114,
                        name: "eau_Hochwassergefahrenkarten_2021",
                        children: [
                          {
                            id: 2117,
                            name: "eau_Hochwassergefahrenkarten_HQ10_2021",
                            metadata: {
                              legend_name: "eau:inondations_2019",
                              metadata_id: "153130ef-8255-4bce-bca0-d2359d277995"
                            },
                            dimensions: {},
                            type: "WMTS",
                            url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                            style: "default",
                            matrixSet: "GLOBAL_WEBMERCATOR",
                            layer: "eau_Hochwassergefahrenkarten_HQ10_2021",
                            imageType: "image/png"
                          },
                          {
                            id: 2118,
                            name: "eau_Hochwassergefahrenkarten_HQ100_2021",
                            metadata: {
                              legend_name: "eau:inondations_2019",
                              metadata_id: "cdb4137d-822f-4888-8a51-4596480970fe"
                            },
                            dimensions: {},
                            type: "WMTS",
                            url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                            style: "default",
                            matrixSet: "GLOBAL_WEBMERCATOR",
                            layer: "eau_Hochwassergefahrenkarten_HQ100_2021",
                            imageType: "image/png"
                          },
                          {
                            id: 2119,
                            name: "eau_Hochwassergefahrenkarten_HQext_2021",
                            metadata: {
                              legend_name: "eau:inondations_2019",
                              metadata_id: "cd0f52f7-7226-4748-95e0-b77025284423"
                            },
                            dimensions: {},
                            type: "WMTS",
                            url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                            style: "default",
                            matrixSet: "GLOBAL_WEBMERCATOR",
                            layer: "eau_Hochwassergefahrenkarten_HQext_2021",
                            imageType: "image/png"
                          }
                        ],
                        metadata: {},
                        mixed: true
                      },
                      {
                        id: 2115,
                        name: "eau_Hochwasserrisikokarten_2021",
                        children: [
                          {
                            id: 2120,
                            name: "eau_Hochwasserrisikokarten_HQ10_2021",
                            metadata: {
                              legend_name: "eau:risque_inondations_2019",
                              metadata_id: "4a428832-16cf-4861-a1da-78a1f0a8c194"
                            },
                            dimensions: {},
                            type: "WMTS",
                            url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                            style: "default",
                            matrixSet: "GLOBAL_WEBMERCATOR",
                            layer: "eau_Hochwasserrisikokarten_HQ10_2021",
                            imageType: "image/png"
                          },
                          {
                            id: 2121,
                            name: "eau_Hochwasserrisikokarten_HQ100_2021",
                            metadata: {
                              legend_name: "eau:risque_inondations_2019",
                              metadata_id: "ccb959ef-0ad6-47ec-ade9-45021912353f"
                            },
                            dimensions: {},
                            type: "WMTS",
                            url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                            style: "default",
                            matrixSet: "GLOBAL_WEBMERCATOR",
                            layer: "eau_Hochwasserrisikokarten_HQ100_2021",
                            imageType: "image/png"
                          },
                          {
                            id: 2122,
                            name: "eau_Hochwasserrisikokarten_HQext_2021",
                            metadata: {
                              legend_name: "eau:risque_inondations_2019",
                              metadata_id: "f803b49a-336a-4bb7-acd9-5cbf508a731f"
                            },
                            dimensions: {},
                            type: "WMTS",
                            url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                            style: "default",
                            matrixSet: "GLOBAL_WEBMERCATOR",
                            layer: "eau_Hochwasserrisikokarten_HQext_2021",
                            imageType: "image/png"
                          }
                        ],
                        metadata: {},
                        mixed: true
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 463,
                name: "eau_new_Zusaetzliche_Informationen",
                children: [
                  {
                    id: 755,
                    name: "eau_new_Gew\xE4sser mit einem signifikanten Hochwasserrisiko",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:gewaesser_mit_einem_signifikanten_hochwasserrisiko",
                      metadata_id: "2006081e-2818-4f2b-978a-8ba505d840a8"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Gew\xE4sser mit einem signifikanten Hochwasserrisiko",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Gew\xE4sser mit einem signifikanten Hochwasserrisiko__Gew\xE4sser mit einem signifikanten Hochwasserrisiko"
                      }
                    ]
                  },
                  {
                    id: 756,
                    name: "eau_new_Hochwasser Brennpunkte",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:hochwasser_brennpunkte",
                      metadata_id: "b2bfd06d-5f05-4abf-8f41-103d40a380e7"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Hochwasser Brennpunkte",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Hochwasser Brennpunkte__Hochwasser Brennpunkte"
                      }
                    ]
                  },
                  {
                    id: 758,
                    name: "eau_new_Ma\xDFnahmens des Hochwasserrisikomanagementplans",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:massnahmens_des_hochwasserrisikomanagementplans",
                      metadata_id: "4326fea6-7ec4-4bb9-861f-4476b0d4ceac"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Ma\xDFnahmens des Hochwasserrisikomanagementplans",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Ma\xDFnahmens des Hochwasserrisikomanagementplans__Ma\xDFnahmens des Hochwasserrisikomanagementplans"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 166,
            name: "env_bruit",
            children: [
              {
                id: 2123,
                name: "env_bruit_modelisation",
                children: [
                  {
                    id: 232,
                    name: "env_bruit_axes_routiers",
                    children: [
                      {
                        id: 1497,
                        name: "env_bruit2016_axes_routiers_lden",
                        metadata: {
                          exclusion: "[336,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          metadata_id: "cf1a21cc-8208-420e-bd7e-091d755b6ace",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_routiers_lden",
                        imageType: "image/png"
                      },
                      {
                        id: 1500,
                        name: "env_bruit2016_axes_routiers_lngt",
                        metadata: {
                          exclusion: "[336,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          metadata_id: "83ae2d3b-f0d9-4584-8c48-f6722bd4f517",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_routiers_lngt",
                        imageType: "image/png"
                      },
                      {
                        id: 1504,
                        name: "env_bruit_axes_routiers_hotspots_2016",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "c5a6e3c5-6bef-4ff9-ac3e-aa494a34e602"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_routiers_hotspots_2016",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_routiers_hotspots_2016__0"
                          },
                          {
                            name: "env_bruit_axes_routiers_hotspots_2016__11"
                          }
                        ]
                      },
                      {
                        id: 1505,
                        name: "env_bruit_axes_routiers_agglomeration_2016",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "a6c63355-6e42-4795-9d72-8744b907b151"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_routiers_agglomeration_2016",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_routiers_agglomeration_2016__0"
                          },
                          {
                            name: "env_bruit_axes_routiers_agglomeration_2016__8"
                          }
                        ]
                      },
                      {
                        id: 326,
                        name: "env_bruit_axes_routiers_lden",
                        metadata: {
                          exclusion: "[333,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          max_dpi: 128,
                          metadata_id: "3e3aa044-89e0-4676-9404-744f64dd7ba0",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit_axes_routiers_lden",
                        imageType: "image/png"
                      },
                      {
                        id: 255,
                        name: "env_bruit_axes_routiers_lngt",
                        metadata: {
                          exclusion: "[333,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          max_dpi: 128,
                          metadata_id: "5e4f2607-b114-4884-8e48-8e1faa997eb4",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit_axes_routiers_lngt",
                        imageType: "image/png"
                      },
                      {
                        id: 1475,
                        name: "env_bruit_axes_routiers_hotspots",
                        metadata: {
                          exclusion: "[332,336]",
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "ff6b3d63-871c-4e88-8fc0-0f276abe259a"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_routiers_hotspots",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_routiers_hotspots__0"
                          },
                          {
                            name: "env_bruit_axes_routiers_hotspots__4"
                          }
                        ]
                      },
                      {
                        id: 1485,
                        name: "env_bruit_axes_routiers_agglomeration",
                        metadata: {
                          exclusion: "[332,336]",
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "f1dd0dd5-4dd5-4d88-b556-af39a20ab137",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_routiers_agglomeration",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_routiers_agglomeration__0"
                          },
                          {
                            name: "env_bruit_axes_routiers_agglomeration__2"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 183,
                    name: "env_bruit_axes_ferroviaires",
                    children: [
                      {
                        id: 1498,
                        name: "env_bruit2016_axes_ferroviaires_lden",
                        metadata: {
                          exclusion: "[336,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          metadata_id: "7975b71b-2fd4-45e6-8c0a-306671d665c6",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_ferroviaires_lden",
                        imageType: "image/png"
                      },
                      {
                        id: 1502,
                        name: "env_bruit2016_axes_ferroviaires_lngt",
                        metadata: {
                          exclusion: "[336,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          metadata_id: "170143ce-53ef-4b2b-997c-a2ccb1b84477",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_ferroviaires_lngt",
                        imageType: "image/png"
                      },
                      {
                        id: 1503,
                        name: "env_bruit_axes_ferroviaires_hotspots_2016",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "29ef44c6-f357-4d21-829c-f2fdd5fe1149"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_ferroviaires_hotspots_2016",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_ferroviaires_hotspots_2016__13"
                          },
                          {
                            name: "env_bruit_axes_ferroviaires_hotspots_2016__0"
                          }
                        ]
                      },
                      {
                        id: 310,
                        name: "env_bruit_axes_ferroviaires_lden",
                        metadata: {
                          exclusion: "[334,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          max_dpi: 128,
                          metadata_id: "32b40d1c-111e-4eed-91c7-61d61ef27b8d",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit_axes_ferroviaires_lden",
                        imageType: "image/png"
                      },
                      {
                        id: 259,
                        name: "env_bruit_axes_ferroviaires_lngt",
                        metadata: {
                          exclusion: "[334,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          max_dpi: 128,
                          metadata_id: "2d7e26ad-e448-45a2-9045-3dfb3e3ec15b",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit_axes_ferroviaires_lngt",
                        imageType: "image/png"
                      },
                      {
                        id: 1476,
                        name: "env_bruit_axes_ferroviaires_hotspots",
                        metadata: {
                          exclusion: "[332,336]",
                          is_queryable: true,
                          legend_name: "aev:noise_hotspots",
                          metadata_id: "d3b30653-d0bf-4924-96b2-251e9f61c979"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_axes_ferroviaires_hotspots",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_axes_ferroviaires_hotspots__6"
                          },
                          {
                            name: "env_bruit_axes_ferroviaires_hotspots__0"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 190,
                    name: "env_bruit_air",
                    children: [
                      {
                        id: 1501,
                        name: "env_bruit2016_axes_aeroport_lden",
                        metadata: {
                          exclusion: "[332,336]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          metadata_id: "26e208ff-39a3-4cf6-92db-4c6707fe972a",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_aeroport_lden",
                        imageType: "image/png"
                      },
                      {
                        id: 1499,
                        name: "env_bruit2016_axes_aeroport_lngt",
                        metadata: {
                          exclusion: "[332,336]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          metadata_id: "2aa6f79d-74cc-4f22-bedd-748f8e8e30b9",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "env_bruit2016_axes_aeroport_lngt",
                        imageType: "image/png"
                      },
                      {
                        id: 157,
                        name: "env_bruit_air_lden",
                        metadata: {
                          exclusion: "[335,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lden",
                          max_dpi: 128,
                          metadata_id: "0f4dcfc5-e947-4e5c-9460-702b8e1a572f",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_air_lden",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_air_lden__1"
                          }
                        ]
                      },
                      {
                        id: 327,
                        name: "env_bruit_air_lngt",
                        metadata: {
                          exclusion: "[335,332]",
                          is_queryable: true,
                          legend_name: "env:bruit_lngt",
                          max_dpi: 128,
                          metadata_id: "6b031060-1f82-467d-af86-afe02a3f04fa",
                          start_opacity: 0.7
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_air_lngt",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_air_lngt__0"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 2124,
                    name: "env_bruit_multiexposition",
                    children: [
                      {
                        id: 2125,
                        name: "aev_multiexposition_Lden",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "37c1c1a2-1926-4c92-8c2a-b9ce0ac6cfef"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "aev_multiexposition_Lden",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "aev_multiexposition_Lden__1"
                          }
                        ]
                      },
                      {
                        id: 2126,
                        name: "aev_multiexposition_Lnight",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "a536e129-3c0f-4a6c-a767-0519eec880c1"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "aev_multiexposition_Lnight",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "aev_multiexposition_Lnight__2"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1641,
                name: "aev_campagne_mesure_bruit",
                children: [
                  {
                    id: 1916,
                    name: "aev_silent_cities_2020",
                    children: [
                      {
                        id: 1917,
                        name: "aev_silent_cities_2020_phase1",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:silent_cities",
                          metadata_id: "58cd0d5a-e69a-4381-8d1c-7cdfd7d98272"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "aev_silent_cities_2020_phase1",
                        imageType: "image/png",
                        childLayers: [
                          {
                            name: "aev_silent_cities_2020_phase1__2"
                          }
                        ]
                      },
                      {
                        id: 1918,
                        name: "aev_silent_cities_2020_phase2",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:silent_cities",
                          metadata_id: "58cd0d5a-e69a-4381-8d1c-7cdfd7d98272"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "aev_silent_cities_2020_phase2",
                        imageType: "image/png",
                        childLayers: [
                          {
                            name: "aev_silent_cities_2020_phase2__3"
                          }
                        ]
                      },
                      {
                        id: 1919,
                        name: "aev_silent_cities_2020_phase3",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:silent_cities",
                          metadata_id: "58cd0d5a-e69a-4381-8d1c-7cdfd7d98272"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "aev_silent_cities_2020_phase3",
                        imageType: "image/png",
                        childLayers: [
                          {
                            name: "aev_silent_cities_2020_phase3__4"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1921,
                    name: "env_bruit_routes_hotspots_2019_group",
                    children: [
                      {
                        id: 1642,
                        name: "env_bruit_routes_hotspots_2019",
                        metadata: {
                          is_queryable: true,
                          legend_name: "aev:hotspots_rail",
                          metadata_id: "f898e289-c5dd-432b-b3e6-de4c3681b77a"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "env_bruit_routes_hotspots_2019",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "env_bruit_routes_hotspots_2019__0"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          bg_layer: "webbasemap",
          css: "lenoz.css",
          display_in_switcher: true,
          fake_scales: [
            "3000",
            "6000",
            "15000",
            "30000",
            "60000",
            "150000",
            "300000",
            "450000",
            "700000",
            "1500000"
          ],
          page_title: "lenoz.geoportail.lu",
          print_img: "bandeaulenoz.png",
          print_long_txt_de: "Luxemburgische Nachhaltigkeitszertifierung",
          print_long_txt_en: "Luxembourgish durability certification",
          print_long_txt_fr: "Certification en durabilit\xE9 luxembourgeoise",
          print_long_txt_lu: "L\xEBtzebuergesch Nohalt\xEBgkeetszertifiz\xE9irung",
          print_scales: ["10000"],
          print_short_txt_de: "lenoz.geoportail.lu",
          print_short_txt_en: "lenoz.geoportail.lu",
          print_short_txt_fr: "lenoz.geoportail.lu",
          print_short_txt_lu: "lenoz.geoportail.lu",
          resolutions: [
            "500.0",
            "250.0",
            "150.0",
            "100.0",
            "50.0",
            "20.0",
            "10.0",
            "5.0",
            "2.0",
            "1.0"
          ],
          start_layers: ["poi_ecoles"]
        }
      },
      {
        id: 124,
        name: "preizerdaul",
        icon: "preizerdaul",
        children: [
          {
            id: 287,
            name: "group_ac_preizerdaul_pag",
            children: [
              {
                id: 331,
                name: "ac_preizerdaul_pag",
                metadata: {
                  is_queryable: true,
                  legend_name: "preizerdaul:pag",
                  max_dpi: 128,
                  metadata_id: "2eb99e09-635c-400f-a32f-fbc7129854c3",
                  start_opacity: 0.7
                },
                dimensions: {},
                type: "WMS",
                layers: "ac_preizerdaul_pag",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "ac_preizerdaul_pag__0"
                  }
                ]
              },
              {
                id: 363,
                name: "ac_preizerdaul_ortho",
                metadata: {
                  max_dpi: 128,
                  metadata_id: "83700e3f-2590-4bab-b93f-47390186a04f"
                },
                dimensions: {},
                type: "WMS",
                layers: "ac_preizerdaul_ortho",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "ac_preizerdaul_ortho__0"
                  }
                ]
              },
              {
                id: 137,
                name: "ac_preizerdaul_ortho_2009",
                metadata: {
                  max_dpi: 128,
                  metadata_id: "2d9a745c-4574-42dd-9c7b-ce8f6ddeb4e3"
                },
                dimensions: {},
                type: "WMS",
                layers: "ac_preizerdaul_ortho_2009",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "ac_preizerdaul_ortho_2009__1"
                  },
                  {
                    name: "ac_preizerdaul_ortho_2009__0"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          bg_layer: "webbasemap",
          bg_opacity: 0,
          css: "preizerdaul.css",
          link_title: "Administration communale de Pr\xE9izerdaul",
          page_title: "preizerdaul.geoportail.lu",
          print_img: "preizerdaul.png",
          print_long_txt_de: "Das \xF6ffentliche Geoportal des Grossherzogtums Luxemburg",
          print_long_txt_en: "The official geoportal for the Grand-Duchy of Luxembourg",
          print_long_txt_fr: "Le g\xE9oportail officiel du Grand-Duch\xE9 de Luxembourg",
          print_long_txt_lu: "Den offizielle Geoportal vu L\xEBtzebuerg",
          print_scales: [
            "1000",
            "1500",
            "2500",
            "5000",
            "10000",
            "15000",
            "20000",
            "25000",
            "50000",
            "80000",
            "100000",
            "125000",
            "200000",
            "250000",
            "400000"
          ],
          print_short_txt_de: "preizerdaul.geoportal.lu",
          print_short_txt_en: "preizerdaul.geoportal.lu",
          print_short_txt_fr: "preizerdaul.geoportail.lu",
          print_short_txt_lu: "preizerdaul.geoportal.lu",
          start_layers: ["ac_preizerdaul_ortho", "ac_preizerdaul_pag"],
          start_x: 95500,
          start_y: 63500,
          start_zoom: 7
        }
      },
      {
        id: 125,
        name: "wellenstein",
        icon: "wellenstein",
        children: [
          {
            id: 279,
            name: "group_ac_wellenstein_pag",
            children: [
              {
                id: 210,
                name: "ac_wellenstein_pag_complet",
                metadata: {
                  legend_name: "wellenstein:pag_complet",
                  metadata_id: "f92b66ee-4d6c-48fe-a553-83236e8f0ed6",
                  start_opacity: 0.7
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "ac_wellenstein_pag_complet",
                imageType: "image/png"
              },
              {
                id: 182,
                name: "ac_wellenstein_pag_zones",
                metadata: {
                  legend_name: "wellenstein:pag_complet",
                  metadata_id: "f92b66ee-4d6c-48fe-a553-83236e8f0ed6",
                  start_opacity: 0.7
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "ac_wellenstein_pag_zones",
                imageType: "image/png"
              },
              {
                id: 257,
                name: "ac_wellenstein_pag_limites",
                metadata: {
                  legend_name: "wellenstein:pag_complet",
                  metadata_id: "f92b66ee-4d6c-48fe-a553-83236e8f0ed6"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "ac_wellenstein_pag_limites",
                imageType: "image/png"
              },
              {
                id: 258,
                name: "ac_wellenstein_pag_voies_acces",
                metadata: {
                  legend_name: "wellenstein:pag_complet",
                  metadata_id: "310c9c19-b3fd-42f2-a537-41a5525fa4a2"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "ac_wellenstein_pag_voies_acces",
                imageType: "image/png"
              },
              {
                id: 300,
                name: "ac_wellenstein_pag_perimetres_zones",
                metadata: {
                  legend_name: "wellenstein:pag_complet",
                  metadata_id: "f92b66ee-4d6c-48fe-a553-83236e8f0ed6"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "ac_wellenstein_pag_perimetres_zones",
                imageType: "image/png"
              },
              {
                id: 305,
                name: "ac_wellenstein_pag_volumes_a_sauvegarder",
                metadata: {
                  legend_name: "wellenstein:pag_complet",
                  metadata_id: "f92b66ee-4d6c-48fe-a553-83236e8f0ed6"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "ac_wellenstein_pag_volumes_a_sauvegarder",
                imageType: "image/png"
              },
              {
                id: 162,
                name: "ac_wellenstein_pag_volumes_batiments",
                metadata: {
                  legend_name: "wellenstein:pag_complet",
                  metadata_id: "f92b66ee-4d6c-48fe-a553-83236e8f0ed6"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "ac_wellenstein_pag_volumes_batiments",
                imageType: "image/png"
              },
              {
                id: 282,
                name: "ac_wellenstein_pag_alignements_a_preserver",
                metadata: {
                  legend_name: "wellenstein:pag_complet",
                  metadata_id: "f92b66ee-4d6c-48fe-a553-83236e8f0ed6"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "ac_wellenstein_pag_alignements_a_preserver",
                imageType: "image/png"
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          bg_layer: "streets",
          css: "wellenstein.css",
          link_title: "Commune de Wellenstein",
          page_title: "wellenstein.geoportail.lu",
          print_img: "wellenstein.png",
          print_long_txt_de: "Das \xF6ffentliche Geoportal des Grossherzogtums Luxemburg",
          print_long_txt_en: "The official geoportal for the Grand-Duchy of Luxembourg",
          print_long_txt_fr: "Le g\xE9oportail officiel du Grand-Duch\xE9 de Luxembourg",
          print_long_txt_lu: "Den offizielle Geoportal vu L\xEBtzebuerg",
          print_scales: [
            "1000",
            "1500",
            "2500",
            "5000",
            "10000",
            "15000",
            "20000",
            "25000",
            "50000",
            "80000",
            "100000",
            "125000",
            "200000",
            "250000",
            "400000"
          ],
          print_short_txt_de: "wellenstein.geoportal.lu",
          print_short_txt_en: "wellenstein.geoportal.lu",
          print_short_txt_fr: "wellenstein.geoportail.lu",
          print_short_txt_lu: "wellenstein.geoportal.lu",
          start_layers: ["ac_wellenstein_pag_complet"],
          start_x: 64965,
          start_y: 93325.5,
          start_zoom: 6
        }
      },
      {
        id: 131,
        name: "lintgen",
        icon: "lintgen",
        children: [
          {
            id: 422,
            name: "pag_lintgen",
            children: [
              {
                id: 425,
                name: "pag_lintgen_layer",
                metadata: {
                  legend_name: "lintgen",
                  metadata_id: "809bceff-4802-47d2-983d-290a0956b327",
                  start_opacity: 0.6
                },
                dimensions: {},
                type: "WMS",
                layers: "pag_lintgen_layer",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "pag_lintgen_layer__pag_lintgen"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 421,
            name: "eau_4_lintgen",
            children: [
              {
                id: 628,
                name: "eau_new_Bohrungen",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:bohrungen",
                  max_dpi: 128,
                  metadata_id: "4ab49f17-a50e-4439-9a9e-01ec93421aec"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Bohrungen",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Bohrungen__39"
                  }
                ]
              },
              {
                id: 629,
                name: "eau_new_Quellen",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:quellen",
                  max_dpi: 128,
                  metadata_id: "58fa573a-a0c3-474d-9e74-c277cf90b135"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_Quellen",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_Quellen__Quellen"
                  }
                ]
              },
              {
                id: 641,
                name: "eau_new_UESG_1993_(ausser_Mosel)",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:uesg_1993_ausser_mosel",
                  max_dpi: 128,
                  metadata_id: "78c692f3-ad20-467b-b03a-0d020a821647"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_UESG_1993_(ausser_Mosel)",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_UESG_1993_(ausser_Mosel)__UESG 1993 [ausser Mosel]"
                  }
                ]
              },
              {
                id: 642,
                name: "eau_new_UESG_Alzette_1995",
                metadata: {
                  is_queryable: true,
                  legend_name: "eau:uesg_alzette_1995",
                  max_dpi: 128,
                  metadata_id: "aaf81780-df85-4580-a890-fded8ae03db7"
                },
                dimensions: {},
                type: "WMS",
                layers: "eau_new_UESG_Alzette_1995",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "eau_new_UESG_Alzette_1995__UESG Alzette 1995"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          bg_layer: "voidLayer",
          bg_opacity: 0.01,
          css: "lintgen.css",
          fake_scales: ["2000", "2500", "5000", "10000", "15000", "30000"],
          page_title: "lintgen.geoportail.lu",
          print_img: "Lintgen.jpg",
          print_long_txt_de: "Das \xF6ffentliche Geoportal des Grossherzogtums Luxemburg",
          print_long_txt_en: "The official geoportal for the Grand-Duchy of Luxembourg",
          print_long_txt_fr: "Le g\xE9oportail officiel du Grand-Duch\xE9 de Luxembourg",
          print_long_txt_lu: "Den offizielle Geoportal vu L\xEBtzebuerg",
          print_scales: ["5000", "10000", "15000", "20000", "25000"],
          print_short_txt_de: "lintgen.geoportal.lu",
          print_short_txt_en: "lintgen.geoportal.lu",
          print_short_txt_fr: "lintgen.geoportail.lu",
          print_short_txt_lu: "lintgen.geoportal.lu",
          start_layers: ["pag_lintgen_layer"],
          start_x: 87430,
          start_y: 77248,
          start_zoom: 1
        }
      },
      {
        id: 120,
        name: "remich",
        icon: "remich",
        children: [
          {
            id: 236,
            name: "group_ac_remich_pag",
            children: [
              {
                id: 344,
                name: "ac_remich_pag",
                metadata: {
                  legend_name: "remich:pag",
                  metadata_id: "14d4159d-e103-4cac-a2a0-418ff24edaee",
                  start_opacity: 0.7
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "ac_remich_pag",
                imageType: "image/png"
              },
              {
                id: 267,
                name: "ac_remich_ortho",
                metadata: {
                  metadata_id: "a2d86966-e7e6-477e-b581-ae3a0e9f8e68"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "ac_remich_ortho",
                imageType: "image/png"
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          bg_layer: "streets",
          css: "remich.css",
          link_title: "Administration communale de Remich",
          page_title: "remich.geoportail.lu",
          print_img: "remich.png",
          print_long_txt_de: "Das \xF6ffentliche Geoportal des Grossherzogtums Luxemburg",
          print_long_txt_en: "The official geoportal for the Grand-Duchy of Luxembourg",
          print_long_txt_fr: "Le g\xE9oportail officiel du Grand-Duch\xE9 de Luxembourg",
          print_long_txt_lu: "Den offizielle Geoportal vu L\xEBtzebuerg",
          print_scales: [
            "1000",
            "1500",
            "2500",
            "5000",
            "10000",
            "15000",
            "20000",
            "25000",
            "50000",
            "80000",
            "100000",
            "125000",
            "200000",
            "250000",
            "400000"
          ],
          print_short_txt_de: "remich.geoportal.lu",
          print_short_txt_en: "remich.geoportal.lu",
          print_short_txt_fr: "remich.geoportail.lu",
          print_short_txt_lu: "remich.geoportal.lu",
          start_layers: ["ac_remich_ortho", "ac_remich_pag"],
          start_x: 67965,
          start_y: 94325.5,
          start_zoom: 6
        }
      },
      {
        id: 114,
        name: "commande",
        icon: "commande",
        children: [
          {
            id: 253,
            name: "commande_grp",
            children: [
              {
                id: 200,
                name: "topo_decoupage_100k",
                metadata: {
                  is_queryable: true,
                  metadata_id: "0d331d41-73ff-4091-84e1-bf949e092a52"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "topo_decoupage_100k",
                imageType: "image/png"
              },
              {
                id: 219,
                name: "topo_decoupage_50k",
                metadata: {
                  is_queryable: true,
                  metadata_id: "f3714ffe-11ec-4a4a-8d51-549ba41086da"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "topo_decoupage_50k",
                imageType: "image/png"
              },
              {
                id: 193,
                name: "topo_decoupage_5000",
                metadata: {
                  is_queryable: true,
                  metadata_id: "036d0cd3-c605-40cb-90d3-8c7afd4ddff6"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "topo_decoupage_5000",
                imageType: "image/png"
              },
              {
                id: 188,
                name: "topo_decoupage_tc",
                metadata: {
                  is_queryable: true,
                  metadata_id: "ef075fce-9bea-4ecd-89a5-73a2587a464a"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "topo_decoupage_tc",
                imageType: "image/png"
              },
              {
                id: 216,
                name: "decoupage_communes",
                metadata: {
                  is_queryable: true,
                  metadata_id: "e71c2d85-3495-435d-90b7-98ac18f9235f"
                },
                dimensions: {},
                type: "WMS",
                layers: "decoupage_communes",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "decoupage_communes__DECOUPAGE_COMMUNE"
                  }
                ]
              },
              {
                id: 306,
                name: "decoupage_geo25k",
                metadata: {
                  is_queryable: true,
                  metadata_id: "5cf702be-f598-4d49-9af0-67724acf5ae2"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "decoupage_geo25k",
                imageType: "image/png"
              },
              {
                id: 211,
                name: "decoupage_geo25_50k",
                metadata: {
                  is_queryable: true,
                  metadata_id: "26ebc97c-166b-426c-ac5c-60ae42256f9e"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "decoupage_geo25_50k",
                imageType: "image/png"
              },
              {
                id: 262,
                name: "cadastre",
                metadata: {
                  exclusion: "[1,11,21,31,32,33,34,35,36,37,38,39,51,52,53,54,55,56,57,58,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115]",
                  is_queryable: true,
                  legend_name: "pcn_parcelles:show",
                  metadata_id: "de5373d6-340f-4203-a065-da7550a03cc4_2050"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "cadastre",
                imageType: "image/png"
              },
              {
                id: 374,
                name: "topo_decoupage_ortho_2013",
                metadata: {
                  is_queryable: true,
                  metadata_id: "3a35eb1a-9eaa-4f90-927f-2891d5e865f7"
                },
                dimensions: {},
                type: "WMS",
                layers: "topo_decoupage_ortho_2013",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "topo_decoupage_ortho_2013__DECOUPAGE_ORTHO_2013"
                  }
                ]
              },
              {
                id: 375,
                name: "prpl_luref",
                metadata: {
                  is_queryable: true,
                  metadata_id: "f97e9064-d97c-4bae-9083-4e21b7469b66"
                },
                dimensions: {},
                type: "WMS",
                layers: "prpl_luref",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "prpl_luref__PRPL_LUREF"
                  }
                ]
              },
              {
                id: 376,
                name: "prpl_ntl",
                metadata: {
                  is_queryable: true,
                  metadata_id: "426"
                },
                dimensions: {},
                type: "WMS",
                layers: "prpl_ntl",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "prpl_ntl__PRPL_NTL"
                  }
                ]
              },
              {
                id: 418,
                name: "repere_alti",
                metadata: {
                  is_queryable: false,
                  metadata_id: "3119179b-56bb-459d-8904-1e0a2bfb6bc7"
                },
                dimensions: {},
                type: "WMS",
                layers: "418",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "repere_alti__POI"
                  }
                ]
              },
              {
                id: 457,
                name: "topo_decoupage_5000_ed2015",
                metadata: {
                  is_queryable: true,
                  metadata_id: "01182ea0-3c30-4fc0-9bc2-e2dc778592da"
                },
                dimensions: {},
                type: "WMS",
                layers: "topo_decoupage_5000_ed2015",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "topo_decoupage_5000_ed2015__DECOUPAGE_5000_ED2015"
                  }
                ]
              },
              {
                id: 823,
                name: "feuilles_cadastrales_urplang2",
                metadata: {
                  is_queryable: true,
                  metadata_id: "3a35eb1a-9eaa-4f90-927f-2891d5e865f7"
                },
                dimensions: {},
                type: "WMS",
                layers: "feuilles_cadastrales_urplang",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "feuilles_cadastrales_urplang2__FEUILLES_CADASTRALES"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          css: "main.css",
          page_title: "map.geoportail.lu",
          print_img: "bandeau.jpg",
          print_long_txt_de: "Das \xF6ffentliche Geoportal des Grossherzogtums Luxemburg",
          print_long_txt_en: "The official geoportal for the Grand-Duchy of Luxembourg",
          print_long_txt_fr: "Le g\xE9oportail officiel du Grand-Duch\xE9 de Luxembourg",
          print_long_txt_lu: "Den offizielle Geoportal vu L\xEBtzebuerg",
          print_scales: [
            "1000",
            "1500",
            "2500",
            "5000",
            "10000",
            "15000",
            "20000",
            "25000",
            "50000",
            "80000",
            "100000",
            "125000",
            "200000",
            "250000",
            "400000"
          ],
          print_short_txt_de: "map.geoportal.lu",
          print_short_txt_en: "map.geoportal.lu",
          print_short_txt_fr: "map.geoportal.lu",
          print_short_txt_lu: "map.geoportal.lu"
        }
      },
      {
        id: 123,
        name: "at",
        icon: "at",
        children: [
          {
            id: 394,
            name: "at_ps",
            children: [
              {
                id: 392,
                name: "at_pst",
                children: [
                  {
                    id: 410,
                    name: "at_pst1",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:projetspst",
                      max_dpi: 128,
                      metadata_id: "10568679-86b2-487b-b19b-b371c39773c1",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_pst1",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_pst1__0"
                      },
                      {
                        name: "at_pst1__1"
                      }
                    ]
                  },
                  {
                    id: 408,
                    name: "at_pst2",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:couloirpst",
                      max_dpi: 128,
                      metadata_id: "10568679-86b2-487b-b19b-b371c39773c1",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_pst2",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_pst2__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 398,
                name: "at_psp",
                children: [
                  {
                    id: 396,
                    name: "at_psp_cv",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:coupureverte",
                      max_dpi: 128,
                      metadata_id: "84763751-9311-4d45-8f30-06e8370aeffa",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_psp_cv",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_psp_cv__0"
                      }
                    ]
                  },
                  {
                    id: 409,
                    name: "at_psp_zvi",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:zoneverteinterurbaine",
                      max_dpi: 128,
                      metadata_id: "7428ad86-57d1-4186-98aa-c4c2fb94578f",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_psp_zvi",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_psp_zvi__0"
                      }
                    ]
                  },
                  {
                    id: 395,
                    name: "at_psp_gep",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:grandsensemblespaysagers",
                      max_dpi: 128,
                      metadata_id: "84763751-9311-4d45-8f30-06e8370aeffa",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_psp_gep",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_psp_gep__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 393,
                name: "at_pszae",
                children: [
                  {
                    id: 407,
                    name: "at_pszae1",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:zaeexistante",
                      max_dpi: 128,
                      metadata_id: "2133d9bd-6941-4181-8866-0d8db0e1d041",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_pszae1",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_pszae1__0"
                      },
                      {
                        name: "at_pszae1__1"
                      }
                    ]
                  },
                  {
                    id: 402,
                    name: "at_pszae2",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:zaenouvext",
                      max_dpi: 128,
                      metadata_id: "ea5da181-a572-43fb-9813-e373ad3ac0c1",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_pszae2",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_pszae2__0"
                      },
                      {
                        name: "at_pszae2__1"
                      }
                    ]
                  },
                  {
                    id: 403,
                    name: "at_pszae3",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:zoneareclasser",
                      max_dpi: 128,
                      metadata_id: "ea5da181-a572-43fb-9813-e373ad3ac0c1",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_pszae3",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_pszae3__0"
                      },
                      {
                        name: "at_pszae3__1"
                      }
                    ]
                  },
                  {
                    id: 1435,
                    name: "at_pszae_droit_preemption",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "ac28744b-e9cd-4db1-8904-7bfe137aafcd"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_pszae_droit_preemption",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_pszae_droit_preemption__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 400,
                name: "at_psl",
                children: [
                  {
                    id: 401,
                    name: "at_psl1",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:zoneprojenvergurehabitat",
                      max_dpi: 128,
                      metadata_id: "a0c94819-73be-40b8-9327-e3b8b0407633",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_psl1",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_psl1__0"
                      },
                      {
                        name: "at_psl1__1"
                      }
                    ]
                  },
                  {
                    id: 1436,
                    name: "at_psl_droit_preemption",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "ec647d3d-46bf-4c3d-84dc-fc42f5c875a7"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_psl_droit_preemption",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_psl_droit_preemption__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1493,
                name: "at_pds_parcels_group",
                children: [
                  {
                    id: 1492,
                    name: "at_pds_parcels",
                    metadata: {
                      is_queryable: true,
                      legend_name: "attestation_pds",
                      metadata_id: "2b5a9769-3c31-4468-b457-724037bc8657"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_pds_parcels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_pds_parcels__0"
                      }
                    ]
                  },
                  {
                    id: 1712,
                    name: "at_psl_fond_de_plan",
                    metadata: {
                      metadata_id: "6c0d4541-6626-4ab4-8d02-baebcd2496bb"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_psl_fond_de_plan",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_psl_fond_de_plan__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {
              is_expanded: true
            },
            mixed: true
          },
          {
            id: 2208,
            name: "at_diagnostique_terr_group",
            children: [
              {
                id: 2209,
                name: "at_impermeabilisation_group",
                children: [
                  {
                    id: 1952,
                    name: "LISL_taux_impermeabilisation_2018",
                    metadata: {
                      is_queryable: true,
                      legend_name: "lisl_taux_impermeabilisation_2018",
                      metadata_id: "5b40c571-dd3c-4e76-8f4f-b54746799688"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "LISL_taux_impermeabilisation_2018",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "LISL_taux_impermeabilisation_2018__0"
                      },
                      {
                        name: "LISL_taux_impermeabilisation_2018__1"
                      }
                    ]
                  },
                  {
                    id: 2216,
                    name: "at_impermeabilisation_grid_2018_100m",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:impermeabilisation_grid_2018_100m",
                      metadata_id: "210db74a-e33a-401b-9e17-2cd966cdcd1f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_impermeabilisation_grid_2018_100m",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_impermeabilisation_grid_2018_100m__0"
                      }
                    ]
                  },
                  {
                    id: 2215,
                    name: "at_impermeabilisation_grid_2018_1km",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:impermeabilisation_grid_2018_1km",
                      metadata_id: "8dc777d0-f910-4c69-a476-85a73dcd8474"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_impermeabilisation_grid_2018_1km",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_impermeabilisation_grid_2018_1km__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2212,
                name: "at_batiments_group",
                children: [
                  {
                    id: 2214,
                    name: "at_batiments_periode_construction",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:periode_construction_batiments",
                      metadata_id: "7c138282-86de-4adb-91c2-467b06786821"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_batiments_periode_construction",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_batiments_periode_construction__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 2211,
            name: "at_regional_group",
            children: [
              {
                id: 2218,
                name: "at_region_sud_group",
                children: [
                  {
                    id: 2213,
                    name: "at_unesco_minett",
                    metadata: {
                      is_queryable: true,
                      legend_name: "at:unesco_minett",
                      metadata_id: "815fc4a3-95ef-47b6-a9ff-fa7e88654639"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "at_unesco_minett",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "at_unesco_minett__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 2313,
            name: "at_pos_group",
            children: [
              {
                id: 710,
                name: "pag_pos",
                metadata: {
                  is_queryable: true,
                  max_dpi: 128,
                  metadata_id: "a5f51e0e-c737-44e6-b0e0-7a0016d87707",
                  start_opacity: 1
                },
                dimensions: {},
                type: "WMS",
                layers: "pag_pos",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "pag_pos__0"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          bg_layer: "pixelmaps-gray",
          bg_opacity: 100,
          css: "at.css",
          display_in_switcher: true,
          fake_scales: [
            "750",
            "1500",
            "3000",
            "6000",
            "15000",
            "30000",
            "60000",
            "150000",
            "300000",
            "450000",
            "700000",
            "1500000"
          ],
          link_title: "Am\xE9nagement du territoire",
          page_title: "at.geoportail.lu",
          print_img: "bandeau_at.png",
          print_long_txt_de: "Das \xF6ffentliche Geoportal des Grossherzogtums Luxemburg",
          print_long_txt_en: "The official geoportal for the Grand-Duchy of Luxembourg",
          print_long_txt_fr: "Le g\xE9oportail officiel du Grand-Duch\xE9 de Luxembourg",
          print_long_txt_lu: "Den offizielle Geoportal vu L\xEBtzebuerg",
          print_scales: [
            "1000",
            "1500",
            "2500",
            "5000",
            "10000",
            "15000",
            "20000",
            "25000",
            "50000",
            "80000",
            "100000",
            "125000",
            "200000",
            "250000",
            "400000"
          ],
          print_short_txt_de: "at.geoportal.lu",
          print_short_txt_en: "at.geoportal.lu",
          print_short_txt_fr: "at.geoportail.lu",
          print_short_txt_lu: "at.geoportal.lu",
          resolutions: [
            "500.0",
            "250.0",
            "150.0",
            "100.0",
            "50.0",
            "20.0",
            "10.0",
            "5.0",
            "2.0",
            "1.0",
            "0.5",
            "0.25"
          ]
        }
      },
      {
        id: 800,
        name: "cadastre_hertzien",
        icon: "main",
        children: [
          {
            id: 803,
            name: "cadastre_hertzien_group",
            children: [
              {
                id: 811,
                name: "mat_antennes_moins_50_watt",
                metadata: {
                  is_queryable: true,
                  legend_name: "at:antennesbelow50w",
                  metadata_id: "cbf57825-26ba-4e36-98e8-083c1945066c"
                },
                dimensions: {},
                type: "WMS",
                layers: "mat_antennes_moins_50_watt",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "mat_antennes_moins_50_watt__0"
                  }
                ]
              },
              {
                id: 1930,
                name: "mat_5G_antennes_plus_50_watt",
                metadata: {
                  is_queryable: true,
                  metadata_id: "76e25a5d-8e78-40cb-a54b-9cfc27b16e60"
                },
                dimensions: {},
                type: "WMS",
                layers: "mat_5G_antennes_plus_50_watt",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "mat_5G_antennes_plus_50_watt__0"
                  }
                ]
              },
              {
                id: 2053,
                name: "mat_5G-3.6GHZ_antennes_plus_50_watt",
                metadata: {
                  is_queryable: true,
                  metadata_id: "e048acda-0ec7-4f52-8221-613d9312c28b"
                },
                dimensions: {},
                type: "WMS",
                layers: "mat_5G-3.6GHZ_antennes_plus_50_watt",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "mat_5G-3.6GHZ_antennes_plus_50_watt__0"
                  }
                ]
              },
              {
                id: 801,
                name: "mat_antennes_plus_50_watt",
                metadata: {
                  is_queryable: true,
                  legend_name: "at:antennes",
                  metadata_id: "e4a24392-591c-4d20-a62b-f75a9191488d"
                },
                dimensions: {},
                type: "WMS",
                layers: "mat_antennes_plus_50_watt",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "mat_antennes_plus_50_watt__0"
                  }
                ]
              },
              {
                id: 802,
                name: "mat_points_mesure",
                metadata: {
                  is_queryable: true,
                  legend_name: "at:pointmesure",
                  metadata_id: "f8f71353-40b8-4e10-b72c-85d8fe9e0577"
                },
                dimensions: {},
                type: "WMS",
                layers: "mat_points_mesure",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "mat_points_mesure__0"
                  }
                ]
              }
            ],
            metadata: {
              is_expanded: true
            },
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          display_in_switcher: true
        }
      },
      {
        id: 1672,
        name: "urban_farming",
        icon: "urban_farming",
        children: [
          {
            id: 1678,
            name: "Donn\xE9es disponibles",
            children: [
              {
                id: 1679,
                name: "Donn\xE9es disponibles",
                metadata: {
                  is_queryable: true,
                  legend_name: "uf:donnees_disponibles",
                  metadata_id: "aaa7619b-8b65-4283-829d-f990c62e7f4c"
                },
                dimensions: {},
                type: "WMS",
                layers: "Donn\xE9es disponibles",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Donn\xE9es disponibles__16"
                  },
                  {
                    name: "Donn\xE9es disponibles__17"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1690,
            name: "Analyse Ensoleillement",
            children: [
              {
                id: 1806,
                name: "Ensoleillement au 15.02",
                metadata: {
                  is_queryable: true,
                  legend_name: "uf:ensoleillement_fr",
                  metadata_id: "ece9ef19-b1ff-4acc-9d19-c00f7233d648"
                },
                dimensions: {},
                type: "WMS",
                layers: "Ensoleillement au 15.02",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Ensoleillement au 15.02__3"
                  }
                ]
              },
              {
                id: 1683,
                name: "Ensoleillement au 15.05",
                metadata: {
                  is_queryable: true,
                  legend_name: "uf:ensoleillement_fr",
                  metadata_id: "ece9ef19-b1ff-4acc-9d19-c00f7233d648"
                },
                dimensions: {},
                type: "WMS",
                layers: "Ensoleillement au 15.05",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Ensoleillement au 15.05__2"
                  }
                ]
              },
              {
                id: 1682,
                name: "Ensoleillement au 15.08",
                metadata: {
                  is_queryable: true,
                  legend_name: "uf:ensoleillement_fr",
                  metadata_id: "89b63cab-2220-4b00-abd5-2bfbe35352cd"
                },
                dimensions: {},
                type: "WMS",
                layers: "Ensoleillement au 15.08",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Ensoleillement au 15.08__1"
                  }
                ]
              }
            ],
            metadata: {
              legend_name: "uf:solar_hiver",
              metadata_id: "15446cbb-82d8-4d68-b049-a0ad24ae670e"
            },
            mixed: true
          },
          {
            id: 1673,
            name: "Projet en ext\xE9rieur, hors sol, professionnel, en toiture",
            children: [
              {
                id: 1674,
                name: "Toitures plates",
                metadata: {
                  legend_name: "uf:roof_type",
                  metadata_id: "65ba3e71-d581-4cde-b037-b6e852963fe6"
                },
                dimensions: {},
                type: "WMS",
                layers: "Toitures plates",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Toitures plates__12"
                  }
                ]
              },
              {
                id: 1675,
                name: "Hauteur des b\xE2timents",
                metadata: {
                  legend_name: "uf:building_height",
                  metadata_id: "021f0cc2-68ea-46b9-97c5-169cc5052e5e"
                },
                dimensions: {},
                type: "WMS",
                layers: "Hauteur des b\xE2timents",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Hauteur des b\xE2timents__11"
                  }
                ]
              },
              {
                id: 1680,
                name: "Accessibilit\xE9 l\xE9gale",
                metadata: {
                  legend_name: "uf:parcels_streets",
                  metadata_id: "a53e2022-a799-47b3-9d21-414c992f1019"
                },
                dimensions: {},
                type: "WMS",
                layers: "Accessibilit\xE9 l\xE9gale",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Accessibilit\xE9 l\xE9gale__13"
                  }
                ]
              },
              {
                id: 1676,
                name: "Ensoleillement",
                metadata: {
                  is_queryable: true,
                  legend_name: "uf:ensoleillement",
                  metadata_id: "15446cbb-82d8-4d68-b049-a0ad24ae670e"
                },
                dimensions: {},
                type: "WMS",
                layers: "Ensoleillement",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Ensoleillement__10"
                  }
                ]
              },
              {
                id: 1681,
                name: "Sites de commercialisation et consommation",
                metadata: {
                  is_queryable: true,
                  legend_name: "uf:commerce_closeby",
                  metadata_id: "54c3973e-3168-4a0a-9df0-ce5c97360d0d"
                },
                dimensions: {},
                type: "WMS",
                layers: "Sites de commercialisation et consommation",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Sites de commercialisation et consommation__14"
                  }
                ]
              },
              {
                id: 1687,
                name: "Typologie 1 - Carte pond\xE9r\xE9e pour le 15.02",
                metadata: {
                  is_queryable: true,
                  legend_name: "uf:typologie1",
                  metadata_id: "aa400ef6-b447-403e-9070-8795067e9017"
                },
                dimensions: {},
                type: "WMS",
                layers: "Typologie 1 - Carte pond\xE9r\xE9e pour le 15.02",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Typologie 1 - Carte pond\xE9r\xE9e pour le 15.02__8"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1685,
            name: "Projet en ext\xE9rieur, hors sol, professionnel, au sol",
            children: [
              {
                id: 1676,
                name: "Ensoleillement",
                metadata: {
                  is_queryable: true,
                  legend_name: "uf:ensoleillement",
                  metadata_id: "15446cbb-82d8-4d68-b049-a0ad24ae670e"
                },
                dimensions: {},
                type: "WMS",
                layers: "Ensoleillement",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Ensoleillement__10"
                  }
                ]
              },
              {
                id: 1681,
                name: "Sites de commercialisation et consommation",
                metadata: {
                  is_queryable: true,
                  legend_name: "uf:commerce_closeby",
                  metadata_id: "54c3973e-3168-4a0a-9df0-ce5c97360d0d"
                },
                dimensions: {},
                type: "WMS",
                layers: "Sites de commercialisation et consommation",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Sites de commercialisation et consommation__14"
                  }
                ]
              },
              {
                id: 1688,
                name: "Typologie 2 - Carte pond\xE9r\xE9e pour le 15.02",
                metadata: {
                  legend_name: "uf:typologie2",
                  metadata_id: "2fdba3ac-42ef-4a4d-9480-a0641b9d9cdc"
                },
                dimensions: {},
                type: "WMS",
                layers: "Typologie 2 - Carte pond\xE9r\xE9e pour le 15.02",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Typologie 2 - Carte pond\xE9r\xE9e pour le 15.02__7"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1686,
            name: "Projet en ext\xE9rieur, hors sol, communautaire, en toiture",
            children: [
              {
                id: 1674,
                name: "Toitures plates",
                metadata: {
                  legend_name: "uf:roof_type",
                  metadata_id: "65ba3e71-d581-4cde-b037-b6e852963fe6"
                },
                dimensions: {},
                type: "WMS",
                layers: "Toitures plates",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Toitures plates__12"
                  }
                ]
              },
              {
                id: 1675,
                name: "Hauteur des b\xE2timents",
                metadata: {
                  legend_name: "uf:building_height",
                  metadata_id: "021f0cc2-68ea-46b9-97c5-169cc5052e5e"
                },
                dimensions: {},
                type: "WMS",
                layers: "Hauteur des b\xE2timents",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Hauteur des b\xE2timents__11"
                  }
                ]
              },
              {
                id: 1676,
                name: "Ensoleillement",
                metadata: {
                  is_queryable: true,
                  legend_name: "uf:ensoleillement",
                  metadata_id: "15446cbb-82d8-4d68-b049-a0ad24ae670e"
                },
                dimensions: {},
                type: "WMS",
                layers: "Ensoleillement",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Ensoleillement__10"
                  }
                ]
              },
              {
                id: 1689,
                name: "Typologie 3 - Carte pond\xE9r\xE9e pour le 15.02",
                metadata: {
                  legend_name: "uf:typologie3",
                  metadata_id: "1fe3fa11-8d55-4612-b044-95a124cb5740"
                },
                dimensions: {},
                type: "WMS",
                layers: "Typologie 3 - Carte pond\xE9r\xE9e pour le 15.02",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "Typologie 3 - Carte pond\xE9r\xE9e pour le 15.02__6"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 248,
            name: "flurstucke_grundstucke",
            children: [
              {
                id: 359,
                name: "parcels",
                metadata: {
                  exclusion: "[1,11,21,31,32,33,34,35,36,37,38,39,51,52,53,54,55,56,57,58,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122]",
                  is_queryable: true,
                  legend_name: "pcn_parcelles:show",
                  metadata_id: "de5373d6-340f-4203-a065-da7550a03cc4_2050"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "parcels",
                imageType: "image/png"
              },
              {
                id: 353,
                name: "parcels_labels",
                metadata: {
                  metadata_id: "a65629c7-ddd6-43de-b0c3-c49647d8fd2b"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "parcels_labels",
                imageType: "image/png"
              },
              {
                id: 199,
                name: "buildings",
                metadata: {
                  exclusion: "[2,12,22,41,42,43,44,45,46,47,48,49,61,62,63,64,65,66,67,68,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222]",
                  is_queryable: true,
                  legend_name: "pcn_batiments:show",
                  metadata_id: "5d0efc9d-a05a-4964-9f9d-a0ab9932af04"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "buildings",
                imageType: "image/png"
              },
              {
                id: 320,
                name: "toponymes",
                metadata: {
                  metadata_id: "ffa537f7-a438-47da-9e0c-8e32260646a9"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "toponymes",
                imageType: "image/png"
              },
              {
                id: 350,
                name: "communes_cadastrales_labels",
                metadata: {
                  is_queryable: true,
                  metadata_id: "5ae8fdfb-bb8f-4f72-b7ee-36c7664fe4b5"
                },
                dimensions: {},
                type: "WMS",
                layers: "communes_cadastrales_labels",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "communes_cadastrales_labels__COMMUNES_CADASTRALES_LABELS"
                  }
                ]
              },
              {
                id: 153,
                name: "communes_cadastrales",
                metadata: {
                  is_queryable: true,
                  metadata_id: "8a95f8b2-2cfb-42e7-a51c-02084228b364"
                },
                dimensions: {},
                type: "WMS",
                layers: "communes_cadastrales",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "communes_cadastrales__COMMUNES_CADASTRALES"
                  }
                ]
              },
              {
                id: 266,
                name: "sections_cadastrales_labels",
                metadata: {
                  is_queryable: true,
                  metadata_id: "69d1b609-11f7-4587-872a-508ee98ea76c"
                },
                dimensions: {},
                type: "WMS",
                layers: "sections_cadastrales_labels",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "sections_cadastrales_labels__SECTIONS_CADASTRALES_LABELS"
                  }
                ]
              },
              {
                id: 355,
                name: "sections_cadastrales",
                metadata: {
                  is_queryable: true,
                  metadata_id: "c9122320-8f06-4499-ac86-eb469e911369"
                },
                dimensions: {},
                type: "WMS",
                layers: "sections_cadastrales",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "sections_cadastrales__SECTIONS_CADASTRALES"
                  }
                ]
              },
              {
                id: 256,
                name: "feuilles_cadastrales",
                metadata: {
                  is_queryable: true,
                  metadata_id: "51333029-c8cf-490f-b4a6-80ba239f0cb4"
                },
                dimensions: {},
                type: "WMS",
                layers: "feuilles_cadastrales",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "feuilles_cadastrales__FEUILLES_CADASTRALES"
                  }
                ]
              },
              {
                id: 417,
                name: "remembrements",
                metadata: {
                  exclusion: "[301,302,303,304,305,306,307,308,309,310]",
                  is_queryable: true,
                  max_dpi: 128,
                  metadata_id: "03d079f3-61fb-48bc-ab39-f3427b208702",
                  start_opacity: 0.7
                },
                dimensions: {},
                type: "WMS",
                layers: "remembrements",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "remembrements__0"
                  },
                  {
                    name: "remembrements__1"
                  }
                ]
              },
              {
                id: 1643,
                name: "act_grid_land_tenure",
                children: [
                  {
                    id: 1644,
                    name: "act_privately_owned_land",
                    metadata: {
                      is_queryable: true,
                      legend_name: "act:privately",
                      metadata_id: "75cb5ae7-7c48-478f-b2a6-1e5bfbdd5958"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "act_privately_owned_land",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "act_privately_owned_land__0"
                      }
                    ]
                  },
                  {
                    id: 1645,
                    name: "act_state_owned_land",
                    metadata: {
                      is_queryable: true,
                      legend_name: "act:stateowned",
                      metadata_id: "e8813b4e-43c4-4a72-853e-bd7c06fd1111"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "act_state_owned_land",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "act_state_owned_land__1"
                      }
                    ]
                  },
                  {
                    id: 1646,
                    name: "act_municipality_owned_land",
                    metadata: {
                      is_queryable: true,
                      legend_name: "act:municipality",
                      metadata_id: "89d42e03-93ae-444f-a49e-eb869b30071e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "act_municipality_owned_land",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "act_municipality_owned_land__2"
                      }
                    ]
                  },
                  {
                    id: 1647,
                    name: "act_domainepublic_owned_land",
                    metadata: {
                      is_queryable: true,
                      legend_name: "act:domainepublic",
                      metadata_id: "ac32c380-37df-4594-bbf2-0fd394482fd9"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "act_domainepublic_owned_land",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "act_domainepublic_owned_land__5"
                      }
                    ]
                  },
                  {
                    id: 1648,
                    name: "act_publicly_owned_land",
                    metadata: {
                      is_queryable: true,
                      legend_name: "act:publicly",
                      metadata_id: "0a1852f5-1f32-4bdc-8bbc-d6103921d862"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "act_publicly_owned_land",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "act_publicly_owned_land__6"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          display_in_switcher: true
        }
      },
      {
        id: 2333,
        name: "3D Meshes",
        icon: "https://map.geoportail.lu/static/0b3affb2592f45f6a379cac74b45a07e/images/blank.png",
        children: [
          {
            id: 2331,
            name: "3d Meshes",
            children: [
              {
                id: 2330,
                name: "2020 mesh",
                metadata: {
                  exclusion: '["mesh_2020_vs_bridges_ACT","mesh_2020_vs_trees","mesh_2020_vs_bridges_vdl","mesh_2020_vs_bd-l-bati-3d_vdl","mesh_2020_vs_bd-l-bati-3d","3d_meshes","mesh_2020_vs_buildings25d","mesh_2020_vs_buidlings_3d","mesh_2020_vs_bridges"]',
                  metadata_id: "1cd61b50-f2ad-4640-a894-e4488458b87e",
                  ol3d_defaultlayer: true,
                  ol3d_options: {
                    heightOffset: -47.8
                  }
                },
                dimensions: {},
                type: "WMTS",
                url: "https://acts3.geoportail.lu/3d-data/3d-tiles/mesh3D/mesh3D_2020_v2",
                layer: "Cesium",
                imageType: "image/png"
              }
            ],
            metadata: {
              is_expanded: true
            },
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          ol3d_type: "mesh"
        }
      },
      {
        id: 818,
        name: "API_ONLY",
        icon: "main",
        children: [
          {
            id: 820,
            name: "API_ONLY_LAYERS",
            children: [
              {
                id: 1363,
                name: "reagis",
                metadata: {
                  is_queryable: true,
                  metadata_id: "aafa412b-a2df-428e-a6d2-19a5774c8000"
                },
                dimensions: {},
                type: "WMS",
                layers: "reagis",
                imageType: "image/png",
                style: "dfault",
                childLayers: [
                  {
                    name: "reagis__POI"
                  }
                ]
              },
              {
                id: 1375,
                name: "makerspaces",
                metadata: {
                  is_queryable: true,
                  metadata_id: "4344ba7d-463c-499f-8a15-29e8baf46d9a"
                },
                dimensions: {},
                type: "WMS",
                layers: "makerspaces",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "makerspaces__POI"
                  }
                ]
              },
              {
                id: 1376,
                name: "parcels_daily",
                metadata: {
                  is_queryable: true,
                  metadata_id: "205a55db-473d-4f0e-8fbb-265dcb4dd8e2"
                },
                dimensions: {},
                type: "WMS",
                layers: "parcels_daily",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "parcels_daily__PARCELLES"
                  }
                ]
              },
              {
                id: 1459,
                name: "OSM_MQ",
                metadata: {
                  attribution: '&copy; <a href="https://www.mapzen.com/rights">CARTO</a>  &copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap</a> contributors for data outside of Luxembourg',
                  metadata_id: "537f7a04-3d75-4f03-9ac4-7212ad78219c"
                },
                dimensions: {},
                type: "WMS",
                layers: "OSM_MQ",
                imageType: "image/png",
                style: "default",
                childLayers: [],
                ogcServer: "source for https://wmts3.geoportail.lu/mapproxy_4_v3/service"
              },
              {
                id: 1798,
                name: "sante_infrastructures_covid19",
                metadata: {
                  is_queryable: true,
                  legend_name: "sante_infrastructures_covid19",
                  metadata_id: "3f86620b-cb97-49fb-a363-898575f6628c",
                  start_opacity: 0.9
                },
                dimensions: {},
                type: "WMS",
                layers: "1798",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "sante_infrastructures_covid19__POI"
                  }
                ]
              },
              {
                id: 1800,
                name: "sip_theatres",
                metadata: {
                  is_queryable: true,
                  metadata_id: "6745d7eb-93e3-4f55-be5f-2286903e46f0",
                  start_opacity: 0.9
                },
                dimensions: {},
                type: "WMS",
                layers: "1800",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "sip_theatres__POI"
                  }
                ]
              },
              {
                id: 1960,
                name: "stations_sps_Lux",
                metadata: {},
                dimensions: {},
                type: "WMS",
                layers: "1078",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "stations_sps_Lux__POI"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {}
      },
      {
        id: 1530,
        name: "atlas_demographique",
        icon: "https://map.geoportail.lu/static/0b3affb2592f45f6a379cac74b45a07e/images/blank.png",
        children: [
          {
            id: 1546,
            name: "ad_org_territoriale",
            children: [
              {
                id: 1547,
                name: "ad_org_terr_lux",
                children: [
                  {
                    id: 1532,
                    name: "ad_communes_cantons",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:communes_cantons",
                      metadata_id: "fbf159ad-4c67-40f4-9b40-547d1eb35642"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_communes_cantons",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_communes_cantons__49"
                      },
                      {
                        name: "ad_communes_cantons__50"
                      }
                    ]
                  },
                  {
                    id: 1531,
                    name: "ad_fusions_communes",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:fusions_communes",
                      metadata_id: "07ce11d6-1cc7-4e87-9d09-ceb89c39bfe1"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_fusions_communes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_fusions_communes__41"
                      },
                      {
                        name: "ad_fusions_communes__42"
                      },
                      {
                        name: "ad_fusions_communes__43"
                      },
                      {
                        name: "ad_fusions_communes__44"
                      },
                      {
                        name: "ad_fusions_communes__45"
                      },
                      {
                        name: "ad_fusions_communes__46"
                      },
                      {
                        name: "ad_fusions_communes__47"
                      },
                      {
                        name: "ad_fusions_communes__54"
                      }
                    ]
                  },
                  {
                    id: 1574,
                    name: "ad_poles_urbains",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:poles_urbains",
                      metadata_id: "891c4e2b-8972-4fd7-a1aa-6330f6dafbf8"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_poles_urbains",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_poles_urbains__35"
                      },
                      {
                        name: "ad_poles_urbains__36"
                      },
                      {
                        name: "ad_poles_urbains__37"
                      },
                      {
                        name: "ad_poles_urbains__38"
                      },
                      {
                        name: "ad_poles_urbains__39"
                      },
                      {
                        name: "ad_poles_urbains__54"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1548,
            name: "ad_etat_population",
            children: [
              {
                id: 1549,
                name: "ad_population_stock_evolution_densite",
                children: [
                  {
                    id: 1575,
                    name: "ad_population_commune_canton",
                    children: [
                      {
                        id: 1576,
                        name: "ad_population_canton",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:population_canton",
                          metadata_id: "18ceedb6-1867-419f-ab92-11e9787782a0"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_population_canton",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_population_canton__31"
                          },
                          {
                            name: "ad_population_canton__54"
                          }
                        ]
                      },
                      {
                        id: 1577,
                        name: "ad_population_commune",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:population_commune",
                          metadata_id: "26308dad-cae4-4ba7-af9f-5585488efb9d"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_population_commune",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_population_commune__32"
                          },
                          {
                            name: "ad_population_commune__54"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1550,
                    name: "ad_evolution_pop_comm",
                    children: [
                      {
                        id: 1533,
                        name: "ad_evol_pop_1981_2018",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:accroissement:1981:2018",
                          metadata_id: "bb9534dd-5a4c-4cfd-8733-90f4b4501379"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_evol_pop_1981_2018",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_evol_pop_1981_2018__29"
                          },
                          {
                            name: "ad_evol_pop_1981_2018__54"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1551,
                    name: "ad_densite_pop",
                    children: [
                      {
                        id: 1535,
                        name: "ad_densite_pop_comm",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:population_densite_commune",
                          metadata_id: "1c6bd461-d2f8-4d87-ab8e-48291eb18cbd"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_densite_pop_comm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_densite_pop_comm__27"
                          },
                          {
                            name: "ad_densite_pop_comm__28"
                          },
                          {
                            name: "ad_densite_pop_comm__54"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1552,
                name: "ad_rapport_hommes_femmes",
                children: [
                  {
                    id: 1578,
                    name: "ad_prop_femmes_comm_2018",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:proportion_femmes",
                      metadata_id: "4424bbe2-bb9b-4bab-b0fd-b754d833ce07"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_prop_femmes_comm_2018",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_prop_femmes_comm_2018__25"
                      },
                      {
                        name: "ad_prop_femmes_comm_2018__54"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1554,
                name: "ad_etrangers_lieu_naissance",
                children: [
                  {
                    id: 1545,
                    name: "ad_part_etrangers_comm",
                    children: [
                      {
                        id: 1579,
                        name: "ad_structure_pop_comm",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:structure_population",
                          metadata_id: "a12c27e9-37a5-4a1e-a98d-6cfccff42c21"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_structure_pop_comm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_structure_pop_comm__23"
                          },
                          {
                            name: "ad_structure_pop_comm__24"
                          },
                          {
                            name: "ad_structure_pop_comm__54"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1555,
                    name: "ad_nationalites_commune_2018",
                    children: [
                      {
                        id: 1536,
                        name: "ad_part_portugais_commune",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:part_portugais",
                          metadata_id: "78513942-ee02-43c1-bd56-a32e57688bf7"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_part_portugais_commune",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_part_portugais_commune__20"
                          },
                          {
                            name: "ad_part_portugais_commune__21"
                          },
                          {
                            name: "ad_part_portugais_commune__54"
                          }
                        ]
                      },
                      {
                        id: 1534,
                        name: "ad_part_francais_commune",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:part_francais",
                          metadata_id: "aff2570e-da08-47a3-a943-a9d8b16bcebb"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_part_francais_commune",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_part_francais_commune__18"
                          },
                          {
                            name: "ad_part_francais_commune__19"
                          },
                          {
                            name: "ad_part_francais_commune__54"
                          }
                        ]
                      },
                      {
                        id: 1544,
                        name: "ad_part_italiens_commune",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:part_italiens",
                          metadata_id: "c983db23-867c-40b0-8388-80a6bc35cc96"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_part_italiens_commune",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_part_italiens_commune__16"
                          },
                          {
                            name: "ad_part_italiens_commune__17"
                          },
                          {
                            name: "ad_part_italiens_commune__54"
                          }
                        ]
                      },
                      {
                        id: 1541,
                        name: "ad_part_belges_commune",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:part_belges",
                          metadata_id: "9b2484d9-1085-43df-bab0-e1ada3a02fde"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_part_belges_commune",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_part_belges_commune__14"
                          },
                          {
                            name: "ad_part_belges_commune__15"
                          },
                          {
                            name: "ad_part_belges_commune__54"
                          }
                        ]
                      },
                      {
                        id: 1538,
                        name: "ad_part_allemands_commune",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:part_allemands",
                          metadata_id: "0c638f13-5530-41fc-8f3b-68eba2cbf8db"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_part_allemands_commune",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_part_allemands_commune__12"
                          },
                          {
                            name: "ad_part_allemands_commune__13"
                          },
                          {
                            name: "ad_part_allemands_commune__54"
                          }
                        ]
                      },
                      {
                        id: 1543,
                        name: "ad_part_UE28_commune",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:part_ue28",
                          metadata_id: "2e232af1-5a76-44ba-b793-2e891c4d2056"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_part_UE28_commune",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_part_UE28_commune__10"
                          },
                          {
                            name: "ad_part_UE28_commune__11"
                          },
                          {
                            name: "ad_part_UE28_commune__54"
                          }
                        ]
                      },
                      {
                        id: 1542,
                        name: "ad_part_nonUE28_commune",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:part_non_ue28",
                          metadata_id: "448fb00f-a7e6-442e-bc45-4f4eb2ba57b8"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_part_nonUE28_commune",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_part_nonUE28_commune__8"
                          },
                          {
                            name: "ad_part_nonUE28_commune__9"
                          },
                          {
                            name: "ad_part_nonUE28_commune__54"
                          }
                        ]
                      },
                      {
                        id: 1537,
                        name: "ad_part_africains_commune",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:part_africains",
                          metadata_id: "4cda15de-4bf7-442c-b4ea-cf9eb48132e2"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_part_africains_commune",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_part_africains_commune__6"
                          },
                          {
                            name: "ad_part_africains_commune__7"
                          },
                          {
                            name: "ad_part_africains_commune__54"
                          }
                        ]
                      },
                      {
                        id: 1539,
                        name: "ad_part_americains_commune",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:part_americains",
                          metadata_id: "5b9181b3-29a1-41a6-a44a-9e54a8677efd"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_part_americains_commune",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_part_americains_commune__4"
                          },
                          {
                            name: "ad_part_americains_commune__5"
                          },
                          {
                            name: "ad_part_americains_commune__54"
                          }
                        ]
                      },
                      {
                        id: 1540,
                        name: "ad_part_asiates_commune",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:part_asiates",
                          metadata_id: "8f83aa66-4b95-4632-90c3-164f591ad99d"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_part_asiates_commune",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_part_asiates_commune__2"
                          },
                          {
                            name: "ad_part_asiates_commune__3"
                          },
                          {
                            name: "ad_part_asiates_commune__54"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1580,
                    name: "ad_lieu_naissance_lux_etr",
                    children: [
                      {
                        id: 1581,
                        name: "ad_lieu_naissance_commune",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:lieu_naissance",
                          metadata_id: "34c8f0cb-08fd-41d9-8f6c-e0036e48a7a2"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_lieu_naissance_commune",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_lieu_naissance_commune__0"
                          },
                          {
                            name: "ad_lieu_naissance_commune__54"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1556,
                name: "ad_structure_age",
                children: [
                  {
                    id: 1557,
                    name: "ad_age_moyen",
                    children: [
                      {
                        id: 1561,
                        name: "ad_age_moyen_femmes",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:age_moyen_femmes",
                          metadata_id: "d371cccb-da30-4a98-9d6e-1b0a6cb43e84"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_age_moyen_femmes",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_age_moyen_femmes__25"
                          },
                          {
                            name: "ad_age_moyen_femmes__26"
                          }
                        ]
                      },
                      {
                        id: 1562,
                        name: "ad_age_moyen_hommes",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:age_moyen_hommes",
                          metadata_id: "6448bc58-c7a2-483e-8fef-381bcd24c007"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_age_moyen_hommes",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_age_moyen_hommes__24"
                          },
                          {
                            name: "ad_age_moyen_hommes__26"
                          }
                        ]
                      },
                      {
                        id: 1563,
                        name: "ad_age_moyen_2",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:age_moyen_2",
                          metadata_id: "d5e02e7a-859e-445e-984f-c88cc03f107e"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_age_moyen_2",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_age_moyen_2__23"
                          },
                          {
                            name: "ad_age_moyen_2__26"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1558,
                    name: "ad_proportion_classes_age",
                    children: [
                      {
                        id: 1564,
                        name: "ad_moins20",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:age_moins20",
                          metadata_id: "5834d06d-316a-41e8-823d-68e522b77550"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_moins20",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_moins20__21"
                          },
                          {
                            name: "ad_moins20__26"
                          }
                        ]
                      },
                      {
                        id: 1565,
                        name: "ad_20_64",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:age_20_64",
                          metadata_id: "8d1624c9-9c5e-4131-8ebe-4989a1214be1"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_20_64",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_20_64__20"
                          },
                          {
                            name: "ad_20_64__26"
                          }
                        ]
                      },
                      {
                        id: 1566,
                        name: "ad_65plus",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:age_65plus",
                          metadata_id: "e263aee4-2f0f-454c-84d5-7abd64406211"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_65plus",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_65plus__19"
                          },
                          {
                            name: "ad_65plus__26"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1559,
                    name: "ad_proportion_jeunes",
                    children: [
                      {
                        id: 1567,
                        name: "ad_moins3",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:age_moin3",
                          metadata_id: "e270926d-1f82-42c5-be80-c8f0d551e52c"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_moins3",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_moins3__17"
                          },
                          {
                            name: "ad_moins3__26"
                          }
                        ]
                      },
                      {
                        id: 1568,
                        name: "ad_3_5",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:age_3_5",
                          metadata_id: "68791225-c16c-45c8-ba06-fa88be4ef4e0"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_3_5",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_3_5__16"
                          },
                          {
                            name: "ad_3_5__26"
                          }
                        ]
                      },
                      {
                        id: 1569,
                        name: "ad_6_10",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:age_6_10",
                          metadata_id: "2e54caf6-b57c-4da5-855e-0dd521518862"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_6_10",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_6_10__15"
                          },
                          {
                            name: "ad_6_10__26"
                          }
                        ]
                      },
                      {
                        id: 1570,
                        name: "ad_11_17",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:age_11_17",
                          metadata_id: "cc51e192-a9b7-4d2f-9406-4ed6639280ed"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_11_17",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_11_17__14"
                          },
                          {
                            name: "ad_11_17__26"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1560,
                    name: "ad_proportion_ages",
                    children: [
                      {
                        id: 1571,
                        name: "ad_65_74",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:age_65_74",
                          metadata_id: "fb59a479-3177-417b-a905-bff71f9eb335"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_65_74",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_65_74__12"
                          },
                          {
                            name: "ad_65_74__26"
                          }
                        ]
                      },
                      {
                        id: 1572,
                        name: "ad_75_89",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:age_75_89",
                          metadata_id: "ee4a9399-501f-4a1f-93b0-d3827d3dd016"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_75_89",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_75_89__11"
                          },
                          {
                            name: "ad_75_89__26"
                          }
                        ]
                      },
                      {
                        id: 1573,
                        name: "ad_90plus",
                        metadata: {
                          is_queryable: true,
                          legend_name: "ad:age_90plus",
                          metadata_id: "c859f388-6e37-49c5-bc23-404703ad9215"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ad_90plus",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ad_90plus__10"
                          },
                          {
                            name: "ad_90plus__26"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1589,
                name: "ad_rapport_dependance",
                children: [
                  {
                    id: 1582,
                    name: "ad_rapport_dependance_personnes_agees",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:rapport_dependance_ages",
                      metadata_id: "b739896e-28cb-471b-afc8-4c9d8a36fcf5"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_rapport_dependance_personnes_agees",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_rapport_dependance_personnes_agees__7"
                      },
                      {
                        name: "ad_rapport_dependance_personnes_agees__26"
                      }
                    ]
                  },
                  {
                    id: 1583,
                    name: "ad_rapport_dependance_jeunes",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:rapport_dependance_jeunes",
                      metadata_id: "711df835-4cf0-4557-80dc-67c7c18d5f3c"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_rapport_dependance_jeunes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_rapport_dependance_jeunes__6"
                      },
                      {
                        name: "ad_rapport_dependance_jeunes__26"
                      }
                    ]
                  },
                  {
                    id: 1584,
                    name: "ad_rapport_dependance_total",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:rapport_dependance_total",
                      metadata_id: "b898fae0-2073-4cc2-88b4-a4851e93e16f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_rapport_dependance_total",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_rapport_dependance_total__5"
                      },
                      {
                        name: "ad_rapport_dependance_total__26"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1590,
                name: "ad_situation_matrimoniale",
                children: [
                  {
                    id: 1585,
                    name: "ad_celibataires",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:celibataires",
                      metadata_id: "40c3ab92-f09b-4722-b401-a6a271f083a4"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_celibataires",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_celibataires__4"
                      },
                      {
                        name: "ad_celibataires__26"
                      }
                    ]
                  },
                  {
                    id: 1586,
                    name: "ad_maries_pacses",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:maries",
                      metadata_id: "764c6af3-bc24-43a6-9741-d3e4f7cf83bb"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_maries_pacses",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_maries_pacses__3"
                      },
                      {
                        name: "ad_maries_pacses__26"
                      }
                    ]
                  },
                  {
                    id: 1587,
                    name: "ad_divorces_separes",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:divorces",
                      metadata_id: "7eb6a7f9-1419-4b34-adbc-fecaef5b5954"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_divorces_separes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_divorces_separes__2"
                      },
                      {
                        name: "ad_divorces_separes__26"
                      }
                    ]
                  },
                  {
                    id: 1588,
                    name: "ad_veufs_veuves",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:veufs",
                      metadata_id: "e17b3af4-b31b-47ec-9a38-c01e8d3ccb30"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_veufs_veuves",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_veufs_veuves__1"
                      },
                      {
                        name: "ad_veufs_veuves__26"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1591,
            name: "ad_mouvement_population",
            children: [
              {
                id: 1592,
                name: "ad_naissances",
                children: [
                  {
                    id: 1597,
                    name: "ad_naissances_taux_natalite",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:naissances_taux_natalite",
                      metadata_id: "9930d837-0412-47a3-bca1-711cdd61af6a"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_naissances_taux_natalite",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_naissances_taux_natalite__58"
                      },
                      {
                        name: "ad_naissances_taux_natalite__59"
                      },
                      {
                        name: "ad_naissances_taux_natalite__61"
                      }
                    ]
                  },
                  {
                    id: 1598,
                    name: "ad_naissances_mariage",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:naissances_mariage",
                      metadata_id: "535ff8a9-86b6-486d-8a68-2e73e0c7a979"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_naissances_mariage",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_naissances_mariage__56"
                      },
                      {
                        name: "ad_naissances_mariage__61"
                      }
                    ]
                  },
                  {
                    id: 1599,
                    name: "ad_naissances_age_maternite",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:naissances_age_maternite",
                      metadata_id: "75a40efe-456c-4f72-8ce7-ea860143ea29"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_naissances_age_maternite",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_naissances_age_maternite__54"
                      },
                      {
                        name: "ad_naissances_age_maternite__61"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1593,
                name: "ad_deces",
                children: [
                  {
                    id: 1600,
                    name: "ad_deces_taux_mortalite",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:deces_taux_mortalite",
                      metadata_id: "68b8de6b-b71f-4f93-9d07-150181d2dfba"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_deces_taux_mortalite",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_deces_taux_mortalite__50"
                      },
                      {
                        name: "ad_deces_taux_mortalite__51"
                      },
                      {
                        name: "ad_deces_taux_mortalite__61"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1594,
                name: "ad_solde_naturel",
                children: [
                  {
                    id: 1601,
                    name: "ad_solde_naturel_nombre_absolu",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:solde_naturel",
                      metadata_id: "7a2fd409-5e34-48b6-89a1-83d14b519dff"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_solde_naturel_nombre_absolu",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_solde_naturel_nombre_absolu__45"
                      },
                      {
                        name: "ad_solde_naturel_nombre_absolu__46"
                      },
                      {
                        name: "ad_solde_naturel_nombre_absolu__47"
                      },
                      {
                        name: "ad_solde_naturel_nombre_absolu__61"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1595,
                name: "ad_migrations",
                children: [
                  {
                    id: 1603,
                    name: "ad_migrations_solde_interne",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:migrations_solde",
                      metadata_id: "2d500aa2-fe45-4a07-ab9f-506b11153744"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_migrations_solde_interne",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_migrations_solde_interne__40"
                      },
                      {
                        name: "ad_migrations_solde_interne__41"
                      },
                      {
                        name: "ad_migrations_solde_interne__42"
                      },
                      {
                        name: "ad_migrations_solde_interne__61"
                      }
                    ]
                  },
                  {
                    id: 1604,
                    name: "ad_migrations_solde_international",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:migrations_solde_international",
                      metadata_id: "48795eb2-baf4-4f60-bb41-bed3b7dac520"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_migrations_solde_international",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_migrations_solde_international__36"
                      },
                      {
                        name: "ad_migrations_solde_international__37"
                      },
                      {
                        name: "ad_migrations_solde_international__38"
                      },
                      {
                        name: "ad_migrations_solde_international__61"
                      }
                    ]
                  },
                  {
                    id: 1605,
                    name: "ad_migrations_solde_total",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:migrations_solde_total",
                      metadata_id: "27cdcc17-8190-4381-94df-e06dcbe7808a"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_migrations_solde_total",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_migrations_solde_total__32"
                      },
                      {
                        name: "ad_migrations_solde_total__33"
                      },
                      {
                        name: "ad_migrations_solde_total__34"
                      },
                      {
                        name: "ad_migrations_solde_total__61"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1596,
                name: "ad_mariages",
                children: [
                  {
                    id: 1606,
                    name: "ad_mariages_taux_nuptialite",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:mariages_taux_nuptialite",
                      metadata_id: "25192002-b1b7-49fd-a0d7-b83642c07c68"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_mariages_taux_nuptialite",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_mariages_taux_nuptialite__28"
                      },
                      {
                        name: "ad_mariages_taux_nuptialite__29"
                      },
                      {
                        name: "ad_mariages_taux_nuptialite__61"
                      }
                    ]
                  },
                  {
                    id: 1607,
                    name: "ad_mariages_age_femme",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:mariages_age_femmes",
                      metadata_id: "727febc6-600f-425c-a8d6-1349890f5e31"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_mariages_age_femme",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_mariages_age_femme__26"
                      },
                      {
                        name: "ad_mariages_age_femme__61"
                      }
                    ]
                  },
                  {
                    id: 1608,
                    name: "ad_mariage_age_hommes",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:mariages_age_homme",
                      metadata_id: "e7334b68-11fe-430f-95d5-d2f792d24011"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_mariage_age_hommes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_mariage_age_hommes__25"
                      },
                      {
                        name: "ad_mariage_age_hommes__61"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1602,
            name: "ad_langues_lux",
            children: [
              {
                id: 1616,
                name: "ad_langue_principale_2018",
                children: [
                  {
                    id: 1609,
                    name: "ad_langues_luxembourgeois",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:langues_lux",
                      metadata_id: "665006fe-aaff-40d3-8adc-76f41909a2cf"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_langues_luxembourgeois",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_langues_luxembourgeois__21"
                      },
                      {
                        name: "ad_langues_luxembourgeois__22"
                      },
                      {
                        name: "ad_langues_luxembourgeois__61"
                      }
                    ]
                  },
                  {
                    id: 1610,
                    name: "ad_langues_francais",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:langues_francais",
                      metadata_id: "207b92c0-6479-4bbc-b8a3-3ddef53d3029"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_langues_francais",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_langues_francais__18"
                      },
                      {
                        name: "ad_langues_francais__19"
                      },
                      {
                        name: "ad_langues_francais__61"
                      }
                    ]
                  },
                  {
                    id: 1611,
                    name: "ad_langues_allemand",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:langues_allemand",
                      metadata_id: "2fbdab89-6330-426c-af00-a1ce4b6294f5"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_langues_allemand",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_langues_allemand__15"
                      },
                      {
                        name: "ad_langues_allemand__16"
                      },
                      {
                        name: "ad_langues_allemand__61"
                      }
                    ]
                  },
                  {
                    id: 1612,
                    name: "ad_langues_portugais",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:langues_portugais",
                      metadata_id: "a0efcf68-9445-4d39-8193-a6f9cebf500b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_langues_portugais",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_langues_portugais__12"
                      },
                      {
                        name: "ad_langues_portugais__13"
                      },
                      {
                        name: "ad_langues_portugais__61"
                      }
                    ]
                  },
                  {
                    id: 1613,
                    name: "ad_langues_italien",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:langues_italien",
                      metadata_id: "aa83ba2b-297e-4d1a-9dbf-00853a3a01bd"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_langues_italien",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_langues_italien__9"
                      },
                      {
                        name: "ad_langues_italien__10"
                      },
                      {
                        name: "ad_langues_italien__61"
                      }
                    ]
                  },
                  {
                    id: 1614,
                    name: "ad_langues_anglais",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:langues_anglais",
                      metadata_id: "2fef731d-4c11-4c56-be6c-69b2f800931d"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_langues_anglais",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_langues_anglais__6"
                      },
                      {
                        name: "ad_langues_anglais__7"
                      },
                      {
                        name: "ad_langues_anglais__61"
                      }
                    ]
                  },
                  {
                    id: 1615,
                    name: "ad_langues_autre",
                    metadata: {
                      is_queryable: true,
                      legend_name: "ad:langues_autre",
                      metadata_id: "6c87f276-7219-4507-b4ba-a7f8a2378856"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ad_langues_autre",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ad_langues_autre__3"
                      },
                      {
                        name: "ad_langues_autre__4"
                      },
                      {
                        name: "ad_langues_autre__61"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          display_in_switcher: true
        }
      },
      {
        id: 1732,
        name: "logement",
        icon: "https://map.geoportail.lu/static/0b3affb2592f45f6a379cac74b45a07e/images/blank.png",
        children: [
          {
            id: 1733,
            name: "log_prix",
            children: [
              {
                id: 1734,
                name: "log_prix_app",
                children: [
                  {
                    id: 1739,
                    name: "log_prix_app_existants",
                    metadata: {
                      is_queryable: true,
                      legend_name: "logt_prix_app_exist",
                      metadata_id: "9679921a-f90e-4d26-9918-96e66225a171"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "log_prix_app_existants",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "log_prix_app_existants__14"
                      }
                    ]
                  },
                  {
                    id: 1740,
                    name: "log_prix_app_en_construction",
                    metadata: {
                      is_queryable: true,
                      legend_name: "logt_prix_app_enconstruction",
                      metadata_id: "bbb36662-64ba-4d2e-a9a4-7ab00d0bb264"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "log_prix_app_en_construction",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "log_prix_app_en_construction__13"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1735,
                name: "log_loyers",
                children: [
                  {
                    id: 1741,
                    name: "log_loyers_app",
                    metadata: {
                      is_queryable: true,
                      legend_name: "logt_loyers_app",
                      metadata_id: "2c3dc437-77ac-4030-a8d0-f61fd12e8f5e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "log_loyers_app",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "log_loyers_app__11"
                      }
                    ]
                  },
                  {
                    id: 1742,
                    name: "log_loyers_maisons",
                    metadata: {
                      is_queryable: true,
                      legend_name: "logt_loyers_maisons",
                      metadata_id: "f914e59b-6684-4a94-b5ec-b5a782708371"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "log_loyers_maisons",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "log_loyers_maisons__10"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1736,
                name: "log_prix_terrains",
                children: [
                  {
                    id: 1743,
                    name: "log_prix_median_terrain_15_17",
                    metadata: {
                      is_queryable: true,
                      legend_name: "logt_prix_median_terrain",
                      metadata_id: "3d5b4a58-3817-41fe-b2db-9310fa605635"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "log_prix_median_terrain_15_17",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "log_prix_median_terrain_15_17__8"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1737,
            name: "log_potentiel_foncier",
            children: [
              {
                id: 1744,
                name: "log_superficie_2016",
                metadata: {
                  is_queryable: true,
                  legend_name: "logt_superficie_dispo",
                  metadata_id: "c3fb1ec8-10d3-4e2b-9272-bb0a7396cdb5"
                },
                dimensions: {},
                type: "WMS",
                layers: "log_superficie_2016",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "log_superficie_2016__5"
                  }
                ]
              },
              {
                id: 1745,
                name: "log_superficie_selon_type_2016",
                metadata: {
                  is_queryable: true,
                  legend_name: "logt_superficie_selon_type",
                  metadata_id: "8c6408ca-4195-4cf0-b4bc-8c095f372c42"
                },
                dimensions: {},
                type: "WMS",
                layers: "log_superficie_selon_type_2016",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "log_superficie_selon_type_2016__4"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1738,
            name: "log_consommation_fonciere",
            children: [
              {
                id: 1746,
                name: "log_superficie_consommee",
                metadata: {
                  is_queryable: true,
                  legend_name: "logt_superficie_consommee",
                  metadata_id: "6766fa1f-26fe-402b-9f21-e3d6e903f13b"
                },
                dimensions: {},
                type: "WMS",
                layers: "log_superficie_consommee",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "log_superficie_consommee__2"
                  }
                ]
              },
              {
                id: 1747,
                name: "log_superficie_reconstruite",
                metadata: {
                  is_queryable: true,
                  legend_name: "logt_superficie_reconstruite",
                  metadata_id: "ea8570b2-f85b-4445-a5d1-a63ac01fa2c1"
                },
                dimensions: {},
                type: "WMS",
                layers: "log_superficie_reconstruite",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "log_superficie_reconstruite__1"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          display_in_switcher: true
        }
      },
      {
        id: 1833,
        name: "energie",
        icon: "https://map.geoportail.lu/static/0b3affb2592f45f6a379cac74b45a07e/images/blank.png",
        children: [
          {
            id: 1842,
            name: "energie_solaire_group",
            children: [
              {
                id: 1821,
                name: "myenergy_solarkataster",
                children: [
                  {
                    id: 1813,
                    name: "myenergy_solarkataster_luxemburg_solar_potentials",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:potentiel_solaire",
                      metadata_id: "97628fac-c53b-4426-a829-b188105b9ead",
                      ogc_info_format: "geojson",
                      ogc_info_srs: "epsg:3857",
                      ogc_query_layers: ["luxemburg_feature_info"]
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "myenergy_solarkataster_luxemburg_solar_potentials",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "myenergy_solarkataster_luxemburg_solar_potentials__luxemburg_solar_potentials"
                      }
                    ]
                  },
                  {
                    id: 1819,
                    name: "myenergy_solarkataster_luxemburg_feed_in_potential",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:tarifs_injection",
                      metadata_id: "23e8adfb-b628-4a4f-89ea-0f057baf6ec8",
                      ogc_info_format: "geojson",
                      ogc_info_srs: "epsg:3857"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "myenergy_solarkataster_luxemburg_feed_in_potential",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "myenergy_solarkataster_luxemburg_feed_in_potential__luxemburg_feed_in_potential"
                      }
                    ]
                  },
                  {
                    id: 1818,
                    name: "myenergy_solarkataster_luxemburg_roofs_above_30_kWp",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:toitures",
                      metadata_id: "a16c315e-abae-4904-95bc-90199393e8ae",
                      ogc_info_format: "geojson",
                      ogc_info_srs: "epsg:3857"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "myenergy_solarkataster_luxemburg_roofs_above_30_kWp",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "myenergy_solarkataster_luxemburg_roofs_above_30_kWp__luxemburg_roofs_above_30_kWp"
                      }
                    ]
                  },
                  {
                    id: 152,
                    name: "addresses",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "28b310e4-b9e1-467c-a28d-fce2e9a96548"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "addresses",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1690,
                name: "Analyse Ensoleillement",
                children: [
                  {
                    id: 1806,
                    name: "Ensoleillement au 15.02",
                    metadata: {
                      is_queryable: true,
                      legend_name: "uf:ensoleillement_fr",
                      metadata_id: "ece9ef19-b1ff-4acc-9d19-c00f7233d648"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "Ensoleillement au 15.02",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "Ensoleillement au 15.02__3"
                      }
                    ]
                  },
                  {
                    id: 1683,
                    name: "Ensoleillement au 15.05",
                    metadata: {
                      is_queryable: true,
                      legend_name: "uf:ensoleillement_fr",
                      metadata_id: "ece9ef19-b1ff-4acc-9d19-c00f7233d648"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "Ensoleillement au 15.05",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "Ensoleillement au 15.05__2"
                      }
                    ]
                  },
                  {
                    id: 1682,
                    name: "Ensoleillement au 15.08",
                    metadata: {
                      is_queryable: true,
                      legend_name: "uf:ensoleillement_fr",
                      metadata_id: "89b63cab-2220-4b00-abd5-2bfbe35352cd"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "Ensoleillement au 15.08",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "Ensoleillement au 15.08__1"
                      }
                    ]
                  }
                ],
                metadata: {
                  legend_name: "uf:solar_hiver",
                  metadata_id: "15446cbb-82d8-4d68-b049-a0ad24ae670e"
                },
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1843,
            name: "energie_eolienne_group",
            children: [
              {
                id: 1360,
                name: "aev_emplacements_eoliennes",
                metadata: {
                  is_queryable: true,
                  legend_name: "aev:eoliennes",
                  metadata_id: "354c5313-a733-4121-8f0d-5e0932d563b7"
                },
                dimensions: {},
                type: "WMS",
                layers: "aev_emplacements_eoliennes",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "aev_emplacements_eoliennes__0"
                  },
                  {
                    name: "aev_emplacements_eoliennes__1"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1835,
            name: "ilr_energie_group",
            children: [
              {
                id: 1946,
                name: "ilr_energie_canton",
                children: [
                  {
                    id: 1934,
                    name: "ilr_energie_cantons_biogas",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:biogaz",
                      metadata_id: "3caf3f4a-f492-4635-8c8e-b1b7ad37ae24-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_cantons_biogas",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_cantons_biogas__11"
                      },
                      {
                        name: "ilr_energie_cantons_biogas__12"
                      }
                    ]
                  },
                  {
                    id: 1935,
                    name: "ilr_energie_cantons_biomasse",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:biomasse",
                      metadata_id: "021ba8d1-2af9-45b7-8e30-c461ae56416a"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_cantons_biomasse",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_cantons_biomasse__9"
                      },
                      {
                        name: "ilr_energie_cantons_biomasse__12"
                      }
                    ]
                  },
                  {
                    id: 1936,
                    name: "ilr_energie_cantons_cogeneration",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:cogeneration",
                      metadata_id: "71a854b4-010d-48a4-acc1-8eddc2bb87c1-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_cantons_cogeneration",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_cantons_cogeneration__7"
                      },
                      {
                        name: "ilr_energie_cantons_cogeneration__12"
                      }
                    ]
                  },
                  {
                    id: 1937,
                    name: "ilr_energie_cantons_eolienne",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:eolienne",
                      metadata_id: "97ce42fc-848c-4c1c-a361-61a9736ae97f-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_cantons_eolienne",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_cantons_eolienne__5"
                      },
                      {
                        name: "ilr_energie_cantons_eolienne__12"
                      }
                    ]
                  },
                  {
                    id: 1938,
                    name: "ilr_energie_cantons_hydroelectrique",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:hydroelectrique",
                      metadata_id: "a96e0c84-8dcc-49af-a753-7321072aa198-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_cantons_hydroelectrique",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_cantons_hydroelectrique__3"
                      },
                      {
                        name: "ilr_energie_cantons_hydroelectrique__12"
                      }
                    ]
                  },
                  {
                    id: 1939,
                    name: "ilr_energie_cantons_photovoltaique",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:solaire",
                      metadata_id: "1bd8193e-5728-4020-be60-9677f3a2c2d6-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_cantons_photovoltaique",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_cantons_photovoltaique__1"
                      },
                      {
                        name: "ilr_energie_cantons_photovoltaique__12"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1947,
                name: "ilr_energie_commune",
                children: [
                  {
                    id: 1940,
                    name: "ilr_energie_communes_biogas",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:biogaz",
                      metadata_id: "3caf3f4a-f492-4635-8c8e-b1b7ad37ae24-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_communes_biogas",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_communes_biogas__10"
                      },
                      {
                        name: "ilr_energie_communes_biogas__12"
                      }
                    ]
                  },
                  {
                    id: 1941,
                    name: "ilr_energie_communes_biomasse",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:biomasse",
                      metadata_id: "021ba8d1-2af9-45b7-8e30-c461ae56416a"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_communes_biomasse",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_communes_biomasse__8"
                      },
                      {
                        name: "ilr_energie_communes_biomasse__12"
                      }
                    ]
                  },
                  {
                    id: 1942,
                    name: "ilr_energie_communes_cogeneration",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:cogeneration",
                      metadata_id: "71a854b4-010d-48a4-acc1-8eddc2bb87c1-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_communes_cogeneration",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_communes_cogeneration__6"
                      },
                      {
                        name: "ilr_energie_communes_cogeneration__12"
                      }
                    ]
                  },
                  {
                    id: 1943,
                    name: "ilr_energie_communes_eolienne",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:eolienne",
                      metadata_id: "97ce42fc-848c-4c1c-a361-61a9736ae97f-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_communes_eolienne",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_communes_eolienne__4"
                      },
                      {
                        name: "ilr_energie_communes_eolienne__12"
                      }
                    ]
                  },
                  {
                    id: 1944,
                    name: "ilr_energie_communes_hydroelectrique",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:hydroelectrique",
                      metadata_id: "a96e0c84-8dcc-49af-a753-7321072aa198-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_communes_hydroelectrique",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_communes_hydroelectrique__2"
                      },
                      {
                        name: "ilr_energie_communes_hydroelectrique__12"
                      }
                    ]
                  },
                  {
                    id: 1945,
                    name: "ilr_energie_communes_photovoltaique",
                    metadata: {
                      is_queryable: true,
                      legend_name: "energie:ilr:solaire",
                      metadata_id: "1bd8193e-5728-4020-be60-9677f3a2c2d6-intranet"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "ilr_energie_communes_photovoltaique",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "ilr_energie_communes_photovoltaique__0"
                      },
                      {
                        name: "ilr_energie_communes_photovoltaique__12"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1847,
            name: "energie_disponibilite",
            children: [
              {
                id: 1494,
                name: "gaz_naturel",
                metadata: {
                  is_queryable: true,
                  legend_name: "gaz",
                  metadata_id: "9e04e366-fcb7-4836-8d09-41b20f280cb0",
                  start_opacity: 0.75
                },
                dimensions: {},
                type: "WMS",
                layers: "gaz_naturel",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "gaz_naturel__0"
                  },
                  {
                    name: "gaz_naturel__2"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1845,
            name: "electromobilite_group",
            children: [
              {
                id: 1381,
                name: "chargy",
                metadata: {
                  is_queryable: true,
                  legend_name: "chargy",
                  metadata_id: "801d732a-c285-4fcd-a043-c5220d6d7eef"
                },
                dimensions: {},
                type: "WMS",
                layers: "chargy",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "chargy__chargy"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          display_in_switcher: true
        }
      },
      {
        id: 1834,
        name: "np_our",
        icon: "https://map.geoportail.lu/static/0b3affb2592f45f6a379cac74b45a07e/images/blank.png",
        children: [
          {
            id: 1860,
            name: "npour_basisdaten",
            children: [
              {
                id: 1861,
                name: "npour_basisdaten_verwaltungseinheiten",
                children: [
                  {
                    id: 302,
                    name: "communes",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "de5373d6-340f-4203-a065-da7550a03cc4_2049"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "communes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "communes__COMMUNES"
                      }
                    ]
                  },
                  {
                    id: 269,
                    name: "communes_labels",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "17c7d883-ff7f-4b48-a894-46bea40d2e49"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "communes_labels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "communes_labels__COMMUNES_LABELS"
                      }
                    ]
                  },
                  {
                    id: 329,
                    name: "cantons",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "e8a034e8-f986-4745-a848-b7ef30ce2740"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "CANTONS",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cantons__CANTONS"
                      }
                    ]
                  },
                  {
                    id: 346,
                    name: "cantons_labels",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "3af20a80-be4a-4819-a42b-18e49af799aa"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "cantons_labels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cantons_labels__CANTONS_LABELS"
                      }
                    ]
                  },
                  {
                    id: 744,
                    name: "tour_ort",
                    metadata: {
                      legend_name: "ort",
                      metadata_id: "44dbfde5-664e-4e45-8802-3d60b52eb9cb"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_ort",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_ort__0"
                      },
                      {
                        name: "tour_ort__1"
                      }
                    ]
                  },
                  {
                    id: 746,
                    name: "tour_leader",
                    metadata: {
                      legend_name: "leader",
                      metadata_id: "a48aec89-7341-459e-a7d3-0e572982b255"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_leader",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_leader__0"
                      },
                      {
                        name: "tour_leader__1"
                      },
                      {
                        name: "tour_leader__2"
                      }
                    ]
                  },
                  {
                    id: 747,
                    name: "tour_parcsnaturels",
                    metadata: {
                      is_queryable: true,
                      legend_name: "parcnaturel",
                      metadata_id: "f519c4e7-4459-49b5-b8c1-569328252d44"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_parcnaturels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_parcsnaturels__0"
                      },
                      {
                        name: "tour_parcsnaturels__1"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1862,
                name: "npour_basisdaten_adressen",
                children: [
                  {
                    id: 152,
                    name: "addresses",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "28b310e4-b9e1-467c-a28d-fce2e9a96548"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "addresses",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1863,
                name: "npour_basisdaten_topo",
                children: [
                  {
                    id: 223,
                    name: "topo_250k",
                    metadata: {
                      metadata_id: "e1f601a5-ed8f-4043-8719-0cad50cbb483"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "topo_250k",
                    imageType: "image/png"
                  },
                  {
                    id: 1730,
                    name: "topo_100k_2019",
                    metadata: {
                      legend_name: "topo_100k_sans_tour",
                      metadata_id: "ce051f08-bca6-43c0-af7b-5fcf3e02376e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "topo_100k_2019",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "topo_100k_2019__topo_100k"
                      }
                    ]
                  },
                  {
                    id: 1727,
                    name: "topo_50k_2019",
                    metadata: {
                      legend_name: "topo_50k_sans_tour",
                      metadata_id: "abc505e1-224c-455e-9e7f-4f094eb4e7b0"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "topo_50k_2019",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "topo_50k_2019__50K-2019-LUX_avec_ETRANGER"
                      }
                    ]
                  },
                  {
                    id: 206,
                    name: "topo_20k",
                    metadata: {
                      legend_name: "topo_20k",
                      metadata_id: "ea998ae8-731a-43bc-aa9f-171684f97602"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "topo_20k",
                    imageType: "image/png"
                  },
                  {
                    id: 149,
                    name: "topo_tour_20k",
                    metadata: {
                      legend_name: "topo_tour_20k",
                      metadata_id: "1173_"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "topo_tour_20k",
                    imageType: "image/png"
                  },
                  {
                    id: 195,
                    name: "topo_5k",
                    metadata: {
                      exclusion: "[32,42]",
                      legend_name: "topo_5k",
                      metadata_id: "270_2012"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "topo_5k",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 178,
                name: "luft_und_satellitenbilder",
                children: [
                  {
                    id: 2272,
                    name: "ortho_2021",
                    metadata: {
                      exclusion: "[121,221]",
                      metadata_id: "ea0bd2ff-b743-4f3a-bd9b-450976563de9"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR_4_V3",
                    layer: "ortho_2021",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 2056,
                    name: "ortho_2020",
                    metadata: {
                      exclusion: "[119,219]",
                      metadata_id: "87870b8a-10a1-4c33-bf50-7efe851fd450"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR_4_V3",
                    layer: "ortho_2020",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 1784,
                    name: "ortho_2019",
                    metadata: {
                      exclusion: "[116,216]",
                      metadata_id: "97c88ef6-6c64-4cb0-a134-06bb42b2b448"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2019",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 1789,
                    name: "ortho_2019_winter",
                    metadata: {
                      exclusion: "[118,218]",
                      metadata_id: "d6cc500f-b802-4be2-a49c-73f3eb2d131e"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2019_winter",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 1527,
                    name: "ortho_2018",
                    metadata: {
                      exclusion: "[113,213]",
                      metadata_id: "6fde72c4-802f-4663-be74-5fa5901cb4f0"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2018",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 1371,
                    name: "ortho_2017",
                    metadata: {
                      exclusion: "[111,211]",
                      metadata_id: "1cdae616-1a7a-49d5-b35d-05864891641f"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2017",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 745,
                    name: "ortho_2016",
                    metadata: {
                      exclusion: "[107,207]",
                      metadata_id: "bba79b6d-4205-4ce4-98e4-7b7922afcd55"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2016",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 360,
                    name: "ortho_2013",
                    metadata: {
                      exclusion: "[106,206]",
                      metadata_id: "ced4a3dd-135e-43d0-86b9-2318982581f7"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2013",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 342,
                    name: "ortho_2010",
                    metadata: {
                      exclusion: "[105,205]",
                      metadata_id: "0faf4bdb-a54b-42d7-942c-4e52fa66e963"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2010",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 231,
                    name: "ortho_2007",
                    metadata: {
                      exclusion: "[101,201]",
                      metadata_id: "3be3d98e-7997-4ff6-8d77-e393a5fc4fdd"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2007",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 224,
                    name: "ortho_2004",
                    metadata: {
                      exclusion: "[103,203]",
                      metadata_id: "a185f78a-ca9c-43f8-8d06-b1abba8ff056"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2004",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 225,
                    name: "ortho_2001",
                    metadata: {
                      exclusion: "[104,204]",
                      metadata_id: "e6ff269c-1c7c-401f-a90b-b805e80a046e"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "ortho_2001",
                    imageType: "image/jpeg"
                  },
                  {
                    id: 345,
                    name: "topo_decoupage_ortho",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "3a35eb1a-9eaa-4f90-927f-2891d5e865f7"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "topo_decoupage_ortho",
                    imageType: "image/png"
                  },
                  {
                    id: 292,
                    name: "wg_ikonos_satellitendaten",
                    metadata: {
                      legend_name: "wg:ikonos_satellitendaten",
                      metadata_id: "db0eea79-114a-4e61-a1f2-7e064f92cdd3"
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                    style: "default",
                    matrixSet: "GLOBAL_WEBMERCATOR",
                    layer: "wg_ikonos_satellitendaten",
                    imageType: "image/png"
                  },
                  {
                    id: 341,
                    name: "aero_1951_10k",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "16586649-8e46-4b04-b75c-5537a4bf214e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aero_1951_10k",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aero_1951_10k__1951_10k"
                      }
                    ]
                  },
                  {
                    id: 229,
                    name: "aero_1951_25k",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "b3b5fc05-323c-4f0b-804c-a4c186d62a96"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aero_1951_25k",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aero_1951_25k__1951_25k"
                      }
                    ]
                  },
                  {
                    id: 140,
                    name: "aero_1963_20k",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "56b65f04-d3ab-45b6-9e93-95c8c9524c3e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aero_1963_20k",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aero_1963_20k__1963_20k"
                      }
                    ]
                  },
                  {
                    id: 665,
                    name: "aero_1977_30k",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "d9dd951e-7345-4ba2-9a76-ce54305edf2f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aero_1977_30k",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "aero_1977_30k__1977_30k"
                      }
                    ]
                  },
                  {
                    id: 743,
                    name: "aero_1987_30k",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "98b63794-8cb1-42ff-9872-214f990ec8cd"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aero_1987_30k",
                    imageType: "image/png",
                    style: "defaults",
                    childLayers: [
                      {
                        name: "aero_1987_30k__1987_30k"
                      }
                    ]
                  },
                  {
                    id: 748,
                    name: "aero_1994_30k",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "abf7f6f5-8647-4317-98f6-8d4f5cd38585"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "aero_1994_30k",
                    imageType: "image/png",
                    style: "defaults",
                    childLayers: [
                      {
                        name: "aero_1994_30k__1994_30k"
                      }
                    ]
                  },
                  {
                    id: 790,
                    name: "Orthophotos Infrarouge",
                    children: [
                      {
                        id: 2283,
                        name: "ortho2021_IR",
                        metadata: {
                          exclusion: "[122,222]",
                          metadata_id: "067dc519-f507-45db-8e7a-f3ccc9125bc5"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ortho2021_IR",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ortho2021_IR__ortho2021_10cm_ir_EPSG2169"
                          }
                        ]
                      },
                      {
                        id: 2089,
                        name: "ortho2020_IR",
                        metadata: {
                          exclusion: "[120,220]",
                          metadata_id: "134fb490-c022-476d-b484-dc652ae8c626"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ortho2020_IR",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ortho2020_IR__Luxembourg-2020_ortho10cm_PIR_LUREF"
                          }
                        ]
                      },
                      {
                        id: 1785,
                        name: "ortho2019_IR",
                        metadata: {
                          exclusion: "[117,217]",
                          metadata_id: "3dfd031a-1721-4f35-b358-25062d5d4c26"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ortho2019_IR",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ortho2019_IR__ortho_2019_20cm_ir"
                          }
                        ]
                      },
                      {
                        id: 1529,
                        name: "ortho2018_IR",
                        metadata: {
                          exclusion: "[114,214]",
                          metadata_id: "2edf6bcb-2a1c-4b8c-8488-56000133abb4"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "ortho2018_IR",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "ortho2018_IR__4"
                          }
                        ]
                      },
                      {
                        id: 1372,
                        name: "ortho_2017_irc",
                        metadata: {
                          exclusion: "[112,212]",
                          metadata_id: "659a3236-a22e-44ae-9fa3-025cdf5d0043"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "ortho_2017_irc",
                        imageType: "image/jpeg"
                      },
                      {
                        id: 793,
                        name: "ortho_2016_irc",
                        metadata: {
                          exclusion: "[110,210]",
                          is_queryable: true,
                          metadata_id: "c313da75-7d8b-4570-9db5-bb6add56309e"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "ortho_2016_irc",
                        imageType: "image/jpeg"
                      },
                      {
                        id: 792,
                        name: "ortho_2013_irc",
                        metadata: {
                          exclusion: "[109,209]",
                          is_queryable: true,
                          metadata_id: "649b34a1-a195-40b4-81c9-0100343b9661"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "ortho_2013_irc",
                        imageType: "image/jpeg"
                      },
                      {
                        id: 791,
                        name: "ortho_2010_irc",
                        metadata: {
                          exclusion: "[108,208]",
                          is_queryable: true,
                          metadata_id: "728ffc2a-9062-4822-8596-01f0e93f6b40"
                        },
                        dimensions: {},
                        type: "WMTS",
                        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                        style: "default",
                        matrixSet: "GLOBAL_WEBMERCATOR",
                        layer: "ortho_2010_irc",
                        imageType: "image/jpeg"
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1865,
            name: "npour_poi_group",
            children: [
              {
                id: 1879,
                name: "npour_poi_propres",
                children: [
                  {
                    id: 1880,
                    name: "npour_poi_admin",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "d5e79fbd-4a11-428f-a7be-4a765508e791"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_poi_admin",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_poi_admin__administration_publique"
                      }
                    ]
                  },
                  {
                    id: 1881,
                    name: "npour_poi_batiments_reli",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "a3384282-5913-4610-b28e-72fa46ea18ea"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_poi_batiments_reli",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_poi_batiments_reli__batiments_religieux"
                      }
                    ]
                  },
                  {
                    id: 1894,
                    name: "npour_poi_culture",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "d4b40114-f351-484d-9b09-bbfc0fd20abd"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_poi_culture",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_poi_culture__culture"
                      }
                    ]
                  },
                  {
                    id: 1883,
                    name: "npour_poi_secours",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "988f5449-959b-488b-acfe-bfb2eee23247"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_poi_secours",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_poi_secours__services_de_secours"
                      }
                    ]
                  },
                  {
                    id: 1884,
                    name: "npour_poi_autres",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "ed8ad1e0-d4ff-46ee-8c2b-91323f45786b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_poi_autres",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_poi_autres__autres_prestations"
                      }
                    ]
                  },
                  {
                    id: 1878,
                    name: "npour_poi_transport",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "3821f8ee-0d90-47a0-b54f-02235af78fc2"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_poi_transport",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_poi_transport__transport_et_circulation"
                      }
                    ]
                  },
                  {
                    id: 1885,
                    name: "npour_poi_sociale",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "fa6c56a3-1bb6-4147-916b-956d0ce795e8"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_poi_sociale",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_poi_sociale__social"
                      }
                    ]
                  },
                  {
                    id: 1886,
                    name: "npour_poi_enseignement",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "6b31dedb-5bd7-44f3-a34e-48871adae269"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_poi_enseignement",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_poi_enseignement__enseignement"
                      }
                    ]
                  },
                  {
                    id: 1887,
                    name: "npour_poi_sante",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "f6480b65-fd0e-441d-a5fe-fd240540b57b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_poi_sante",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_poi_sante__sante"
                      }
                    ]
                  },
                  {
                    id: 1888,
                    name: "npour_poi_attraction",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "7e66c353-2a0d-4d58-a782-f2ec67371166"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_poi_attraction",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_poi_attraction__attractions"
                      }
                    ]
                  },
                  {
                    id: 1889,
                    name: "npour_poi_logement",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "d9f9d25d-2c2e-41a8-84fb-ba6d941ddb05"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_poi_logement",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_poi_logement__logement"
                      }
                    ]
                  },
                  {
                    id: 1890,
                    name: "npour_poi_gastronomie",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "54de547d-f500-4985-9893-96f58f9b8bc1"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_poi_gastronomie",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_poi_gastronomie__gastronomie"
                      }
                    ]
                  },
                  {
                    id: 1891,
                    name: "npour_poi_sport",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "43b24d55-7198-41f2-86d4-e6203d71ec09"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_poi_sport",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_poi_sport__sports_loisirs"
                      }
                    ]
                  },
                  {
                    id: 1892,
                    name: "npour_poi_tourisme",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "c36ba1cd-0d28-491f-8d51-e268e420a8f9"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_poi_tourisme",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_poi_tourisme__tourisme"
                      }
                    ]
                  },
                  {
                    id: 1893,
                    name: "npour_poi_commerce",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "87c0fcc6-3452-47f7-9b23-0fd9c9f38189"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_poi_commerce",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_poi_commerce__commerce"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 684,
                name: "editus_pois_tourisme",
                children: [
                  {
                    id: 542,
                    name: "editus_poi_299",
                    metadata: {
                      is_queryable: true,
                      legend_name: "editus_1",
                      metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                      start_opacity: 0.9
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "542",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "editus_poi_299__POI"
                      }
                    ]
                  },
                  {
                    id: 543,
                    name: "editus_poi_286",
                    metadata: {
                      is_queryable: true,
                      legend_name: "editus_2",
                      metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                      start_opacity: 0.9
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "543",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "editus_poi_286__POI"
                      }
                    ]
                  },
                  {
                    id: 544,
                    name: "editus_poi_285",
                    metadata: {
                      is_queryable: true,
                      legend_name: "editus_3",
                      metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                      start_opacity: 0.9
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "544",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "editus_poi_285__POI"
                      }
                    ]
                  },
                  {
                    id: 545,
                    name: "editus_poi_287",
                    metadata: {
                      is_queryable: true,
                      legend_name: "editus_4",
                      metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                      start_opacity: 0.9
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "545",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "editus_poi_287__POI"
                      }
                    ]
                  },
                  {
                    id: 546,
                    name: "editus_poi_289",
                    metadata: {
                      is_queryable: true,
                      legend_name: "editus_5",
                      metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                      start_opacity: 0.9
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "546",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "editus_poi_289__POI"
                      }
                    ]
                  },
                  {
                    id: 547,
                    name: "editus_poi_290",
                    metadata: {
                      is_queryable: true,
                      legend_name: "editus_6",
                      metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                      start_opacity: 0.9
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "547",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "editus_poi_290__POI"
                      }
                    ]
                  },
                  {
                    id: 549,
                    name: "editus_poi_291",
                    metadata: {
                      is_queryable: true,
                      legend_name: "editus_7",
                      metadata_id: "4a04ebff-4954-4c4d-9387-46d3587eccef",
                      start_opacity: 0.9
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "549",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "editus_poi_291__POI"
                      }
                    ]
                  },
                  {
                    id: 550,
                    name: "editus_poi_292",
                    metadata: {
                      is_queryable: true,
                      legend_name: "editus_8",
                      metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                      start_opacity: 0.9
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "550",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "editus_poi_292__POI"
                      }
                    ]
                  },
                  {
                    id: 551,
                    name: "editus_poi_293",
                    metadata: {
                      is_queryable: true,
                      legend_name: "editus_9",
                      metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                      start_opacity: 0.9
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "551",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "editus_poi_293__POI"
                      }
                    ]
                  },
                  {
                    id: 548,
                    name: "editus_poi_294",
                    metadata: {
                      is_queryable: true,
                      legend_name: "editus_10",
                      metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                      start_opacity: 0.9
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "548",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "editus_poi_294__POI"
                      }
                    ]
                  },
                  {
                    id: 552,
                    name: "editus_poi_295",
                    metadata: {
                      is_queryable: true,
                      legend_name: "editus_11",
                      metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                      start_opacity: 0.9
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "552",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "editus_poi_295__POI"
                      }
                    ]
                  },
                  {
                    id: 553,
                    name: "editus_poi_296",
                    metadata: {
                      is_queryable: true,
                      legend_name: "editus_12",
                      metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                      start_opacity: 0.9
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "553",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "editus_poi_296__POI"
                      }
                    ]
                  },
                  {
                    id: 554,
                    name: "editus_poi_298",
                    metadata: {
                      is_queryable: true,
                      legend_name: "editus_13",
                      metadata_id: "ae1bc422-5751-4efa-92af-c24287609dbb",
                      start_opacity: 0.9
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "554",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "editus_poi_298__POI"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2018,
                name: "tour_erleben_new",
                children: [
                  {
                    id: 2042,
                    name: "tour_tourist_info_new",
                    metadata: {
                      is_queryable: true
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "tour_tourist_info_new",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "tour_tourist_info_new__0"
                      }
                    ]
                  },
                  {
                    id: 2030,
                    name: "tour_essen_uebernachten_new",
                    children: [
                      {
                        id: 2038,
                        name: "tour_hotels_new",
                        metadata: {
                          is_queryable: true
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "tour_hotels_new",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "tour_hotels_new__8"
                          }
                        ]
                      },
                      {
                        id: 2037,
                        name: "tour_camping_new",
                        metadata: {
                          is_queryable: true
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "tour_camping_new",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "tour_camping_new__7"
                          }
                        ]
                      },
                      {
                        id: 2036,
                        name: "tour_jugendherberge_new",
                        metadata: {
                          is_queryable: true
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "tour_jugendherberge_new",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "tour_jugendherberge_new__6"
                          }
                        ]
                      },
                      {
                        id: 2035,
                        name: "tour_fewo_new",
                        metadata: {
                          is_queryable: true
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "tour_fewo_new",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "tour_fewo_new__5"
                          }
                        ]
                      },
                      {
                        id: 2034,
                        name: "tour_bb_new",
                        metadata: {
                          is_queryable: true
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "tour_bb_new",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "tour_bb_new__4"
                          }
                        ]
                      },
                      {
                        id: 2033,
                        name: "tour_restaurants_new",
                        metadata: {
                          is_queryable: true
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "tour_restaurants_new",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "tour_restaurants_new__3"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 2031,
                    name: "tour_kultur_new",
                    children: [
                      {
                        id: 2044,
                        name: "tour_burgen_schloesser_new",
                        metadata: {
                          is_queryable: true
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "tour_burgen_schloesser_new",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "tour_burgen_schloesser_new__2"
                          }
                        ]
                      },
                      {
                        id: 2043,
                        name: "tour_museen_new",
                        metadata: {
                          is_queryable: true
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "tour_museen_new",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "tour_museen_new__1"
                          }
                        ]
                      },
                      {
                        id: 2027,
                        name: "tour_unesco_new",
                        metadata: {
                          is_queryable: true
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "category",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [],
                        ogcServer: "source for config://my_maps?category_id=131"
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1866,
            name: "npour_wanderwege_group",
            children: [
              {
                id: 1867,
                name: "npour_wanderwege_eigene_group",
                children: [
                  {
                    id: 1895,
                    name: "npour_wanderwege_eigene",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "ef5983e1-a28f-4770-845a-8fcbd6f22fc0"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "npour_wanderwege_eigene",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "npour_wanderwege_eigene__randonnee"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 304,
                name: "tour_quality",
                children: [
                  {
                    id: 189,
                    name: "tour_mullerthal_trail",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "543f42ef-8aaf-47e3-8a3a-c694c05cbf67"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=7"
                  },
                  {
                    id: 205,
                    name: "tour_escape_ardenne",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "ecd56a00-be39-424f-a240-aab88ac680ef"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=16"
                  },
                  {
                    id: 250,
                    name: "tour_DeLux",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "dde68324-501b-4fdd-972a-c6fef3f1c3d1"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=13"
                  },
                  {
                    id: 168,
                    name: "tour_rando_traumschleifen_new",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "5ef27e69-57e1-4d76-9332-bfa268196ce0"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=22"
                  }
                ],
                metadata: {
                  is_expanded: true
                },
                mixed: true
              },
              {
                id: 1868,
                name: "npour_wanderwege_andere",
                children: [
                  {
                    id: 176,
                    name: "tour_autopedestre",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "aa1953b8-f97a-4871-bcd8-eb27e98098df"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=11,43"
                  },
                  {
                    id: 227,
                    name: "tour_sentiers_nationaux",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "04188aad-5a70-4b9c-a478-64d4899e0a86"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=4"
                  },
                  {
                    id: 158,
                    name: "tour_cfl",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "c4ac0376-8958-497c-a8d0-197d723df82c"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=12"
                  },
                  {
                    id: 197,
                    name: "tour_sentiers_ajl",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "bf8fcfc4-8b94-4fb8-a419-321d5d6a8f3f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=10"
                  },
                  {
                    id: 235,
                    name: "tour_sentiers_gr",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "6e9e8843-e20b-4b20-9ee3-53f6b0d06e8e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=9"
                  },
                  {
                    id: 218,
                    name: "tour_saint_jacques",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667"],
                      metadata_id: "210bf21c-6e3d-4555-907c-bb29c963b6e3"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=6"
                  },
                  {
                    id: 316,
                    name: "env_sentiersnature",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "cfc8de82-e187-4547-a1da-83385f86c786"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "env_sentiersnature",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "env_sentiersnature__sentiers_nature"
                      }
                    ]
                  },
                  {
                    id: 179,
                    name: "tour_sentiers_locaux",
                    children: [
                      {
                        id: 177,
                        name: "tour_sentiers_communaux",
                        metadata: {
                          is_queryable: true,
                          linked_layers: ["667", "444"],
                          metadata_id: "4d39824a-6a5d-4020-bc88-a0bb3d3e28e6"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "category",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [],
                        ogcServer: "source for config://my_maps?category_id=18"
                      },
                      {
                        id: 246,
                        name: "tour_sentiers_syndicats",
                        metadata: {
                          is_queryable: true,
                          linked_layers: ["667", "444"],
                          metadata_id: "3e98c2a3-b991-4b11-b3cc-d18aaf6eac80"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "category",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [],
                        ogcServer: "source for config://my_maps?category_id=19"
                      }
                    ],
                    metadata: {
                      is_expanded: true
                    },
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1869,
            name: "npour_radwege_group",
            children: [
              {
                id: 281,
                name: "tour_velo_v2",
                children: [
                  {
                    id: 808,
                    name: "velo_by_pch",
                    metadata: {
                      is_queryable: true,
                      legend_name: "tour_velo_national",
                      metadata_id: "387f6949-0fc4-43a5-b0e6-4e09bdf65225"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "velo_by_pch",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "velo_by_pch__1"
                      },
                      {
                        name: "velo_by_pch__0"
                      }
                    ]
                  },
                  {
                    id: 512,
                    name: "tour_pistes_velo_mymaps2",
                    metadata: {
                      is_queryable: true,
                      legend_name: "tour_velo_national",
                      metadata_id: "8e3c102a-393e-4d48-a321-9f8957ff49cf"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=106"
                  },
                  {
                    id: 809,
                    name: "lvi_circuits_cyclables",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "8ae3eb00-4f7d-40e7-b7e0-c913fb70b2b9"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=117,501"
                  },
                  {
                    id: 293,
                    name: "tour_pistes_vtt",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "fbc9cdfe-c3f4-4f75-960e-169973fb020c"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=8"
                  },
                  {
                    id: 676,
                    name: "tour_velo_route",
                    metadata: {
                      is_queryable: true,
                      linked_layers: ["667", "444"],
                      metadata_id: "b2e4a860-73cf-455c-95ff-2ccdf69186ed"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=107"
                  },
                  {
                    id: 1650,
                    name: "unseco_biketour",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "eda8222e-b76f-4016-8fea-87b27d0f622f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=501"
                  },
                  {
                    id: 725,
                    name: "tour_tdl",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "35226642-3f09-4f98-86b6-6e55316bce53"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "category",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [],
                    ogcServer: "source for config://my_maps?category_id=33"
                  },
                  {
                    id: 1913,
                    name: "tour_restrictions_velo",
                    children: [
                      {
                        id: 1713,
                        name: "chantiers_actuels_pc",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "7d59f3a6-e8d8-464b-bbf9-73c6ca358a51",
                          start_opacity: 1
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "chantiers_actuels_pc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "chantiers_actuels_pc__CHANTIERS_ACTUEL_PC"
                          }
                        ]
                      },
                      {
                        id: 1714,
                        name: "chantiers_futurs_pc",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "f6b9df36-5e62-46d1-ae91-c7c58c7e2e45",
                          start_opacity: 1
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "chantiers_futurs_pc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "chantiers_futurs_pc__CHANTIERS_FUTUR_PC"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1870,
            name: "npour_infrastruktur",
            children: [
              {
                id: 1871,
                name: "npour_verkehrsnetze",
                children: [
                  {
                    id: 181,
                    name: "roads",
                    metadata: {
                      legend_name: "road_network:show",
                      metadata_id: "12627f90-f0f8-41b3-a56a-2e11a232ba59"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "roads",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "roads__ROADS_NOLABELS"
                      }
                    ]
                  },
                  {
                    id: 351,
                    name: "roads_labels",
                    metadata: {
                      metadata_id: "5d606cae-cbc6-44c3-a465-edb981e44a39"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "roads_labels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "roads_labels__ROADS_LABELS"
                      }
                    ]
                  },
                  {
                    id: 147,
                    name: "arrets_bus",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:arrets_de_bus",
                      metadata_id: "7318c6e8-bb63-40e0-9e40-46ae7b0dc266"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "arrets_bus",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "arrets_bus__0"
                      },
                      {
                        name: "arrets_bus__1"
                      }
                    ]
                  },
                  {
                    id: 813,
                    name: "cdt_lignes_all",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "bbe0523f-374d-4c94-a27d-7ce81d8bae3b"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "cdt_lignes_all",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "cdt_lignes_all__lignes_de_bus"
                      }
                    ]
                  },
                  {
                    id: 1381,
                    name: "chargy",
                    metadata: {
                      is_queryable: true,
                      legend_name: "chargy",
                      metadata_id: "801d732a-c285-4fcd-a043-c5220d6d7eef"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "chargy",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "chargy__chargy"
                      }
                    ]
                  },
                  {
                    id: 423,
                    name: "mobiliteit_cfl",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:cfl",
                      max_dpi: 128,
                      metadata_id: "0b3c42a2-275e-4519-b228-f407d46b8350"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobiliteit_cfl",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobiliteit_cfl__1"
                      }
                    ]
                  },
                  {
                    id: 377,
                    name: "mobiliteit_pr",
                    metadata: {
                      is_queryable: true,
                      legend_name: "mobiliteit:pr",
                      max_dpi: 128,
                      metadata_id: "9e0c97ae-aff9-41fc-9489-bbf97999163d"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "mobiliteit_pr",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "mobiliteit_pr__2"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1924,
            name: "npour_umwelt",
            children: [
              {
                id: 807,
                name: "zpin_group",
                children: [
                  {
                    id: 804,
                    name: "anf_zpin_declarees",
                    metadata: {
                      is_queryable: true,
                      legend_name: "anf:zpin_declarees",
                      metadata_id: "9439d9b1-eff6-47b5-a4c7-4c5bde2744f4"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_zpin_declarees",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_zpin_declarees__ZPIN_DECLAREES"
                      }
                    ]
                  },
                  {
                    id: 805,
                    name: "anf_zpin_a_declarer",
                    metadata: {
                      is_queryable: true,
                      legend_name: "anf:zpin_a_declarer",
                      metadata_id: "db53336b-1a33-4b1a-94a8-42a29b55ce45"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_zpin_a_declarer",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_zpin_a_declarer__ZPIN_A_DECLARER"
                      }
                    ]
                  },
                  {
                    id: 806,
                    name: "anf_zpin_en_procedure",
                    metadata: {
                      is_queryable: true,
                      legend_name: "anf:zpin_en_procedure_reglementaire",
                      metadata_id: "74499cf0-ab69-48bd-a357-8c151dd3d5c9"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_zpin_en_procedure",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_zpin_en_procedure__ZPIN_EN_PROCEDURE_REGLEMENTAIRE"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 334,
                name: "env_zones_protegees_communautaires",
                children: [
                  {
                    id: 146,
                    name: "env_natura2000",
                    children: [
                      {
                        id: 1915,
                        name: "anf_communes_copil_2020",
                        metadata: {
                          is_queryable: true,
                          metadata_id: "e0369dfa-0219-4a60-84c4-4ce60cec0a02"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "anf_communes_copil_2020",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "anf_communes_copil_2020__COMMUNES_COPIL_2020"
                          }
                        ]
                      },
                      {
                        id: 540,
                        name: "natura2000_habitats",
                        metadata: {
                          is_queryable: true,
                          max_dpi: 128,
                          metadata_id: "080b7d2e-f8d5-4943-8dbf-04d3dfd4fe09"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "natura2000_habitats",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "natura2000_habitats__2"
                          },
                          {
                            name: "natura2000_habitats__0"
                          }
                        ]
                      },
                      {
                        id: 533,
                        name: "natura2000_oiseaux",
                        metadata: {
                          is_queryable: true,
                          max_dpi: 128,
                          metadata_id: "080b7d2e-f8d5-4943-8dbf-04d3dfd4fe09"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "natura2000_oiseaux",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "natura2000_oiseaux__1"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 180,
                name: "anf_secteurs_ecologiques_group",
                children: [
                  {
                    id: 690,
                    name: "anf_secteurs_ecologiques",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "8afa4162-c23b-4001-b737-4074d4f5360f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_secteurs_ecologiques",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_secteurs_ecologiques__SECTEURS_ECOLOGIQUES"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 366,
                name: "emwelt_biotop_kadaster",
                children: [
                  {
                    id: 1367,
                    name: "anf_biotopes_points",
                    metadata: {
                      is_queryable: true,
                      legend_name: "env:btk_p",
                      metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_biotopes_points",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_biotopes_points__BIOTOPES_MO_EL_PONCTUELS"
                      }
                    ]
                  },
                  {
                    id: 1368,
                    name: "anf_biotopes_vergers",
                    metadata: {
                      is_queryable: true,
                      legend_name: "env:btk_s",
                      metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_biotopes_vergers",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_biotopes_vergers__BIOTOPES_MO_VERGERS"
                      }
                    ]
                  },
                  {
                    id: 1369,
                    name: "anf_biotopes_surfaces",
                    metadata: {
                      is_queryable: true,
                      legend_name: "env:btk_f",
                      metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_biotopes_surfaces",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_biotopes_surfaces__BIOTOPES_MO_SURFACES"
                      }
                    ]
                  },
                  {
                    id: 1370,
                    name: "anf_biotopes_tampons",
                    metadata: {
                      is_queryable: true,
                      legend_name: "env:btk_b",
                      metadata_id: "f46eace4-8a83-4fa5-b2dd-a417a46fc720"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "anf_biotopes_tampons",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "anf_biotopes_tampons__BIOTOPES_MO_ZONES_TAMPONS"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1872,
            name: "npour_agri",
            children: [
              {
                id: 307,
                name: "asta",
                children: [
                  {
                    id: 1637,
                    name: "asta_flik_parcels",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "f511a4ee-928a-4900-ac05-52aa0ce03bba"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "asta_flik_parcels",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "asta_flik_parcels__3"
                      }
                    ]
                  },
                  {
                    id: 1511,
                    name: "asta_prairies_permanentes",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "f6f493c2-f57b-419d-8953-ab8018576ac7"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "asta_prairies_permanentes",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "asta_prairies_permanentes__0"
                      }
                    ]
                  },
                  {
                    id: 740,
                    name: "asta_herbages_sensibles",
                    metadata: {
                      metadata_id: "e5d2717e-4541-43f1-b586-1b18cdf11827"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "asta_herbages_sensibles",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "asta_herbages_sensibles__gruenland"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1873,
            name: "npour_eau",
            children: [
              {
                id: 1874,
                name: "npour_eau_surface",
                children: [
                  {
                    id: 749,
                    name: "eau_new_Gew\xE4sser",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:primaere_gewaesser_sekundaere_gewaesser_temporaer_fliessende_baeche",
                      metadata_id: "9da34ec3-89d5-4731-b927-e38ed8088571"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Gew\xE4sser",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Gew\xE4sser__Prim\xE4re Gew\xE4sser"
                      },
                      {
                        name: "eau_new_Gew\xE4sser__Sekund\xE4re Gew\xE4sser"
                      },
                      {
                        name: "eau_new_Gew\xE4sser__Tempor\xE4r fliessende B\xE4che"
                      }
                    ]
                  },
                  {
                    id: 651,
                    name: "eau_new_Kanal_-__Muehlgraben",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:kanal_-__muehlgraben",
                      max_dpi: 128,
                      metadata_id: "909501fc-a0a9-4af8-8e82-f2a8d7f2fe2f"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Kanal_-__Muehlgraben",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Kanal_-__Muehlgraben__Kanal -  M\xFChlgraben"
                      }
                    ]
                  },
                  {
                    id: 750,
                    name: "eau_new_Kilometrierung der Gew\xE4sser",
                    metadata: {
                      legend_name: "eau:kilometrierung_primaere_gewaesser_kilometrierung_sekundaere_gewaesser",
                      metadata_id: "4002b1cf-08b5-421a-bc92-40271d62f03c"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Kilometrierung der Gew\xE4sser",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Kilometrierung der Gew\xE4sser__Kilometrierung prim\xE4re Gew\xE4sser"
                      },
                      {
                        name: "eau_new_Kilometrierung der Gew\xE4sser__Kilometrierung sekund\xE4re Gew\xE4sser"
                      }
                    ]
                  },
                  {
                    id: 636,
                    name: "eau_new_Einzugsgebiete",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:einzugsgebiete",
                      max_dpi: 128,
                      metadata_id: "a295a30a-f819-400c-842c-d0ccc695bea5"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Einzugsgebiete",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Einzugsgebiete__Einzugsgebiete"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1875,
                name: "npour_eau_souterraine",
                children: [
                  {
                    id: 628,
                    name: "eau_new_Bohrungen",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:bohrungen",
                      max_dpi: 128,
                      metadata_id: "4ab49f17-a50e-4439-9a9e-01ec93421aec"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Bohrungen",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Bohrungen__39"
                      }
                    ]
                  },
                  {
                    id: 629,
                    name: "eau_new_Quellen",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:quellen",
                      max_dpi: 128,
                      metadata_id: "58fa573a-a0c3-474d-9e74-c277cf90b135"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Quellen",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Quellen__Quellen"
                      }
                    ]
                  },
                  {
                    id: 631,
                    name: "eau_new_Grundwasserleiter",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:grundwasserleiter",
                      max_dpi: 128,
                      metadata_id: "783a8608-e4b3-44ed-8864-68525da33760"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Grundwasserleiter",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Grundwasserleiter__Grundwasserleiter"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1876,
                name: "npour_eau_zps",
                children: [
                  {
                    id: 214,
                    name: "eau_new_Provisorische_ZPS",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:provisorische_zps",
                      max_dpi: 128,
                      metadata_id: "ddc51f25-2fb7-4d14-866a-a08f8af8ef03"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Provisorische_ZPS",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Provisorische_ZPS__Provisorische ZPS"
                      }
                    ]
                  },
                  {
                    id: 664,
                    name: "eau_new_ZPS_laufende_oeffentliche_Verfahrungsweise",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:zps_laufende_oeffentliche_verfahrungsweise",
                      max_dpi: 128,
                      metadata_id: "87beb1ac-7496-48f6-b5a9-8666e3897523"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_ZPS_laufende_oeffentliche_Verfahrungsweise",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_ZPS_laufende_oeffentliche_Verfahrungsweise__ZPS laufende \xF6ffentliche Verfahrungsweise"
                      }
                    ]
                  },
                  {
                    id: 573,
                    name: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:zps_durch_grosshrzgl._verordnung_festgelegt",
                      max_dpi: 128,
                      metadata_id: "d70f99e0-6032-4a4b-b516-5dfdfce33b26"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt__ZPS durch grosshrzgl. Verordnung festgelegt"
                      }
                    ]
                  },
                  {
                    id: 1464,
                    name: "eau_prgd_zones_protection_lac",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:prgd_stausee",
                      metadata_id: "eab29425-71cc-4610-b48e-8d848d0a8431"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_prgd_zones_protection_lac",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_prgd_zones_protection_lac__PRGD Schutzzonen Stausee"
                      }
                    ]
                  },
                  {
                    id: 490,
                    name: "eau_new_Sanitaere_Schutzzonen_Stausee_EschSauer",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:sanitaere_schutzzonen_stausee",
                      max_dpi: 128,
                      metadata_id: "e34de488-68ea-48a8-9e92-f67bb209508e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Sanitaere_Schutzzonen_Stausee_EschSauer",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Sanitaere_Schutzzonen_Stausee_EschSauer__Sanit\xE4re Schutzzonen Stausee"
                      }
                    ]
                  },
                  {
                    id: 559,
                    name: "eau_new_Zones_interdiction_utilisation_metazachlore",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau_new:metazachlore",
                      max_dpi: 128,
                      metadata_id: "803e93f8-588f-4697-8d76-972be1ad3531",
                      start_opacity: 0.7
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Zones_interdiction_utilisation_metazachlore",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Zones_interdiction_utilisation_metazachlore__Zones interdiction utilisation metazachlore"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1877,
                name: "npour_eau_protection",
                children: [
                  {
                    id: 643,
                    name: "eau_new_Abwassersyndikate",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:abwassersyndikate",
                      max_dpi: 128,
                      metadata_id: "4b5e384c-5603-4cf4-9bd5-6e520df5c375"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Abwassersyndikate",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Abwassersyndikate__Abwassersyndikate"
                      }
                    ]
                  },
                  {
                    id: 645,
                    name: "eau_new_Klaeranlagen",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:klaeranlagen",
                      max_dpi: 128,
                      metadata_id: "53e55765-90eb-438f-a744-3ac878b06334"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Klaeranlagen",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Klaeranlagen__Kl\xE4ranlagen"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          display_in_switcher: true
        }
      },
      {
        id: 2177,
        name: "geosciences",
        icon: "https://map.geoportail.lu/static/0b3affb2592f45f6a379cac74b45a07e/images/blank.png",
        children: [
          {
            id: 2178,
            name: "geo_geologie_group",
            children: [
              {
                id: 2167,
                name: "geo_carte_geol_harmonisee",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:geologie_harmonisee",
                  metadata_id: "542a0caa-4b33-4019-8ce7-b8541b436106"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_carte_geol_harmonisee",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_carte_geol_harmonisee__Unit\xE9s_g\xE9ologiques2495"
                  },
                  {
                    name: "geo_carte_geol_harmonisee__Symbole"
                  },
                  {
                    name: "geo_carte_geol_harmonisee__Failles"
                  },
                  {
                    name: "geo_carte_geol_harmonisee__Contours"
                  }
                ]
              },
              {
                id: 2168,
                name: "geo_carte_geol_harmonisee_decouverte",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:geologie_harmonisee_decouverte",
                  metadata_id: "d03be720-e33c-4bd4-8829-559dc951dc2d"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_carte_geol_harmonisee_decouverte",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_carte_geol_harmonisee_decouverte__Unit\xE9s_g\xE9ologiques:_Substratum_rocheux9983"
                  },
                  {
                    name: "geo_carte_geol_harmonisee_decouverte__Symbole"
                  },
                  {
                    name: "geo_carte_geol_harmonisee_decouverte__Failles"
                  },
                  {
                    name: "geo_carte_geol_harmonisee_decouverte__Contours"
                  }
                ]
              },
              {
                id: 2185,
                name: "geo_carte_detail_25k",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:geo25k_ned",
                  metadata_id: "f8e6c6ca-948a-404e-9d15-54d9a423627b"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_carte_detail_25k",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_carte_detail_25k__geologie_detail_nouv_edition"
                  }
                ]
              },
              {
                id: 2186,
                name: "geo_carte_generale_100k",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:geologie_generale",
                  metadata_id: "61b929b6-7964-449d-bc3e-87483a7997f5"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_carte_generale_100k",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_carte_generale_100k__geologie_generale"
                  }
                ]
              },
              {
                id: 2169,
                name: "geo_carte_geol_simplifiee",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:geologie_simplifiee",
                  metadata_id: "d5235bf1-96c8-4fc8-8d6d-2a0cde246aad"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_carte_geol_simplifiee",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_carte_geol_simplifiee__geologie_simplifiee_substratum"
                  },
                  {
                    name: "geo_carte_geol_simplifiee__geologie_simplifiee_form_sup"
                  },
                  {
                    name: "geo_carte_geol_simplifiee__geologie_simplifiee_failles"
                  }
                ]
              },
              {
                id: 2170,
                name: "geo_carte_geol_simplifiee_decouverte",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:geologie_simplifiee_decouverte",
                  metadata_id: "d8d627ee-ec11-4054-8a05-f4cd98adbd72"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_carte_geol_simplifiee_decouverte",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_carte_geol_simplifiee_decouverte__geologie_simplifiee_failles"
                  },
                  {
                    name: "geo_carte_geol_simplifiee_decouverte__geologie_simplifiee_substratum"
                  }
                ]
              },
              {
                id: 2199,
                name: "geo_cartes_geologiques_historiques",
                children: [
                  {
                    id: 2202,
                    name: "geo_geologie_wies_siegen",
                    metadata: {
                      is_queryable: true,
                      legend_name: "geol:geologie_wies_siegen",
                      metadata_id: "f595fd68-0036-433f-ae93-2bbace506f0a"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "geo_geologie_wies_siegen",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "geo_geologie_wies_siegen__geologie_wies_siegen"
                      }
                    ]
                  },
                  {
                    id: 2203,
                    name: "geo_geologie_van_werweke",
                    metadata: {
                      is_queryable: true,
                      legend_name: "geol:geologie_van_werweke",
                      metadata_id: "5156b574-f67c-4bee-b349-e769581fe079"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "geo_geologie_van_werweke",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "geo_geologie_van_werweke__geologie_van_werweke"
                      }
                    ]
                  },
                  {
                    id: 2204,
                    name: "geo_geologie_lucius",
                    metadata: {
                      is_queryable: true,
                      legend_name: "geol:geologie_lucius",
                      metadata_id: "34e148cb-7d47-455a-8d5f-0f2623ab6a4e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "geo_geologie_lucius",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "geo_geologie_lucius__geologie_lucius"
                      }
                    ]
                  },
                  {
                    id: 2205,
                    name: "geo_geologie_robert",
                    metadata: {
                      is_queryable: true,
                      legend_name: "geol:geologie_robert",
                      metadata_id: "a299b930-a36c-4709-8712-b52cfd7c9fa1"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "geo_geologie_robert",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "geo_geologie_robert__geologie_robert"
                      }
                    ]
                  },
                  {
                    id: 2206,
                    name: "geo_geologie_detail_anc_edition",
                    metadata: {
                      is_queryable: true,
                      legend_name: "geol:geo25_50k_aed",
                      metadata_id: "a3342917-2a84-48ee-bf20-668810bb4c80"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "geo_geologie_detail_anc_edition",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "geo_geologie_detail_anc_edition__geologie_detail_anc_edition"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2173,
                name: "geo_coupes_geologiques",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:coupes_geologiques",
                  metadata_id: "8a35490a-8dc8-4dfd-9136-edfdd6d08281"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_coupes_geologiques",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_coupes_geologiques__coupes_geologiques"
                  }
                ]
              },
              {
                id: 2175,
                name: "geo_epaisseurs_unites",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:epaisseurs_unites",
                  metadata_id: "3fab8010-2f8b-43e2-96a7-155a24233db4"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_epaisseurs_unites",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_epaisseurs_unites__epaisseurs_unites"
                  }
                ]
              },
              {
                id: 2201,
                name: "geo_forages_group",
                children: [
                  {
                    id: 2176,
                    name: "geo_forages_ref",
                    metadata: {
                      is_queryable: true,
                      legend_name: "geol:forages_ref",
                      metadata_id: "0564eda7-c92d-4a80-b3c7-be94f5d67186"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "geo_forages_ref",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "geo_forages_ref__forages_ref"
                      }
                    ]
                  },
                  {
                    id: 628,
                    name: "eau_new_Bohrungen",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:bohrungen",
                      max_dpi: 128,
                      metadata_id: "4ab49f17-a50e-4439-9a9e-01ec93421aec"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Bohrungen",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Bohrungen__39"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2200,
                name: "geo_eaux_souterraines",
                children: [
                  {
                    id: 631,
                    name: "eau_new_Grundwasserleiter",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:grundwasserleiter",
                      max_dpi: 128,
                      metadata_id: "783a8608-e4b3-44ed-8864-68525da33760"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Grundwasserleiter",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Grundwasserleiter__Grundwasserleiter"
                      }
                    ]
                  },
                  {
                    id: 629,
                    name: "eau_new_Quellen",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:quellen",
                      max_dpi: 128,
                      metadata_id: "58fa573a-a0c3-474d-9e74-c277cf90b135"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_Quellen",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_Quellen__Quellen"
                      }
                    ]
                  },
                  {
                    id: 573,
                    name: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt",
                    metadata: {
                      is_queryable: true,
                      legend_name: "eau:zps_durch_grosshrzgl._verordnung_festgelegt",
                      max_dpi: 128,
                      metadata_id: "d70f99e0-6032-4a4b-b516-5dfdfce33b26"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt",
                    imageType: "image/png",
                    style: "default",
                    childLayers: [
                      {
                        name: "eau_new_ZPS_durch_grosshrzgl._Verordnung_festgelegt__ZPS durch grosshrzgl. Verordnung festgelegt"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2191,
                name: "geo_geomorphologie_carte100K",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:geomorphologie100k",
                  metadata_id: "3fd5088b-021d-4207-9d4b-4040e1ccfe22"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_geomorphologie_carte100K",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_geomorphologie_carte100K__geomorphologie100k"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 2182,
            name: "geo_geophysique_group",
            children: [
              {
                id: 2192,
                name: "geo_geophysique_comptage_uranium",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:geophysique_aeroportee_uranium",
                  metadata_id: "6b9443de-b85c-4360-9c3b-b937c5804303"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_geophysique_comptage_uranium",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_geophysique_comptage_uranium__comptage_uranium"
                  }
                ]
              },
              {
                id: 2193,
                name: "geo_geophysique_comptage_thorium",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:geophysique_aeroportee_thorium",
                  metadata_id: "335aec3a-52e5-49c4-8325-cd57b0751b47"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_geophysique_comptage_thorium",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_geophysique_comptage_thorium__comptage_thorium"
                  }
                ]
              },
              {
                id: 2194,
                name: "geo_geophysique_comptage_potassium",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:geophysique_aeroportee_potassium",
                  metadata_id: "39b205a1-2a16-44fe-9a16-c6e1fdd60084"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_geophysique_comptage_potassium",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_geophysique_comptage_potassium__comptage_potassium"
                  }
                ]
              },
              {
                id: 2195,
                name: "geo_geophysique_synthese_uthk",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:geophysique_aeroportee_uthk",
                  metadata_id: "bcbbc55a-e6b7-4b5a-ac62-dc5ce8b0825a"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_geophysique_synthese_uthk",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_geophysique_synthese_uthk__synthese_uthk"
                  }
                ]
              },
              {
                id: 2196,
                name: "geo_geophysique_champ_vlf",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:geophysique_aeroportee_vlf",
                  metadata_id: "ce816301-b6eb-480a-a891-6d394b635ff7"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_geophysique_champ_vlf",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_geophysique_champ_vlf__champ_vlf"
                  }
                ]
              },
              {
                id: 2197,
                name: "geo_geophysique_champ_total",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:geophysique_aeroportee_total_residuel",
                  metadata_id: "efcea741-1392-4c97-8233-3d31b64eb82a"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_geophysique_champ_total",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_geophysique_champ_total__champ_total"
                  }
                ]
              },
              {
                id: 2198,
                name: "geo_geophysique_champ_total_reduit_pole",
                metadata: {
                  is_queryable: true,
                  legend_name: "geol:geophysique_aeroportee_total_residuel_reduit_pole",
                  metadata_id: "b1b387a3-96d2-4a4b-9a1f-0add1712840c"
                },
                dimensions: {},
                type: "WMS",
                layers: "geo_geophysique_champ_total_reduit_pole",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "geo_geophysique_champ_total_reduit_pole__champ_total_reduit_pole"
                  }
                ]
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 321,
            name: "pedologie",
            children: [
              {
                id: 272,
                name: "pedologie_100k",
                metadata: {
                  legend_name: "pedologie",
                  metadata_id: "2d712a34-ce79-426d-a57b-b7cadf97b80f"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR",
                layer: "pedologie_100k",
                imageType: "image/png"
              },
              {
                id: 702,
                name: "asta_pedologie_new",
                metadata: {
                  legend_name: "pedologie_new",
                  max_dpi: 128,
                  metadata_id: "37686d89-0173-4040-88c7-be84a3648d01"
                },
                dimensions: {},
                type: "WMS",
                layers: "asta_pedologie_new",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "asta_pedologie_new__1"
                  },
                  {
                    name: "asta_pedologie_new__2"
                  },
                  {
                    name: "asta_pedologie_new__3"
                  },
                  {
                    name: "asta_pedologie_new__4"
                  },
                  {
                    name: "asta_pedologie_new__5"
                  },
                  {
                    name: "asta_pedologie_new__6"
                  },
                  {
                    name: "asta_pedologie_new__7"
                  }
                ]
              },
              {
                id: 704,
                name: "asta_pedologie_humus",
                metadata: {
                  legend_name: "asta_corg",
                  max_dpi: 128,
                  metadata_id: "a1b0807c-9bff-4f6a-a5e7-130316742f56"
                },
                dimensions: {},
                type: "WMS",
                layers: "asta_pedologie_humus",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "asta_pedologie_humus__0"
                  }
                ]
              },
              {
                id: 703,
                name: "asta_pedologie_ph",
                metadata: {
                  legend_name: "asta_ph",
                  max_dpi: 128,
                  metadata_id: "628ee73f-4c37-4689-bc4c-1fd9f6bd2663"
                },
                dimensions: {},
                type: "WMS",
                layers: "asta_pedologie_ph",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "asta_pedologie_ph__0"
                  }
                ]
              },
              {
                id: 2408,
                name: "asta_erosion_group",
                children: [
                  {
                    id: 2407,
                    name: "asta_erosion_2023",
                    metadata: {
                      is_queryable: true,
                      metadata_id: "427aff9b-b988-455c-8cd9-1c029cfd6b6e"
                    },
                    dimensions: {},
                    type: "WMS",
                    layers: "asta_erosion_2023",
                    imageType: "image/png",
                    childLayers: [
                      {
                        name: "asta_erosion_2023__0"
                      }
                    ]
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 2183,
            name: "geo_relief_group",
            children: [
              {
                id: 1460,
                name: "wg_relief_map",
                metadata: {
                  metadata_id: "7d195815-23c2-4963-863c-60e3a39ab8af"
                },
                dimensions: {},
                type: "WMS",
                layers: "wg_relief_map",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "wg_relief_map__0"
                  }
                ]
              },
              {
                id: 1461,
                name: "wg_hangneigung_map",
                metadata: {
                  legend_name: "wg:hangneigung",
                  metadata_id: "6ffa94a4-af02-43ec-82e0-6796cd01a948"
                },
                dimensions: {},
                type: "WMS",
                layers: "wg_hangneigung_map",
                imageType: "image/png",
                style: "default",
                childLayers: [
                  {
                    name: "wg_hangneigung_map__0"
                  }
                ]
              },
              {
                id: 1795,
                name: "lidar_2019_mnt_public",
                metadata: {
                  legend_name: "lidar:mnt2019",
                  metadata_id: "ba62d5be-9c71-406a-8b46-a36bfaa36357"
                },
                dimensions: {},
                type: "WMTS",
                url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
                style: "default",
                matrixSet: "GLOBAL_WEBMERCATOR_4_V3",
                layer: "lidar_2019_mnt_public",
                imageType: "image/png"
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 2184,
            name: "geo_decouverte_group",
            children: [
              {
                id: 2021,
                name: "tour_rando_natur_geologie_new",
                metadata: {
                  is_queryable: true
                },
                dimensions: {},
                type: "WMS",
                layers: "category",
                imageType: "image/png",
                style: "default",
                childLayers: [],
                ogcServer: "source for config://my_maps?category_id=123"
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          display_in_switcher: true
        }
      },
      {
        id: 2332,
        name: "3D Layers",
        icon: "https://map.geoportail.lu/static/0b3affb2592f45f6a379cac74b45a07e/images/blank.png",
        children: [
          {
            id: 1958,
            name: "3d Layers",
            children: [
              {
                id: 2346,
                name: "ACT2022_BD_L_BATI3D_LOD2",
                metadata: {
                  exclusion: '["mesh_2020_vs_bd-l-bati-3d"]',
                  metadata_id: "2e8b722a-87ea-4b62-a307-423832adabab",
                  ol3d_defaultlayer: true
                },
                dimensions: {},
                type: "WMTS",
                url: "https://acts3.geoportail.lu/3d-data/3d-tiles",
                layer: "ACT2022_BD_L_BATI3D_LOD2",
                imageType: "image/png"
              },
              {
                id: 2348,
                name: "VDL2022_LOD2_IMPORT",
                metadata: {
                  exclusion: '["mesh_2020_vs_bd-l-bati-3d_vdl"]',
                  metadata_id: "a116f21e-faf1-4bdd-9a29-064fd9a30b8d",
                  ol3d_defaultlayer: true
                },
                dimensions: {},
                type: "WMTS",
                url: "https://acts3.geoportail.lu/3d-data/3d-tiles",
                layer: "VDL2022_LOD2_IMPORT_old",
                imageType: "image/png"
              },
              {
                id: 2350,
                name: "VDL2022_BRIDGES_IMPORT",
                metadata: {
                  exclusion: '["mesh_2020_vs_bridges_vdl"]',
                  metadata_id: "95c91657-5d7b-4b1f-bc74-de0e2db0f5c7",
                  ol3d_defaultlayer: true
                },
                dimensions: {},
                type: "WMTS",
                url: "https://acts3.geoportail.lu/3d-data/3d-tiles",
                layer: "Bridges_LOD2",
                imageType: "image/png"
              },
              {
                id: 2397,
                name: "ACT2019_LiDAR_Bridges",
                metadata: {
                  exclusion: '["mesh_2020_vs_bridges_ACT"]',
                  metadata_id: "0690e5cb-50df-4cf8-8cf3-d12dbecfc171",
                  ol3d_defaultlayer: true
                },
                dimensions: {},
                type: "WMTS",
                url: "https://acts3.geoportail.lu/3d-data/3d-tiles",
                layer: "ACT2019_LiDAR_Bridges_LOD1",
                imageType: "image/png"
              },
              {
                id: 2384,
                name: "ACT2019_LiDAR_Vegetation",
                metadata: {
                  exclusion: '["mesh_2020_vs_trees"]',
                  metadata_id: "99180a32-bf64-46c2-b901-ce055b0f01fe",
                  ol3d_defaultlayer: true
                },
                dimensions: {},
                type: "WMTS",
                url: "https://acts3.geoportail.lu/3d-data/3d-tiles",
                layer: "ACT2019_LiDAR_Vegetation",
                imageType: "image/png"
              }
            ],
            metadata: {
              display_in_switcher: true,
              is_expanded: true
            },
            mixed: true
          },
          {
            id: 2410,
            name: "TDL2022",
            children: [
              {
                id: 2409,
                name: "TDL2022_path_all_stages",
                metadata: {
                  linked_layers: ["725"],
                  ol3d_defaultlayer: true
                },
                dimensions: {},
                type: "WMTS",
                url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_path",
                layer: "all_stages",
                imageType: "image/png"
              },
              {
                id: 2413,
                name: "TDL2022_points_km_all_stages",
                metadata: {
                  ol3d_defaultlayer: true
                },
                dimensions: {},
                type: "WMTS",
                url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_points_km",
                layer: "point_km_all_stages",
                imageType: "image/png"
              },
              {
                id: 2415,
                name: "TDL2022_stage2",
                children: [
                  {
                    id: 2420,
                    name: "TDL2022_barriers_stage2",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_barriers",
                    layer: "barriers_stage2",
                    imageType: "image/png"
                  },
                  {
                    id: 2424,
                    name: "TDL2022_points_km_stage2",
                    metadata: {
                      ol3d_defaultlayer: false
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_points_km",
                    layer: "points_km_stage2",
                    imageType: "image/png"
                  },
                  {
                    id: 2429,
                    name: "TDL2022_path_stage2",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_path",
                    layer: "path_stage2",
                    imageType: "image/png"
                  },
                  {
                    id: 2435,
                    name: "TDL2022_cyclistes_stage2",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_cyclistes",
                    layer: "cyclistes_stage2",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2416,
                name: "TDL2022_stage3",
                children: [
                  {
                    id: 2421,
                    name: "TDL2022_barriers_stage3",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_barriers",
                    layer: "barriers_stage3",
                    imageType: "image/png"
                  },
                  {
                    id: 2425,
                    name: "TDL2022_points_km_stage3",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_points_km",
                    layer: "points_km_stage3",
                    imageType: "image/png"
                  },
                  {
                    id: 2430,
                    name: "TDL2022_path_stage3",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_path",
                    layer: "path_stage3",
                    imageType: "image/png"
                  },
                  {
                    id: 2436,
                    name: "TDL2022_cyclistes_stage3",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_cyclistes",
                    layer: "cyclistes_stage3",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2417,
                name: "TDL2022_stage4",
                children: [
                  {
                    id: 2422,
                    name: "TDL2022_barriers_stage4",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_barriers",
                    layer: "barriers_stage4",
                    imageType: "image/png"
                  },
                  {
                    id: 2426,
                    name: "TDL2022_points_km_stage4",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_points_km",
                    layer: "points_km_stage4",
                    imageType: "image/png"
                  },
                  {
                    id: 2431,
                    name: "TDL2022_path_stage4",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_path",
                    layer: "path_stage4",
                    imageType: "image/png"
                  },
                  {
                    id: 2433,
                    name: "TDL2022_cyclistes_stage4",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_cyclistes",
                    layer: "cyclistes_stage4",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2414,
                name: "TDL2022_stage1",
                children: [
                  {
                    id: 2412,
                    name: "TDL2022_barriers_stage1",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_barriers",
                    layer: "barriers_stage1",
                    imageType: "image/png"
                  },
                  {
                    id: 2423,
                    name: "TDL2022_points_km_stage1",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_points_km",
                    layer: "points_km_stage1",
                    imageType: "image/png"
                  },
                  {
                    id: 2428,
                    name: "TDL2022_path_stage1",
                    metadata: {
                      exclusion: '["mesh_2020_vs_bridges_ACT"]',
                      linked_layers: ["725"],
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_path",
                    layer: "path_stage1",
                    imageType: "image/png"
                  },
                  {
                    id: 2434,
                    name: "TDL2022_cyclistes_stage1",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_cyclistes",
                    layer: "cyclistes_stage1",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 2418,
                name: "TDL2022_stage5",
                children: [
                  {
                    id: 2419,
                    name: "TDL2022_barriers_stage5",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_barriers",
                    layer: "barriers_stage5",
                    imageType: "image/png"
                  },
                  {
                    id: 2427,
                    name: "TDL2022_points_km_stage5",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_points_km",
                    layer: "points_km_stage5",
                    imageType: "image/png"
                  },
                  {
                    id: 2432,
                    name: "TDL2022_path_stage5",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_path",
                    layer: "path_stage5",
                    imageType: "image/png"
                  },
                  {
                    id: 2437,
                    name: "TDL2022_cyclistes_stage5",
                    metadata: {
                      ol3d_defaultlayer: true
                    },
                    dimensions: {},
                    type: "WMTS",
                    url: "https://acts3.geoportail.lu/3d-data/3d-tiles/TDL2022/TDL2022_cyclistes",
                    layer: "cyclistes_stage5",
                    imageType: "image/png"
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          ol3d_type: "data"
        }
      },
      {
        id: 824,
        name: "ahc",
        icon: "https://map.geoportail.lu/static/0b3affb2592f45f6a379cac74b45a07e/images/blank.png",
        children: [
          {
            id: 826,
            name: "30 years reference period 1971-2000",
            children: [
              {
                id: 827,
                name: "Precipitation",
                children: [
                  {
                    id: 828,
                    name: "lux_norm1971_2000_pluvio_sum",
                    children: [
                      {
                        id: 830,
                        name: "lux_norm1971_2000_00_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_norm1971_2000_00_pluvio_sum",
                          metadata_id: "0a4eda30-1a91-4c5c-98cf-63f1014e231d"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_norm1971_2000_00_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_norm1971_2000_00_pluvio_sum__lux_norm1971_2000_00_map_pluvio_sum"
                          },
                          {
                            name: "lux_norm1971_2000_00_pluvio_sum__lux_norm1971_2000_00_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 833,
                        name: "lux_norm1971_2000_01_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_norm1971_2000_01_pluvio_sum",
                          metadata_id: "fa45906d-bdde-488e-8bb7-606ff9d52d0a"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_norm1971_2000_01_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_norm1971_2000_01_pluvio_sum__lux_norm1971_2000_01_map_pluvio_sum"
                          },
                          {
                            name: "lux_norm1971_2000_01_pluvio_sum__lux_norm1971_2000_01_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 836,
                        name: "lux_norm1971_2000_02_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_norm1971_2000_02_pluvio_sum",
                          metadata_id: "1181434b-e302-4c24-8e20-beae617da834"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_norm1971_2000_02_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_norm1971_2000_02_pluvio_sum__lux_norm1971_2000_02_map_pluvio_sum"
                          },
                          {
                            name: "lux_norm1971_2000_02_pluvio_sum__lux_norm1971_2000_02_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 839,
                        name: "lux_norm1971_2000_03_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_norm1971_2000_03_pluvio_sum",
                          metadata_id: "6a331111-25e3-4369-9827-93dd6e53728a"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_norm1971_2000_03_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_norm1971_2000_03_pluvio_sum__lux_norm1971_2000_03_map_pluvio_sum"
                          },
                          {
                            name: "lux_norm1971_2000_03_pluvio_sum__lux_norm1971_2000_03_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 842,
                        name: "lux_norm1971_2000_04_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_norm1971_2000_04_pluvio_sum",
                          metadata_id: "2aac48e2-ff02-4fec-a7b6-a7a58ba3f9b5"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_norm1971_2000_04_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_norm1971_2000_04_pluvio_sum__lux_norm1971_2000_04_map_pluvio_sum"
                          },
                          {
                            name: "lux_norm1971_2000_04_pluvio_sum__lux_norm1971_2000_04_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 845,
                        name: "lux_norm1971_2000_05_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_norm1971_2000_05_pluvio_sum",
                          metadata_id: "f58f26b6-f4e8-456b-a7aa-5064f59d87ca"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_norm1971_2000_05_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_norm1971_2000_05_pluvio_sum__lux_norm1971_2000_05_map_pluvio_sum"
                          },
                          {
                            name: "lux_norm1971_2000_05_pluvio_sum__lux_norm1971_2000_05_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 848,
                        name: "lux_norm1971_2000_06_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_norm1971_2000_06_pluvio_sum",
                          metadata_id: "b416c8eb-510c-4285-bd00-049120b5310d"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_norm1971_2000_06_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_norm1971_2000_06_pluvio_sum__lux_norm1971_2000_06_map_pluvio_sum"
                          },
                          {
                            name: "lux_norm1971_2000_06_pluvio_sum__lux_norm1971_2000_06_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 851,
                        name: "lux_norm1971_2000_07_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_norm1971_2000_07_pluvio_sum",
                          metadata_id: "07483c69-8c1f-4090-b44a-8fc8c36ebf09"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_norm1971_2000_07_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_norm1971_2000_07_pluvio_sum__lux_norm1971_2000_07_map_pluvio_sum"
                          },
                          {
                            name: "lux_norm1971_2000_07_pluvio_sum__lux_norm1971_2000_07_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 854,
                        name: "lux_norm1971_2000_08_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_norm1971_2000_08_pluvio_sum",
                          metadata_id: "8b893722-4e44-45de-948d-caee741c8632"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_norm1971_2000_08_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_norm1971_2000_08_pluvio_sum__lux_norm1971_2000_08_map_pluvio_sum"
                          },
                          {
                            name: "lux_norm1971_2000_08_pluvio_sum__lux_norm1971_2000_08_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 857,
                        name: "lux_norm1971_2000_09_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_norm1971_2000_09_pluvio_sum",
                          metadata_id: "024de345-0d97-4356-a11a-48fc34f52def"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_norm1971_2000_09_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_norm1971_2000_09_pluvio_sum__lux_norm1971_2000_09_map_pluvio_sum"
                          },
                          {
                            name: "lux_norm1971_2000_09_pluvio_sum__lux_norm1971_2000_09_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 860,
                        name: "lux_norm1971_2000_10_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_norm1971_2000_10_pluvio_sum",
                          metadata_id: "c3646551-bc0e-4cea-b468-a10dbd7ce429"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_norm1971_2000_10_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_norm1971_2000_10_pluvio_sum__lux_norm1971_2000_10_map_pluvio_sum"
                          },
                          {
                            name: "lux_norm1971_2000_10_pluvio_sum__lux_norm1971_2000_10_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 863,
                        name: "lux_norm1971_2000_11_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_norm1971_2000_11_pluvio_sum",
                          metadata_id: "a177f78a-3db2-4c3a-af82-8fc9ea56dfca"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_norm1971_2000_11_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_norm1971_2000_11_pluvio_sum__lux_norm1971_2000_11_map_pluvio_sum"
                          },
                          {
                            name: "lux_norm1971_2000_11_pluvio_sum__lux_norm1971_2000_11_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 866,
                        name: "lux_norm1971_2000_12_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_norm1971_2000_12_pluvio_sum",
                          metadata_id: "f812a2bd-87a7-4ec1-92af-2296d98c5e75"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_norm1971_2000_12_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_norm1971_2000_12_pluvio_sum__lux_norm1971_2000_12_map_pluvio_sum"
                          },
                          {
                            name: "lux_norm1971_2000_12_pluvio_sum__lux_norm1971_2000_12_samples_pluvio_sum"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 868,
            name: "2012",
            children: [
              {
                id: 869,
                name: "Temperature2",
                children: [
                  {
                    id: 870,
                    name: "lux_2012_temp_minimum",
                    children: [
                      {
                        id: 872,
                        name: "lux_2012_00_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2012_00_temp_minimum",
                          metadata_id: "f54b5868-f0f1-46dc-9bbc-92ae955437fe"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_00_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_00_temp_minimum__lux_2012_00_map_temp_minimum"
                          },
                          {
                            name: "lux_2012_00_temp_minimum__lux_2012_00_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 875,
                        name: "lux_2012_01_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2012_01_temp_minimum",
                          metadata_id: "90e182a4-606a-41f1-b1a8-31f32f81133f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_01_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_01_temp_minimum__lux_2012_01_map_temp_minimum"
                          },
                          {
                            name: "lux_2012_01_temp_minimum__lux_2012_01_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 878,
                        name: "lux_2012_02_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2012_02_temp_minimum",
                          metadata_id: "0e6f4745-dcc6-416e-bf77-d1d411d7bd60"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_02_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_02_temp_minimum__lux_2012_02_map_temp_minimum"
                          },
                          {
                            name: "lux_2012_02_temp_minimum__lux_2012_02_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 881,
                        name: "lux_2012_03_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2012_03_temp_minimum",
                          metadata_id: "85f0484d-342f-4ff3-ade4-adf7b94d7144"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_03_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_03_temp_minimum__lux_2012_03_map_temp_minimum"
                          },
                          {
                            name: "lux_2012_03_temp_minimum__lux_2012_03_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 884,
                        name: "lux_2012_04_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2012_04_temp_minimum",
                          metadata_id: "1630e042-c85a-4cde-9ce2-45394640b48c"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_04_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_04_temp_minimum__lux_2012_04_map_temp_minimum"
                          },
                          {
                            name: "lux_2012_04_temp_minimum__lux_2012_04_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 887,
                        name: "lux_2012_05_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2012_05_temp_minimum",
                          metadata_id: "14a98a2d-55cc-4e4c-b54b-38393a7969b1"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_05_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_05_temp_minimum__lux_2012_05_map_temp_minimum"
                          },
                          {
                            name: "lux_2012_05_temp_minimum__lux_2012_05_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 890,
                        name: "lux_2012_06_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2012_06_temp_minimum",
                          metadata_id: "06f73749-3790-4907-86f5-3e5b56f137fd"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_06_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_06_temp_minimum__lux_2012_06_map_temp_minimum"
                          },
                          {
                            name: "lux_2012_06_temp_minimum__lux_2012_06_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 893,
                        name: "lux_2012_07_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2012_07_temp_minimum",
                          metadata_id: "76754f40-ce9b-405e-a3fb-f6c1db259fd2"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_07_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_07_temp_minimum__lux_2012_07_map_temp_minimum"
                          },
                          {
                            name: "lux_2012_07_temp_minimum__lux_2012_07_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 896,
                        name: "lux_2012_08_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2012_08_temp_minimum",
                          metadata_id: "dfc10c11-0718-40e2-8174-c4a593726e3e"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_08_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_08_temp_minimum__lux_2012_08_map_temp_minimum"
                          },
                          {
                            name: "lux_2012_08_temp_minimum__lux_2012_08_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 899,
                        name: "lux_2012_09_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2012_09_temp_minimum",
                          metadata_id: "bc6f1456-15b7-4c8a-9a4b-011965df42ff"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_09_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_09_temp_minimum__lux_2012_09_map_temp_minimum"
                          },
                          {
                            name: "lux_2012_09_temp_minimum__lux_2012_09_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 902,
                        name: "lux_2012_10_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2012_10_temp_minimum",
                          metadata_id: "cf026e5c-69ee-4472-9c7d-93f9a4ca200f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_10_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_10_temp_minimum__lux_2012_10_map_temp_minimum"
                          },
                          {
                            name: "lux_2012_10_temp_minimum__lux_2012_10_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 905,
                        name: "lux_2012_11_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2012_11_temp_minimum",
                          metadata_id: "9c68b000-6bdf-46e7-a61e-531dc0b846d2"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_11_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_11_temp_minimum__lux_2012_11_map_temp_minimum"
                          },
                          {
                            name: "lux_2012_11_temp_minimum__lux_2012_11_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 908,
                        name: "lux_2012_12_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2012_12_temp_minimum",
                          metadata_id: "6656e377-b0d2-4239-b57b-a801c864c29a"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_12_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_12_temp_minimum__lux_2012_12_map_temp_minimum"
                          },
                          {
                            name: "lux_2012_12_temp_minimum__lux_2012_12_samples_temp_minimum"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 910,
                    name: "lux_2012_temp_average",
                    children: [
                      {
                        id: 912,
                        name: "lux_2012_00_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2012_00_temp_average",
                          metadata_id: "f67d6c9e-7eb3-4f45-8a87-593745c2014a"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_00_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_00_temp_average__lux_2012_00_map_temp_average"
                          },
                          {
                            name: "lux_2012_00_temp_average__lux_2012_00_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 915,
                        name: "lux_2012_01_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2012_01_temp_average",
                          metadata_id: "1343cbfa-8e50-4ad2-bf8e-ebf107eba015"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_01_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_01_temp_average__lux_2012_01_map_temp_average"
                          },
                          {
                            name: "lux_2012_01_temp_average__lux_2012_01_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 918,
                        name: "lux_2012_02_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2012_02_temp_average",
                          metadata_id: "b657e9ea-ffab-40c5-98f4-bb474029e5bd"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_02_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_02_temp_average__lux_2012_02_map_temp_average"
                          },
                          {
                            name: "lux_2012_02_temp_average__lux_2012_02_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 921,
                        name: "lux_2012_03_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2012_03_temp_average",
                          metadata_id: "e1759289-e639-4b59-9f72-29f47fde2e3f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_03_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_03_temp_average__lux_2012_03_map_temp_average"
                          },
                          {
                            name: "lux_2012_03_temp_average__lux_2012_03_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 924,
                        name: "lux_2012_04_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2012_04_temp_average",
                          metadata_id: "b0ac7707-7548-4723-9e88-9c593c22d7ca"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_04_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_04_temp_average__lux_2012_04_map_temp_average"
                          },
                          {
                            name: "lux_2012_04_temp_average__lux_2012_04_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 927,
                        name: "lux_2012_05_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2012_05_temp_average",
                          metadata_id: "ca97bd10-f8f5-48d7-9daa-a7ee461fe029"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_05_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_05_temp_average__lux_2012_05_map_temp_average"
                          },
                          {
                            name: "lux_2012_05_temp_average__lux_2012_05_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 930,
                        name: "lux_2012_06_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2012_06_temp_average",
                          metadata_id: "6112dd55-d6bf-4d39-bf13-4e94e35d0e29"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_06_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_06_temp_average__lux_2012_06_map_temp_average"
                          },
                          {
                            name: "lux_2012_06_temp_average__lux_2012_06_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 933,
                        name: "lux_2012_07_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2012_07_temp_average",
                          metadata_id: "2a8b5666-607c-4fe8-bc16-72a867f7344c"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_07_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_07_temp_average__lux_2012_07_map_temp_average"
                          },
                          {
                            name: "lux_2012_07_temp_average__lux_2012_07_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 936,
                        name: "lux_2012_08_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2012_08_temp_average",
                          metadata_id: "736dd14c-488e-4a75-b4c1-15e5ef5b815d"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_08_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_08_temp_average__lux_2012_08_map_temp_average"
                          },
                          {
                            name: "lux_2012_08_temp_average__lux_2012_08_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 939,
                        name: "lux_2012_09_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2012_09_temp_average",
                          metadata_id: "e35af491-251f-449e-b185-4edd3bfae0e5"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_09_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_09_temp_average__lux_2012_09_map_temp_average"
                          },
                          {
                            name: "lux_2012_09_temp_average__lux_2012_09_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 942,
                        name: "lux_2012_10_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2012_10_temp_average",
                          metadata_id: "575c1c75-088d-47e9-9f92-593a8faddf8f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_10_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_10_temp_average__lux_2012_10_map_temp_average"
                          },
                          {
                            name: "lux_2012_10_temp_average__lux_2012_10_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 945,
                        name: "lux_2012_11_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2012_11_temp_average",
                          metadata_id: "191bbb34-b6f6-46e4-961b-d299fc443f0e"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_11_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_11_temp_average__lux_2012_11_map_temp_average"
                          },
                          {
                            name: "lux_2012_11_temp_average__lux_2012_11_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 948,
                        name: "lux_2012_12_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2012_12_temp_average",
                          metadata_id: "994f64fa-f63e-4ca0-a3f8-e04c585ddcee"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_12_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_12_temp_average__lux_2012_12_map_temp_average"
                          },
                          {
                            name: "lux_2012_12_temp_average__lux_2012_12_samples_temp_average"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 950,
                    name: "lux_2012_temp_maximum",
                    children: [
                      {
                        id: 952,
                        name: "lux_2012_00_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2012_00_temp_maximum",
                          metadata_id: "d22c66f6-d4fa-481b-a9c7-2b5249d5c8d0"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_00_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_00_temp_maximum__lux_2012_00_map_temp_maximum"
                          },
                          {
                            name: "lux_2012_00_temp_maximum__lux_2012_00_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 955,
                        name: "lux_2012_01_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2012_01_temp_maximum",
                          metadata_id: "ec11bd74-992e-4319-8479-dfdd0918201d"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_01_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_01_temp_maximum__lux_2012_01_map_temp_maximum"
                          },
                          {
                            name: "lux_2012_01_temp_maximum__lux_2012_01_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 958,
                        name: "lux_2012_02_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2012_02_temp_maximum",
                          metadata_id: "30059e69-9f0d-49f5-82bd-8286e0964a97"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_02_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_02_temp_maximum__lux_2012_02_map_temp_maximum"
                          },
                          {
                            name: "lux_2012_02_temp_maximum__lux_2012_02_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 961,
                        name: "lux_2012_03_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2012_03_temp_maximum",
                          metadata_id: "b697dfe9-4866-47b8-b91e-26e1307ff321"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_03_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_03_temp_maximum__lux_2012_03_map_temp_maximum"
                          },
                          {
                            name: "lux_2012_03_temp_maximum__lux_2012_03_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 964,
                        name: "lux_2012_04_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2012_04_temp_maximum",
                          metadata_id: "d4fc7743-7c28-4fed-be24-190be6f1f9ef"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_04_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_04_temp_maximum__lux_2012_04_map_temp_maximum"
                          },
                          {
                            name: "lux_2012_04_temp_maximum__lux_2012_04_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 967,
                        name: "lux_2012_05_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2012_05_temp_maximum",
                          metadata_id: "353c6301-54f5-438a-8bb2-83c9f871fe38"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_05_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_05_temp_maximum__lux_2012_05_map_temp_maximum"
                          },
                          {
                            name: "lux_2012_05_temp_maximum__lux_2012_05_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 970,
                        name: "lux_2012_06_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2012_06_temp_maximum",
                          metadata_id: "50804ff9-437e-47a4-8d34-1b51d87f3cce"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_06_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_06_temp_maximum__lux_2012_06_map_temp_maximum"
                          },
                          {
                            name: "lux_2012_06_temp_maximum__lux_2012_06_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 973,
                        name: "lux_2012_07_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2012_07_temp_maximum",
                          metadata_id: "e00a102f-3438-4ae0-8aed-939f26060524"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_07_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_07_temp_maximum__lux_2012_07_map_temp_maximum"
                          },
                          {
                            name: "lux_2012_07_temp_maximum__lux_2012_07_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 976,
                        name: "lux_2012_08_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2012_08_temp_maximum",
                          metadata_id: "c667bf8a-64dc-4bc9-9620-58fd53552d21"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_08_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_08_temp_maximum__lux_2012_08_map_temp_maximum"
                          },
                          {
                            name: "lux_2012_08_temp_maximum__lux_2012_08_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 979,
                        name: "lux_2012_09_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2012_09_temp_maximum",
                          metadata_id: "2bafa929-5bd9-4d18-9bef-8e41f87c6e8f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_09_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_09_temp_maximum__lux_2012_09_map_temp_maximum"
                          },
                          {
                            name: "lux_2012_09_temp_maximum__lux_2012_09_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 982,
                        name: "lux_2012_10_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2012_10_temp_maximum",
                          metadata_id: "a6e2f1f0-c3a1-41da-addb-5a441374e75f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_10_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_10_temp_maximum__lux_2012_10_map_temp_maximum"
                          },
                          {
                            name: "lux_2012_10_temp_maximum__lux_2012_10_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 985,
                        name: "lux_2012_11_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2012_11_temp_maximum",
                          metadata_id: "2b8ef18d-8075-4d27-a7c7-01e0fb187d7c"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_11_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_11_temp_maximum__lux_2012_11_map_temp_maximum"
                          },
                          {
                            name: "lux_2012_11_temp_maximum__lux_2012_11_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 988,
                        name: "lux_2012_12_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2012_12_temp_maximum",
                          metadata_id: "b7190c55-3028-4591-b692-cc45a7cdff83"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_12_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_12_temp_maximum__lux_2012_12_map_temp_maximum"
                          },
                          {
                            name: "lux_2012_12_temp_maximum__lux_2012_12_samples_temp_maximum"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 990,
                name: "Precipitation2",
                children: [
                  {
                    id: 991,
                    name: "lux_2012_pluvio_sum",
                    children: [
                      {
                        id: 993,
                        name: "lux_2012_00_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2012_00_pluvio_sum",
                          metadata_id: "995f2132-f1cf-4801-93df-b3a57ed1f4e3"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_00_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_00_pluvio_sum__lux_2012_00_map_pluvio_sum"
                          },
                          {
                            name: "lux_2012_00_pluvio_sum__lux_2012_00_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 996,
                        name: "lux_2012_01_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2012_01_pluvio_sum",
                          metadata_id: "91449219-e981-4f3b-a49d-0aabff6b75b2"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_01_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_01_pluvio_sum__lux_2012_01_map_pluvio_sum"
                          },
                          {
                            name: "lux_2012_01_pluvio_sum__lux_2012_01_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 999,
                        name: "lux_2012_02_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2012_02_pluvio_sum",
                          metadata_id: "1a6eb0de-156b-489c-9a6b-abc62bf30b52"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_02_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_02_pluvio_sum__lux_2012_02_map_pluvio_sum"
                          },
                          {
                            name: "lux_2012_02_pluvio_sum__lux_2012_02_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1002,
                        name: "lux_2012_03_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2012_03_pluvio_sum",
                          metadata_id: "e69a30b4-0c0a-4609-bb5d-b8e618cfb0df"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_03_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_03_pluvio_sum__lux_2012_03_map_pluvio_sum"
                          },
                          {
                            name: "lux_2012_03_pluvio_sum__lux_2012_03_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1005,
                        name: "lux_2012_04_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2012_04_pluvio_sum",
                          metadata_id: "40bc155c-a5d9-4d1c-a248-09f83075ee04"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_04_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_04_pluvio_sum__lux_2012_04_map_pluvio_sum"
                          },
                          {
                            name: "lux_2012_04_pluvio_sum__lux_2012_04_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1008,
                        name: "lux_2012_05_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2012_05_pluvio_sum",
                          metadata_id: "4f084681-4050-4e88-9800-bbdbbc3ec807"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_05_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_05_pluvio_sum__lux_2012_05_map_pluvio_sum"
                          },
                          {
                            name: "lux_2012_05_pluvio_sum__lux_2012_05_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1011,
                        name: "lux_2012_06_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2012_06_pluvio_sum",
                          metadata_id: "b156be37-7f3a-4e5b-97c5-575adbf2234d"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_06_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_06_pluvio_sum__lux_2012_06_map_pluvio_sum"
                          },
                          {
                            name: "lux_2012_06_pluvio_sum__lux_2012_06_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1014,
                        name: "lux_2012_07_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2012_07_pluvio_sum",
                          metadata_id: "15e35e50-8095-4783-ae94-f18bee8e2d4a"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_07_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_07_pluvio_sum__lux_2012_07_map_pluvio_sum"
                          },
                          {
                            name: "lux_2012_07_pluvio_sum__lux_2012_07_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1017,
                        name: "lux_2012_08_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2012_08_pluvio_sum",
                          metadata_id: "f0a5be5e-f550-4ffd-9cbf-a638b5c9decf"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_08_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_08_pluvio_sum__lux_2012_08_map_pluvio_sum"
                          },
                          {
                            name: "lux_2012_08_pluvio_sum__lux_2012_08_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1020,
                        name: "lux_2012_09_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2012_09_pluvio_sum",
                          metadata_id: "814b8548-6713-4759-8103-2da86ce8b791"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_09_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_09_pluvio_sum__lux_2012_09_map_pluvio_sum"
                          },
                          {
                            name: "lux_2012_09_pluvio_sum__lux_2012_09_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1023,
                        name: "lux_2012_10_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2012_10_pluvio_sum",
                          metadata_id: "980df41e-135b-4d56-88e2-86bf161b7861"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_10_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_10_pluvio_sum__lux_2012_10_map_pluvio_sum"
                          },
                          {
                            name: "lux_2012_10_pluvio_sum__lux_2012_10_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1026,
                        name: "lux_2012_11_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2012_11_pluvio_sum",
                          metadata_id: "afbd1119-2de8-4f81-ab5c-675548923ecd"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_11_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_11_pluvio_sum__lux_2012_11_map_pluvio_sum"
                          },
                          {
                            name: "lux_2012_11_pluvio_sum__lux_2012_11_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1029,
                        name: "lux_2012_12_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2012_12_pluvio_sum",
                          metadata_id: "ee9bc98d-ac9a-492e-8430-8c40db1ee35d"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_12_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_12_pluvio_sum__lux_2012_12_map_pluvio_sum"
                          },
                          {
                            name: "lux_2012_12_pluvio_sum__lux_2012_12_samples_pluvio_sum"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1031,
                    name: "lux_2012_pluvio_diff_mm",
                    children: [
                      {
                        id: 1036,
                        name: "lux_2012_01_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2012_01_pluvio_diff_mm",
                          metadata_id: "20d0cfb4-8add-4ddd-b95a-aeaf9b9a38f4"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_01_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_01_pluvio_diff_mm__lux_2012_01_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2012_01_pluvio_diff_mm__lux_2012_01_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1039,
                        name: "lux_2012_02_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2012_02_pluvio_diff_mm",
                          metadata_id: "451848ab-641a-40cd-9a07-c6d77577719f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_02_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_02_pluvio_diff_mm__lux_2012_02_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2012_02_pluvio_diff_mm__lux_2012_02_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1042,
                        name: "lux_2012_03_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2012_03_pluvio_diff_mm",
                          metadata_id: "c8423f15-46b9-4a13-801e-0f6ee387635b"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_03_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_03_pluvio_diff_mm__lux_2012_03_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2012_03_pluvio_diff_mm__lux_2012_03_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1045,
                        name: "lux_2012_04_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2012_04_pluvio_diff_mm",
                          metadata_id: "27f223c7-3f6e-4bf2-be02-9f61276b23ae"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_04_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_04_pluvio_diff_mm__lux_2012_04_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2012_04_pluvio_diff_mm__lux_2012_04_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1048,
                        name: "lux_2012_05_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2012_05_pluvio_diff_mm",
                          metadata_id: "87934362-d3cf-4815-87db-6d6592c39a5c"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_05_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_05_pluvio_diff_mm__lux_2012_05_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2012_05_pluvio_diff_mm__lux_2012_05_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1051,
                        name: "lux_2012_06_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2012_06_pluvio_diff_mm",
                          metadata_id: "c8a605e8-1214-4c5c-b09e-ed1bc960bdfd"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_06_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_06_pluvio_diff_mm__lux_2012_06_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2012_06_pluvio_diff_mm__lux_2012_06_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1054,
                        name: "lux_2012_07_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2012_07_pluvio_diff_mm",
                          metadata_id: "e0c512bf-23ba-49ab-b6e0-eb39e703e89a"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_07_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_07_pluvio_diff_mm__lux_2012_07_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2012_07_pluvio_diff_mm__lux_2012_07_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1057,
                        name: "lux_2012_08_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2012_08_pluvio_diff_mm",
                          metadata_id: "42ae3dde-d671-4f6c-b316-6d9a4f4fe27d"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_08_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_08_pluvio_diff_mm__lux_2012_08_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2012_08_pluvio_diff_mm__lux_2012_08_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1060,
                        name: "lux_2012_09_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2012_09_pluvio_diff_mm",
                          metadata_id: "b503b838-ee90-453c-991c-4d2339e3cf88"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_09_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_09_pluvio_diff_mm__lux_2012_09_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2012_09_pluvio_diff_mm__lux_2012_09_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1063,
                        name: "lux_2012_10_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2012_10_pluvio_diff_mm",
                          metadata_id: "31bd014c-7414-45f0-b80a-d84fb8da2aa9"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_10_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_10_pluvio_diff_mm__lux_2012_10_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2012_10_pluvio_diff_mm__lux_2012_10_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1066,
                        name: "lux_2012_11_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2012_11_pluvio_diff_mm",
                          metadata_id: "2822d021-ee39-4e2d-bdb6-a899a4c263f4"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_11_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_11_pluvio_diff_mm__lux_2012_11_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2012_11_pluvio_diff_mm__lux_2012_11_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1069,
                        name: "lux_2012_12_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2012_12_pluvio_diff_mm",
                          metadata_id: "4ecf9607-f88b-4691-b003-2d182417a242"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_12_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_12_pluvio_diff_mm__lux_2012_12_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2012_12_pluvio_diff_mm__lux_2012_12_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1033,
                        name: "lux_2012_00_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2012_00_pluvio_diff_mm",
                          metadata_id: "718191c9-f9da-404d-bf48-20fe2224eb14"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_00_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_00_pluvio_diff_mm__lux_2012_00_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2012_00_pluvio_diff_mm__lux_2012_00_samples_pluvio_diff_mm_01"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1071,
                    name: "lux_2012_pluvio_diff_perc",
                    children: [
                      {
                        id: 1076,
                        name: "lux_2012_01_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2012_01_pluvio_diff_perc",
                          metadata_id: "9c2f4506-5e93-4a93-ba09-6ef741498f87"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_01_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_01_pluvio_diff_perc__lux_2012_01_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2012_01_pluvio_diff_perc__lux_2012_01_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1079,
                        name: "lux_2012_02_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2012_02_pluvio_diff_perc",
                          metadata_id: "bb0a61d8-f9a5-4d3b-bbc3-c1d063966ce4"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_02_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_02_pluvio_diff_perc__lux_2012_02_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2012_02_pluvio_diff_perc__lux_2012_02_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1082,
                        name: "lux_2012_03_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2012_03_pluvio_diff_perc",
                          metadata_id: "8dbd9280-f68b-418c-ad30-9001daacd931"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_03_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_03_pluvio_diff_perc__lux_2012_03_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2012_03_pluvio_diff_perc__lux_2012_03_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1085,
                        name: "lux_2012_04_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2012_04_pluvio_diff_perc",
                          metadata_id: "77a78f1f-61fb-4e4a-b2d6-c04fc8a87e3d"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_04_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_04_pluvio_diff_perc__lux_2012_04_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2012_04_pluvio_diff_perc__lux_2012_04_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1088,
                        name: "lux_2012_05_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2012_05_pluvio_diff_perc",
                          metadata_id: "5d1e5786-46ba-4a38-988e-6440a027629a"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_05_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_05_pluvio_diff_perc__lux_2012_05_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2012_05_pluvio_diff_perc__lux_2012_05_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1091,
                        name: "lux_2012_06_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2012_06_pluvio_diff_perc",
                          metadata_id: "080d016b-c09e-4e0f-a8ef-ea2474119883"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_06_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_06_pluvio_diff_perc__lux_2012_06_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2012_06_pluvio_diff_perc__lux_2012_06_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1094,
                        name: "lux_2012_07_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2012_07_pluvio_diff_perc",
                          metadata_id: "683be930-7be7-4a9f-ae30-525694cee659"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_07_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_07_pluvio_diff_perc__lux_2012_07_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2012_07_pluvio_diff_perc__lux_2012_07_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1097,
                        name: "lux_2012_08_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2012_08_pluvio_diff_perc",
                          metadata_id: "fbd95c38-5169-4f7a-8c3d-e27959f3d5fa"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_08_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_08_pluvio_diff_perc__lux_2012_08_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2012_08_pluvio_diff_perc__lux_2012_08_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1100,
                        name: "lux_2012_09_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2012_09_pluvio_diff_perc",
                          metadata_id: "97eb3553-977d-4a8a-9df2-a7d1ba413f01"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_09_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_09_pluvio_diff_perc__lux_2012_09_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2012_09_pluvio_diff_perc__lux_2012_09_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1103,
                        name: "lux_2012_10_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2012_10_pluvio_diff_perc",
                          metadata_id: "64916321-6298-4af5-9be5-a80a15972343"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_10_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_10_pluvio_diff_perc__lux_2012_10_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2012_10_pluvio_diff_perc__lux_2012_10_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1106,
                        name: "lux_2012_11_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2012_11_pluvio_diff_perc",
                          metadata_id: "1d9e06b3-c417-47e3-8a65-4916a23ee5fd"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_11_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_11_pluvio_diff_perc__lux_2012_11_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2012_11_pluvio_diff_perc__lux_2012_11_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1109,
                        name: "lux_2012_12_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2012_12_pluvio_diff_perc",
                          metadata_id: "e81bb134-ece6-4b77-a377-0c47b6ebfa5c"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_12_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_12_pluvio_diff_perc__lux_2012_12_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2012_12_pluvio_diff_perc__lux_2012_12_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1073,
                        name: "lux_2012_00_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2012_00_pluvio_diff_perc",
                          metadata_id: "68c5f8cd-4260-4a72-9467-2334820c1090"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2012_00_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2012_00_pluvio_diff_perc__lux_2012_00_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2012_00_pluvio_diff_perc__lux_2012_00_samples_pluvio_diff_mm_02"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          },
          {
            id: 1111,
            name: "2013",
            children: [
              {
                id: 1112,
                name: "Temperature",
                children: [
                  {
                    id: 1113,
                    name: "lux_2013_temp_minimum",
                    children: [
                      {
                        id: 1115,
                        name: "lux_2013_00_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2013_00_temp_minimum",
                          metadata_id: "9491b9ca-27e1-48ff-a7c4-8f65e964afa6"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_00_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_00_temp_minimum__lux_2013_00_map_temp_minimum"
                          },
                          {
                            name: "lux_2013_00_temp_minimum__lux_2013_00_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 1118,
                        name: "lux_2013_01_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2013_01_temp_minimum",
                          metadata_id: "a0fccdfb-be0c-49b5-8e73-9928b76bc1b6"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_01_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_01_temp_minimum__lux_2013_01_map_temp_minimum"
                          },
                          {
                            name: "lux_2013_01_temp_minimum__lux_2013_01_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 1121,
                        name: "lux_2013_02_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2013_02_temp_minimum",
                          metadata_id: "b0c95d39-7bc5-44f9-ba29-1126d145b705"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_02_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_02_temp_minimum__lux_2013_02_map_temp_minimum"
                          },
                          {
                            name: "lux_2013_02_temp_minimum__lux_2013_02_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 1124,
                        name: "lux_2013_03_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2013_03_temp_minimum",
                          metadata_id: "7414126a-9d1a-496c-9ceb-ea11ee259f74"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_03_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_03_temp_minimum__lux_2013_03_map_temp_minimum"
                          },
                          {
                            name: "lux_2013_03_temp_minimum__lux_2013_03_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 1127,
                        name: "lux_2013_04_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2013_04_temp_minimum",
                          metadata_id: "8476317e-b13f-4275-941f-b4cfd286af9f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_04_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_04_temp_minimum__lux_2013_04_map_temp_minimum"
                          },
                          {
                            name: "lux_2013_04_temp_minimum__lux_2013_04_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 1130,
                        name: "lux_2013_05_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2013_05_temp_minimum",
                          metadata_id: "13c66d86-f6c7-4c0c-8a6e-ef23f49c1c3a"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_05_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_05_temp_minimum__lux_2013_05_map_temp_minimum"
                          },
                          {
                            name: "lux_2013_05_temp_minimum__lux_2013_05_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 1133,
                        name: "lux_2013_06_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2013_06_temp_minimum",
                          metadata_id: "a470e8a9-e077-4f5b-a39a-c972048431e4"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_06_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_06_temp_minimum__lux_2013_06_map_temp_minimum"
                          },
                          {
                            name: "lux_2013_06_temp_minimum__lux_2013_06_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 1136,
                        name: "lux_2013_07_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2013_07_temp_minimum",
                          metadata_id: "44b643b3-5508-48d0-86a9-4cac1e71980b"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_07_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_07_temp_minimum__lux_2013_07_map_temp_minimum"
                          },
                          {
                            name: "lux_2013_07_temp_minimum__lux_2013_07_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 1139,
                        name: "lux_2013_08_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2013_08_temp_minimum",
                          metadata_id: "9fa46b73-271c-4831-ae28-ccbdb4714cf5"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_08_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_08_temp_minimum__lux_2013_08_map_temp_minimum"
                          },
                          {
                            name: "lux_2013_08_temp_minimum__lux_2013_08_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 1142,
                        name: "lux_2013_09_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2013_09_temp_minimum",
                          metadata_id: "888e8d4e-d391-4453-ae90-7f9f5f2d051b"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_09_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_09_temp_minimum__lux_2013_09_map_temp_minimum"
                          },
                          {
                            name: "lux_2013_09_temp_minimum__lux_2013_09_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 1145,
                        name: "lux_2013_10_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2013_10_temp_minimum",
                          metadata_id: "a24fc9f4-59ff-4c9f-a39c-926583491c5d"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_10_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_10_temp_minimum__lux_2013_10_map_temp_minimum"
                          },
                          {
                            name: "lux_2013_10_temp_minimum__lux_2013_10_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 1148,
                        name: "lux_2013_11_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2013_11_temp_minimum",
                          metadata_id: "0d7a0b9d-02ae-48cc-9456-f69ef74f9ff7"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_11_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_11_temp_minimum__lux_2013_11_map_temp_minimum"
                          },
                          {
                            name: "lux_2013_11_temp_minimum__lux_2013_11_samples_temp_minimum"
                          }
                        ]
                      },
                      {
                        id: 1151,
                        name: "lux_2013_12_temp_minimum",
                        metadata: {
                          legend_name: "ahc:lux_2013_12_temp_minimum",
                          metadata_id: "2908895f-0b04-4489-b22f-9f105b2f9a13"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_12_temp_minimum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_12_temp_minimum__lux_2013_12_map_temp_minimum"
                          },
                          {
                            name: "lux_2013_12_temp_minimum__lux_2013_12_samples_temp_minimum"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1153,
                    name: "lux_2013_temp_average",
                    children: [
                      {
                        id: 1155,
                        name: "lux_2013_00_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2013_00_temp_average",
                          metadata_id: "8fcdd152-cf89-4430-ab35-66cfb7f45fa3"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_00_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_00_temp_average__lux_2013_00_map_temp_average"
                          },
                          {
                            name: "lux_2013_00_temp_average__lux_2013_00_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 1158,
                        name: "lux_2013_01_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2013_01_temp_average",
                          metadata_id: "8d736a16-7c67-4691-a320-3d7ca985c4bd"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_01_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_01_temp_average__lux_2013_01_map_temp_average"
                          },
                          {
                            name: "lux_2013_01_temp_average__lux_2013_01_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 1161,
                        name: "lux_2013_02_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2013_02_temp_average",
                          metadata_id: "867f9ad9-42bd-499d-b0d9-21b62dd870a3"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_02_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_02_temp_average__lux_2013_02_map_temp_average"
                          },
                          {
                            name: "lux_2013_02_temp_average__lux_2013_02_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 1164,
                        name: "lux_2013_03_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2013_03_temp_average",
                          metadata_id: "41176e94-9991-4b00-87fc-a0aa342d6149"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_03_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_03_temp_average__lux_2013_03_map_temp_average"
                          },
                          {
                            name: "lux_2013_03_temp_average__lux_2013_03_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 1167,
                        name: "lux_2013_04_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2013_04_temp_average",
                          metadata_id: "c29928a4-c82d-419a-a74b-20cd5d9ee6db"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_04_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_04_temp_average__lux_2013_04_map_temp_average"
                          },
                          {
                            name: "lux_2013_04_temp_average__lux_2013_04_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 1170,
                        name: "lux_2013_05_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2013_05_temp_average",
                          metadata_id: "42128c19-7fd3-4a11-9d75-cd88709c6b92"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_05_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_05_temp_average__lux_2013_05_map_temp_average"
                          },
                          {
                            name: "lux_2013_05_temp_average__lux_2013_05_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 1173,
                        name: "lux_2013_06_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2013_06_temp_average",
                          metadata_id: "8f4af35c-6312-4d67-8f20-1b83b2e422df"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_06_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_06_temp_average__lux_2013_06_map_temp_average"
                          },
                          {
                            name: "lux_2013_06_temp_average__lux_2013_06_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 1176,
                        name: "lux_2013_07_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2013_07_temp_average",
                          metadata_id: "d925c1bb-8c3c-430a-966d-3b924ffdc67e"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_07_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_07_temp_average__lux_2013_07_map_temp_average"
                          },
                          {
                            name: "lux_2013_07_temp_average__lux_2013_07_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 1179,
                        name: "lux_2013_08_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2013_08_temp_average",
                          metadata_id: "74345275-8902-4bc5-aa69-fb88c8b79be8"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_08_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_08_temp_average__lux_2013_08_map_temp_average"
                          },
                          {
                            name: "lux_2013_08_temp_average__lux_2013_08_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 1182,
                        name: "lux_2013_09_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2013_09_temp_average",
                          metadata_id: "d34052ae-0b2d-48cd-9bd5-f0032a0bed47"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_09_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_09_temp_average__lux_2013_09_map_temp_average"
                          },
                          {
                            name: "lux_2013_09_temp_average__lux_2013_09_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 1185,
                        name: "lux_2013_10_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2013_10_temp_average",
                          metadata_id: "29d46c4d-b803-4fe3-b0df-9861590bc741"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_10_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_10_temp_average__lux_2013_10_map_temp_average"
                          },
                          {
                            name: "lux_2013_10_temp_average__lux_2013_10_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 1188,
                        name: "lux_2013_11_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2013_11_temp_average",
                          metadata_id: "210c3e61-6ee3-4ae9-b6c7-a42919570f65"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_11_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_11_temp_average__lux_2013_11_map_temp_average"
                          },
                          {
                            name: "lux_2013_11_temp_average__lux_2013_11_samples_temp_average"
                          }
                        ]
                      },
                      {
                        id: 1191,
                        name: "lux_2013_12_temp_average",
                        metadata: {
                          legend_name: "ahc:lux_2013_12_temp_average",
                          metadata_id: "cb111db8-4647-47af-8ce2-c78a24172053"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_12_temp_average",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_12_temp_average__lux_2013_12_map_temp_average"
                          },
                          {
                            name: "lux_2013_12_temp_average__lux_2013_12_samples_temp_average"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1193,
                    name: "lux_2013_temp_maximum",
                    children: [
                      {
                        id: 1195,
                        name: "lux_2013_00_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2013_00_temp_maximum",
                          metadata_id: "38302ccb-d128-4131-900e-af265e6db07f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_00_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_00_temp_maximum__lux_2013_00_map_temp_maximum"
                          },
                          {
                            name: "lux_2013_00_temp_maximum__lux_2013_00_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 1198,
                        name: "lux_2013_01_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2013_01_temp_maximum",
                          metadata_id: "dcc77aea-c193-4d11-9e09-ed7533e93add"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_01_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_01_temp_maximum__lux_2013_01_map_temp_maximum"
                          },
                          {
                            name: "lux_2013_01_temp_maximum__lux_2013_01_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 1201,
                        name: "lux_2013_02_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2013_02_temp_maximum",
                          metadata_id: "af6addcb-cbc7-4df0-9f72-a16f4a458ff7"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_02_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_02_temp_maximum__lux_2013_02_map_temp_maximum"
                          },
                          {
                            name: "lux_2013_02_temp_maximum__lux_2013_02_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 1204,
                        name: "lux_2013_03_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2013_03_temp_maximum",
                          metadata_id: "b3a55d44-164e-476b-87b3-5034f7e26a76"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_03_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_03_temp_maximum__lux_2013_03_map_temp_maximum"
                          },
                          {
                            name: "lux_2013_03_temp_maximum__lux_2013_03_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 1207,
                        name: "lux_2013_04_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2013_04_temp_maximum",
                          metadata_id: "16f1fa2f-e987-4495-bec8-7814497d91c7"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_04_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_04_temp_maximum__lux_2013_04_map_temp_maximum"
                          },
                          {
                            name: "lux_2013_04_temp_maximum__lux_2013_04_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 1210,
                        name: "lux_2013_05_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2013_05_temp_maximum",
                          metadata_id: "c4cd6879-96db-40c1-bc7a-a29c129150eb"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_05_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_05_temp_maximum__lux_2013_05_map_temp_maximum"
                          },
                          {
                            name: "lux_2013_05_temp_maximum__lux_2013_05_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 1213,
                        name: "lux_2013_06_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2013_06_temp_maximum",
                          metadata_id: "3a9de7b2-e535-46eb-a3fb-168fd23d7aeb"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_06_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_06_temp_maximum__lux_2013_06_map_temp_maximum"
                          },
                          {
                            name: "lux_2013_06_temp_maximum__lux_2013_06_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 1216,
                        name: "lux_2013_07_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2013_07_temp_maximum",
                          metadata_id: "a72dcdbf-f26d-448c-844b-70a221153e0d"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_07_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_07_temp_maximum__lux_2013_07_map_temp_maximum"
                          },
                          {
                            name: "lux_2013_07_temp_maximum__lux_2013_07_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 1219,
                        name: "lux_2013_08_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2013_08_temp_maximum",
                          metadata_id: "16bdbbdb-4c6b-41f3-aa4a-079e11b5dc96"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_08_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_08_temp_maximum__lux_2013_08_map_temp_maximum"
                          },
                          {
                            name: "lux_2013_08_temp_maximum__lux_2013_08_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 1222,
                        name: "lux_2013_09_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2013_09_temp_maximum",
                          metadata_id: "727ee672-138a-4c5a-8693-06b8696bdfd5"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_09_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_09_temp_maximum__lux_2013_09_map_temp_maximum"
                          },
                          {
                            name: "lux_2013_09_temp_maximum__lux_2013_09_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 1225,
                        name: "lux_2013_10_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2013_10_temp_maximum",
                          metadata_id: "72b7c62b-9a89-4123-bb5c-fd593ed037a2"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_10_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_10_temp_maximum__lux_2013_10_map_temp_maximum"
                          },
                          {
                            name: "lux_2013_10_temp_maximum__lux_2013_10_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 1228,
                        name: "lux_2013_11_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2013_11_temp_maximum",
                          metadata_id: "754c15d3-eb29-4759-8f01-dcd77e20caf5"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_11_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_11_temp_maximum__lux_2013_11_map_temp_maximum"
                          },
                          {
                            name: "lux_2013_11_temp_maximum__lux_2013_11_samples_temp_maximum"
                          }
                        ]
                      },
                      {
                        id: 1231,
                        name: "lux_2013_12_temp_maximum",
                        metadata: {
                          legend_name: "ahc:lux_2013_12_temp_maximum",
                          metadata_id: "eb4ed213-faab-4453-a0dc-c005e63dbe54"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_12_temp_maximum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_12_temp_maximum__lux_2013_12_map_temp_maximum"
                          },
                          {
                            name: "lux_2013_12_temp_maximum__lux_2013_12_samples_temp_maximum"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              },
              {
                id: 1233,
                name: "Precipitation3",
                children: [
                  {
                    id: 1234,
                    name: "lux_2013_pluvio_sum",
                    children: [
                      {
                        id: 1236,
                        name: "lux_2013_00_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2013_00_pluvio_sum",
                          metadata_id: "b5080e49-bdb7-4915-972f-9d744ed565cd"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_00_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_00_pluvio_sum__lux_2013_00_map_pluvio_sum"
                          },
                          {
                            name: "lux_2013_00_pluvio_sum__lux_2013_00_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1239,
                        name: "lux_2013_01_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2013_01_pluvio_sum",
                          metadata_id: "34b89ba6-548d-489a-985a-77e2e091814c"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_01_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_01_pluvio_sum__lux_2013_01_map_pluvio_sum"
                          },
                          {
                            name: "lux_2013_01_pluvio_sum__lux_2013_01_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1242,
                        name: "lux_2013_02_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2013_02_pluvio_sum",
                          metadata_id: "d260feba-b542-419f-a7fa-175a41c751d6"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_02_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_02_pluvio_sum__lux_2013_02_map_pluvio_sum"
                          },
                          {
                            name: "lux_2013_02_pluvio_sum__lux_2013_02_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1245,
                        name: "lux_2013_03_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2013_03_pluvio_sum",
                          metadata_id: "a2c5e951-c4fb-45a8-ab6d-de86f553ca5f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_03_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_03_pluvio_sum__lux_2013_03_map_pluvio_sum"
                          },
                          {
                            name: "lux_2013_03_pluvio_sum__lux_2013_03_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1248,
                        name: "lux_2013_04_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2013_04_pluvio_sum",
                          metadata_id: "569d346a-af56-447f-9d4d-f4058e42b196"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_04_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_04_pluvio_sum__lux_2013_04_map_pluvio_sum"
                          },
                          {
                            name: "lux_2013_04_pluvio_sum__lux_2013_04_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1251,
                        name: "lux_2013_05_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2013_05_pluvio_sum",
                          metadata_id: "91109847-6a28-4035-949c-e1c70a2af222"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_05_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_05_pluvio_sum__lux_2013_05_map_pluvio_sum"
                          },
                          {
                            name: "lux_2013_05_pluvio_sum__lux_2013_05_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1254,
                        name: "lux_2013_06_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2013_06_pluvio_sum",
                          metadata_id: "3188667a-f04f-4cda-a35c-c587a7fb192a"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_06_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_06_pluvio_sum__lux_2013_06_map_pluvio_sum"
                          },
                          {
                            name: "lux_2013_06_pluvio_sum__lux_2013_06_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1257,
                        name: "lux_2013_07_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2013_07_pluvio_sum",
                          metadata_id: "e1daa189-ffe2-49a5-9644-d5dbf46788e5"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_07_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_07_pluvio_sum__lux_2013_07_map_pluvio_sum"
                          },
                          {
                            name: "lux_2013_07_pluvio_sum__lux_2013_07_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1260,
                        name: "lux_2013_08_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2013_08_pluvio_sum",
                          metadata_id: "42c36f8b-dbaa-4b26-87ee-41022578bf8b"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_08_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_08_pluvio_sum__lux_2013_08_map_pluvio_sum"
                          },
                          {
                            name: "lux_2013_08_pluvio_sum__lux_2013_08_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1263,
                        name: "lux_2013_09_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2013_09_pluvio_sum",
                          metadata_id: "5181f183-e287-40df-b262-f18c3b879659"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_09_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_09_pluvio_sum__lux_2013_09_map_pluvio_sum"
                          },
                          {
                            name: "lux_2013_09_pluvio_sum__lux_2013_09_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1266,
                        name: "lux_2013_10_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2013_10_pluvio_sum",
                          metadata_id: "31907d6a-ac9e-421e-95c2-68ff61df2804"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_10_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_10_pluvio_sum__lux_2013_10_map_pluvio_sum"
                          },
                          {
                            name: "lux_2013_10_pluvio_sum__lux_2013_10_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1269,
                        name: "lux_2013_11_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2013_11_pluvio_sum",
                          metadata_id: "0aed9327-3d3e-497b-8a90-722ada2dc9e2"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_11_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_11_pluvio_sum__lux_2013_11_map_pluvio_sum"
                          },
                          {
                            name: "lux_2013_11_pluvio_sum__lux_2013_11_samples_pluvio_sum"
                          }
                        ]
                      },
                      {
                        id: 1272,
                        name: "lux_2013_12_pluvio_sum",
                        metadata: {
                          legend_name: "ahc:lux_2013_12_pluvio_sum",
                          metadata_id: "4fe594e6-e8e6-4759-9a69-631f9408777f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_12_pluvio_sum",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_12_pluvio_sum__lux_2013_12_map_pluvio_sum"
                          },
                          {
                            name: "lux_2013_12_pluvio_sum__lux_2013_12_samples_pluvio_sum"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1274,
                    name: "lux_2013_pluvio_diff_mm",
                    children: [
                      {
                        id: 1279,
                        name: "lux_2013_01_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2013_01_pluvio_diff_mm",
                          metadata_id: "1b4e7653-8560-4b11-9050-6e2da25d2536"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_01_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_01_pluvio_diff_mm__lux_2013_01_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2013_01_pluvio_diff_mm__lux_2013_01_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1282,
                        name: "lux_2013_02_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2013_02_pluvio_diff_mm",
                          metadata_id: "cb124ba7-497a-49b0-b5d8-daf624feab66"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_02_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_02_pluvio_diff_mm__lux_2013_02_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2013_02_pluvio_diff_mm__lux_2013_02_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1285,
                        name: "lux_2013_03_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2013_03_pluvio_diff_mm",
                          metadata_id: "feb7cc51-d9c5-4dee-9f92-2e1eccfb8fd3"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_03_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_03_pluvio_diff_mm__lux_2013_03_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2013_03_pluvio_diff_mm__lux_2013_03_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1288,
                        name: "lux_2013_04_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2013_04_pluvio_diff_mm",
                          metadata_id: "e5fec492-f0ce-40f5-bbcf-e4c0e2460c37"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_04_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_04_pluvio_diff_mm__lux_2013_04_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2013_04_pluvio_diff_mm__lux_2013_04_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1291,
                        name: "lux_2013_05_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2013_05_pluvio_diff_mm",
                          metadata_id: "67d1d6a9-b444-4860-b9c1-0a4abda5b4bc"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_05_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_05_pluvio_diff_mm__lux_2013_05_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2013_05_pluvio_diff_mm__lux_2013_05_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1294,
                        name: "lux_2013_06_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2013_06_pluvio_diff_mm",
                          metadata_id: "49b60010-28fc-46d0-aa63-2a3624d629a8"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_06_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_06_pluvio_diff_mm__lux_2013_06_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2013_06_pluvio_diff_mm__lux_2013_06_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1297,
                        name: "lux_2013_07_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2013_07_pluvio_diff_mm",
                          metadata_id: "e4a49062-a310-4257-aba5-409fe79cc048"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_07_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_07_pluvio_diff_mm__lux_2013_07_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2013_07_pluvio_diff_mm__lux_2013_07_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1300,
                        name: "lux_2013_08_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2013_08_pluvio_diff_mm",
                          metadata_id: "f9c8cf90-9fea-4e3e-a3d2-af34c0f3c8c9"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_08_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_08_pluvio_diff_mm__lux_2013_08_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2013_08_pluvio_diff_mm__lux_2013_08_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1303,
                        name: "lux_2013_09_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2013_09_pluvio_diff_mm",
                          metadata_id: "954c29ac-997d-43f5-b128-97939df0e0bc"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_09_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_09_pluvio_diff_mm__lux_2013_09_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2013_09_pluvio_diff_mm__lux_2013_09_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1306,
                        name: "lux_2013_10_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2013_10_pluvio_diff_mm",
                          metadata_id: "5ee53d0f-7a12-4e01-a780-6106ee4a9d1f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_10_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_10_pluvio_diff_mm__lux_2013_10_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2013_10_pluvio_diff_mm__lux_2013_10_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1309,
                        name: "lux_2013_11_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2013_11_pluvio_diff_mm",
                          metadata_id: "2b60cc3d-3aca-4991-858b-989f58650183"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_11_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_11_pluvio_diff_mm__lux_2013_11_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2013_11_pluvio_diff_mm__lux_2013_11_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1312,
                        name: "lux_2013_12_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2013_12_pluvio_diff_mm",
                          metadata_id: "a0b2df18-1258-4882-bb53-dc67a016026d"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_12_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_12_pluvio_diff_mm__lux_2013_12_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2013_12_pluvio_diff_mm__lux_2013_12_samples_pluvio_diff_mm"
                          }
                        ]
                      },
                      {
                        id: 1276,
                        name: "lux_2013_00_pluvio_diff_mm",
                        metadata: {
                          legend_name: "ahc:lux_2013_00_pluvio_diff_mm",
                          metadata_id: "f0c3d6f2-417d-40e8-b2a0-b4c93fece026"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_00_pluvio_diff_mm",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_00_pluvio_diff_mm__lux_2013_00_map_pluvio_diff_mm"
                          },
                          {
                            name: "lux_2013_00_pluvio_diff_mm__lux_2013_00_samples_pluvio_diff_mm_01"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  },
                  {
                    id: 1314,
                    name: "lux_2013_pluvio_diff_perc",
                    children: [
                      {
                        id: 1319,
                        name: "lux_2013_01_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2013_01_pluvio_diff_perc",
                          metadata_id: "9c3afb13-f628-4ecb-8728-50e7d5077403"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_01_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_01_pluvio_diff_perc__lux_2013_01_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2013_01_pluvio_diff_perc__lux_2013_01_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1322,
                        name: "lux_2013_02_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2013_02_pluvio_diff_perc",
                          metadata_id: "e543ffcf-9b44-41a1-b9e1-dd6b847b6b2f"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_02_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_02_pluvio_diff_perc__lux_2013_02_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2013_02_pluvio_diff_perc__lux_2013_02_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1325,
                        name: "lux_2013_03_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2013_03_pluvio_diff_perc",
                          metadata_id: "22278d05-9abc-463b-9a37-d8bf3d305011"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_03_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_03_pluvio_diff_perc__lux_2013_03_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2013_03_pluvio_diff_perc__lux_2013_03_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1328,
                        name: "lux_2013_04_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2013_04_pluvio_diff_perc",
                          metadata_id: "ef0ddc6b-d503-4d3e-95b5-a848079bc781"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_04_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_04_pluvio_diff_perc__lux_2013_04_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2013_04_pluvio_diff_perc__lux_2013_04_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1331,
                        name: "lux_2013_05_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2013_05_pluvio_diff_perc",
                          metadata_id: "8867534c-5db8-411a-a10e-896bef2771ef"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_05_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_05_pluvio_diff_perc__lux_2013_05_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2013_05_pluvio_diff_perc__lux_2013_05_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1334,
                        name: "lux_2013_06_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2013_06_pluvio_diff_perc",
                          metadata_id: "7da0d693-a192-45c7-9fe1-642f91382d77"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_06_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_06_pluvio_diff_perc__lux_2013_06_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2013_06_pluvio_diff_perc__lux_2013_06_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1337,
                        name: "lux_2013_07_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2013_07_pluvio_diff_perc",
                          metadata_id: "10b015b1-ca60-4ab6-b824-3dad31bf9877"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_07_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_07_pluvio_diff_perc__lux_2013_07_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2013_07_pluvio_diff_perc__lux_2013_07_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1340,
                        name: "lux_2013_08_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2013_08_pluvio_diff_perc",
                          metadata_id: "ad2406b4-e2cd-44a3-ab83-23e3a1fdcc1d"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_08_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_08_pluvio_diff_perc__lux_2013_08_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2013_08_pluvio_diff_perc__lux_2013_08_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1343,
                        name: "lux_2013_09_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2013_09_pluvio_diff_perc",
                          metadata_id: "fa85f943-3521-43b1-ae35-61ed895b22d5"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_09_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_09_pluvio_diff_perc__lux_2013_09_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2013_09_pluvio_diff_perc__lux_2013_09_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1346,
                        name: "lux_2013_10_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2013_10_pluvio_diff_perc",
                          metadata_id: "665b8b4e-d97f-4186-8a18-ba17177ca725"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_10_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_10_pluvio_diff_perc__lux_2013_10_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2013_10_pluvio_diff_perc__lux_2013_10_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1349,
                        name: "lux_2013_11_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2013_11_pluvio_diff_perc",
                          metadata_id: "96abf4cd-affa-4dc8-b772-a1b4ea00b2b7"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_11_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_11_pluvio_diff_perc__lux_2013_11_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2013_11_pluvio_diff_perc__lux_2013_11_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1352,
                        name: "lux_2013_12_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2013_12_pluvio_diff_perc",
                          metadata_id: "9960a338-263d-4b86-9bb6-012f5d339ba1"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_12_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_12_pluvio_diff_perc__lux_2013_12_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2013_12_pluvio_diff_perc__lux_2013_12_samples_pluvio_diff_perc"
                          }
                        ]
                      },
                      {
                        id: 1316,
                        name: "lux_2013_00_pluvio_diff_perc",
                        metadata: {
                          legend_name: "ahc:lux_2013_00_pluvio_diff_perc",
                          metadata_id: "a3897301-7be1-4e45-a6e2-e207999c0ec9"
                        },
                        dimensions: {},
                        type: "WMS",
                        layers: "lux_2013_00_pluvio_diff_perc",
                        imageType: "image/png",
                        style: "default",
                        childLayers: [
                          {
                            name: "lux_2013_00_pluvio_diff_perc__lux_2013_00_map_pluvio_diff_perc"
                          },
                          {
                            name: "lux_2013_00_pluvio_diff_perc__lux_2013_00_samples_pluvio_diff_mm_02"
                          }
                        ]
                      }
                    ],
                    metadata: {},
                    mixed: true
                  }
                ],
                metadata: {},
                mixed: true
              }
            ],
            metadata: {},
            mixed: true
          }
        ],
        functionalities: {},
        metadata: {
          display_in_switcher: true
        }
      }
    ],
    background_layers: [
      {
        id: 556,
        name: "basemap_2015_global",
        metadata: {
          attribution: '&copy; <a href="https://www.mapzen.com/rights">CARTO</a>  &copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap</a> contributors for data outside of Luxembourg',
          exclusion: "[31, 32]",
          legend_name: "act:roadmap_vt",
          metadata_id: "a1fea2a0-e0a0-4e5f-a61d-9b3c3a9426bd"
        },
        dimensions: {},
        type: "WMTS",
        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
        style: "default",
        matrixSet: "GLOBAL_WEBMERCATOR",
        layer: "basemap_2015_global",
        imageType: "image/png"
      },
      {
        id: 502,
        name: "topo_bw_jpeg",
        metadata: {
          exclusion: "[35, 45]",
          legend_name: "act_topovt_bw",
          metadata_id: "b786acc2-b87e-4c7a-aff7-52778357243b"
        },
        dimensions: {},
        type: "WMTS",
        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
        style: "default",
        matrixSet: "GLOBAL_WEBMERCATOR",
        layer: "topo_bw_jpeg",
        imageType: "image/jpeg"
      },
      {
        id: 529,
        name: "topogr_global",
        metadata: {
          exclusion: "[36, 46]",
          legend_name: "act_topovt",
          metadata_id: "b786acc2-b87e-4c7a-aff7-52778357243b"
        },
        dimensions: {},
        type: "WMTS",
        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
        style: "default",
        matrixSet: "GLOBAL_WEBMERCATOR",
        layer: "topogr_global",
        imageType: "image/png"
      },
      {
        id: 530,
        name: "orthogr_2013_global",
        metadata: {
          exclusion: "[21, 22]",
          hasRetina: false,
          metadata_id: "554cb3f9-a6e7-4e0e-8d62-0853dfd33c32"
        },
        dimensions: {},
        type: "WMTS",
        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
        style: "default",
        matrixSet: "GLOBAL_WEBMERCATOR",
        layer: "orthogr_2013_global",
        imageType: "image/jpeg"
      },
      {
        id: 501,
        name: "streets_jpeg",
        metadata: {
          exclusion: "[11, 12]",
          hasRetina: false,
          metadata_id: "c427b194-53ba-418d-9b4a-226a8cbfd568"
        },
        dimensions: {},
        type: "WMTS",
        url: "http://wmts.geoportail.lu/mapproxy_4_v3/wmts/1.0.0/WMTSCapabilities.xml",
        style: "default",
        matrixSet: "GLOBAL_WEBMERCATOR",
        layer: "streets_jpeg",
        imageType: "image/png"
      }
    ],
    errors: [],
    lux_3d: {
      terrain_url: "https://acts3.geoportail.lu/3d-data/3d-tiles/terrain3D/lidar_2019_terrain/3DTiles"
    }
  });
  function useThemes() {
    function findById(id, node) {
      return findByIdOrName(id, void 0, node);
    }
    function findByName(name, node) {
      return findByIdOrName(void 0, name, node);
    }
    function findByIdOrName(id, name, node) {
      const { theme } = useThemeStore();
      node = node || theme;
      if (id && (node == null ? void 0 : node.id) === id || name && (node == null ? void 0 : node.name) === name) {
        return node;
      } else if (node == null ? void 0 : node.children) {
        for (const child of node.children) {
          const match2 = findByIdOrName(id, name, child);
          if (match2) {
            return match2;
          }
        }
      }
    }
    function findBgLayerById(id) {
      const { bgLayers } = useThemeStore();
      return bgLayers.find((l) => l.id === id);
    }
    function findBgLayerByName(name) {
      const { bgLayers } = useThemeStore();
      return bgLayers.find((l) => l.name === name);
    }
    function setTheme(name) {
      const { setTheme: setTheme2 } = useThemeStore();
      setTheme2(name);
    }
    async function fetchThemes() {
      return new Promise((resolve) => resolve(themesApiFixture()));
    }
    return {
      findById,
      findByName,
      findBgLayerById,
      findBgLayerByName,
      setTheme,
      fetchThemes
    };
  }
  const useThemeStore = defineStore(
    "config",
    () => {
      const themesService = useThemes();
      const config = vue.shallowRef();
      const themeName = vue.ref("main");
      const themes2 = vue.computed(() => {
        var _a;
        return (_a = config.value) == null ? void 0 : _a.themes;
      });
      const theme = vue.computed(
        () => {
          var _a;
          return (_a = themes2.value) == null ? void 0 : _a.find((theme2) => theme2.name === themeName.value);
        }
      );
      const bgLayers = vue.computed(() => {
        var _a;
        return ((_a = config.value) == null ? void 0 : _a.background_layers) || [];
      });
      themesService.fetchThemes().then((response) => config.value = response);
      function setTheme(name) {
        themeName.value = name;
      }
      return { config, themes: themes2, themeName, theme, bgLayers, setTheme };
    },
    {}
  );
  const themes = useThemes();
  function useLayers() {
    function hasIntersect(exclusionA, exclusionB) {
      try {
        const concat = JSON.parse(exclusionA).concat(JSON.parse(exclusionB)).sort((a, b) => a - b);
        return concat.some(
          (element, index2, array) => index2 && element === array[index2 - 1]
        );
      } catch (e) {
        return false;
      }
    }
    function initLayer(layer) {
      var _a, _b;
      layer.opacity = layer.previousOpacity = (_b = (_a = layer.metadata) == null ? void 0 : _a.start_opacity) != null ? _b : 1;
      return layer;
    }
    function handleExclusionLayers(layer) {
      var _a;
      if (!((_a = layer.metadata) == null ? void 0 : _a.exclusion)) {
        return;
      }
      const mapStore = useMapStore();
      const excludedLayers = mapStore.layers.filter(
        (_layer) => {
          var _a2, _b;
          return hasIntersect(
            (_a2 = layer == null ? void 0 : layer.metadata) == null ? void 0 : _a2.exclusion,
            (_b = _layer == null ? void 0 : _layer.metadata) == null ? void 0 : _b.exclusion
          );
        }
      );
      if (excludedLayers.length > 0) {
        mapStore.removeLayers(...excludedLayers.map((_layer) => _layer.id));
        alert(
          instance.t(
            "The layer <b>{{layersToRemove}}</b> has been removed because it cannot be displayed while the layer <b>{{layer}}</b> is displayed",
            {
              count: excludedLayers.length,
              layersToRemove: excludedLayers.map((_layer) => instance.t(_layer.name, { ns: "client" })).join(", "),
              layer: instance.t(layer.name, { ns: "client" }),
              ns: "client"
            }
          )
        );
      }
    }
    function toggleLayer(id, show = true) {
      var _a;
      const themeStore = useThemeStore();
      const mapStore = useMapStore();
      const layer = themes.findById(id, themeStore.theme);
      if (layer) {
        const linkedLayers = ((_a = layer.metadata) == null ? void 0 : _a.linked_layers) || [];
        if (show === false) {
          mapStore.removeLayers(layer.id, ...linkedLayers);
        } else {
          handleExclusionLayers(layer);
          mapStore.addLayers(
            initLayer(layer),
            ...linkedLayers.map(
              (layerId) => initLayer(
                themes.findById(parseInt(layerId, 10))
              )
            )
          );
        }
      }
    }
    return {
      initLayer,
      handleExclusionLayers,
      toggleLayer
    };
  }
  const _hoisted_1$f = {
    class: "mb-px",
    key: "node.id"
  };
  const _hoisted_2$a = ["aria-expanded", "data-cy"];
  const _hoisted_3$8 = { class: "grow" };
  const _hoisted_4$7 = { class: "leading-6" };
  const _hoisted_5$6 = ["aria-expanded", "data-cy"];
  const _hoisted_6$3 = { class: "grow" };
  const _hoisted_7$2 = { class: "leading-6" };
  const _hoisted_8$2 = {
    key: 1,
    class: "flex text-tertiary pr-2"
  };
  const _hoisted_9$2 = ["data-cy"];
  const _hoisted_10$2 = { class: "ml-1 hover:underline" };
  const _sfc_main$i = /* @__PURE__ */ vue.defineComponent({
    __name: "layer-tree-node",
    props: {
      node: null
    },
    emits: ["toggleLayer", "toggleParent"],
    setup(__props, { emit }) {
      const props = __props;
      const { t } = useTranslation();
      const { setMetadataId } = useMetadataStore();
      const isParent = !!props.node.children;
      const isRoot = props.node.depth === 0;
      const isMaxDepth = props.node.depth >= 10;
      const label = vue.computed(() => t(props.node.name, { ns: "client" }));
      function toggleLayer(node) {
        emit("toggleLayer", node);
      }
      function toggleParent(node) {
        emit("toggleParent", node);
      }
      return (_ctx, _cache) => {
        const _component_layer_tree_node = vue.resolveComponent("layer-tree-node", true);
        return isParent ? (vue.openBlock(), vue.createElementBlock("div", _hoisted_1$f, [
          __props.node.depth === 1 ? (vue.openBlock(), vue.createElementBlock("button", {
            key: 0,
            class: vue.normalizeClass(["group node-1 w-full text-left flex px-2 py-1.5 uppercase bg-tertiary", __props.node.expanded ? "text-white" : "text-secondary"]),
            "aria-expanded": __props.node.expanded,
            onClick: _cache[0] || (_cache[0] = ($event) => toggleParent(__props.node)),
            "data-cy": `parentLayerLabel-${__props.node.id}`
          }, [
            vue.createElementVNode("div", _hoisted_3$8, vue.toDisplayString(vue.unref(label)), 1),
            vue.createElementVNode("div", _hoisted_4$7, [
              vue.createElementVNode("div", {
                class: vue.normalizeClass(["fa fa-sharp fa-solid group-hover:text-white", __props.node.expanded ? "fa-caret-up" : "fa-caret-down"])
              }, null, 2)
            ])
          ], 10, _hoisted_2$a)) : __props.node.depth > 1 && !isMaxDepth ? (vue.openBlock(), vue.createElementBlock("button", {
            key: 1,
            class: vue.normalizeClass([
              "w-full text-left flex px-2 py-1.5 pl-2",
              __props.node.expanded ? "bg-secondary text-tertiary" : "bg-white text-primary"
            ]),
            "aria-expanded": __props.node.expanded,
            onClick: _cache[1] || (_cache[1] = ($event) => toggleParent(__props.node)),
            "data-cy": `parentLayerLabel-${__props.node.id}`
          }, [
            vue.createElementVNode("div", _hoisted_6$3, vue.toDisplayString(vue.unref(label)), 1),
            vue.createElementVNode("div", _hoisted_7$2, [
              vue.createElementVNode("div", {
                class: vue.normalizeClass(["fa-sharp fa-solid", __props.node.expanded ? "fa-minus" : "fa-plus"])
              }, null, 2)
            ])
          ], 10, _hoisted_5$6)) : vue.createCommentVNode("", true),
          !isMaxDepth ? (vue.openBlock(), vue.createElementBlock("div", {
            key: 2,
            class: vue.normalizeClass(["bg-secondary", [
              { "pl-2": __props.node.depth > 1 },
              { "lux-collapse": !isRoot },
              { expanded: !isRoot && __props.node.expanded }
            ]])
          }, [
            (vue.openBlock(true), vue.createElementBlock(vue.Fragment, null, vue.renderList(__props.node.children, (child) => {
              return vue.openBlock(), vue.createBlock(_component_layer_tree_node, {
                key: child.id,
                node: child,
                onToggleParent: _cache[2] || (_cache[2] = ($event) => toggleParent($event)),
                onToggleLayer: _cache[3] || (_cache[3] = ($event) => toggleLayer($event))
              }, null, 8, ["node"]);
            }), 128))
          ], 2)) : vue.createCommentVNode("", true)
        ])) : (vue.openBlock(), vue.createElementBlock("div", _hoisted_8$2, [
          vue.createElementVNode("button", {
            class: "self-start before:text-[.85rem] before:transform before:translate-y-[.1rem] before:inline-block before:content-['\\f129'] fa-solid fa-fw fa-fh fa-info",
            onClick: _cache[4] || (_cache[4] = ($event) => vue.unref(setMetadataId)(__props.node.id))
          }),
          vue.createElementVNode("button", {
            class: vue.normalizeClass(["w-full text-left", { "font-bold": __props.node.checked }]),
            onClick: _cache[5] || (_cache[5] = ($event) => toggleLayer(__props.node)),
            "data-cy": `layerLabel-${__props.node.id}`
          }, [
            vue.createElementVNode("i", {
              class: vue.normalizeClass(["fa-solid", __props.node.checked ? "fa-check-square" : "fa-square"])
            }, null, 2),
            vue.createElementVNode("span", _hoisted_10$2, vue.toDisplayString(vue.unref(label)), 1)
          ], 10, _hoisted_9$2)
        ]));
      };
    }
  });
  function themesToLayerTree(node, depth = 0) {
    const { name, id, children, metadata } = node;
    return {
      name,
      id,
      depth,
      children: children == null ? void 0 : children.map((child) => themesToLayerTree(child, depth + 1)),
      checked: false,
      expanded: (metadata == null ? void 0 : metadata.is_expanded) || false
    };
  }
  class LayerTreeService {
    toggleNode(id, node, propertyName) {
      var _a;
      if ((node == null ? void 0 : node.id) === id) {
        return {
          ...node,
          [propertyName]: !node[propertyName]
        };
      } else {
        return {
          ...node,
          children: (_a = node.children) == null ? void 0 : _a.map(
            (child) => this.toggleNode(id, child, propertyName)
          )
        };
      }
    }
    updateLayers(node, layers) {
      const { id } = node;
      if (node.children) {
        return {
          ...node,
          children: node.children.map((child) => this.updateLayers(child, layers))
        };
      } else {
        const checked = !!(layers == null ? void 0 : layers.find((l) => l.id === id));
        return {
          ...node,
          checked
        };
      }
    }
  }
  const layerTreeService = new LayerTreeService();
  const _sfc_main$h = /* @__PURE__ */ vue.defineComponent({
    __name: "catalog-tree",
    setup(__props) {
      const mapStore = useMapStore();
      const themeStore = useThemeStore();
      const layers = useLayers();
      const layerTree = vue.shallowRef();
      vue.watchEffect(updateLayerTree);
      function updateLayerTree() {
        var _a;
        if (themeStore.theme && mapStore.layers) {
          const treeModel = layerTree.value && layerTree.value.id === ((_a = themeStore.theme) == null ? void 0 : _a.id) ? layerTree.value : themesToLayerTree(themeStore.theme);
          layerTree.value = layerTreeService.updateLayers(
            treeModel,
            mapStore.layers
          );
        }
      }
      function toggleParent(node) {
        layerTree.value = layerTreeService.toggleNode(
          node.id,
          layerTree.value,
          "expanded"
        );
      }
      function toggleLayer(node) {
        layers.toggleLayer(+node.id, !node.checked);
      }
      return (_ctx, _cache) => {
        return vue.unref(layerTree) ? (vue.openBlock(), vue.createBlock(_sfc_main$i, {
          node: vue.unref(layerTree),
          key: vue.unref(layerTree).id,
          onToggleParent: toggleParent,
          onToggleLayer: toggleLayer
        }, null, 8, ["node"])) : vue.createCommentVNode("", true);
      };
    }
  });
  function _typeof$2(obj) {
    "@babel/helpers - typeof";
    return _typeof$2 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(obj2) {
      return typeof obj2;
    } : function(obj2) {
      return obj2 && "function" == typeof Symbol && obj2.constructor === Symbol && obj2 !== Symbol.prototype ? "symbol" : typeof obj2;
    }, _typeof$2(obj);
  }
  var arr = [];
  var each = arr.forEach;
  var slice = arr.slice;
  function defaults$2(obj) {
    each.call(slice.call(arguments, 1), function(source) {
      if (source) {
        for (var prop in source) {
          if (obj[prop] === void 0)
            obj[prop] = source[prop];
        }
      }
    });
    return obj;
  }
  function hasXMLHttpRequest() {
    return typeof XMLHttpRequest === "function" || (typeof XMLHttpRequest === "undefined" ? "undefined" : _typeof$2(XMLHttpRequest)) === "object";
  }
  function isPromise(maybePromise) {
    return !!maybePromise && typeof maybePromise.then === "function";
  }
  function makePromise(maybePromise) {
    if (isPromise(maybePromise)) {
      return maybePromise;
    }
    return Promise.resolve(maybePromise);
  }
  var commonjsGlobal = typeof globalThis !== "undefined" ? globalThis : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : {};
  function commonjsRequire(path) {
    throw new Error('Could not dynamically require "' + path + '". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');
  }
  var getFetch$1 = { exports: {} };
  var browserPonyfill = { exports: {} };
  var hasRequiredBrowserPonyfill;
  function requireBrowserPonyfill() {
    if (hasRequiredBrowserPonyfill)
      return browserPonyfill.exports;
    hasRequiredBrowserPonyfill = 1;
    (function(module2, exports3) {
      var global2 = typeof self !== "undefined" ? self : commonjsGlobal;
      var __self__ = function() {
        function F() {
          this.fetch = false;
          this.DOMException = global2.DOMException;
        }
        F.prototype = global2;
        return new F();
      }();
      (function(self2) {
        (function(exports4) {
          var support = {
            searchParams: "URLSearchParams" in self2,
            iterable: "Symbol" in self2 && "iterator" in Symbol,
            blob: "FileReader" in self2 && "Blob" in self2 && function() {
              try {
                new Blob();
                return true;
              } catch (e) {
                return false;
              }
            }(),
            formData: "FormData" in self2,
            arrayBuffer: "ArrayBuffer" in self2
          };
          function isDataView(obj) {
            return obj && DataView.prototype.isPrototypeOf(obj);
          }
          if (support.arrayBuffer) {
            var viewClasses = [
              "[object Int8Array]",
              "[object Uint8Array]",
              "[object Uint8ClampedArray]",
              "[object Int16Array]",
              "[object Uint16Array]",
              "[object Int32Array]",
              "[object Uint32Array]",
              "[object Float32Array]",
              "[object Float64Array]"
            ];
            var isArrayBufferView = ArrayBuffer.isView || function(obj) {
              return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1;
            };
          }
          function normalizeName(name) {
            if (typeof name !== "string") {
              name = String(name);
            }
            if (/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(name)) {
              throw new TypeError("Invalid character in header field name");
            }
            return name.toLowerCase();
          }
          function normalizeValue(value) {
            if (typeof value !== "string") {
              value = String(value);
            }
            return value;
          }
          function iteratorFor(items) {
            var iterator = {
              next: function() {
                var value = items.shift();
                return { done: value === void 0, value };
              }
            };
            if (support.iterable) {
              iterator[Symbol.iterator] = function() {
                return iterator;
              };
            }
            return iterator;
          }
          function Headers2(headers) {
            this.map = {};
            if (headers instanceof Headers2) {
              headers.forEach(function(value, name) {
                this.append(name, value);
              }, this);
            } else if (Array.isArray(headers)) {
              headers.forEach(function(header) {
                this.append(header[0], header[1]);
              }, this);
            } else if (headers) {
              Object.getOwnPropertyNames(headers).forEach(function(name) {
                this.append(name, headers[name]);
              }, this);
            }
          }
          Headers2.prototype.append = function(name, value) {
            name = normalizeName(name);
            value = normalizeValue(value);
            var oldValue = this.map[name];
            this.map[name] = oldValue ? oldValue + ", " + value : value;
          };
          Headers2.prototype["delete"] = function(name) {
            delete this.map[normalizeName(name)];
          };
          Headers2.prototype.get = function(name) {
            name = normalizeName(name);
            return this.has(name) ? this.map[name] : null;
          };
          Headers2.prototype.has = function(name) {
            return this.map.hasOwnProperty(normalizeName(name));
          };
          Headers2.prototype.set = function(name, value) {
            this.map[normalizeName(name)] = normalizeValue(value);
          };
          Headers2.prototype.forEach = function(callback, thisArg) {
            for (var name in this.map) {
              if (this.map.hasOwnProperty(name)) {
                callback.call(thisArg, this.map[name], name, this);
              }
            }
          };
          Headers2.prototype.keys = function() {
            var items = [];
            this.forEach(function(value, name) {
              items.push(name);
            });
            return iteratorFor(items);
          };
          Headers2.prototype.values = function() {
            var items = [];
            this.forEach(function(value) {
              items.push(value);
            });
            return iteratorFor(items);
          };
          Headers2.prototype.entries = function() {
            var items = [];
            this.forEach(function(value, name) {
              items.push([name, value]);
            });
            return iteratorFor(items);
          };
          if (support.iterable) {
            Headers2.prototype[Symbol.iterator] = Headers2.prototype.entries;
          }
          function consumed(body) {
            if (body.bodyUsed) {
              return Promise.reject(new TypeError("Already read"));
            }
            body.bodyUsed = true;
          }
          function fileReaderReady(reader) {
            return new Promise(function(resolve, reject) {
              reader.onload = function() {
                resolve(reader.result);
              };
              reader.onerror = function() {
                reject(reader.error);
              };
            });
          }
          function readBlobAsArrayBuffer(blob) {
            var reader = new FileReader();
            var promise = fileReaderReady(reader);
            reader.readAsArrayBuffer(blob);
            return promise;
          }
          function readBlobAsText(blob) {
            var reader = new FileReader();
            var promise = fileReaderReady(reader);
            reader.readAsText(blob);
            return promise;
          }
          function readArrayBufferAsText(buf) {
            var view = new Uint8Array(buf);
            var chars2 = new Array(view.length);
            for (var i = 0; i < view.length; i++) {
              chars2[i] = String.fromCharCode(view[i]);
            }
            return chars2.join("");
          }
          function bufferClone(buf) {
            if (buf.slice) {
              return buf.slice(0);
            } else {
              var view = new Uint8Array(buf.byteLength);
              view.set(new Uint8Array(buf));
              return view.buffer;
            }
          }
          function Body() {
            this.bodyUsed = false;
            this._initBody = function(body) {
              this._bodyInit = body;
              if (!body) {
                this._bodyText = "";
              } else if (typeof body === "string") {
                this._bodyText = body;
              } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {
                this._bodyBlob = body;
              } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {
                this._bodyFormData = body;
              } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {
                this._bodyText = body.toString();
              } else if (support.arrayBuffer && support.blob && isDataView(body)) {
                this._bodyArrayBuffer = bufferClone(body.buffer);
                this._bodyInit = new Blob([this._bodyArrayBuffer]);
              } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {
                this._bodyArrayBuffer = bufferClone(body);
              } else {
                this._bodyText = body = Object.prototype.toString.call(body);
              }
              if (!this.headers.get("content-type")) {
                if (typeof body === "string") {
                  this.headers.set("content-type", "text/plain;charset=UTF-8");
                } else if (this._bodyBlob && this._bodyBlob.type) {
                  this.headers.set("content-type", this._bodyBlob.type);
                } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {
                  this.headers.set("content-type", "application/x-www-form-urlencoded;charset=UTF-8");
                }
              }
            };
            if (support.blob) {
              this.blob = function() {
                var rejected = consumed(this);
                if (rejected) {
                  return rejected;
                }
                if (this._bodyBlob) {
                  return Promise.resolve(this._bodyBlob);
                } else if (this._bodyArrayBuffer) {
                  return Promise.resolve(new Blob([this._bodyArrayBuffer]));
                } else if (this._bodyFormData) {
                  throw new Error("could not read FormData body as blob");
                } else {
                  return Promise.resolve(new Blob([this._bodyText]));
                }
              };
              this.arrayBuffer = function() {
                if (this._bodyArrayBuffer) {
                  return consumed(this) || Promise.resolve(this._bodyArrayBuffer);
                } else {
                  return this.blob().then(readBlobAsArrayBuffer);
                }
              };
            }
            this.text = function() {
              var rejected = consumed(this);
              if (rejected) {
                return rejected;
              }
              if (this._bodyBlob) {
                return readBlobAsText(this._bodyBlob);
              } else if (this._bodyArrayBuffer) {
                return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer));
              } else if (this._bodyFormData) {
                throw new Error("could not read FormData body as text");
              } else {
                return Promise.resolve(this._bodyText);
              }
            };
            if (support.formData) {
              this.formData = function() {
                return this.text().then(decode2);
              };
            }
            this.json = function() {
              return this.text().then(JSON.parse);
            };
            return this;
          }
          var methods = ["DELETE", "GET", "HEAD", "OPTIONS", "POST", "PUT"];
          function normalizeMethod(method) {
            var upcased = method.toUpperCase();
            return methods.indexOf(upcased) > -1 ? upcased : method;
          }
          function Request2(input, options) {
            options = options || {};
            var body = options.body;
            if (input instanceof Request2) {
              if (input.bodyUsed) {
                throw new TypeError("Already read");
              }
              this.url = input.url;
              this.credentials = input.credentials;
              if (!options.headers) {
                this.headers = new Headers2(input.headers);
              }
              this.method = input.method;
              this.mode = input.mode;
              this.signal = input.signal;
              if (!body && input._bodyInit != null) {
                body = input._bodyInit;
                input.bodyUsed = true;
              }
            } else {
              this.url = String(input);
            }
            this.credentials = options.credentials || this.credentials || "same-origin";
            if (options.headers || !this.headers) {
              this.headers = new Headers2(options.headers);
            }
            this.method = normalizeMethod(options.method || this.method || "GET");
            this.mode = options.mode || this.mode || null;
            this.signal = options.signal || this.signal;
            this.referrer = null;
            if ((this.method === "GET" || this.method === "HEAD") && body) {
              throw new TypeError("Body not allowed for GET or HEAD requests");
            }
            this._initBody(body);
          }
          Request2.prototype.clone = function() {
            return new Request2(this, { body: this._bodyInit });
          };
          function decode2(body) {
            var form = new FormData();
            body.trim().split("&").forEach(function(bytes) {
              if (bytes) {
                var split = bytes.split("=");
                var name = split.shift().replace(/\+/g, " ");
                var value = split.join("=").replace(/\+/g, " ");
                form.append(decodeURIComponent(name), decodeURIComponent(value));
              }
            });
            return form;
          }
          function parseHeaders(rawHeaders) {
            var headers = new Headers2();
            var preProcessedHeaders = rawHeaders.replace(/\r?\n[\t ]+/g, " ");
            preProcessedHeaders.split(/\r?\n/).forEach(function(line) {
              var parts = line.split(":");
              var key = parts.shift().trim();
              if (key) {
                var value = parts.join(":").trim();
                headers.append(key, value);
              }
            });
            return headers;
          }
          Body.call(Request2.prototype);
          function Response2(bodyInit, options) {
            if (!options) {
              options = {};
            }
            this.type = "default";
            this.status = options.status === void 0 ? 200 : options.status;
            this.ok = this.status >= 200 && this.status < 300;
            this.statusText = "statusText" in options ? options.statusText : "OK";
            this.headers = new Headers2(options.headers);
            this.url = options.url || "";
            this._initBody(bodyInit);
          }
          Body.call(Response2.prototype);
          Response2.prototype.clone = function() {
            return new Response2(this._bodyInit, {
              status: this.status,
              statusText: this.statusText,
              headers: new Headers2(this.headers),
              url: this.url
            });
          };
          Response2.error = function() {
            var response = new Response2(null, { status: 0, statusText: "" });
            response.type = "error";
            return response;
          };
          var redirectStatuses = [301, 302, 303, 307, 308];
          Response2.redirect = function(url, status) {
            if (redirectStatuses.indexOf(status) === -1) {
              throw new RangeError("Invalid status code");
            }
            return new Response2(null, { status, headers: { location: url } });
          };
          exports4.DOMException = self2.DOMException;
          try {
            new exports4.DOMException();
          } catch (err) {
            exports4.DOMException = function(message, name) {
              this.message = message;
              this.name = name;
              var error = Error(message);
              this.stack = error.stack;
            };
            exports4.DOMException.prototype = Object.create(Error.prototype);
            exports4.DOMException.prototype.constructor = exports4.DOMException;
          }
          function fetch2(input, init2) {
            return new Promise(function(resolve, reject) {
              var request2 = new Request2(input, init2);
              if (request2.signal && request2.signal.aborted) {
                return reject(new exports4.DOMException("Aborted", "AbortError"));
              }
              var xhr = new XMLHttpRequest();
              function abortXhr() {
                xhr.abort();
              }
              xhr.onload = function() {
                var options = {
                  status: xhr.status,
                  statusText: xhr.statusText,
                  headers: parseHeaders(xhr.getAllResponseHeaders() || "")
                };
                options.url = "responseURL" in xhr ? xhr.responseURL : options.headers.get("X-Request-URL");
                var body = "response" in xhr ? xhr.response : xhr.responseText;
                resolve(new Response2(body, options));
              };
              xhr.onerror = function() {
                reject(new TypeError("Network request failed"));
              };
              xhr.ontimeout = function() {
                reject(new TypeError("Network request failed"));
              };
              xhr.onabort = function() {
                reject(new exports4.DOMException("Aborted", "AbortError"));
              };
              xhr.open(request2.method, request2.url, true);
              if (request2.credentials === "include") {
                xhr.withCredentials = true;
              } else if (request2.credentials === "omit") {
                xhr.withCredentials = false;
              }
              if ("responseType" in xhr && support.blob) {
                xhr.responseType = "blob";
              }
              request2.headers.forEach(function(value, name) {
                xhr.setRequestHeader(name, value);
              });
              if (request2.signal) {
                request2.signal.addEventListener("abort", abortXhr);
                xhr.onreadystatechange = function() {
                  if (xhr.readyState === 4) {
                    request2.signal.removeEventListener("abort", abortXhr);
                  }
                };
              }
              xhr.send(typeof request2._bodyInit === "undefined" ? null : request2._bodyInit);
            });
          }
          fetch2.polyfill = true;
          if (!self2.fetch) {
            self2.fetch = fetch2;
            self2.Headers = Headers2;
            self2.Request = Request2;
            self2.Response = Response2;
          }
          exports4.Headers = Headers2;
          exports4.Request = Request2;
          exports4.Response = Response2;
          exports4.fetch = fetch2;
          Object.defineProperty(exports4, "__esModule", { value: true });
          return exports4;
        })({});
      })(__self__);
      __self__.fetch.ponyfill = true;
      delete __self__.fetch.polyfill;
      var ctx = __self__;
      exports3 = ctx.fetch;
      exports3.default = ctx.fetch;
      exports3.fetch = ctx.fetch;
      exports3.Headers = ctx.Headers;
      exports3.Request = ctx.Request;
      exports3.Response = ctx.Response;
      module2.exports = exports3;
    })(browserPonyfill, browserPonyfill.exports);
    return browserPonyfill.exports;
  }
  (function(module2, exports3) {
    var fetchApi2;
    if (typeof fetch === "function") {
      if (typeof commonjsGlobal !== "undefined" && commonjsGlobal.fetch) {
        fetchApi2 = commonjsGlobal.fetch;
      } else if (typeof window !== "undefined" && window.fetch) {
        fetchApi2 = window.fetch;
      } else {
        fetchApi2 = fetch;
      }
    }
    if (typeof commonjsRequire !== "undefined" && (typeof window === "undefined" || typeof window.document === "undefined")) {
      var f = fetchApi2 || requireBrowserPonyfill();
      if (f.default)
        f = f.default;
      exports3.default = f;
      module2.exports = exports3.default;
    }
  })(getFetch$1, getFetch$1.exports);
  const getFetch = getFetch$1.exports;
  const fetchNode = /* @__PURE__ */ _mergeNamespaces({
    __proto__: null,
    default: getFetch
  }, [getFetch$1.exports]);
  function _typeof$1(obj) {
    "@babel/helpers - typeof";
    return _typeof$1 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(obj2) {
      return typeof obj2;
    } : function(obj2) {
      return obj2 && "function" == typeof Symbol && obj2.constructor === Symbol && obj2 !== Symbol.prototype ? "symbol" : typeof obj2;
    }, _typeof$1(obj);
  }
  var fetchApi;
  if (typeof fetch === "function") {
    if (typeof global !== "undefined" && global.fetch) {
      fetchApi = global.fetch;
    } else if (typeof window !== "undefined" && window.fetch) {
      fetchApi = window.fetch;
    } else {
      fetchApi = fetch;
    }
  }
  var XmlHttpRequestApi;
  if (hasXMLHttpRequest()) {
    if (typeof global !== "undefined" && global.XMLHttpRequest) {
      XmlHttpRequestApi = global.XMLHttpRequest;
    } else if (typeof window !== "undefined" && window.XMLHttpRequest) {
      XmlHttpRequestApi = window.XMLHttpRequest;
    }
  }
  var ActiveXObjectApi;
  if (typeof ActiveXObject === "function") {
    if (typeof global !== "undefined" && global.ActiveXObject) {
      ActiveXObjectApi = global.ActiveXObject;
    } else if (typeof window !== "undefined" && window.ActiveXObject) {
      ActiveXObjectApi = window.ActiveXObject;
    }
  }
  if (!fetchApi && fetchNode && !XmlHttpRequestApi && !ActiveXObjectApi)
    fetchApi = getFetch || fetchNode;
  if (typeof fetchApi !== "function")
    fetchApi = void 0;
  var addQueryString = function addQueryString2(url, params2) {
    if (params2 && _typeof$1(params2) === "object") {
      var queryString = "";
      for (var paramName in params2) {
        queryString += "&" + encodeURIComponent(paramName) + "=" + encodeURIComponent(params2[paramName]);
      }
      if (!queryString)
        return url;
      url = url + (url.indexOf("?") !== -1 ? "&" : "?") + queryString.slice(1);
    }
    return url;
  };
  var fetchIt = function fetchIt2(url, fetchOptions, callback) {
    fetchApi(url, fetchOptions).then(function(response) {
      if (!response.ok)
        return callback(response.statusText || "Error", {
          status: response.status
        });
      response.text().then(function(data) {
        callback(null, {
          status: response.status,
          data
        });
      }).catch(callback);
    }).catch(callback);
  };
  var omitFetchOptions = false;
  var requestWithFetch = function requestWithFetch2(options, url, payload, callback) {
    if (options.queryStringParams) {
      url = addQueryString(url, options.queryStringParams);
    }
    var headers = defaults$2({}, typeof options.customHeaders === "function" ? options.customHeaders() : options.customHeaders);
    if (payload)
      headers["Content-Type"] = "application/json";
    var reqOptions = typeof options.requestOptions === "function" ? options.requestOptions(payload) : options.requestOptions;
    var fetchOptions = defaults$2({
      method: payload ? "POST" : "GET",
      body: payload ? options.stringify(payload) : void 0,
      headers
    }, omitFetchOptions ? {} : reqOptions);
    try {
      fetchIt(url, fetchOptions, callback);
    } catch (e) {
      if (!reqOptions || Object.keys(reqOptions).length === 0 || !e.message || e.message.indexOf("not implemented") < 0) {
        return callback(e);
      }
      try {
        Object.keys(reqOptions).forEach(function(opt) {
          delete fetchOptions[opt];
        });
        fetchIt(url, fetchOptions, callback);
        omitFetchOptions = true;
      } catch (err) {
        callback(err);
      }
    }
  };
  var requestWithXmlHttpRequest = function requestWithXmlHttpRequest2(options, url, payload, callback) {
    if (payload && _typeof$1(payload) === "object") {
      payload = addQueryString("", payload).slice(1);
    }
    if (options.queryStringParams) {
      url = addQueryString(url, options.queryStringParams);
    }
    try {
      var x;
      if (XmlHttpRequestApi) {
        x = new XmlHttpRequestApi();
      } else {
        x = new ActiveXObjectApi("MSXML2.XMLHTTP.3.0");
      }
      x.open(payload ? "POST" : "GET", url, 1);
      if (!options.crossDomain) {
        x.setRequestHeader("X-Requested-With", "XMLHttpRequest");
      }
      x.withCredentials = !!options.withCredentials;
      if (payload) {
        x.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
      }
      if (x.overrideMimeType) {
        x.overrideMimeType("application/json");
      }
      var h = options.customHeaders;
      h = typeof h === "function" ? h() : h;
      if (h) {
        for (var i in h) {
          x.setRequestHeader(i, h[i]);
        }
      }
      x.onreadystatechange = function() {
        x.readyState > 3 && callback(x.status >= 400 ? x.statusText : null, {
          status: x.status,
          data: x.responseText
        });
      };
      x.send(payload);
    } catch (e) {
      console && console.log(e);
    }
  };
  var request = function request2(options, url, payload, callback) {
    if (typeof payload === "function") {
      callback = payload;
      payload = void 0;
    }
    callback = callback || function() {
    };
    if (fetchApi && url.indexOf("file:") !== 0) {
      return requestWithFetch(options, url, payload, callback);
    }
    if (hasXMLHttpRequest() || typeof ActiveXObject === "function") {
      return requestWithXmlHttpRequest(options, url, payload, callback);
    }
    callback(new Error("No fetch and no xhr implementation found!"));
  };
  function _typeof(obj) {
    "@babel/helpers - typeof";
    return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(obj2) {
      return typeof obj2;
    } : function(obj2) {
      return obj2 && "function" == typeof Symbol && obj2.constructor === Symbol && obj2 !== Symbol.prototype ? "symbol" : typeof obj2;
    }, _typeof(obj);
  }
  function _classCallCheck(instance2, Constructor) {
    if (!(instance2 instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }
  function _defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor)
        descriptor.writable = true;
      Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);
    }
  }
  function _createClass(Constructor, protoProps, staticProps) {
    if (protoProps)
      _defineProperties(Constructor.prototype, protoProps);
    if (staticProps)
      _defineProperties(Constructor, staticProps);
    Object.defineProperty(Constructor, "prototype", { writable: false });
    return Constructor;
  }
  function _defineProperty(obj, key, value) {
    key = _toPropertyKey(key);
    if (key in obj) {
      Object.defineProperty(obj, key, { value, enumerable: true, configurable: true, writable: true });
    } else {
      obj[key] = value;
    }
    return obj;
  }
  function _toPropertyKey(arg) {
    var key = _toPrimitive(arg, "string");
    return _typeof(key) === "symbol" ? key : String(key);
  }
  function _toPrimitive(input, hint) {
    if (_typeof(input) !== "object" || input === null)
      return input;
    var prim = input[Symbol.toPrimitive];
    if (prim !== void 0) {
      var res = prim.call(input, hint || "default");
      if (_typeof(res) !== "object")
        return res;
      throw new TypeError("@@toPrimitive must return a primitive value.");
    }
    return (hint === "string" ? String : Number)(input);
  }
  var getDefaults = function getDefaults2() {
    return {
      loadPath: "/locales/{{lng}}/{{ns}}.json",
      addPath: "/locales/add/{{lng}}/{{ns}}",
      allowMultiLoading: false,
      parse: function parse2(data) {
        return JSON.parse(data);
      },
      stringify: JSON.stringify,
      parsePayload: function parsePayload(namespace, key, fallbackValue) {
        return _defineProperty({}, key, fallbackValue || "");
      },
      request,
      reloadInterval: typeof window !== "undefined" ? false : 60 * 60 * 1e3,
      customHeaders: {},
      queryStringParams: {},
      crossDomain: false,
      withCredentials: false,
      overrideMimeType: false,
      requestOptions: {
        mode: "cors",
        credentials: "same-origin",
        cache: "default"
      }
    };
  };
  var Backend = function() {
    function Backend2(services) {
      var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
      var allOptions = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
      _classCallCheck(this, Backend2);
      this.services = services;
      this.options = options;
      this.allOptions = allOptions;
      this.type = "backend";
      this.init(services, options, allOptions);
    }
    _createClass(Backend2, [{
      key: "init",
      value: function init2(services) {
        var _this = this;
        var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        var allOptions = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
        this.services = services;
        this.options = defaults$2(options, this.options || {}, getDefaults());
        this.allOptions = allOptions;
        if (this.services && this.options.reloadInterval) {
          setInterval(function() {
            return _this.reload();
          }, this.options.reloadInterval);
        }
      }
    }, {
      key: "readMulti",
      value: function readMulti(languages, namespaces, callback) {
        this._readAny(languages, languages, namespaces, namespaces, callback);
      }
    }, {
      key: "read",
      value: function read(language, namespace, callback) {
        this._readAny([language], language, [namespace], namespace, callback);
      }
    }, {
      key: "_readAny",
      value: function _readAny(languages, loadUrlLanguages, namespaces, loadUrlNamespaces, callback) {
        var _this2 = this;
        var loadPath = this.options.loadPath;
        if (typeof this.options.loadPath === "function") {
          loadPath = this.options.loadPath(languages, namespaces);
        }
        loadPath = makePromise(loadPath);
        loadPath.then(function(resolvedLoadPath) {
          if (!resolvedLoadPath)
            return callback(null, {});
          var url = _this2.services.interpolator.interpolate(resolvedLoadPath, {
            lng: languages.join("+"),
            ns: namespaces.join("+")
          });
          _this2.loadUrl(url, callback, loadUrlLanguages, loadUrlNamespaces);
        });
      }
    }, {
      key: "loadUrl",
      value: function loadUrl(url, callback, languages, namespaces) {
        var _this3 = this;
        this.options.request(this.options, url, void 0, function(err, res) {
          if (res && (res.status >= 500 && res.status < 600 || !res.status))
            return callback("failed loading " + url + "; status code: " + res.status, true);
          if (res && res.status >= 400 && res.status < 500)
            return callback("failed loading " + url + "; status code: " + res.status, false);
          if (!res && err && err.message && err.message.indexOf("Failed to fetch") > -1)
            return callback("failed loading " + url + ": " + err.message, true);
          if (err)
            return callback(err, false);
          var ret, parseErr;
          try {
            if (typeof res.data === "string") {
              ret = _this3.options.parse(res.data, languages, namespaces);
            } else {
              ret = res.data;
            }
          } catch (e) {
            parseErr = "failed parsing " + url + " to json";
          }
          if (parseErr)
            return callback(parseErr, false);
          callback(null, ret);
        });
      }
    }, {
      key: "create",
      value: function create2(languages, namespace, key, fallbackValue, callback) {
        var _this4 = this;
        if (!this.options.addPath)
          return;
        if (typeof languages === "string")
          languages = [languages];
        var payload = this.options.parsePayload(namespace, key, fallbackValue);
        var finished = 0;
        var dataArray = [];
        var resArray = [];
        languages.forEach(function(lng) {
          var addPath = _this4.options.addPath;
          if (typeof _this4.options.addPath === "function") {
            addPath = _this4.options.addPath(lng, namespace);
          }
          var url = _this4.services.interpolator.interpolate(addPath, {
            lng,
            ns: namespace
          });
          _this4.options.request(_this4.options, url, payload, function(data, res) {
            finished += 1;
            dataArray.push(data);
            resArray.push(res);
            if (finished === languages.length) {
              if (typeof callback === "function")
                callback(dataArray, resArray);
            }
          });
        });
      }
    }, {
      key: "reload",
      value: function reload() {
        var _this5 = this;
        var _this$services = this.services, backendConnector = _this$services.backendConnector, languageUtils = _this$services.languageUtils, logger = _this$services.logger;
        var currentLanguage = backendConnector.language;
        if (currentLanguage && currentLanguage.toLowerCase() === "cimode")
          return;
        var toLoad = [];
        var append = function append2(lng) {
          var lngs = languageUtils.toResolveHierarchy(lng);
          lngs.forEach(function(l) {
            if (toLoad.indexOf(l) < 0)
              toLoad.push(l);
          });
        };
        append(currentLanguage);
        if (this.allOptions.preload)
          this.allOptions.preload.forEach(function(l) {
            return append(l);
          });
        toLoad.forEach(function(lng) {
          _this5.allOptions.ns.forEach(function(ns) {
            backendConnector.read(lng, ns, "read", null, null, function(err, data) {
              if (err)
                logger.warn("loading namespace ".concat(ns, " for language ").concat(lng, " failed"), err);
              if (!err && data)
                logger.log("loaded namespace ".concat(ns, " for language ").concat(lng), data);
              backendConnector.loaded("".concat(lng, "|").concat(ns), err, data);
            });
          });
        });
      }
    }]);
    return Backend2;
  }();
  Backend.type = "backend";
  const ol = "";
  const _imports_0 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAM0AAAAoCAMAAABq645qAAACPVBMVEUAAABaW13////tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy5aW13tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy5aW13tGy7tGy7tGy7tGy7tGy7tGy7tGy5aW13tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy5aW13tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy5aW13tGy7tGy7tGy7tGy7tGy7tGy7tGy5aW13tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy5aW13tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy5aW13tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy5aW13tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy5aW13tGy7tGy7tGy7tGy7tGy7tGy7tGy5aW13tGy7tGy5aW13tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy5aW13tGy7tGy7tGy5aW13tGy7tGy7tGy7tGy7tGy7tGy7tGy5aW13tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy5aW13tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy7tGy5aW13tGy5DjxTaAAAAvXRSTlMAAAABAgMEBQYHCAkKCwwNDg8QERESFBUWFxkaGx0eHyAhIiInKSosMTIzNTY5Ojs8PUFCQ0RERkpMTk9QU1RVVldaXmFjZWZmamtwcXJzdXd3eHl7fX+AgYKDhIaHiIiKi4yOj5CTlJWWl5iZmZqcnZ+goaKjpKanqKqqq6ywsbK0tbW4u7u8vb6/wMHExcbHysvMzM7P0NDS1NXa29zd3t/g4eTl5ujp6uvs7e7u8PLz9PX29/j5+vv8/f5cALqzAAAEcklEQVRo3u3Z+ZPUVBAH8O63LsLKijoIgotHFI+HgiKNeGC8MCqgUUFAJYjgAQ6HKMgGEQQiqChIPFh1iciiwPIEhvv49t/mD5lBORa2tHbLTO2rmqnUTCrJZ3r65ZuEjDHGGLrMWGcKMah7mh/7NP8PzXBqbqgfzdtPb7i/fjQPvq8r5jUVXNNIY4moYeL6+XNfn9Ov6LUZ2/Z7Pxo3YaZWTp/uLPw/reXYbqLRPz/38g+qJ/oTEV396IzmgmquXHZoIRHd/sTs31T1DqIBcyqHZjQWtTbf6nQiokHLVVWn7ju4euXGjsX9LtTAGgPAGGMzOPZSOGFYtmAXsO8skFkgZovQgi2QcZKyIGAAjJQtIgAB/5vRTc2IvbqSqOWNJQdUVdfe+/zitmsu2jeQ/GWMC43HacRhxhAWcJRyEgmYBSVYgROwgJkzeGVEDGEGotqnPaih1Xp63KSvVFVVtz0wt23AvMVda5AZY2FM7OWO/N2DwBMgESBiQZyABUgYSYQkYSBjhAh7QXN3Zfey7YdyzXh6aQpdu2fIpWsD30CykKOU4XPgmBPEnNcmC1jgIT9uCx9ZkOW1kQi9oBm6aMvO3KIVomUPES19/KIaoNo34uA8cUgtB4DzmQXCFoCFhbXgMtgC8DNGKMj7xnIKtj2toeGf55X5c9+ZRpo1lWjyq5c/33Avj+5obpz25miiwd+p6q4/2jfvIrqtrYlemF5MzZObTuhHCw6cUd2y/91ftj5DRJOn0JKniqm56jPtUNXDx44u6NywvaPzPqL+G5v3jCimhhqaX/vyi6VTxtzyYkVV9dSsRvrmnVXUI5oo7GkNEV2RH/igaRVV1Y8fOdE+tEc0tlzqBU1tND+7U1W18t51F8/QAFJrkUccL4VjABFb+MwoMyznszWzBZxfDT2SIbZgm0/TzBbIpLqcr8GwScJxfF4UiliAgGEZ1gKx8VK4bmuafmpdrqr6cFdXBJBSORPkp9A0ZI8hAi4jYQY8CEN8MDML2K/FBBdwKU80kOp3eSBirq7BkJJLstK5UShw+eYhDBGUYNPQeN3WTND2rd+r6oquNUZQ00A49gCEJQg8RhJD8j0DQX6IEBZYMLMAAANZrpHa8lkNBwjOi0Ion90KRIDIQEzsdVfzlurhT1X11F2XqE3qwfNQMiYLGYIYNgAQMcTltXHV3z9w1dAD/8LapH/XJt9eycWudG4U8lGrjYeSIAtMFlaD1SU1NxAR0cA9qrpqr6ruaOmybxLPREBojLEOzoMNkAXsO4YNYRnIpNo3WS30+EByXt+kttY3AEdAyGmZ4/TcKORCDgDhEAg5D0wO7vK1mbmwhajxA9XWkXTTh8dVj6wZX9gr6ZFL9eTm1nbVhUREdOs2Vb25sJqmRTuOq+r+rwfmgGEHVYcU+H7a8KNrdP6kYTXBJ6qPFVjT2DxwzD/msbWqE+vnrvqvevSeutGMUm0dXC+ahk3asb5unt+8cvLIqOvr52nU7Dv7nq31afo0/0mzrhiavwAx1n2SsZnMdgAAAABJRU5ErkJggg==";
  const useAppStore = defineStore(
    "app",
    () => {
      const lang = vue.ref("fr");
      const layersOpen = vue.ref();
      function setLang(language) {
        lang.value = language;
      }
      function setLayersOpen(open2) {
        layersOpen.value = open2;
      }
      return { lang, layersOpen, setLang, setLayersOpen };
    },
    {}
  );
  class StatePersistorLangService {
    bootstrap() {
      this.restore();
      let stop;
      stop = vue.watchEffect(() => {
        this.persist();
        stop && stop();
      });
    }
    persist() {
      const appStore = useAppStore();
      const { lang } = storeToRefs(appStore);
      vue.watch(
        lang,
        (value, oldValue) => {
          if (oldValue !== value) {
            storageHelper.setValue(SP_KEY_LANG, value);
            const getHTMLTag = document.documentElement;
            getHTMLTag.setAttribute("lang", value);
          }
        },
        { immediate: true }
      );
    }
    restore() {
      const lang = storageHelper.getValue(SP_KEY_LANG);
      if (lang) {
        const { setLang } = useAppStore();
        const { i18next } = useTranslation();
        i18next.changeLanguage(lang);
        setLang(lang);
      }
    }
  }
  const statePersistorLangService = new StatePersistorLangService();
  const _sfc_main$g = /* @__PURE__ */ vue.defineComponent({
    __name: "language-selector",
    setup(__props) {
      const { i18next, t } = useTranslation();
      const { setLang } = useAppStore();
      const { lang } = storeToRefs(useAppStore());
      const availableLanguages = vue.computed(
        () => ["en", "de", "fr", "lb"].map((lang2) => ({
          label: t(lang2),
          value: lang2,
          ariaLabel: t(`Changer de langue : {{lang}}`, { lang: lang2 })
        }))
      );
      const placeholder = t("Changer de langue");
      statePersistorLangService.bootstrap();
      function changeLanguages(lang2) {
        i18next.changeLanguage(lang2);
        setLang(lang2);
      }
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock("div", null, [
          vue.createVNode(_sfc_main$o, {
            class: "lux-navbar-dropdown lux-dropdown-inline text-white h-full",
            options: vue.unref(availableLanguages),
            placeholder: vue.unref(placeholder),
            modelValue: vue.unref(lang),
            "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => vue.isRef(lang) ? lang.value = $event : null),
            onChange: changeLanguages
          }, null, 8, ["options", "placeholder", "modelValue"])
        ]);
      };
    }
  });
  class ThemeSelectorService {
    setCurrentThemeColors(theme) {
      const root = document.querySelector(":root");
      const colors = ["primary", "secondary", "tertiary"];
      colors.forEach((colorTone) => {
        const color = getComputedStyle(root).getPropertyValue(
          `--${theme.name}-${colorTone}`
        );
        root.style.setProperty(`--color-${colorTone}`, color);
      });
    }
  }
  const themeSelectorService = new ThemeSelectorService();
  const _hoisted_1$e = { class: "w-full h-14 flex bg-white shadow-header z-10 shrink-0" };
  const _hoisted_2$9 = /* @__PURE__ */ vue.createElementVNode("div", { class: "flex-2 p-[5px]" }, [
    /* @__PURE__ */ vue.createElementVNode("img", { src: _imports_0 })
  ], -1);
  const _hoisted_3$7 = /* @__PURE__ */ vue.createElementVNode("div", { class: "grow text-center" }, "search", -1);
  const _hoisted_4$6 = { class: "h-full flex" };
  const _hoisted_5$5 = { class: "hidden lg:inline-block" };
  const _hoisted_6$2 = { class: "border-l-[1px] border-stone-300 h-full" };
  const _sfc_main$f = /* @__PURE__ */ vue.defineComponent({
    __name: "header-bar",
    setup(__props) {
      const { t } = useTranslation();
      const appStore = useAppStore();
      const { layersOpen } = storeToRefs(appStore);
      const { setLayersOpen } = appStore;
      const themeStore = useThemeStore();
      const { theme } = storeToRefs(themeStore);
      vue.watch(
        theme,
        (theme2) => {
          if (theme2) {
            themeSelectorService.setCurrentThemeColors(theme2);
          }
        },
        { immediate: true }
      );
      return (_ctx, _cache) => {
        var _a, _b;
        return vue.openBlock(), vue.createElementBlock("header", _hoisted_1$e, [
          _hoisted_2$9,
          _hoisted_3$7,
          vue.createElementVNode("div", null, [
            vue.createElementVNode("ul", _hoisted_4$6, [
              vue.createElementVNode("li", null, [
                vue.createElementVNode("button", {
                  class: vue.normalizeClass(["flex items-center before:font-icons before:text-3xl before:w-16 text-primary uppercase h-full mr-3", `before:content-${(_a = vue.unref(theme)) == null ? void 0 : _a.name}`]),
                  onClick: _cache[0] || (_cache[0] = () => vue.unref(setLayersOpen)(!vue.unref(layersOpen)))
                }, [
                  vue.createElementVNode("span", _hoisted_5$5, vue.toDisplayString(vue.unref(t)(`${(_b = vue.unref(theme)) == null ? void 0 : _b.name}`)), 1)
                ], 2)
              ]),
              vue.createElementVNode("li", _hoisted_6$2, [
                vue.createVNode(_sfc_main$g, { class: "flex-none h-full" })
              ])
            ])
          ])
        ]);
      };
    }
  });
  const _hoisted_1$d = { class: "h-[42px] w-full sm:h-full sm:w-16 hover:text-white hover:bg-primary" };
  const _hoisted_2$8 = { class: "block text-[13px] sm:text-base uppercase" };
  const _sfc_main$e = /* @__PURE__ */ vue.defineComponent({
    __name: "button-icon",
    props: {
      label: null,
      icon: null
    },
    setup(__props) {
      const props = __props;
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock("button", _hoisted_1$d, [
          vue.createElementVNode("span", {
            class: vue.normalizeClass(["block text-[1.7rem] sm:text-[2rem] -mt-1.5 -mb-3 after:font-icons", `after:content-${props.icon}`])
          }, null, 2),
          vue.createElementVNode("span", _hoisted_2$8, vue.toDisplayString(props.label), 1)
        ]);
      };
    }
  });
  const _hoisted_1$c = ["href"];
  const _sfc_main$d = /* @__PURE__ */ vue.defineComponent({
    __name: "button-link",
    props: {
      label: null,
      link: null
    },
    setup(__props) {
      const props = __props;
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock("a", {
          class: "h-full flex flex-col justify-center px-[7px] uppercase hover:text-white hover:bg-primary",
          href: `${props.link}`,
          target: "_blank"
        }, vue.toDisplayString(_ctx.$props.label), 9, _hoisted_1$c);
      };
    }
  });
  const _hoisted_1$b = { class: "flex flex-col w-12 justify-between bg-white z-5 shrink-0 sm:flex-row sm:w-full sm:h-14 sm:shadow-footer" };
  const _hoisted_2$7 = { class: "flex flex-col w-full sm:w-80 sm:flex-row justify-start text-primary divide-y sm:divide-y-0 sm:divide-x divide-gray-400 divide-solid box-content border-y sm:border-y-0 border-x border-gray-400" };
  const _hoisted_3$6 = { class: "flex flex-col w-12 sm:w-64 sm:flex-row justify-start text-primary divide-y sm:divide-y-0 sm:divide-x divide-gray-400 divide-solid box-content border-y sm:border-y-0 border-x border-gray-400" };
  const _hoisted_4$5 = { class: "w-[466px] hidden sm:flex flex-row justify-end text-gray-500 whitespace-nowrap" };
  const _sfc_main$c = /* @__PURE__ */ vue.defineComponent({
    __name: "footer-bar",
    setup(__props) {
      const { t, i18next } = useTranslation();
      const { setLayersOpen } = useAppStore();
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock("footer", _hoisted_1$b, [
          vue.createElementVNode("ul", _hoisted_2$7, [
            vue.createElementVNode("li", null, [
              vue.createVNode(_sfc_main$e, {
                label: vue.unref(t)("Layers", { ns: "client" }),
                icon: "layers",
                onClick: _cache[0] || (_cache[0] = () => vue.unref(setLayersOpen)(true))
              }, null, 8, ["label"])
            ]),
            vue.createElementVNode("li", null, [
              vue.createVNode(_sfc_main$e, {
                class: "text-gray-300",
                label: vue.unref(t)("My Maps", { ns: "client" }),
                icon: "mymaps"
              }, null, 8, ["label"])
            ]),
            vue.createElementVNode("li", null, [
              vue.createVNode(_sfc_main$e, {
                class: "text-gray-300",
                label: vue.unref(t)("Infos", { ns: "client" }),
                icon: "infos"
              }, null, 8, ["label"])
            ]),
            vue.createElementVNode("li", null, [
              vue.createVNode(_sfc_main$e, {
                class: "text-gray-300",
                label: vue.unref(t)("Legends", { ns: "client" }),
                icon: "legends"
              }, null, 8, ["label"])
            ]),
            vue.createElementVNode("li", null, [
              vue.createVNode(_sfc_main$e, {
                class: "text-gray-300",
                label: vue.unref(t)("Routing", { ns: "client" }),
                icon: "routing"
              }, null, 8, ["label"])
            ])
          ]),
          vue.createElementVNode("div", _hoisted_3$6, [
            vue.createVNode(_sfc_main$e, {
              class: "text-gray-300",
              label: vue.unref(t)("Dessin", { ns: "client" }),
              icon: "draw"
            }, null, 8, ["label"]),
            vue.createVNode(_sfc_main$e, {
              class: "text-gray-300 hidden sm:block",
              label: vue.unref(t)("Mesurer", { ns: "client" }),
              icon: "measure"
            }, null, 8, ["label"]),
            vue.createVNode(_sfc_main$e, {
              class: "text-gray-300 hidden sm:block",
              label: vue.unref(t)("Imprimer", { ns: "client" }),
              icon: "print"
            }, null, 8, ["label"]),
            vue.createVNode(_sfc_main$e, {
              class: "text-gray-300",
              label: vue.unref(t)("Partager", { ns: "client" }),
              icon: "share"
            }, null, 8, ["label"])
          ]),
          vue.createElementVNode("div", _hoisted_4$5, [
            vue.createVNode(_sfc_main$d, {
              class: "hidden lg:flex",
              label: vue.unref(t)("What's new", { ns: "client" }),
              link: `https://geoportail.lu/${vue.unref(i18next).language}/questions/whats-new/`
            }, null, 8, ["label", "link"]),
            vue.createVNode(_sfc_main$d, {
              class: "hidden lg:flex",
              label: vue.unref(t)("Geocatalogue", { ns: "client" }),
              link: ""
            }, null, 8, ["label"]),
            vue.createVNode(_sfc_main$d, {
              class: "hidden lg:flex",
              label: vue.unref(t)("Feedback", { ns: "client" }),
              link: ""
            }, null, 8, ["label"]),
            vue.createVNode(_sfc_main$d, {
              class: "hidden lg:flex",
              label: vue.unref(t)("A Propos", { ns: "client" }),
              link: `https://www.geoportail.lu/${vue.unref(i18next).language}/propos/`
            }, null, 8, ["label", "link"]),
            vue.createVNode(_sfc_main$d, {
              class: "hidden lg:flex",
              label: vue.unref(t)("Aide", { ns: "client" }),
              link: `https://www.geoportail.lu/${vue.unref(i18next).language}/documentation/`
            }, null, 8, ["label", "link"]),
            vue.createVNode(_sfc_main$d, {
              class: "hidden lg:flex",
              label: vue.unref(t)("Contact", { ns: "client" }),
              link: `https://www.geoportail.lu/${vue.unref(i18next).language}/propos/contactez-nous/`
            }, null, 8, ["label", "link"]),
            vue.createVNode(_sfc_main$d, {
              label: vue.unref(t)("Legalites", { ns: "client" }),
              link: `https://www.geoportail.lu/${vue.unref(i18next).language}/propos/mentions-legales/`
            }, null, 8, ["label", "link"]),
            vue.createVNode(_sfc_main$d, {
              label: vue.unref(t)("ACT", { ns: "client" }),
              link: `http://www.act.public.lu/`
            }, null, 8, ["label", "link"])
          ])
        ]);
      };
    }
  });
  function useBackgroundLayer() {
    const theme = useThemes();
    const mapStore = useMapStore();
    const layers = useLayers();
    const defaultSelectedBgId = vue.computed(() => {
      var _a;
      const theme_name = (_a = useThemeStore().theme) == null ? void 0 : _a.name;
      if (theme_name) {
        const defaultBgLayers = bgConfigFixture().bg_layer_theme_defaults;
        return defaultBgLayers[theme_name] || getDefaultSelectedId();
      }
      return getDefaultSelectedId();
    });
    function setBgLayer(layerId) {
      const newBgLayer = theme.findBgLayerById(layerId);
      setMapBackground(newBgLayer || null);
    }
    function setMapBackground(bgLayer) {
      if (bgLayer) {
        if (bgLayer.type === "WMTS" || bgLayer.type === "BG WMTS") {
          bgLayer.type = "BG WMTS";
        } else if (bgLayer.type === "BG MVT") {
          console.log(`passed through MVT layer ${bgLayer.name}`);
        } else {
          throw new Error(
            `Only WMTS and MVT BG layers are currently implemented (not ${bgLayer.type} for ${bgLayer.name})`
          );
        }
        layers.handleExclusionLayers(bgLayer);
        mapStore.setBgLayer(layers.initLayer(bgLayer));
      } else {
        mapStore.setBgLayer(null);
      }
    }
    function getDefaultSelectedId() {
      var _a;
      return ((_a = getBgLayersFromConfig().find((l) => l.is_default)) == null ? void 0 : _a.id) || BLANK_BACKGROUNDLAYER.id;
    }
    function getNullId() {
      return BLANK_BACKGROUNDLAYER.id;
    }
    function getBgLayersFromConfig() {
      return bgConfigFixture().bg_layers;
    }
    return {
      setBgLayer,
      setMapBackground,
      getBgLayersFromConfig,
      getNullId,
      getDefaultSelectedId,
      defaultSelectedBgId
    };
  }
  var LayerImageType = /* @__PURE__ */ ((LayerImageType2) => {
    LayerImageType2["PNG"] = "image/png";
    LayerImageType2["JPG"] = "image/jpeg";
    return LayerImageType2;
  })(LayerImageType || {});
  var REMOTE_SERVICE_TYPE = /* @__PURE__ */ ((REMOTE_SERVICE_TYPE2) => {
    REMOTE_SERVICE_TYPE2["WMS"] = "WMS";
    REMOTE_SERVICE_TYPE2["WMTS"] = "WMTS";
    return REMOTE_SERVICE_TYPE2;
  })(REMOTE_SERVICE_TYPE || {});
  class EndpointError {
    constructor(message, httpStatus = 0, isCrossOriginRelated = false) {
      this.message = message;
      this.httpStatus = httpStatus;
      this.isCrossOriginRelated = isCrossOriginRelated;
    }
  }
  let counter = 0;
  function getUniqueId() {
    return counter++;
  }
  function sendTaskRequest(taskName, workerInstance2, params2) {
    return new Promise((resolve, reject) => {
      const requestId = getUniqueId();
      const request2 = {
        requestId,
        taskName,
        params: params2
      };
      if (workerInstance2 === null) {
        window.dispatchEvent(
          new CustomEvent("ogc-client.request", {
            detail: request2
          })
        );
      } else {
        workerInstance2.postMessage(request2);
      }
      const handler = ({ detail, data }) => {
        const response = detail || data;
        if (response.requestId === requestId) {
          if (workerInstance2 === null) {
            window.removeEventListener("message", handler);
          } else {
            workerInstance2.removeEventListener("message", handler);
          }
          if ("error" in response) {
            reject(response.error);
          } else {
            resolve(response.response);
          }
        }
      };
      if (workerInstance2 === null) {
        window.addEventListener("ogc-client.response", handler);
      } else {
        workerInstance2.addEventListener("message", handler);
      }
    });
  }
  function addTaskHandler(taskName, scope, handler) {
    const useWorker = typeof WorkerGlobalScope !== "undefined";
    const eventHandler = async ({ detail, data }) => {
      const request2 = detail || data;
      if (request2.taskName === taskName) {
        let response, error;
        try {
          response = await handler(request2.params);
        } catch (e) {
          error = e;
        }
        const message = {
          taskName,
          requestId: request2.requestId,
          ...response && { response },
          ...error && { error }
        };
        if (useWorker) {
          scope.postMessage(message);
        } else {
          scope.dispatchEvent(
            new CustomEvent("ogc-client.response", {
              detail: message
            })
          );
        }
      }
    };
    if (useWorker) {
      scope.addEventListener("message", eventHandler);
    } else {
      scope.addEventListener("ogc-client.request", eventHandler);
    }
  }
  let workerInstance;
  function getWorkerInstance() {
    if (!workerInstance) {
      workerInstance = new Worker(URL.createObjectURL(new Blob([`function t(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function r(t){return function(){var r=this,n=arguments;return new Promise((function(o,i){var a=t.apply(r,n);function c(t){e(a,o,i,c,u,"next",t)}function u(t){e(a,o,i,c,u,"throw",t)}c(void 0)}))}}function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}var o={exports:{}};!function(t){var e=function(t){var e,r=Object.prototype,o=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,i=Object.create(o.prototype),a=new j(n||[]);return i._invoke=function(t,e,r){var n=h;return function(o,i){if(n===v)throw new Error("Generator is already running");if(n===d){if("throw"===o)throw i;return G()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=k(a,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=v;var u=l(t,e,r);if("normal"===u.type){if(n=r.done?d:p,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=d,r.method="throw",r.arg=u.arg)}}}(t,r,a),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var h="suspendedStart",p="suspendedYield",v="executing",d="completed",y={};function m(){}function g(){}function b(){}var S={};S[a]=function(){return this};var E=Object.getPrototypeOf,w=E&&E(E(C([])));w&&w!==r&&o.call(w,a)&&(S=w);var O=b.prototype=m.prototype=Object.create(S);function x(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(i,a,c,u){var s=l(t[i],t,a);if("throw"!==s.type){var f=s.arg,h=f.value;return h&&"object"===n(h)&&o.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,c,u)}),(function(t){r("throw",t,c,u)})):e.resolve(h).then((function(t){f.value=t,c(f)}),(function(t){return r("throw",t,c,u)}))}u(s.arg)}var i;this._invoke=function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}}function k(t,r){var n=t.iterator[r.method];if(n===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method))return y;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=l(n,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function C(t){if(t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function r(){for(;++n<t.length;)if(o.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}return{next:G}}function G(){return{value:e,done:!0}}return g.prototype=O.constructor=b,b.constructor=g,g.displayName=s(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(O),t},t.awrap=function(t){return{__await:t}},x(P.prototype),P.prototype[c]=function(){return this},t.AsyncIterator=P,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new P(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(O),s(O,u,"Generator"),O[a]=function(){return this},O.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=C,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),s=o.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}(o);var i=o.exports;function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?a(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(t,e,n){var o="undefined"!=typeof WorkerGlobalScope,a=function(){var a=r(i.mark((function r(a){var u,s,f,l,h,p;return i.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(u=a.detail,s=a.data,(f=u||s).taskName!==t){r.next=14;break}return r.prev=3,r.next=6,n(f.params);case 6:l=r.sent,r.next=12;break;case 9:r.prev=9,r.t0=r.catch(3),h=r.t0;case 12:p=c(c({taskName:t,requestId:f.requestId},l&&{response:l}),h&&{error:h}),o?e.postMessage(p):e.dispatchEvent(new CustomEvent("ogc-client.response",{detail:p}));case 14:case"end":return r.stop()}}),r,null,[[3,9]])})));return function(t){return a.apply(this,arguments)}}();o?e.addEventListener("message",a):e.addEventListener("ogc-client.request",a)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function f(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}function p(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}function v(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function m(t,e,r){return m=y()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&h(o,r.prototype),o},m.apply(null,arguments)}function g(t){var e="function"==typeof Map?new Map:void 0;return g=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return m(t,arguments,d(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),h(n,t)},g(t)}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function S(t,e,r){return e&&b(t.prototype,e),r&&b(t,r),t}var E=function(){function t(e){l(this,t),this.chars=f(e),this.charCount=this.chars.length,this.charIndex=0,this.charsToBytes=new Array(this.charCount),this.multiByteMode=!1,this.string=e;var r=this.chars,n=this.charCount,o=this.charsToBytes;if(n===e.length)for(var i=0;i<n;++i)o[i]=i;else{for(var a=0,c=0;c<n;++c)o[c]=a,a+=r[c].length;this.multiByteMode=!0}}return S(t,[{key:"isEnd",get:function(){return this.charIndex>=this.charCount}},{key:"_charLength",value:function(t){var e=t.length;return e<2||!this.multiByteMode?e:t.replace(/[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g,"_").length}},{key:"advance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.charIndex=Math.min(this.charCount,this.charIndex+t)}},{key:"consume",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this.peek(t);return this.advance(t),e}},{key:"consumeMatch",value:function(t){if(!t.sticky)throw new Error('\`regex\` must have a sticky flag ("y")');t.lastIndex=this.charsToBytes[this.charIndex];var e=t.exec(this.string);if(null===e)return"";var r=e[0];return this.advance(this._charLength(r)),r}},{key:"consumeMatchFn",value:function(t){for(var e=this.charIndex;!this.isEnd&&t(this.peek());)this.advance();return this.charIndex>e?this.string.slice(this.charsToBytes[e],this.charsToBytes[this.charIndex]):""}},{key:"consumeString",value:function(t){if(this.consumeStringFast(t))return t;if(!this.multiByteMode)return"";var e=t.length,r=this._charLength(t);return r!==e&&t===this.peek(r)?(this.advance(r),t):""}},{key:"consumeStringFast",value:function(t){if(this.peek()===t[0]){var e=t.length;if(1===e)return this.advance(),t;if(this.peek(e)===t)return this.advance(e),t}return""}},{key:"consumeUntilMatch",value:function(t){if(!t.global)throw new Error('\`regex\` must have a global flag ("g")');var e=this.charsToBytes[this.charIndex];t.lastIndex=e;var r=t.exec(this.string);if(null===r||r.index===e)return"";var n=this.string.slice(e,r.index);return this.advance(this._charLength(n)),n}},{key:"consumeUntilString",value:function(t){var e=this.charIndex,r=this.charsToBytes,n=this.string,o=r[e],i=n.indexOf(t,o);if(i<=0)return"";var a=n.slice(o,i);return this.advance(this._charLength(a)),a}},{key:"peek",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.charIndex>=this.charCount)return"";if(1===t)return this.chars[this.charIndex];var e=this.charsToBytes,r=this.charIndex;return this.string.slice(e[r],e[r+t])}},{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.charIndex=t>=0?Math.min(this.charCount,t):Math.max(0,this.charIndex+t)}}]),t}(),w=E,O={},x=Object.freeze(Object.assign(Object.create(null),{amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}));function P(t){if(k(t))return!0;var e=T(t);return 45===e||46===e||e>=48&&e<=57||183===e||e>=768&&e<=879||e>=8255&&e<=8256}function k(t){var e=T(t);return 58===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}function R(t){var e=T(t);return 9===e||10===e||13===e||e>=32&&e<=55295||e>=57344&&e<=65533||e>=65536&&e<=1114111}function T(t){return t.codePointAt(0)||-1}O.predefinedEntities=x,O.isNameChar=P,O.isNameStartChar=k,O.isNotXmlChar=function(t){return!R(t)},O.isReferenceChar=function(t){return"#"===t||P(t)},O.isWhitespace=function(t){var e=T(t);return 32===e||9===e||10===e||13===e},O.isXmlChar=R;var j=function(){function t(){l(this,t),this.parent=null}return S(t,[{key:"document",get:function(){return this.parent?this.parent.document:null}},{key:"isRootNode",get:function(){return!!this.parent&&this.parent===this.document}},{key:"preserveWhitespace",get:function(){return Boolean(this.parent&&this.parent.preserveWhitespace)}},{key:"type",get:function(){return""}},{key:"toJSON",value:function(){var t={type:this.type};return this.isRootNode&&(t.isRootNode=!0),this.preserveWhitespace&&(t.preserveWhitespace=!0),t}}]),t}();j.TYPE_CDATA="cdata",j.TYPE_COMMENT="comment",j.TYPE_DOCUMENT="document",j.TYPE_ELEMENT="element",j.TYPE_PROCESSING_INSTRUCTION="pi",j.TYPE_TEXT="text";var C=j;function G(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=d(t);if(e){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}var N=C,A=function(t){p(r,N);var e=G(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return l(this,r),(t=e.call(this)).text=n,t}return S(r,[{key:"type",get:function(){return N.TYPE_TEXT}},{key:"toJSON",value:function(){return Object.assign(N.prototype.toJSON.call(this),{text:this.text})}}]),r}(),F=A;function I(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=d(t);if(e){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}var L=C,M=F,B=function(t){p(r,M);var e=I(r);function r(){return l(this,r),e.apply(this,arguments)}return S(r,[{key:"type",get:function(){return L.TYPE_CDATA}}]),r}(),_=B;function U(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=d(t);if(e){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}var D=C,W=function(t){p(r,D);var e=U(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return l(this,r),(t=e.call(this)).content=n,t}return S(r,[{key:"type",get:function(){return D.TYPE_COMMENT}},{key:"toJSON",value:function(){return Object.assign(D.prototype.toJSON.call(this),{content:this.content})}}]),r}(),X=W;function Y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=d(t);if(e){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}var q=C,J=function(t){p(r,q);var e=Y(r);function r(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.create(null),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return l(this,r),(n=e.call(this)).name=t,n.attributes=o,n.children=i,n}return S(r,[{key:"isEmpty",get:function(){return 0===this.children.length}},{key:"preserveWhitespace",get:function(){for(var t=this;t instanceof r;){if("xml:space"in t.attributes)return"preserve"===t.attributes["xml:space"];t=t.parent}return!1}},{key:"text",get:function(){return this.children.map((function(t){return"text"in t?t.text:""})).join("")}},{key:"type",get:function(){return q.TYPE_ELEMENT}},{key:"toJSON",value:function(){return Object.assign(q.prototype.toJSON.call(this),{name:this.name,attributes:this.attributes,children:this.children.map((function(t){return t.toJSON()}))})}}]),r}(),V=J;function $(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=d(t);if(e){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}var K=V,z=C,H=function(t){p(r,z);var e=$(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return l(this,r),(t=e.call(this)).children=n,t}return S(r,[{key:"document",get:function(){return this}},{key:"root",get:function(){return this.children.find((function(t){return t instanceof K}))||null}},{key:"text",get:function(){return this.children.map((function(t){return"text"in t?t.text:""})).join("")}},{key:"type",get:function(){return z.TYPE_DOCUMENT}},{key:"toJSON",value:function(){return Object.assign(z.prototype.toJSON.call(this),{children:this.children.map((function(t){return t.toJSON()}))})}}]),r}(),Q=H;function Z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=d(t);if(e){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}var tt=C,et=function(t){p(r,tt);var e=Z(r);function r(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return l(this,r),(n=e.call(this)).name=t,n.content=o,n}return S(r,[{key:"type",get:function(){return tt.TYPE_PROCESSING_INSTRUCTION}},{key:"toJSON",value:function(){return Object.assign(tt.prototype.toJSON.call(this),{name:this.name,content:this.content})}}]),r}(),rt=et;function nt(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return ot(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ot(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function ot(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var it=w,at=O,ct=_,ut=X,st=Q,ft=V,lt=rt,ht=F,pt=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(l(this,t),this.document=new st,this.currentNode=this.document,this.options=r,this.scanner=new it(vt(e)),this.consumeProlog(),this.consumeElement()||this.error("Root element is missing or invalid");this.consumeMisc(););this.scanner.isEnd||this.error("Extra content at the end of the document")}return S(t,[{key:"addNode",value:function(t){t.parent=this.currentNode,this.currentNode.children.push(t)}},{key:"addText",value:function(t){var e=this.currentNode.children;if(e.length>0){var r=e[e.length-1];if(r instanceof ht)return void(r.text+=t)}this.addNode(new ht(t))}},{key:"consumeAttributeValue",value:function(){var t,e=this.scanner,r=e.peek();if('"'!==r&&"'"!==r)return!1;e.advance();var n=!1,o="",i='"'===r?new RegExp('[^"&<]+',"y"):new RegExp("[^'&<]+","y");t:for(;!e.isEnd;){switch((t=e.consumeMatch(i))&&(this.validateChars(t),o+=t.replace(/[\\t\\r\\n]/g," ")),e.peek()){case r:n=!0;break t;case"&":o+=this.consumeReference();continue;case"<":this.error("Unescaped \`<\` is not allowed in an attribute value");break;case"":this.error("Unclosed attribute")}}return n||this.error("Unclosed attribute"),e.advance(),o}},{key:"consumeCdataSection",value:function(){var t=this.scanner;if(!t.consumeStringFast("<![CDATA["))return!1;var e=t.consumeUntilString("]]>");return this.validateChars(e),t.consumeStringFast("]]>")||this.error("Unclosed CDATA section"),this.options.preserveCdata?this.addNode(new ct(e)):this.addText(e),!0}},{key:"consumeCharData",value:function(){var t=this.scanner,e=t.consumeUntilMatch(/<|&|]]>/g);return!!e&&(this.validateChars(e),"]"===t.peek()&&"]]>"===t.peek(3)&&this.error("Element content may not contain the CDATA section close delimiter \`]]>\`"),this.addText(e),!0)}},{key:"consumeComment",value:function(){var t=this.scanner;if(!t.consumeStringFast("\\x3c!--"))return!1;var e=t.consumeUntilString("--");return this.validateChars(e),t.consumeStringFast("--\\x3e")||("--"===t.peek(2)?this.error("The string \`--\` isn't allowed inside a comment"):this.error("Unclosed comment")),this.options.preserveComments&&this.addNode(new ut(e.trim())),!0}},{key:"consumeContentReference",value:function(){var t=this.consumeReference();return!!t&&(this.addText(t),!0)}},{key:"consumeDoctypeDeclaration",value:function(){var t=this.scanner;return!(!t.consumeStringFast("<!DOCTYPE")||!this.consumeWhitespace())&&(t.consumeMatch(new RegExp("[^[>]+","y")),t.consumeMatch(new RegExp("\\\\[[\\\\s\\\\S]+?\\\\][\\\\x20\\\\t\\\\r\\\\n]*>","y"))||t.consumeStringFast(">")||this.error("Unclosed doctype declaration"),!0)}},{key:"consumeElement",value:function(){var t=this.scanner,e=t.charIndex;if("<"!==t.peek())return!1;t.advance();var r=this.consumeName();if(!r)return t.reset(e),!1;for(var n=Object.create(null);this.consumeWhitespace();){var o=this.consumeName();if(o){var i=this.consumeEqual()&&this.consumeAttributeValue();!1===i&&this.error("Attribute value expected"),o in n&&this.error("Duplicate attribute: ".concat(o)),"xml:space"===o&&"default"!==i&&"preserve"!==i&&this.error('Value of the \`xml:space\` attribute must be "default" or "preserve"'),n[o]=i}}if(this.options.sortAttributes){for(var a=Object.keys(n).sort(),c=Object.create(null),u=0;u<a.length;++u){var s=a[u];c[s]=n[s]}n=c}var f=Boolean(t.consumeStringFast("/>")),l=new ft(r,n);if(l.parent=this.currentNode,!f){for(t.consumeStringFast(">")||this.error("Unclosed start tag for element \`".concat(r,"\`")),this.currentNode=l,this.consumeCharData();this.consumeElement()||this.consumeContentReference()||this.consumeCdataSection()||this.consumeProcessingInstruction()||this.consumeComment();)this.consumeCharData();var h,p=t.charIndex;t.consumeStringFast("</")&&(h=this.consumeName())&&h===r||(t.reset(p),this.error("Missing end tag for element ".concat(r))),this.consumeWhitespace(),t.consumeStringFast(">")||this.error("Unclosed end tag for element ".concat(r)),this.currentNode=l.parent}return this.addNode(l),!0}},{key:"consumeEqual",value:function(){return this.consumeWhitespace(),!!this.scanner.consumeStringFast("=")&&(this.consumeWhitespace(),!0)}},{key:"consumeMisc",value:function(){return this.consumeComment()||this.consumeProcessingInstruction()||this.consumeWhitespace()}},{key:"consumeName",value:function(){return at.isNameStartChar(this.scanner.peek())?this.scanner.consumeMatchFn(at.isNameChar):""}},{key:"consumeProcessingInstruction",value:function(){var t=this.scanner,e=t.charIndex;if(!t.consumeStringFast("<?"))return!1;var r=this.consumeName();if(r?"xml"===r.toLowerCase()&&(t.reset(e),this.error("XML declaration isn't allowed here")):this.error("Invalid processing instruction"),!this.consumeWhitespace()){if(t.consumeStringFast("?>"))return this.addNode(new lt(r)),!0;this.error("Whitespace is required after a processing instruction name")}var n=t.consumeUntilString("?>");return this.validateChars(n),t.consumeStringFast("?>")||this.error("Unterminated processing instruction"),this.addNode(new lt(r,n)),!0}},{key:"consumeProlog",value:function(){var t=this.scanner,e=t.charIndex;for(this.consumeXmlDeclaration();this.consumeMisc(););if(this.consumeDoctypeDeclaration())for(;this.consumeMisc(););return e<t.charIndex}},{key:"consumeReference",value:function(){var t=this.scanner;if("&"!==t.peek())return!1;t.advance();var e,r=t.consumeMatchFn(at.isReferenceChar);if(";"!==t.consume()&&this.error("Unterminated reference (a reference must end with \`;\`)"),"#"===r[0]){var o="x"===r[1]?parseInt(r.slice(2),16):parseInt(r.slice(1),10);isNaN(o)&&this.error("Invalid character reference"),e=String.fromCodePoint(o),at.isXmlChar(e)||this.error("Character reference resolves to an invalid character")}else if(void 0===(e=at.predefinedEntities[r])){var i=this.options,a=i.ignoreUndefinedEntities,c=i.resolveUndefinedEntity,u="&".concat(r,";");if(c){var s=c(u);if(null!=s){var f=n(s);if("string"!==f)throw new TypeError("\`resolveUndefinedEntity()\` must return a string, \`null\`, or \`undefined\`, but returned a value of type ".concat(f));return s}}if(a)return u;t.reset(-u.length),this.error("Named entity isn't defined: ".concat(u))}return e}},{key:"consumeSystemLiteral",value:function(){var t=this.scanner,e=t.consumeStringFast('"')||t.consumeStringFast("'");if(!e)return!1;var r=t.consumeUntilString(e);return this.validateChars(r),t.consumeStringFast(e)||this.error("Missing end quote"),r}},{key:"consumeWhitespace",value:function(){return Boolean(this.scanner.consumeMatchFn(at.isWhitespace))}},{key:"consumeXmlDeclaration",value:function(){var t=this.scanner;if(!t.consumeStringFast("<?xml"))return!1;this.consumeWhitespace()||this.error("Invalid XML declaration");var e=Boolean(t.consumeStringFast("version"))&&this.consumeEqual()&&this.consumeSystemLiteral();if(!1===e?this.error("XML version is missing or invalid"):/^1\\.[0-9]+$/.test(e)||this.error("Invalid character in version number"),this.consumeWhitespace()){Boolean(t.consumeStringFast("encoding"))&&this.consumeEqual()&&this.consumeSystemLiteral()&&this.consumeWhitespace();var r=Boolean(t.consumeStringFast("standalone"))&&this.consumeEqual()&&this.consumeSystemLiteral();r&&("yes"!==r&&"no"!==r&&this.error('Only "yes" and "no" are permitted as values of \`standalone\`'),this.consumeWhitespace())}return t.consumeStringFast("?>")||this.error("Invalid or unclosed XML declaration"),!0}},{key:"error",value:function(t){for(var e=this.scanner,r=e.charIndex,n=e.string,o=1,i="",a=1,c=0;c<r;++c){var u=n[c];"\\n"===u?(o=1,i="",a+=1):(o+=1,i+=u)}var s=n.indexOf("\\n",r),f=0;(i+=-1===s?n.slice(r):n.slice(r,s)).length>50&&(o<40?i=i.slice(0,50):(f=o-20,i=i.slice(f,o+30)));var l=new Error("".concat(t," (line ").concat(a,", column ").concat(o,")\\n")+"  ".concat(i,"\\n")+" ".repeat(o-f+1)+"^\\n");throw Object.assign(l,{column:o,excerpt:i,line:a,pos:r}),l}},{key:"validateChars",value:function(t){var e,r=0,n=nt(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;at.isNotXmlChar(o)&&(this.scanner.reset(-(f(t).length-r)),this.error("Invalid character")),r+=1}}catch(t){n.e(t)}finally{n.f()}}}]),t}();function vt(t){return"\\ufeff"===t[0]&&(t=t.slice(1)),t.replace(/\\r\\n?/g,"\\n")}var dt=pt,yt=_,mt=X,gt=Q,bt=V,St=C,Et=rt,wt=F;function Ot(t,e){return new dt(t,e).document}Ot.XmlCdata=yt,Ot.XmlComment=mt,Ot.XmlDocument=gt,Ot.XmlElement=bt,Ot.XmlNode=St,Ot.XmlProcessingInstruction=Et,Ot.XmlText=wt;var xt=Ot;function Pt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=d(t);if(e){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}var kt=function(t){p(r,g(Error));var e=Pt(r);function r(t){return l(this,r),e.call(this,t)}return r}();function Rt(t){return t.children[0]}function Tt(t){var e=t.indexOf(":");return e>-1?t.substr(e+1):t}function jt(t){return t.name||""}function Ct(t,e,r){var n=Tt(e);return t&&Array.isArray(t.children)?t.children.reduce((function t(e,o){return Tt(jt(o))===n&&e.push(o),r&&Array.isArray(o.children)?[].concat(f(e),f(o.children.reduce(t,[]))):e}),[]):[]}function Gt(t,e,r){return Ct(t,e,r)[0]||null}function Nt(t){return t&&Array.isArray(t.children)?f(t.children.filter((function(t){return"XmlElement"===t.constructor.name}))):[]}function At(t){var e=t&&Array.isArray(t.children)?t.children.find((function(t){return"text"===t.type})):null;return e?e.text:""}function Ft(t,e){return t&&t.attributes[e]||""}var It=function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];l(this,t),this.message=e,this.httpStatus=r,this.isCrossOriginRelated=n};function Lt(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return Mt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mt(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function Mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Bt=["utf-8","utf-16","iso-8859-1"];function _t(t,e){var r,n=e?function(t){var e=/charset=([^;]+)/.exec(t);return e?e[1]:null}(e):null,o=Lt(n?[n].concat(Bt):Bt);try{for(o.s();!(r=o.n()).done;){var i=r.value;try{return new TextDecoder(i,{fatal:!0}).decode(t)}catch(t){}}}catch(t){o.e(t)}finally{o.f()}return console.warn("XML document encoding could not be determined, falling back to ".concat("utf-8",".")),new TextDecoder("utf-8").decode(t)}function Ut(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return Dt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dt(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function Dt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Wt=new Map;function Xt(t){return function(t){if(Wt.has(t))return Wt.get(t);var e=fetch(t);return e.finally((function(){return Wt.delete(t)})),Wt.set(t,e),e}(t).catch((function(){return fetch(t,{method:"HEAD",mode:"no-cors"}).catch((function(t){throw new It("Fetching the document failed either due to network errors or unreachable host, error is: ".concat(t.message),0,!1)})).then((function(){throw new It("The document could not be fetched due to CORS limitations",0,!0)}))})).then(function(){var t=r(i.mark((function t(e){var r,n,o;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ok){t.next=5;break}return t.next=3,e.text();case 3:throw r=t.sent,new It("Received an error with code ".concat(e.status,": ").concat(r),e.status,!1);case 5:return t.next=7,e.arrayBuffer();case 7:return n=t.sent,o=e.headers.get("Content-Type"),t.abrupt("return",_t(n,o));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).then((function(t){return function(t){var e=null;try{e=xt(t)}catch(t){throw new kt(t.message)}return e}(t)}))}function Yt(t,e){var r=t.match(/(https?%3A%2F%2F[^/]+)$/);if(r){var n=r[1],o=Yt(decodeURIComponent(n),e);return t.replace(n,encodeURIComponent(o))}var i,a=new URL(t),c=Object.keys(e),u=c.map((function(t){return t.toLowerCase()})),s=[],f=Ut(a.searchParams.keys());try{for(f.s();!(i=f.n()).done;){var l=i.value;u.indexOf(l.toLowerCase())>-1&&s.push(l)}}catch(t){f.e(t)}finally{f.f()}return s.map((function(t){return a.searchParams.delete(t)})),c.forEach((function(t){return a.searchParams.set(t,!0===e[t]?"":e[t])})),a.toString()}var qt=["EPSG:4046","EPSG:4075","EPSG:4120","EPSG:4122","EPSG:4124","EPSG:4126","EPSG:4149","EPSG:4151","EPSG:4153","EPSG:4155","EPSG:4157","EPSG:4159","EPSG:4161","EPSG:4163","EPSG:4165","EPSG:4167","EPSG:4169","EPSG:4171","EPSG:4173","EPSG:4175","EPSG:4178","EPSG:4180","EPSG:4182","EPSG:4184","EPSG:4188","EPSG:4190","EPSG:4191","EPSG:4196","EPSG:4198","EPSG:4202","EPSG:4210","EPSG:4211","EPSG:4214","EPSG:4226","EPSG:4229","EPSG:4231","EPSG:4233","EPSG:4236","EPSG:4238","EPSG:4240","EPSG:4242","EPSG:4244","EPSG:4246","EPSG:4248","EPSG:4250","EPSG:4252","EPSG:4255","EPSG:4258","EPSG:4261","EPSG:4264","EPSG:4267","EPSG:4270","EPSG:4273","EPSG:4276","EPSG:4279","EPSG:4281","EPSG:4284","EPSG:4286","EPSG:4288","EPSG:4292","EPSG:4295","EPSG:4297","EPSG:4299","EPSG:4302","EPSG:4324","EPSG:4326"];function Jt(t){return qt.indexOf(Vt(t))>-1}function Vt(t){if(/^urn:(?:x-)?ogc:def:crs:epsg:/.test(t.toLowerCase())){var e=/([0-9]+)$/.exec(t)[1];return"EPSG:".concat(e)}return t}function $t(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Kt(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?$t(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zt(t){return Rt(t).attributes.version}function Ht(t){var e=zt(t);return Ct(Gt(Rt(t),"Capability"),"Layer").map((function(t){return Qt(t,e)}))}function Qt(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a="1.3.0"===r?"CRS":"SRS",c=Ct(e,a).map(At),u=c.length>0?c:n,s=Ct(e,"Style").map(Zt),f=s.length>0?s:o;function l(t){return(Jt(Ft(t,a))&&"1.3.0"===r?["miny","minx","maxy","maxx"]:["minx","miny","maxx","maxy"]).map((function(e){return Ft(t,e)}))}var h=Gt(e,"Attribution"),p=null!==h?te(h):i,v=Ct(e,"Layer").map((function(t){return Qt(t,r,u,f,p)}));return Kt({name:At(Gt(e,"Name")),title:At(Gt(e,"Title")),abstract:At(Gt(e,"Abstract")),availableCrs:u,styles:f,attribution:p,boundingBoxes:Ct(e,"BoundingBox").reduce((function(e,r){return Kt(Kt({},e),{},t({},Ft(r,a),l(r)))}),{})},v.length&&{children:v})}function Zt(t){var e=Ft(Gt(Gt(t,"LegendURL"),"OnlineResource"),"xlink:href");return Kt({name:At(Gt(t,"Name")),title:At(Gt(t,"Title"))},e&&{legendUrl:e})}function te(t){var e=Ft(Gt(Gt(t,"LogoURL"),"OnlineResource"),"xlink:href"),r=Ft(Gt(t,"OnlineResource"),"xlink:href"),n=At(Gt(t,"Title"));return Kt(Kt(Kt({},n&&{title:n}),r&&{url:r}),e&&{logoUrl:e})}function ee(t){return Rt(t).attributes.version}function re(t){var e;if(ee(t).startsWith("1.0")){var r=Gt(Gt(Gt(Rt(t),"Capability"),"Request"),"GetFeature");e=Nt(Gt(r,"ResultFormat")).map(jt)}else{var n=Ct(Gt(Rt(t),"OperationsMetadata"),"Operation").find((function(t){return"GetFeature"===Ft(t,"name")})),o=Ct(n,"Parameter").find((function(t){return"outputFormat"===Ft(t,"name")}));e=Ct(o,"Value",!0).map(At)}return e}function ne(t){var e=ee(t),r=re(t);return Ct(Gt(Rt(t),"FeatureTypeList"),"FeatureType").map((function(t){return function(t,e,r){var n=e.startsWith("2.")?"CRS":"SRS",o=e.startsWith("1.0")?"SRS":"Default".concat(n);function i(){var e=Gt(t,"LatLongBoundingBox");return["minx","miny","maxx","maxy"].map((function(t){return Ft(e,t)})).map(parseFloat)}function a(){var e=Gt(t,"WGS84BoundingBox");return["LowerCorner","UpperCorner"].map((function(t){return Gt(e,t)})).map((function(t){return At(t).split(" ")})).reduce((function(t,e){return[].concat(f(t),f(e))})).map(parseFloat)}var c=e.startsWith("1.0")?[]:Ct(t,"Other".concat(n)).map(At).map(Vt),u=e.startsWith("1.0")?[]:Ct(Gt(t,"OutputFormats"),"Format").map(At);return{name:At(Gt(t,"Name")),title:At(Gt(t,"Title")),abstract:At(Gt(t,"Abstract")),defaultCrs:Vt(At(Gt(t,o))),otherCrs:c,outputFormats:u.length>0?u:r,latLonBoundingBox:e.startsWith("1.0")?i():a()}}(t,e,r)}))}function oe(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ie(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?oe(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ae(e,r,n){var o,i=Rt(e);if(n.startsWith("2.0"))o=Ct(i,"member").map((function(t){return Nt(t)[0]}));else{var a=Gt(i,"featureMembers");o=a?Nt(a):Ct(i,"featureMember").map((function(t){return Nt(t)[0]}))}var c="1.0.0"===n?"fid":"gml:id";function u(e){return Nt(e).filter((function(t){return Tt(jt(t))in r.properties})).reduce((function(e,n){var o=Tt(jt(n));return ie(ie({},e),{},t({},o,function(t,e){switch(r.properties[t]){case"integer":return parseInt(e);case"float":return parseFloat(e);case"boolean":return"true"===e;default:return e}}(o,At(n))))}),{})}return o.map((function(t){return{id:Ft(t,c),properties:u(t)}}))}function ce(e,r,n,o,i,a,c,u,s,f){var l="2.0.0"===r?"COUNT":"MAXFEATURES",h=t({SERVICE:"WFS",REQUEST:"GetFeature",VERSION:r},"2.0.0"===r?"TYPENAMES":"TYPENAME",n);if(void 0!==o&&(h.OUTPUTFORMAT=o),void 0!==a&&(h.PROPERTYNAME=a.join(",")),c?(h.RESULTTYPE="hits",h[l]="1"):void 0!==i&&(h[l]=i.toString(10)),u&&(h.SRSNAME=u),s){var p=s.join(",");h.BBOX=f?"".concat(p,",").concat(f):p}return Yt(e,h)}u("parseWmsCapabilities",self,(function(t){return Xt(t.url).then((function(t){return{info:(e=t,r=Gt(Rt(e),"Service"),n=Ct(Gt(r,"KeywordList"),"Keyword").map(At).filter((function(t,e,r){return r.indexOf(t)===e})),{title:At(Gt(r,"Title")),name:At(Gt(r,"Name")),abstract:At(Gt(r,"Abstract")),fees:At(Gt(r,"Fees")),constraints:At(Gt(r,"AccessConstraints")),keywords:n}),layers:Ht(t),version:zt(t)};var e,r,n}))})),u("parseWfsCapabilities",self,(function(t){return Xt(t.url).then((function(t){return{info:(e=t,n=ee(e),o=n.startsWith("1.0")?"Service":"ServiceIdentification",i=n.startsWith("1.0")?"Name":"ServiceType",a=Gt(Rt(e),o),r=n.startsWith("1.0")?At(Gt(a,"Keywords")).split(",").map((function(t){return t.trim()})):Ct(Gt(a,"Keywords"),"Keyword").map(At),{title:At(Gt(a,"Title")),name:At(Gt(a,i)),abstract:At(Gt(a,"Abstract")),fees:At(Gt(a,"Fees")),constraints:At(Gt(a,"AccessConstraints")),keywords:r,outputFormats:re(e)}),featureTypes:ne(t),version:ee(t)};var e,r,n,o,i,a}))})),u("queryWfsFeatureTypeDetails",self,(function(t){var e=t.url,r=t.serviceVersion,n=t.featureTypeFull;return Xt(ce(e,r,n.name,void 0,void 0,Object.keys(n.properties))).then((function(t){return{props:(e=ae(t,n,r),e.reduce((function(t,e){var r=function(r){var n=e.properties[r];r in t||(t[r]={uniqueValues:[]});var o=t[r].uniqueValues.find((function(t){return t.value===n}));o?o.count++:t[r].uniqueValues.push({value:n,count:1})};for(var n in e.properties)r(n);return t}),{}))};var e}))}));
`], { type: "application/javascript" })), {
        type: "module"
      });
    }
    return workerInstance;
  }
  function parseWmsCapabilities(capabilitiesUrl) {
    return sendTaskRequest("parseWmsCapabilities", getWorkerInstance(), {
      url: capabilitiesUrl
    });
  }
  const emptyString$1 = "";
  class StringScanner$1 {
    constructor(string) {
      this.chars = [...string];
      this.charCount = this.chars.length;
      this.charIndex = 0;
      this.charsToBytes = new Array(this.charCount);
      this.multiByteMode = false;
      this.string = string;
      let { chars: chars2, charCount, charsToBytes } = this;
      if (charCount === string.length) {
        for (let i = 0; i < charCount; ++i) {
          charsToBytes[i] = i;
        }
      } else {
        for (let byteIndex = 0, charIndex = 0; charIndex < charCount; ++charIndex) {
          charsToBytes[charIndex] = byteIndex;
          byteIndex += chars2[charIndex].length;
        }
        this.multiByteMode = true;
      }
    }
    get isEnd() {
      return this.charIndex >= this.charCount;
    }
    _charLength(string) {
      let { length } = string;
      if (length < 2 || !this.multiByteMode) {
        return length;
      }
      return string.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g, "_").length;
    }
    advance(count = 1) {
      this.charIndex = Math.min(this.charCount, this.charIndex + count);
    }
    consume(count = 1) {
      let chars2 = this.peek(count);
      this.advance(count);
      return chars2;
    }
    consumeMatch(regex) {
      if (!regex.sticky) {
        throw new Error('`regex` must have a sticky flag ("y")');
      }
      regex.lastIndex = this.charsToBytes[this.charIndex];
      let result = regex.exec(this.string);
      if (result === null) {
        return emptyString$1;
      }
      let match2 = result[0];
      this.advance(this._charLength(match2));
      return match2;
    }
    consumeMatchFn(fn) {
      let startIndex = this.charIndex;
      while (!this.isEnd && fn(this.peek())) {
        this.advance();
      }
      return this.charIndex > startIndex ? this.string.slice(this.charsToBytes[startIndex], this.charsToBytes[this.charIndex]) : emptyString$1;
    }
    consumeString(stringToConsume) {
      if (this.consumeStringFast(stringToConsume)) {
        return stringToConsume;
      }
      if (!this.multiByteMode) {
        return emptyString$1;
      }
      let { length } = stringToConsume;
      let charLengthToMatch = this._charLength(stringToConsume);
      if (charLengthToMatch !== length && stringToConsume === this.peek(charLengthToMatch)) {
        this.advance(charLengthToMatch);
        return stringToConsume;
      }
      return emptyString$1;
    }
    consumeStringFast(stringToConsume) {
      if (this.peek() === stringToConsume[0]) {
        let { length } = stringToConsume;
        if (length === 1) {
          this.advance();
          return stringToConsume;
        }
        if (this.peek(length) === stringToConsume) {
          this.advance(length);
          return stringToConsume;
        }
      }
      return emptyString$1;
    }
    consumeUntilMatch(regex) {
      if (!regex.global) {
        throw new Error('`regex` must have a global flag ("g")');
      }
      let byteIndex = this.charsToBytes[this.charIndex];
      regex.lastIndex = byteIndex;
      let match2 = regex.exec(this.string);
      if (match2 === null || match2.index === byteIndex) {
        return emptyString$1;
      }
      let result = this.string.slice(byteIndex, match2.index);
      this.advance(this._charLength(result));
      return result;
    }
    consumeUntilString(searchString) {
      let { charIndex, charsToBytes, string } = this;
      let byteIndex = charsToBytes[charIndex];
      let matchByteIndex = string.indexOf(searchString, byteIndex);
      if (matchByteIndex <= 0) {
        return emptyString$1;
      }
      let result = string.slice(byteIndex, matchByteIndex);
      this.advance(this._charLength(result));
      return result;
    }
    peek(count = 1) {
      if (this.charIndex >= this.charCount) {
        return emptyString$1;
      }
      if (count === 1) {
        return this.chars[this.charIndex];
      }
      let { charsToBytes, charIndex } = this;
      return this.string.slice(charsToBytes[charIndex], charsToBytes[charIndex + count]);
    }
    reset(index2 = 0) {
      this.charIndex = index2 >= 0 ? Math.min(this.charCount, index2) : Math.max(0, this.charIndex + index2);
    }
  }
  var StringScanner_1 = StringScanner$1;
  var syntax$1 = {};
  const predefinedEntities = Object.freeze(Object.assign(/* @__PURE__ */ Object.create(null), {
    amp: "&",
    apos: "'",
    gt: ">",
    lt: "<",
    quot: '"'
  }));
  syntax$1.predefinedEntities = predefinedEntities;
  function isNameChar(char) {
    if (isNameStartChar(char)) {
      return true;
    }
    let cp = getCodePoint(char);
    return cp === 45 || cp === 46 || cp >= 48 && cp <= 57 || cp === 183 || cp >= 768 && cp <= 879 || cp >= 8255 && cp <= 8256;
  }
  syntax$1.isNameChar = isNameChar;
  function isNameStartChar(char) {
    let cp = getCodePoint(char);
    return cp === 58 || cp === 95 || cp >= 65 && cp <= 90 || cp >= 97 && cp <= 122 || cp >= 192 && cp <= 214 || cp >= 216 && cp <= 246 || cp >= 248 && cp <= 767 || cp >= 880 && cp <= 893 || cp >= 895 && cp <= 8191 || cp >= 8204 && cp <= 8205 || cp >= 8304 && cp <= 8591 || cp >= 11264 && cp <= 12271 || cp >= 12289 && cp <= 55295 || cp >= 63744 && cp <= 64975 || cp >= 65008 && cp <= 65533 || cp >= 65536 && cp <= 983039;
  }
  syntax$1.isNameStartChar = isNameStartChar;
  function isNotXmlChar(char) {
    return !isXmlChar(char);
  }
  syntax$1.isNotXmlChar = isNotXmlChar;
  function isReferenceChar(char) {
    return char === "#" || isNameChar(char);
  }
  syntax$1.isReferenceChar = isReferenceChar;
  function isWhitespace(char) {
    let cp = getCodePoint(char);
    return cp === 32 || cp === 9 || cp === 10 || cp === 13;
  }
  syntax$1.isWhitespace = isWhitespace;
  function isXmlChar(char) {
    let cp = getCodePoint(char);
    return cp === 9 || cp === 10 || cp === 13 || cp >= 32 && cp <= 55295 || cp >= 57344 && cp <= 65533 || cp >= 65536 && cp <= 1114111;
  }
  syntax$1.isXmlChar = isXmlChar;
  function getCodePoint(char) {
    return char.codePointAt(0) || -1;
  }
  class XmlNode$7 {
    constructor() {
      this.parent = null;
    }
    get document() {
      return this.parent ? this.parent.document : null;
    }
    get isRootNode() {
      return this.parent ? this.parent === this.document : false;
    }
    get preserveWhitespace() {
      return Boolean(this.parent && this.parent.preserveWhitespace);
    }
    get type() {
      return "";
    }
    toJSON() {
      let json = {
        type: this.type
      };
      if (this.isRootNode) {
        json.isRootNode = true;
      }
      if (this.preserveWhitespace) {
        json.preserveWhitespace = true;
      }
      return json;
    }
  }
  XmlNode$7.TYPE_CDATA = "cdata";
  XmlNode$7.TYPE_COMMENT = "comment";
  XmlNode$7.TYPE_DOCUMENT = "document";
  XmlNode$7.TYPE_ELEMENT = "element";
  XmlNode$7.TYPE_PROCESSING_INSTRUCTION = "pi";
  XmlNode$7.TYPE_TEXT = "text";
  var XmlNode_1 = XmlNode$7;
  const XmlNode$6 = XmlNode_1;
  class XmlText$3 extends XmlNode$6 {
    constructor(text2 = "") {
      super();
      this.text = text2;
    }
    get type() {
      return XmlNode$6.TYPE_TEXT;
    }
    toJSON() {
      return Object.assign(XmlNode$6.prototype.toJSON.call(this), {
        text: this.text
      });
    }
  }
  var XmlText_1 = XmlText$3;
  const XmlNode$5 = XmlNode_1;
  const XmlText$2 = XmlText_1;
  class XmlCdata$2 extends XmlText$2 {
    get type() {
      return XmlNode$5.TYPE_CDATA;
    }
  }
  var XmlCdata_1 = XmlCdata$2;
  const XmlNode$4 = XmlNode_1;
  class XmlComment$2 extends XmlNode$4 {
    constructor(content = "") {
      super();
      this.content = content;
    }
    get type() {
      return XmlNode$4.TYPE_COMMENT;
    }
    toJSON() {
      return Object.assign(XmlNode$4.prototype.toJSON.call(this), {
        content: this.content
      });
    }
  }
  var XmlComment_1 = XmlComment$2;
  const XmlNode$3 = XmlNode_1;
  class XmlElement$3 extends XmlNode$3 {
    constructor(name, attributes = /* @__PURE__ */ Object.create(null), children = []) {
      super();
      this.name = name;
      this.attributes = attributes;
      this.children = children;
    }
    get isEmpty() {
      return this.children.length === 0;
    }
    get preserveWhitespace() {
      let node = this;
      while (node instanceof XmlElement$3) {
        if ("xml:space" in node.attributes) {
          return node.attributes["xml:space"] === "preserve";
        }
        node = node.parent;
      }
      return false;
    }
    get text() {
      return this.children.map((child) => "text" in child ? child.text : "").join("");
    }
    get type() {
      return XmlNode$3.TYPE_ELEMENT;
    }
    toJSON() {
      return Object.assign(XmlNode$3.prototype.toJSON.call(this), {
        name: this.name,
        attributes: this.attributes,
        children: this.children.map((child) => child.toJSON())
      });
    }
  }
  var XmlElement_1 = XmlElement$3;
  const XmlElement$2 = XmlElement_1;
  const XmlNode$2 = XmlNode_1;
  class XmlDocument$2 extends XmlNode$2 {
    constructor(children = []) {
      super();
      this.children = children;
    }
    get document() {
      return this;
    }
    get root() {
      return this.children.find((child) => child instanceof XmlElement$2) || null;
    }
    get text() {
      return this.children.map((child) => "text" in child ? child.text : "").join("");
    }
    get type() {
      return XmlNode$2.TYPE_DOCUMENT;
    }
    toJSON() {
      return Object.assign(XmlNode$2.prototype.toJSON.call(this), {
        children: this.children.map((child) => child.toJSON())
      });
    }
  }
  var XmlDocument_1 = XmlDocument$2;
  const XmlNode$1 = XmlNode_1;
  class XmlProcessingInstruction$2 extends XmlNode$1 {
    constructor(name, content = "") {
      super();
      this.name = name;
      this.content = content;
    }
    get type() {
      return XmlNode$1.TYPE_PROCESSING_INSTRUCTION;
    }
    toJSON() {
      return Object.assign(XmlNode$1.prototype.toJSON.call(this), {
        name: this.name,
        content: this.content
      });
    }
  }
  var XmlProcessingInstruction_1 = XmlProcessingInstruction$2;
  const StringScanner = StringScanner_1;
  const syntax = syntax$1;
  const XmlCdata$1 = XmlCdata_1;
  const XmlComment$1 = XmlComment_1;
  const XmlDocument$1 = XmlDocument_1;
  const XmlElement$1 = XmlElement_1;
  const XmlProcessingInstruction$1 = XmlProcessingInstruction_1;
  const XmlText$1 = XmlText_1;
  const emptyString = "";
  class Parser$1 {
    constructor(xml2, options = {}) {
      this.document = new XmlDocument$1();
      this.currentNode = this.document;
      this.options = options;
      this.scanner = new StringScanner(normalizeXmlString(xml2));
      this.consumeProlog();
      if (!this.consumeElement()) {
        this.error("Root element is missing or invalid");
      }
      while (this.consumeMisc()) {
      }
      if (!this.scanner.isEnd) {
        this.error("Extra content at the end of the document");
      }
    }
    addNode(node) {
      node.parent = this.currentNode;
      this.currentNode.children.push(node);
    }
    addText(text2) {
      let { children } = this.currentNode;
      if (children.length > 0) {
        let prevNode = children[children.length - 1];
        if (prevNode instanceof XmlText$1) {
          prevNode.text += text2;
          return;
        }
      }
      this.addNode(new XmlText$1(text2));
    }
    consumeAttributeValue() {
      let { scanner } = this;
      let quote = scanner.peek();
      if (quote !== '"' && quote !== "'") {
        return false;
      }
      scanner.advance();
      let chars2;
      let isClosed = false;
      let value = emptyString;
      let regex = quote === '"' ? /[^"&<]+/y : /[^'&<]+/y;
      matchLoop:
        while (!scanner.isEnd) {
          chars2 = scanner.consumeMatch(regex);
          if (chars2) {
            this.validateChars(chars2);
            value += chars2.replace(/[\t\r\n]/g, " ");
          }
          let nextChar = scanner.peek();
          switch (nextChar) {
            case quote:
              isClosed = true;
              break matchLoop;
            case "&":
              value += this.consumeReference();
              continue;
            case "<":
              this.error("Unescaped `<` is not allowed in an attribute value");
              break;
            case emptyString:
              this.error("Unclosed attribute");
              break;
          }
        }
      if (!isClosed) {
        this.error("Unclosed attribute");
      }
      scanner.advance();
      return value;
    }
    consumeCdataSection() {
      let { scanner } = this;
      if (!scanner.consumeStringFast("<![CDATA[")) {
        return false;
      }
      let text2 = scanner.consumeUntilString("]]>");
      this.validateChars(text2);
      if (!scanner.consumeStringFast("]]>")) {
        this.error("Unclosed CDATA section");
      }
      if (this.options.preserveCdata) {
        this.addNode(new XmlCdata$1(text2));
      } else {
        this.addText(text2);
      }
      return true;
    }
    consumeCharData() {
      let { scanner } = this;
      let charData = scanner.consumeUntilMatch(/<|&|]]>/g);
      if (!charData) {
        return false;
      }
      this.validateChars(charData);
      if (scanner.peek() === "]" && scanner.peek(3) === "]]>") {
        this.error("Element content may not contain the CDATA section close delimiter `]]>`");
      }
      this.addText(charData);
      return true;
    }
    consumeComment() {
      let { scanner } = this;
      if (!scanner.consumeStringFast("<!--")) {
        return false;
      }
      let content = scanner.consumeUntilString("--");
      this.validateChars(content);
      if (!scanner.consumeStringFast("-->")) {
        if (scanner.peek(2) === "--") {
          this.error("The string `--` isn't allowed inside a comment");
        } else {
          this.error("Unclosed comment");
        }
      }
      if (this.options.preserveComments) {
        this.addNode(new XmlComment$1(content.trim()));
      }
      return true;
    }
    consumeContentReference() {
      let ref = this.consumeReference();
      if (ref) {
        this.addText(ref);
        return true;
      }
      return false;
    }
    consumeDoctypeDeclaration() {
      let { scanner } = this;
      if (!scanner.consumeStringFast("<!DOCTYPE") || !this.consumeWhitespace()) {
        return false;
      }
      scanner.consumeMatch(/[^[>]+/y);
      if (scanner.consumeMatch(/\[[\s\S]+?\][\x20\t\r\n]*>/y)) {
        return true;
      }
      if (!scanner.consumeStringFast(">")) {
        this.error("Unclosed doctype declaration");
      }
      return true;
    }
    consumeElement() {
      let { scanner } = this;
      let mark = scanner.charIndex;
      if (scanner.peek() !== "<") {
        return false;
      }
      scanner.advance();
      let name = this.consumeName();
      if (!name) {
        scanner.reset(mark);
        return false;
      }
      let attributes = /* @__PURE__ */ Object.create(null);
      while (this.consumeWhitespace()) {
        let attrName = this.consumeName();
        if (!attrName) {
          continue;
        }
        let attrValue = this.consumeEqual() && this.consumeAttributeValue();
        if (attrValue === false) {
          this.error("Attribute value expected");
        }
        if (attrName in attributes) {
          this.error(`Duplicate attribute: ${attrName}`);
        }
        if (attrName === "xml:space" && attrValue !== "default" && attrValue !== "preserve") {
          this.error('Value of the `xml:space` attribute must be "default" or "preserve"');
        }
        attributes[attrName] = attrValue;
      }
      if (this.options.sortAttributes) {
        let attrNames = Object.keys(attributes).sort();
        let sortedAttributes = /* @__PURE__ */ Object.create(null);
        for (let i = 0; i < attrNames.length; ++i) {
          let attrName = attrNames[i];
          sortedAttributes[attrName] = attributes[attrName];
        }
        attributes = sortedAttributes;
      }
      let isEmpty2 = Boolean(scanner.consumeStringFast("/>"));
      let element = new XmlElement$1(name, attributes);
      element.parent = this.currentNode;
      if (!isEmpty2) {
        if (!scanner.consumeStringFast(">")) {
          this.error(`Unclosed start tag for element \`${name}\``);
        }
        this.currentNode = element;
        this.consumeCharData();
        while (this.consumeElement() || this.consumeContentReference() || this.consumeCdataSection() || this.consumeProcessingInstruction() || this.consumeComment()) {
          this.consumeCharData();
        }
        let endTagMark = scanner.charIndex;
        let endTagName;
        if (!scanner.consumeStringFast("</") || !(endTagName = this.consumeName()) || endTagName !== name) {
          scanner.reset(endTagMark);
          this.error(`Missing end tag for element ${name}`);
        }
        this.consumeWhitespace();
        if (!scanner.consumeStringFast(">")) {
          this.error(`Unclosed end tag for element ${name}`);
        }
        this.currentNode = element.parent;
      }
      this.addNode(element);
      return true;
    }
    consumeEqual() {
      this.consumeWhitespace();
      if (this.scanner.consumeStringFast("=")) {
        this.consumeWhitespace();
        return true;
      }
      return false;
    }
    consumeMisc() {
      return this.consumeComment() || this.consumeProcessingInstruction() || this.consumeWhitespace();
    }
    consumeName() {
      return syntax.isNameStartChar(this.scanner.peek()) ? this.scanner.consumeMatchFn(syntax.isNameChar) : emptyString;
    }
    consumeProcessingInstruction() {
      let { scanner } = this;
      let mark = scanner.charIndex;
      if (!scanner.consumeStringFast("<?")) {
        return false;
      }
      let name = this.consumeName();
      if (name) {
        if (name.toLowerCase() === "xml") {
          scanner.reset(mark);
          this.error("XML declaration isn't allowed here");
        }
      } else {
        this.error("Invalid processing instruction");
      }
      if (!this.consumeWhitespace()) {
        if (scanner.consumeStringFast("?>")) {
          this.addNode(new XmlProcessingInstruction$1(name));
          return true;
        }
        this.error("Whitespace is required after a processing instruction name");
      }
      let content = scanner.consumeUntilString("?>");
      this.validateChars(content);
      if (!scanner.consumeStringFast("?>")) {
        this.error("Unterminated processing instruction");
      }
      this.addNode(new XmlProcessingInstruction$1(name, content));
      return true;
    }
    consumeProlog() {
      let { scanner } = this;
      let mark = scanner.charIndex;
      this.consumeXmlDeclaration();
      while (this.consumeMisc()) {
      }
      if (this.consumeDoctypeDeclaration()) {
        while (this.consumeMisc()) {
        }
      }
      return mark < scanner.charIndex;
    }
    consumeReference() {
      let { scanner } = this;
      if (scanner.peek() !== "&") {
        return false;
      }
      scanner.advance();
      let ref = scanner.consumeMatchFn(syntax.isReferenceChar);
      if (scanner.consume() !== ";") {
        this.error("Unterminated reference (a reference must end with `;`)");
      }
      let parsedValue;
      if (ref[0] === "#") {
        let codePoint = ref[1] === "x" ? parseInt(ref.slice(2), 16) : parseInt(ref.slice(1), 10);
        if (isNaN(codePoint)) {
          this.error("Invalid character reference");
        }
        parsedValue = String.fromCodePoint(codePoint);
        if (!syntax.isXmlChar(parsedValue)) {
          this.error("Character reference resolves to an invalid character");
        }
      } else {
        parsedValue = syntax.predefinedEntities[ref];
        if (parsedValue === void 0) {
          let {
            ignoreUndefinedEntities,
            resolveUndefinedEntity
          } = this.options;
          let wrappedRef = `&${ref};`;
          if (resolveUndefinedEntity) {
            let resolvedValue = resolveUndefinedEntity(wrappedRef);
            if (resolvedValue !== null && resolvedValue !== void 0) {
              let type = typeof resolvedValue;
              if (type !== "string") {
                throw new TypeError(`\`resolveUndefinedEntity()\` must return a string, \`null\`, or \`undefined\`, but returned a value of type ${type}`);
              }
              return resolvedValue;
            }
          }
          if (ignoreUndefinedEntities) {
            return wrappedRef;
          }
          scanner.reset(-wrappedRef.length);
          this.error(`Named entity isn't defined: ${wrappedRef}`);
        }
      }
      return parsedValue;
    }
    consumeSystemLiteral() {
      let { scanner } = this;
      let quote = scanner.consumeStringFast('"') || scanner.consumeStringFast("'");
      if (!quote) {
        return false;
      }
      let value = scanner.consumeUntilString(quote);
      this.validateChars(value);
      if (!scanner.consumeStringFast(quote)) {
        this.error("Missing end quote");
      }
      return value;
    }
    consumeWhitespace() {
      return Boolean(this.scanner.consumeMatchFn(syntax.isWhitespace));
    }
    consumeXmlDeclaration() {
      let { scanner } = this;
      if (!scanner.consumeStringFast("<?xml")) {
        return false;
      }
      if (!this.consumeWhitespace()) {
        this.error("Invalid XML declaration");
      }
      let version2 = Boolean(scanner.consumeStringFast("version")) && this.consumeEqual() && this.consumeSystemLiteral();
      if (version2 === false) {
        this.error("XML version is missing or invalid");
      } else if (!/^1\.[0-9]+$/.test(version2)) {
        this.error("Invalid character in version number");
      }
      if (this.consumeWhitespace()) {
        let encoding = Boolean(scanner.consumeStringFast("encoding")) && this.consumeEqual() && this.consumeSystemLiteral();
        if (encoding) {
          this.consumeWhitespace();
        }
        let standalone = Boolean(scanner.consumeStringFast("standalone")) && this.consumeEqual() && this.consumeSystemLiteral();
        if (standalone) {
          if (standalone !== "yes" && standalone !== "no") {
            this.error('Only "yes" and "no" are permitted as values of `standalone`');
          }
          this.consumeWhitespace();
        }
      }
      if (!scanner.consumeStringFast("?>")) {
        this.error("Invalid or unclosed XML declaration");
      }
      return true;
    }
    error(message) {
      let { charIndex, string: xml2 } = this.scanner;
      let column = 1;
      let excerpt = "";
      let line = 1;
      for (let i = 0; i < charIndex; ++i) {
        let char = xml2[i];
        if (char === "\n") {
          column = 1;
          excerpt = "";
          line += 1;
        } else {
          column += 1;
          excerpt += char;
        }
      }
      let eol = xml2.indexOf("\n", charIndex);
      excerpt += eol === -1 ? xml2.slice(charIndex) : xml2.slice(charIndex, eol);
      let excerptStart = 0;
      if (excerpt.length > 50) {
        if (column < 40) {
          excerpt = excerpt.slice(0, 50);
        } else {
          excerptStart = column - 20;
          excerpt = excerpt.slice(excerptStart, column + 30);
        }
      }
      let err = new Error(
        `${message} (line ${line}, column ${column})
  ${excerpt}
` + " ".repeat(column - excerptStart + 1) + "^\n"
      );
      Object.assign(err, {
        column,
        excerpt,
        line,
        pos: charIndex
      });
      throw err;
    }
    validateChars(string) {
      let charIndex = 0;
      for (let char of string) {
        if (syntax.isNotXmlChar(char)) {
          this.scanner.reset(-([...string].length - charIndex));
          this.error("Invalid character");
        }
        charIndex += 1;
      }
    }
  }
  var Parser_1 = Parser$1;
  function normalizeXmlString(xml2) {
    if (xml2[0] === "\uFEFF") {
      xml2 = xml2.slice(1);
    }
    return xml2.replace(/\r\n?/g, "\n");
  }
  const Parser = Parser_1;
  const XmlCdata = XmlCdata_1;
  const XmlComment = XmlComment_1;
  const XmlDocument = XmlDocument_1;
  const XmlElement = XmlElement_1;
  const XmlNode = XmlNode_1;
  const XmlProcessingInstruction = XmlProcessingInstruction_1;
  const XmlText = XmlText_1;
  function parseXml(xml2, options) {
    return new Parser(xml2, options).document;
  }
  parseXml.XmlCdata = XmlCdata;
  parseXml.XmlComment = XmlComment;
  parseXml.XmlDocument = XmlDocument;
  parseXml.XmlElement = XmlElement;
  parseXml.XmlNode = XmlNode;
  parseXml.XmlProcessingInstruction = XmlProcessingInstruction;
  parseXml.XmlText = XmlText;
  var src = parseXml;
  class XmlParseError extends Error {
    constructor(message) {
      super(message);
    }
  }
  function parseXmlString(xmlString) {
    let doc = null;
    try {
      doc = src(xmlString);
    } catch (e) {
      throw new XmlParseError(e.message);
    }
    return doc;
  }
  function getRootElement(xmlDoc) {
    return xmlDoc.children[0];
  }
  function stripNamespace(name) {
    const colon = name.indexOf(":");
    return colon > -1 ? name.substr(colon + 1) : name;
  }
  function getElementName(element) {
    return element.name || "";
  }
  function findChildrenElement(element, name, nested) {
    const strippedName = stripNamespace(name);
    function reducer(prev, curr) {
      if (stripNamespace(getElementName(curr)) === strippedName) {
        prev.push(curr);
      }
      if (nested && Array.isArray(curr.children)) {
        return [...prev, ...curr.children.reduce(reducer, [])];
      } else {
        return prev;
      }
    }
    return element && Array.isArray(element.children) ? element.children.reduce(reducer, []) : [];
  }
  function findChildElement(element, name, nested) {
    return findChildrenElement(element, name, nested)[0] || null;
  }
  function getChildrenElement(element) {
    return element && Array.isArray(element.children) ? [...element.children.filter((el) => el.constructor.name === "XmlElement")] : [];
  }
  function getElementText(element) {
    const textNode = element && Array.isArray(element.children) ? element.children.find((node) => node.type === "text") : null;
    return textNode ? textNode.text : "";
  }
  function getElementAttribute(element, attrName) {
    return element && element.attributes[attrName] || "";
  }
  const ENCODINGS = ["utf-8", "utf-16", "iso-8859-1"];
  const FALLBACK_ENCODING = "utf-8";
  function extractEncoding(contentType) {
    const matches2 = /charset=([^;]+)/.exec(contentType);
    return matches2 ? matches2[1] : null;
  }
  function decodeString(buffer, contentType) {
    const encodingHint = contentType ? extractEncoding(contentType) : null;
    const encodingAttempts = encodingHint ? [encodingHint, ...ENCODINGS] : ENCODINGS;
    for (const encoding of encodingAttempts) {
      try {
        const decoder = new TextDecoder(encoding, { fatal: true });
        return decoder.decode(buffer);
      } catch (e) {
      }
    }
    console.warn(
      `XML document encoding could not be determined, falling back to ${FALLBACK_ENCODING}.`
    );
    return new TextDecoder(FALLBACK_ENCODING).decode(buffer);
  }
  const fetchPromises = /* @__PURE__ */ new Map();
  function sharedFetch(url) {
    if (fetchPromises.has(url)) {
      return fetchPromises.get(url);
    }
    const promise = fetch(url);
    promise.finally(() => fetchPromises.delete(url));
    fetchPromises.set(url, promise);
    return promise;
  }
  function queryXmlDocument(url) {
    return sharedFetch(url).catch(
      () => fetch(url, { method: "HEAD", mode: "no-cors" }).catch((error) => {
        throw new EndpointError(
          `Fetching the document failed either due to network errors or unreachable host, error is: ${error.message}`,
          0,
          false
        );
      }).then(() => {
        throw new EndpointError(
          `The document could not be fetched due to CORS limitations`,
          0,
          true
        );
      })
    ).then(async (resp) => {
      if (!resp.ok) {
        const text2 = await resp.text();
        throw new EndpointError(
          `Received an error with code ${resp.status}: ${text2}`,
          resp.status,
          false
        );
      }
      const buffer = await resp.arrayBuffer();
      const contentTypeHeader = resp.headers.get("Content-Type");
      return decodeString(buffer, contentTypeHeader);
    }).then((xml2) => parseXmlString(xml2));
  }
  function setQueryParams(url, params2) {
    const encodedUrlMatch = url.match(/(https?%3A%2F%2F[^/]+)$/);
    if (encodedUrlMatch) {
      const encodedUrl = encodedUrlMatch[1];
      const modifiedUrl = setQueryParams(decodeURIComponent(encodedUrl), params2);
      return url.replace(encodedUrl, encodeURIComponent(modifiedUrl));
    }
    const urlObj = new URL(url);
    const keys = Object.keys(params2);
    const keysLower = keys.map((key) => key.toLowerCase());
    const toDelete = [];
    for (const param of urlObj.searchParams.keys()) {
      if (keysLower.indexOf(param.toLowerCase()) > -1) {
        toDelete.push(param);
      }
    }
    toDelete.map((param) => urlObj.searchParams.delete(param));
    keys.forEach(
      (key) => urlObj.searchParams.set(key, params2[key] === true ? "" : params2[key])
    );
    return urlObj.toString();
  }
  let cacheExpiryDuration = 1e3 * 60 * 60;
  function getCacheExpiryDuration() {
    return cacheExpiryDuration;
  }
  const cachePromise = "caches" in self ? caches.open("ogc-client") : null;
  async function storeCacheEntry(object, ...keys) {
    if (!cachePromise)
      return;
    const entryUrl = "https://cache/" + keys.join("/");
    const cache2 = await cachePromise;
    await cache2.put(
      entryUrl,
      new Response(JSON.stringify(object), {
        headers: {
          "x-expiry": (Date.now() + getCacheExpiryDuration()).toString(10)
        }
      })
    );
  }
  async function hasValidCacheEntry(...keys) {
    if (!cachePromise)
      return false;
    const entryUrl = "https://cache/" + keys.join("/");
    const cache2 = await cachePromise;
    return cache2.match(entryUrl).then((req) => !!req && parseInt(req.headers.get("x-expiry")) > Date.now());
  }
  async function readCacheEntry(...keys) {
    if (!cachePromise)
      return null;
    const entryUrl = "https://cache/" + keys.join("/");
    const cache2 = await cachePromise;
    const response = await cache2.match(entryUrl);
    return response ? response.clone().json() : null;
  }
  const tasksMap = /* @__PURE__ */ new Map();
  async function useCache(factory, ...keys) {
    await purgeEntries();
    if (await hasValidCacheEntry(...keys)) {
      return readCacheEntry(...keys);
    }
    const taskKey = keys.join("#");
    if (tasksMap.has(taskKey)) {
      return tasksMap.get(taskKey);
    }
    const taskRun = factory();
    if (taskRun instanceof Promise) {
      taskRun.then(() => tasksMap.delete(taskKey));
      tasksMap.set(taskKey, taskRun);
    }
    const result = await taskRun;
    await storeCacheEntry(result, ...keys);
    return result;
  }
  async function purgeEntries() {
    if (!cachePromise)
      return;
    const cache2 = await cachePromise;
    const keys = await cache2.keys();
    for (let key of keys) {
      const resp = await cache2.match(key);
      if (parseInt(resp.headers.get("x-expiry")) <= Date.now())
        await cache2.delete(key);
    }
  }
  function generateGetFeatureUrl(serviceUrl, version2, featureType, outputFormat, maxFeatures, attributes, hitsOnly, outputCrs, extent, extentCrs) {
    const typeParam = version2 === "2.0.0" ? "TYPENAMES" : "TYPENAME";
    const countParam = version2 === "2.0.0" ? "COUNT" : "MAXFEATURES";
    const newParams = {
      SERVICE: "WFS",
      REQUEST: "GetFeature",
      VERSION: version2,
      [typeParam]: featureType
    };
    if (outputFormat !== void 0)
      newParams.OUTPUTFORMAT = outputFormat;
    if (attributes !== void 0)
      newParams.PROPERTYNAME = attributes.join(",");
    if (hitsOnly) {
      newParams.RESULTTYPE = "hits";
      newParams[countParam] = "1";
    } else if (maxFeatures !== void 0)
      newParams[countParam] = maxFeatures.toString(10);
    if (outputCrs) {
      newParams.SRSNAME = outputCrs;
    }
    if (extent) {
      const extentJoined = extent.join(",");
      newParams.BBOX = extentCrs ? `${extentJoined},${extentCrs}` : extentJoined;
    }
    return setQueryParams(serviceUrl, newParams);
  }
  class WmsEndpoint {
    constructor(url) {
      const capabilitiesUrl = setQueryParams(url, {
        SERVICE: "WMS",
        REQUEST: "GetCapabilities"
      });
      this._capabilitiesPromise = useCache(
        () => parseWmsCapabilities(capabilitiesUrl),
        "WMS",
        "CAPABILITIES",
        capabilitiesUrl
      ).then(({ info, layers, version: version2 }) => {
        this._info = info;
        this._layers = layers;
        this._version = version2;
      });
      this._info = null;
      this._layers = null;
      this._version = null;
    }
    isReady() {
      return this._capabilitiesPromise.then(() => this);
    }
    getServiceInfo() {
      return this._info;
    }
    getLayers() {
      function layerSummaryMapper(layerFull) {
        return {
          title: layerFull.title,
          name: layerFull.name,
          abstract: layerFull.abstract,
          ..."children" in layerFull && {
            children: layerFull.children.map(layerSummaryMapper)
          }
        };
      }
      return this._layers.map(layerSummaryMapper);
    }
    getLayerByName(name) {
      let result = null;
      function layerLookup(layer) {
        if (result !== null)
          return;
        if (layer.name === name) {
          result = layer;
          return;
        }
        if ("children" in layer) {
          layer.children.map(layerLookup);
        }
      }
      this._layers.map(layerLookup);
      return result;
    }
    getVersion() {
      return this._version;
    }
  }
  const LatLonCrsList = [
    "EPSG:4046",
    "EPSG:4075",
    "EPSG:4120",
    "EPSG:4122",
    "EPSG:4124",
    "EPSG:4126",
    "EPSG:4149",
    "EPSG:4151",
    "EPSG:4153",
    "EPSG:4155",
    "EPSG:4157",
    "EPSG:4159",
    "EPSG:4161",
    "EPSG:4163",
    "EPSG:4165",
    "EPSG:4167",
    "EPSG:4169",
    "EPSG:4171",
    "EPSG:4173",
    "EPSG:4175",
    "EPSG:4178",
    "EPSG:4180",
    "EPSG:4182",
    "EPSG:4184",
    "EPSG:4188",
    "EPSG:4190",
    "EPSG:4191",
    "EPSG:4196",
    "EPSG:4198",
    "EPSG:4202",
    "EPSG:4210",
    "EPSG:4211",
    "EPSG:4214",
    "EPSG:4226",
    "EPSG:4229",
    "EPSG:4231",
    "EPSG:4233",
    "EPSG:4236",
    "EPSG:4238",
    "EPSG:4240",
    "EPSG:4242",
    "EPSG:4244",
    "EPSG:4246",
    "EPSG:4248",
    "EPSG:4250",
    "EPSG:4252",
    "EPSG:4255",
    "EPSG:4258",
    "EPSG:4261",
    "EPSG:4264",
    "EPSG:4267",
    "EPSG:4270",
    "EPSG:4273",
    "EPSG:4276",
    "EPSG:4279",
    "EPSG:4281",
    "EPSG:4284",
    "EPSG:4286",
    "EPSG:4288",
    "EPSG:4292",
    "EPSG:4295",
    "EPSG:4297",
    "EPSG:4299",
    "EPSG:4302",
    "EPSG:4324",
    "EPSG:4326"
  ];
  function hasInvertedCoordinates(crsName) {
    return LatLonCrsList.indexOf(simplifyEpsgUrn(crsName)) > -1;
  }
  function simplifyEpsgUrn(fullCrsName) {
    if (/^urn:(?:x-)?ogc:def:crs:epsg:/.test(fullCrsName.toLowerCase())) {
      const code = /([0-9]+)$/.exec(fullCrsName)[1];
      return `EPSG:${code}`;
    }
    return fullCrsName;
  }
  function readVersionFromCapabilities$1(capabilitiesDoc) {
    return getRootElement(capabilitiesDoc).attributes["version"];
  }
  function readLayersFromCapabilities(capabilitiesDoc) {
    const version2 = readVersionFromCapabilities$1(capabilitiesDoc);
    const capability = findChildElement(
      getRootElement(capabilitiesDoc),
      "Capability"
    );
    return findChildrenElement(capability, "Layer").map(
      (layerEl) => parseLayer(layerEl, version2)
    );
  }
  function readInfoFromCapabilities$1(capabilitiesDoc) {
    const service = findChildElement(getRootElement(capabilitiesDoc), "Service");
    const keywords = findChildrenElement(
      findChildElement(service, "KeywordList"),
      "Keyword"
    ).map(getElementText).filter((v2, i, arr2) => arr2.indexOf(v2) === i);
    return {
      title: getElementText(findChildElement(service, "Title")),
      name: getElementText(findChildElement(service, "Name")),
      abstract: getElementText(findChildElement(service, "Abstract")),
      fees: getElementText(findChildElement(service, "Fees")),
      constraints: getElementText(findChildElement(service, "AccessConstraints")),
      keywords
    };
  }
  function parseLayer(layerEl, version2, inheritedSrs = [], inheritedStyles = [], inheritedAttribution = null) {
    const srsTag = version2 === "1.3.0" ? "CRS" : "SRS";
    const srsList = findChildrenElement(layerEl, srsTag).map(getElementText);
    const availableCrs = srsList.length > 0 ? srsList : inheritedSrs;
    const layerStyles = findChildrenElement(layerEl, "Style").map(
      parseLayerStyle
    );
    const styles = layerStyles.length > 0 ? layerStyles : inheritedStyles;
    function parseBBox(bboxEl) {
      const srs = getElementAttribute(bboxEl, srsTag);
      const attrs = hasInvertedCoordinates(srs) && version2 === "1.3.0" ? ["miny", "minx", "maxy", "maxx"] : ["minx", "miny", "maxx", "maxy"];
      return attrs.map((name) => getElementAttribute(bboxEl, name));
    }
    const attributionEl = findChildElement(layerEl, "Attribution");
    const attribution = attributionEl !== null ? parseLayerAttribution(attributionEl) : inheritedAttribution;
    const children = findChildrenElement(layerEl, "Layer").map(
      (layer) => parseLayer(layer, version2, availableCrs, styles, attribution)
    );
    return {
      name: getElementText(findChildElement(layerEl, "Name")),
      title: getElementText(findChildElement(layerEl, "Title")),
      abstract: getElementText(findChildElement(layerEl, "Abstract")),
      availableCrs,
      styles,
      attribution,
      boundingBoxes: findChildrenElement(layerEl, "BoundingBox").reduce(
        (prev, bboxEl) => ({
          ...prev,
          [getElementAttribute(bboxEl, srsTag)]: parseBBox(bboxEl)
        }),
        {}
      ),
      ...children.length && { children }
    };
  }
  function parseLayerStyle(styleEl) {
    const legendUrl = getElementAttribute(
      findChildElement(findChildElement(styleEl, "LegendURL"), "OnlineResource"),
      "xlink:href"
    );
    return {
      name: getElementText(findChildElement(styleEl, "Name")),
      title: getElementText(findChildElement(styleEl, "Title")),
      ...legendUrl && { legendUrl }
    };
  }
  function parseLayerAttribution(attributionEl) {
    const logoUrl = getElementAttribute(
      findChildElement(
        findChildElement(attributionEl, "LogoURL"),
        "OnlineResource"
      ),
      "xlink:href"
    );
    const url = getElementAttribute(
      findChildElement(attributionEl, "OnlineResource"),
      "xlink:href"
    );
    const title = getElementText(findChildElement(attributionEl, "Title"));
    return {
      ...title && { title },
      ...url && { url },
      ...logoUrl && { logoUrl }
    };
  }
  function readVersionFromCapabilities(capabilitiesDoc) {
    return getRootElement(capabilitiesDoc).attributes["version"];
  }
  function readOutputFormatsFromCapabilities(capabilitiesDoc) {
    const version2 = readVersionFromCapabilities(capabilitiesDoc);
    let outputFormats;
    if (version2.startsWith("1.0")) {
      const getFeature = findChildElement(
        findChildElement(
          findChildElement(getRootElement(capabilitiesDoc), "Capability"),
          "Request"
        ),
        "GetFeature"
      );
      outputFormats = getChildrenElement(
        findChildElement(getFeature, "ResultFormat")
      ).map(getElementName);
    } else {
      const operations = findChildElement(
        getRootElement(capabilitiesDoc),
        "OperationsMetadata"
      );
      const getFeature = findChildrenElement(operations, "Operation").find(
        (el) => getElementAttribute(el, "name") === "GetFeature"
      );
      const parameter = findChildrenElement(getFeature, "Parameter").find(
        (el) => getElementAttribute(el, "name") === "outputFormat"
      );
      outputFormats = findChildrenElement(parameter, "Value", true).map(
        getElementText
      );
    }
    return outputFormats;
  }
  function readInfoFromCapabilities(capabilitiesDoc) {
    const version2 = readVersionFromCapabilities(capabilitiesDoc);
    const serviceTag = version2.startsWith("1.0") ? "Service" : "ServiceIdentification";
    const nameTag = version2.startsWith("1.0") ? "Name" : "ServiceType";
    const service = findChildElement(getRootElement(capabilitiesDoc), serviceTag);
    let keywords;
    if (version2.startsWith("1.0")) {
      keywords = getElementText(findChildElement(service, "Keywords")).split(",").map((keyword2) => keyword2.trim());
    } else {
      keywords = findChildrenElement(
        findChildElement(service, "Keywords"),
        "Keyword"
      ).map(getElementText);
    }
    return {
      title: getElementText(findChildElement(service, "Title")),
      name: getElementText(findChildElement(service, nameTag)),
      abstract: getElementText(findChildElement(service, "Abstract")),
      fees: getElementText(findChildElement(service, "Fees")),
      constraints: getElementText(findChildElement(service, "AccessConstraints")),
      keywords,
      outputFormats: readOutputFormatsFromCapabilities(capabilitiesDoc)
    };
  }
  function readFeatureTypesFromCapabilities(capabilitiesDoc) {
    const version2 = readVersionFromCapabilities(capabilitiesDoc);
    const outputFormats = readOutputFormatsFromCapabilities(capabilitiesDoc);
    const capability = findChildElement(
      getRootElement(capabilitiesDoc),
      "FeatureTypeList"
    );
    return findChildrenElement(capability, "FeatureType").map(
      (featureTypeEl) => parseFeatureType(featureTypeEl, version2, outputFormats)
    );
  }
  function parseFeatureType(featureTypeEl, serviceVersion, defaultOutputFormats) {
    const srsTag = serviceVersion.startsWith("2.") ? "CRS" : "SRS";
    const defaultSrsTag = serviceVersion.startsWith("1.0") ? "SRS" : `Default${srsTag}`;
    function parseBBox100() {
      const bboxEl = findChildElement(featureTypeEl, "LatLongBoundingBox");
      return ["minx", "miny", "maxx", "maxy"].map((name) => getElementAttribute(bboxEl, name)).map(parseFloat);
    }
    function parseBBox() {
      const bboxEl = findChildElement(featureTypeEl, "WGS84BoundingBox");
      return ["LowerCorner", "UpperCorner"].map((elName) => findChildElement(bboxEl, elName)).map((cornerEl) => getElementText(cornerEl).split(" ")).reduce((prev, curr) => [...prev, ...curr]).map(parseFloat);
    }
    const otherCrs = serviceVersion.startsWith("1.0") ? [] : findChildrenElement(featureTypeEl, `Other${srsTag}`).map(getElementText).map(simplifyEpsgUrn);
    const outputFormats = serviceVersion.startsWith("1.0") ? [] : findChildrenElement(
      findChildElement(featureTypeEl, "OutputFormats"),
      "Format"
    ).map(getElementText);
    return {
      name: getElementText(findChildElement(featureTypeEl, "Name")),
      title: getElementText(findChildElement(featureTypeEl, "Title")),
      abstract: getElementText(findChildElement(featureTypeEl, "Abstract")),
      defaultCrs: simplifyEpsgUrn(
        getElementText(findChildElement(featureTypeEl, defaultSrsTag))
      ),
      otherCrs,
      outputFormats: outputFormats.length > 0 ? outputFormats : defaultOutputFormats,
      latLonBoundingBox: serviceVersion.startsWith("1.0") ? parseBBox100() : parseBBox()
    };
  }
  function parseFeatureProps(getFeaturesDoc, featureTypeFull, serviceVersion) {
    const collection = getRootElement(getFeaturesDoc);
    let members;
    if (serviceVersion.startsWith("2.0")) {
      members = findChildrenElement(collection, "member").map(
        (parent) => getChildrenElement(parent)[0]
      );
    } else {
      const membersRoot = findChildElement(collection, "featureMembers");
      members = membersRoot ? getChildrenElement(membersRoot) : findChildrenElement(collection, "featureMember").map(
        (parent) => getChildrenElement(parent)[0]
      );
    }
    const idAttr = serviceVersion === "1.0.0" ? "fid" : "gml:id";
    function isElementProperty(propName) {
      return propName in featureTypeFull.properties;
    }
    function parseElementPropertyValue(propName, valueAsString) {
      const type = featureTypeFull.properties[propName];
      switch (type) {
        case "integer":
          return parseInt(valueAsString);
        case "float":
          return parseFloat(valueAsString);
        case "boolean":
          return valueAsString === "true";
        default:
          return valueAsString;
      }
    }
    function getProperties(memberEl) {
      return getChildrenElement(memberEl).filter((el) => isElementProperty(stripNamespace(getElementName(el)))).reduce((prev, curr) => {
        const propName = stripNamespace(getElementName(curr));
        return {
          ...prev,
          [propName]: parseElementPropertyValue(propName, getElementText(curr))
        };
      }, {});
    }
    return members.map((el) => ({
      id: getElementAttribute(el, idAttr),
      properties: getProperties(el)
    }));
  }
  function computeFeaturePropsDetails(featuresWithProps) {
    return featuresWithProps.reduce((prev, curr) => {
      for (const propName in curr.properties) {
        const propValue = curr.properties[propName];
        if (!(propName in prev)) {
          prev[propName] = { uniqueValues: [] };
        }
        const uniqueValue = prev[propName].uniqueValues.find(
          (v2) => v2.value === propValue
        );
        if (uniqueValue)
          uniqueValue.count++;
        else
          prev[propName].uniqueValues.push({ value: propValue, count: 1 });
      }
      return prev;
    }, {});
  }
  addTaskHandler(
    "parseWmsCapabilities",
    self,
    ({ url }) => queryXmlDocument(url).then((xmlDoc) => ({
      info: readInfoFromCapabilities$1(xmlDoc),
      layers: readLayersFromCapabilities(xmlDoc),
      version: readVersionFromCapabilities$1(xmlDoc)
    }))
  );
  addTaskHandler(
    "parseWfsCapabilities",
    self,
    ({ url }) => queryXmlDocument(url).then((xmlDoc) => ({
      info: readInfoFromCapabilities(xmlDoc),
      featureTypes: readFeatureTypesFromCapabilities(xmlDoc),
      version: readVersionFromCapabilities(xmlDoc)
    }))
  );
  addTaskHandler(
    "queryWfsFeatureTypeDetails",
    self,
    ({ url, serviceVersion, featureTypeFull }) => {
      const getFeatureUrl = generateGetFeatureUrl(
        url,
        serviceVersion,
        featureTypeFull.name,
        void 0,
        void 0,
        Object.keys(featureTypeFull.properties)
      );
      return queryXmlDocument(getFeatureUrl).then((getFeatureDoc) => ({
        props: computeFeaturePropsDetails(
          parseFeatureProps(getFeatureDoc, featureTypeFull, serviceVersion)
        )
      }));
    }
  );
  const predefinedWmsFixture = () => {
    return [
      {
        url: "http://wmts1.geoportail.lu/opendata/service",
        label: "Open Data Webservices WMS"
      },
      {
        url: "http://ows.terrestris.de/osm-gray/service",
        label: "OpenStreetMap by Terrestris (Grey)"
      },
      {
        url: "http://ows.terrestris.de/osm/service",
        label: "OpenStreetMap by Terrestris (Color)"
      }
    ];
  };
  class BaseEvent {
    constructor(type) {
      this.propagationStopped;
      this.defaultPrevented;
      this.type = type;
      this.target = null;
    }
    preventDefault() {
      this.defaultPrevented = true;
    }
    stopPropagation() {
      this.propagationStopped = true;
    }
  }
  const Event = BaseEvent;
  const ObjectEventType = {
    PROPERTYCHANGE: "propertychange"
  };
  class Disposable {
    constructor() {
      this.disposed = false;
    }
    dispose() {
      if (!this.disposed) {
        this.disposed = true;
        this.disposeInternal();
      }
    }
    disposeInternal() {
    }
  }
  const Disposable$1 = Disposable;
  function ascending(a, b) {
    return a > b ? 1 : a < b ? -1 : 0;
  }
  function linearFindNearest(arr2, target, direction) {
    const n = arr2.length;
    if (arr2[0] <= target) {
      return 0;
    } else if (target <= arr2[n - 1]) {
      return n - 1;
    }
    let i;
    if (direction > 0) {
      for (i = 1; i < n; ++i) {
        if (arr2[i] < target) {
          return i - 1;
        }
      }
    } else if (direction < 0) {
      for (i = 1; i < n; ++i) {
        if (arr2[i] <= target) {
          return i;
        }
      }
    } else {
      for (i = 1; i < n; ++i) {
        if (arr2[i] == target) {
          return i;
        } else if (arr2[i] < target) {
          if (typeof direction === "function") {
            if (direction(target, arr2[i - 1], arr2[i]) > 0) {
              return i - 1;
            }
            return i;
          } else if (arr2[i - 1] - target < target - arr2[i]) {
            return i - 1;
          }
          return i;
        }
      }
    }
    return n - 1;
  }
  function extend(arr2, data) {
    const extension = Array.isArray(data) ? data : [data];
    const length = extension.length;
    for (let i = 0; i < length; i++) {
      arr2[arr2.length] = extension[i];
    }
  }
  function equals(arr1, arr2) {
    const len1 = arr1.length;
    if (len1 !== arr2.length) {
      return false;
    }
    for (let i = 0; i < len1; i++) {
      if (arr1[i] !== arr2[i]) {
        return false;
      }
    }
    return true;
  }
  function isSorted(arr2, func, strict) {
    const compare = func || ascending;
    return arr2.every(function(currentVal, index2) {
      if (index2 === 0) {
        return true;
      }
      const res = compare(arr2[index2 - 1], currentVal);
      return !(res > 0 || strict && res === 0);
    });
  }
  function TRUE() {
    return true;
  }
  function FALSE() {
    return false;
  }
  function VOID() {
  }
  function memoizeOne(fn) {
    let called = false;
    let lastResult;
    let lastArgs;
    let lastThis;
    return function() {
      const nextArgs = Array.prototype.slice.call(arguments);
      if (!called || this !== lastThis || !equals(nextArgs, lastArgs)) {
        called = true;
        lastThis = this;
        lastArgs = nextArgs;
        lastResult = fn.apply(this, arguments);
      }
      return lastResult;
    };
  }
  class Target extends Disposable$1 {
    constructor(target) {
      super();
      this.eventTarget_ = target;
      this.pendingRemovals_ = null;
      this.dispatching_ = null;
      this.listeners_ = null;
    }
    addEventListener(type, listener) {
      if (!type || !listener) {
        return;
      }
      const listeners = this.listeners_ || (this.listeners_ = {});
      const listenersForType = listeners[type] || (listeners[type] = []);
      if (!listenersForType.includes(listener)) {
        listenersForType.push(listener);
      }
    }
    dispatchEvent(event) {
      const isString = typeof event === "string";
      const type = isString ? event : event.type;
      const listeners = this.listeners_ && this.listeners_[type];
      if (!listeners) {
        return;
      }
      const evt = isString ? new Event(event) : event;
      if (!evt.target) {
        evt.target = this.eventTarget_ || this;
      }
      const dispatching = this.dispatching_ || (this.dispatching_ = {});
      const pendingRemovals = this.pendingRemovals_ || (this.pendingRemovals_ = {});
      if (!(type in dispatching)) {
        dispatching[type] = 0;
        pendingRemovals[type] = 0;
      }
      ++dispatching[type];
      let propagate;
      for (let i = 0, ii = listeners.length; i < ii; ++i) {
        if ("handleEvent" in listeners[i]) {
          propagate = listeners[i].handleEvent(evt);
        } else {
          propagate = listeners[i].call(this, evt);
        }
        if (propagate === false || evt.propagationStopped) {
          propagate = false;
          break;
        }
      }
      if (--dispatching[type] === 0) {
        let pr = pendingRemovals[type];
        delete pendingRemovals[type];
        while (pr--) {
          this.removeEventListener(type, VOID);
        }
        delete dispatching[type];
      }
      return propagate;
    }
    disposeInternal() {
      this.listeners_ && clear(this.listeners_);
    }
    getListeners(type) {
      return this.listeners_ && this.listeners_[type] || void 0;
    }
    hasListener(type) {
      if (!this.listeners_) {
        return false;
      }
      return type ? type in this.listeners_ : Object.keys(this.listeners_).length > 0;
    }
    removeEventListener(type, listener) {
      const listeners = this.listeners_ && this.listeners_[type];
      if (listeners) {
        const index2 = listeners.indexOf(listener);
        if (index2 !== -1) {
          if (this.pendingRemovals_ && type in this.pendingRemovals_) {
            listeners[index2] = VOID;
            ++this.pendingRemovals_[type];
          } else {
            listeners.splice(index2, 1);
            if (listeners.length === 0) {
              delete this.listeners_[type];
            }
          }
        }
      }
    }
  }
  const Target$1 = Target;
  const EventType = {
    CHANGE: "change",
    ERROR: "error",
    BLUR: "blur",
    CLEAR: "clear",
    CONTEXTMENU: "contextmenu",
    CLICK: "click",
    DBLCLICK: "dblclick",
    DRAGENTER: "dragenter",
    DRAGOVER: "dragover",
    DROP: "drop",
    FOCUS: "focus",
    KEYDOWN: "keydown",
    KEYPRESS: "keypress",
    LOAD: "load",
    RESIZE: "resize",
    TOUCHMOVE: "touchmove",
    WHEEL: "wheel"
  };
  function listen(target, type, listener, thisArg, once) {
    if (thisArg && thisArg !== target) {
      listener = listener.bind(thisArg);
    }
    if (once) {
      const originalListener = listener;
      listener = function() {
        target.removeEventListener(type, listener);
        originalListener.apply(this, arguments);
      };
    }
    const eventsKey = {
      target,
      type,
      listener
    };
    target.addEventListener(type, listener);
    return eventsKey;
  }
  function listenOnce(target, type, listener, thisArg) {
    return listen(target, type, listener, thisArg, true);
  }
  function unlistenByKey(key) {
    if (key && key.target) {
      key.target.removeEventListener(key.type, key.listener);
      clear(key);
    }
  }
  class Observable extends Target$1 {
    constructor() {
      super();
      this.on = this.onInternal;
      this.once = this.onceInternal;
      this.un = this.unInternal;
      this.revision_ = 0;
    }
    changed() {
      ++this.revision_;
      this.dispatchEvent(EventType.CHANGE);
    }
    getRevision() {
      return this.revision_;
    }
    onInternal(type, listener) {
      if (Array.isArray(type)) {
        const len = type.length;
        const keys = new Array(len);
        for (let i = 0; i < len; ++i) {
          keys[i] = listen(this, type[i], listener);
        }
        return keys;
      }
      return listen(this, type, listener);
    }
    onceInternal(type, listener) {
      let key;
      if (Array.isArray(type)) {
        const len = type.length;
        key = new Array(len);
        for (let i = 0; i < len; ++i) {
          key[i] = listenOnce(this, type[i], listener);
        }
      } else {
        key = listenOnce(this, type, listener);
      }
      listener.ol_key = key;
      return key;
    }
    unInternal(type, listener) {
      const key = listener.ol_key;
      if (key) {
        unByKey(key);
      } else if (Array.isArray(type)) {
        for (let i = 0, ii = type.length; i < ii; ++i) {
          this.removeEventListener(type[i], listener);
        }
      } else {
        this.removeEventListener(type, listener);
      }
    }
  }
  Observable.prototype.on;
  Observable.prototype.once;
  Observable.prototype.un;
  function unByKey(key) {
    if (Array.isArray(key)) {
      for (let i = 0, ii = key.length; i < ii; ++i) {
        unlistenByKey(key[i]);
      }
    } else {
      unlistenByKey(key);
    }
  }
  const Observable$1 = Observable;
  function abstract() {
    throw new Error("Unimplemented abstract method.");
  }
  let uidCounter_ = 0;
  function getUid(obj) {
    return obj.ol_uid || (obj.ol_uid = String(++uidCounter_));
  }
  class ObjectEvent extends Event {
    constructor(type, key, oldValue) {
      super(type);
      this.key = key;
      this.oldValue = oldValue;
    }
  }
  class BaseObject extends Observable$1 {
    constructor(values) {
      super();
      this.on;
      this.once;
      this.un;
      getUid(this);
      this.values_ = null;
      if (values !== void 0) {
        this.setProperties(values);
      }
    }
    get(key) {
      let value;
      if (this.values_ && this.values_.hasOwnProperty(key)) {
        value = this.values_[key];
      }
      return value;
    }
    getKeys() {
      return this.values_ && Object.keys(this.values_) || [];
    }
    getProperties() {
      return this.values_ && Object.assign({}, this.values_) || {};
    }
    hasProperties() {
      return !!this.values_;
    }
    notify(key, oldValue) {
      let eventType;
      eventType = `change:${key}`;
      if (this.hasListener(eventType)) {
        this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));
      }
      eventType = ObjectEventType.PROPERTYCHANGE;
      if (this.hasListener(eventType)) {
        this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));
      }
    }
    addChangeListener(key, listener) {
      this.addEventListener(`change:${key}`, listener);
    }
    removeChangeListener(key, listener) {
      this.removeEventListener(`change:${key}`, listener);
    }
    set(key, value, silent) {
      const values = this.values_ || (this.values_ = {});
      if (silent) {
        values[key] = value;
      } else {
        const oldValue = values[key];
        values[key] = value;
        if (oldValue !== value) {
          this.notify(key, oldValue);
        }
      }
    }
    setProperties(values, silent) {
      for (const key in values) {
        this.set(key, values[key], silent);
      }
    }
    applyProperties(source) {
      if (!source.values_) {
        return;
      }
      Object.assign(this.values_ || (this.values_ = {}), source.values_);
    }
    unset(key, silent) {
      if (this.values_ && key in this.values_) {
        const oldValue = this.values_[key];
        delete this.values_[key];
        if (isEmpty$1(this.values_)) {
          this.values_ = null;
        }
        if (!silent) {
          this.notify(key, oldValue);
        }
      }
    }
  }
  const BaseObject$1 = BaseObject;
  const LayerProperty = {
    OPACITY: "opacity",
    VISIBLE: "visible",
    EXTENT: "extent",
    Z_INDEX: "zIndex",
    MAX_RESOLUTION: "maxResolution",
    MIN_RESOLUTION: "minResolution",
    MAX_ZOOM: "maxZoom",
    MIN_ZOOM: "minZoom",
    SOURCE: "source",
    MAP: "map"
  };
  class BaseLayer extends BaseObject$1 {
    constructor(options) {
      super();
      this.on;
      this.once;
      this.un;
      this.background_ = options.background;
      const properties = Object.assign({}, options);
      if (typeof options.properties === "object") {
        delete properties.properties;
        Object.assign(properties, options.properties);
      }
      properties[LayerProperty.OPACITY] = options.opacity !== void 0 ? options.opacity : 1;
      assert(typeof properties[LayerProperty.OPACITY] === "number", 64);
      properties[LayerProperty.VISIBLE] = options.visible !== void 0 ? options.visible : true;
      properties[LayerProperty.Z_INDEX] = options.zIndex;
      properties[LayerProperty.MAX_RESOLUTION] = options.maxResolution !== void 0 ? options.maxResolution : Infinity;
      properties[LayerProperty.MIN_RESOLUTION] = options.minResolution !== void 0 ? options.minResolution : 0;
      properties[LayerProperty.MIN_ZOOM] = options.minZoom !== void 0 ? options.minZoom : -Infinity;
      properties[LayerProperty.MAX_ZOOM] = options.maxZoom !== void 0 ? options.maxZoom : Infinity;
      this.className_ = properties.className !== void 0 ? properties.className : "ol-layer";
      delete properties.className;
      this.setProperties(properties);
      this.state_ = null;
    }
    getBackground() {
      return this.background_;
    }
    getClassName() {
      return this.className_;
    }
    getLayerState(managed) {
      const state = this.state_ || {
        layer: this,
        managed: managed === void 0 ? true : managed
      };
      const zIndex = this.getZIndex();
      state.opacity = clamp(Math.round(this.getOpacity() * 100) / 100, 0, 1);
      state.visible = this.getVisible();
      state.extent = this.getExtent();
      state.zIndex = zIndex === void 0 && !state.managed ? Infinity : zIndex;
      state.maxResolution = this.getMaxResolution();
      state.minResolution = Math.max(this.getMinResolution(), 0);
      state.minZoom = this.getMinZoom();
      state.maxZoom = this.getMaxZoom();
      this.state_ = state;
      return state;
    }
    getLayersArray(array) {
      return abstract();
    }
    getLayerStatesArray(states) {
      return abstract();
    }
    getExtent() {
      return this.get(LayerProperty.EXTENT);
    }
    getMaxResolution() {
      return this.get(LayerProperty.MAX_RESOLUTION);
    }
    getMinResolution() {
      return this.get(LayerProperty.MIN_RESOLUTION);
    }
    getMinZoom() {
      return this.get(LayerProperty.MIN_ZOOM);
    }
    getMaxZoom() {
      return this.get(LayerProperty.MAX_ZOOM);
    }
    getOpacity() {
      return this.get(LayerProperty.OPACITY);
    }
    getSourceState() {
      return abstract();
    }
    getVisible() {
      return this.get(LayerProperty.VISIBLE);
    }
    getZIndex() {
      return this.get(LayerProperty.Z_INDEX);
    }
    setBackground(background) {
      this.background_ = background;
      this.changed();
    }
    setExtent(extent) {
      this.set(LayerProperty.EXTENT, extent);
    }
    setMaxResolution(maxResolution) {
      this.set(LayerProperty.MAX_RESOLUTION, maxResolution);
    }
    setMinResolution(minResolution) {
      this.set(LayerProperty.MIN_RESOLUTION, minResolution);
    }
    setMaxZoom(maxZoom) {
      this.set(LayerProperty.MAX_ZOOM, maxZoom);
    }
    setMinZoom(minZoom) {
      this.set(LayerProperty.MIN_ZOOM, minZoom);
    }
    setOpacity(opacity) {
      assert(typeof opacity === "number", 64);
      this.set(LayerProperty.OPACITY, opacity);
    }
    setVisible(visible) {
      this.set(LayerProperty.VISIBLE, visible);
    }
    setZIndex(zindex) {
      this.set(LayerProperty.Z_INDEX, zindex);
    }
    disposeInternal() {
      if (this.state_) {
        this.state_.layer = null;
        this.state_ = null;
      }
      super.disposeInternal();
    }
  }
  const BaseLayer$1 = BaseLayer;
  const RenderEventType = {
    PRERENDER: "prerender",
    POSTRENDER: "postrender",
    PRECOMPOSE: "precompose",
    POSTCOMPOSE: "postcompose",
    RENDERCOMPLETE: "rendercomplete"
  };
  const ViewHint = {
    ANIMATING: 0,
    INTERACTING: 1
  };
  const ViewProperty = {
    CENTER: "center",
    RESOLUTION: "resolution",
    ROTATION: "rotation"
  };
  const DEFAULT_MAX_ZOOM = 42;
  const DEFAULT_TILE_SIZE = 256;
  function createExtent(extent, onlyCenter, smooth) {
    return function(center, resolution, size, isMoving, centerShift) {
      if (!center) {
        return void 0;
      }
      if (!resolution && !onlyCenter) {
        return center;
      }
      const viewWidth = onlyCenter ? 0 : size[0] * resolution;
      const viewHeight = onlyCenter ? 0 : size[1] * resolution;
      const shiftX = centerShift ? centerShift[0] : 0;
      const shiftY = centerShift ? centerShift[1] : 0;
      let minX = extent[0] + viewWidth / 2 + shiftX;
      let maxX = extent[2] - viewWidth / 2 + shiftX;
      let minY = extent[1] + viewHeight / 2 + shiftY;
      let maxY = extent[3] - viewHeight / 2 + shiftY;
      if (minX > maxX) {
        minX = (maxX + minX) / 2;
        maxX = minX;
      }
      if (minY > maxY) {
        minY = (maxY + minY) / 2;
        maxY = minY;
      }
      let x = clamp(center[0], minX, maxX);
      let y2 = clamp(center[1], minY, maxY);
      if (isMoving && smooth && resolution) {
        const ratio = 30 * resolution;
        x += -ratio * Math.log(1 + Math.max(0, minX - center[0]) / ratio) + ratio * Math.log(1 + Math.max(0, center[0] - maxX) / ratio);
        y2 += -ratio * Math.log(1 + Math.max(0, minY - center[1]) / ratio) + ratio * Math.log(1 + Math.max(0, center[1] - maxY) / ratio);
      }
      return [x, y2];
    };
  }
  function none$1(center) {
    return center;
  }
  function getViewportClampedResolution(resolution, maxExtent, viewportSize, showFullExtent) {
    const xResolution = getWidth(maxExtent) / viewportSize[0];
    const yResolution = getHeight(maxExtent) / viewportSize[1];
    if (showFullExtent) {
      return Math.min(resolution, Math.max(xResolution, yResolution));
    }
    return Math.min(resolution, Math.min(xResolution, yResolution));
  }
  function getSmoothClampedResolution(resolution, maxResolution, minResolution) {
    let result = Math.min(resolution, maxResolution);
    const ratio = 50;
    result *= Math.log(1 + ratio * Math.max(0, resolution / maxResolution - 1)) / ratio + 1;
    if (minResolution) {
      result = Math.max(result, minResolution);
      result /= Math.log(1 + ratio * Math.max(0, minResolution / resolution - 1)) / ratio + 1;
    }
    return clamp(result, minResolution / 2, maxResolution * 2);
  }
  function createSnapToResolutions(resolutions, smooth, maxExtent, showFullExtent) {
    smooth = smooth !== void 0 ? smooth : true;
    return function(resolution, direction, size, isMoving) {
      if (resolution !== void 0) {
        const maxResolution = resolutions[0];
        const minResolution = resolutions[resolutions.length - 1];
        const cappedMaxRes = maxExtent ? getViewportClampedResolution(
          maxResolution,
          maxExtent,
          size,
          showFullExtent
        ) : maxResolution;
        if (isMoving) {
          if (!smooth) {
            return clamp(resolution, minResolution, cappedMaxRes);
          }
          return getSmoothClampedResolution(
            resolution,
            cappedMaxRes,
            minResolution
          );
        }
        const capped = Math.min(cappedMaxRes, resolution);
        const z = Math.floor(linearFindNearest(resolutions, capped, direction));
        if (resolutions[z] > cappedMaxRes && z < resolutions.length - 1) {
          return resolutions[z + 1];
        }
        return resolutions[z];
      }
      return void 0;
    };
  }
  function createSnapToPower(power, maxResolution, minResolution, smooth, maxExtent, showFullExtent) {
    smooth = smooth !== void 0 ? smooth : true;
    minResolution = minResolution !== void 0 ? minResolution : 0;
    return function(resolution, direction, size, isMoving) {
      if (resolution !== void 0) {
        const cappedMaxRes = maxExtent ? getViewportClampedResolution(
          maxResolution,
          maxExtent,
          size,
          showFullExtent
        ) : maxResolution;
        if (isMoving) {
          if (!smooth) {
            return clamp(resolution, minResolution, cappedMaxRes);
          }
          return getSmoothClampedResolution(
            resolution,
            cappedMaxRes,
            minResolution
          );
        }
        const tolerance = 1e-9;
        const minZoomLevel = Math.ceil(
          Math.log(maxResolution / cappedMaxRes) / Math.log(power) - tolerance
        );
        const offset = -direction * (0.5 - tolerance) + 0.5;
        const capped = Math.min(cappedMaxRes, resolution);
        const cappedZoomLevel = Math.floor(
          Math.log(maxResolution / capped) / Math.log(power) + offset
        );
        const zoomLevel = Math.max(minZoomLevel, cappedZoomLevel);
        const newResolution = maxResolution / Math.pow(power, zoomLevel);
        return clamp(newResolution, minResolution, cappedMaxRes);
      }
      return void 0;
    };
  }
  function createMinMaxResolution(maxResolution, minResolution, smooth, maxExtent, showFullExtent) {
    smooth = smooth !== void 0 ? smooth : true;
    return function(resolution, direction, size, isMoving) {
      if (resolution !== void 0) {
        const cappedMaxRes = maxExtent ? getViewportClampedResolution(
          maxResolution,
          maxExtent,
          size,
          showFullExtent
        ) : maxResolution;
        if (!smooth || !isMoving) {
          return clamp(resolution, minResolution, cappedMaxRes);
        }
        return getSmoothClampedResolution(
          resolution,
          cappedMaxRes,
          minResolution
        );
      }
      return void 0;
    };
  }
  function disable(rotation) {
    if (rotation !== void 0) {
      return 0;
    }
    return void 0;
  }
  function none(rotation) {
    if (rotation !== void 0) {
      return rotation;
    }
    return void 0;
  }
  function createSnapToN(n) {
    const theta = 2 * Math.PI / n;
    return function(rotation, isMoving) {
      if (isMoving) {
        return rotation;
      }
      if (rotation !== void 0) {
        rotation = Math.floor(rotation / theta + 0.5) * theta;
        return rotation;
      }
      return void 0;
    };
  }
  function createSnapToZero(tolerance) {
    tolerance = tolerance || toRadians(5);
    return function(rotation, isMoving) {
      if (isMoving) {
        return rotation;
      }
      if (rotation !== void 0) {
        if (Math.abs(rotation) <= tolerance) {
          return 0;
        }
        return rotation;
      }
      return void 0;
    };
  }
  function easeIn(t) {
    return Math.pow(t, 3);
  }
  function easeOut(t) {
    return 1 - easeIn(1 - t);
  }
  function inAndOut(t) {
    return 3 * t * t - 2 * t * t * t;
  }
  function linear(t) {
    return t;
  }
  const ua = typeof navigator !== "undefined" && typeof navigator.userAgent !== "undefined" ? navigator.userAgent.toLowerCase() : "";
  const FIREFOX = ua.includes("firefox");
  const SAFARI = ua.includes("safari") && !ua.includes("chrom");
  SAFARI && (ua.includes("version/15.4") || /cpu (os|iphone os) 15_4 like mac os x/.test(ua));
  const WEBKIT = ua.includes("webkit") && !ua.includes("edge");
  const MAC = ua.includes("macintosh");
  const DEVICE_PIXEL_RATIO = typeof devicePixelRatio !== "undefined" ? devicePixelRatio : 1;
  const WORKER_OFFSCREEN_CANVAS = typeof WorkerGlobalScope !== "undefined" && typeof OffscreenCanvas !== "undefined" && self instanceof WorkerGlobalScope;
  const IMAGE_DECODE = typeof Image !== "undefined" && Image.prototype.decode;
  const PASSIVE_EVENT_LISTENERS = function() {
    let passive = false;
    try {
      const options = Object.defineProperty({}, "passive", {
        get: function() {
          passive = true;
        }
      });
      window.addEventListener("_", null, options);
      window.removeEventListener("_", null, options);
    } catch (error) {
    }
    return passive;
  }();
  new Array(6);
  function create() {
    return [1, 0, 0, 1, 0, 0];
  }
  function apply(transform2, coordinate) {
    const x = coordinate[0];
    const y2 = coordinate[1];
    coordinate[0] = transform2[0] * x + transform2[2] * y2 + transform2[4];
    coordinate[1] = transform2[1] * x + transform2[3] * y2 + transform2[5];
    return coordinate;
  }
  function compose(transform2, dx1, dy1, sx, sy, angle, dx2, dy2) {
    const sin = Math.sin(angle);
    const cos = Math.cos(angle);
    transform2[0] = sx * cos;
    transform2[1] = sy * sin;
    transform2[2] = -sx * sin;
    transform2[3] = sy * cos;
    transform2[4] = dx2 * sx * cos - dy2 * sx * sin + dx1;
    transform2[5] = dx2 * sy * sin + dy2 * sy * cos + dy1;
    return transform2;
  }
  function makeInverse(target, source) {
    const det = determinant(source);
    assert(det !== 0, 32);
    const a = source[0];
    const b = source[1];
    const c2 = source[2];
    const d = source[3];
    const e = source[4];
    const f = source[5];
    target[0] = d / det;
    target[1] = -b / det;
    target[2] = -c2 / det;
    target[3] = a / det;
    target[4] = (c2 * f - d * e) / det;
    target[5] = -(a * f - b * e) / det;
    return target;
  }
  function determinant(mat) {
    return mat[0] * mat[3] - mat[1] * mat[2];
  }
  let transformStringDiv;
  function toString$1(mat) {
    const transformString = "matrix(" + mat.join(", ") + ")";
    if (WORKER_OFFSCREEN_CANVAS) {
      return transformString;
    }
    const node = transformStringDiv || (transformStringDiv = document.createElement("div"));
    node.style.transform = transformString;
    return node.style.transform;
  }
  function transform2D(flatCoordinates, offset, end, stride, transform2, dest) {
    dest = dest ? dest : [];
    let i = 0;
    for (let j = offset; j < end; j += stride) {
      const x = flatCoordinates[j];
      const y2 = flatCoordinates[j + 1];
      dest[i++] = transform2[0] * x + transform2[2] * y2 + transform2[4];
      dest[i++] = transform2[1] * x + transform2[3] * y2 + transform2[5];
    }
    if (dest && dest.length != i) {
      dest.length = i;
    }
    return dest;
  }
  function rotate(flatCoordinates, offset, end, stride, angle, anchor, dest) {
    dest = dest ? dest : [];
    const cos = Math.cos(angle);
    const sin = Math.sin(angle);
    const anchorX = anchor[0];
    const anchorY = anchor[1];
    let i = 0;
    for (let j = offset; j < end; j += stride) {
      const deltaX = flatCoordinates[j] - anchorX;
      const deltaY = flatCoordinates[j + 1] - anchorY;
      dest[i++] = anchorX + deltaX * cos - deltaY * sin;
      dest[i++] = anchorY + deltaX * sin + deltaY * cos;
      for (let k = j + 2; k < j + stride; ++k) {
        dest[i++] = flatCoordinates[k];
      }
    }
    if (dest && dest.length != i) {
      dest.length = i;
    }
    return dest;
  }
  function scale$1(flatCoordinates, offset, end, stride, sx, sy, anchor, dest) {
    dest = dest ? dest : [];
    const anchorX = anchor[0];
    const anchorY = anchor[1];
    let i = 0;
    for (let j = offset; j < end; j += stride) {
      const deltaX = flatCoordinates[j] - anchorX;
      const deltaY = flatCoordinates[j + 1] - anchorY;
      dest[i++] = anchorX + sx * deltaX;
      dest[i++] = anchorY + sy * deltaY;
      for (let k = j + 2; k < j + stride; ++k) {
        dest[i++] = flatCoordinates[k];
      }
    }
    if (dest && dest.length != i) {
      dest.length = i;
    }
    return dest;
  }
  function translate(flatCoordinates, offset, end, stride, deltaX, deltaY, dest) {
    dest = dest ? dest : [];
    let i = 0;
    for (let j = offset; j < end; j += stride) {
      dest[i++] = flatCoordinates[j] + deltaX;
      dest[i++] = flatCoordinates[j + 1] + deltaY;
      for (let k = j + 2; k < j + stride; ++k) {
        dest[i++] = flatCoordinates[k];
      }
    }
    if (dest && dest.length != i) {
      dest.length = i;
    }
    return dest;
  }
  const tmpTransform = create();
  class Geometry extends BaseObject$1 {
    constructor() {
      super();
      this.extent_ = createEmpty();
      this.extentRevision_ = -1;
      this.simplifiedGeometryMaxMinSquaredTolerance = 0;
      this.simplifiedGeometryRevision = 0;
      this.simplifyTransformedInternal = memoizeOne(function(revision, squaredTolerance, transform2) {
        if (!transform2) {
          return this.getSimplifiedGeometry(squaredTolerance);
        }
        const clone2 = this.clone();
        clone2.applyTransform(transform2);
        return clone2.getSimplifiedGeometry(squaredTolerance);
      });
    }
    simplifyTransformed(squaredTolerance, transform2) {
      return this.simplifyTransformedInternal(
        this.getRevision(),
        squaredTolerance,
        transform2
      );
    }
    clone() {
      return abstract();
    }
    closestPointXY(x, y2, closestPoint, minSquaredDistance) {
      return abstract();
    }
    containsXY(x, y2) {
      const coord = this.getClosestPoint([x, y2]);
      return coord[0] === x && coord[1] === y2;
    }
    getClosestPoint(point, closestPoint) {
      closestPoint = closestPoint ? closestPoint : [NaN, NaN];
      this.closestPointXY(point[0], point[1], closestPoint, Infinity);
      return closestPoint;
    }
    intersectsCoordinate(coordinate) {
      return this.containsXY(coordinate[0], coordinate[1]);
    }
    computeExtent(extent) {
      return abstract();
    }
    getExtent(extent) {
      if (this.extentRevision_ != this.getRevision()) {
        const extent2 = this.computeExtent(this.extent_);
        if (isNaN(extent2[0]) || isNaN(extent2[1])) {
          createOrUpdateEmpty(extent2);
        }
        this.extentRevision_ = this.getRevision();
      }
      return returnOrUpdate(this.extent_, extent);
    }
    rotate(angle, anchor) {
      abstract();
    }
    scale(sx, sy, anchor) {
      abstract();
    }
    simplify(tolerance) {
      return this.getSimplifiedGeometry(tolerance * tolerance);
    }
    getSimplifiedGeometry(squaredTolerance) {
      return abstract();
    }
    getType() {
      return abstract();
    }
    applyTransform(transformFn) {
      abstract();
    }
    intersectsExtent(extent) {
      return abstract();
    }
    translate(deltaX, deltaY) {
      abstract();
    }
    transform(source, destination) {
      const sourceProj = get$2(source);
      const transformFn = sourceProj.getUnits() == "tile-pixels" ? function(inCoordinates, outCoordinates, stride) {
        const pixelExtent = sourceProj.getExtent();
        const projectedExtent = sourceProj.getWorldExtent();
        const scale2 = getHeight(projectedExtent) / getHeight(pixelExtent);
        compose(
          tmpTransform,
          projectedExtent[0],
          projectedExtent[3],
          scale2,
          -scale2,
          0,
          0,
          0
        );
        transform2D(
          inCoordinates,
          0,
          inCoordinates.length,
          stride,
          tmpTransform,
          outCoordinates
        );
        return getTransform(sourceProj, destination)(
          inCoordinates,
          outCoordinates,
          stride
        );
      } : getTransform(sourceProj, destination);
      this.applyTransform(transformFn);
      return this;
    }
  }
  const Geometry$1 = Geometry;
  class SimpleGeometry extends Geometry$1 {
    constructor() {
      super();
      this.layout = "XY";
      this.stride = 2;
      this.flatCoordinates = null;
    }
    computeExtent(extent) {
      return createOrUpdateFromFlatCoordinates(
        this.flatCoordinates,
        0,
        this.flatCoordinates.length,
        this.stride,
        extent
      );
    }
    getCoordinates() {
      return abstract();
    }
    getFirstCoordinate() {
      return this.flatCoordinates.slice(0, this.stride);
    }
    getFlatCoordinates() {
      return this.flatCoordinates;
    }
    getLastCoordinate() {
      return this.flatCoordinates.slice(
        this.flatCoordinates.length - this.stride
      );
    }
    getLayout() {
      return this.layout;
    }
    getSimplifiedGeometry(squaredTolerance) {
      if (this.simplifiedGeometryRevision !== this.getRevision()) {
        this.simplifiedGeometryMaxMinSquaredTolerance = 0;
        this.simplifiedGeometryRevision = this.getRevision();
      }
      if (squaredTolerance < 0 || this.simplifiedGeometryMaxMinSquaredTolerance !== 0 && squaredTolerance <= this.simplifiedGeometryMaxMinSquaredTolerance) {
        return this;
      }
      const simplifiedGeometry = this.getSimplifiedGeometryInternal(squaredTolerance);
      const simplifiedFlatCoordinates = simplifiedGeometry.getFlatCoordinates();
      if (simplifiedFlatCoordinates.length < this.flatCoordinates.length) {
        return simplifiedGeometry;
      }
      this.simplifiedGeometryMaxMinSquaredTolerance = squaredTolerance;
      return this;
    }
    getSimplifiedGeometryInternal(squaredTolerance) {
      return this;
    }
    getStride() {
      return this.stride;
    }
    setFlatCoordinates(layout, flatCoordinates) {
      this.stride = getStrideForLayout(layout);
      this.layout = layout;
      this.flatCoordinates = flatCoordinates;
    }
    setCoordinates(coordinates2, layout) {
      abstract();
    }
    setLayout(layout, coordinates2, nesting) {
      let stride;
      if (layout) {
        stride = getStrideForLayout(layout);
      } else {
        for (let i = 0; i < nesting; ++i) {
          if (coordinates2.length === 0) {
            this.layout = "XY";
            this.stride = 2;
            return;
          }
          coordinates2 = coordinates2[0];
        }
        stride = coordinates2.length;
        layout = getLayoutForStride(stride);
      }
      this.layout = layout;
      this.stride = stride;
    }
    applyTransform(transformFn) {
      if (this.flatCoordinates) {
        transformFn(this.flatCoordinates, this.flatCoordinates, this.stride);
        this.changed();
      }
    }
    rotate(angle, anchor) {
      const flatCoordinates = this.getFlatCoordinates();
      if (flatCoordinates) {
        const stride = this.getStride();
        rotate(
          flatCoordinates,
          0,
          flatCoordinates.length,
          stride,
          angle,
          anchor,
          flatCoordinates
        );
        this.changed();
      }
    }
    scale(sx, sy, anchor) {
      if (sy === void 0) {
        sy = sx;
      }
      if (!anchor) {
        anchor = getCenter(this.getExtent());
      }
      const flatCoordinates = this.getFlatCoordinates();
      if (flatCoordinates) {
        const stride = this.getStride();
        scale$1(
          flatCoordinates,
          0,
          flatCoordinates.length,
          stride,
          sx,
          sy,
          anchor,
          flatCoordinates
        );
        this.changed();
      }
    }
    translate(deltaX, deltaY) {
      const flatCoordinates = this.getFlatCoordinates();
      if (flatCoordinates) {
        const stride = this.getStride();
        translate(
          flatCoordinates,
          0,
          flatCoordinates.length,
          stride,
          deltaX,
          deltaY,
          flatCoordinates
        );
        this.changed();
      }
    }
  }
  function getLayoutForStride(stride) {
    let layout;
    if (stride == 2) {
      layout = "XY";
    } else if (stride == 3) {
      layout = "XYZ";
    } else if (stride == 4) {
      layout = "XYZM";
    }
    return layout;
  }
  function getStrideForLayout(layout) {
    let stride;
    if (layout == "XY") {
      stride = 2;
    } else if (layout == "XYZ" || layout == "XYM") {
      stride = 3;
    } else if (layout == "XYZM") {
      stride = 4;
    }
    return stride;
  }
  const SimpleGeometry$1 = SimpleGeometry;
  function assignClosest(flatCoordinates, offset1, offset2, stride, x, y2, closestPoint) {
    const x1 = flatCoordinates[offset1];
    const y1 = flatCoordinates[offset1 + 1];
    const dx = flatCoordinates[offset2] - x1;
    const dy = flatCoordinates[offset2 + 1] - y1;
    let offset;
    if (dx === 0 && dy === 0) {
      offset = offset1;
    } else {
      const t = ((x - x1) * dx + (y2 - y1) * dy) / (dx * dx + dy * dy);
      if (t > 1) {
        offset = offset2;
      } else if (t > 0) {
        for (let i = 0; i < stride; ++i) {
          closestPoint[i] = lerp(
            flatCoordinates[offset1 + i],
            flatCoordinates[offset2 + i],
            t
          );
        }
        closestPoint.length = stride;
        return;
      } else {
        offset = offset1;
      }
    }
    for (let i = 0; i < stride; ++i) {
      closestPoint[i] = flatCoordinates[offset + i];
    }
    closestPoint.length = stride;
  }
  function maxSquaredDelta(flatCoordinates, offset, end, stride, max) {
    let x1 = flatCoordinates[offset];
    let y1 = flatCoordinates[offset + 1];
    for (offset += stride; offset < end; offset += stride) {
      const x2 = flatCoordinates[offset];
      const y2 = flatCoordinates[offset + 1];
      const squaredDelta = squaredDistance(x1, y1, x2, y2);
      if (squaredDelta > max) {
        max = squaredDelta;
      }
      x1 = x2;
      y1 = y2;
    }
    return max;
  }
  function arrayMaxSquaredDelta(flatCoordinates, offset, ends, stride, max) {
    for (let i = 0, ii = ends.length; i < ii; ++i) {
      const end = ends[i];
      max = maxSquaredDelta(flatCoordinates, offset, end, stride, max);
      offset = end;
    }
    return max;
  }
  function assignClosestPoint(flatCoordinates, offset, end, stride, maxDelta, isRing, x, y2, closestPoint, minSquaredDistance, tmpPoint) {
    if (offset == end) {
      return minSquaredDistance;
    }
    let i, squaredDistance$1;
    if (maxDelta === 0) {
      squaredDistance$1 = squaredDistance(
        x,
        y2,
        flatCoordinates[offset],
        flatCoordinates[offset + 1]
      );
      if (squaredDistance$1 < minSquaredDistance) {
        for (i = 0; i < stride; ++i) {
          closestPoint[i] = flatCoordinates[offset + i];
        }
        closestPoint.length = stride;
        return squaredDistance$1;
      }
      return minSquaredDistance;
    }
    tmpPoint = tmpPoint ? tmpPoint : [NaN, NaN];
    let index2 = offset + stride;
    while (index2 < end) {
      assignClosest(
        flatCoordinates,
        index2 - stride,
        index2,
        stride,
        x,
        y2,
        tmpPoint
      );
      squaredDistance$1 = squaredDistance(x, y2, tmpPoint[0], tmpPoint[1]);
      if (squaredDistance$1 < minSquaredDistance) {
        minSquaredDistance = squaredDistance$1;
        for (i = 0; i < stride; ++i) {
          closestPoint[i] = tmpPoint[i];
        }
        closestPoint.length = stride;
        index2 += stride;
      } else {
        index2 += stride * Math.max(
          (Math.sqrt(squaredDistance$1) - Math.sqrt(minSquaredDistance)) / maxDelta | 0,
          1
        );
      }
    }
    if (isRing) {
      assignClosest(
        flatCoordinates,
        end - stride,
        offset,
        stride,
        x,
        y2,
        tmpPoint
      );
      squaredDistance$1 = squaredDistance(x, y2, tmpPoint[0], tmpPoint[1]);
      if (squaredDistance$1 < minSquaredDistance) {
        minSquaredDistance = squaredDistance$1;
        for (i = 0; i < stride; ++i) {
          closestPoint[i] = tmpPoint[i];
        }
        closestPoint.length = stride;
      }
    }
    return minSquaredDistance;
  }
  function assignClosestArrayPoint(flatCoordinates, offset, ends, stride, maxDelta, isRing, x, y2, closestPoint, minSquaredDistance, tmpPoint) {
    tmpPoint = tmpPoint ? tmpPoint : [NaN, NaN];
    for (let i = 0, ii = ends.length; i < ii; ++i) {
      const end = ends[i];
      minSquaredDistance = assignClosestPoint(
        flatCoordinates,
        offset,
        end,
        stride,
        maxDelta,
        isRing,
        x,
        y2,
        closestPoint,
        minSquaredDistance,
        tmpPoint
      );
      offset = end;
    }
    return minSquaredDistance;
  }
  function deflateCoordinate(flatCoordinates, offset, coordinate, stride) {
    for (let i = 0, ii = coordinate.length; i < ii; ++i) {
      flatCoordinates[offset++] = coordinate[i];
    }
    return offset;
  }
  function deflateCoordinates(flatCoordinates, offset, coordinates2, stride) {
    for (let i = 0, ii = coordinates2.length; i < ii; ++i) {
      const coordinate = coordinates2[i];
      for (let j = 0; j < stride; ++j) {
        flatCoordinates[offset++] = coordinate[j];
      }
    }
    return offset;
  }
  function deflateCoordinatesArray(flatCoordinates, offset, coordinatess, stride, ends) {
    ends = ends ? ends : [];
    let i = 0;
    for (let j = 0, jj = coordinatess.length; j < jj; ++j) {
      const end = deflateCoordinates(
        flatCoordinates,
        offset,
        coordinatess[j],
        stride
      );
      ends[i++] = end;
      offset = end;
    }
    ends.length = i;
    return ends;
  }
  function douglasPeucker(flatCoordinates, offset, end, stride, squaredTolerance, simplifiedFlatCoordinates, simplifiedOffset) {
    const n = (end - offset) / stride;
    if (n < 3) {
      for (; offset < end; offset += stride) {
        simplifiedFlatCoordinates[simplifiedOffset++] = flatCoordinates[offset];
        simplifiedFlatCoordinates[simplifiedOffset++] = flatCoordinates[offset + 1];
      }
      return simplifiedOffset;
    }
    const markers = new Array(n);
    markers[0] = 1;
    markers[n - 1] = 1;
    const stack = [offset, end - stride];
    let index2 = 0;
    while (stack.length > 0) {
      const last = stack.pop();
      const first = stack.pop();
      let maxSquaredDistance = 0;
      const x1 = flatCoordinates[first];
      const y1 = flatCoordinates[first + 1];
      const x2 = flatCoordinates[last];
      const y2 = flatCoordinates[last + 1];
      for (let i = first + stride; i < last; i += stride) {
        const x = flatCoordinates[i];
        const y3 = flatCoordinates[i + 1];
        const squaredDistance2 = squaredSegmentDistance(x, y3, x1, y1, x2, y2);
        if (squaredDistance2 > maxSquaredDistance) {
          index2 = i;
          maxSquaredDistance = squaredDistance2;
        }
      }
      if (maxSquaredDistance > squaredTolerance) {
        markers[(index2 - offset) / stride] = 1;
        if (first + stride < index2) {
          stack.push(first, index2);
        }
        if (index2 + stride < last) {
          stack.push(index2, last);
        }
      }
    }
    for (let i = 0; i < n; ++i) {
      if (markers[i]) {
        simplifiedFlatCoordinates[simplifiedOffset++] = flatCoordinates[offset + i * stride];
        simplifiedFlatCoordinates[simplifiedOffset++] = flatCoordinates[offset + i * stride + 1];
      }
    }
    return simplifiedOffset;
  }
  function snap(value, tolerance) {
    return tolerance * Math.round(value / tolerance);
  }
  function quantize(flatCoordinates, offset, end, stride, tolerance, simplifiedFlatCoordinates, simplifiedOffset) {
    if (offset == end) {
      return simplifiedOffset;
    }
    let x1 = snap(flatCoordinates[offset], tolerance);
    let y1 = snap(flatCoordinates[offset + 1], tolerance);
    offset += stride;
    simplifiedFlatCoordinates[simplifiedOffset++] = x1;
    simplifiedFlatCoordinates[simplifiedOffset++] = y1;
    let x2, y2;
    do {
      x2 = snap(flatCoordinates[offset], tolerance);
      y2 = snap(flatCoordinates[offset + 1], tolerance);
      offset += stride;
      if (offset == end) {
        simplifiedFlatCoordinates[simplifiedOffset++] = x2;
        simplifiedFlatCoordinates[simplifiedOffset++] = y2;
        return simplifiedOffset;
      }
    } while (x2 == x1 && y2 == y1);
    while (offset < end) {
      const x3 = snap(flatCoordinates[offset], tolerance);
      const y3 = snap(flatCoordinates[offset + 1], tolerance);
      offset += stride;
      if (x3 == x2 && y3 == y2) {
        continue;
      }
      const dx1 = x2 - x1;
      const dy1 = y2 - y1;
      const dx2 = x3 - x1;
      const dy2 = y3 - y1;
      if (dx1 * dy2 == dy1 * dx2 && (dx1 < 0 && dx2 < dx1 || dx1 == dx2 || dx1 > 0 && dx2 > dx1) && (dy1 < 0 && dy2 < dy1 || dy1 == dy2 || dy1 > 0 && dy2 > dy1)) {
        x2 = x3;
        y2 = y3;
        continue;
      }
      simplifiedFlatCoordinates[simplifiedOffset++] = x2;
      simplifiedFlatCoordinates[simplifiedOffset++] = y2;
      x1 = x2;
      y1 = y2;
      x2 = x3;
      y2 = y3;
    }
    simplifiedFlatCoordinates[simplifiedOffset++] = x2;
    simplifiedFlatCoordinates[simplifiedOffset++] = y2;
    return simplifiedOffset;
  }
  function quantizeArray(flatCoordinates, offset, ends, stride, tolerance, simplifiedFlatCoordinates, simplifiedOffset, simplifiedEnds) {
    for (let i = 0, ii = ends.length; i < ii; ++i) {
      const end = ends[i];
      simplifiedOffset = quantize(
        flatCoordinates,
        offset,
        end,
        stride,
        tolerance,
        simplifiedFlatCoordinates,
        simplifiedOffset
      );
      simplifiedEnds.push(simplifiedOffset);
      offset = end;
    }
    return simplifiedOffset;
  }
  function inflateCoordinates(flatCoordinates, offset, end, stride, coordinates2) {
    coordinates2 = coordinates2 !== void 0 ? coordinates2 : [];
    let i = 0;
    for (let j = offset; j < end; j += stride) {
      coordinates2[i++] = flatCoordinates.slice(j, j + stride);
    }
    coordinates2.length = i;
    return coordinates2;
  }
  function inflateCoordinatesArray(flatCoordinates, offset, ends, stride, coordinatess) {
    coordinatess = coordinatess !== void 0 ? coordinatess : [];
    let i = 0;
    for (let j = 0, jj = ends.length; j < jj; ++j) {
      const end = ends[j];
      coordinatess[i++] = inflateCoordinates(
        flatCoordinates,
        offset,
        end,
        stride,
        coordinatess[i]
      );
      offset = end;
    }
    coordinatess.length = i;
    return coordinatess;
  }
  function linearRing(flatCoordinates, offset, end, stride) {
    let twiceArea = 0;
    let x1 = flatCoordinates[end - stride];
    let y1 = flatCoordinates[end - stride + 1];
    for (; offset < end; offset += stride) {
      const x2 = flatCoordinates[offset];
      const y2 = flatCoordinates[offset + 1];
      twiceArea += y1 * x2 - x1 * y2;
      x1 = x2;
      y1 = y2;
    }
    return twiceArea / 2;
  }
  function linearRings(flatCoordinates, offset, ends, stride) {
    let area = 0;
    for (let i = 0, ii = ends.length; i < ii; ++i) {
      const end = ends[i];
      area += linearRing(flatCoordinates, offset, end, stride);
      offset = end;
    }
    return area;
  }
  class LinearRing extends SimpleGeometry$1 {
    constructor(coordinates2, layout) {
      super();
      this.maxDelta_ = -1;
      this.maxDeltaRevision_ = -1;
      if (layout !== void 0 && !Array.isArray(coordinates2[0])) {
        this.setFlatCoordinates(
          layout,
          coordinates2
        );
      } else {
        this.setCoordinates(
          coordinates2,
          layout
        );
      }
    }
    clone() {
      return new LinearRing(this.flatCoordinates.slice(), this.layout);
    }
    closestPointXY(x, y2, closestPoint, minSquaredDistance) {
      if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y2)) {
        return minSquaredDistance;
      }
      if (this.maxDeltaRevision_ != this.getRevision()) {
        this.maxDelta_ = Math.sqrt(
          maxSquaredDelta(
            this.flatCoordinates,
            0,
            this.flatCoordinates.length,
            this.stride,
            0
          )
        );
        this.maxDeltaRevision_ = this.getRevision();
      }
      return assignClosestPoint(
        this.flatCoordinates,
        0,
        this.flatCoordinates.length,
        this.stride,
        this.maxDelta_,
        true,
        x,
        y2,
        closestPoint,
        minSquaredDistance
      );
    }
    getArea() {
      return linearRing(
        this.flatCoordinates,
        0,
        this.flatCoordinates.length,
        this.stride
      );
    }
    getCoordinates() {
      return inflateCoordinates(
        this.flatCoordinates,
        0,
        this.flatCoordinates.length,
        this.stride
      );
    }
    getSimplifiedGeometryInternal(squaredTolerance) {
      const simplifiedFlatCoordinates = [];
      simplifiedFlatCoordinates.length = douglasPeucker(
        this.flatCoordinates,
        0,
        this.flatCoordinates.length,
        this.stride,
        squaredTolerance,
        simplifiedFlatCoordinates,
        0
      );
      return new LinearRing(simplifiedFlatCoordinates, "XY");
    }
    getType() {
      return "LinearRing";
    }
    intersectsExtent(extent) {
      return false;
    }
    setCoordinates(coordinates2, layout) {
      this.setLayout(layout, coordinates2, 1);
      if (!this.flatCoordinates) {
        this.flatCoordinates = [];
      }
      this.flatCoordinates.length = deflateCoordinates(
        this.flatCoordinates,
        0,
        coordinates2,
        this.stride
      );
      this.changed();
    }
  }
  const LinearRing$1 = LinearRing;
  class Point extends SimpleGeometry$1 {
    constructor(coordinates2, layout) {
      super();
      this.setCoordinates(coordinates2, layout);
    }
    clone() {
      const point = new Point(this.flatCoordinates.slice(), this.layout);
      point.applyProperties(this);
      return point;
    }
    closestPointXY(x, y2, closestPoint, minSquaredDistance) {
      const flatCoordinates = this.flatCoordinates;
      const squaredDistance$1 = squaredDistance(
        x,
        y2,
        flatCoordinates[0],
        flatCoordinates[1]
      );
      if (squaredDistance$1 < minSquaredDistance) {
        const stride = this.stride;
        for (let i = 0; i < stride; ++i) {
          closestPoint[i] = flatCoordinates[i];
        }
        closestPoint.length = stride;
        return squaredDistance$1;
      }
      return minSquaredDistance;
    }
    getCoordinates() {
      return !this.flatCoordinates ? [] : this.flatCoordinates.slice();
    }
    computeExtent(extent) {
      return createOrUpdateFromCoordinate(this.flatCoordinates, extent);
    }
    getType() {
      return "Point";
    }
    intersectsExtent(extent) {
      return containsXY(extent, this.flatCoordinates[0], this.flatCoordinates[1]);
    }
    setCoordinates(coordinates2, layout) {
      this.setLayout(layout, coordinates2, 0);
      if (!this.flatCoordinates) {
        this.flatCoordinates = [];
      }
      this.flatCoordinates.length = deflateCoordinate(
        this.flatCoordinates,
        0,
        coordinates2,
        this.stride
      );
      this.changed();
    }
  }
  const Point$1 = Point;
  function linearRingContainsExtent(flatCoordinates, offset, end, stride, extent) {
    const outside = forEachCorner(
      extent,
      function(coordinate) {
        return !linearRingContainsXY(
          flatCoordinates,
          offset,
          end,
          stride,
          coordinate[0],
          coordinate[1]
        );
      }
    );
    return !outside;
  }
  function linearRingContainsXY(flatCoordinates, offset, end, stride, x, y2) {
    let wn = 0;
    let x1 = flatCoordinates[end - stride];
    let y1 = flatCoordinates[end - stride + 1];
    for (; offset < end; offset += stride) {
      const x2 = flatCoordinates[offset];
      const y22 = flatCoordinates[offset + 1];
      if (y1 <= y2) {
        if (y22 > y2 && (x2 - x1) * (y2 - y1) - (x - x1) * (y22 - y1) > 0) {
          wn++;
        }
      } else if (y22 <= y2 && (x2 - x1) * (y2 - y1) - (x - x1) * (y22 - y1) < 0) {
        wn--;
      }
      x1 = x2;
      y1 = y22;
    }
    return wn !== 0;
  }
  function linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y2) {
    if (ends.length === 0) {
      return false;
    }
    if (!linearRingContainsXY(flatCoordinates, offset, ends[0], stride, x, y2)) {
      return false;
    }
    for (let i = 1, ii = ends.length; i < ii; ++i) {
      if (linearRingContainsXY(flatCoordinates, ends[i - 1], ends[i], stride, x, y2)) {
        return false;
      }
    }
    return true;
  }
  function getInteriorPointOfArray(flatCoordinates, offset, ends, stride, flatCenters, flatCentersOffset, dest) {
    let i, ii, x, x1, x2, y1, y2;
    const y3 = flatCenters[flatCentersOffset + 1];
    const intersections = [];
    for (let r = 0, rr = ends.length; r < rr; ++r) {
      const end = ends[r];
      x1 = flatCoordinates[end - stride];
      y1 = flatCoordinates[end - stride + 1];
      for (i = offset; i < end; i += stride) {
        x2 = flatCoordinates[i];
        y2 = flatCoordinates[i + 1];
        if (y3 <= y1 && y2 <= y3 || y1 <= y3 && y3 <= y2) {
          x = (y3 - y1) / (y2 - y1) * (x2 - x1) + x1;
          intersections.push(x);
        }
        x1 = x2;
        y1 = y2;
      }
    }
    let pointX = NaN;
    let maxSegmentLength = -Infinity;
    intersections.sort(ascending);
    x1 = intersections[0];
    for (i = 1, ii = intersections.length; i < ii; ++i) {
      x2 = intersections[i];
      const segmentLength = Math.abs(x2 - x1);
      if (segmentLength > maxSegmentLength) {
        x = (x1 + x2) / 2;
        if (linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y3)) {
          pointX = x;
          maxSegmentLength = segmentLength;
        }
      }
      x1 = x2;
    }
    if (isNaN(pointX)) {
      pointX = flatCenters[flatCentersOffset];
    }
    if (dest) {
      dest.push(pointX, y3, maxSegmentLength);
      return dest;
    }
    return [pointX, y3, maxSegmentLength];
  }
  function forEach(flatCoordinates, offset, end, stride, callback) {
    let ret;
    offset += stride;
    for (; offset < end; offset += stride) {
      ret = callback(
        flatCoordinates.slice(offset - stride, offset),
        flatCoordinates.slice(offset, offset + stride)
      );
      if (ret) {
        return ret;
      }
    }
    return false;
  }
  function intersectsLineString(flatCoordinates, offset, end, stride, extent) {
    const coordinatesExtent = extendFlatCoordinates(
      createEmpty(),
      flatCoordinates,
      offset,
      end,
      stride
    );
    if (!intersects(extent, coordinatesExtent)) {
      return false;
    }
    if (containsExtent(extent, coordinatesExtent)) {
      return true;
    }
    if (coordinatesExtent[0] >= extent[0] && coordinatesExtent[2] <= extent[2]) {
      return true;
    }
    if (coordinatesExtent[1] >= extent[1] && coordinatesExtent[3] <= extent[3]) {
      return true;
    }
    return forEach(
      flatCoordinates,
      offset,
      end,
      stride,
      function(point1, point2) {
        return intersectsSegment(extent, point1, point2);
      }
    );
  }
  function intersectsLinearRing(flatCoordinates, offset, end, stride, extent) {
    if (intersectsLineString(flatCoordinates, offset, end, stride, extent)) {
      return true;
    }
    if (linearRingContainsXY(
      flatCoordinates,
      offset,
      end,
      stride,
      extent[0],
      extent[1]
    )) {
      return true;
    }
    if (linearRingContainsXY(
      flatCoordinates,
      offset,
      end,
      stride,
      extent[0],
      extent[3]
    )) {
      return true;
    }
    if (linearRingContainsXY(
      flatCoordinates,
      offset,
      end,
      stride,
      extent[2],
      extent[1]
    )) {
      return true;
    }
    if (linearRingContainsXY(
      flatCoordinates,
      offset,
      end,
      stride,
      extent[2],
      extent[3]
    )) {
      return true;
    }
    return false;
  }
  function intersectsLinearRingArray(flatCoordinates, offset, ends, stride, extent) {
    if (!intersectsLinearRing(flatCoordinates, offset, ends[0], stride, extent)) {
      return false;
    }
    if (ends.length === 1) {
      return true;
    }
    for (let i = 1, ii = ends.length; i < ii; ++i) {
      if (linearRingContainsExtent(
        flatCoordinates,
        ends[i - 1],
        ends[i],
        stride,
        extent
      )) {
        if (!intersectsLineString(
          flatCoordinates,
          ends[i - 1],
          ends[i],
          stride,
          extent
        )) {
          return false;
        }
      }
    }
    return true;
  }
  function coordinates(flatCoordinates, offset, end, stride) {
    while (offset < end - stride) {
      for (let i = 0; i < stride; ++i) {
        const tmp = flatCoordinates[offset + i];
        flatCoordinates[offset + i] = flatCoordinates[end - stride + i];
        flatCoordinates[end - stride + i] = tmp;
      }
      offset += stride;
      end -= stride;
    }
  }
  function linearRingIsClockwise(flatCoordinates, offset, end, stride) {
    let edge = 0;
    let x1 = flatCoordinates[end - stride];
    let y1 = flatCoordinates[end - stride + 1];
    for (; offset < end; offset += stride) {
      const x2 = flatCoordinates[offset];
      const y2 = flatCoordinates[offset + 1];
      edge += (x2 - x1) * (y2 + y1);
      x1 = x2;
      y1 = y2;
    }
    return edge === 0 ? void 0 : edge > 0;
  }
  function linearRingsAreOriented(flatCoordinates, offset, ends, stride, right) {
    right = right !== void 0 ? right : false;
    for (let i = 0, ii = ends.length; i < ii; ++i) {
      const end = ends[i];
      const isClockwise = linearRingIsClockwise(
        flatCoordinates,
        offset,
        end,
        stride
      );
      if (i === 0) {
        if (right && isClockwise || !right && !isClockwise) {
          return false;
        }
      } else {
        if (right && !isClockwise || !right && isClockwise) {
          return false;
        }
      }
      offset = end;
    }
    return true;
  }
  function orientLinearRings(flatCoordinates, offset, ends, stride, right) {
    right = right !== void 0 ? right : false;
    for (let i = 0, ii = ends.length; i < ii; ++i) {
      const end = ends[i];
      const isClockwise = linearRingIsClockwise(
        flatCoordinates,
        offset,
        end,
        stride
      );
      const reverse = i === 0 ? right && isClockwise || !right && !isClockwise : right && !isClockwise || !right && isClockwise;
      if (reverse) {
        coordinates(flatCoordinates, offset, end, stride);
      }
      offset = end;
    }
    return offset;
  }
  class Polygon extends SimpleGeometry$1 {
    constructor(coordinates2, layout, ends) {
      super();
      this.ends_ = [];
      this.flatInteriorPointRevision_ = -1;
      this.flatInteriorPoint_ = null;
      this.maxDelta_ = -1;
      this.maxDeltaRevision_ = -1;
      this.orientedRevision_ = -1;
      this.orientedFlatCoordinates_ = null;
      if (layout !== void 0 && ends) {
        this.setFlatCoordinates(
          layout,
          coordinates2
        );
        this.ends_ = ends;
      } else {
        this.setCoordinates(
          coordinates2,
          layout
        );
      }
    }
    appendLinearRing(linearRing2) {
      if (!this.flatCoordinates) {
        this.flatCoordinates = linearRing2.getFlatCoordinates().slice();
      } else {
        extend(this.flatCoordinates, linearRing2.getFlatCoordinates());
      }
      this.ends_.push(this.flatCoordinates.length);
      this.changed();
    }
    clone() {
      const polygon = new Polygon(
        this.flatCoordinates.slice(),
        this.layout,
        this.ends_.slice()
      );
      polygon.applyProperties(this);
      return polygon;
    }
    closestPointXY(x, y2, closestPoint, minSquaredDistance) {
      if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y2)) {
        return minSquaredDistance;
      }
      if (this.maxDeltaRevision_ != this.getRevision()) {
        this.maxDelta_ = Math.sqrt(
          arrayMaxSquaredDelta(
            this.flatCoordinates,
            0,
            this.ends_,
            this.stride,
            0
          )
        );
        this.maxDeltaRevision_ = this.getRevision();
      }
      return assignClosestArrayPoint(
        this.flatCoordinates,
        0,
        this.ends_,
        this.stride,
        this.maxDelta_,
        true,
        x,
        y2,
        closestPoint,
        minSquaredDistance
      );
    }
    containsXY(x, y2) {
      return linearRingsContainsXY(
        this.getOrientedFlatCoordinates(),
        0,
        this.ends_,
        this.stride,
        x,
        y2
      );
    }
    getArea() {
      return linearRings(
        this.getOrientedFlatCoordinates(),
        0,
        this.ends_,
        this.stride
      );
    }
    getCoordinates(right) {
      let flatCoordinates;
      if (right !== void 0) {
        flatCoordinates = this.getOrientedFlatCoordinates().slice();
        orientLinearRings(flatCoordinates, 0, this.ends_, this.stride, right);
      } else {
        flatCoordinates = this.flatCoordinates;
      }
      return inflateCoordinatesArray(flatCoordinates, 0, this.ends_, this.stride);
    }
    getEnds() {
      return this.ends_;
    }
    getFlatInteriorPoint() {
      if (this.flatInteriorPointRevision_ != this.getRevision()) {
        const flatCenter = getCenter(this.getExtent());
        this.flatInteriorPoint_ = getInteriorPointOfArray(
          this.getOrientedFlatCoordinates(),
          0,
          this.ends_,
          this.stride,
          flatCenter,
          0
        );
        this.flatInteriorPointRevision_ = this.getRevision();
      }
      return this.flatInteriorPoint_;
    }
    getInteriorPoint() {
      return new Point$1(this.getFlatInteriorPoint(), "XYM");
    }
    getLinearRingCount() {
      return this.ends_.length;
    }
    getLinearRing(index2) {
      if (index2 < 0 || this.ends_.length <= index2) {
        return null;
      }
      return new LinearRing$1(
        this.flatCoordinates.slice(
          index2 === 0 ? 0 : this.ends_[index2 - 1],
          this.ends_[index2]
        ),
        this.layout
      );
    }
    getLinearRings() {
      const layout = this.layout;
      const flatCoordinates = this.flatCoordinates;
      const ends = this.ends_;
      const linearRings2 = [];
      let offset = 0;
      for (let i = 0, ii = ends.length; i < ii; ++i) {
        const end = ends[i];
        const linearRing2 = new LinearRing$1(
          flatCoordinates.slice(offset, end),
          layout
        );
        linearRings2.push(linearRing2);
        offset = end;
      }
      return linearRings2;
    }
    getOrientedFlatCoordinates() {
      if (this.orientedRevision_ != this.getRevision()) {
        const flatCoordinates = this.flatCoordinates;
        if (linearRingsAreOriented(flatCoordinates, 0, this.ends_, this.stride)) {
          this.orientedFlatCoordinates_ = flatCoordinates;
        } else {
          this.orientedFlatCoordinates_ = flatCoordinates.slice();
          this.orientedFlatCoordinates_.length = orientLinearRings(
            this.orientedFlatCoordinates_,
            0,
            this.ends_,
            this.stride
          );
        }
        this.orientedRevision_ = this.getRevision();
      }
      return this.orientedFlatCoordinates_;
    }
    getSimplifiedGeometryInternal(squaredTolerance) {
      const simplifiedFlatCoordinates = [];
      const simplifiedEnds = [];
      simplifiedFlatCoordinates.length = quantizeArray(
        this.flatCoordinates,
        0,
        this.ends_,
        this.stride,
        Math.sqrt(squaredTolerance),
        simplifiedFlatCoordinates,
        0,
        simplifiedEnds
      );
      return new Polygon(simplifiedFlatCoordinates, "XY", simplifiedEnds);
    }
    getType() {
      return "Polygon";
    }
    intersectsExtent(extent) {
      return intersectsLinearRingArray(
        this.getOrientedFlatCoordinates(),
        0,
        this.ends_,
        this.stride,
        extent
      );
    }
    setCoordinates(coordinates2, layout) {
      this.setLayout(layout, coordinates2, 2);
      if (!this.flatCoordinates) {
        this.flatCoordinates = [];
      }
      const ends = deflateCoordinatesArray(
        this.flatCoordinates,
        0,
        coordinates2,
        this.stride,
        this.ends_
      );
      this.flatCoordinates.length = ends.length === 0 ? 0 : ends[ends.length - 1];
      this.changed();
    }
  }
  function fromExtent(extent) {
    const minX = extent[0];
    const minY = extent[1];
    const maxX = extent[2];
    const maxY = extent[3];
    const flatCoordinates = [
      minX,
      minY,
      minX,
      maxY,
      maxX,
      maxY,
      maxX,
      minY,
      minX,
      minY
    ];
    return new Polygon(flatCoordinates, "XY", [flatCoordinates.length]);
  }
  const DEFAULT_MIN_ZOOM = 0;
  class View extends BaseObject$1 {
    constructor(options) {
      super();
      this.on;
      this.once;
      this.un;
      options = Object.assign({}, options);
      this.hints_ = [0, 0];
      this.animations_ = [];
      this.updateAnimationKey_;
      this.projection_ = createProjection(options.projection, "EPSG:3857");
      this.viewportSize_ = [100, 100];
      this.targetCenter_ = null;
      this.targetResolution_;
      this.targetRotation_;
      this.nextCenter_ = null;
      this.nextResolution_;
      this.nextRotation_;
      this.cancelAnchor_ = void 0;
      if (options.projection) {
        disableCoordinateWarning();
      }
      if (options.center) {
        options.center = fromUserCoordinate(options.center, this.projection_);
      }
      if (options.extent) {
        options.extent = fromUserExtent(options.extent, this.projection_);
      }
      this.applyOptions_(options);
    }
    applyOptions_(options) {
      const properties = Object.assign({}, options);
      for (const key in ViewProperty) {
        delete properties[key];
      }
      this.setProperties(properties, true);
      const resolutionConstraintInfo = createResolutionConstraint(options);
      this.maxResolution_ = resolutionConstraintInfo.maxResolution;
      this.minResolution_ = resolutionConstraintInfo.minResolution;
      this.zoomFactor_ = resolutionConstraintInfo.zoomFactor;
      this.resolutions_ = options.resolutions;
      this.padding_ = options.padding;
      this.minZoom_ = resolutionConstraintInfo.minZoom;
      const centerConstraint = createCenterConstraint(options);
      const resolutionConstraint = resolutionConstraintInfo.constraint;
      const rotationConstraint = createRotationConstraint(options);
      this.constraints_ = {
        center: centerConstraint,
        resolution: resolutionConstraint,
        rotation: rotationConstraint
      };
      this.setRotation(options.rotation !== void 0 ? options.rotation : 0);
      this.setCenterInternal(
        options.center !== void 0 ? options.center : null
      );
      if (options.resolution !== void 0) {
        this.setResolution(options.resolution);
      } else if (options.zoom !== void 0) {
        this.setZoom(options.zoom);
      }
    }
    get padding() {
      return this.padding_;
    }
    set padding(padding) {
      let oldPadding = this.padding_;
      this.padding_ = padding;
      const center = this.getCenterInternal();
      if (center) {
        const newPadding = padding || [0, 0, 0, 0];
        oldPadding = oldPadding || [0, 0, 0, 0];
        const resolution = this.getResolution();
        const offsetX = resolution / 2 * (newPadding[3] - oldPadding[3] + oldPadding[1] - newPadding[1]);
        const offsetY = resolution / 2 * (newPadding[0] - oldPadding[0] + oldPadding[2] - newPadding[2]);
        this.setCenterInternal([center[0] + offsetX, center[1] - offsetY]);
      }
    }
    getUpdatedOptions_(newOptions) {
      const options = this.getProperties();
      if (options.resolution !== void 0) {
        options.resolution = this.getResolution();
      } else {
        options.zoom = this.getZoom();
      }
      options.center = this.getCenterInternal();
      options.rotation = this.getRotation();
      return Object.assign({}, options, newOptions);
    }
    animate(var_args) {
      if (this.isDef() && !this.getAnimating()) {
        this.resolveConstraints(0);
      }
      const args = new Array(arguments.length);
      for (let i = 0; i < args.length; ++i) {
        let options = arguments[i];
        if (options.center) {
          options = Object.assign({}, options);
          options.center = fromUserCoordinate(
            options.center,
            this.getProjection()
          );
        }
        if (options.anchor) {
          options = Object.assign({}, options);
          options.anchor = fromUserCoordinate(
            options.anchor,
            this.getProjection()
          );
        }
        args[i] = options;
      }
      this.animateInternal.apply(this, args);
    }
    animateInternal(var_args) {
      let animationCount = arguments.length;
      let callback;
      if (animationCount > 1 && typeof arguments[animationCount - 1] === "function") {
        callback = arguments[animationCount - 1];
        --animationCount;
      }
      let i = 0;
      for (; i < animationCount && !this.isDef(); ++i) {
        const state = arguments[i];
        if (state.center) {
          this.setCenterInternal(state.center);
        }
        if (state.zoom !== void 0) {
          this.setZoom(state.zoom);
        } else if (state.resolution) {
          this.setResolution(state.resolution);
        }
        if (state.rotation !== void 0) {
          this.setRotation(state.rotation);
        }
      }
      if (i === animationCount) {
        if (callback) {
          animationCallback(callback, true);
        }
        return;
      }
      let start2 = Date.now();
      let center = this.targetCenter_.slice();
      let resolution = this.targetResolution_;
      let rotation = this.targetRotation_;
      const series = [];
      for (; i < animationCount; ++i) {
        const options = arguments[i];
        const animation = {
          start: start2,
          complete: false,
          anchor: options.anchor,
          duration: options.duration !== void 0 ? options.duration : 1e3,
          easing: options.easing || inAndOut,
          callback
        };
        if (options.center) {
          animation.sourceCenter = center;
          animation.targetCenter = options.center.slice();
          center = animation.targetCenter;
        }
        if (options.zoom !== void 0) {
          animation.sourceResolution = resolution;
          animation.targetResolution = this.getResolutionForZoom(options.zoom);
          resolution = animation.targetResolution;
        } else if (options.resolution) {
          animation.sourceResolution = resolution;
          animation.targetResolution = options.resolution;
          resolution = animation.targetResolution;
        }
        if (options.rotation !== void 0) {
          animation.sourceRotation = rotation;
          const delta = modulo(options.rotation - rotation + Math.PI, 2 * Math.PI) - Math.PI;
          animation.targetRotation = rotation + delta;
          rotation = animation.targetRotation;
        }
        if (isNoopAnimation(animation)) {
          animation.complete = true;
        } else {
          start2 += animation.duration;
        }
        series.push(animation);
      }
      this.animations_.push(series);
      this.setHint(ViewHint.ANIMATING, 1);
      this.updateAnimations_();
    }
    getAnimating() {
      return this.hints_[ViewHint.ANIMATING] > 0;
    }
    getInteracting() {
      return this.hints_[ViewHint.INTERACTING] > 0;
    }
    cancelAnimations() {
      this.setHint(ViewHint.ANIMATING, -this.hints_[ViewHint.ANIMATING]);
      let anchor;
      for (let i = 0, ii = this.animations_.length; i < ii; ++i) {
        const series = this.animations_[i];
        if (series[0].callback) {
          animationCallback(series[0].callback, false);
        }
        if (!anchor) {
          for (let j = 0, jj = series.length; j < jj; ++j) {
            const animation = series[j];
            if (!animation.complete) {
              anchor = animation.anchor;
              break;
            }
          }
        }
      }
      this.animations_.length = 0;
      this.cancelAnchor_ = anchor;
      this.nextCenter_ = null;
      this.nextResolution_ = NaN;
      this.nextRotation_ = NaN;
    }
    updateAnimations_() {
      if (this.updateAnimationKey_ !== void 0) {
        cancelAnimationFrame(this.updateAnimationKey_);
        this.updateAnimationKey_ = void 0;
      }
      if (!this.getAnimating()) {
        return;
      }
      const now2 = Date.now();
      let more = false;
      for (let i = this.animations_.length - 1; i >= 0; --i) {
        const series = this.animations_[i];
        let seriesComplete = true;
        for (let j = 0, jj = series.length; j < jj; ++j) {
          const animation = series[j];
          if (animation.complete) {
            continue;
          }
          const elapsed = now2 - animation.start;
          let fraction = animation.duration > 0 ? elapsed / animation.duration : 1;
          if (fraction >= 1) {
            animation.complete = true;
            fraction = 1;
          } else {
            seriesComplete = false;
          }
          const progress = animation.easing(fraction);
          if (animation.sourceCenter) {
            const x0 = animation.sourceCenter[0];
            const y0 = animation.sourceCenter[1];
            const x1 = animation.targetCenter[0];
            const y1 = animation.targetCenter[1];
            this.nextCenter_ = animation.targetCenter;
            const x = x0 + progress * (x1 - x0);
            const y2 = y0 + progress * (y1 - y0);
            this.targetCenter_ = [x, y2];
          }
          if (animation.sourceResolution && animation.targetResolution) {
            const resolution = progress === 1 ? animation.targetResolution : animation.sourceResolution + progress * (animation.targetResolution - animation.sourceResolution);
            if (animation.anchor) {
              const size = this.getViewportSize_(this.getRotation());
              const constrainedResolution = this.constraints_.resolution(
                resolution,
                0,
                size,
                true
              );
              this.targetCenter_ = this.calculateCenterZoom(
                constrainedResolution,
                animation.anchor
              );
            }
            this.nextResolution_ = animation.targetResolution;
            this.targetResolution_ = resolution;
            this.applyTargetState_(true);
          }
          if (animation.sourceRotation !== void 0 && animation.targetRotation !== void 0) {
            const rotation = progress === 1 ? modulo(animation.targetRotation + Math.PI, 2 * Math.PI) - Math.PI : animation.sourceRotation + progress * (animation.targetRotation - animation.sourceRotation);
            if (animation.anchor) {
              const constrainedRotation = this.constraints_.rotation(
                rotation,
                true
              );
              this.targetCenter_ = this.calculateCenterRotate(
                constrainedRotation,
                animation.anchor
              );
            }
            this.nextRotation_ = animation.targetRotation;
            this.targetRotation_ = rotation;
          }
          this.applyTargetState_(true);
          more = true;
          if (!animation.complete) {
            break;
          }
        }
        if (seriesComplete) {
          this.animations_[i] = null;
          this.setHint(ViewHint.ANIMATING, -1);
          this.nextCenter_ = null;
          this.nextResolution_ = NaN;
          this.nextRotation_ = NaN;
          const callback = series[0].callback;
          if (callback) {
            animationCallback(callback, true);
          }
        }
      }
      this.animations_ = this.animations_.filter(Boolean);
      if (more && this.updateAnimationKey_ === void 0) {
        this.updateAnimationKey_ = requestAnimationFrame(
          this.updateAnimations_.bind(this)
        );
      }
    }
    calculateCenterRotate(rotation, anchor) {
      let center;
      const currentCenter = this.getCenterInternal();
      if (currentCenter !== void 0) {
        center = [currentCenter[0] - anchor[0], currentCenter[1] - anchor[1]];
        rotate$1(center, rotation - this.getRotation());
        add$1(center, anchor);
      }
      return center;
    }
    calculateCenterZoom(resolution, anchor) {
      let center;
      const currentCenter = this.getCenterInternal();
      const currentResolution = this.getResolution();
      if (currentCenter !== void 0 && currentResolution !== void 0) {
        const x = anchor[0] - resolution * (anchor[0] - currentCenter[0]) / currentResolution;
        const y2 = anchor[1] - resolution * (anchor[1] - currentCenter[1]) / currentResolution;
        center = [x, y2];
      }
      return center;
    }
    getViewportSize_(rotation) {
      const size = this.viewportSize_;
      if (rotation) {
        const w = size[0];
        const h = size[1];
        return [
          Math.abs(w * Math.cos(rotation)) + Math.abs(h * Math.sin(rotation)),
          Math.abs(w * Math.sin(rotation)) + Math.abs(h * Math.cos(rotation))
        ];
      }
      return size;
    }
    setViewportSize(size) {
      this.viewportSize_ = Array.isArray(size) ? size.slice() : [100, 100];
      if (!this.getAnimating()) {
        this.resolveConstraints(0);
      }
    }
    getCenter() {
      const center = this.getCenterInternal();
      if (!center) {
        return center;
      }
      return toUserCoordinate(center, this.getProjection());
    }
    getCenterInternal() {
      return this.get(ViewProperty.CENTER);
    }
    getConstraints() {
      return this.constraints_;
    }
    getConstrainResolution() {
      return this.get("constrainResolution");
    }
    getHints(hints) {
      if (hints !== void 0) {
        hints[0] = this.hints_[0];
        hints[1] = this.hints_[1];
        return hints;
      }
      return this.hints_.slice();
    }
    calculateExtent(size) {
      const extent = this.calculateExtentInternal(size);
      return toUserExtent(extent, this.getProjection());
    }
    calculateExtentInternal(size) {
      size = size || this.getViewportSizeMinusPadding_();
      const center = this.getCenterInternal();
      assert(center, 1);
      const resolution = this.getResolution();
      assert(resolution !== void 0, 2);
      const rotation = this.getRotation();
      assert(rotation !== void 0, 3);
      return getForViewAndSize(center, resolution, rotation, size);
    }
    getMaxResolution() {
      return this.maxResolution_;
    }
    getMinResolution() {
      return this.minResolution_;
    }
    getMaxZoom() {
      return this.getZoomForResolution(this.minResolution_);
    }
    setMaxZoom(zoom) {
      this.applyOptions_(this.getUpdatedOptions_({ maxZoom: zoom }));
    }
    getMinZoom() {
      return this.getZoomForResolution(this.maxResolution_);
    }
    setMinZoom(zoom) {
      this.applyOptions_(this.getUpdatedOptions_({ minZoom: zoom }));
    }
    setConstrainResolution(enabled) {
      this.applyOptions_(this.getUpdatedOptions_({ constrainResolution: enabled }));
    }
    getProjection() {
      return this.projection_;
    }
    getResolution() {
      return this.get(ViewProperty.RESOLUTION);
    }
    getResolutions() {
      return this.resolutions_;
    }
    getResolutionForExtent(extent, size) {
      return this.getResolutionForExtentInternal(
        fromUserExtent(extent, this.getProjection()),
        size
      );
    }
    getResolutionForExtentInternal(extent, size) {
      size = size || this.getViewportSizeMinusPadding_();
      const xResolution = getWidth(extent) / size[0];
      const yResolution = getHeight(extent) / size[1];
      return Math.max(xResolution, yResolution);
    }
    getResolutionForValueFunction(power) {
      power = power || 2;
      const maxResolution = this.getConstrainedResolution(this.maxResolution_);
      const minResolution = this.minResolution_;
      const max = Math.log(maxResolution / minResolution) / Math.log(power);
      return function(value) {
        const resolution = maxResolution / Math.pow(power, value * max);
        return resolution;
      };
    }
    getRotation() {
      return this.get(ViewProperty.ROTATION);
    }
    getValueForResolutionFunction(power) {
      const logPower = Math.log(power || 2);
      const maxResolution = this.getConstrainedResolution(this.maxResolution_);
      const minResolution = this.minResolution_;
      const max = Math.log(maxResolution / minResolution) / logPower;
      return function(resolution) {
        const value = Math.log(maxResolution / resolution) / logPower / max;
        return value;
      };
    }
    getViewportSizeMinusPadding_(rotation) {
      let size = this.getViewportSize_(rotation);
      const padding = this.padding_;
      if (padding) {
        size = [
          size[0] - padding[1] - padding[3],
          size[1] - padding[0] - padding[2]
        ];
      }
      return size;
    }
    getState() {
      const projection = this.getProjection();
      const resolution = this.getResolution();
      const rotation = this.getRotation();
      let center = this.getCenterInternal();
      const padding = this.padding_;
      if (padding) {
        const reducedSize = this.getViewportSizeMinusPadding_();
        center = calculateCenterOn(
          center,
          this.getViewportSize_(),
          [reducedSize[0] / 2 + padding[3], reducedSize[1] / 2 + padding[0]],
          resolution,
          rotation
        );
      }
      return {
        center: center.slice(0),
        projection: projection !== void 0 ? projection : null,
        resolution,
        nextCenter: this.nextCenter_,
        nextResolution: this.nextResolution_,
        nextRotation: this.nextRotation_,
        rotation,
        zoom: this.getZoom()
      };
    }
    getViewStateAndExtent() {
      return {
        viewState: this.getState(),
        extent: this.calculateExtent()
      };
    }
    getZoom() {
      let zoom;
      const resolution = this.getResolution();
      if (resolution !== void 0) {
        zoom = this.getZoomForResolution(resolution);
      }
      return zoom;
    }
    getZoomForResolution(resolution) {
      let offset = this.minZoom_ || 0;
      let max, zoomFactor;
      if (this.resolutions_) {
        const nearest = linearFindNearest(this.resolutions_, resolution, 1);
        offset = nearest;
        max = this.resolutions_[nearest];
        if (nearest == this.resolutions_.length - 1) {
          zoomFactor = 2;
        } else {
          zoomFactor = max / this.resolutions_[nearest + 1];
        }
      } else {
        max = this.maxResolution_;
        zoomFactor = this.zoomFactor_;
      }
      return offset + Math.log(max / resolution) / Math.log(zoomFactor);
    }
    getResolutionForZoom(zoom) {
      if (this.resolutions_) {
        if (this.resolutions_.length <= 1) {
          return 0;
        }
        const baseLevel = clamp(
          Math.floor(zoom),
          0,
          this.resolutions_.length - 2
        );
        const zoomFactor = this.resolutions_[baseLevel] / this.resolutions_[baseLevel + 1];
        return this.resolutions_[baseLevel] / Math.pow(zoomFactor, clamp(zoom - baseLevel, 0, 1));
      }
      return this.maxResolution_ / Math.pow(this.zoomFactor_, zoom - this.minZoom_);
    }
    fit(geometryOrExtent, options) {
      let geometry;
      assert(
        Array.isArray(geometryOrExtent) || typeof geometryOrExtent.getSimplifiedGeometry === "function",
        24
      );
      if (Array.isArray(geometryOrExtent)) {
        assert(!isEmpty(geometryOrExtent), 25);
        const extent = fromUserExtent(geometryOrExtent, this.getProjection());
        geometry = fromExtent(extent);
      } else if (geometryOrExtent.getType() === "Circle") {
        const extent = fromUserExtent(
          geometryOrExtent.getExtent(),
          this.getProjection()
        );
        geometry = fromExtent(extent);
        geometry.rotate(this.getRotation(), getCenter(extent));
      } else {
        {
          geometry = geometryOrExtent;
        }
      }
      this.fitInternal(geometry, options);
    }
    rotatedExtentForGeometry(geometry) {
      const rotation = this.getRotation();
      const cosAngle = Math.cos(rotation);
      const sinAngle = Math.sin(-rotation);
      const coords = geometry.getFlatCoordinates();
      const stride = geometry.getStride();
      let minRotX = Infinity;
      let minRotY = Infinity;
      let maxRotX = -Infinity;
      let maxRotY = -Infinity;
      for (let i = 0, ii = coords.length; i < ii; i += stride) {
        const rotX = coords[i] * cosAngle - coords[i + 1] * sinAngle;
        const rotY = coords[i] * sinAngle + coords[i + 1] * cosAngle;
        minRotX = Math.min(minRotX, rotX);
        minRotY = Math.min(minRotY, rotY);
        maxRotX = Math.max(maxRotX, rotX);
        maxRotY = Math.max(maxRotY, rotY);
      }
      return [minRotX, minRotY, maxRotX, maxRotY];
    }
    fitInternal(geometry, options) {
      options = options || {};
      let size = options.size;
      if (!size) {
        size = this.getViewportSizeMinusPadding_();
      }
      const padding = options.padding !== void 0 ? options.padding : [0, 0, 0, 0];
      const nearest = options.nearest !== void 0 ? options.nearest : false;
      let minResolution;
      if (options.minResolution !== void 0) {
        minResolution = options.minResolution;
      } else if (options.maxZoom !== void 0) {
        minResolution = this.getResolutionForZoom(options.maxZoom);
      } else {
        minResolution = 0;
      }
      const rotatedExtent = this.rotatedExtentForGeometry(geometry);
      let resolution = this.getResolutionForExtentInternal(rotatedExtent, [
        size[0] - padding[1] - padding[3],
        size[1] - padding[0] - padding[2]
      ]);
      resolution = isNaN(resolution) ? minResolution : Math.max(resolution, minResolution);
      resolution = this.getConstrainedResolution(resolution, nearest ? 0 : 1);
      const rotation = this.getRotation();
      const sinAngle = Math.sin(rotation);
      const cosAngle = Math.cos(rotation);
      const centerRot = getCenter(rotatedExtent);
      centerRot[0] += (padding[1] - padding[3]) / 2 * resolution;
      centerRot[1] += (padding[0] - padding[2]) / 2 * resolution;
      const centerX = centerRot[0] * cosAngle - centerRot[1] * sinAngle;
      const centerY = centerRot[1] * cosAngle + centerRot[0] * sinAngle;
      const center = this.getConstrainedCenter([centerX, centerY], resolution);
      const callback = options.callback ? options.callback : VOID;
      if (options.duration !== void 0) {
        this.animateInternal(
          {
            resolution,
            center,
            duration: options.duration,
            easing: options.easing
          },
          callback
        );
      } else {
        this.targetResolution_ = resolution;
        this.targetCenter_ = center;
        this.applyTargetState_(false, true);
        animationCallback(callback, true);
      }
    }
    centerOn(coordinate, size, position) {
      this.centerOnInternal(
        fromUserCoordinate(coordinate, this.getProjection()),
        size,
        position
      );
    }
    centerOnInternal(coordinate, size, position) {
      this.setCenterInternal(
        calculateCenterOn(
          coordinate,
          size,
          position,
          this.getResolution(),
          this.getRotation()
        )
      );
    }
    calculateCenterShift(center, resolution, rotation, size) {
      let centerShift;
      const padding = this.padding_;
      if (padding && center) {
        const reducedSize = this.getViewportSizeMinusPadding_(-rotation);
        const shiftedCenter = calculateCenterOn(
          center,
          size,
          [reducedSize[0] / 2 + padding[3], reducedSize[1] / 2 + padding[0]],
          resolution,
          rotation
        );
        centerShift = [
          center[0] - shiftedCenter[0],
          center[1] - shiftedCenter[1]
        ];
      }
      return centerShift;
    }
    isDef() {
      return !!this.getCenterInternal() && this.getResolution() !== void 0;
    }
    adjustCenter(deltaCoordinates) {
      const center = toUserCoordinate(this.targetCenter_, this.getProjection());
      this.setCenter([
        center[0] + deltaCoordinates[0],
        center[1] + deltaCoordinates[1]
      ]);
    }
    adjustCenterInternal(deltaCoordinates) {
      const center = this.targetCenter_;
      this.setCenterInternal([
        center[0] + deltaCoordinates[0],
        center[1] + deltaCoordinates[1]
      ]);
    }
    adjustResolution(ratio, anchor) {
      anchor = anchor && fromUserCoordinate(anchor, this.getProjection());
      this.adjustResolutionInternal(ratio, anchor);
    }
    adjustResolutionInternal(ratio, anchor) {
      const isMoving = this.getAnimating() || this.getInteracting();
      const size = this.getViewportSize_(this.getRotation());
      const newResolution = this.constraints_.resolution(
        this.targetResolution_ * ratio,
        0,
        size,
        isMoving
      );
      if (anchor) {
        this.targetCenter_ = this.calculateCenterZoom(newResolution, anchor);
      }
      this.targetResolution_ *= ratio;
      this.applyTargetState_();
    }
    adjustZoom(delta, anchor) {
      this.adjustResolution(Math.pow(this.zoomFactor_, -delta), anchor);
    }
    adjustRotation(delta, anchor) {
      if (anchor) {
        anchor = fromUserCoordinate(anchor, this.getProjection());
      }
      this.adjustRotationInternal(delta, anchor);
    }
    adjustRotationInternal(delta, anchor) {
      const isMoving = this.getAnimating() || this.getInteracting();
      const newRotation = this.constraints_.rotation(
        this.targetRotation_ + delta,
        isMoving
      );
      if (anchor) {
        this.targetCenter_ = this.calculateCenterRotate(newRotation, anchor);
      }
      this.targetRotation_ += delta;
      this.applyTargetState_();
    }
    setCenter(center) {
      this.setCenterInternal(
        center ? fromUserCoordinate(center, this.getProjection()) : center
      );
    }
    setCenterInternal(center) {
      this.targetCenter_ = center;
      this.applyTargetState_();
    }
    setHint(hint, delta) {
      this.hints_[hint] += delta;
      this.changed();
      return this.hints_[hint];
    }
    setResolution(resolution) {
      this.targetResolution_ = resolution;
      this.applyTargetState_();
    }
    setRotation(rotation) {
      this.targetRotation_ = rotation;
      this.applyTargetState_();
    }
    setZoom(zoom) {
      this.setResolution(this.getResolutionForZoom(zoom));
    }
    applyTargetState_(doNotCancelAnims, forceMoving) {
      const isMoving = this.getAnimating() || this.getInteracting() || forceMoving;
      const newRotation = this.constraints_.rotation(
        this.targetRotation_,
        isMoving
      );
      const size = this.getViewportSize_(newRotation);
      const newResolution = this.constraints_.resolution(
        this.targetResolution_,
        0,
        size,
        isMoving
      );
      const newCenter = this.constraints_.center(
        this.targetCenter_,
        newResolution,
        size,
        isMoving,
        this.calculateCenterShift(
          this.targetCenter_,
          newResolution,
          newRotation,
          size
        )
      );
      if (this.get(ViewProperty.ROTATION) !== newRotation) {
        this.set(ViewProperty.ROTATION, newRotation);
      }
      if (this.get(ViewProperty.RESOLUTION) !== newResolution) {
        this.set(ViewProperty.RESOLUTION, newResolution);
        this.set("zoom", this.getZoom(), true);
      }
      if (!newCenter || !this.get(ViewProperty.CENTER) || !equals$1(this.get(ViewProperty.CENTER), newCenter)) {
        this.set(ViewProperty.CENTER, newCenter);
      }
      if (this.getAnimating() && !doNotCancelAnims) {
        this.cancelAnimations();
      }
      this.cancelAnchor_ = void 0;
    }
    resolveConstraints(duration, resolutionDirection, anchor) {
      duration = duration !== void 0 ? duration : 200;
      const direction = resolutionDirection || 0;
      const newRotation = this.constraints_.rotation(this.targetRotation_);
      const size = this.getViewportSize_(newRotation);
      const newResolution = this.constraints_.resolution(
        this.targetResolution_,
        direction,
        size
      );
      const newCenter = this.constraints_.center(
        this.targetCenter_,
        newResolution,
        size,
        false,
        this.calculateCenterShift(
          this.targetCenter_,
          newResolution,
          newRotation,
          size
        )
      );
      if (duration === 0 && !this.cancelAnchor_) {
        this.targetResolution_ = newResolution;
        this.targetRotation_ = newRotation;
        this.targetCenter_ = newCenter;
        this.applyTargetState_();
        return;
      }
      anchor = anchor || (duration === 0 ? this.cancelAnchor_ : void 0);
      this.cancelAnchor_ = void 0;
      if (this.getResolution() !== newResolution || this.getRotation() !== newRotation || !this.getCenterInternal() || !equals$1(this.getCenterInternal(), newCenter)) {
        if (this.getAnimating()) {
          this.cancelAnimations();
        }
        this.animateInternal({
          rotation: newRotation,
          center: newCenter,
          resolution: newResolution,
          duration,
          easing: easeOut,
          anchor
        });
      }
    }
    beginInteraction() {
      this.resolveConstraints(0);
      this.setHint(ViewHint.INTERACTING, 1);
    }
    endInteraction(duration, resolutionDirection, anchor) {
      anchor = anchor && fromUserCoordinate(anchor, this.getProjection());
      this.endInteractionInternal(duration, resolutionDirection, anchor);
    }
    endInteractionInternal(duration, resolutionDirection, anchor) {
      if (!this.getInteracting()) {
        return;
      }
      this.setHint(ViewHint.INTERACTING, -1);
      this.resolveConstraints(duration, resolutionDirection, anchor);
    }
    getConstrainedCenter(targetCenter, targetResolution) {
      const size = this.getViewportSize_(this.getRotation());
      return this.constraints_.center(
        targetCenter,
        targetResolution || this.getResolution(),
        size
      );
    }
    getConstrainedZoom(targetZoom, direction) {
      const targetRes = this.getResolutionForZoom(targetZoom);
      return this.getZoomForResolution(
        this.getConstrainedResolution(targetRes, direction)
      );
    }
    getConstrainedResolution(targetResolution, direction) {
      direction = direction || 0;
      const size = this.getViewportSize_(this.getRotation());
      return this.constraints_.resolution(targetResolution, direction, size);
    }
  }
  function animationCallback(callback, returnValue) {
    setTimeout(function() {
      callback(returnValue);
    }, 0);
  }
  function createCenterConstraint(options) {
    if (options.extent !== void 0) {
      const smooth = options.smoothExtentConstraint !== void 0 ? options.smoothExtentConstraint : true;
      return createExtent(options.extent, options.constrainOnlyCenter, smooth);
    }
    const projection = createProjection(options.projection, "EPSG:3857");
    if (options.multiWorld !== true && projection.isGlobal()) {
      const extent = projection.getExtent().slice();
      extent[0] = -Infinity;
      extent[2] = Infinity;
      return createExtent(extent, false, false);
    }
    return none$1;
  }
  function createResolutionConstraint(options) {
    let resolutionConstraint;
    let maxResolution;
    let minResolution;
    const defaultMaxZoom = 28;
    const defaultZoomFactor = 2;
    let minZoom = options.minZoom !== void 0 ? options.minZoom : DEFAULT_MIN_ZOOM;
    let maxZoom = options.maxZoom !== void 0 ? options.maxZoom : defaultMaxZoom;
    const zoomFactor = options.zoomFactor !== void 0 ? options.zoomFactor : defaultZoomFactor;
    const multiWorld = options.multiWorld !== void 0 ? options.multiWorld : false;
    const smooth = options.smoothResolutionConstraint !== void 0 ? options.smoothResolutionConstraint : true;
    const showFullExtent = options.showFullExtent !== void 0 ? options.showFullExtent : false;
    const projection = createProjection(options.projection, "EPSG:3857");
    const projExtent = projection.getExtent();
    let constrainOnlyCenter = options.constrainOnlyCenter;
    let extent = options.extent;
    if (!multiWorld && !extent && projection.isGlobal()) {
      constrainOnlyCenter = false;
      extent = projExtent;
    }
    if (options.resolutions !== void 0) {
      const resolutions = options.resolutions;
      maxResolution = resolutions[minZoom];
      minResolution = resolutions[maxZoom] !== void 0 ? resolutions[maxZoom] : resolutions[resolutions.length - 1];
      if (options.constrainResolution) {
        resolutionConstraint = createSnapToResolutions(
          resolutions,
          smooth,
          !constrainOnlyCenter && extent,
          showFullExtent
        );
      } else {
        resolutionConstraint = createMinMaxResolution(
          maxResolution,
          minResolution,
          smooth,
          !constrainOnlyCenter && extent,
          showFullExtent
        );
      }
    } else {
      const size = !projExtent ? 360 * METERS_PER_UNIT$1.degrees / projection.getMetersPerUnit() : Math.max(getWidth(projExtent), getHeight(projExtent));
      const defaultMaxResolution = size / DEFAULT_TILE_SIZE / Math.pow(defaultZoomFactor, DEFAULT_MIN_ZOOM);
      const defaultMinResolution = defaultMaxResolution / Math.pow(defaultZoomFactor, defaultMaxZoom - DEFAULT_MIN_ZOOM);
      maxResolution = options.maxResolution;
      if (maxResolution !== void 0) {
        minZoom = 0;
      } else {
        maxResolution = defaultMaxResolution / Math.pow(zoomFactor, minZoom);
      }
      minResolution = options.minResolution;
      if (minResolution === void 0) {
        if (options.maxZoom !== void 0) {
          if (options.maxResolution !== void 0) {
            minResolution = maxResolution / Math.pow(zoomFactor, maxZoom);
          } else {
            minResolution = defaultMaxResolution / Math.pow(zoomFactor, maxZoom);
          }
        } else {
          minResolution = defaultMinResolution;
        }
      }
      maxZoom = minZoom + Math.floor(
        Math.log(maxResolution / minResolution) / Math.log(zoomFactor)
      );
      minResolution = maxResolution / Math.pow(zoomFactor, maxZoom - minZoom);
      if (options.constrainResolution) {
        resolutionConstraint = createSnapToPower(
          zoomFactor,
          maxResolution,
          minResolution,
          smooth,
          !constrainOnlyCenter && extent,
          showFullExtent
        );
      } else {
        resolutionConstraint = createMinMaxResolution(
          maxResolution,
          minResolution,
          smooth,
          !constrainOnlyCenter && extent,
          showFullExtent
        );
      }
    }
    return {
      constraint: resolutionConstraint,
      maxResolution,
      minResolution,
      minZoom,
      zoomFactor
    };
  }
  function createRotationConstraint(options) {
    const enableRotation = options.enableRotation !== void 0 ? options.enableRotation : true;
    if (enableRotation) {
      const constrainRotation = options.constrainRotation;
      if (constrainRotation === void 0 || constrainRotation === true) {
        return createSnapToZero();
      } else if (constrainRotation === false) {
        return none;
      } else if (typeof constrainRotation === "number") {
        return createSnapToN(constrainRotation);
      }
      return none;
    }
    return disable;
  }
  function isNoopAnimation(animation) {
    if (animation.sourceCenter && animation.targetCenter) {
      if (!equals$1(animation.sourceCenter, animation.targetCenter)) {
        return false;
      }
    }
    if (animation.sourceResolution !== animation.targetResolution) {
      return false;
    }
    if (animation.sourceRotation !== animation.targetRotation) {
      return false;
    }
    return true;
  }
  function calculateCenterOn(coordinate, size, position, resolution, rotation) {
    const cosAngle = Math.cos(-rotation);
    let sinAngle = Math.sin(-rotation);
    let rotX = coordinate[0] * cosAngle - coordinate[1] * sinAngle;
    let rotY = coordinate[1] * cosAngle + coordinate[0] * sinAngle;
    rotX += (size[0] / 2 - position[0]) * resolution;
    rotY += (position[1] - size[1] / 2) * resolution;
    sinAngle = -sinAngle;
    const centerX = rotX * cosAngle - rotY * sinAngle;
    const centerY = rotY * cosAngle + rotX * sinAngle;
    return [centerX, centerY];
  }
  const OlView = View;
  class Layer extends BaseLayer$1 {
    constructor(options) {
      const baseOptions = Object.assign({}, options);
      delete baseOptions.source;
      super(baseOptions);
      this.on;
      this.once;
      this.un;
      this.mapPrecomposeKey_ = null;
      this.mapRenderKey_ = null;
      this.sourceChangeKey_ = null;
      this.renderer_ = null;
      this.sourceReady_ = false;
      this.rendered = false;
      if (options.render) {
        this.render = options.render;
      }
      if (options.map) {
        this.setMap(options.map);
      }
      this.addChangeListener(
        LayerProperty.SOURCE,
        this.handleSourcePropertyChange_
      );
      const source = options.source ? options.source : null;
      this.setSource(source);
    }
    getLayersArray(array) {
      array = array ? array : [];
      array.push(this);
      return array;
    }
    getLayerStatesArray(states) {
      states = states ? states : [];
      states.push(this.getLayerState());
      return states;
    }
    getSource() {
      return this.get(LayerProperty.SOURCE) || null;
    }
    getRenderSource() {
      return this.getSource();
    }
    getSourceState() {
      const source = this.getSource();
      return !source ? "undefined" : source.getState();
    }
    handleSourceChange_() {
      this.changed();
      if (this.sourceReady_ || this.getSource().getState() !== "ready") {
        return;
      }
      this.sourceReady_ = true;
      this.dispatchEvent("sourceready");
    }
    handleSourcePropertyChange_() {
      if (this.sourceChangeKey_) {
        unlistenByKey(this.sourceChangeKey_);
        this.sourceChangeKey_ = null;
      }
      this.sourceReady_ = false;
      const source = this.getSource();
      if (source) {
        this.sourceChangeKey_ = listen(
          source,
          EventType.CHANGE,
          this.handleSourceChange_,
          this
        );
        if (source.getState() === "ready") {
          this.sourceReady_ = true;
          setTimeout(() => {
            this.dispatchEvent("sourceready");
          }, 0);
        }
      }
      this.changed();
    }
    getFeatures(pixel) {
      if (!this.renderer_) {
        return Promise.resolve([]);
      }
      return this.renderer_.getFeatures(pixel);
    }
    getData(pixel) {
      if (!this.renderer_ || !this.rendered) {
        return null;
      }
      return this.renderer_.getData(pixel);
    }
    isVisible(view) {
      let frameState;
      if (view instanceof OlView) {
        frameState = {
          viewState: view.getState(),
          extent: view.calculateExtent()
        };
      } else {
        frameState = view;
      }
      const layerExtent = this.getExtent();
      return this.getVisible() && inView(this.getLayerState(), frameState.viewState) && (!layerExtent || intersects(layerExtent, frameState.extent));
    }
    getAttributions(view) {
      if (!this.isVisible(view)) {
        return [];
      }
      let getAttributions;
      const source = this.getSource();
      if (source) {
        getAttributions = source.getAttributions();
      }
      if (!getAttributions) {
        return [];
      }
      const frameState = view instanceof OlView ? view.getViewStateAndExtent() : view;
      let attributions = getAttributions(frameState);
      if (!Array.isArray(attributions)) {
        attributions = [attributions];
      }
      return attributions;
    }
    render(frameState, target) {
      const layerRenderer = this.getRenderer();
      if (layerRenderer.prepareFrame(frameState)) {
        this.rendered = true;
        return layerRenderer.renderFrame(frameState, target);
      }
    }
    unrender() {
      this.rendered = false;
    }
    setMapInternal(map2) {
      if (!map2) {
        this.unrender();
      }
      this.set(LayerProperty.MAP, map2);
    }
    getMapInternal() {
      return this.get(LayerProperty.MAP);
    }
    setMap(map2) {
      if (this.mapPrecomposeKey_) {
        unlistenByKey(this.mapPrecomposeKey_);
        this.mapPrecomposeKey_ = null;
      }
      if (!map2) {
        this.changed();
      }
      if (this.mapRenderKey_) {
        unlistenByKey(this.mapRenderKey_);
        this.mapRenderKey_ = null;
      }
      if (map2) {
        this.mapPrecomposeKey_ = listen(
          map2,
          RenderEventType.PRECOMPOSE,
          function(evt) {
            const renderEvent = evt;
            const layerStatesArray = renderEvent.frameState.layerStatesArray;
            const layerState = this.getLayerState(false);
            assert(
              !layerStatesArray.some(function(arrayLayerState) {
                return arrayLayerState.layer === layerState.layer;
              }),
              67
            );
            layerStatesArray.push(layerState);
          },
          this
        );
        this.mapRenderKey_ = listen(this, EventType.CHANGE, map2.render, map2);
        this.changed();
      }
    }
    setSource(source) {
      this.set(LayerProperty.SOURCE, source);
    }
    getRenderer() {
      if (!this.renderer_) {
        this.renderer_ = this.createRenderer();
      }
      return this.renderer_;
    }
    hasRenderer() {
      return !!this.renderer_;
    }
    createRenderer() {
      return null;
    }
    disposeInternal() {
      if (this.renderer_) {
        this.renderer_.dispose();
        delete this.renderer_;
      }
      this.setSource(null);
      super.disposeInternal();
    }
  }
  function inView(layerState, viewState) {
    if (!layerState.visible) {
      return false;
    }
    const resolution = viewState.resolution;
    if (resolution < layerState.minResolution || resolution >= layerState.maxResolution) {
      return false;
    }
    const zoom = viewState.zoom;
    return zoom > layerState.minZoom && zoom <= layerState.maxZoom;
  }
  const Layer$1 = Layer;
  class BaseImageLayer extends Layer$1 {
    constructor(options) {
      options = options ? options : {};
      super(options);
    }
  }
  const BaseImageLayer$1 = BaseImageLayer;
  const ImageState = {
    IDLE: 0,
    LOADING: 1,
    LOADED: 2,
    ERROR: 3,
    EMPTY: 4
  };
  class LayerRenderer extends Observable$1 {
    constructor(layer) {
      super();
      this.ready = true;
      this.boundHandleImageChange_ = this.handleImageChange_.bind(this);
      this.layer_ = layer;
      this.declutterExecutorGroup = null;
    }
    getFeatures(pixel) {
      return abstract();
    }
    getData(pixel) {
      return null;
    }
    prepareFrame(frameState) {
      return abstract();
    }
    renderFrame(frameState, target) {
      return abstract();
    }
    loadedTileCallback(tiles, zoom, tile) {
      if (!tiles[zoom]) {
        tiles[zoom] = {};
      }
      tiles[zoom][tile.tileCoord.toString()] = tile;
      return void 0;
    }
    createLoadedTileFinder(source, projection, tiles) {
      return (zoom, tileRange) => {
        const callback = this.loadedTileCallback.bind(this, tiles, zoom);
        return source.forEachLoadedTile(projection, zoom, tileRange, callback);
      };
    }
    forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, callback, matches2) {
      return void 0;
    }
    getLayer() {
      return this.layer_;
    }
    handleFontsChanged() {
    }
    handleImageChange_(event) {
      const image = event.target;
      if (image.getState() === ImageState.LOADED) {
        this.renderIfReadyAndVisible();
      }
    }
    loadImage(image) {
      let imageState = image.getState();
      if (imageState != ImageState.LOADED && imageState != ImageState.ERROR) {
        image.addEventListener(EventType.CHANGE, this.boundHandleImageChange_);
      }
      if (imageState == ImageState.IDLE) {
        image.load();
        imageState = image.getState();
      }
      return imageState == ImageState.LOADED;
    }
    renderIfReadyAndVisible() {
      const layer = this.getLayer();
      if (layer && layer.getVisible() && layer.getSourceState() === "ready") {
        layer.changed();
      }
    }
    disposeInternal() {
      delete this.layer_;
      super.disposeInternal();
    }
  }
  const LayerRenderer$1 = LayerRenderer;
  class RenderEvent extends Event {
    constructor(type, inversePixelTransform, frameState, context) {
      super(type);
      this.inversePixelTransform = inversePixelTransform;
      this.frameState = frameState;
      this.context = context;
    }
  }
  const RenderEvent$1 = RenderEvent;
  const HEX_COLOR_RE_ = /^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i;
  const NAMED_COLOR_RE_ = /^([a-z]*)$|^hsla?\(.*\)$/i;
  function asString(color) {
    if (typeof color === "string") {
      return color;
    }
    return toString(color);
  }
  function fromNamed(color) {
    const el = document.createElement("div");
    el.style.color = color;
    if (el.style.color !== "") {
      document.body.appendChild(el);
      const rgb = getComputedStyle(el).color;
      document.body.removeChild(el);
      return rgb;
    }
    return "";
  }
  const fromString = function() {
    const MAX_CACHE_SIZE = 1024;
    const cache2 = {};
    let cacheSize = 0;
    return function(s) {
      let color;
      if (cache2.hasOwnProperty(s)) {
        color = cache2[s];
      } else {
        if (cacheSize >= MAX_CACHE_SIZE) {
          let i = 0;
          for (const key in cache2) {
            if ((i++ & 3) === 0) {
              delete cache2[key];
              --cacheSize;
            }
          }
        }
        color = fromStringInternal_(s);
        cache2[s] = color;
        ++cacheSize;
      }
      return color;
    };
  }();
  function asArray(color) {
    if (Array.isArray(color)) {
      return color;
    }
    return fromString(color);
  }
  function fromStringInternal_(s) {
    let r, g, b, a, color;
    if (NAMED_COLOR_RE_.exec(s)) {
      s = fromNamed(s);
    }
    if (HEX_COLOR_RE_.exec(s)) {
      const n = s.length - 1;
      let d;
      if (n <= 4) {
        d = 1;
      } else {
        d = 2;
      }
      const hasAlpha = n === 4 || n === 8;
      r = parseInt(s.substr(1 + 0 * d, d), 16);
      g = parseInt(s.substr(1 + 1 * d, d), 16);
      b = parseInt(s.substr(1 + 2 * d, d), 16);
      if (hasAlpha) {
        a = parseInt(s.substr(1 + 3 * d, d), 16);
      } else {
        a = 255;
      }
      if (d == 1) {
        r = (r << 4) + r;
        g = (g << 4) + g;
        b = (b << 4) + b;
        if (hasAlpha) {
          a = (a << 4) + a;
        }
      }
      color = [r, g, b, a / 255];
    } else if (s.startsWith("rgba(")) {
      color = s.slice(5, -1).split(",").map(Number);
      normalize(color);
    } else if (s.startsWith("rgb(")) {
      color = s.slice(4, -1).split(",").map(Number);
      color.push(1);
      normalize(color);
    } else {
      assert(false, 14);
    }
    return color;
  }
  function normalize(color) {
    color[0] = clamp(color[0] + 0.5 | 0, 0, 255);
    color[1] = clamp(color[1] + 0.5 | 0, 0, 255);
    color[2] = clamp(color[2] + 0.5 | 0, 0, 255);
    color[3] = clamp(color[3], 0, 1);
    return color;
  }
  function toString(color) {
    let r = color[0];
    if (r != (r | 0)) {
      r = r + 0.5 | 0;
    }
    let g = color[1];
    if (g != (g | 0)) {
      g = g + 0.5 | 0;
    }
    let b = color[2];
    if (b != (b | 0)) {
      b = b + 0.5 | 0;
    }
    const a = color[3] === void 0 ? 1 : Math.round(color[3] * 100) / 100;
    return "rgba(" + r + "," + g + "," + b + "," + a + ")";
  }
  function createCanvasContext2D(width, height, canvasPool2, settings) {
    let canvas;
    if (canvasPool2 && canvasPool2.length) {
      canvas = canvasPool2.shift();
    } else if (WORKER_OFFSCREEN_CANVAS) {
      canvas = new OffscreenCanvas(width || 300, height || 300);
    } else {
      canvas = document.createElement("canvas");
    }
    if (width) {
      canvas.width = width;
    }
    if (height) {
      canvas.height = height;
    }
    return canvas.getContext("2d", settings);
  }
  function releaseCanvas(context) {
    const canvas = context.canvas;
    canvas.width = 1;
    canvas.height = 1;
    context.clearRect(0, 0, 1, 1);
  }
  function replaceNode(newNode, oldNode) {
    const parent = oldNode.parentNode;
    if (parent) {
      parent.replaceChild(newNode, oldNode);
    }
  }
  function removeNode(node) {
    return node && node.parentNode ? node.parentNode.removeChild(node) : null;
  }
  function removeChildren(node) {
    while (node.lastChild) {
      node.removeChild(node.lastChild);
    }
  }
  function replaceChildren(node, children) {
    const oldChildren = node.childNodes;
    for (let i = 0; true; ++i) {
      const oldChild = oldChildren[i];
      const newChild = children[i];
      if (!oldChild && !newChild) {
        break;
      }
      if (oldChild === newChild) {
        continue;
      }
      if (!oldChild) {
        node.appendChild(newChild);
        continue;
      }
      if (!newChild) {
        node.removeChild(oldChild);
        --i;
        continue;
      }
      node.insertBefore(newChild, oldChild);
    }
  }
  let pixelContext = null;
  function createPixelContext() {
    pixelContext = createCanvasContext2D(1, 1, void 0, {
      willReadFrequently: true
    });
  }
  class CanvasLayerRenderer extends LayerRenderer$1 {
    constructor(layer) {
      super(layer);
      this.container = null;
      this.renderedResolution;
      this.tempTransform = create();
      this.pixelTransform = create();
      this.inversePixelTransform = create();
      this.context = null;
      this.containerReused = false;
      this.pixelContext_ = null;
      this.frameState = null;
    }
    getImageData(image, col, row) {
      if (!pixelContext) {
        createPixelContext();
      }
      pixelContext.clearRect(0, 0, 1, 1);
      let data;
      try {
        pixelContext.drawImage(image, col, row, 1, 1, 0, 0, 1, 1);
        data = pixelContext.getImageData(0, 0, 1, 1).data;
      } catch (err) {
        pixelContext = null;
        return null;
      }
      return data;
    }
    getBackground(frameState) {
      const layer = this.getLayer();
      let background = layer.getBackground();
      if (typeof background === "function") {
        background = background(frameState.viewState.resolution);
      }
      return background || void 0;
    }
    useContainer(target, transform2, backgroundColor) {
      const layerClassName = this.getLayer().getClassName();
      let container, context;
      if (target && target.className === layerClassName && (!backgroundColor || target && target.style.backgroundColor && equals(
        asArray(target.style.backgroundColor),
        asArray(backgroundColor)
      ))) {
        const canvas = target.firstElementChild;
        if (canvas instanceof HTMLCanvasElement) {
          context = canvas.getContext("2d");
        }
      }
      if (context && context.canvas.style.transform === transform2) {
        this.container = target;
        this.context = context;
        this.containerReused = true;
      } else if (this.containerReused) {
        this.container = null;
        this.context = null;
        this.containerReused = false;
      }
      if (!this.container) {
        container = document.createElement("div");
        container.className = layerClassName;
        let style = container.style;
        style.position = "absolute";
        style.width = "100%";
        style.height = "100%";
        context = createCanvasContext2D();
        const canvas = context.canvas;
        container.appendChild(canvas);
        style = canvas.style;
        style.position = "absolute";
        style.left = "0";
        style.transformOrigin = "top left";
        this.container = container;
        this.context = context;
      }
      if (!this.containerReused && backgroundColor && !this.container.style.backgroundColor) {
        this.container.style.backgroundColor = backgroundColor;
      }
    }
    clipUnrotated(context, frameState, extent) {
      const topLeft = getTopLeft(extent);
      const topRight = getTopRight(extent);
      const bottomRight = getBottomRight(extent);
      const bottomLeft = getBottomLeft(extent);
      apply(frameState.coordinateToPixelTransform, topLeft);
      apply(frameState.coordinateToPixelTransform, topRight);
      apply(frameState.coordinateToPixelTransform, bottomRight);
      apply(frameState.coordinateToPixelTransform, bottomLeft);
      const inverted = this.inversePixelTransform;
      apply(inverted, topLeft);
      apply(inverted, topRight);
      apply(inverted, bottomRight);
      apply(inverted, bottomLeft);
      context.save();
      context.beginPath();
      context.moveTo(Math.round(topLeft[0]), Math.round(topLeft[1]));
      context.lineTo(Math.round(topRight[0]), Math.round(topRight[1]));
      context.lineTo(Math.round(bottomRight[0]), Math.round(bottomRight[1]));
      context.lineTo(Math.round(bottomLeft[0]), Math.round(bottomLeft[1]));
      context.clip();
    }
    dispatchRenderEvent_(type, context, frameState) {
      const layer = this.getLayer();
      if (layer.hasListener(type)) {
        const event = new RenderEvent$1(
          type,
          this.inversePixelTransform,
          frameState,
          context
        );
        layer.dispatchEvent(event);
      }
    }
    preRender(context, frameState) {
      this.frameState = frameState;
      this.dispatchRenderEvent_(RenderEventType.PRERENDER, context, frameState);
    }
    postRender(context, frameState) {
      this.dispatchRenderEvent_(RenderEventType.POSTRENDER, context, frameState);
    }
    getRenderTransform(center, resolution, rotation, pixelRatio, width, height, offsetX) {
      const dx1 = width / 2;
      const dy1 = height / 2;
      const sx = pixelRatio / resolution;
      const sy = -sx;
      const dx2 = -center[0] + offsetX;
      const dy2 = -center[1];
      return compose(
        this.tempTransform,
        dx1,
        dy1,
        sx,
        sy,
        -rotation,
        dx2,
        dy2
      );
    }
    disposeInternal() {
      delete this.frameState;
      super.disposeInternal();
    }
  }
  const CanvasLayerRenderer$1 = CanvasLayerRenderer;
  class CanvasImageLayerRenderer extends CanvasLayerRenderer$1 {
    constructor(imageLayer) {
      super(imageLayer);
      this.image_ = null;
    }
    getImage() {
      return this.image_ ? this.image_.getImage() : null;
    }
    prepareFrame(frameState) {
      const layerState = frameState.layerStatesArray[frameState.layerIndex];
      const pixelRatio = frameState.pixelRatio;
      const viewState = frameState.viewState;
      const viewResolution = viewState.resolution;
      const imageSource = this.getLayer().getSource();
      const hints = frameState.viewHints;
      let renderedExtent = frameState.extent;
      if (layerState.extent !== void 0) {
        renderedExtent = getIntersection(
          renderedExtent,
          fromUserExtent(layerState.extent, viewState.projection)
        );
      }
      if (!hints[ViewHint.ANIMATING] && !hints[ViewHint.INTERACTING] && !isEmpty(renderedExtent)) {
        if (imageSource) {
          const projection = viewState.projection;
          const image = imageSource.getImage(
            renderedExtent,
            viewResolution,
            pixelRatio,
            projection
          );
          if (image) {
            if (this.loadImage(image)) {
              this.image_ = image;
            } else if (image.getState() === ImageState.EMPTY) {
              this.image_ = null;
            }
          }
        } else {
          this.image_ = null;
        }
      }
      return !!this.image_;
    }
    getData(pixel) {
      const frameState = this.frameState;
      if (!frameState) {
        return null;
      }
      const layer = this.getLayer();
      const coordinate = apply(
        frameState.pixelToCoordinateTransform,
        pixel.slice()
      );
      const layerExtent = layer.getExtent();
      if (layerExtent) {
        if (!containsCoordinate(layerExtent, coordinate)) {
          return null;
        }
      }
      const imageExtent = this.image_.getExtent();
      const img = this.getImage();
      const imageMapWidth = getWidth(imageExtent);
      const col = Math.floor(
        img.width * ((coordinate[0] - imageExtent[0]) / imageMapWidth)
      );
      if (col < 0 || col >= img.width) {
        return null;
      }
      const imageMapHeight = getHeight(imageExtent);
      const row = Math.floor(
        img.height * ((imageExtent[3] - coordinate[1]) / imageMapHeight)
      );
      if (row < 0 || row >= img.height) {
        return null;
      }
      return this.getImageData(img, col, row);
    }
    renderFrame(frameState, target) {
      const image = this.image_;
      const imageExtent = image.getExtent();
      const imageResolution = image.getResolution();
      const imagePixelRatio = image.getPixelRatio();
      const layerState = frameState.layerStatesArray[frameState.layerIndex];
      const pixelRatio = frameState.pixelRatio;
      const viewState = frameState.viewState;
      const viewCenter = viewState.center;
      const viewResolution = viewState.resolution;
      const scale2 = pixelRatio * imageResolution / (viewResolution * imagePixelRatio);
      const extent = frameState.extent;
      const resolution = viewState.resolution;
      const rotation = viewState.rotation;
      const width = Math.round(getWidth(extent) / resolution * pixelRatio);
      const height = Math.round(getHeight(extent) / resolution * pixelRatio);
      compose(
        this.pixelTransform,
        frameState.size[0] / 2,
        frameState.size[1] / 2,
        1 / pixelRatio,
        1 / pixelRatio,
        rotation,
        -width / 2,
        -height / 2
      );
      makeInverse(this.inversePixelTransform, this.pixelTransform);
      const canvasTransform = toString$1(this.pixelTransform);
      this.useContainer(target, canvasTransform, this.getBackground(frameState));
      const context = this.context;
      const canvas = context.canvas;
      if (canvas.width != width || canvas.height != height) {
        canvas.width = width;
        canvas.height = height;
      } else if (!this.containerReused) {
        context.clearRect(0, 0, width, height);
      }
      let clipped = false;
      let render2 = true;
      if (layerState.extent) {
        const layerExtent = fromUserExtent(
          layerState.extent,
          viewState.projection
        );
        render2 = intersects(layerExtent, frameState.extent);
        clipped = render2 && !containsExtent(layerExtent, frameState.extent);
        if (clipped) {
          this.clipUnrotated(context, frameState, layerExtent);
        }
      }
      const img = this.getImage();
      const transform2 = compose(
        this.tempTransform,
        width / 2,
        height / 2,
        scale2,
        scale2,
        0,
        imagePixelRatio * (imageExtent[0] - viewCenter[0]) / imageResolution,
        imagePixelRatio * (viewCenter[1] - imageExtent[3]) / imageResolution
      );
      this.renderedResolution = imageResolution * pixelRatio / imagePixelRatio;
      const dw = img.width * transform2[0];
      const dh = img.height * transform2[3];
      if (!this.getLayer().getSource().getInterpolate()) {
        context.imageSmoothingEnabled = false;
      }
      this.preRender(context, frameState);
      if (render2 && dw >= 0.5 && dh >= 0.5) {
        const dx = transform2[4];
        const dy = transform2[5];
        const opacity = layerState.opacity;
        let previousAlpha;
        if (opacity !== 1) {
          previousAlpha = context.globalAlpha;
          context.globalAlpha = opacity;
        }
        context.drawImage(img, 0, 0, +img.width, +img.height, dx, dy, dw, dh);
        if (opacity !== 1) {
          context.globalAlpha = previousAlpha;
        }
      }
      this.postRender(context, frameState);
      if (clipped) {
        context.restore();
      }
      context.imageSmoothingEnabled = true;
      if (canvasTransform !== canvas.style.transform) {
        canvas.style.transform = canvasTransform;
      }
      return this.container;
    }
  }
  const CanvasImageLayerRenderer$1 = CanvasImageLayerRenderer;
  class ImageLayer extends BaseImageLayer$1 {
    constructor(options) {
      super(options);
    }
    createRenderer() {
      return new CanvasImageLayerRenderer$1(this);
    }
    getData(pixel) {
      return super.getData(pixel);
    }
  }
  const ImageLayer$1 = ImageLayer;
  const TileProperty = {
    PRELOAD: "preload",
    USE_INTERIM_TILES_ON_ERROR: "useInterimTilesOnError"
  };
  class BaseTileLayer extends Layer$1 {
    constructor(options) {
      options = options ? options : {};
      const baseOptions = Object.assign({}, options);
      delete baseOptions.preload;
      delete baseOptions.useInterimTilesOnError;
      super(baseOptions);
      this.on;
      this.once;
      this.un;
      this.setPreload(options.preload !== void 0 ? options.preload : 0);
      this.setUseInterimTilesOnError(
        options.useInterimTilesOnError !== void 0 ? options.useInterimTilesOnError : true
      );
    }
    getPreload() {
      return this.get(TileProperty.PRELOAD);
    }
    setPreload(preload) {
      this.set(TileProperty.PRELOAD, preload);
    }
    getUseInterimTilesOnError() {
      return this.get(TileProperty.USE_INTERIM_TILES_ON_ERROR);
    }
    setUseInterimTilesOnError(useInterimTilesOnError) {
      this.set(TileProperty.USE_INTERIM_TILES_ON_ERROR, useInterimTilesOnError);
    }
    getData(pixel) {
      return super.getData(pixel);
    }
  }
  const BaseTileLayer$1 = BaseTileLayer;
  const TileState = {
    IDLE: 0,
    LOADING: 1,
    LOADED: 2,
    ERROR: 3,
    EMPTY: 4
  };
  class Tile extends Target$1 {
    constructor(tileCoord, state, options) {
      super();
      options = options ? options : {};
      this.tileCoord = tileCoord;
      this.state = state;
      this.interimTile = null;
      this.key = "";
      this.transition_ = options.transition === void 0 ? 250 : options.transition;
      this.transitionStarts_ = {};
      this.interpolate = !!options.interpolate;
    }
    changed() {
      this.dispatchEvent(EventType.CHANGE);
    }
    release() {
      if (this.state === TileState.ERROR) {
        this.setState(TileState.EMPTY);
      }
    }
    getKey() {
      return this.key + "/" + this.tileCoord;
    }
    getInterimTile() {
      if (!this.interimTile) {
        return this;
      }
      let tile = this.interimTile;
      do {
        if (tile.getState() == TileState.LOADED) {
          this.transition_ = 0;
          return tile;
        }
        tile = tile.interimTile;
      } while (tile);
      return this;
    }
    refreshInterimChain() {
      if (!this.interimTile) {
        return;
      }
      let tile = this.interimTile;
      let prev = this;
      do {
        if (tile.getState() == TileState.LOADED) {
          tile.interimTile = null;
          break;
        } else if (tile.getState() == TileState.LOADING) {
          prev = tile;
        } else if (tile.getState() == TileState.IDLE) {
          prev.interimTile = tile.interimTile;
        } else {
          prev = tile;
        }
        tile = prev.interimTile;
      } while (tile);
    }
    getTileCoord() {
      return this.tileCoord;
    }
    getState() {
      return this.state;
    }
    setState(state) {
      if (this.state !== TileState.ERROR && this.state > state) {
        throw new Error("Tile load sequence violation");
      }
      this.state = state;
      this.changed();
    }
    load() {
      abstract();
    }
    getAlpha(id, time) {
      if (!this.transition_) {
        return 1;
      }
      let start2 = this.transitionStarts_[id];
      if (!start2) {
        start2 = time;
        this.transitionStarts_[id] = start2;
      } else if (start2 === -1) {
        return 1;
      }
      const delta = time - start2 + 1e3 / 60;
      if (delta >= this.transition_) {
        return 1;
      }
      return easeIn(delta / this.transition_);
    }
    inTransition(id) {
      if (!this.transition_) {
        return false;
      }
      return this.transitionStarts_[id] !== -1;
    }
    endTransition(id) {
      if (this.transition_) {
        this.transitionStarts_[id] = -1;
      }
    }
  }
  const Tile$1 = Tile;
  class ImageBase extends Target$1 {
    constructor(extent, resolution, pixelRatio, state) {
      super();
      this.extent = extent;
      this.pixelRatio_ = pixelRatio;
      this.resolution = resolution;
      this.state = state;
    }
    changed() {
      this.dispatchEvent(EventType.CHANGE);
    }
    getExtent() {
      return this.extent;
    }
    getImage() {
      return abstract();
    }
    getPixelRatio() {
      return this.pixelRatio_;
    }
    getResolution() {
      return this.resolution;
    }
    getState() {
      return this.state;
    }
    load() {
      abstract();
    }
  }
  const ImageBase$1 = ImageBase;
  class ImageWrapper extends ImageBase$1 {
    constructor(extent, resolution, pixelRatio, src2, crossOrigin, imageLoadFunction, context) {
      super(extent, resolution, pixelRatio, ImageState.IDLE);
      this.src_ = src2;
      this.image_ = new Image();
      if (crossOrigin !== null) {
        this.image_.crossOrigin = crossOrigin;
      }
      this.context_ = context;
      this.unlisten_ = null;
      this.state = ImageState.IDLE;
      this.imageLoadFunction_ = imageLoadFunction;
    }
    getImage() {
      if (this.state == ImageState.LOADED && this.context_ && !(this.image_ instanceof HTMLCanvasElement)) {
        const canvas = this.context_.canvas;
        canvas.width = this.image_.width;
        canvas.height = this.image_.height;
        this.context_.drawImage(this.image_, 0, 0);
        this.image_ = this.context_.canvas;
      }
      return this.image_;
    }
    handleImageError_() {
      this.state = ImageState.ERROR;
      this.unlistenImage_();
      this.changed();
    }
    handleImageLoad_() {
      if (this.resolution === void 0) {
        this.resolution = getHeight(this.extent) / this.image_.height;
      }
      this.state = ImageState.LOADED;
      this.unlistenImage_();
      this.changed();
    }
    load() {
      if (this.state == ImageState.IDLE || this.state == ImageState.ERROR) {
        this.state = ImageState.LOADING;
        this.changed();
        this.imageLoadFunction_(this, this.src_);
        this.unlisten_ = listenImage(
          this.image_,
          this.handleImageLoad_.bind(this),
          this.handleImageError_.bind(this)
        );
      }
    }
    setImage(image) {
      this.image_ = image;
      this.resolution = getHeight(this.extent) / this.image_.height;
    }
    unlistenImage_() {
      if (this.unlisten_) {
        this.unlisten_();
        this.unlisten_ = null;
      }
    }
  }
  function listenImage(image, loadHandler, errorHandler) {
    const img = image;
    let listening = true;
    let decoding = false;
    let loaded = false;
    const listenerKeys = [
      listenOnce(img, EventType.LOAD, function() {
        loaded = true;
        if (!decoding) {
          loadHandler();
        }
      })
    ];
    if (img.src && IMAGE_DECODE) {
      decoding = true;
      img.decode().then(function() {
        if (listening) {
          loadHandler();
        }
      }).catch(function(error) {
        if (listening) {
          if (loaded) {
            loadHandler();
          } else {
            errorHandler();
          }
        }
      });
    } else {
      listenerKeys.push(listenOnce(img, EventType.ERROR, errorHandler));
    }
    return function unlisten() {
      listening = false;
      listenerKeys.forEach(unlistenByKey);
    };
  }
  const ImageWrapper$1 = ImageWrapper;
  class ImageTile extends Tile$1 {
    constructor(tileCoord, state, src2, crossOrigin, tileLoadFunction, options) {
      super(tileCoord, state, options);
      this.crossOrigin_ = crossOrigin;
      this.src_ = src2;
      this.key = src2;
      this.image_ = new Image();
      if (crossOrigin !== null) {
        this.image_.crossOrigin = crossOrigin;
      }
      this.unlisten_ = null;
      this.tileLoadFunction_ = tileLoadFunction;
    }
    getImage() {
      return this.image_;
    }
    setImage(element) {
      this.image_ = element;
      this.state = TileState.LOADED;
      this.unlistenImage_();
      this.changed();
    }
    handleImageError_() {
      this.state = TileState.ERROR;
      this.unlistenImage_();
      this.image_ = getBlankImage();
      this.changed();
    }
    handleImageLoad_() {
      const image = this.image_;
      if (image.naturalWidth && image.naturalHeight) {
        this.state = TileState.LOADED;
      } else {
        this.state = TileState.EMPTY;
      }
      this.unlistenImage_();
      this.changed();
    }
    load() {
      if (this.state == TileState.ERROR) {
        this.state = TileState.IDLE;
        this.image_ = new Image();
        if (this.crossOrigin_ !== null) {
          this.image_.crossOrigin = this.crossOrigin_;
        }
      }
      if (this.state == TileState.IDLE) {
        this.state = TileState.LOADING;
        this.changed();
        this.tileLoadFunction_(this, this.src_);
        this.unlisten_ = listenImage(
          this.image_,
          this.handleImageLoad_.bind(this),
          this.handleImageError_.bind(this)
        );
      }
    }
    unlistenImage_() {
      if (this.unlisten_) {
        this.unlisten_();
        this.unlisten_ = null;
      }
    }
  }
  function getBlankImage() {
    const ctx = createCanvasContext2D(1, 1);
    ctx.fillStyle = "rgba(0,0,0,0)";
    ctx.fillRect(0, 0, 1, 1);
    return ctx.canvas;
  }
  const ImageTile$1 = ImageTile;
  const ERROR_THRESHOLD = 0.5;
  const MAX_SUBDIVISION = 10;
  const MAX_TRIANGLE_WIDTH = 0.25;
  class Triangulation {
    constructor(sourceProj, targetProj, targetExtent, maxSourceExtent, errorThreshold, destinationResolution) {
      this.sourceProj_ = sourceProj;
      this.targetProj_ = targetProj;
      let transformInvCache = {};
      const transformInv = getTransform(this.targetProj_, this.sourceProj_);
      this.transformInv_ = function(c2) {
        const key = c2[0] + "/" + c2[1];
        if (!transformInvCache[key]) {
          transformInvCache[key] = transformInv(c2);
        }
        return transformInvCache[key];
      };
      this.maxSourceExtent_ = maxSourceExtent;
      this.errorThresholdSquared_ = errorThreshold * errorThreshold;
      this.triangles_ = [];
      this.wrapsXInSource_ = false;
      this.canWrapXInSource_ = this.sourceProj_.canWrapX() && !!maxSourceExtent && !!this.sourceProj_.getExtent() && getWidth(maxSourceExtent) == getWidth(this.sourceProj_.getExtent());
      this.sourceWorldWidth_ = this.sourceProj_.getExtent() ? getWidth(this.sourceProj_.getExtent()) : null;
      this.targetWorldWidth_ = this.targetProj_.getExtent() ? getWidth(this.targetProj_.getExtent()) : null;
      const destinationTopLeft = getTopLeft(targetExtent);
      const destinationTopRight = getTopRight(targetExtent);
      const destinationBottomRight = getBottomRight(targetExtent);
      const destinationBottomLeft = getBottomLeft(targetExtent);
      const sourceTopLeft = this.transformInv_(destinationTopLeft);
      const sourceTopRight = this.transformInv_(destinationTopRight);
      const sourceBottomRight = this.transformInv_(destinationBottomRight);
      const sourceBottomLeft = this.transformInv_(destinationBottomLeft);
      const maxSubdivision = MAX_SUBDIVISION + (destinationResolution ? Math.max(
        0,
        Math.ceil(
          Math.log2(
            getArea(targetExtent) / (destinationResolution * destinationResolution * 256 * 256)
          )
        )
      ) : 0);
      this.addQuad_(
        destinationTopLeft,
        destinationTopRight,
        destinationBottomRight,
        destinationBottomLeft,
        sourceTopLeft,
        sourceTopRight,
        sourceBottomRight,
        sourceBottomLeft,
        maxSubdivision
      );
      if (this.wrapsXInSource_) {
        let leftBound = Infinity;
        this.triangles_.forEach(function(triangle, i, arr2) {
          leftBound = Math.min(
            leftBound,
            triangle.source[0][0],
            triangle.source[1][0],
            triangle.source[2][0]
          );
        });
        this.triangles_.forEach((triangle) => {
          if (Math.max(
            triangle.source[0][0],
            triangle.source[1][0],
            triangle.source[2][0]
          ) - leftBound > this.sourceWorldWidth_ / 2) {
            const newTriangle = [
              [triangle.source[0][0], triangle.source[0][1]],
              [triangle.source[1][0], triangle.source[1][1]],
              [triangle.source[2][0], triangle.source[2][1]]
            ];
            if (newTriangle[0][0] - leftBound > this.sourceWorldWidth_ / 2) {
              newTriangle[0][0] -= this.sourceWorldWidth_;
            }
            if (newTriangle[1][0] - leftBound > this.sourceWorldWidth_ / 2) {
              newTriangle[1][0] -= this.sourceWorldWidth_;
            }
            if (newTriangle[2][0] - leftBound > this.sourceWorldWidth_ / 2) {
              newTriangle[2][0] -= this.sourceWorldWidth_;
            }
            const minX = Math.min(
              newTriangle[0][0],
              newTriangle[1][0],
              newTriangle[2][0]
            );
            const maxX = Math.max(
              newTriangle[0][0],
              newTriangle[1][0],
              newTriangle[2][0]
            );
            if (maxX - minX < this.sourceWorldWidth_ / 2) {
              triangle.source = newTriangle;
            }
          }
        });
      }
      transformInvCache = {};
    }
    addTriangle_(a, b, c2, aSrc, bSrc, cSrc) {
      this.triangles_.push({
        source: [aSrc, bSrc, cSrc],
        target: [a, b, c2]
      });
    }
    addQuad_(a, b, c2, d, aSrc, bSrc, cSrc, dSrc, maxSubdivision) {
      const sourceQuadExtent = boundingExtent([aSrc, bSrc, cSrc, dSrc]);
      const sourceCoverageX = this.sourceWorldWidth_ ? getWidth(sourceQuadExtent) / this.sourceWorldWidth_ : null;
      const sourceWorldWidth = this.sourceWorldWidth_;
      const wrapsX = this.sourceProj_.canWrapX() && sourceCoverageX > 0.5 && sourceCoverageX < 1;
      let needsSubdivision = false;
      if (maxSubdivision > 0) {
        if (this.targetProj_.isGlobal() && this.targetWorldWidth_) {
          const targetQuadExtent = boundingExtent([a, b, c2, d]);
          const targetCoverageX = getWidth(targetQuadExtent) / this.targetWorldWidth_;
          needsSubdivision = targetCoverageX > MAX_TRIANGLE_WIDTH || needsSubdivision;
        }
        if (!wrapsX && this.sourceProj_.isGlobal() && sourceCoverageX) {
          needsSubdivision = sourceCoverageX > MAX_TRIANGLE_WIDTH || needsSubdivision;
        }
      }
      if (!needsSubdivision && this.maxSourceExtent_) {
        if (isFinite(sourceQuadExtent[0]) && isFinite(sourceQuadExtent[1]) && isFinite(sourceQuadExtent[2]) && isFinite(sourceQuadExtent[3])) {
          if (!intersects(sourceQuadExtent, this.maxSourceExtent_)) {
            return;
          }
        }
      }
      let isNotFinite = 0;
      if (!needsSubdivision) {
        if (!isFinite(aSrc[0]) || !isFinite(aSrc[1]) || !isFinite(bSrc[0]) || !isFinite(bSrc[1]) || !isFinite(cSrc[0]) || !isFinite(cSrc[1]) || !isFinite(dSrc[0]) || !isFinite(dSrc[1])) {
          if (maxSubdivision > 0) {
            needsSubdivision = true;
          } else {
            isNotFinite = (!isFinite(aSrc[0]) || !isFinite(aSrc[1]) ? 8 : 0) + (!isFinite(bSrc[0]) || !isFinite(bSrc[1]) ? 4 : 0) + (!isFinite(cSrc[0]) || !isFinite(cSrc[1]) ? 2 : 0) + (!isFinite(dSrc[0]) || !isFinite(dSrc[1]) ? 1 : 0);
            if (isNotFinite != 1 && isNotFinite != 2 && isNotFinite != 4 && isNotFinite != 8) {
              return;
            }
          }
        }
      }
      if (maxSubdivision > 0) {
        if (!needsSubdivision) {
          const center = [(a[0] + c2[0]) / 2, (a[1] + c2[1]) / 2];
          const centerSrc = this.transformInv_(center);
          let dx;
          if (wrapsX) {
            const centerSrcEstimX = (modulo(aSrc[0], sourceWorldWidth) + modulo(cSrc[0], sourceWorldWidth)) / 2;
            dx = centerSrcEstimX - modulo(centerSrc[0], sourceWorldWidth);
          } else {
            dx = (aSrc[0] + cSrc[0]) / 2 - centerSrc[0];
          }
          const dy = (aSrc[1] + cSrc[1]) / 2 - centerSrc[1];
          const centerSrcErrorSquared = dx * dx + dy * dy;
          needsSubdivision = centerSrcErrorSquared > this.errorThresholdSquared_;
        }
        if (needsSubdivision) {
          if (Math.abs(a[0] - c2[0]) <= Math.abs(a[1] - c2[1])) {
            const bc = [(b[0] + c2[0]) / 2, (b[1] + c2[1]) / 2];
            const bcSrc = this.transformInv_(bc);
            const da = [(d[0] + a[0]) / 2, (d[1] + a[1]) / 2];
            const daSrc = this.transformInv_(da);
            this.addQuad_(
              a,
              b,
              bc,
              da,
              aSrc,
              bSrc,
              bcSrc,
              daSrc,
              maxSubdivision - 1
            );
            this.addQuad_(
              da,
              bc,
              c2,
              d,
              daSrc,
              bcSrc,
              cSrc,
              dSrc,
              maxSubdivision - 1
            );
          } else {
            const ab = [(a[0] + b[0]) / 2, (a[1] + b[1]) / 2];
            const abSrc = this.transformInv_(ab);
            const cd = [(c2[0] + d[0]) / 2, (c2[1] + d[1]) / 2];
            const cdSrc = this.transformInv_(cd);
            this.addQuad_(
              a,
              ab,
              cd,
              d,
              aSrc,
              abSrc,
              cdSrc,
              dSrc,
              maxSubdivision - 1
            );
            this.addQuad_(
              ab,
              b,
              c2,
              cd,
              abSrc,
              bSrc,
              cSrc,
              cdSrc,
              maxSubdivision - 1
            );
          }
          return;
        }
      }
      if (wrapsX) {
        if (!this.canWrapXInSource_) {
          return;
        }
        this.wrapsXInSource_ = true;
      }
      if ((isNotFinite & 11) == 0) {
        this.addTriangle_(a, c2, d, aSrc, cSrc, dSrc);
      }
      if ((isNotFinite & 14) == 0) {
        this.addTriangle_(a, c2, b, aSrc, cSrc, bSrc);
      }
      if (isNotFinite) {
        if ((isNotFinite & 13) == 0) {
          this.addTriangle_(b, d, a, bSrc, dSrc, aSrc);
        }
        if ((isNotFinite & 7) == 0) {
          this.addTriangle_(b, d, c2, bSrc, dSrc, cSrc);
        }
      }
    }
    calculateSourceExtent() {
      const extent = createEmpty();
      this.triangles_.forEach(function(triangle, i, arr2) {
        const src2 = triangle.source;
        extendCoordinate(extent, src2[0]);
        extendCoordinate(extent, src2[1]);
        extendCoordinate(extent, src2[2]);
      });
      return extent;
    }
    getTriangles() {
      return this.triangles_;
    }
  }
  const Triangulation$1 = Triangulation;
  let brokenDiagonalRendering_;
  const canvasPool = [];
  function drawTestTriangle(ctx, u1, v1, u2, v2) {
    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.lineTo(u1, v1);
    ctx.lineTo(u2, v2);
    ctx.closePath();
    ctx.save();
    ctx.clip();
    ctx.fillRect(0, 0, Math.max(u1, u2) + 1, Math.max(v1, v2));
    ctx.restore();
  }
  function verifyBrokenDiagonalRendering(data, offset) {
    return Math.abs(data[offset * 4] - 210) > 2 || Math.abs(data[offset * 4 + 3] - 0.75 * 255) > 2;
  }
  function isBrokenDiagonalRendering() {
    if (brokenDiagonalRendering_ === void 0) {
      const ctx = createCanvasContext2D(6, 6, canvasPool);
      ctx.globalCompositeOperation = "lighter";
      ctx.fillStyle = "rgba(210, 0, 0, 0.75)";
      drawTestTriangle(ctx, 4, 5, 4, 0);
      drawTestTriangle(ctx, 4, 5, 0, 5);
      const data = ctx.getImageData(0, 0, 3, 3).data;
      brokenDiagonalRendering_ = verifyBrokenDiagonalRendering(data, 0) || verifyBrokenDiagonalRendering(data, 4) || verifyBrokenDiagonalRendering(data, 8);
      releaseCanvas(ctx);
      canvasPool.push(ctx.canvas);
    }
    return brokenDiagonalRendering_;
  }
  function calculateSourceResolution(sourceProj, targetProj, targetCenter, targetResolution) {
    const sourceCenter = transform$1(targetCenter, targetProj, sourceProj);
    let sourceResolution = getPointResolution(
      targetProj,
      targetResolution,
      targetCenter
    );
    const targetMetersPerUnit = targetProj.getMetersPerUnit();
    if (targetMetersPerUnit !== void 0) {
      sourceResolution *= targetMetersPerUnit;
    }
    const sourceMetersPerUnit = sourceProj.getMetersPerUnit();
    if (sourceMetersPerUnit !== void 0) {
      sourceResolution /= sourceMetersPerUnit;
    }
    const sourceExtent = sourceProj.getExtent();
    if (!sourceExtent || containsCoordinate(sourceExtent, sourceCenter)) {
      const compensationFactor = getPointResolution(sourceProj, sourceResolution, sourceCenter) / sourceResolution;
      if (isFinite(compensationFactor) && compensationFactor > 0) {
        sourceResolution /= compensationFactor;
      }
    }
    return sourceResolution;
  }
  function calculateSourceExtentResolution(sourceProj, targetProj, targetExtent, targetResolution) {
    const targetCenter = getCenter(targetExtent);
    let sourceResolution = calculateSourceResolution(
      sourceProj,
      targetProj,
      targetCenter,
      targetResolution
    );
    if (!isFinite(sourceResolution) || sourceResolution <= 0) {
      forEachCorner(targetExtent, function(corner) {
        sourceResolution = calculateSourceResolution(
          sourceProj,
          targetProj,
          corner,
          targetResolution
        );
        return isFinite(sourceResolution) && sourceResolution > 0;
      });
    }
    return sourceResolution;
  }
  function render(width, height, pixelRatio, sourceResolution, sourceExtent, targetResolution, targetExtent, triangulation, sources, gutter, renderEdges, interpolate) {
    const context = createCanvasContext2D(
      Math.round(pixelRatio * width),
      Math.round(pixelRatio * height),
      canvasPool
    );
    if (!interpolate) {
      context.imageSmoothingEnabled = false;
    }
    if (sources.length === 0) {
      return context.canvas;
    }
    context.scale(pixelRatio, pixelRatio);
    function pixelRound(value) {
      return Math.round(value * pixelRatio) / pixelRatio;
    }
    context.globalCompositeOperation = "lighter";
    const sourceDataExtent = createEmpty();
    sources.forEach(function(src2, i, arr2) {
      extend$3(sourceDataExtent, src2.extent);
    });
    const canvasWidthInUnits = getWidth(sourceDataExtent);
    const canvasHeightInUnits = getHeight(sourceDataExtent);
    const stitchContext = createCanvasContext2D(
      Math.round(pixelRatio * canvasWidthInUnits / sourceResolution),
      Math.round(pixelRatio * canvasHeightInUnits / sourceResolution),
      canvasPool
    );
    if (!interpolate) {
      stitchContext.imageSmoothingEnabled = false;
    }
    const stitchScale = pixelRatio / sourceResolution;
    sources.forEach(function(src2, i, arr2) {
      const xPos = src2.extent[0] - sourceDataExtent[0];
      const yPos = -(src2.extent[3] - sourceDataExtent[3]);
      const srcWidth = getWidth(src2.extent);
      const srcHeight = getHeight(src2.extent);
      if (src2.image.width > 0 && src2.image.height > 0) {
        stitchContext.drawImage(
          src2.image,
          gutter,
          gutter,
          src2.image.width - 2 * gutter,
          src2.image.height - 2 * gutter,
          xPos * stitchScale,
          yPos * stitchScale,
          srcWidth * stitchScale,
          srcHeight * stitchScale
        );
      }
    });
    const targetTopLeft = getTopLeft(targetExtent);
    triangulation.getTriangles().forEach(function(triangle, i, arr2) {
      const source = triangle.source;
      const target = triangle.target;
      let x0 = source[0][0], y0 = source[0][1];
      let x1 = source[1][0], y1 = source[1][1];
      let x2 = source[2][0], y2 = source[2][1];
      const u0 = pixelRound((target[0][0] - targetTopLeft[0]) / targetResolution);
      const v0 = pixelRound(
        -(target[0][1] - targetTopLeft[1]) / targetResolution
      );
      const u1 = pixelRound((target[1][0] - targetTopLeft[0]) / targetResolution);
      const v1 = pixelRound(
        -(target[1][1] - targetTopLeft[1]) / targetResolution
      );
      const u2 = pixelRound((target[2][0] - targetTopLeft[0]) / targetResolution);
      const v2 = pixelRound(
        -(target[2][1] - targetTopLeft[1]) / targetResolution
      );
      const sourceNumericalShiftX = x0;
      const sourceNumericalShiftY = y0;
      x0 = 0;
      y0 = 0;
      x1 -= sourceNumericalShiftX;
      y1 -= sourceNumericalShiftY;
      x2 -= sourceNumericalShiftX;
      y2 -= sourceNumericalShiftY;
      const augmentedMatrix = [
        [x1, y1, 0, 0, u1 - u0],
        [x2, y2, 0, 0, u2 - u0],
        [0, 0, x1, y1, v1 - v0],
        [0, 0, x2, y2, v2 - v0]
      ];
      const affineCoefs = solveLinearSystem(augmentedMatrix);
      if (!affineCoefs) {
        return;
      }
      context.save();
      context.beginPath();
      if (isBrokenDiagonalRendering() || !interpolate) {
        context.moveTo(u1, v1);
        const steps = 4;
        const ud = u0 - u1;
        const vd = v0 - v1;
        for (let step = 0; step < steps; step++) {
          context.lineTo(
            u1 + pixelRound((step + 1) * ud / steps),
            v1 + pixelRound(step * vd / (steps - 1))
          );
          if (step != steps - 1) {
            context.lineTo(
              u1 + pixelRound((step + 1) * ud / steps),
              v1 + pixelRound((step + 1) * vd / (steps - 1))
            );
          }
        }
        context.lineTo(u2, v2);
      } else {
        context.moveTo(u1, v1);
        context.lineTo(u0, v0);
        context.lineTo(u2, v2);
      }
      context.clip();
      context.transform(
        affineCoefs[0],
        affineCoefs[2],
        affineCoefs[1],
        affineCoefs[3],
        u0,
        v0
      );
      context.translate(
        sourceDataExtent[0] - sourceNumericalShiftX,
        sourceDataExtent[3] - sourceNumericalShiftY
      );
      context.scale(
        sourceResolution / pixelRatio,
        -sourceResolution / pixelRatio
      );
      context.drawImage(stitchContext.canvas, 0, 0);
      context.restore();
    });
    releaseCanvas(stitchContext);
    canvasPool.push(stitchContext.canvas);
    if (renderEdges) {
      context.save();
      context.globalCompositeOperation = "source-over";
      context.strokeStyle = "black";
      context.lineWidth = 1;
      triangulation.getTriangles().forEach(function(triangle, i, arr2) {
        const target = triangle.target;
        const u0 = (target[0][0] - targetTopLeft[0]) / targetResolution;
        const v0 = -(target[0][1] - targetTopLeft[1]) / targetResolution;
        const u1 = (target[1][0] - targetTopLeft[0]) / targetResolution;
        const v1 = -(target[1][1] - targetTopLeft[1]) / targetResolution;
        const u2 = (target[2][0] - targetTopLeft[0]) / targetResolution;
        const v2 = -(target[2][1] - targetTopLeft[1]) / targetResolution;
        context.beginPath();
        context.moveTo(u1, v1);
        context.lineTo(u0, v0);
        context.lineTo(u2, v2);
        context.closePath();
        context.stroke();
      });
      context.restore();
    }
    return context.canvas;
  }
  class ReprojTile extends Tile$1 {
    constructor(sourceProj, sourceTileGrid, targetProj, targetTileGrid, tileCoord, wrappedTileCoord, pixelRatio, gutter, getTileFunction, errorThreshold, renderEdges, interpolate) {
      super(tileCoord, TileState.IDLE, { interpolate: !!interpolate });
      this.renderEdges_ = renderEdges !== void 0 ? renderEdges : false;
      this.pixelRatio_ = pixelRatio;
      this.gutter_ = gutter;
      this.canvas_ = null;
      this.sourceTileGrid_ = sourceTileGrid;
      this.targetTileGrid_ = targetTileGrid;
      this.wrappedTileCoord_ = wrappedTileCoord ? wrappedTileCoord : tileCoord;
      this.sourceTiles_ = [];
      this.sourcesListenerKeys_ = null;
      this.sourceZ_ = 0;
      const targetExtent = targetTileGrid.getTileCoordExtent(
        this.wrappedTileCoord_
      );
      const maxTargetExtent = this.targetTileGrid_.getExtent();
      let maxSourceExtent = this.sourceTileGrid_.getExtent();
      const limitedTargetExtent = maxTargetExtent ? getIntersection(targetExtent, maxTargetExtent) : targetExtent;
      if (getArea(limitedTargetExtent) === 0) {
        this.state = TileState.EMPTY;
        return;
      }
      const sourceProjExtent = sourceProj.getExtent();
      if (sourceProjExtent) {
        if (!maxSourceExtent) {
          maxSourceExtent = sourceProjExtent;
        } else {
          maxSourceExtent = getIntersection(maxSourceExtent, sourceProjExtent);
        }
      }
      const targetResolution = targetTileGrid.getResolution(
        this.wrappedTileCoord_[0]
      );
      const sourceResolution = calculateSourceExtentResolution(
        sourceProj,
        targetProj,
        limitedTargetExtent,
        targetResolution
      );
      if (!isFinite(sourceResolution) || sourceResolution <= 0) {
        this.state = TileState.EMPTY;
        return;
      }
      const errorThresholdInPixels = errorThreshold !== void 0 ? errorThreshold : ERROR_THRESHOLD;
      this.triangulation_ = new Triangulation$1(
        sourceProj,
        targetProj,
        limitedTargetExtent,
        maxSourceExtent,
        sourceResolution * errorThresholdInPixels,
        targetResolution
      );
      if (this.triangulation_.getTriangles().length === 0) {
        this.state = TileState.EMPTY;
        return;
      }
      this.sourceZ_ = sourceTileGrid.getZForResolution(sourceResolution);
      let sourceExtent = this.triangulation_.calculateSourceExtent();
      if (maxSourceExtent) {
        if (sourceProj.canWrapX()) {
          sourceExtent[1] = clamp(
            sourceExtent[1],
            maxSourceExtent[1],
            maxSourceExtent[3]
          );
          sourceExtent[3] = clamp(
            sourceExtent[3],
            maxSourceExtent[1],
            maxSourceExtent[3]
          );
        } else {
          sourceExtent = getIntersection(sourceExtent, maxSourceExtent);
        }
      }
      if (!getArea(sourceExtent)) {
        this.state = TileState.EMPTY;
      } else {
        const sourceRange = sourceTileGrid.getTileRangeForExtentAndZ(
          sourceExtent,
          this.sourceZ_
        );
        for (let srcX = sourceRange.minX; srcX <= sourceRange.maxX; srcX++) {
          for (let srcY = sourceRange.minY; srcY <= sourceRange.maxY; srcY++) {
            const tile = getTileFunction(this.sourceZ_, srcX, srcY, pixelRatio);
            if (tile) {
              this.sourceTiles_.push(tile);
            }
          }
        }
        if (this.sourceTiles_.length === 0) {
          this.state = TileState.EMPTY;
        }
      }
    }
    getImage() {
      return this.canvas_;
    }
    reproject_() {
      const sources = [];
      this.sourceTiles_.forEach((tile) => {
        if (tile && tile.getState() == TileState.LOADED) {
          sources.push({
            extent: this.sourceTileGrid_.getTileCoordExtent(tile.tileCoord),
            image: tile.getImage()
          });
        }
      });
      this.sourceTiles_.length = 0;
      if (sources.length === 0) {
        this.state = TileState.ERROR;
      } else {
        const z = this.wrappedTileCoord_[0];
        const size = this.targetTileGrid_.getTileSize(z);
        const width = typeof size === "number" ? size : size[0];
        const height = typeof size === "number" ? size : size[1];
        const targetResolution = this.targetTileGrid_.getResolution(z);
        const sourceResolution = this.sourceTileGrid_.getResolution(
          this.sourceZ_
        );
        const targetExtent = this.targetTileGrid_.getTileCoordExtent(
          this.wrappedTileCoord_
        );
        this.canvas_ = render(
          width,
          height,
          this.pixelRatio_,
          sourceResolution,
          this.sourceTileGrid_.getExtent(),
          targetResolution,
          targetExtent,
          this.triangulation_,
          sources,
          this.gutter_,
          this.renderEdges_,
          this.interpolate
        );
        this.state = TileState.LOADED;
      }
      this.changed();
    }
    load() {
      if (this.state == TileState.IDLE) {
        this.state = TileState.LOADING;
        this.changed();
        let leftToLoad = 0;
        this.sourcesListenerKeys_ = [];
        this.sourceTiles_.forEach((tile) => {
          const state = tile.getState();
          if (state == TileState.IDLE || state == TileState.LOADING) {
            leftToLoad++;
            const sourceListenKey = listen(
              tile,
              EventType.CHANGE,
              function(e) {
                const state2 = tile.getState();
                if (state2 == TileState.LOADED || state2 == TileState.ERROR || state2 == TileState.EMPTY) {
                  unlistenByKey(sourceListenKey);
                  leftToLoad--;
                  if (leftToLoad === 0) {
                    this.unlistenSources_();
                    this.reproject_();
                  }
                }
              },
              this
            );
            this.sourcesListenerKeys_.push(sourceListenKey);
          }
        });
        if (leftToLoad === 0) {
          setTimeout(this.reproject_.bind(this), 0);
        } else {
          this.sourceTiles_.forEach(function(tile, i, arr2) {
            const state = tile.getState();
            if (state == TileState.IDLE) {
              tile.load();
            }
          });
        }
      }
    }
    unlistenSources_() {
      this.sourcesListenerKeys_.forEach(unlistenByKey);
      this.sourcesListenerKeys_ = null;
    }
    release() {
      if (this.canvas_) {
        releaseCanvas(this.canvas_.getContext("2d"));
        canvasPool.push(this.canvas_);
        this.canvas_ = null;
      }
      super.release();
    }
  }
  const ReprojTile$1 = ReprojTile;
  class TileRange {
    constructor(minX, maxX, minY, maxY) {
      this.minX = minX;
      this.maxX = maxX;
      this.minY = minY;
      this.maxY = maxY;
    }
    contains(tileCoord) {
      return this.containsXY(tileCoord[1], tileCoord[2]);
    }
    containsTileRange(tileRange) {
      return this.minX <= tileRange.minX && tileRange.maxX <= this.maxX && this.minY <= tileRange.minY && tileRange.maxY <= this.maxY;
    }
    containsXY(x, y2) {
      return this.minX <= x && x <= this.maxX && this.minY <= y2 && y2 <= this.maxY;
    }
    equals(tileRange) {
      return this.minX == tileRange.minX && this.minY == tileRange.minY && this.maxX == tileRange.maxX && this.maxY == tileRange.maxY;
    }
    extend(tileRange) {
      if (tileRange.minX < this.minX) {
        this.minX = tileRange.minX;
      }
      if (tileRange.maxX > this.maxX) {
        this.maxX = tileRange.maxX;
      }
      if (tileRange.minY < this.minY) {
        this.minY = tileRange.minY;
      }
      if (tileRange.maxY > this.maxY) {
        this.maxY = tileRange.maxY;
      }
    }
    getHeight() {
      return this.maxY - this.minY + 1;
    }
    getSize() {
      return [this.getWidth(), this.getHeight()];
    }
    getWidth() {
      return this.maxX - this.minX + 1;
    }
    intersects(tileRange) {
      return this.minX <= tileRange.maxX && this.maxX >= tileRange.minX && this.minY <= tileRange.maxY && this.maxY >= tileRange.minY;
    }
  }
  function createOrUpdate$1(minX, maxX, minY, maxY, tileRange) {
    if (tileRange !== void 0) {
      tileRange.minX = minX;
      tileRange.maxX = maxX;
      tileRange.minY = minY;
      tileRange.maxY = maxY;
      return tileRange;
    }
    return new TileRange(minX, maxX, minY, maxY);
  }
  const TileRange$1 = TileRange;
  function hasArea(size) {
    return size[0] > 0 && size[1] > 0;
  }
  function scale(size, ratio, dest) {
    if (dest === void 0) {
      dest = [0, 0];
    }
    dest[0] = size[0] * ratio + 0.5 | 0;
    dest[1] = size[1] * ratio + 0.5 | 0;
    return dest;
  }
  function toSize(size, dest) {
    if (Array.isArray(size)) {
      return size;
    }
    if (dest === void 0) {
      dest = [size, size];
    } else {
      dest[0] = size;
      dest[1] = size;
    }
    return dest;
  }
  class CanvasTileLayerRenderer extends CanvasLayerRenderer$1 {
    constructor(tileLayer) {
      super(tileLayer);
      this.extentChanged = true;
      this.renderedExtent_ = null;
      this.renderedPixelRatio;
      this.renderedProjection = null;
      this.renderedRevision;
      this.renderedTiles = [];
      this.newTiles_ = false;
      this.tmpExtent = createEmpty();
      this.tmpTileRange_ = new TileRange$1(0, 0, 0, 0);
    }
    isDrawableTile(tile) {
      const tileLayer = this.getLayer();
      const tileState = tile.getState();
      const useInterimTilesOnError = tileLayer.getUseInterimTilesOnError();
      return tileState == TileState.LOADED || tileState == TileState.EMPTY || tileState == TileState.ERROR && !useInterimTilesOnError;
    }
    getTile(z, x, y2, frameState) {
      const pixelRatio = frameState.pixelRatio;
      const projection = frameState.viewState.projection;
      const tileLayer = this.getLayer();
      const tileSource = tileLayer.getSource();
      let tile = tileSource.getTile(z, x, y2, pixelRatio, projection);
      if (tile.getState() == TileState.ERROR) {
        if (tileLayer.getUseInterimTilesOnError() && tileLayer.getPreload() > 0) {
          this.newTiles_ = true;
        }
      }
      if (!this.isDrawableTile(tile)) {
        tile = tile.getInterimTile();
      }
      return tile;
    }
    getData(pixel) {
      const frameState = this.frameState;
      if (!frameState) {
        return null;
      }
      const layer = this.getLayer();
      const coordinate = apply(
        frameState.pixelToCoordinateTransform,
        pixel.slice()
      );
      const layerExtent = layer.getExtent();
      if (layerExtent) {
        if (!containsCoordinate(layerExtent, coordinate)) {
          return null;
        }
      }
      const pixelRatio = frameState.pixelRatio;
      const projection = frameState.viewState.projection;
      const viewState = frameState.viewState;
      const source = layer.getRenderSource();
      const tileGrid = source.getTileGridForProjection(viewState.projection);
      const tilePixelRatio = source.getTilePixelRatio(frameState.pixelRatio);
      for (let z = tileGrid.getZForResolution(viewState.resolution); z >= tileGrid.getMinZoom(); --z) {
        const tileCoord = tileGrid.getTileCoordForCoordAndZ(coordinate, z);
        const tile = source.getTile(
          z,
          tileCoord[1],
          tileCoord[2],
          pixelRatio,
          projection
        );
        if (!(tile instanceof ImageTile$1 || tile instanceof ReprojTile$1) || tile instanceof ReprojTile$1 && tile.getState() === TileState.EMPTY) {
          return null;
        }
        if (tile.getState() !== TileState.LOADED) {
          continue;
        }
        const tileOrigin = tileGrid.getOrigin(z);
        const tileSize = toSize(tileGrid.getTileSize(z));
        const tileResolution = tileGrid.getResolution(z);
        const col = Math.floor(
          tilePixelRatio * ((coordinate[0] - tileOrigin[0]) / tileResolution - tileCoord[1] * tileSize[0])
        );
        const row = Math.floor(
          tilePixelRatio * ((tileOrigin[1] - coordinate[1]) / tileResolution - tileCoord[2] * tileSize[1])
        );
        const gutter = Math.round(
          tilePixelRatio * source.getGutterForProjection(viewState.projection)
        );
        return this.getImageData(tile.getImage(), col + gutter, row + gutter);
      }
      return null;
    }
    loadedTileCallback(tiles, zoom, tile) {
      if (this.isDrawableTile(tile)) {
        return super.loadedTileCallback(tiles, zoom, tile);
      }
      return false;
    }
    prepareFrame(frameState) {
      return !!this.getLayer().getSource();
    }
    renderFrame(frameState, target) {
      const layerState = frameState.layerStatesArray[frameState.layerIndex];
      const viewState = frameState.viewState;
      const projection = viewState.projection;
      const viewResolution = viewState.resolution;
      const viewCenter = viewState.center;
      const rotation = viewState.rotation;
      const pixelRatio = frameState.pixelRatio;
      const tileLayer = this.getLayer();
      const tileSource = tileLayer.getSource();
      const sourceRevision = tileSource.getRevision();
      const tileGrid = tileSource.getTileGridForProjection(projection);
      const z = tileGrid.getZForResolution(viewResolution, tileSource.zDirection);
      const tileResolution = tileGrid.getResolution(z);
      let extent = frameState.extent;
      const resolution = frameState.viewState.resolution;
      const tilePixelRatio = tileSource.getTilePixelRatio(pixelRatio);
      const width = Math.round(getWidth(extent) / resolution * pixelRatio);
      const height = Math.round(getHeight(extent) / resolution * pixelRatio);
      const layerExtent = layerState.extent && fromUserExtent(layerState.extent);
      if (layerExtent) {
        extent = getIntersection(
          extent,
          fromUserExtent(layerState.extent)
        );
      }
      const dx = tileResolution * width / 2 / tilePixelRatio;
      const dy = tileResolution * height / 2 / tilePixelRatio;
      const canvasExtent = [
        viewCenter[0] - dx,
        viewCenter[1] - dy,
        viewCenter[0] + dx,
        viewCenter[1] + dy
      ];
      const tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);
      const tilesToDrawByZ = {};
      tilesToDrawByZ[z] = {};
      const findLoadedTiles = this.createLoadedTileFinder(
        tileSource,
        projection,
        tilesToDrawByZ
      );
      const tmpExtent = this.tmpExtent;
      const tmpTileRange = this.tmpTileRange_;
      this.newTiles_ = false;
      const viewport = rotation ? getRotatedViewport(
        viewState.center,
        resolution,
        rotation,
        frameState.size
      ) : void 0;
      for (let x = tileRange.minX; x <= tileRange.maxX; ++x) {
        for (let y2 = tileRange.minY; y2 <= tileRange.maxY; ++y2) {
          if (rotation && !tileGrid.tileCoordIntersectsViewport([z, x, y2], viewport)) {
            continue;
          }
          const tile = this.getTile(z, x, y2, frameState);
          if (this.isDrawableTile(tile)) {
            const uid = getUid(this);
            if (tile.getState() == TileState.LOADED) {
              tilesToDrawByZ[z][tile.tileCoord.toString()] = tile;
              let inTransition = tile.inTransition(uid);
              if (inTransition && layerState.opacity !== 1) {
                tile.endTransition(uid);
                inTransition = false;
              }
              if (!this.newTiles_ && (inTransition || !this.renderedTiles.includes(tile))) {
                this.newTiles_ = true;
              }
            }
            if (tile.getAlpha(uid, frameState.time) === 1) {
              continue;
            }
          }
          const childTileRange = tileGrid.getTileCoordChildTileRange(
            tile.tileCoord,
            tmpTileRange,
            tmpExtent
          );
          let covered = false;
          if (childTileRange) {
            covered = findLoadedTiles(z + 1, childTileRange);
          }
          if (!covered) {
            tileGrid.forEachTileCoordParentTileRange(
              tile.tileCoord,
              findLoadedTiles,
              tmpTileRange,
              tmpExtent
            );
          }
        }
      }
      const canvasScale = tileResolution / viewResolution * pixelRatio / tilePixelRatio;
      compose(
        this.pixelTransform,
        frameState.size[0] / 2,
        frameState.size[1] / 2,
        1 / pixelRatio,
        1 / pixelRatio,
        rotation,
        -width / 2,
        -height / 2
      );
      const canvasTransform = toString$1(this.pixelTransform);
      this.useContainer(target, canvasTransform, this.getBackground(frameState));
      const context = this.context;
      const canvas = context.canvas;
      makeInverse(this.inversePixelTransform, this.pixelTransform);
      compose(
        this.tempTransform,
        width / 2,
        height / 2,
        canvasScale,
        canvasScale,
        0,
        -width / 2,
        -height / 2
      );
      if (canvas.width != width || canvas.height != height) {
        canvas.width = width;
        canvas.height = height;
      } else if (!this.containerReused) {
        context.clearRect(0, 0, width, height);
      }
      if (layerExtent) {
        this.clipUnrotated(context, frameState, layerExtent);
      }
      if (!tileSource.getInterpolate()) {
        context.imageSmoothingEnabled = false;
      }
      this.preRender(context, frameState);
      this.renderedTiles.length = 0;
      let zs = Object.keys(tilesToDrawByZ).map(Number);
      zs.sort(ascending);
      let clips, clipZs, currentClip;
      if (layerState.opacity === 1 && (!this.containerReused || tileSource.getOpaque(frameState.viewState.projection))) {
        zs = zs.reverse();
      } else {
        clips = [];
        clipZs = [];
      }
      for (let i = zs.length - 1; i >= 0; --i) {
        const currentZ = zs[i];
        const currentTilePixelSize = tileSource.getTilePixelSize(
          currentZ,
          pixelRatio,
          projection
        );
        const currentResolution = tileGrid.getResolution(currentZ);
        const currentScale = currentResolution / tileResolution;
        const dx2 = currentTilePixelSize[0] * currentScale * canvasScale;
        const dy2 = currentTilePixelSize[1] * currentScale * canvasScale;
        const originTileCoord = tileGrid.getTileCoordForCoordAndZ(
          getTopLeft(canvasExtent),
          currentZ
        );
        const originTileExtent = tileGrid.getTileCoordExtent(originTileCoord);
        const origin = apply(this.tempTransform, [
          tilePixelRatio * (originTileExtent[0] - canvasExtent[0]) / tileResolution,
          tilePixelRatio * (canvasExtent[3] - originTileExtent[3]) / tileResolution
        ]);
        const tileGutter = tilePixelRatio * tileSource.getGutterForProjection(projection);
        const tilesToDraw = tilesToDrawByZ[currentZ];
        for (const tileCoordKey in tilesToDraw) {
          const tile = tilesToDraw[tileCoordKey];
          const tileCoord = tile.tileCoord;
          const xIndex = originTileCoord[1] - tileCoord[1];
          const nextX = Math.round(origin[0] - (xIndex - 1) * dx2);
          const yIndex = originTileCoord[2] - tileCoord[2];
          const nextY = Math.round(origin[1] - (yIndex - 1) * dy2);
          const x = Math.round(origin[0] - xIndex * dx2);
          const y2 = Math.round(origin[1] - yIndex * dy2);
          const w = nextX - x;
          const h = nextY - y2;
          const transition = z === currentZ;
          const inTransition = transition && tile.getAlpha(getUid(this), frameState.time) !== 1;
          let contextSaved = false;
          if (!inTransition) {
            if (clips) {
              currentClip = [x, y2, x + w, y2, x + w, y2 + h, x, y2 + h];
              for (let i2 = 0, ii = clips.length; i2 < ii; ++i2) {
                if (z !== currentZ && currentZ < clipZs[i2]) {
                  const clip = clips[i2];
                  if (intersects(
                    [x, y2, x + w, y2 + h],
                    [clip[0], clip[3], clip[4], clip[7]]
                  )) {
                    if (!contextSaved) {
                      context.save();
                      contextSaved = true;
                    }
                    context.beginPath();
                    context.moveTo(currentClip[0], currentClip[1]);
                    context.lineTo(currentClip[2], currentClip[3]);
                    context.lineTo(currentClip[4], currentClip[5]);
                    context.lineTo(currentClip[6], currentClip[7]);
                    context.moveTo(clip[6], clip[7]);
                    context.lineTo(clip[4], clip[5]);
                    context.lineTo(clip[2], clip[3]);
                    context.lineTo(clip[0], clip[1]);
                    context.clip();
                  }
                }
              }
              clips.push(currentClip);
              clipZs.push(currentZ);
            } else {
              context.clearRect(x, y2, w, h);
            }
          }
          this.drawTileImage(
            tile,
            frameState,
            x,
            y2,
            w,
            h,
            tileGutter,
            transition
          );
          if (clips && !inTransition) {
            if (contextSaved) {
              context.restore();
            }
            this.renderedTiles.unshift(tile);
          } else {
            this.renderedTiles.push(tile);
          }
          this.updateUsedTiles(frameState.usedTiles, tileSource, tile);
        }
      }
      this.renderedRevision = sourceRevision;
      this.renderedResolution = tileResolution;
      this.extentChanged = !this.renderedExtent_ || !equals$2(this.renderedExtent_, canvasExtent);
      this.renderedExtent_ = canvasExtent;
      this.renderedPixelRatio = pixelRatio;
      this.renderedProjection = projection;
      this.manageTilePyramid(
        frameState,
        tileSource,
        tileGrid,
        pixelRatio,
        projection,
        extent,
        z,
        tileLayer.getPreload()
      );
      this.scheduleExpireCache(frameState, tileSource);
      this.postRender(context, frameState);
      if (layerState.extent) {
        context.restore();
      }
      context.imageSmoothingEnabled = true;
      if (canvasTransform !== canvas.style.transform) {
        canvas.style.transform = canvasTransform;
      }
      return this.container;
    }
    drawTileImage(tile, frameState, x, y2, w, h, gutter, transition) {
      const image = this.getTileImage(tile);
      if (!image) {
        return;
      }
      const uid = getUid(this);
      const layerState = frameState.layerStatesArray[frameState.layerIndex];
      const alpha = layerState.opacity * (transition ? tile.getAlpha(uid, frameState.time) : 1);
      const alphaChanged = alpha !== this.context.globalAlpha;
      if (alphaChanged) {
        this.context.save();
        this.context.globalAlpha = alpha;
      }
      this.context.drawImage(
        image,
        gutter,
        gutter,
        image.width - 2 * gutter,
        image.height - 2 * gutter,
        x,
        y2,
        w,
        h
      );
      if (alphaChanged) {
        this.context.restore();
      }
      if (alpha !== layerState.opacity) {
        frameState.animate = true;
      } else if (transition) {
        tile.endTransition(uid);
      }
    }
    getImage() {
      const context = this.context;
      return context ? context.canvas : null;
    }
    getTileImage(tile) {
      return tile.getImage();
    }
    scheduleExpireCache(frameState, tileSource) {
      if (tileSource.canExpireCache()) {
        const postRenderFunction = function(tileSource2, map2, frameState2) {
          const tileSourceKey = getUid(tileSource2);
          if (tileSourceKey in frameState2.usedTiles) {
            tileSource2.expireCache(
              frameState2.viewState.projection,
              frameState2.usedTiles[tileSourceKey]
            );
          }
        }.bind(null, tileSource);
        frameState.postRenderFunctions.push(
          postRenderFunction
        );
      }
    }
    updateUsedTiles(usedTiles, tileSource, tile) {
      const tileSourceKey = getUid(tileSource);
      if (!(tileSourceKey in usedTiles)) {
        usedTiles[tileSourceKey] = {};
      }
      usedTiles[tileSourceKey][tile.getKey()] = true;
    }
    manageTilePyramid(frameState, tileSource, tileGrid, pixelRatio, projection, extent, currentZ, preload, tileCallback) {
      const tileSourceKey = getUid(tileSource);
      if (!(tileSourceKey in frameState.wantedTiles)) {
        frameState.wantedTiles[tileSourceKey] = {};
      }
      const wantedTiles = frameState.wantedTiles[tileSourceKey];
      const tileQueue = frameState.tileQueue;
      const minZoom = tileGrid.getMinZoom();
      const rotation = frameState.viewState.rotation;
      const viewport = rotation ? getRotatedViewport(
        frameState.viewState.center,
        frameState.viewState.resolution,
        rotation,
        frameState.size
      ) : void 0;
      let tileCount = 0;
      let tile, tileRange, tileResolution, x, y2, z;
      for (z = minZoom; z <= currentZ; ++z) {
        tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z, tileRange);
        tileResolution = tileGrid.getResolution(z);
        for (x = tileRange.minX; x <= tileRange.maxX; ++x) {
          for (y2 = tileRange.minY; y2 <= tileRange.maxY; ++y2) {
            if (rotation && !tileGrid.tileCoordIntersectsViewport([z, x, y2], viewport)) {
              continue;
            }
            if (currentZ - z <= preload) {
              ++tileCount;
              tile = tileSource.getTile(z, x, y2, pixelRatio, projection);
              if (tile.getState() == TileState.IDLE) {
                wantedTiles[tile.getKey()] = true;
                if (!tileQueue.isKeyQueued(tile.getKey())) {
                  tileQueue.enqueue([
                    tile,
                    tileSourceKey,
                    tileGrid.getTileCoordCenter(tile.tileCoord),
                    tileResolution
                  ]);
                }
              }
              if (tileCallback !== void 0) {
                tileCallback(tile);
              }
            } else {
              tileSource.useTile(z, x, y2, projection);
            }
          }
        }
      }
      tileSource.updateCacheSize(tileCount, projection);
    }
  }
  const CanvasTileLayerRenderer$1 = CanvasTileLayerRenderer;
  class TileLayer extends BaseTileLayer$1 {
    constructor(options) {
      super(options);
    }
    createRenderer() {
      return new CanvasTileLayerRenderer$1(this);
    }
  }
  const TileLayer$1 = TileLayer;
  class LRUCache {
    constructor(highWaterMark) {
      this.highWaterMark = highWaterMark !== void 0 ? highWaterMark : 2048;
      this.count_ = 0;
      this.entries_ = {};
      this.oldest_ = null;
      this.newest_ = null;
    }
    canExpireCache() {
      return this.highWaterMark > 0 && this.getCount() > this.highWaterMark;
    }
    expireCache(keep) {
      while (this.canExpireCache()) {
        this.pop();
      }
    }
    clear() {
      this.count_ = 0;
      this.entries_ = {};
      this.oldest_ = null;
      this.newest_ = null;
    }
    containsKey(key) {
      return this.entries_.hasOwnProperty(key);
    }
    forEach(f) {
      let entry = this.oldest_;
      while (entry) {
        f(entry.value_, entry.key_, this);
        entry = entry.newer;
      }
    }
    get(key, options) {
      const entry = this.entries_[key];
      assert(entry !== void 0, 15);
      if (entry === this.newest_) {
        return entry.value_;
      } else if (entry === this.oldest_) {
        this.oldest_ = this.oldest_.newer;
        this.oldest_.older = null;
      } else {
        entry.newer.older = entry.older;
        entry.older.newer = entry.newer;
      }
      entry.newer = null;
      entry.older = this.newest_;
      this.newest_.newer = entry;
      this.newest_ = entry;
      return entry.value_;
    }
    remove(key) {
      const entry = this.entries_[key];
      assert(entry !== void 0, 15);
      if (entry === this.newest_) {
        this.newest_ = entry.older;
        if (this.newest_) {
          this.newest_.newer = null;
        }
      } else if (entry === this.oldest_) {
        this.oldest_ = entry.newer;
        if (this.oldest_) {
          this.oldest_.older = null;
        }
      } else {
        entry.newer.older = entry.older;
        entry.older.newer = entry.newer;
      }
      delete this.entries_[key];
      --this.count_;
      return entry.value_;
    }
    getCount() {
      return this.count_;
    }
    getKeys() {
      const keys = new Array(this.count_);
      let i = 0;
      let entry;
      for (entry = this.newest_; entry; entry = entry.older) {
        keys[i++] = entry.key_;
      }
      return keys;
    }
    getValues() {
      const values = new Array(this.count_);
      let i = 0;
      let entry;
      for (entry = this.newest_; entry; entry = entry.older) {
        values[i++] = entry.value_;
      }
      return values;
    }
    peekLast() {
      return this.oldest_.value_;
    }
    peekLastKey() {
      return this.oldest_.key_;
    }
    peekFirstKey() {
      return this.newest_.key_;
    }
    peek(key) {
      if (!this.containsKey(key)) {
        return void 0;
      }
      return this.entries_[key].value_;
    }
    pop() {
      const entry = this.oldest_;
      delete this.entries_[entry.key_];
      if (entry.newer) {
        entry.newer.older = null;
      }
      this.oldest_ = entry.newer;
      if (!this.oldest_) {
        this.newest_ = null;
      }
      --this.count_;
      return entry.value_;
    }
    replace(key, value) {
      this.get(key);
      this.entries_[key].value_ = value;
    }
    set(key, value) {
      assert(!(key in this.entries_), 16);
      const entry = {
        key_: key,
        newer: null,
        older: this.newest_,
        value_: value
      };
      if (!this.newest_) {
        this.oldest_ = entry;
      } else {
        this.newest_.newer = entry;
      }
      this.newest_ = entry;
      this.entries_[key] = entry;
      ++this.count_;
    }
    setSize(size) {
      this.highWaterMark = size;
    }
  }
  const LRUCache$1 = LRUCache;
  function createOrUpdate(z, x, y2, tileCoord) {
    if (tileCoord !== void 0) {
      tileCoord[0] = z;
      tileCoord[1] = x;
      tileCoord[2] = y2;
      return tileCoord;
    }
    return [z, x, y2];
  }
  function getKeyZXY(z, x, y2) {
    return z + "/" + x + "/" + y2;
  }
  function getKey$1(tileCoord) {
    return getKeyZXY(tileCoord[0], tileCoord[1], tileCoord[2]);
  }
  function fromKey(key) {
    return key.split("/").map(Number);
  }
  function hash(tileCoord) {
    return (tileCoord[1] << tileCoord[0]) + tileCoord[2];
  }
  function withinExtentAndZ(tileCoord, tileGrid) {
    const z = tileCoord[0];
    const x = tileCoord[1];
    const y2 = tileCoord[2];
    if (tileGrid.getMinZoom() > z || z > tileGrid.getMaxZoom()) {
      return false;
    }
    const tileRange = tileGrid.getFullTileRange(z);
    if (!tileRange) {
      return true;
    }
    return tileRange.containsXY(x, y2);
  }
  class TileCache extends LRUCache$1 {
    clear() {
      while (this.getCount() > 0) {
        this.pop().release();
      }
      super.clear();
    }
    expireCache(usedTiles) {
      while (this.canExpireCache()) {
        const tile = this.peekLast();
        if (tile.getKey() in usedTiles) {
          break;
        } else {
          this.pop().release();
        }
      }
    }
    pruneExceptNewestZ() {
      if (this.getCount() === 0) {
        return;
      }
      const key = this.peekFirstKey();
      const tileCoord = fromKey(key);
      const z = tileCoord[0];
      this.forEach((tile) => {
        if (tile.tileCoord[0] !== z) {
          this.remove(getKey$1(tile.tileCoord));
          tile.release();
        }
      });
    }
  }
  const TileCache$1 = TileCache;
  const TileEventType = {
    TILELOADSTART: "tileloadstart",
    TILELOADEND: "tileloadend",
    TILELOADERROR: "tileloaderror"
  };
  class Source extends BaseObject$1 {
    constructor(options) {
      super();
      this.projection = get$2(options.projection);
      this.attributions_ = adaptAttributions(options.attributions);
      this.attributionsCollapsible_ = options.attributionsCollapsible !== void 0 ? options.attributionsCollapsible : true;
      this.loading = false;
      this.state_ = options.state !== void 0 ? options.state : "ready";
      this.wrapX_ = options.wrapX !== void 0 ? options.wrapX : false;
      this.interpolate_ = !!options.interpolate;
      this.viewResolver = null;
      this.viewRejector = null;
      const self2 = this;
      this.viewPromise_ = new Promise(function(resolve, reject) {
        self2.viewResolver = resolve;
        self2.viewRejector = reject;
      });
    }
    getAttributions() {
      return this.attributions_;
    }
    getAttributionsCollapsible() {
      return this.attributionsCollapsible_;
    }
    getProjection() {
      return this.projection;
    }
    getResolutions(projection) {
      return null;
    }
    getView() {
      return this.viewPromise_;
    }
    getState() {
      return this.state_;
    }
    getWrapX() {
      return this.wrapX_;
    }
    getInterpolate() {
      return this.interpolate_;
    }
    refresh() {
      this.changed();
    }
    setAttributions(attributions) {
      this.attributions_ = adaptAttributions(attributions);
      this.changed();
    }
    setState(state) {
      this.state_ = state;
      this.changed();
    }
  }
  function adaptAttributions(attributionLike) {
    if (!attributionLike) {
      return null;
    }
    if (Array.isArray(attributionLike)) {
      return function(frameState) {
        return attributionLike;
      };
    }
    if (typeof attributionLike === "function") {
      return attributionLike;
    }
    return function(frameState) {
      return [attributionLike];
    };
  }
  const Source$1 = Source;
  const tmpTileCoord = [0, 0, 0];
  const DECIMALS$1 = 5;
  class TileGrid {
    constructor(options) {
      this.minZoom = options.minZoom !== void 0 ? options.minZoom : 0;
      this.resolutions_ = options.resolutions;
      assert(
        isSorted(
          this.resolutions_,
          function(a, b) {
            return b - a;
          },
          true
        ),
        17
      );
      let zoomFactor;
      if (!options.origins) {
        for (let i = 0, ii = this.resolutions_.length - 1; i < ii; ++i) {
          if (!zoomFactor) {
            zoomFactor = this.resolutions_[i] / this.resolutions_[i + 1];
          } else {
            if (this.resolutions_[i] / this.resolutions_[i + 1] !== zoomFactor) {
              zoomFactor = void 0;
              break;
            }
          }
        }
      }
      this.zoomFactor_ = zoomFactor;
      this.maxZoom = this.resolutions_.length - 1;
      this.origin_ = options.origin !== void 0 ? options.origin : null;
      this.origins_ = null;
      if (options.origins !== void 0) {
        this.origins_ = options.origins;
        assert(this.origins_.length == this.resolutions_.length, 20);
      }
      const extent = options.extent;
      if (extent !== void 0 && !this.origin_ && !this.origins_) {
        this.origin_ = getTopLeft(extent);
      }
      assert(
        !this.origin_ && this.origins_ || this.origin_ && !this.origins_,
        18
      );
      this.tileSizes_ = null;
      if (options.tileSizes !== void 0) {
        this.tileSizes_ = options.tileSizes;
        assert(this.tileSizes_.length == this.resolutions_.length, 19);
      }
      this.tileSize_ = options.tileSize !== void 0 ? options.tileSize : !this.tileSizes_ ? DEFAULT_TILE_SIZE : null;
      assert(
        !this.tileSize_ && this.tileSizes_ || this.tileSize_ && !this.tileSizes_,
        22
      );
      this.extent_ = extent !== void 0 ? extent : null;
      this.fullTileRanges_ = null;
      this.tmpSize_ = [0, 0];
      this.tmpExtent_ = [0, 0, 0, 0];
      if (options.sizes !== void 0) {
        this.fullTileRanges_ = options.sizes.map(function(size, z) {
          const tileRange = new TileRange$1(
            Math.min(0, size[0]),
            Math.max(size[0] - 1, -1),
            Math.min(0, size[1]),
            Math.max(size[1] - 1, -1)
          );
          if (extent) {
            const restrictedTileRange = this.getTileRangeForExtentAndZ(extent, z);
            tileRange.minX = Math.max(restrictedTileRange.minX, tileRange.minX);
            tileRange.maxX = Math.min(restrictedTileRange.maxX, tileRange.maxX);
            tileRange.minY = Math.max(restrictedTileRange.minY, tileRange.minY);
            tileRange.maxY = Math.min(restrictedTileRange.maxY, tileRange.maxY);
          }
          return tileRange;
        }, this);
      } else if (extent) {
        this.calculateTileRanges_(extent);
      }
    }
    forEachTileCoord(extent, zoom, callback) {
      const tileRange = this.getTileRangeForExtentAndZ(extent, zoom);
      for (let i = tileRange.minX, ii = tileRange.maxX; i <= ii; ++i) {
        for (let j = tileRange.minY, jj = tileRange.maxY; j <= jj; ++j) {
          callback([zoom, i, j]);
        }
      }
    }
    forEachTileCoordParentTileRange(tileCoord, callback, tempTileRange, tempExtent) {
      let tileRange, x, y2;
      let tileCoordExtent = null;
      let z = tileCoord[0] - 1;
      if (this.zoomFactor_ === 2) {
        x = tileCoord[1];
        y2 = tileCoord[2];
      } else {
        tileCoordExtent = this.getTileCoordExtent(tileCoord, tempExtent);
      }
      while (z >= this.minZoom) {
        if (this.zoomFactor_ === 2) {
          x = Math.floor(x / 2);
          y2 = Math.floor(y2 / 2);
          tileRange = createOrUpdate$1(x, x, y2, y2, tempTileRange);
        } else {
          tileRange = this.getTileRangeForExtentAndZ(
            tileCoordExtent,
            z,
            tempTileRange
          );
        }
        if (callback(z, tileRange)) {
          return true;
        }
        --z;
      }
      return false;
    }
    getExtent() {
      return this.extent_;
    }
    getMaxZoom() {
      return this.maxZoom;
    }
    getMinZoom() {
      return this.minZoom;
    }
    getOrigin(z) {
      if (this.origin_) {
        return this.origin_;
      }
      return this.origins_[z];
    }
    getResolution(z) {
      return this.resolutions_[z];
    }
    getResolutions() {
      return this.resolutions_;
    }
    getTileCoordChildTileRange(tileCoord, tempTileRange, tempExtent) {
      if (tileCoord[0] < this.maxZoom) {
        if (this.zoomFactor_ === 2) {
          const minX = tileCoord[1] * 2;
          const minY = tileCoord[2] * 2;
          return createOrUpdate$1(
            minX,
            minX + 1,
            minY,
            minY + 1,
            tempTileRange
          );
        }
        const tileCoordExtent = this.getTileCoordExtent(
          tileCoord,
          tempExtent || this.tmpExtent_
        );
        return this.getTileRangeForExtentAndZ(
          tileCoordExtent,
          tileCoord[0] + 1,
          tempTileRange
        );
      }
      return null;
    }
    getTileRangeForTileCoordAndZ(tileCoord, z, tempTileRange) {
      if (z > this.maxZoom || z < this.minZoom) {
        return null;
      }
      const tileCoordZ = tileCoord[0];
      const tileCoordX = tileCoord[1];
      const tileCoordY = tileCoord[2];
      if (z === tileCoordZ) {
        return createOrUpdate$1(
          tileCoordX,
          tileCoordY,
          tileCoordX,
          tileCoordY,
          tempTileRange
        );
      }
      if (this.zoomFactor_) {
        const factor = Math.pow(this.zoomFactor_, z - tileCoordZ);
        const minX = Math.floor(tileCoordX * factor);
        const minY = Math.floor(tileCoordY * factor);
        if (z < tileCoordZ) {
          return createOrUpdate$1(minX, minX, minY, minY, tempTileRange);
        }
        const maxX = Math.floor(factor * (tileCoordX + 1)) - 1;
        const maxY = Math.floor(factor * (tileCoordY + 1)) - 1;
        return createOrUpdate$1(minX, maxX, minY, maxY, tempTileRange);
      }
      const tileCoordExtent = this.getTileCoordExtent(tileCoord, this.tmpExtent_);
      return this.getTileRangeForExtentAndZ(tileCoordExtent, z, tempTileRange);
    }
    getTileRangeExtent(z, tileRange, tempExtent) {
      const origin = this.getOrigin(z);
      const resolution = this.getResolution(z);
      const tileSize = toSize(this.getTileSize(z), this.tmpSize_);
      const minX = origin[0] + tileRange.minX * tileSize[0] * resolution;
      const maxX = origin[0] + (tileRange.maxX + 1) * tileSize[0] * resolution;
      const minY = origin[1] + tileRange.minY * tileSize[1] * resolution;
      const maxY = origin[1] + (tileRange.maxY + 1) * tileSize[1] * resolution;
      return createOrUpdate$2(minX, minY, maxX, maxY, tempExtent);
    }
    getTileRangeForExtentAndZ(extent, z, tempTileRange) {
      this.getTileCoordForXYAndZ_(extent[0], extent[3], z, false, tmpTileCoord);
      const minX = tmpTileCoord[1];
      const minY = tmpTileCoord[2];
      this.getTileCoordForXYAndZ_(extent[2], extent[1], z, true, tmpTileCoord);
      const maxX = tmpTileCoord[1];
      const maxY = tmpTileCoord[2];
      return createOrUpdate$1(minX, maxX, minY, maxY, tempTileRange);
    }
    getTileCoordCenter(tileCoord) {
      const origin = this.getOrigin(tileCoord[0]);
      const resolution = this.getResolution(tileCoord[0]);
      const tileSize = toSize(this.getTileSize(tileCoord[0]), this.tmpSize_);
      return [
        origin[0] + (tileCoord[1] + 0.5) * tileSize[0] * resolution,
        origin[1] - (tileCoord[2] + 0.5) * tileSize[1] * resolution
      ];
    }
    getTileCoordExtent(tileCoord, tempExtent) {
      const origin = this.getOrigin(tileCoord[0]);
      const resolution = this.getResolution(tileCoord[0]);
      const tileSize = toSize(this.getTileSize(tileCoord[0]), this.tmpSize_);
      const minX = origin[0] + tileCoord[1] * tileSize[0] * resolution;
      const minY = origin[1] - (tileCoord[2] + 1) * tileSize[1] * resolution;
      const maxX = minX + tileSize[0] * resolution;
      const maxY = minY + tileSize[1] * resolution;
      return createOrUpdate$2(minX, minY, maxX, maxY, tempExtent);
    }
    getTileCoordForCoordAndResolution(coordinate, resolution, opt_tileCoord) {
      return this.getTileCoordForXYAndResolution_(
        coordinate[0],
        coordinate[1],
        resolution,
        false,
        opt_tileCoord
      );
    }
    getTileCoordForXYAndResolution_(x, y2, resolution, reverseIntersectionPolicy, opt_tileCoord) {
      const z = this.getZForResolution(resolution);
      const scale2 = resolution / this.getResolution(z);
      const origin = this.getOrigin(z);
      const tileSize = toSize(this.getTileSize(z), this.tmpSize_);
      let tileCoordX = scale2 * (x - origin[0]) / resolution / tileSize[0];
      let tileCoordY = scale2 * (origin[1] - y2) / resolution / tileSize[1];
      if (reverseIntersectionPolicy) {
        tileCoordX = ceil(tileCoordX, DECIMALS$1) - 1;
        tileCoordY = ceil(tileCoordY, DECIMALS$1) - 1;
      } else {
        tileCoordX = floor(tileCoordX, DECIMALS$1);
        tileCoordY = floor(tileCoordY, DECIMALS$1);
      }
      return createOrUpdate(z, tileCoordX, tileCoordY, opt_tileCoord);
    }
    getTileCoordForXYAndZ_(x, y2, z, reverseIntersectionPolicy, opt_tileCoord) {
      const origin = this.getOrigin(z);
      const resolution = this.getResolution(z);
      const tileSize = toSize(this.getTileSize(z), this.tmpSize_);
      let tileCoordX = (x - origin[0]) / resolution / tileSize[0];
      let tileCoordY = (origin[1] - y2) / resolution / tileSize[1];
      if (reverseIntersectionPolicy) {
        tileCoordX = ceil(tileCoordX, DECIMALS$1) - 1;
        tileCoordY = ceil(tileCoordY, DECIMALS$1) - 1;
      } else {
        tileCoordX = floor(tileCoordX, DECIMALS$1);
        tileCoordY = floor(tileCoordY, DECIMALS$1);
      }
      return createOrUpdate(z, tileCoordX, tileCoordY, opt_tileCoord);
    }
    getTileCoordForCoordAndZ(coordinate, z, opt_tileCoord) {
      return this.getTileCoordForXYAndZ_(
        coordinate[0],
        coordinate[1],
        z,
        false,
        opt_tileCoord
      );
    }
    getTileCoordResolution(tileCoord) {
      return this.resolutions_[tileCoord[0]];
    }
    getTileSize(z) {
      if (this.tileSize_) {
        return this.tileSize_;
      }
      return this.tileSizes_[z];
    }
    getFullTileRange(z) {
      if (!this.fullTileRanges_) {
        return this.extent_ ? this.getTileRangeForExtentAndZ(this.extent_, z) : null;
      }
      return this.fullTileRanges_[z];
    }
    getZForResolution(resolution, opt_direction) {
      const z = linearFindNearest(
        this.resolutions_,
        resolution,
        opt_direction || 0
      );
      return clamp(z, this.minZoom, this.maxZoom);
    }
    tileCoordIntersectsViewport(tileCoord, viewport) {
      return intersectsLinearRing(
        viewport,
        0,
        viewport.length,
        2,
        this.getTileCoordExtent(tileCoord)
      );
    }
    calculateTileRanges_(extent) {
      const length = this.resolutions_.length;
      const fullTileRanges = new Array(length);
      for (let z = this.minZoom; z < length; ++z) {
        fullTileRanges[z] = this.getTileRangeForExtentAndZ(extent, z);
      }
      this.fullTileRanges_ = fullTileRanges;
    }
  }
  const TileGrid$1 = TileGrid;
  function getForProjection(projection) {
    let tileGrid = projection.getDefaultTileGrid();
    if (!tileGrid) {
      tileGrid = createForProjection(projection);
      projection.setDefaultTileGrid(tileGrid);
    }
    return tileGrid;
  }
  function wrapX(tileGrid, tileCoord, projection) {
    const z = tileCoord[0];
    const center = tileGrid.getTileCoordCenter(tileCoord);
    const projectionExtent = extentFromProjection(projection);
    if (!containsCoordinate(projectionExtent, center)) {
      const worldWidth = getWidth(projectionExtent);
      const worldsAway = Math.ceil(
        (projectionExtent[0] - center[0]) / worldWidth
      );
      center[0] += worldWidth * worldsAway;
      return tileGrid.getTileCoordForCoordAndZ(center, z);
    }
    return tileCoord;
  }
  function createForExtent(extent, maxZoom, tileSize, corner) {
    corner = corner !== void 0 ? corner : "top-left";
    const resolutions = resolutionsFromExtent(extent, maxZoom, tileSize);
    return new TileGrid$1({
      extent,
      origin: getCorner(extent, corner),
      resolutions,
      tileSize
    });
  }
  function resolutionsFromExtent(extent, maxZoom, tileSize, maxResolution) {
    maxZoom = maxZoom !== void 0 ? maxZoom : DEFAULT_MAX_ZOOM;
    tileSize = toSize(tileSize !== void 0 ? tileSize : DEFAULT_TILE_SIZE);
    const height = getHeight(extent);
    const width = getWidth(extent);
    maxResolution = maxResolution > 0 ? maxResolution : Math.max(width / tileSize[0], height / tileSize[1]);
    const length = maxZoom + 1;
    const resolutions = new Array(length);
    for (let z = 0; z < length; ++z) {
      resolutions[z] = maxResolution / Math.pow(2, z);
    }
    return resolutions;
  }
  function createForProjection(projection, maxZoom, tileSize, corner) {
    const extent = extentFromProjection(projection);
    return createForExtent(extent, maxZoom, tileSize, corner);
  }
  function extentFromProjection(projection) {
    projection = get$2(projection);
    let extent = projection.getExtent();
    if (!extent) {
      const half = 180 * METERS_PER_UNIT$1.degrees / projection.getMetersPerUnit();
      extent = createOrUpdate$2(-half, -half, half, half);
    }
    return extent;
  }
  class TileSource extends Source$1 {
    constructor(options) {
      super({
        attributions: options.attributions,
        attributionsCollapsible: options.attributionsCollapsible,
        projection: options.projection,
        state: options.state,
        wrapX: options.wrapX,
        interpolate: options.interpolate
      });
      this.on;
      this.once;
      this.un;
      this.opaque_ = options.opaque !== void 0 ? options.opaque : false;
      this.tilePixelRatio_ = options.tilePixelRatio !== void 0 ? options.tilePixelRatio : 1;
      this.tileGrid = options.tileGrid !== void 0 ? options.tileGrid : null;
      const tileSize = [256, 256];
      if (this.tileGrid) {
        toSize(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()), tileSize);
      }
      this.tileCache = new TileCache$1(options.cacheSize || 0);
      this.tmpSize = [0, 0];
      this.key_ = options.key || "";
      this.tileOptions = {
        transition: options.transition,
        interpolate: options.interpolate
      };
      this.zDirection = options.zDirection ? options.zDirection : 0;
    }
    canExpireCache() {
      return this.tileCache.canExpireCache();
    }
    expireCache(projection, usedTiles) {
      const tileCache = this.getTileCacheForProjection(projection);
      if (tileCache) {
        tileCache.expireCache(usedTiles);
      }
    }
    forEachLoadedTile(projection, z, tileRange, callback) {
      const tileCache = this.getTileCacheForProjection(projection);
      if (!tileCache) {
        return false;
      }
      let covered = true;
      let tile, tileCoordKey, loaded;
      for (let x = tileRange.minX; x <= tileRange.maxX; ++x) {
        for (let y2 = tileRange.minY; y2 <= tileRange.maxY; ++y2) {
          tileCoordKey = getKeyZXY(z, x, y2);
          loaded = false;
          if (tileCache.containsKey(tileCoordKey)) {
            tile = tileCache.get(tileCoordKey);
            loaded = tile.getState() === TileState.LOADED;
            if (loaded) {
              loaded = callback(tile) !== false;
            }
          }
          if (!loaded) {
            covered = false;
          }
        }
      }
      return covered;
    }
    getGutterForProjection(projection) {
      return 0;
    }
    getKey() {
      return this.key_;
    }
    setKey(key) {
      if (this.key_ !== key) {
        this.key_ = key;
        this.changed();
      }
    }
    getOpaque(projection) {
      return this.opaque_;
    }
    getResolutions(projection) {
      const tileGrid = projection ? this.getTileGridForProjection(projection) : this.tileGrid;
      if (!tileGrid) {
        return null;
      }
      return tileGrid.getResolutions();
    }
    getTile(z, x, y2, pixelRatio, projection) {
      return abstract();
    }
    getTileGrid() {
      return this.tileGrid;
    }
    getTileGridForProjection(projection) {
      if (!this.tileGrid) {
        return getForProjection(projection);
      }
      return this.tileGrid;
    }
    getTileCacheForProjection(projection) {
      const sourceProjection = this.getProjection();
      assert(
        sourceProjection === null || equivalent(sourceProjection, projection),
        68
      );
      return this.tileCache;
    }
    getTilePixelRatio(pixelRatio) {
      return this.tilePixelRatio_;
    }
    getTilePixelSize(z, pixelRatio, projection) {
      const tileGrid = this.getTileGridForProjection(projection);
      const tilePixelRatio = this.getTilePixelRatio(pixelRatio);
      const tileSize = toSize(tileGrid.getTileSize(z), this.tmpSize);
      if (tilePixelRatio == 1) {
        return tileSize;
      }
      return scale(tileSize, tilePixelRatio, this.tmpSize);
    }
    getTileCoordForTileUrlFunction(tileCoord, projection) {
      projection = projection !== void 0 ? projection : this.getProjection();
      const tileGrid = this.getTileGridForProjection(projection);
      if (this.getWrapX() && projection.isGlobal()) {
        tileCoord = wrapX(tileGrid, tileCoord, projection);
      }
      return withinExtentAndZ(tileCoord, tileGrid) ? tileCoord : null;
    }
    clear() {
      this.tileCache.clear();
    }
    refresh() {
      this.clear();
      super.refresh();
    }
    updateCacheSize(tileCount, projection) {
      const tileCache = this.getTileCacheForProjection(projection);
      if (tileCount > tileCache.highWaterMark) {
        tileCache.highWaterMark = tileCount;
      }
    }
    useTile(z, x, y2, projection) {
    }
  }
  class TileSourceEvent extends Event {
    constructor(type, tile) {
      super(type);
      this.tile = tile;
    }
  }
  const TileSource$1 = TileSource;
  function createFromTemplate(template, tileGrid) {
    const zRegEx = /\{z\}/g;
    const xRegEx = /\{x\}/g;
    const yRegEx = /\{y\}/g;
    const dashYRegEx = /\{-y\}/g;
    return function(tileCoord, pixelRatio, projection) {
      if (!tileCoord) {
        return void 0;
      }
      return template.replace(zRegEx, tileCoord[0].toString()).replace(xRegEx, tileCoord[1].toString()).replace(yRegEx, tileCoord[2].toString()).replace(dashYRegEx, function() {
        const z = tileCoord[0];
        const range = tileGrid.getFullTileRange(z);
        assert(range, 55);
        const y2 = range.getHeight() - tileCoord[2] - 1;
        return y2.toString();
      });
    };
  }
  function createFromTemplates(templates, tileGrid) {
    const len = templates.length;
    const tileUrlFunctions = new Array(len);
    for (let i = 0; i < len; ++i) {
      tileUrlFunctions[i] = createFromTemplate(templates[i], tileGrid);
    }
    return createFromTileUrlFunctions(tileUrlFunctions);
  }
  function createFromTileUrlFunctions(tileUrlFunctions) {
    if (tileUrlFunctions.length === 1) {
      return tileUrlFunctions[0];
    }
    return function(tileCoord, pixelRatio, projection) {
      if (!tileCoord) {
        return void 0;
      }
      const h = hash(tileCoord);
      const index2 = modulo(h, tileUrlFunctions.length);
      return tileUrlFunctions[index2](tileCoord, pixelRatio, projection);
    };
  }
  function expandUrl(url) {
    const urls = [];
    let match2 = /\{([a-z])-([a-z])\}/.exec(url);
    if (match2) {
      const startCharCode = match2[1].charCodeAt(0);
      const stopCharCode = match2[2].charCodeAt(0);
      let charCode;
      for (charCode = startCharCode; charCode <= stopCharCode; ++charCode) {
        urls.push(url.replace(match2[0], String.fromCharCode(charCode)));
      }
      return urls;
    }
    match2 = /\{(\d+)-(\d+)\}/.exec(url);
    if (match2) {
      const stop = parseInt(match2[2], 10);
      for (let i = parseInt(match2[1], 10); i <= stop; i++) {
        urls.push(url.replace(match2[0], i.toString()));
      }
      return urls;
    }
    urls.push(url);
    return urls;
  }
  class UrlTile extends TileSource$1 {
    constructor(options) {
      super({
        attributions: options.attributions,
        cacheSize: options.cacheSize,
        opaque: options.opaque,
        projection: options.projection,
        state: options.state,
        tileGrid: options.tileGrid,
        tilePixelRatio: options.tilePixelRatio,
        wrapX: options.wrapX,
        transition: options.transition,
        interpolate: options.interpolate,
        key: options.key,
        attributionsCollapsible: options.attributionsCollapsible,
        zDirection: options.zDirection
      });
      this.generateTileUrlFunction_ = this.tileUrlFunction === UrlTile.prototype.tileUrlFunction;
      this.tileLoadFunction = options.tileLoadFunction;
      if (options.tileUrlFunction) {
        this.tileUrlFunction = options.tileUrlFunction;
      }
      this.urls = null;
      if (options.urls) {
        this.setUrls(options.urls);
      } else if (options.url) {
        this.setUrl(options.url);
      }
      this.tileLoadingKeys_ = {};
    }
    getTileLoadFunction() {
      return this.tileLoadFunction;
    }
    getTileUrlFunction() {
      return Object.getPrototypeOf(this).tileUrlFunction === this.tileUrlFunction ? this.tileUrlFunction.bind(this) : this.tileUrlFunction;
    }
    getUrls() {
      return this.urls;
    }
    handleTileChange(event) {
      const tile = event.target;
      const uid = getUid(tile);
      const tileState = tile.getState();
      let type;
      if (tileState == TileState.LOADING) {
        this.tileLoadingKeys_[uid] = true;
        type = TileEventType.TILELOADSTART;
      } else if (uid in this.tileLoadingKeys_) {
        delete this.tileLoadingKeys_[uid];
        type = tileState == TileState.ERROR ? TileEventType.TILELOADERROR : tileState == TileState.LOADED ? TileEventType.TILELOADEND : void 0;
      }
      if (type != void 0) {
        this.dispatchEvent(new TileSourceEvent(type, tile));
      }
    }
    setTileLoadFunction(tileLoadFunction) {
      this.tileCache.clear();
      this.tileLoadFunction = tileLoadFunction;
      this.changed();
    }
    setTileUrlFunction(tileUrlFunction, key) {
      this.tileUrlFunction = tileUrlFunction;
      this.tileCache.pruneExceptNewestZ();
      if (typeof key !== "undefined") {
        this.setKey(key);
      } else {
        this.changed();
      }
    }
    setUrl(url) {
      const urls = expandUrl(url);
      this.urls = urls;
      this.setUrls(urls);
    }
    setUrls(urls) {
      this.urls = urls;
      const key = urls.join("\n");
      if (this.generateTileUrlFunction_) {
        this.setTileUrlFunction(createFromTemplates(urls, this.tileGrid), key);
      } else {
        this.setKey(key);
      }
    }
    tileUrlFunction(tileCoord, pixelRatio, projection) {
      return void 0;
    }
    useTile(z, x, y2) {
      const tileCoordKey = getKeyZXY(z, x, y2);
      if (this.tileCache.containsKey(tileCoordKey)) {
        this.tileCache.get(tileCoordKey);
      }
    }
  }
  const UrlTile$1 = UrlTile;
  class TileImage extends UrlTile$1 {
    constructor(options) {
      super({
        attributions: options.attributions,
        cacheSize: options.cacheSize,
        opaque: options.opaque,
        projection: options.projection,
        state: options.state,
        tileGrid: options.tileGrid,
        tileLoadFunction: options.tileLoadFunction ? options.tileLoadFunction : defaultTileLoadFunction,
        tilePixelRatio: options.tilePixelRatio,
        tileUrlFunction: options.tileUrlFunction,
        url: options.url,
        urls: options.urls,
        wrapX: options.wrapX,
        transition: options.transition,
        interpolate: options.interpolate !== void 0 ? options.interpolate : true,
        key: options.key,
        attributionsCollapsible: options.attributionsCollapsible,
        zDirection: options.zDirection
      });
      this.crossOrigin = options.crossOrigin !== void 0 ? options.crossOrigin : null;
      this.tileClass = options.tileClass !== void 0 ? options.tileClass : ImageTile$1;
      this.tileCacheForProjection = {};
      this.tileGridForProjection = {};
      this.reprojectionErrorThreshold_ = options.reprojectionErrorThreshold;
      this.renderReprojectionEdges_ = false;
    }
    canExpireCache() {
      if (this.tileCache.canExpireCache()) {
        return true;
      }
      for (const key in this.tileCacheForProjection) {
        if (this.tileCacheForProjection[key].canExpireCache()) {
          return true;
        }
      }
      return false;
    }
    expireCache(projection, usedTiles) {
      const usedTileCache = this.getTileCacheForProjection(projection);
      this.tileCache.expireCache(
        this.tileCache == usedTileCache ? usedTiles : {}
      );
      for (const id in this.tileCacheForProjection) {
        const tileCache = this.tileCacheForProjection[id];
        tileCache.expireCache(tileCache == usedTileCache ? usedTiles : {});
      }
    }
    getGutterForProjection(projection) {
      if (this.getProjection() && projection && !equivalent(this.getProjection(), projection)) {
        return 0;
      }
      return this.getGutter();
    }
    getGutter() {
      return 0;
    }
    getKey() {
      let key = super.getKey();
      if (!this.getInterpolate()) {
        key += ":disable-interpolation";
      }
      return key;
    }
    getOpaque(projection) {
      if (this.getProjection() && projection && !equivalent(this.getProjection(), projection)) {
        return false;
      }
      return super.getOpaque(projection);
    }
    getTileGridForProjection(projection) {
      const thisProj = this.getProjection();
      if (this.tileGrid && (!thisProj || equivalent(thisProj, projection))) {
        return this.tileGrid;
      }
      const projKey = getUid(projection);
      if (!(projKey in this.tileGridForProjection)) {
        this.tileGridForProjection[projKey] = getForProjection(projection);
      }
      return this.tileGridForProjection[projKey];
    }
    getTileCacheForProjection(projection) {
      const thisProj = this.getProjection();
      if (!thisProj || equivalent(thisProj, projection)) {
        return this.tileCache;
      }
      const projKey = getUid(projection);
      if (!(projKey in this.tileCacheForProjection)) {
        this.tileCacheForProjection[projKey] = new TileCache$1(
          this.tileCache.highWaterMark
        );
      }
      return this.tileCacheForProjection[projKey];
    }
    createTile_(z, x, y2, pixelRatio, projection, key) {
      const tileCoord = [z, x, y2];
      const urlTileCoord = this.getTileCoordForTileUrlFunction(
        tileCoord,
        projection
      );
      const tileUrl = urlTileCoord ? this.tileUrlFunction(urlTileCoord, pixelRatio, projection) : void 0;
      const tile = new this.tileClass(
        tileCoord,
        tileUrl !== void 0 ? TileState.IDLE : TileState.EMPTY,
        tileUrl !== void 0 ? tileUrl : "",
        this.crossOrigin,
        this.tileLoadFunction,
        this.tileOptions
      );
      tile.key = key;
      tile.addEventListener(EventType.CHANGE, this.handleTileChange.bind(this));
      return tile;
    }
    getTile(z, x, y2, pixelRatio, projection) {
      const sourceProjection = this.getProjection();
      if (!sourceProjection || !projection || equivalent(sourceProjection, projection)) {
        return this.getTileInternal(
          z,
          x,
          y2,
          pixelRatio,
          sourceProjection || projection
        );
      }
      const cache2 = this.getTileCacheForProjection(projection);
      const tileCoord = [z, x, y2];
      let tile;
      const tileCoordKey = getKey$1(tileCoord);
      if (cache2.containsKey(tileCoordKey)) {
        tile = cache2.get(tileCoordKey);
      }
      const key = this.getKey();
      if (tile && tile.key == key) {
        return tile;
      }
      const sourceTileGrid = this.getTileGridForProjection(sourceProjection);
      const targetTileGrid = this.getTileGridForProjection(projection);
      const wrappedTileCoord = this.getTileCoordForTileUrlFunction(
        tileCoord,
        projection
      );
      const newTile = new ReprojTile$1(
        sourceProjection,
        sourceTileGrid,
        projection,
        targetTileGrid,
        tileCoord,
        wrappedTileCoord,
        this.getTilePixelRatio(pixelRatio),
        this.getGutter(),
        (z2, x2, y3, pixelRatio2) => this.getTileInternal(z2, x2, y3, pixelRatio2, sourceProjection),
        this.reprojectionErrorThreshold_,
        this.renderReprojectionEdges_,
        this.getInterpolate()
      );
      newTile.key = key;
      if (tile) {
        newTile.interimTile = tile;
        newTile.refreshInterimChain();
        cache2.replace(tileCoordKey, newTile);
      } else {
        cache2.set(tileCoordKey, newTile);
      }
      return newTile;
    }
    getTileInternal(z, x, y2, pixelRatio, projection) {
      let tile = null;
      const tileCoordKey = getKeyZXY(z, x, y2);
      const key = this.getKey();
      if (!this.tileCache.containsKey(tileCoordKey)) {
        tile = this.createTile_(z, x, y2, pixelRatio, projection, key);
        this.tileCache.set(tileCoordKey, tile);
      } else {
        tile = this.tileCache.get(tileCoordKey);
        if (tile.key != key) {
          const interimTile = tile;
          tile = this.createTile_(z, x, y2, pixelRatio, projection, key);
          if (interimTile.getState() == TileState.IDLE) {
            tile.interimTile = interimTile.interimTile;
          } else {
            tile.interimTile = interimTile;
          }
          tile.refreshInterimChain();
          this.tileCache.replace(tileCoordKey, tile);
        }
      }
      return tile;
    }
    setRenderReprojectionEdges(render2) {
      if (this.renderReprojectionEdges_ == render2) {
        return;
      }
      this.renderReprojectionEdges_ = render2;
      for (const id in this.tileCacheForProjection) {
        this.tileCacheForProjection[id].clear();
      }
      this.changed();
    }
    setTileGridForProjection(projection, tilegrid) {
      const proj = get$2(projection);
      if (proj) {
        const projKey = getUid(proj);
        if (!(projKey in this.tileGridForProjection)) {
          this.tileGridForProjection[projKey] = tilegrid;
        }
      }
    }
    clear() {
      super.clear();
      for (const id in this.tileCacheForProjection) {
        this.tileCacheForProjection[id].clear();
      }
    }
  }
  function defaultTileLoadFunction(imageTile, src2) {
    imageTile.getImage().src = src2;
  }
  const TileImage$1 = TileImage;
  const CollectionEventType = {
    ADD: "add",
    REMOVE: "remove"
  };
  const Property$1 = {
    LENGTH: "length"
  };
  class CollectionEvent extends Event {
    constructor(type, element, index2) {
      super(type);
      this.element = element;
      this.index = index2;
    }
  }
  class Collection extends BaseObject$1 {
    constructor(array, options) {
      super();
      this.on;
      this.once;
      this.un;
      options = options || {};
      this.unique_ = !!options.unique;
      this.array_ = array ? array : [];
      if (this.unique_) {
        for (let i = 0, ii = this.array_.length; i < ii; ++i) {
          this.assertUnique_(this.array_[i], i);
        }
      }
      this.updateLength_();
    }
    clear() {
      while (this.getLength() > 0) {
        this.pop();
      }
    }
    extend(arr2) {
      for (let i = 0, ii = arr2.length; i < ii; ++i) {
        this.push(arr2[i]);
      }
      return this;
    }
    forEach(f) {
      const array = this.array_;
      for (let i = 0, ii = array.length; i < ii; ++i) {
        f(array[i], i, array);
      }
    }
    getArray() {
      return this.array_;
    }
    item(index2) {
      return this.array_[index2];
    }
    getLength() {
      return this.get(Property$1.LENGTH);
    }
    insertAt(index2, elem) {
      if (index2 < 0 || index2 > this.getLength()) {
        throw new Error("Index out of bounds: " + index2);
      }
      if (this.unique_) {
        this.assertUnique_(elem);
      }
      this.array_.splice(index2, 0, elem);
      this.updateLength_();
      this.dispatchEvent(
        new CollectionEvent(CollectionEventType.ADD, elem, index2)
      );
    }
    pop() {
      return this.removeAt(this.getLength() - 1);
    }
    push(elem) {
      if (this.unique_) {
        this.assertUnique_(elem);
      }
      const n = this.getLength();
      this.insertAt(n, elem);
      return this.getLength();
    }
    remove(elem) {
      const arr2 = this.array_;
      for (let i = 0, ii = arr2.length; i < ii; ++i) {
        if (arr2[i] === elem) {
          return this.removeAt(i);
        }
      }
      return void 0;
    }
    removeAt(index2) {
      if (index2 < 0 || index2 >= this.getLength()) {
        return void 0;
      }
      const prev = this.array_[index2];
      this.array_.splice(index2, 1);
      this.updateLength_();
      this.dispatchEvent(
        new CollectionEvent(CollectionEventType.REMOVE, prev, index2)
      );
      return prev;
    }
    setAt(index2, elem) {
      const n = this.getLength();
      if (index2 >= n) {
        this.insertAt(index2, elem);
        return;
      }
      if (index2 < 0) {
        throw new Error("Index out of bounds: " + index2);
      }
      if (this.unique_) {
        this.assertUnique_(elem, index2);
      }
      const prev = this.array_[index2];
      this.array_[index2] = elem;
      this.dispatchEvent(
        new CollectionEvent(CollectionEventType.REMOVE, prev, index2)
      );
      this.dispatchEvent(
        new CollectionEvent(CollectionEventType.ADD, elem, index2)
      );
    }
    updateLength_() {
      this.set(Property$1.LENGTH, this.array_.length);
    }
    assertUnique_(elem, except) {
      for (let i = 0, ii = this.array_.length; i < ii; ++i) {
        if (this.array_[i] === elem && i !== except) {
          throw new AssertionError$1(58);
        }
      }
    }
  }
  const Collection$1 = Collection;
  class ReprojImage extends ImageBase$1 {
    constructor(sourceProj, targetProj, targetExtent, targetResolution, pixelRatio, getImageFunction, interpolate) {
      const maxSourceExtent = sourceProj.getExtent();
      const maxTargetExtent = targetProj.getExtent();
      const limitedTargetExtent = maxTargetExtent ? getIntersection(targetExtent, maxTargetExtent) : targetExtent;
      const targetCenter = getCenter(limitedTargetExtent);
      const sourceResolution = calculateSourceResolution(
        sourceProj,
        targetProj,
        targetCenter,
        targetResolution
      );
      const errorThresholdInPixels = ERROR_THRESHOLD;
      const triangulation = new Triangulation$1(
        sourceProj,
        targetProj,
        limitedTargetExtent,
        maxSourceExtent,
        sourceResolution * errorThresholdInPixels,
        targetResolution
      );
      const sourceExtent = triangulation.calculateSourceExtent();
      const sourceImage = getImageFunction(
        sourceExtent,
        sourceResolution,
        pixelRatio
      );
      const state = sourceImage ? ImageState.IDLE : ImageState.EMPTY;
      const sourcePixelRatio = sourceImage ? sourceImage.getPixelRatio() : 1;
      super(targetExtent, targetResolution, sourcePixelRatio, state);
      this.targetProj_ = targetProj;
      this.maxSourceExtent_ = maxSourceExtent;
      this.triangulation_ = triangulation;
      this.targetResolution_ = targetResolution;
      this.targetExtent_ = targetExtent;
      this.sourceImage_ = sourceImage;
      this.sourcePixelRatio_ = sourcePixelRatio;
      this.interpolate_ = interpolate;
      this.canvas_ = null;
      this.sourceListenerKey_ = null;
    }
    disposeInternal() {
      if (this.state == ImageState.LOADING) {
        this.unlistenSource_();
      }
      super.disposeInternal();
    }
    getImage() {
      return this.canvas_;
    }
    getProjection() {
      return this.targetProj_;
    }
    reproject_() {
      const sourceState = this.sourceImage_.getState();
      if (sourceState == ImageState.LOADED) {
        const width = getWidth(this.targetExtent_) / this.targetResolution_;
        const height = getHeight(this.targetExtent_) / this.targetResolution_;
        this.canvas_ = render(
          width,
          height,
          this.sourcePixelRatio_,
          this.sourceImage_.getResolution(),
          this.maxSourceExtent_,
          this.targetResolution_,
          this.targetExtent_,
          this.triangulation_,
          [
            {
              extent: this.sourceImage_.getExtent(),
              image: this.sourceImage_.getImage()
            }
          ],
          0,
          void 0,
          this.interpolate_
        );
      }
      this.state = sourceState;
      this.changed();
    }
    load() {
      if (this.state == ImageState.IDLE) {
        this.state = ImageState.LOADING;
        this.changed();
        const sourceState = this.sourceImage_.getState();
        if (sourceState == ImageState.LOADED || sourceState == ImageState.ERROR) {
          this.reproject_();
        } else {
          this.sourceListenerKey_ = listen(
            this.sourceImage_,
            EventType.CHANGE,
            function(e) {
              const sourceState2 = this.sourceImage_.getState();
              if (sourceState2 == ImageState.LOADED || sourceState2 == ImageState.ERROR) {
                this.unlistenSource_();
                this.reproject_();
              }
            },
            this
          );
          this.sourceImage_.load();
        }
      }
    }
    unlistenSource_() {
      unlistenByKey(
        this.sourceListenerKey_
      );
      this.sourceListenerKey_ = null;
    }
  }
  const ReprojImage$1 = ReprojImage;
  const ImageSourceEventType = {
    IMAGELOADSTART: "imageloadstart",
    IMAGELOADEND: "imageloadend",
    IMAGELOADERROR: "imageloaderror"
  };
  class ImageSourceEvent extends Event {
    constructor(type, image) {
      super(type);
      this.image = image;
    }
  }
  class ImageSource extends Source$1 {
    constructor(options) {
      super({
        attributions: options.attributions,
        projection: options.projection,
        state: options.state,
        interpolate: options.interpolate !== void 0 ? options.interpolate : true
      });
      this.on;
      this.once;
      this.un;
      this.resolutions_ = options.resolutions !== void 0 ? options.resolutions : null;
      this.reprojectedImage_ = null;
      this.reprojectedRevision_ = 0;
    }
    getResolutions() {
      return this.resolutions_;
    }
    setResolutions(resolutions) {
      this.resolutions_ = resolutions;
    }
    findNearestResolution(resolution) {
      const resolutions = this.getResolutions();
      if (resolutions) {
        const idx = linearFindNearest(resolutions, resolution, 0);
        resolution = resolutions[idx];
      }
      return resolution;
    }
    getImage(extent, resolution, pixelRatio, projection) {
      const sourceProjection = this.getProjection();
      if (!sourceProjection || !projection || equivalent(sourceProjection, projection)) {
        if (sourceProjection) {
          projection = sourceProjection;
        }
        return this.getImageInternal(extent, resolution, pixelRatio, projection);
      }
      if (this.reprojectedImage_) {
        if (this.reprojectedRevision_ == this.getRevision() && equivalent(this.reprojectedImage_.getProjection(), projection) && this.reprojectedImage_.getResolution() == resolution && equals$2(this.reprojectedImage_.getExtent(), extent)) {
          return this.reprojectedImage_;
        }
        this.reprojectedImage_.dispose();
        this.reprojectedImage_ = null;
      }
      this.reprojectedImage_ = new ReprojImage$1(
        sourceProjection,
        projection,
        extent,
        resolution,
        pixelRatio,
        (extent2, resolution2, pixelRatio2) => this.getImageInternal(extent2, resolution2, pixelRatio2, sourceProjection),
        this.getInterpolate()
      );
      this.reprojectedRevision_ = this.getRevision();
      return this.reprojectedImage_;
    }
    getImageInternal(extent, resolution, pixelRatio, projection) {
      return abstract();
    }
    handleImageChange(event) {
      const image = event.target;
      let type;
      switch (image.getState()) {
        case ImageState.LOADING:
          this.loading = true;
          type = ImageSourceEventType.IMAGELOADSTART;
          break;
        case ImageState.LOADED:
          this.loading = false;
          type = ImageSourceEventType.IMAGELOADEND;
          break;
        case ImageState.ERROR:
          this.loading = false;
          type = ImageSourceEventType.IMAGELOADERROR;
          break;
        default:
          return;
      }
      if (this.hasListener(type)) {
        this.dispatchEvent(new ImageSourceEvent(type, image));
      }
    }
  }
  function defaultImageLoadFunction(image, src2) {
    image.getImage().src = src2;
  }
  const ImageSource$1 = ImageSource;
  function appendParams(uri, params2) {
    const keyParams = [];
    Object.keys(params2).forEach(function(k) {
      if (params2[k] !== null && params2[k] !== void 0) {
        keyParams.push(k + "=" + encodeURIComponent(params2[k]));
      }
    });
    const qs = keyParams.join("&");
    uri = uri.replace(/[?&]$/, "");
    uri += uri.includes("?") ? "&" : "?";
    return uri + qs;
  }
  const DEFAULT_VERSION = "1.3.0";
  const DECIMALS = 4;
  const GETFEATUREINFO_IMAGE_SIZE = [101, 101];
  class ImageWMS extends ImageSource$1 {
    constructor(options) {
      options = options ? options : {};
      super({
        attributions: options.attributions,
        interpolate: options.interpolate,
        projection: options.projection,
        resolutions: options.resolutions
      });
      this.context_ = createCanvasContext2D(1, 1);
      this.crossOrigin_ = options.crossOrigin !== void 0 ? options.crossOrigin : null;
      this.url_ = options.url;
      this.imageLoadFunction_ = options.imageLoadFunction !== void 0 ? options.imageLoadFunction : defaultImageLoadFunction;
      this.params_ = Object.assign({}, options.params);
      this.v13_ = true;
      this.updateV13_();
      this.serverType_ = options.serverType;
      this.hidpi_ = options.hidpi !== void 0 ? options.hidpi : true;
      this.image_ = null;
      this.imageSize_ = [0, 0];
      this.renderedRevision_ = 0;
      this.ratio_ = options.ratio !== void 0 ? options.ratio : 1.5;
    }
    getFeatureInfoUrl(coordinate, resolution, projection, params2) {
      if (this.url_ === void 0) {
        return void 0;
      }
      const projectionObj = get$2(projection);
      const sourceProjectionObj = this.getProjection();
      if (sourceProjectionObj && sourceProjectionObj !== projectionObj) {
        resolution = calculateSourceResolution(
          sourceProjectionObj,
          projectionObj,
          coordinate,
          resolution
        );
        coordinate = transform$1(coordinate, projectionObj, sourceProjectionObj);
      }
      const extent = getForViewAndSize(
        coordinate,
        resolution,
        0,
        GETFEATUREINFO_IMAGE_SIZE
      );
      const baseParams = {
        "SERVICE": "WMS",
        "VERSION": DEFAULT_VERSION,
        "REQUEST": "GetFeatureInfo",
        "FORMAT": "image/png",
        "TRANSPARENT": true,
        "QUERY_LAYERS": this.params_["LAYERS"]
      };
      Object.assign(baseParams, this.params_, params2);
      const x = floor((coordinate[0] - extent[0]) / resolution, DECIMALS);
      const y2 = floor((extent[3] - coordinate[1]) / resolution, DECIMALS);
      baseParams[this.v13_ ? "I" : "X"] = x;
      baseParams[this.v13_ ? "J" : "Y"] = y2;
      return this.getRequestUrl_(
        extent,
        GETFEATUREINFO_IMAGE_SIZE,
        1,
        sourceProjectionObj || projectionObj,
        baseParams
      );
    }
    getLegendUrl(resolution, params2) {
      if (this.url_ === void 0) {
        return void 0;
      }
      const baseParams = {
        "SERVICE": "WMS",
        "VERSION": DEFAULT_VERSION,
        "REQUEST": "GetLegendGraphic",
        "FORMAT": "image/png"
      };
      if (params2 === void 0 || params2["LAYER"] === void 0) {
        const layers = this.params_.LAYERS;
        const isSingleLayer = !Array.isArray(layers) || layers.length === 1;
        if (!isSingleLayer) {
          return void 0;
        }
        baseParams["LAYER"] = layers;
      }
      if (resolution !== void 0) {
        const mpu = this.getProjection() ? this.getProjection().getMetersPerUnit() : 1;
        const pixelSize = 28e-5;
        baseParams["SCALE"] = resolution * mpu / pixelSize;
      }
      Object.assign(baseParams, params2);
      return appendParams(this.url_, baseParams);
    }
    getParams() {
      return this.params_;
    }
    getImageInternal(extent, resolution, pixelRatio, projection) {
      if (this.url_ === void 0) {
        return null;
      }
      resolution = this.findNearestResolution(resolution);
      if (pixelRatio != 1 && (!this.hidpi_ || this.serverType_ === void 0)) {
        pixelRatio = 1;
      }
      const imageResolution = resolution / pixelRatio;
      const center = getCenter(extent);
      const viewWidth = ceil(getWidth(extent) / imageResolution, DECIMALS);
      const viewHeight = ceil(getHeight(extent) / imageResolution, DECIMALS);
      const viewExtent = getForViewAndSize(center, imageResolution, 0, [
        viewWidth,
        viewHeight
      ]);
      const requestWidth = ceil(
        this.ratio_ * getWidth(extent) / imageResolution,
        DECIMALS
      );
      const requestHeight = ceil(
        this.ratio_ * getHeight(extent) / imageResolution,
        DECIMALS
      );
      const requestExtent = getForViewAndSize(center, imageResolution, 0, [
        requestWidth,
        requestHeight
      ]);
      const image = this.image_;
      if (image && this.renderedRevision_ == this.getRevision() && image.getResolution() == resolution && image.getPixelRatio() == pixelRatio && containsExtent(image.getExtent(), viewExtent)) {
        return image;
      }
      const params2 = {
        "SERVICE": "WMS",
        "VERSION": DEFAULT_VERSION,
        "REQUEST": "GetMap",
        "FORMAT": "image/png",
        "TRANSPARENT": true
      };
      Object.assign(params2, this.params_);
      this.imageSize_[0] = round(
        getWidth(requestExtent) / imageResolution,
        DECIMALS
      );
      this.imageSize_[1] = round(
        getHeight(requestExtent) / imageResolution,
        DECIMALS
      );
      const url = this.getRequestUrl_(
        requestExtent,
        this.imageSize_,
        pixelRatio,
        projection,
        params2
      );
      this.image_ = new ImageWrapper$1(
        requestExtent,
        resolution,
        pixelRatio,
        url,
        this.crossOrigin_,
        this.imageLoadFunction_,
        this.context_
      );
      this.renderedRevision_ = this.getRevision();
      this.image_.addEventListener(
        EventType.CHANGE,
        this.handleImageChange.bind(this)
      );
      return this.image_;
    }
    getImageLoadFunction() {
      return this.imageLoadFunction_;
    }
    getRequestUrl_(extent, size, pixelRatio, projection, params2) {
      assert(this.url_ !== void 0, 9);
      params2[this.v13_ ? "CRS" : "SRS"] = projection.getCode();
      if (!("STYLES" in this.params_)) {
        params2["STYLES"] = "";
      }
      if (pixelRatio != 1) {
        switch (this.serverType_) {
          case "geoserver":
            const dpi = 90 * pixelRatio + 0.5 | 0;
            if ("FORMAT_OPTIONS" in params2) {
              params2["FORMAT_OPTIONS"] += ";dpi:" + dpi;
            } else {
              params2["FORMAT_OPTIONS"] = "dpi:" + dpi;
            }
            break;
          case "mapserver":
            params2["MAP_RESOLUTION"] = 90 * pixelRatio;
            break;
          case "carmentaserver":
          case "qgis":
            params2["DPI"] = 90 * pixelRatio;
            break;
          default:
            assert(false, 8);
            break;
        }
      }
      params2["WIDTH"] = size[0];
      params2["HEIGHT"] = size[1];
      const axisOrientation = projection.getAxisOrientation();
      let bbox;
      if (this.v13_ && axisOrientation.substr(0, 2) == "ne") {
        bbox = [extent[1], extent[0], extent[3], extent[2]];
      } else {
        bbox = extent;
      }
      params2["BBOX"] = bbox.join(",");
      return appendParams(this.url_, params2);
    }
    getUrl() {
      return this.url_;
    }
    setImageLoadFunction(imageLoadFunction) {
      this.image_ = null;
      this.imageLoadFunction_ = imageLoadFunction;
      this.changed();
    }
    setUrl(url) {
      if (url != this.url_) {
        this.url_ = url;
        this.image_ = null;
        this.changed();
      }
    }
    updateParams(params2) {
      Object.assign(this.params_, params2);
      this.updateV13_();
      this.image_ = null;
      this.changed();
    }
    updateV13_() {
      const version2 = this.params_["VERSION"] || DEFAULT_VERSION;
      this.v13_ = compareVersions(version2, "1.3") >= 0;
    }
  }
  const ImageWMS$1 = ImageWMS;
  const DROP = Infinity;
  class PriorityQueue {
    constructor(priorityFunction, keyFunction) {
      this.priorityFunction_ = priorityFunction;
      this.keyFunction_ = keyFunction;
      this.elements_ = [];
      this.priorities_ = [];
      this.queuedElements_ = {};
    }
    clear() {
      this.elements_.length = 0;
      this.priorities_.length = 0;
      clear(this.queuedElements_);
    }
    dequeue() {
      const elements = this.elements_;
      const priorities = this.priorities_;
      const element = elements[0];
      if (elements.length == 1) {
        elements.length = 0;
        priorities.length = 0;
      } else {
        elements[0] = elements.pop();
        priorities[0] = priorities.pop();
        this.siftUp_(0);
      }
      const elementKey = this.keyFunction_(element);
      delete this.queuedElements_[elementKey];
      return element;
    }
    enqueue(element) {
      assert(!(this.keyFunction_(element) in this.queuedElements_), 31);
      const priority = this.priorityFunction_(element);
      if (priority != DROP) {
        this.elements_.push(element);
        this.priorities_.push(priority);
        this.queuedElements_[this.keyFunction_(element)] = true;
        this.siftDown_(0, this.elements_.length - 1);
        return true;
      }
      return false;
    }
    getCount() {
      return this.elements_.length;
    }
    getLeftChildIndex_(index2) {
      return index2 * 2 + 1;
    }
    getRightChildIndex_(index2) {
      return index2 * 2 + 2;
    }
    getParentIndex_(index2) {
      return index2 - 1 >> 1;
    }
    heapify_() {
      let i;
      for (i = (this.elements_.length >> 1) - 1; i >= 0; i--) {
        this.siftUp_(i);
      }
    }
    isEmpty() {
      return this.elements_.length === 0;
    }
    isKeyQueued(key) {
      return key in this.queuedElements_;
    }
    isQueued(element) {
      return this.isKeyQueued(this.keyFunction_(element));
    }
    siftUp_(index2) {
      const elements = this.elements_;
      const priorities = this.priorities_;
      const count = elements.length;
      const element = elements[index2];
      const priority = priorities[index2];
      const startIndex = index2;
      while (index2 < count >> 1) {
        const lIndex = this.getLeftChildIndex_(index2);
        const rIndex = this.getRightChildIndex_(index2);
        const smallerChildIndex = rIndex < count && priorities[rIndex] < priorities[lIndex] ? rIndex : lIndex;
        elements[index2] = elements[smallerChildIndex];
        priorities[index2] = priorities[smallerChildIndex];
        index2 = smallerChildIndex;
      }
      elements[index2] = element;
      priorities[index2] = priority;
      this.siftDown_(startIndex, index2);
    }
    siftDown_(startIndex, index2) {
      const elements = this.elements_;
      const priorities = this.priorities_;
      const element = elements[index2];
      const priority = priorities[index2];
      while (index2 > startIndex) {
        const parentIndex = this.getParentIndex_(index2);
        if (priorities[parentIndex] > priority) {
          elements[index2] = elements[parentIndex];
          priorities[index2] = priorities[parentIndex];
          index2 = parentIndex;
        } else {
          break;
        }
      }
      elements[index2] = element;
      priorities[index2] = priority;
    }
    reprioritize() {
      const priorityFunction = this.priorityFunction_;
      const elements = this.elements_;
      const priorities = this.priorities_;
      let index2 = 0;
      const n = elements.length;
      let element, i, priority;
      for (i = 0; i < n; ++i) {
        element = elements[i];
        priority = priorityFunction(element);
        if (priority == DROP) {
          delete this.queuedElements_[this.keyFunction_(element)];
        } else {
          priorities[index2] = priority;
          elements[index2++] = element;
        }
      }
      elements.length = index2;
      priorities.length = index2;
      this.heapify_();
    }
  }
  const PriorityQueue$1 = PriorityQueue;
  class TileQueue extends PriorityQueue$1 {
    constructor(tilePriorityFunction, tileChangeCallback) {
      super(
        function(element) {
          return tilePriorityFunction.apply(null, element);
        },
        function(element) {
          return element[0].getKey();
        }
      );
      this.boundHandleTileChange_ = this.handleTileChange.bind(this);
      this.tileChangeCallback_ = tileChangeCallback;
      this.tilesLoading_ = 0;
      this.tilesLoadingKeys_ = {};
    }
    enqueue(element) {
      const added = super.enqueue(element);
      if (added) {
        const tile = element[0];
        tile.addEventListener(EventType.CHANGE, this.boundHandleTileChange_);
      }
      return added;
    }
    getTilesLoading() {
      return this.tilesLoading_;
    }
    handleTileChange(event) {
      const tile = event.target;
      const state = tile.getState();
      if (state === TileState.LOADED || state === TileState.ERROR || state === TileState.EMPTY) {
        if (state !== TileState.ERROR) {
          tile.removeEventListener(EventType.CHANGE, this.boundHandleTileChange_);
        }
        const tileKey = tile.getKey();
        if (tileKey in this.tilesLoadingKeys_) {
          delete this.tilesLoadingKeys_[tileKey];
          --this.tilesLoading_;
        }
        this.tileChangeCallback_();
      }
    }
    loadMoreTiles(maxTotalLoading, maxNewLoads) {
      let newLoads = 0;
      let state, tile, tileKey;
      while (this.tilesLoading_ < maxTotalLoading && newLoads < maxNewLoads && this.getCount() > 0) {
        tile = this.dequeue()[0];
        tileKey = tile.getKey();
        state = tile.getState();
        if (state === TileState.IDLE && !(tileKey in this.tilesLoadingKeys_)) {
          this.tilesLoadingKeys_[tileKey] = true;
          ++this.tilesLoading_;
          ++newLoads;
          tile.load();
        }
      }
    }
  }
  const TileQueue$1 = TileQueue;
  function getTilePriority(frameState, tile, tileSourceKey, tileCenter, tileResolution) {
    if (!frameState || !(tileSourceKey in frameState.wantedTiles)) {
      return DROP;
    }
    if (!frameState.wantedTiles[tileSourceKey][tile.getKey()]) {
      return DROP;
    }
    const center = frameState.viewState.center;
    const deltaX = tileCenter[0] - center[0];
    const deltaY = tileCenter[1] - center[1];
    return 65536 * Math.log(tileResolution) + Math.sqrt(deltaX * deltaX + deltaY * deltaY) / tileResolution;
  }
  class WMTSTileGrid extends TileGrid$1 {
    constructor(options) {
      super({
        extent: options.extent,
        origin: options.origin,
        origins: options.origins,
        resolutions: options.resolutions,
        tileSize: options.tileSize,
        tileSizes: options.tileSizes,
        sizes: options.sizes
      });
      this.matrixIds_ = options.matrixIds;
    }
    getMatrixId(z) {
      return this.matrixIds_[z];
    }
    getMatrixIds() {
      return this.matrixIds_;
    }
  }
  const WmtsTileGrid = WMTSTileGrid;
  class WMTS extends TileImage$1 {
    constructor(options) {
      const requestEncoding = options.requestEncoding !== void 0 ? options.requestEncoding : "KVP";
      const tileGrid = options.tileGrid;
      let urls = options.urls;
      if (urls === void 0 && options.url !== void 0) {
        urls = expandUrl(options.url);
      }
      super({
        attributions: options.attributions,
        attributionsCollapsible: options.attributionsCollapsible,
        cacheSize: options.cacheSize,
        crossOrigin: options.crossOrigin,
        interpolate: options.interpolate,
        projection: options.projection,
        reprojectionErrorThreshold: options.reprojectionErrorThreshold,
        tileClass: options.tileClass,
        tileGrid,
        tileLoadFunction: options.tileLoadFunction,
        tilePixelRatio: options.tilePixelRatio,
        urls,
        wrapX: options.wrapX !== void 0 ? options.wrapX : false,
        transition: options.transition,
        zDirection: options.zDirection
      });
      this.version_ = options.version !== void 0 ? options.version : "1.0.0";
      this.format_ = options.format !== void 0 ? options.format : "image/jpeg";
      this.dimensions_ = options.dimensions !== void 0 ? options.dimensions : {};
      this.layer_ = options.layer;
      this.matrixSet_ = options.matrixSet;
      this.style_ = options.style;
      this.requestEncoding_ = requestEncoding;
      this.setKey(this.getKeyForDimensions_());
      if (urls && urls.length > 0) {
        this.tileUrlFunction = createFromTileUrlFunctions(
          urls.map(this.createFromWMTSTemplate.bind(this))
        );
      }
    }
    setUrls(urls) {
      this.urls = urls;
      const key = urls.join("\n");
      this.setTileUrlFunction(
        createFromTileUrlFunctions(
          urls.map(this.createFromWMTSTemplate.bind(this))
        ),
        key
      );
    }
    getDimensions() {
      return this.dimensions_;
    }
    getFormat() {
      return this.format_;
    }
    getLayer() {
      return this.layer_;
    }
    getMatrixSet() {
      return this.matrixSet_;
    }
    getRequestEncoding() {
      return this.requestEncoding_;
    }
    getStyle() {
      return this.style_;
    }
    getVersion() {
      return this.version_;
    }
    getKeyForDimensions_() {
      const res = this.urls ? this.urls.slice(0) : [];
      for (const key in this.dimensions_) {
        res.push(key + "-" + this.dimensions_[key]);
      }
      return res.join("/");
    }
    updateDimensions(dimensions) {
      Object.assign(this.dimensions_, dimensions);
      this.setKey(this.getKeyForDimensions_());
    }
    createFromWMTSTemplate(template) {
      const requestEncoding = this.requestEncoding_;
      const context = {
        "layer": this.layer_,
        "style": this.style_,
        "tilematrixset": this.matrixSet_
      };
      if (requestEncoding == "KVP") {
        Object.assign(context, {
          "Service": "WMTS",
          "Request": "GetTile",
          "Version": this.version_,
          "Format": this.format_
        });
      }
      template = requestEncoding == "KVP" ? appendParams(template, context) : template.replace(/\{(\w+?)\}/g, function(m, p2) {
        return p2.toLowerCase() in context ? context[p2.toLowerCase()] : m;
      });
      const tileGrid = this.tileGrid;
      const dimensions = this.dimensions_;
      return function(tileCoord, pixelRatio, projection) {
        if (!tileCoord) {
          return void 0;
        }
        const localContext = {
          "TileMatrix": tileGrid.getMatrixId(tileCoord[0]),
          "TileCol": tileCoord[1],
          "TileRow": tileCoord[2]
        };
        Object.assign(localContext, dimensions);
        let url = template;
        if (requestEncoding == "KVP") {
          url = appendParams(url, localContext);
        } else {
          url = url.replace(/\{(\w+?)\}/g, function(m, p2) {
            return localContext[p2];
          });
        }
        return url;
      };
    }
  }
  const WMTS$1 = WMTS;
  var maplibreGl = { exports: {} };
  (function(module2, exports3) {
    (function(global2, factory) {
      module2.exports = factory();
    })(commonjsGlobal, function() {
      var shared2, worker, maplibregl2;
      function define2(_, chunk) {
        if (!shared2) {
          shared2 = chunk;
        } else if (!worker) {
          worker = chunk;
        } else {
          var workerBundleString = "var sharedChunk = {}; (" + shared2 + ")(sharedChunk); (" + worker + ")(sharedChunk);";
          var sharedChunk = {};
          shared2(sharedChunk);
          maplibregl2 = chunk(sharedChunk);
          if (typeof window !== "undefined") {
            maplibregl2.workerUrl = window.URL.createObjectURL(new Blob([workerBundleString], { type: "text/javascript" }));
          }
        }
      }
      define2(["exports"], function(t) {
        var e = r;
        function r(t2, e2, r2, n2) {
          this.cx = 3 * t2, this.bx = 3 * (r2 - t2) - this.cx, this.ax = 1 - this.cx - this.bx, this.cy = 3 * e2, this.by = 3 * (n2 - e2) - this.cy, this.ay = 1 - this.cy - this.by, this.p1x = t2, this.p1y = e2, this.p2x = r2, this.p2y = n2;
        }
        function n(t2, r2, n2, i2) {
          const a2 = new e(t2, r2, n2, i2);
          return function(t3) {
            return a2.solve(t3);
          };
        }
        r.prototype = { sampleCurveX: function(t2) {
          return ((this.ax * t2 + this.bx) * t2 + this.cx) * t2;
        }, sampleCurveY: function(t2) {
          return ((this.ay * t2 + this.by) * t2 + this.cy) * t2;
        }, sampleCurveDerivativeX: function(t2) {
          return (3 * this.ax * t2 + 2 * this.bx) * t2 + this.cx;
        }, solveCurveX: function(t2, e2) {
          if (void 0 === e2 && (e2 = 1e-6), t2 < 0)
            return 0;
          if (t2 > 1)
            return 1;
          for (var r2 = t2, n2 = 0; n2 < 8; n2++) {
            var i2 = this.sampleCurveX(r2) - t2;
            if (Math.abs(i2) < e2)
              return r2;
            var a2 = this.sampleCurveDerivativeX(r2);
            if (Math.abs(a2) < 1e-6)
              break;
            r2 -= i2 / a2;
          }
          var s2 = 0, o2 = 1;
          for (r2 = t2, n2 = 0; n2 < 20 && (i2 = this.sampleCurveX(r2), !(Math.abs(i2 - t2) < e2)); n2++)
            t2 > i2 ? s2 = r2 : o2 = r2, r2 = 0.5 * (o2 - s2) + s2;
          return r2;
        }, solve: function(t2, e2) {
          return this.sampleCurveY(this.solveCurveX(t2, e2));
        } };
        const i = n(0.25, 0.1, 0.25, 1);
        function a(t2, e2, r2) {
          return Math.min(r2, Math.max(e2, t2));
        }
        function s(t2, e2, r2) {
          const n2 = r2 - e2, i2 = ((t2 - e2) % n2 + n2) % n2 + e2;
          return i2 === e2 ? r2 : i2;
        }
        function o(t2, ...e2) {
          for (const r2 of e2)
            for (const e3 in r2)
              t2[e3] = r2[e3];
          return t2;
        }
        let l = 1;
        function u(t2, e2) {
          t2.forEach((t3) => {
            e2[t3] && (e2[t3] = e2[t3].bind(e2));
          });
        }
        function c2(t2, e2, r2) {
          const n2 = {};
          for (const i2 in t2)
            n2[i2] = e2.call(r2 || this, t2[i2], i2, t2);
          return n2;
        }
        function h(t2, e2, r2) {
          const n2 = {};
          for (const i2 in t2)
            e2.call(r2 || this, t2[i2], i2, t2) && (n2[i2] = t2[i2]);
          return n2;
        }
        function p2(t2) {
          return Array.isArray(t2) ? t2.map(p2) : "object" == typeof t2 && t2 ? c2(t2, p2) : t2;
        }
        const f = {};
        function d(t2) {
          f[t2] || ("undefined" != typeof console && console.warn(t2), f[t2] = true);
        }
        function y2(t2, e2, r2) {
          return (r2.y - t2.y) * (e2.x - t2.x) > (e2.y - t2.y) * (r2.x - t2.x);
        }
        function m(t2) {
          let e2 = 0;
          for (let r2, n2, i2 = 0, a2 = t2.length, s2 = a2 - 1; i2 < a2; s2 = i2++)
            r2 = t2[i2], n2 = t2[s2], e2 += (n2.x - r2.x) * (r2.y + n2.y);
          return e2;
        }
        function g() {
          return "undefined" != typeof WorkerGlobalScope && "undefined" != typeof self && self instanceof WorkerGlobalScope;
        }
        function x(t2) {
          const e2 = {};
          if (t2.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g, (t3, r2, n2, i2) => {
            const a2 = n2 || i2;
            return e2[r2] = !a2 || a2.toLowerCase(), "";
          }), e2["max-age"]) {
            const t3 = parseInt(e2["max-age"], 10);
            isNaN(t3) ? delete e2["max-age"] : e2["max-age"] = t3;
          }
          return e2;
        }
        let v2, b, w = null;
        function _(t2) {
          if (null == w) {
            const e2 = t2.navigator ? t2.navigator.userAgent : null;
            w = !!t2.safari || !(!e2 || !(/\b(iPad|iPhone|iPod)\b/.test(e2) || e2.match("Safari") && !e2.match("Chrome")));
          }
          return w;
        }
        function A2(t2) {
          return "undefined" != typeof ImageBitmap && t2 instanceof ImageBitmap;
        }
        const k = { now: "undefined" != typeof performance && performance && performance.now ? performance.now.bind(performance) : Date.now.bind(Date), frame(t2) {
          const e2 = requestAnimationFrame(t2);
          return { cancel: () => cancelAnimationFrame(e2) };
        }, getImageData(t2, e2 = 0) {
          const r2 = window.document.createElement("canvas"), n2 = r2.getContext("2d");
          if (!n2)
            throw new Error("failed to create canvas 2d context");
          return r2.width = t2.width, r2.height = t2.height, n2.drawImage(t2, 0, 0, t2.width, t2.height), n2.getImageData(-e2, -e2, t2.width + 2 * e2, t2.height + 2 * e2);
        }, resolveURL: (t2) => (v2 || (v2 = document.createElement("a")), v2.href = t2, v2.href), hardwareConcurrency: "undefined" != typeof navigator && navigator.hardwareConcurrency || 4, get prefersReducedMotion() {
          return !!matchMedia && (null == b && (b = matchMedia("(prefers-reduced-motion: reduce)")), b.matches);
        } };
        var S = I2;
        function I2(t2, e2) {
          this.x = t2, this.y = e2;
        }
        I2.prototype = { clone: function() {
          return new I2(this.x, this.y);
        }, add: function(t2) {
          return this.clone()._add(t2);
        }, sub: function(t2) {
          return this.clone()._sub(t2);
        }, multByPoint: function(t2) {
          return this.clone()._multByPoint(t2);
        }, divByPoint: function(t2) {
          return this.clone()._divByPoint(t2);
        }, mult: function(t2) {
          return this.clone()._mult(t2);
        }, div: function(t2) {
          return this.clone()._div(t2);
        }, rotate: function(t2) {
          return this.clone()._rotate(t2);
        }, rotateAround: function(t2, e2) {
          return this.clone()._rotateAround(t2, e2);
        }, matMult: function(t2) {
          return this.clone()._matMult(t2);
        }, unit: function() {
          return this.clone()._unit();
        }, perp: function() {
          return this.clone()._perp();
        }, round: function() {
          return this.clone()._round();
        }, mag: function() {
          return Math.sqrt(this.x * this.x + this.y * this.y);
        }, equals: function(t2) {
          return this.x === t2.x && this.y === t2.y;
        }, dist: function(t2) {
          return Math.sqrt(this.distSqr(t2));
        }, distSqr: function(t2) {
          var e2 = t2.x - this.x, r2 = t2.y - this.y;
          return e2 * e2 + r2 * r2;
        }, angle: function() {
          return Math.atan2(this.y, this.x);
        }, angleTo: function(t2) {
          return Math.atan2(this.y - t2.y, this.x - t2.x);
        }, angleWith: function(t2) {
          return this.angleWithSep(t2.x, t2.y);
        }, angleWithSep: function(t2, e2) {
          return Math.atan2(this.x * e2 - this.y * t2, this.x * t2 + this.y * e2);
        }, _matMult: function(t2) {
          var e2 = t2[2] * this.x + t2[3] * this.y;
          return this.x = t2[0] * this.x + t2[1] * this.y, this.y = e2, this;
        }, _add: function(t2) {
          return this.x += t2.x, this.y += t2.y, this;
        }, _sub: function(t2) {
          return this.x -= t2.x, this.y -= t2.y, this;
        }, _mult: function(t2) {
          return this.x *= t2, this.y *= t2, this;
        }, _div: function(t2) {
          return this.x /= t2, this.y /= t2, this;
        }, _multByPoint: function(t2) {
          return this.x *= t2.x, this.y *= t2.y, this;
        }, _divByPoint: function(t2) {
          return this.x /= t2.x, this.y /= t2.y, this;
        }, _unit: function() {
          return this._div(this.mag()), this;
        }, _perp: function() {
          var t2 = this.y;
          return this.y = this.x, this.x = -t2, this;
        }, _rotate: function(t2) {
          var e2 = Math.cos(t2), r2 = Math.sin(t2), n2 = r2 * this.x + e2 * this.y;
          return this.x = e2 * this.x - r2 * this.y, this.y = n2, this;
        }, _rotateAround: function(t2, e2) {
          var r2 = Math.cos(t2), n2 = Math.sin(t2), i2 = e2.y + n2 * (this.x - e2.x) + r2 * (this.y - e2.y);
          return this.x = e2.x + r2 * (this.x - e2.x) - n2 * (this.y - e2.y), this.y = i2, this;
        }, _round: function() {
          return this.x = Math.round(this.x), this.y = Math.round(this.y), this;
        } }, I2.convert = function(t2) {
          return t2 instanceof I2 ? t2 : Array.isArray(t2) ? new I2(t2[0], t2[1]) : t2;
        };
        const M = { MAX_PARALLEL_IMAGE_REQUESTS: 16, REGISTERED_PROTOCOLS: {} }, z = "mapbox-tiles";
        let B, C, P = 500, V2 = 50;
        function E() {
          "undefined" == typeof caches || B || (B = caches.open(z));
        }
        let F = 1 / 0;
        const T = { supported: false, testSupport: function(t2) {
          !$ && D && (R ? O2(t2) : L = t2);
        } };
        let L, D, $ = false, R = false;
        function O2(t2) {
          const e2 = t2.createTexture();
          t2.bindTexture(t2.TEXTURE_2D, e2);
          try {
            if (t2.texImage2D(t2.TEXTURE_2D, 0, t2.RGBA, t2.RGBA, t2.UNSIGNED_BYTE, D), t2.isContextLost())
              return;
            T.supported = true;
          } catch (t3) {
          }
          t2.deleteTexture(e2), $ = true;
        }
        "undefined" != typeof document && (D = document.createElement("img"), D.onload = function() {
          L && O2(L), L = null, R = true;
        }, D.onerror = function() {
          $ = true, L = null;
        }, D.src = "data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");
        const U = { Unknown: "Unknown", Style: "Style", Source: "Source", Tile: "Tile", Glyphs: "Glyphs", SpriteImage: "SpriteImage", SpriteJSON: "SpriteJSON", Image: "Image" };
        "function" == typeof Object.freeze && Object.freeze(U);
        class q extends Error {
          constructor(t2, e2, r2, n2) {
            super(`AJAXError: ${e2} (${t2}): ${r2}`), this.status = t2, this.statusText = e2, this.url = r2, this.body = n2;
          }
        }
        const j = g() ? () => self.worker && self.worker.referrer : () => ("blob:" === window.location.protocol ? window.parent : window).location.href;
        function N(t2, e2) {
          const r2 = new AbortController(), n2 = new Request(t2.url, { method: t2.method || "GET", body: t2.body, credentials: t2.credentials, headers: t2.headers, referrer: j(), signal: r2.signal });
          let i2 = false, a2 = false;
          "json" === t2.type && n2.headers.set("Accept", "application/json");
          return ((r3, s2, o2) => {
            if (a2)
              return;
            const l2 = Date.now();
            fetch(n2).then((r4) => r4.ok ? ((r5, s3, o3) => {
              ("arrayBuffer" === t2.type ? r5.arrayBuffer() : "json" === t2.type ? r5.json() : r5.text()).then((t3) => {
                a2 || (s3 && o3 && function(t4, e3, r6) {
                  if (E(), !B)
                    return;
                  const n3 = { status: e3.status, statusText: e3.statusText, headers: new Headers() };
                  e3.headers.forEach((t5, e4) => n3.headers.set(e4, t5));
                  const i3 = x(e3.headers.get("Cache-Control") || "");
                  i3["no-store"] || (i3["max-age"] && n3.headers.set("Expires", new Date(r6 + 1e3 * i3["max-age"]).toUTCString()), new Date(n3.headers.get("Expires")).getTime() - r6 < 42e4 || function(t5, e4) {
                    if (void 0 === C)
                      try {
                        new Response(new ReadableStream()), C = true;
                      } catch (t6) {
                        C = false;
                      }
                    C ? e4(t5.body) : t5.blob().then(e4);
                  }(e3, (e4) => {
                    const r7 = new Response(e4, n3);
                    E(), B && B.then((e5) => e5.put(function(t5) {
                      const e6 = t5.indexOf("?");
                      return e6 < 0 ? t5 : t5.slice(0, e6);
                    }(t4.url), r7)).catch((t5) => d(t5.message));
                  }));
                }(n2, s3, o3), i2 = true, e2(null, t3, r5.headers.get("Cache-Control"), r5.headers.get("Expires")));
              }).catch((t3) => {
                a2 || e2(new Error(t3.message));
              });
            })(r4, null, l2) : r4.blob().then((n3) => e2(new q(r4.status, r4.statusText, t2.url, n3)))).catch((t3) => {
              20 !== t3.code && e2(new Error(t3.message));
            });
          })(), { cancel: () => {
            a2 = true, i2 || r2.abort();
          } };
        }
        const Z2 = function(t2, e2) {
          if (/:\/\//.test(t2.url) && !/^https?:|^file:/.test(t2.url)) {
            if (g() && self.worker && self.worker.actor)
              return self.worker.actor.send("getResource", t2, e2);
            if (!g()) {
              const r3 = t2.url.substring(0, t2.url.indexOf("://"));
              return (M.REGISTERED_PROTOCOLS[r3] || N)(t2, e2);
            }
          }
          if (!(/^file:/.test(r2 = t2.url) || /^file:/.test(j()) && !/^\w+:/.test(r2))) {
            if (fetch && Request && AbortController && Object.prototype.hasOwnProperty.call(Request.prototype, "signal"))
              return N(t2, e2);
            if (g() && self.worker && self.worker.actor)
              return self.worker.actor.send("getResource", t2, e2, void 0, true);
          }
          var r2;
          return function(t3, e3) {
            const r3 = new XMLHttpRequest();
            r3.open(t3.method || "GET", t3.url, true), "arrayBuffer" === t3.type && (r3.responseType = "arraybuffer");
            for (const e4 in t3.headers)
              r3.setRequestHeader(e4, t3.headers[e4]);
            return "json" === t3.type && (r3.responseType = "text", r3.setRequestHeader("Accept", "application/json")), r3.withCredentials = "include" === t3.credentials, r3.onerror = () => {
              e3(new Error(r3.statusText));
            }, r3.onload = () => {
              if ((r3.status >= 200 && r3.status < 300 || 0 === r3.status) && null !== r3.response) {
                let n2 = r3.response;
                if ("json" === t3.type)
                  try {
                    n2 = JSON.parse(r3.response);
                  } catch (t4) {
                    return e3(t4);
                  }
                e3(null, n2, r3.getResponseHeader("Cache-Control"), r3.getResponseHeader("Expires"));
              } else {
                const n2 = new Blob([r3.response], { type: r3.getResponseHeader("Content-Type") });
                e3(new q(r3.status, r3.statusText, t3.url, n2));
              }
            }, r3.send(t3.body), { cancel: () => r3.abort() };
          }(t2, e2);
        }, K = function(t2, e2) {
          return Z2(o(t2, { type: "arrayBuffer" }), e2);
        };
        function G(t2) {
          const e2 = window.document.createElement("a");
          return e2.href = t2, e2.protocol === window.document.location.protocol && e2.host === window.document.location.host;
        }
        const J = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";
        let X, Y;
        X = [], Y = 0;
        const H = function(t2, e2) {
          if (T.supported && (t2.headers || (t2.headers = {}), t2.headers.accept = "image/webp,*/*"), Y >= M.MAX_PARALLEL_IMAGE_REQUESTS) {
            const r3 = { requestParameters: t2, callback: e2, cancelled: false, cancel() {
              this.cancelled = true;
            } };
            return X.push(r3), r3;
          }
          Y++;
          let r2 = false;
          const n2 = () => {
            if (!r2)
              for (r2 = true, Y--; X.length && Y < M.MAX_PARALLEL_IMAGE_REQUESTS; ) {
                const t3 = X.shift(), { requestParameters: e3, callback: r3, cancelled: n3 } = t3;
                n3 || (t3.cancel = H(e3, r3).cancel);
              }
          }, i2 = K(t2, (t3, r3, i3, a2) => {
            n2(), t3 ? e2(t3) : r3 && function(t4, e3) {
              "function" == typeof createImageBitmap ? function(t5, e4) {
                const r4 = new Blob([new Uint8Array(t5)], { type: "image/png" });
                createImageBitmap(r4).then((t6) => {
                  e4(null, t6);
                }).catch((t6) => {
                  e4(new Error(`Could not load image because of ${t6.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`));
                });
              }(t4, e3) : function(t5, e4) {
                const r4 = new Image();
                r4.onload = () => {
                  e4(null, r4), URL.revokeObjectURL(r4.src), r4.onload = null, window.requestAnimationFrame(() => {
                    r4.src = J;
                  });
                }, r4.onerror = () => e4(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));
                const n3 = new Blob([new Uint8Array(t5)], { type: "image/png" });
                r4.src = t5.byteLength ? URL.createObjectURL(n3) : J;
              }(t4, e3);
            }(r3, (t4, r4) => {
              null != t4 ? e2(t4) : null != r4 && e2(null, r4, { cacheControl: i3, expires: a2 });
            });
          });
          return { cancel: () => {
            i2.cancel(), n2();
          } };
        };
        function W(t2, e2, r2) {
          r2[t2] && -1 !== r2[t2].indexOf(e2) || (r2[t2] = r2[t2] || [], r2[t2].push(e2));
        }
        function Q(t2, e2, r2) {
          if (r2 && r2[t2]) {
            const n2 = r2[t2].indexOf(e2);
            -1 !== n2 && r2[t2].splice(n2, 1);
          }
        }
        class tt {
          constructor(t2, e2 = {}) {
            o(this, e2), this.type = t2;
          }
        }
        class et extends tt {
          constructor(t2, e2 = {}) {
            super("error", o({ error: t2 }, e2));
          }
        }
        class rt {
          on(t2, e2) {
            return this._listeners = this._listeners || {}, W(t2, e2, this._listeners), this;
          }
          off(t2, e2) {
            return Q(t2, e2, this._listeners), Q(t2, e2, this._oneTimeListeners), this;
          }
          once(t2, e2) {
            return this._oneTimeListeners = this._oneTimeListeners || {}, W(t2, e2, this._oneTimeListeners), this;
          }
          fire(t2, e2) {
            "string" == typeof t2 && (t2 = new tt(t2, e2 || {}));
            const r2 = t2.type;
            if (this.listens(r2)) {
              t2.target = this;
              const e3 = this._listeners && this._listeners[r2] ? this._listeners[r2].slice() : [];
              for (const r3 of e3)
                r3.call(this, t2);
              const n2 = this._oneTimeListeners && this._oneTimeListeners[r2] ? this._oneTimeListeners[r2].slice() : [];
              for (const e4 of n2)
                Q(r2, e4, this._oneTimeListeners), e4.call(this, t2);
              const i2 = this._eventedParent;
              i2 && (o(t2, "function" == typeof this._eventedParentData ? this._eventedParentData() : this._eventedParentData), i2.fire(t2));
            } else
              t2 instanceof et && console.error(t2.error);
            return this;
          }
          listens(t2) {
            return this._listeners && this._listeners[t2] && this._listeners[t2].length > 0 || this._oneTimeListeners && this._oneTimeListeners[t2] && this._oneTimeListeners[t2].length > 0 || this._eventedParent && this._eventedParent.listens(t2);
          }
          setEventedParent(t2, e2) {
            return this._eventedParent = t2, this._eventedParentData = e2, this;
          }
        }
        var nt = { $version: 8, $root: { version: { required: true, type: "enum", values: [8] }, name: { type: "string" }, metadata: { type: "*" }, center: { type: "array", value: "number" }, zoom: { type: "number" }, bearing: { type: "number", default: 0, period: 360, units: "degrees" }, pitch: { type: "number", default: 0, units: "degrees" }, light: { type: "light" }, terrain: { type: "terrain" }, sources: { required: true, type: "sources" }, sprite: { type: "string" }, glyphs: { type: "string" }, transition: { type: "transition" }, layers: { required: true, type: "array", value: "layer" } }, sources: { "*": { type: "source" } }, source: ["source_vector", "source_raster", "source_raster_dem", "source_geojson", "source_video", "source_image"], source_vector: { type: { required: true, type: "enum", values: { vector: {} } }, url: { type: "string" }, tiles: { type: "array", value: "string" }, bounds: { type: "array", value: "number", length: 4, default: [-180, -85.051129, 180, 85.051129] }, scheme: { type: "enum", values: { xyz: {}, tms: {} }, default: "xyz" }, minzoom: { type: "number", default: 0 }, maxzoom: { type: "number", default: 22 }, attribution: { type: "string" }, promoteId: { type: "promoteId" }, volatile: { type: "boolean", default: false }, "*": { type: "*" } }, source_raster: { type: { required: true, type: "enum", values: { raster: {} } }, url: { type: "string" }, tiles: { type: "array", value: "string" }, bounds: { type: "array", value: "number", length: 4, default: [-180, -85.051129, 180, 85.051129] }, minzoom: { type: "number", default: 0 }, maxzoom: { type: "number", default: 22 }, tileSize: { type: "number", default: 512, units: "pixels" }, scheme: { type: "enum", values: { xyz: {}, tms: {} }, default: "xyz" }, attribution: { type: "string" }, volatile: { type: "boolean", default: false }, "*": { type: "*" } }, source_raster_dem: { type: { required: true, type: "enum", values: { "raster-dem": {} } }, url: { type: "string" }, tiles: { type: "array", value: "string" }, bounds: { type: "array", value: "number", length: 4, default: [-180, -85.051129, 180, 85.051129] }, minzoom: { type: "number", default: 0 }, maxzoom: { type: "number", default: 22 }, tileSize: { type: "number", default: 512, units: "pixels" }, attribution: { type: "string" }, encoding: { type: "enum", values: { terrarium: {}, mapbox: {} }, default: "mapbox" }, volatile: { type: "boolean", default: false }, "*": { type: "*" } }, source_geojson: { type: { required: true, type: "enum", values: { geojson: {} } }, data: { type: "*" }, maxzoom: { type: "number", default: 18 }, attribution: { type: "string" }, buffer: { type: "number", default: 128, maximum: 512, minimum: 0 }, filter: { type: "*" }, tolerance: { type: "number", default: 0.375 }, cluster: { type: "boolean", default: false }, clusterRadius: { type: "number", default: 50, minimum: 0 }, clusterMaxZoom: { type: "number" }, clusterMinPoints: { type: "number" }, clusterProperties: { type: "*" }, lineMetrics: { type: "boolean", default: false }, generateId: { type: "boolean", default: false }, promoteId: { type: "promoteId" } }, source_video: { type: { required: true, type: "enum", values: { video: {} } }, urls: { required: true, type: "array", value: "string" }, coordinates: { required: true, type: "array", length: 4, value: { type: "array", length: 2, value: "number" } } }, source_image: { type: { required: true, type: "enum", values: { image: {} } }, url: { required: true, type: "string" }, coordinates: { required: true, type: "array", length: 4, value: { type: "array", length: 2, value: "number" } } }, layer: { id: { type: "string", required: true }, type: { type: "enum", values: { fill: {}, line: {}, symbol: {}, circle: {}, heatmap: {}, "fill-extrusion": {}, raster: {}, hillshade: {}, background: {} }, required: true }, metadata: { type: "*" }, source: { type: "string" }, "source-layer": { type: "string" }, minzoom: { type: "number", minimum: 0, maximum: 24 }, maxzoom: { type: "number", minimum: 0, maximum: 24 }, filter: { type: "filter" }, layout: { type: "layout" }, paint: { type: "paint" } }, layout: ["layout_fill", "layout_line", "layout_circle", "layout_heatmap", "layout_fill-extrusion", "layout_symbol", "layout_raster", "layout_hillshade", "layout_background"], layout_background: { visibility: { type: "enum", values: { visible: {}, none: {} }, default: "visible", "property-type": "constant" } }, layout_fill: { "fill-sort-key": { type: "number", expression: { interpolated: false, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, visibility: { type: "enum", values: { visible: {}, none: {} }, default: "visible", "property-type": "constant" } }, layout_circle: { "circle-sort-key": { type: "number", expression: { interpolated: false, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, visibility: { type: "enum", values: { visible: {}, none: {} }, default: "visible", "property-type": "constant" } }, layout_heatmap: { visibility: { type: "enum", values: { visible: {}, none: {} }, default: "visible", "property-type": "constant" } }, "layout_fill-extrusion": { visibility: { type: "enum", values: { visible: {}, none: {} }, default: "visible", "property-type": "constant" } }, layout_line: { "line-cap": { type: "enum", values: { butt: {}, round: {}, square: {} }, default: "butt", expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "line-join": { type: "enum", values: { bevel: {}, round: {}, miter: {} }, default: "miter", expression: { interpolated: false, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "line-miter-limit": { type: "number", default: 2, requires: [{ "line-join": "miter" }], expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "line-round-limit": { type: "number", default: 1.05, requires: [{ "line-join": "round" }], expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "line-sort-key": { type: "number", expression: { interpolated: false, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, visibility: { type: "enum", values: { visible: {}, none: {} }, default: "visible", "property-type": "constant" } }, layout_symbol: { "symbol-placement": { type: "enum", values: { point: {}, line: {}, "line-center": {} }, default: "point", expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "symbol-spacing": { type: "number", default: 250, minimum: 1, units: "pixels", requires: [{ "symbol-placement": "line" }], expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "symbol-avoid-edges": { type: "boolean", default: false, expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "symbol-sort-key": { type: "number", expression: { interpolated: false, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "symbol-z-order": { type: "enum", values: { auto: {}, "viewport-y": {}, source: {} }, default: "auto", expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "icon-allow-overlap": { type: "boolean", default: false, requires: ["icon-image", { "!": "icon-overlap" }], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "icon-overlap": { type: "enum", values: { never: {}, always: {}, cooperative: {} }, requires: ["icon-image"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "icon-ignore-placement": { type: "boolean", default: false, requires: ["icon-image"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "icon-optional": { type: "boolean", default: false, requires: ["icon-image", "text-field"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "icon-rotation-alignment": { type: "enum", values: { map: {}, viewport: {}, auto: {} }, default: "auto", requires: ["icon-image"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "icon-size": { type: "number", default: 1, minimum: 0, units: "factor of the original icon size", requires: ["icon-image"], expression: { interpolated: true, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "icon-text-fit": { type: "enum", values: { none: {}, width: {}, height: {}, both: {} }, default: "none", requires: ["icon-image", "text-field"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "icon-text-fit-padding": { type: "array", value: "number", length: 4, default: [0, 0, 0, 0], units: "pixels", requires: ["icon-image", "text-field", { "icon-text-fit": ["both", "width", "height"] }], expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "icon-image": { type: "resolvedImage", tokens: true, expression: { interpolated: false, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "icon-rotate": { type: "number", default: 0, period: 360, units: "degrees", requires: ["icon-image"], expression: { interpolated: true, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "icon-padding": { type: "padding", default: [2], units: "pixels", requires: ["icon-image"], expression: { interpolated: true, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "icon-keep-upright": { type: "boolean", default: false, requires: ["icon-image", { "icon-rotation-alignment": "map" }, { "symbol-placement": ["line", "line-center"] }], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "icon-offset": { type: "array", value: "number", length: 2, default: [0, 0], requires: ["icon-image"], expression: { interpolated: true, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "icon-anchor": { type: "enum", values: { center: {}, left: {}, right: {}, top: {}, bottom: {}, "top-left": {}, "top-right": {}, "bottom-left": {}, "bottom-right": {} }, default: "center", requires: ["icon-image"], expression: { interpolated: false, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "icon-pitch-alignment": { type: "enum", values: { map: {}, viewport: {}, auto: {} }, default: "auto", requires: ["icon-image"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "text-pitch-alignment": { type: "enum", values: { map: {}, viewport: {}, auto: {} }, default: "auto", requires: ["text-field"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "text-rotation-alignment": { type: "enum", values: { map: {}, viewport: {}, "viewport-glyph": {}, auto: {} }, default: "auto", requires: ["text-field"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "text-field": { type: "formatted", default: "", tokens: true, expression: { interpolated: false, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "text-font": { type: "array", value: "string", default: ["Open Sans Regular", "Arial Unicode MS Regular"], requires: ["text-field"], expression: { interpolated: false, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "text-size": { type: "number", default: 16, minimum: 0, units: "pixels", requires: ["text-field"], expression: { interpolated: true, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "text-max-width": { type: "number", default: 10, minimum: 0, units: "ems", requires: ["text-field"], expression: { interpolated: true, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "text-line-height": { type: "number", default: 1.2, units: "ems", requires: ["text-field"], expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "text-letter-spacing": { type: "number", default: 0, units: "ems", requires: ["text-field"], expression: { interpolated: true, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "text-justify": { type: "enum", values: { auto: {}, left: {}, center: {}, right: {} }, default: "center", requires: ["text-field"], expression: { interpolated: false, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "text-radial-offset": { type: "number", units: "ems", default: 0, requires: ["text-field"], "property-type": "data-driven", expression: { interpolated: true, parameters: ["zoom", "feature"] } }, "text-variable-anchor": { type: "array", value: "enum", values: { center: {}, left: {}, right: {}, top: {}, bottom: {}, "top-left": {}, "top-right": {}, "bottom-left": {}, "bottom-right": {} }, requires: ["text-field", { "symbol-placement": ["point"] }], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "text-anchor": { type: "enum", values: { center: {}, left: {}, right: {}, top: {}, bottom: {}, "top-left": {}, "top-right": {}, "bottom-left": {}, "bottom-right": {} }, default: "center", requires: ["text-field", { "!": "text-variable-anchor" }], expression: { interpolated: false, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "text-max-angle": { type: "number", default: 45, units: "degrees", requires: ["text-field", { "symbol-placement": ["line", "line-center"] }], expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "text-writing-mode": { type: "array", value: "enum", values: { horizontal: {}, vertical: {} }, requires: ["text-field", { "symbol-placement": ["point"] }], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "text-rotate": { type: "number", default: 0, period: 360, units: "degrees", requires: ["text-field"], expression: { interpolated: true, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "text-padding": { type: "number", default: 2, minimum: 0, units: "pixels", requires: ["text-field"], expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "text-keep-upright": { type: "boolean", default: true, requires: ["text-field", { "text-rotation-alignment": "map" }, { "symbol-placement": ["line", "line-center"] }], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "text-transform": { type: "enum", values: { none: {}, uppercase: {}, lowercase: {} }, default: "none", requires: ["text-field"], expression: { interpolated: false, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "text-offset": { type: "array", value: "number", units: "ems", length: 2, default: [0, 0], requires: ["text-field", { "!": "text-radial-offset" }], expression: { interpolated: true, parameters: ["zoom", "feature"] }, "property-type": "data-driven" }, "text-allow-overlap": { type: "boolean", default: false, requires: ["text-field", { "!": "text-overlap" }], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "text-overlap": { type: "enum", values: { never: {}, always: {}, cooperative: {} }, requires: ["text-field"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "text-ignore-placement": { type: "boolean", default: false, requires: ["text-field"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "text-optional": { type: "boolean", default: false, requires: ["text-field", "icon-image"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, visibility: { type: "enum", values: { visible: {}, none: {} }, default: "visible", "property-type": "constant" } }, layout_raster: { visibility: { type: "enum", values: { visible: {}, none: {} }, default: "visible", "property-type": "constant" } }, layout_hillshade: { visibility: { type: "enum", values: { visible: {}, none: {} }, default: "visible", "property-type": "constant" } }, filter: { type: "array", value: "*" }, filter_operator: { type: "enum", values: { "==": {}, "!=": {}, ">": {}, ">=": {}, "<": {}, "<=": {}, in: {}, "!in": {}, all: {}, any: {}, none: {}, has: {}, "!has": {}, within: {} } }, geometry_type: { type: "enum", values: { Point: {}, LineString: {}, Polygon: {} } }, function: { expression: { type: "expression" }, stops: { type: "array", value: "function_stop" }, base: { type: "number", default: 1, minimum: 0 }, property: { type: "string", default: "$zoom" }, type: { type: "enum", values: { identity: {}, exponential: {}, interval: {}, categorical: {} }, default: "exponential" }, colorSpace: { type: "enum", values: { rgb: {}, lab: {}, hcl: {} }, default: "rgb" }, default: { type: "*", required: false } }, function_stop: { type: "array", minimum: 0, maximum: 24, value: ["number", "color"], length: 2 }, expression: { type: "array", value: "*", minimum: 1 }, light: { anchor: { type: "enum", default: "viewport", values: { map: {}, viewport: {} }, "property-type": "data-constant", transition: false, expression: { interpolated: false, parameters: ["zoom"] } }, position: { type: "array", default: [1.15, 210, 30], length: 3, value: "number", "property-type": "data-constant", transition: true, expression: { interpolated: true, parameters: ["zoom"] } }, color: { type: "color", "property-type": "data-constant", default: "#ffffff", expression: { interpolated: true, parameters: ["zoom"] }, transition: true }, intensity: { type: "number", "property-type": "data-constant", default: 0.5, minimum: 0, maximum: 1, expression: { interpolated: true, parameters: ["zoom"] }, transition: true } }, terrain: { source: { type: "string", required: true }, exaggeration: { type: "number", minimum: 0, default: 1 }, elevationOffset: { type: "number", default: 450 } }, paint: ["paint_fill", "paint_line", "paint_circle", "paint_heatmap", "paint_fill-extrusion", "paint_symbol", "paint_raster", "paint_hillshade", "paint_background"], paint_fill: { "fill-antialias": { type: "boolean", default: true, expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "fill-opacity": { type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "fill-color": { type: "color", default: "#000000", transition: true, requires: [{ "!": "fill-pattern" }], expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "fill-outline-color": { type: "color", transition: true, requires: [{ "!": "fill-pattern" }, { "fill-antialias": true }], expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "fill-translate": { type: "array", value: "number", length: 2, default: [0, 0], transition: true, units: "pixels", expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "fill-translate-anchor": { type: "enum", values: { map: {}, viewport: {} }, default: "map", requires: ["fill-translate"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "fill-pattern": { type: "resolvedImage", transition: true, expression: { interpolated: false, parameters: ["zoom", "feature"] }, "property-type": "cross-faded-data-driven" } }, "paint_fill-extrusion": { "fill-extrusion-opacity": { type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "fill-extrusion-color": { type: "color", default: "#000000", transition: true, requires: [{ "!": "fill-extrusion-pattern" }], expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "fill-extrusion-translate": { type: "array", value: "number", length: 2, default: [0, 0], transition: true, units: "pixels", expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "fill-extrusion-translate-anchor": { type: "enum", values: { map: {}, viewport: {} }, default: "map", requires: ["fill-extrusion-translate"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "fill-extrusion-pattern": { type: "resolvedImage", transition: true, expression: { interpolated: false, parameters: ["zoom", "feature"] }, "property-type": "cross-faded-data-driven" }, "fill-extrusion-height": { type: "number", default: 0, minimum: 0, units: "meters", transition: true, expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "fill-extrusion-base": { type: "number", default: 0, minimum: 0, units: "meters", transition: true, requires: ["fill-extrusion-height"], expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "fill-extrusion-vertical-gradient": { type: "boolean", default: true, transition: false, expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" } }, paint_line: { "line-opacity": { type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "line-color": { type: "color", default: "#000000", transition: true, requires: [{ "!": "line-pattern" }], expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "line-translate": { type: "array", value: "number", length: 2, default: [0, 0], transition: true, units: "pixels", expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "line-translate-anchor": { type: "enum", values: { map: {}, viewport: {} }, default: "map", requires: ["line-translate"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "line-width": { type: "number", default: 1, minimum: 0, transition: true, units: "pixels", expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "line-gap-width": { type: "number", default: 0, minimum: 0, transition: true, units: "pixels", expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "line-offset": { type: "number", default: 0, transition: true, units: "pixels", expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "line-blur": { type: "number", default: 0, minimum: 0, transition: true, units: "pixels", expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "line-dasharray": { type: "array", value: "number", minimum: 0, transition: true, units: "line widths", requires: [{ "!": "line-pattern" }], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "cross-faded" }, "line-pattern": { type: "resolvedImage", transition: true, expression: { interpolated: false, parameters: ["zoom", "feature"] }, "property-type": "cross-faded-data-driven" }, "line-gradient": { type: "color", transition: false, requires: [{ "!": "line-dasharray" }, { "!": "line-pattern" }, { source: "geojson", has: { lineMetrics: true } }], expression: { interpolated: true, parameters: ["line-progress"] }, "property-type": "color-ramp" } }, paint_circle: { "circle-radius": { type: "number", default: 5, minimum: 0, transition: true, units: "pixels", expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "circle-color": { type: "color", default: "#000000", transition: true, expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "circle-blur": { type: "number", default: 0, transition: true, expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "circle-opacity": { type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "circle-translate": { type: "array", value: "number", length: 2, default: [0, 0], transition: true, units: "pixels", expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "circle-translate-anchor": { type: "enum", values: { map: {}, viewport: {} }, default: "map", requires: ["circle-translate"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "circle-pitch-scale": { type: "enum", values: { map: {}, viewport: {} }, default: "map", expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "circle-pitch-alignment": { type: "enum", values: { map: {}, viewport: {} }, default: "viewport", expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "circle-stroke-width": { type: "number", default: 0, minimum: 0, transition: true, units: "pixels", expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "circle-stroke-color": { type: "color", default: "#000000", transition: true, expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "circle-stroke-opacity": { type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" } }, paint_heatmap: { "heatmap-radius": { type: "number", default: 30, minimum: 1, transition: true, units: "pixels", expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "heatmap-weight": { type: "number", default: 1, minimum: 0, transition: false, expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "heatmap-intensity": { type: "number", default: 1, minimum: 0, transition: true, expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "heatmap-color": { type: "color", default: ["interpolate", ["linear"], ["heatmap-density"], 0, "rgba(0, 0, 255, 0)", 0.1, "royalblue", 0.3, "cyan", 0.5, "lime", 0.7, "yellow", 1, "red"], transition: false, expression: { interpolated: true, parameters: ["heatmap-density"] }, "property-type": "color-ramp" }, "heatmap-opacity": { type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" } }, paint_symbol: { "icon-opacity": { type: "number", default: 1, minimum: 0, maximum: 1, transition: true, requires: ["icon-image"], expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "icon-color": { type: "color", default: "#000000", transition: true, requires: ["icon-image"], expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "icon-halo-color": { type: "color", default: "rgba(0, 0, 0, 0)", transition: true, requires: ["icon-image"], expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "icon-halo-width": { type: "number", default: 0, minimum: 0, transition: true, units: "pixels", requires: ["icon-image"], expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "icon-halo-blur": { type: "number", default: 0, minimum: 0, transition: true, units: "pixels", requires: ["icon-image"], expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "icon-translate": { type: "array", value: "number", length: 2, default: [0, 0], transition: true, units: "pixels", requires: ["icon-image"], expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "icon-translate-anchor": { type: "enum", values: { map: {}, viewport: {} }, default: "map", requires: ["icon-image", "icon-translate"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "text-opacity": { type: "number", default: 1, minimum: 0, maximum: 1, transition: true, requires: ["text-field"], expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "text-color": { type: "color", default: "#000000", transition: true, overridable: true, requires: ["text-field"], expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "text-halo-color": { type: "color", default: "rgba(0, 0, 0, 0)", transition: true, requires: ["text-field"], expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "text-halo-width": { type: "number", default: 0, minimum: 0, transition: true, units: "pixels", requires: ["text-field"], expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "text-halo-blur": { type: "number", default: 0, minimum: 0, transition: true, units: "pixels", requires: ["text-field"], expression: { interpolated: true, parameters: ["zoom", "feature", "feature-state"] }, "property-type": "data-driven" }, "text-translate": { type: "array", value: "number", length: 2, default: [0, 0], transition: true, units: "pixels", requires: ["text-field"], expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "text-translate-anchor": { type: "enum", values: { map: {}, viewport: {} }, default: "map", requires: ["text-field", "text-translate"], expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" } }, paint_raster: { "raster-opacity": { type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "raster-hue-rotate": { type: "number", default: 0, period: 360, transition: true, units: "degrees", expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "raster-brightness-min": { type: "number", default: 0, minimum: 0, maximum: 1, transition: true, expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "raster-brightness-max": { type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "raster-saturation": { type: "number", default: 0, minimum: -1, maximum: 1, transition: true, expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "raster-contrast": { type: "number", default: 0, minimum: -1, maximum: 1, transition: true, expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "raster-resampling": { type: "enum", values: { linear: {}, nearest: {} }, default: "linear", expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "raster-fade-duration": { type: "number", default: 300, minimum: 0, transition: false, units: "milliseconds", expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" } }, paint_hillshade: { "hillshade-illumination-direction": { type: "number", default: 335, minimum: 0, maximum: 359, transition: false, expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "hillshade-illumination-anchor": { type: "enum", values: { map: {}, viewport: {} }, default: "viewport", expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "data-constant" }, "hillshade-exaggeration": { type: "number", default: 0.5, minimum: 0, maximum: 1, transition: true, expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "hillshade-shadow-color": { type: "color", default: "#000000", transition: true, expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "hillshade-highlight-color": { type: "color", default: "#FFFFFF", transition: true, expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "hillshade-accent-color": { type: "color", default: "#000000", transition: true, expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" } }, paint_background: { "background-color": { type: "color", default: "#000000", transition: true, requires: [{ "!": "background-pattern" }], expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" }, "background-pattern": { type: "resolvedImage", transition: true, expression: { interpolated: false, parameters: ["zoom"] }, "property-type": "cross-faded" }, "background-opacity": { type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: { interpolated: true, parameters: ["zoom"] }, "property-type": "data-constant" } }, transition: { duration: { type: "number", default: 300, minimum: 0, units: "milliseconds" }, delay: { type: "number", default: 0, minimum: 0, units: "milliseconds" } }, "property-type": { "data-driven": { type: "property-type" }, "cross-faded": { type: "property-type" }, "cross-faded-data-driven": { type: "property-type" }, "color-ramp": { type: "property-type" }, "data-constant": { type: "property-type" }, constant: { type: "property-type" } }, promoteId: { "*": { type: "string" } } };
        class it {
          constructor(t2, e2, r2, n2) {
            this.message = (t2 ? `${t2}: ` : "") + r2, n2 && (this.identifier = n2), null != e2 && e2.__line__ && (this.line = e2.__line__);
          }
        }
        function at(t2) {
          const e2 = t2.value;
          return e2 ? [new it(t2.key, e2, "constants have been deprecated as of v8")] : [];
        }
        function st(t2, ...e2) {
          for (const r2 of e2)
            for (const e3 in r2)
              t2[e3] = r2[e3];
          return t2;
        }
        function ot(t2) {
          return t2 instanceof Number || t2 instanceof String || t2 instanceof Boolean ? t2.valueOf() : t2;
        }
        function lt(t2) {
          if (Array.isArray(t2))
            return t2.map(lt);
          if (t2 instanceof Object && !(t2 instanceof Number || t2 instanceof String || t2 instanceof Boolean)) {
            const e2 = {};
            for (const r2 in t2)
              e2[r2] = lt(t2[r2]);
            return e2;
          }
          return ot(t2);
        }
        class ut extends Error {
          constructor(t2, e2) {
            super(e2), this.message = e2, this.key = t2;
          }
        }
        class ct {
          constructor(t2, e2 = []) {
            this.parent = t2, this.bindings = {};
            for (const [t3, r2] of e2)
              this.bindings[t3] = r2;
          }
          concat(t2) {
            return new ct(this, t2);
          }
          get(t2) {
            if (this.bindings[t2])
              return this.bindings[t2];
            if (this.parent)
              return this.parent.get(t2);
            throw new Error(`${t2} not found in scope.`);
          }
          has(t2) {
            return !!this.bindings[t2] || !!this.parent && this.parent.has(t2);
          }
        }
        const ht = { kind: "null" }, pt = { kind: "number" }, ft = { kind: "string" }, dt = { kind: "boolean" }, yt = { kind: "color" }, mt = { kind: "object" }, gt = { kind: "value" }, xt = { kind: "collator" }, vt = { kind: "formatted" }, bt = { kind: "padding" }, wt = { kind: "resolvedImage" };
        function _t(t2, e2) {
          return { kind: "array", itemType: t2, N: e2 };
        }
        function At(t2) {
          if ("array" === t2.kind) {
            const e2 = At(t2.itemType);
            return "number" == typeof t2.N ? `array<${e2}, ${t2.N}>` : "value" === t2.itemType.kind ? "array" : `array<${e2}>`;
          }
          return t2.kind;
        }
        const kt = [ht, pt, ft, dt, yt, vt, mt, _t(gt), bt, wt];
        function St(t2, e2) {
          if ("error" === e2.kind)
            return null;
          if ("array" === t2.kind) {
            if ("array" === e2.kind && (0 === e2.N && "value" === e2.itemType.kind || !St(t2.itemType, e2.itemType)) && ("number" != typeof t2.N || t2.N === e2.N))
              return null;
          } else {
            if (t2.kind === e2.kind)
              return null;
            if ("value" === t2.kind) {
              for (const t3 of kt)
                if (!St(t3, e2))
                  return null;
            }
          }
          return `Expected ${At(t2)} but found ${At(e2)} instead.`;
        }
        function It(t2, e2) {
          return e2.some((e3) => e3.kind === t2.kind);
        }
        function Mt(t2, e2) {
          return e2.some((e3) => "null" === e3 ? null === t2 : "array" === e3 ? Array.isArray(t2) : "object" === e3 ? t2 && !Array.isArray(t2) && "object" == typeof t2 : e3 === typeof t2);
        }
        var zt, Bt = { transparent: [0, 0, 0, 0], aliceblue: [240, 248, 255, 1], antiquewhite: [250, 235, 215, 1], aqua: [0, 255, 255, 1], aquamarine: [127, 255, 212, 1], azure: [240, 255, 255, 1], beige: [245, 245, 220, 1], bisque: [255, 228, 196, 1], black: [0, 0, 0, 1], blanchedalmond: [255, 235, 205, 1], blue: [0, 0, 255, 1], blueviolet: [138, 43, 226, 1], brown: [165, 42, 42, 1], burlywood: [222, 184, 135, 1], cadetblue: [95, 158, 160, 1], chartreuse: [127, 255, 0, 1], chocolate: [210, 105, 30, 1], coral: [255, 127, 80, 1], cornflowerblue: [100, 149, 237, 1], cornsilk: [255, 248, 220, 1], crimson: [220, 20, 60, 1], cyan: [0, 255, 255, 1], darkblue: [0, 0, 139, 1], darkcyan: [0, 139, 139, 1], darkgoldenrod: [184, 134, 11, 1], darkgray: [169, 169, 169, 1], darkgreen: [0, 100, 0, 1], darkgrey: [169, 169, 169, 1], darkkhaki: [189, 183, 107, 1], darkmagenta: [139, 0, 139, 1], darkolivegreen: [85, 107, 47, 1], darkorange: [255, 140, 0, 1], darkorchid: [153, 50, 204, 1], darkred: [139, 0, 0, 1], darksalmon: [233, 150, 122, 1], darkseagreen: [143, 188, 143, 1], darkslateblue: [72, 61, 139, 1], darkslategray: [47, 79, 79, 1], darkslategrey: [47, 79, 79, 1], darkturquoise: [0, 206, 209, 1], darkviolet: [148, 0, 211, 1], deeppink: [255, 20, 147, 1], deepskyblue: [0, 191, 255, 1], dimgray: [105, 105, 105, 1], dimgrey: [105, 105, 105, 1], dodgerblue: [30, 144, 255, 1], firebrick: [178, 34, 34, 1], floralwhite: [255, 250, 240, 1], forestgreen: [34, 139, 34, 1], fuchsia: [255, 0, 255, 1], gainsboro: [220, 220, 220, 1], ghostwhite: [248, 248, 255, 1], gold: [255, 215, 0, 1], goldenrod: [218, 165, 32, 1], gray: [128, 128, 128, 1], green: [0, 128, 0, 1], greenyellow: [173, 255, 47, 1], grey: [128, 128, 128, 1], honeydew: [240, 255, 240, 1], hotpink: [255, 105, 180, 1], indianred: [205, 92, 92, 1], indigo: [75, 0, 130, 1], ivory: [255, 255, 240, 1], khaki: [240, 230, 140, 1], lavender: [230, 230, 250, 1], lavenderblush: [255, 240, 245, 1], lawngreen: [124, 252, 0, 1], lemonchiffon: [255, 250, 205, 1], lightblue: [173, 216, 230, 1], lightcoral: [240, 128, 128, 1], lightcyan: [224, 255, 255, 1], lightgoldenrodyellow: [250, 250, 210, 1], lightgray: [211, 211, 211, 1], lightgreen: [144, 238, 144, 1], lightgrey: [211, 211, 211, 1], lightpink: [255, 182, 193, 1], lightsalmon: [255, 160, 122, 1], lightseagreen: [32, 178, 170, 1], lightskyblue: [135, 206, 250, 1], lightslategray: [119, 136, 153, 1], lightslategrey: [119, 136, 153, 1], lightsteelblue: [176, 196, 222, 1], lightyellow: [255, 255, 224, 1], lime: [0, 255, 0, 1], limegreen: [50, 205, 50, 1], linen: [250, 240, 230, 1], magenta: [255, 0, 255, 1], maroon: [128, 0, 0, 1], mediumaquamarine: [102, 205, 170, 1], mediumblue: [0, 0, 205, 1], mediumorchid: [186, 85, 211, 1], mediumpurple: [147, 112, 219, 1], mediumseagreen: [60, 179, 113, 1], mediumslateblue: [123, 104, 238, 1], mediumspringgreen: [0, 250, 154, 1], mediumturquoise: [72, 209, 204, 1], mediumvioletred: [199, 21, 133, 1], midnightblue: [25, 25, 112, 1], mintcream: [245, 255, 250, 1], mistyrose: [255, 228, 225, 1], moccasin: [255, 228, 181, 1], navajowhite: [255, 222, 173, 1], navy: [0, 0, 128, 1], oldlace: [253, 245, 230, 1], olive: [128, 128, 0, 1], olivedrab: [107, 142, 35, 1], orange: [255, 165, 0, 1], orangered: [255, 69, 0, 1], orchid: [218, 112, 214, 1], palegoldenrod: [238, 232, 170, 1], palegreen: [152, 251, 152, 1], paleturquoise: [175, 238, 238, 1], palevioletred: [219, 112, 147, 1], papayawhip: [255, 239, 213, 1], peachpuff: [255, 218, 185, 1], peru: [205, 133, 63, 1], pink: [255, 192, 203, 1], plum: [221, 160, 221, 1], powderblue: [176, 224, 230, 1], purple: [128, 0, 128, 1], rebeccapurple: [102, 51, 153, 1], red: [255, 0, 0, 1], rosybrown: [188, 143, 143, 1], royalblue: [65, 105, 225, 1], saddlebrown: [139, 69, 19, 1], salmon: [250, 128, 114, 1], sandybrown: [244, 164, 96, 1], seagreen: [46, 139, 87, 1], seashell: [255, 245, 238, 1], sienna: [160, 82, 45, 1], silver: [192, 192, 192, 1], skyblue: [135, 206, 235, 1], slateblue: [106, 90, 205, 1], slategray: [112, 128, 144, 1], slategrey: [112, 128, 144, 1], snow: [255, 250, 250, 1], springgreen: [0, 255, 127, 1], steelblue: [70, 130, 180, 1], tan: [210, 180, 140, 1], teal: [0, 128, 128, 1], thistle: [216, 191, 216, 1], tomato: [255, 99, 71, 1], turquoise: [64, 224, 208, 1], violet: [238, 130, 238, 1], wheat: [245, 222, 179, 1], white: [255, 255, 255, 1], whitesmoke: [245, 245, 245, 1], yellow: [255, 255, 0, 1], yellowgreen: [154, 205, 50, 1] };
        function Ct(t2) {
          return (t2 = Math.round(t2)) < 0 ? 0 : t2 > 255 ? 255 : t2;
        }
        function Pt(t2) {
          return Ct("%" === t2[t2.length - 1] ? parseFloat(t2) / 100 * 255 : parseInt(t2));
        }
        function Vt(t2) {
          return (e2 = "%" === t2[t2.length - 1] ? parseFloat(t2) / 100 : parseFloat(t2)) < 0 ? 0 : e2 > 1 ? 1 : e2;
          var e2;
        }
        function Et(t2, e2, r2) {
          return r2 < 0 ? r2 += 1 : r2 > 1 && (r2 -= 1), 6 * r2 < 1 ? t2 + (e2 - t2) * r2 * 6 : 2 * r2 < 1 ? e2 : 3 * r2 < 2 ? t2 + (e2 - t2) * (2 / 3 - r2) * 6 : t2;
        }
        try {
          zt = {}.parseCSSColor = function(t2) {
            var e2, r2 = t2.replace(/ /g, "").toLowerCase();
            if (r2 in Bt)
              return Bt[r2].slice();
            if ("#" === r2[0])
              return 4 === r2.length ? (e2 = parseInt(r2.substr(1), 16)) >= 0 && e2 <= 4095 ? [(3840 & e2) >> 4 | (3840 & e2) >> 8, 240 & e2 | (240 & e2) >> 4, 15 & e2 | (15 & e2) << 4, 1] : null : 7 === r2.length && (e2 = parseInt(r2.substr(1), 16)) >= 0 && e2 <= 16777215 ? [(16711680 & e2) >> 16, (65280 & e2) >> 8, 255 & e2, 1] : null;
            var n2 = r2.indexOf("("), i2 = r2.indexOf(")");
            if (-1 !== n2 && i2 + 1 === r2.length) {
              var a2 = r2.substr(0, n2), s2 = r2.substr(n2 + 1, i2 - (n2 + 1)).split(","), o2 = 1;
              switch (a2) {
                case "rgba":
                  if (4 !== s2.length)
                    return null;
                  o2 = Vt(s2.pop());
                case "rgb":
                  return 3 !== s2.length ? null : [Pt(s2[0]), Pt(s2[1]), Pt(s2[2]), o2];
                case "hsla":
                  if (4 !== s2.length)
                    return null;
                  o2 = Vt(s2.pop());
                case "hsl":
                  if (3 !== s2.length)
                    return null;
                  var l2 = (parseFloat(s2[0]) % 360 + 360) % 360 / 360, u2 = Vt(s2[1]), c3 = Vt(s2[2]), h2 = c3 <= 0.5 ? c3 * (u2 + 1) : c3 + u2 - c3 * u2, p3 = 2 * c3 - h2;
                  return [Ct(255 * Et(p3, h2, l2 + 1 / 3)), Ct(255 * Et(p3, h2, l2)), Ct(255 * Et(p3, h2, l2 - 1 / 3)), o2];
                default:
                  return null;
              }
            }
            return null;
          };
        } catch (t2) {
        }
        class Ft {
          constructor(t2, e2, r2, n2 = 1) {
            this.r = t2, this.g = e2, this.b = r2, this.a = n2;
          }
          static parse(t2) {
            if (!t2)
              return;
            if (t2 instanceof Ft)
              return t2;
            if ("string" != typeof t2)
              return;
            const e2 = zt(t2);
            return e2 ? new Ft(e2[0] / 255 * e2[3], e2[1] / 255 * e2[3], e2[2] / 255 * e2[3], e2[3]) : void 0;
          }
          toString() {
            const [t2, e2, r2, n2] = this.toArray();
            return `rgba(${Math.round(t2)},${Math.round(e2)},${Math.round(r2)},${n2})`;
          }
          toArray() {
            const { r: t2, g: e2, b: r2, a: n2 } = this;
            return 0 === n2 ? [0, 0, 0, 0] : [255 * t2 / n2, 255 * e2 / n2, 255 * r2 / n2, n2];
          }
        }
        Ft.black = new Ft(0, 0, 0, 1), Ft.white = new Ft(1, 1, 1, 1), Ft.transparent = new Ft(0, 0, 0, 0), Ft.red = new Ft(1, 0, 0, 1);
        class Tt {
          constructor(t2, e2, r2) {
            this.sensitivity = t2 ? e2 ? "variant" : "case" : e2 ? "accent" : "base", this.locale = r2, this.collator = new Intl.Collator(this.locale ? this.locale : [], { sensitivity: this.sensitivity, usage: "search" });
          }
          compare(t2, e2) {
            return this.collator.compare(t2, e2);
          }
          resolvedLocale() {
            return new Intl.Collator(this.locale ? this.locale : []).resolvedOptions().locale;
          }
        }
        class Lt {
          constructor(t2, e2, r2, n2, i2) {
            this.text = t2, this.image = e2, this.scale = r2, this.fontStack = n2, this.textColor = i2;
          }
        }
        class Dt {
          constructor(t2) {
            this.sections = t2;
          }
          static fromString(t2) {
            return new Dt([new Lt(t2, null, null, null, null)]);
          }
          isEmpty() {
            return 0 === this.sections.length || !this.sections.some((t2) => 0 !== t2.text.length || t2.image && 0 !== t2.image.name.length);
          }
          static factory(t2) {
            return t2 instanceof Dt ? t2 : Dt.fromString(t2);
          }
          toString() {
            return 0 === this.sections.length ? "" : this.sections.map((t2) => t2.text).join("");
          }
        }
        class $t {
          constructor(t2) {
            this.values = t2.slice();
          }
          static parse(t2) {
            if (t2 instanceof $t)
              return t2;
            if ("number" == typeof t2)
              return new $t([t2, t2, t2, t2]);
            if (Array.isArray(t2) && !(t2.length < 1 || t2.length > 4)) {
              for (const e2 of t2)
                if ("number" != typeof e2)
                  return;
              switch (t2.length) {
                case 1:
                  t2 = [t2[0], t2[0], t2[0], t2[0]];
                  break;
                case 2:
                  t2 = [t2[0], t2[1], t2[0], t2[1]];
                  break;
                case 3:
                  t2 = [t2[0], t2[1], t2[2], t2[1]];
              }
              return new $t(t2);
            }
          }
          toString() {
            return JSON.stringify(this.values);
          }
        }
        class Rt {
          constructor(t2) {
            this.name = t2.name, this.available = t2.available;
          }
          toString() {
            return this.name;
          }
          static fromString(t2) {
            return t2 ? new Rt({ name: t2, available: false }) : null;
          }
        }
        function Ot(t2, e2, r2, n2) {
          return "number" == typeof t2 && t2 >= 0 && t2 <= 255 && "number" == typeof e2 && e2 >= 0 && e2 <= 255 && "number" == typeof r2 && r2 >= 0 && r2 <= 255 ? void 0 === n2 || "number" == typeof n2 && n2 >= 0 && n2 <= 1 ? null : `Invalid rgba value [${[t2, e2, r2, n2].join(", ")}]: 'a' must be between 0 and 1.` : `Invalid rgba value [${("number" == typeof n2 ? [t2, e2, r2, n2] : [t2, e2, r2]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`;
        }
        function Ut(t2) {
          if (null === t2)
            return true;
          if ("string" == typeof t2)
            return true;
          if ("boolean" == typeof t2)
            return true;
          if ("number" == typeof t2)
            return true;
          if (t2 instanceof Ft)
            return true;
          if (t2 instanceof Tt)
            return true;
          if (t2 instanceof Dt)
            return true;
          if (t2 instanceof $t)
            return true;
          if (t2 instanceof Rt)
            return true;
          if (Array.isArray(t2)) {
            for (const e2 of t2)
              if (!Ut(e2))
                return false;
            return true;
          }
          if ("object" == typeof t2) {
            for (const e2 in t2)
              if (!Ut(t2[e2]))
                return false;
            return true;
          }
          return false;
        }
        function qt(t2) {
          if (null === t2)
            return ht;
          if ("string" == typeof t2)
            return ft;
          if ("boolean" == typeof t2)
            return dt;
          if ("number" == typeof t2)
            return pt;
          if (t2 instanceof Ft)
            return yt;
          if (t2 instanceof Tt)
            return xt;
          if (t2 instanceof Dt)
            return vt;
          if (t2 instanceof $t)
            return bt;
          if (t2 instanceof Rt)
            return wt;
          if (Array.isArray(t2)) {
            const e2 = t2.length;
            let r2;
            for (const e3 of t2) {
              const t3 = qt(e3);
              if (r2) {
                if (r2 === t3)
                  continue;
                r2 = gt;
                break;
              }
              r2 = t3;
            }
            return _t(r2 || gt, e2);
          }
          return mt;
        }
        function jt(t2) {
          const e2 = typeof t2;
          return null === t2 ? "" : "string" === e2 || "number" === e2 || "boolean" === e2 ? String(t2) : t2 instanceof Ft || t2 instanceof Dt || t2 instanceof $t || t2 instanceof Rt ? t2.toString() : JSON.stringify(t2);
        }
        class Nt {
          constructor(t2, e2) {
            this.type = t2, this.value = e2;
          }
          static parse(t2, e2) {
            if (2 !== t2.length)
              return e2.error(`'literal' expression requires exactly one argument, but found ${t2.length - 1} instead.`);
            if (!Ut(t2[1]))
              return e2.error("invalid value");
            const r2 = t2[1];
            let n2 = qt(r2);
            const i2 = e2.expectedType;
            return "array" !== n2.kind || 0 !== n2.N || !i2 || "array" !== i2.kind || "number" == typeof i2.N && 0 !== i2.N || (n2 = i2), new Nt(n2, r2);
          }
          evaluate() {
            return this.value;
          }
          eachChild() {
          }
          outputDefined() {
            return true;
          }
        }
        class Zt {
          constructor(t2) {
            this.name = "ExpressionEvaluationError", this.message = t2;
          }
          toJSON() {
            return this.message;
          }
        }
        const Kt = { string: ft, number: pt, boolean: dt, object: mt };
        class Gt {
          constructor(t2, e2) {
            this.type = t2, this.args = e2;
          }
          static parse(t2, e2) {
            if (t2.length < 2)
              return e2.error("Expected at least one argument.");
            let r2, n2 = 1;
            const i2 = t2[0];
            if ("array" === i2) {
              let i3, a3;
              if (t2.length > 2) {
                const r3 = t2[1];
                if ("string" != typeof r3 || !(r3 in Kt) || "object" === r3)
                  return e2.error('The item type argument of "array" must be one of string, number, boolean', 1);
                i3 = Kt[r3], n2++;
              } else
                i3 = gt;
              if (t2.length > 3) {
                if (null !== t2[2] && ("number" != typeof t2[2] || t2[2] < 0 || t2[2] !== Math.floor(t2[2])))
                  return e2.error('The length argument to "array" must be a positive integer literal', 2);
                a3 = t2[2], n2++;
              }
              r2 = _t(i3, a3);
            } else {
              if (!Kt[i2])
                throw new Error(`Types doesn't contain name = ${i2}`);
              r2 = Kt[i2];
            }
            const a2 = [];
            for (; n2 < t2.length; n2++) {
              const r3 = e2.parse(t2[n2], n2, gt);
              if (!r3)
                return null;
              a2.push(r3);
            }
            return new Gt(r2, a2);
          }
          evaluate(t2) {
            for (let e2 = 0; e2 < this.args.length; e2++) {
              const r2 = this.args[e2].evaluate(t2);
              if (!St(this.type, qt(r2)))
                return r2;
              if (e2 === this.args.length - 1)
                throw new Zt(`Expected value to be of type ${At(this.type)}, but found ${At(qt(r2))} instead.`);
            }
            throw new Error();
          }
          eachChild(t2) {
            this.args.forEach(t2);
          }
          outputDefined() {
            return this.args.every((t2) => t2.outputDefined());
          }
        }
        const Jt = { "to-boolean": dt, "to-color": yt, "to-number": pt, "to-string": ft };
        class Xt {
          constructor(t2, e2) {
            this.type = t2, this.args = e2;
          }
          static parse(t2, e2) {
            if (t2.length < 2)
              return e2.error("Expected at least one argument.");
            const r2 = t2[0];
            if (!Jt[r2])
              throw new Error(`Can't parse ${r2} as it is not part of the known types`);
            if (("to-boolean" === r2 || "to-string" === r2) && 2 !== t2.length)
              return e2.error("Expected one argument.");
            const n2 = Jt[r2], i2 = [];
            for (let r3 = 1; r3 < t2.length; r3++) {
              const n3 = e2.parse(t2[r3], r3, gt);
              if (!n3)
                return null;
              i2.push(n3);
            }
            return new Xt(n2, i2);
          }
          evaluate(t2) {
            if ("boolean" === this.type.kind)
              return Boolean(this.args[0].evaluate(t2));
            if ("color" === this.type.kind) {
              let e2, r2;
              for (const n2 of this.args) {
                if (e2 = n2.evaluate(t2), r2 = null, e2 instanceof Ft)
                  return e2;
                if ("string" == typeof e2) {
                  const r3 = t2.parseColor(e2);
                  if (r3)
                    return r3;
                } else if (Array.isArray(e2) && (r2 = e2.length < 3 || e2.length > 4 ? `Invalid rbga value ${JSON.stringify(e2)}: expected an array containing either three or four numeric values.` : Ot(e2[0], e2[1], e2[2], e2[3]), !r2))
                  return new Ft(e2[0] / 255, e2[1] / 255, e2[2] / 255, e2[3]);
              }
              throw new Zt(r2 || `Could not parse color from value '${"string" == typeof e2 ? e2 : JSON.stringify(e2)}'`);
            }
            if ("padding" === this.type.kind) {
              let e2;
              for (const r2 of this.args) {
                e2 = r2.evaluate(t2);
                const n2 = $t.parse(e2);
                if (n2)
                  return n2;
              }
              throw new Zt(`Could not parse padding from value '${"string" == typeof e2 ? e2 : JSON.stringify(e2)}'`);
            }
            if ("number" === this.type.kind) {
              let e2 = null;
              for (const r2 of this.args) {
                if (e2 = r2.evaluate(t2), null === e2)
                  return 0;
                const n2 = Number(e2);
                if (!isNaN(n2))
                  return n2;
              }
              throw new Zt(`Could not convert ${JSON.stringify(e2)} to number.`);
            }
            return "formatted" === this.type.kind ? Dt.fromString(jt(this.args[0].evaluate(t2))) : "resolvedImage" === this.type.kind ? Rt.fromString(jt(this.args[0].evaluate(t2))) : jt(this.args[0].evaluate(t2));
          }
          eachChild(t2) {
            this.args.forEach(t2);
          }
          outputDefined() {
            return this.args.every((t2) => t2.outputDefined());
          }
        }
        const Yt = ["Unknown", "Point", "LineString", "Polygon"];
        class Ht {
          constructor() {
            this.globals = null, this.feature = null, this.featureState = null, this.formattedSection = null, this._parseColorCache = {}, this.availableImages = null, this.canonical = null;
          }
          id() {
            return this.feature && "id" in this.feature ? this.feature.id : null;
          }
          geometryType() {
            return this.feature ? "number" == typeof this.feature.type ? Yt[this.feature.type] : this.feature.type : null;
          }
          geometry() {
            return this.feature && "geometry" in this.feature ? this.feature.geometry : null;
          }
          canonicalID() {
            return this.canonical;
          }
          properties() {
            return this.feature && this.feature.properties || {};
          }
          parseColor(t2) {
            let e2 = this._parseColorCache[t2];
            return e2 || (e2 = this._parseColorCache[t2] = Ft.parse(t2)), e2;
          }
        }
        class Wt {
          constructor(t2, e2, r2, n2) {
            this.name = t2, this.type = e2, this._evaluate = r2, this.args = n2;
          }
          evaluate(t2) {
            return this._evaluate(t2, this.args);
          }
          eachChild(t2) {
            this.args.forEach(t2);
          }
          outputDefined() {
            return false;
          }
          static parse(t2, e2) {
            const r2 = t2[0], n2 = Wt.definitions[r2];
            if (!n2)
              return e2.error(`Unknown expression "${r2}". If you wanted a literal array, use ["literal", [...]].`, 0);
            const i2 = Array.isArray(n2) ? n2[0] : n2.type, a2 = Array.isArray(n2) ? [[n2[1], n2[2]]] : n2.overloads, s2 = a2.filter(([e3]) => !Array.isArray(e3) || e3.length === t2.length - 1);
            let o2 = null;
            for (const [n3, a3] of s2) {
              o2 = new we(e2.registry, e2.path, null, e2.scope);
              const s3 = [];
              let l2 = false;
              for (let e3 = 1; e3 < t2.length; e3++) {
                const r3 = t2[e3], i3 = Array.isArray(n3) ? n3[e3 - 1] : n3.type, a4 = o2.parse(r3, 1 + s3.length, i3);
                if (!a4) {
                  l2 = true;
                  break;
                }
                s3.push(a4);
              }
              if (!l2)
                if (Array.isArray(n3) && n3.length !== s3.length)
                  o2.error(`Expected ${n3.length} arguments, but found ${s3.length} instead.`);
                else {
                  for (let t3 = 0; t3 < s3.length; t3++) {
                    const e3 = Array.isArray(n3) ? n3[t3] : n3.type, r3 = s3[t3];
                    o2.concat(t3 + 1).checkSubtype(e3, r3.type);
                  }
                  if (0 === o2.errors.length)
                    return new Wt(r2, i2, a3, s3);
                }
            }
            if (1 === s2.length)
              e2.errors.push(...o2.errors);
            else {
              const r3 = (s2.length ? s2 : a2).map(([t3]) => {
                return e3 = t3, Array.isArray(e3) ? `(${e3.map(At).join(", ")})` : `(${At(e3.type)}...)`;
                var e3;
              }).join(" | "), n3 = [];
              for (let r4 = 1; r4 < t2.length; r4++) {
                const i3 = e2.parse(t2[r4], 1 + n3.length);
                if (!i3)
                  return null;
                n3.push(At(i3.type));
              }
              e2.error(`Expected arguments of type ${r3}, but found (${n3.join(", ")}) instead.`);
            }
            return null;
          }
          static register(t2, e2) {
            Wt.definitions = e2;
            for (const r2 in e2)
              t2[r2] = Wt;
          }
        }
        class Qt {
          constructor(t2, e2, r2) {
            this.type = xt, this.locale = r2, this.caseSensitive = t2, this.diacriticSensitive = e2;
          }
          static parse(t2, e2) {
            if (2 !== t2.length)
              return e2.error("Expected one argument.");
            const r2 = t2[1];
            if ("object" != typeof r2 || Array.isArray(r2))
              return e2.error("Collator options argument must be an object.");
            const n2 = e2.parse(void 0 !== r2["case-sensitive"] && r2["case-sensitive"], 1, dt);
            if (!n2)
              return null;
            const i2 = e2.parse(void 0 !== r2["diacritic-sensitive"] && r2["diacritic-sensitive"], 1, dt);
            if (!i2)
              return null;
            let a2 = null;
            return r2.locale && (a2 = e2.parse(r2.locale, 1, ft), !a2) ? null : new Qt(n2, i2, a2);
          }
          evaluate(t2) {
            return new Tt(this.caseSensitive.evaluate(t2), this.diacriticSensitive.evaluate(t2), this.locale ? this.locale.evaluate(t2) : null);
          }
          eachChild(t2) {
            t2(this.caseSensitive), t2(this.diacriticSensitive), this.locale && t2(this.locale);
          }
          outputDefined() {
            return false;
          }
        }
        const te = 8192;
        function ee(t2, e2) {
          t2[0] = Math.min(t2[0], e2[0]), t2[1] = Math.min(t2[1], e2[1]), t2[2] = Math.max(t2[2], e2[0]), t2[3] = Math.max(t2[3], e2[1]);
        }
        function re(t2, e2) {
          return !(t2[0] <= e2[0] || t2[2] >= e2[2] || t2[1] <= e2[1] || t2[3] >= e2[3]);
        }
        function ne(t2, e2) {
          const r2 = (180 + t2[0]) / 360, n2 = (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + t2[1] * Math.PI / 360))) / 360, i2 = Math.pow(2, e2.z);
          return [Math.round(r2 * i2 * te), Math.round(n2 * i2 * te)];
        }
        function ie(t2, e2, r2) {
          const n2 = t2[0] - e2[0], i2 = t2[1] - e2[1], a2 = t2[0] - r2[0], s2 = t2[1] - r2[1];
          return n2 * s2 - a2 * i2 == 0 && n2 * a2 <= 0 && i2 * s2 <= 0;
        }
        function ae(t2, e2) {
          let r2 = false;
          for (let s2 = 0, o2 = e2.length; s2 < o2; s2++) {
            const o3 = e2[s2];
            for (let e3 = 0, s3 = o3.length; e3 < s3 - 1; e3++) {
              if (ie(t2, o3[e3], o3[e3 + 1]))
                return false;
              (i2 = o3[e3])[1] > (n2 = t2)[1] != (a2 = o3[e3 + 1])[1] > n2[1] && n2[0] < (a2[0] - i2[0]) * (n2[1] - i2[1]) / (a2[1] - i2[1]) + i2[0] && (r2 = !r2);
            }
          }
          var n2, i2, a2;
          return r2;
        }
        function se(t2, e2) {
          for (let r2 = 0; r2 < e2.length; r2++)
            if (ae(t2, e2[r2]))
              return true;
          return false;
        }
        function oe(t2, e2, r2, n2) {
          const i2 = n2[0] - r2[0], a2 = n2[1] - r2[1], s2 = (t2[0] - r2[0]) * a2 - i2 * (t2[1] - r2[1]), o2 = (e2[0] - r2[0]) * a2 - i2 * (e2[1] - r2[1]);
          return s2 > 0 && o2 < 0 || s2 < 0 && o2 > 0;
        }
        function le(t2, e2, r2) {
          for (const u2 of r2)
            for (let r3 = 0; r3 < u2.length - 1; ++r3)
              if (0 != (o2 = [(s2 = u2[r3 + 1])[0] - (a2 = u2[r3])[0], s2[1] - a2[1]])[0] * (l2 = [(i2 = e2)[0] - (n2 = t2)[0], i2[1] - n2[1]])[1] - o2[1] * l2[0] && oe(n2, i2, a2, s2) && oe(a2, s2, n2, i2))
                return true;
          var n2, i2, a2, s2, o2, l2;
          return false;
        }
        function ue(t2, e2) {
          for (let r2 = 0; r2 < t2.length; ++r2)
            if (!ae(t2[r2], e2))
              return false;
          for (let r2 = 0; r2 < t2.length - 1; ++r2)
            if (le(t2[r2], t2[r2 + 1], e2))
              return false;
          return true;
        }
        function ce(t2, e2) {
          for (let r2 = 0; r2 < e2.length; r2++)
            if (ue(t2, e2[r2]))
              return true;
          return false;
        }
        function he(t2, e2, r2) {
          const n2 = [];
          for (let i2 = 0; i2 < t2.length; i2++) {
            const a2 = [];
            for (let n3 = 0; n3 < t2[i2].length; n3++) {
              const s2 = ne(t2[i2][n3], r2);
              ee(e2, s2), a2.push(s2);
            }
            n2.push(a2);
          }
          return n2;
        }
        function pe(t2, e2, r2) {
          const n2 = [];
          for (let i2 = 0; i2 < t2.length; i2++) {
            const a2 = he(t2[i2], e2, r2);
            n2.push(a2);
          }
          return n2;
        }
        function fe(t2, e2, r2, n2) {
          if (t2[0] < r2[0] || t2[0] > r2[2]) {
            const e3 = 0.5 * n2;
            let i2 = t2[0] - r2[0] > e3 ? -n2 : r2[0] - t2[0] > e3 ? n2 : 0;
            0 === i2 && (i2 = t2[0] - r2[2] > e3 ? -n2 : r2[2] - t2[0] > e3 ? n2 : 0), t2[0] += i2;
          }
          ee(e2, t2);
        }
        function de(t2, e2, r2, n2) {
          const i2 = Math.pow(2, n2.z) * te, a2 = [n2.x * te, n2.y * te], s2 = [];
          for (const n3 of t2)
            for (const t3 of n3) {
              const n4 = [t3.x + a2[0], t3.y + a2[1]];
              fe(n4, e2, r2, i2), s2.push(n4);
            }
          return s2;
        }
        function ye(t2, e2, r2, n2) {
          const i2 = Math.pow(2, n2.z) * te, a2 = [n2.x * te, n2.y * te], s2 = [];
          for (const r3 of t2) {
            const t3 = [];
            for (const n3 of r3) {
              const r4 = [n3.x + a2[0], n3.y + a2[1]];
              ee(e2, r4), t3.push(r4);
            }
            s2.push(t3);
          }
          if (e2[2] - e2[0] <= i2 / 2) {
            (o2 = e2)[0] = o2[1] = 1 / 0, o2[2] = o2[3] = -1 / 0;
            for (const t3 of s2)
              for (const n3 of t3)
                fe(n3, e2, r2, i2);
          }
          var o2;
          return s2;
        }
        class me {
          constructor(t2, e2) {
            this.type = dt, this.geojson = t2, this.geometries = e2;
          }
          static parse(t2, e2) {
            if (2 !== t2.length)
              return e2.error(`'within' expression requires exactly one argument, but found ${t2.length - 1} instead.`);
            if (Ut(t2[1])) {
              const e3 = t2[1];
              if ("FeatureCollection" === e3.type)
                for (let t3 = 0; t3 < e3.features.length; ++t3) {
                  const r2 = e3.features[t3].geometry.type;
                  if ("Polygon" === r2 || "MultiPolygon" === r2)
                    return new me(e3, e3.features[t3].geometry);
                }
              else if ("Feature" === e3.type) {
                const t3 = e3.geometry.type;
                if ("Polygon" === t3 || "MultiPolygon" === t3)
                  return new me(e3, e3.geometry);
              } else if ("Polygon" === e3.type || "MultiPolygon" === e3.type)
                return new me(e3, e3);
            }
            return e2.error("'within' expression requires valid geojson object that contains polygon geometry type.");
          }
          evaluate(t2) {
            if (null != t2.geometry() && null != t2.canonicalID()) {
              if ("Point" === t2.geometryType())
                return function(t3, e2) {
                  const r2 = [1 / 0, 1 / 0, -1 / 0, -1 / 0], n2 = [1 / 0, 1 / 0, -1 / 0, -1 / 0], i2 = t3.canonicalID();
                  if ("Polygon" === e2.type) {
                    const a2 = he(e2.coordinates, n2, i2), s2 = de(t3.geometry(), r2, n2, i2);
                    if (!re(r2, n2))
                      return false;
                    for (const t4 of s2)
                      if (!ae(t4, a2))
                        return false;
                  }
                  if ("MultiPolygon" === e2.type) {
                    const a2 = pe(e2.coordinates, n2, i2), s2 = de(t3.geometry(), r2, n2, i2);
                    if (!re(r2, n2))
                      return false;
                    for (const t4 of s2)
                      if (!se(t4, a2))
                        return false;
                  }
                  return true;
                }(t2, this.geometries);
              if ("LineString" === t2.geometryType())
                return function(t3, e2) {
                  const r2 = [1 / 0, 1 / 0, -1 / 0, -1 / 0], n2 = [1 / 0, 1 / 0, -1 / 0, -1 / 0], i2 = t3.canonicalID();
                  if ("Polygon" === e2.type) {
                    const a2 = he(e2.coordinates, n2, i2), s2 = ye(t3.geometry(), r2, n2, i2);
                    if (!re(r2, n2))
                      return false;
                    for (const t4 of s2)
                      if (!ue(t4, a2))
                        return false;
                  }
                  if ("MultiPolygon" === e2.type) {
                    const a2 = pe(e2.coordinates, n2, i2), s2 = ye(t3.geometry(), r2, n2, i2);
                    if (!re(r2, n2))
                      return false;
                    for (const t4 of s2)
                      if (!ce(t4, a2))
                        return false;
                  }
                  return true;
                }(t2, this.geometries);
            }
            return false;
          }
          eachChild() {
          }
          outputDefined() {
            return true;
          }
        }
        function ge(t2) {
          if (t2 instanceof Wt) {
            if ("get" === t2.name && 1 === t2.args.length)
              return false;
            if ("feature-state" === t2.name)
              return false;
            if ("has" === t2.name && 1 === t2.args.length)
              return false;
            if ("properties" === t2.name || "geometry-type" === t2.name || "id" === t2.name)
              return false;
            if (/^filter-/.test(t2.name))
              return false;
          }
          if (t2 instanceof me)
            return false;
          let e2 = true;
          return t2.eachChild((t3) => {
            e2 && !ge(t3) && (e2 = false);
          }), e2;
        }
        function xe(t2) {
          if (t2 instanceof Wt && "feature-state" === t2.name)
            return false;
          let e2 = true;
          return t2.eachChild((t3) => {
            e2 && !xe(t3) && (e2 = false);
          }), e2;
        }
        function ve(t2, e2) {
          if (t2 instanceof Wt && e2.indexOf(t2.name) >= 0)
            return false;
          let r2 = true;
          return t2.eachChild((t3) => {
            r2 && !ve(t3, e2) && (r2 = false);
          }), r2;
        }
        class be {
          constructor(t2, e2) {
            this.type = e2.type, this.name = t2, this.boundExpression = e2;
          }
          static parse(t2, e2) {
            if (2 !== t2.length || "string" != typeof t2[1])
              return e2.error("'var' expression requires exactly one string literal argument.");
            const r2 = t2[1];
            return e2.scope.has(r2) ? new be(r2, e2.scope.get(r2)) : e2.error(`Unknown variable "${r2}". Make sure "${r2}" has been bound in an enclosing "let" expression before using it.`, 1);
          }
          evaluate(t2) {
            return this.boundExpression.evaluate(t2);
          }
          eachChild() {
          }
          outputDefined() {
            return false;
          }
        }
        class we {
          constructor(t2, e2 = [], r2, n2 = new ct(), i2 = []) {
            this.registry = t2, this.path = e2, this.key = e2.map((t3) => `[${t3}]`).join(""), this.scope = n2, this.errors = i2, this.expectedType = r2;
          }
          parse(t2, e2, r2, n2, i2 = {}) {
            return e2 ? this.concat(e2, r2, n2)._parse(t2, i2) : this._parse(t2, i2);
          }
          _parse(t2, e2) {
            function r2(t3, e3, r3) {
              return "assert" === r3 ? new Gt(e3, [t3]) : "coerce" === r3 ? new Xt(e3, [t3]) : t3;
            }
            if (null !== t2 && "string" != typeof t2 && "boolean" != typeof t2 && "number" != typeof t2 || (t2 = ["literal", t2]), Array.isArray(t2)) {
              if (0 === t2.length)
                return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');
              const n2 = t2[0];
              if ("string" != typeof n2)
                return this.error(`Expression name must be a string, but found ${typeof n2} instead. If you wanted a literal array, use ["literal", [...]].`, 0), null;
              const i2 = this.registry[n2];
              if (i2) {
                let n3 = i2.parse(t2, this);
                if (!n3)
                  return null;
                if (this.expectedType) {
                  const t3 = this.expectedType, i3 = n3.type;
                  if ("string" !== t3.kind && "number" !== t3.kind && "boolean" !== t3.kind && "object" !== t3.kind && "array" !== t3.kind || "value" !== i3.kind)
                    if ("color" !== t3.kind && "formatted" !== t3.kind && "resolvedImage" !== t3.kind || "value" !== i3.kind && "string" !== i3.kind)
                      if ("padding" !== t3.kind || "value" !== i3.kind && "number" !== i3.kind && "array" !== i3.kind) {
                        if (this.checkSubtype(t3, i3))
                          return null;
                      } else
                        n3 = r2(n3, t3, e2.typeAnnotation || "coerce");
                    else
                      n3 = r2(n3, t3, e2.typeAnnotation || "coerce");
                  else
                    n3 = r2(n3, t3, e2.typeAnnotation || "assert");
                }
                if (!(n3 instanceof Nt) && "resolvedImage" !== n3.type.kind && _e(n3)) {
                  const t3 = new Ht();
                  try {
                    n3 = new Nt(n3.type, n3.evaluate(t3));
                  } catch (t4) {
                    return this.error(t4.message), null;
                  }
                }
                return n3;
              }
              return this.error(`Unknown expression "${n2}". If you wanted a literal array, use ["literal", [...]].`, 0);
            }
            return this.error(void 0 === t2 ? "'undefined' value invalid. Use null instead." : "object" == typeof t2 ? 'Bare objects invalid. Use ["literal", {...}] instead.' : `Expected an array, but found ${typeof t2} instead.`);
          }
          concat(t2, e2, r2) {
            const n2 = "number" == typeof t2 ? this.path.concat(t2) : this.path, i2 = r2 ? this.scope.concat(r2) : this.scope;
            return new we(this.registry, n2, e2 || null, i2, this.errors);
          }
          error(t2, ...e2) {
            const r2 = `${this.key}${e2.map((t3) => `[${t3}]`).join("")}`;
            this.errors.push(new ut(r2, t2));
          }
          checkSubtype(t2, e2) {
            const r2 = St(t2, e2);
            return r2 && this.error(r2), r2;
          }
        }
        function _e(t2) {
          if (t2 instanceof be)
            return _e(t2.boundExpression);
          if (t2 instanceof Wt && "error" === t2.name)
            return false;
          if (t2 instanceof Qt)
            return false;
          if (t2 instanceof me)
            return false;
          const e2 = t2 instanceof Xt || t2 instanceof Gt;
          let r2 = true;
          return t2.eachChild((t3) => {
            r2 = e2 ? r2 && _e(t3) : r2 && t3 instanceof Nt;
          }), !!r2 && ge(t2) && ve(t2, ["zoom", "heatmap-density", "line-progress", "accumulated", "is-supported-script"]);
        }
        function Ae(t2, e2) {
          const r2 = t2.length - 1;
          let n2, i2, a2 = 0, s2 = r2, o2 = 0;
          for (; a2 <= s2; )
            if (o2 = Math.floor((a2 + s2) / 2), n2 = t2[o2], i2 = t2[o2 + 1], n2 <= e2) {
              if (o2 === r2 || e2 < i2)
                return o2;
              a2 = o2 + 1;
            } else {
              if (!(n2 > e2))
                throw new Zt("Input is not a number.");
              s2 = o2 - 1;
            }
          return 0;
        }
        class ke {
          constructor(t2, e2, r2) {
            this.type = t2, this.input = e2, this.labels = [], this.outputs = [];
            for (const [t3, e3] of r2)
              this.labels.push(t3), this.outputs.push(e3);
          }
          static parse(t2, e2) {
            if (t2.length - 1 < 4)
              return e2.error(`Expected at least 4 arguments, but found only ${t2.length - 1}.`);
            if ((t2.length - 1) % 2 != 0)
              return e2.error("Expected an even number of arguments.");
            const r2 = e2.parse(t2[1], 1, pt);
            if (!r2)
              return null;
            const n2 = [];
            let i2 = null;
            e2.expectedType && "value" !== e2.expectedType.kind && (i2 = e2.expectedType);
            for (let r3 = 1; r3 < t2.length; r3 += 2) {
              const a2 = 1 === r3 ? -1 / 0 : t2[r3], s2 = t2[r3 + 1], o2 = r3, l2 = r3 + 1;
              if ("number" != typeof a2)
                return e2.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.', o2);
              if (n2.length && n2[n2.length - 1][0] >= a2)
                return e2.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.', o2);
              const u2 = e2.parse(s2, l2, i2);
              if (!u2)
                return null;
              i2 = i2 || u2.type, n2.push([a2, u2]);
            }
            return new ke(i2, r2, n2);
          }
          evaluate(t2) {
            const e2 = this.labels, r2 = this.outputs;
            if (1 === e2.length)
              return r2[0].evaluate(t2);
            const n2 = this.input.evaluate(t2);
            if (n2 <= e2[0])
              return r2[0].evaluate(t2);
            const i2 = e2.length;
            return n2 >= e2[i2 - 1] ? r2[i2 - 1].evaluate(t2) : r2[Ae(e2, n2)].evaluate(t2);
          }
          eachChild(t2) {
            t2(this.input);
            for (const e2 of this.outputs)
              t2(e2);
          }
          outputDefined() {
            return this.outputs.every((t2) => t2.outputDefined());
          }
        }
        function Se(t2, e2, r2) {
          return t2 * (1 - r2) + e2 * r2;
        }
        var Ie = Object.freeze({ __proto__: null, number: Se, color: function(t2, e2, r2) {
          return new Ft(Se(t2.r, e2.r, r2), Se(t2.g, e2.g, r2), Se(t2.b, e2.b, r2), Se(t2.a, e2.a, r2));
        }, array: function(t2, e2, r2) {
          return t2.map((t3, n2) => Se(t3, e2[n2], r2));
        }, padding: function(t2, e2, r2) {
          const n2 = t2.values, i2 = e2.values;
          return new $t([Se(n2[0], i2[0], r2), Se(n2[1], i2[1], r2), Se(n2[2], i2[2], r2), Se(n2[3], i2[3], r2)]);
        } });
        const Me = 0.95047, ze = 1.08883, Be = 4 / 29, Ce = 6 / 29, Pe = 3 * Ce * Ce, Ve = Math.PI / 180, Ee = 180 / Math.PI;
        function Fe(t2) {
          return t2 > 0.008856451679035631 ? Math.pow(t2, 1 / 3) : t2 / Pe + Be;
        }
        function Te(t2) {
          return t2 > Ce ? t2 * t2 * t2 : Pe * (t2 - Be);
        }
        function Le(t2) {
          return 255 * (t2 <= 31308e-7 ? 12.92 * t2 : 1.055 * Math.pow(t2, 1 / 2.4) - 0.055);
        }
        function De(t2) {
          return (t2 /= 255) <= 0.04045 ? t2 / 12.92 : Math.pow((t2 + 0.055) / 1.055, 2.4);
        }
        function $e(t2) {
          const e2 = De(t2.r), r2 = De(t2.g), n2 = De(t2.b), i2 = Fe((0.4124564 * e2 + 0.3575761 * r2 + 0.1804375 * n2) / Me), a2 = Fe((0.2126729 * e2 + 0.7151522 * r2 + 0.072175 * n2) / 1);
          return { l: 116 * a2 - 16, a: 500 * (i2 - a2), b: 200 * (a2 - Fe((0.0193339 * e2 + 0.119192 * r2 + 0.9503041 * n2) / ze)), alpha: t2.a };
        }
        function Re(t2) {
          let e2 = (t2.l + 16) / 116, r2 = isNaN(t2.a) ? e2 : e2 + t2.a / 500, n2 = isNaN(t2.b) ? e2 : e2 - t2.b / 200;
          return e2 = 1 * Te(e2), r2 = Me * Te(r2), n2 = ze * Te(n2), new Ft(Le(3.2404542 * r2 - 1.5371385 * e2 - 0.4985314 * n2), Le(-0.969266 * r2 + 1.8760108 * e2 + 0.041556 * n2), Le(0.0556434 * r2 - 0.2040259 * e2 + 1.0572252 * n2), t2.alpha);
        }
        function Oe(t2, e2, r2) {
          const n2 = e2 - t2;
          return t2 + r2 * (n2 > 180 || n2 < -180 ? n2 - 360 * Math.round(n2 / 360) : n2);
        }
        const Ue = { forward: $e, reverse: Re, interpolate: function(t2, e2, r2) {
          return { l: Se(t2.l, e2.l, r2), a: Se(t2.a, e2.a, r2), b: Se(t2.b, e2.b, r2), alpha: Se(t2.alpha, e2.alpha, r2) };
        } }, qe = { forward: function(t2) {
          const { l: e2, a: r2, b: n2 } = $e(t2), i2 = Math.atan2(n2, r2) * Ee;
          return { h: i2 < 0 ? i2 + 360 : i2, c: Math.sqrt(r2 * r2 + n2 * n2), l: e2, alpha: t2.a };
        }, reverse: function(t2) {
          const e2 = t2.h * Ve, r2 = t2.c;
          return Re({ l: t2.l, a: Math.cos(e2) * r2, b: Math.sin(e2) * r2, alpha: t2.alpha });
        }, interpolate: function(t2, e2, r2) {
          return { h: Oe(t2.h, e2.h, r2), c: Se(t2.c, e2.c, r2), l: Se(t2.l, e2.l, r2), alpha: Se(t2.alpha, e2.alpha, r2) };
        } };
        var je = Object.freeze({ __proto__: null, lab: Ue, hcl: qe });
        class Ne {
          constructor(t2, e2, r2, n2, i2) {
            this.type = t2, this.operator = e2, this.interpolation = r2, this.input = n2, this.labels = [], this.outputs = [];
            for (const [t3, e3] of i2)
              this.labels.push(t3), this.outputs.push(e3);
          }
          static interpolationFactor(t2, r2, n2, i2) {
            let a2 = 0;
            if ("exponential" === t2.name)
              a2 = Ze(r2, t2.base, n2, i2);
            else if ("linear" === t2.name)
              a2 = Ze(r2, 1, n2, i2);
            else if ("cubic-bezier" === t2.name) {
              const s2 = t2.controlPoints;
              a2 = new e(s2[0], s2[1], s2[2], s2[3]).solve(Ze(r2, 1, n2, i2));
            }
            return a2;
          }
          static parse(t2, e2) {
            let [r2, n2, i2, ...a2] = t2;
            if (!Array.isArray(n2) || 0 === n2.length)
              return e2.error("Expected an interpolation type expression.", 1);
            if ("linear" === n2[0])
              n2 = { name: "linear" };
            else if ("exponential" === n2[0]) {
              const t3 = n2[1];
              if ("number" != typeof t3)
                return e2.error("Exponential interpolation requires a numeric base.", 1, 1);
              n2 = { name: "exponential", base: t3 };
            } else {
              if ("cubic-bezier" !== n2[0])
                return e2.error(`Unknown interpolation type ${String(n2[0])}`, 1, 0);
              {
                const t3 = n2.slice(1);
                if (4 !== t3.length || t3.some((t4) => "number" != typeof t4 || t4 < 0 || t4 > 1))
                  return e2.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.", 1);
                n2 = { name: "cubic-bezier", controlPoints: t3 };
              }
            }
            if (t2.length - 1 < 4)
              return e2.error(`Expected at least 4 arguments, but found only ${t2.length - 1}.`);
            if ((t2.length - 1) % 2 != 0)
              return e2.error("Expected an even number of arguments.");
            if (i2 = e2.parse(i2, 2, pt), !i2)
              return null;
            const s2 = [];
            let o2 = null;
            "interpolate-hcl" === r2 || "interpolate-lab" === r2 ? o2 = yt : e2.expectedType && "value" !== e2.expectedType.kind && (o2 = e2.expectedType);
            for (let t3 = 0; t3 < a2.length; t3 += 2) {
              const r3 = a2[t3], n3 = a2[t3 + 1], i3 = t3 + 3, l2 = t3 + 4;
              if ("number" != typeof r3)
                return e2.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.', i3);
              if (s2.length && s2[s2.length - 1][0] >= r3)
                return e2.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.', i3);
              const u2 = e2.parse(n3, l2, o2);
              if (!u2)
                return null;
              o2 = o2 || u2.type, s2.push([r3, u2]);
            }
            return "number" === o2.kind || "color" === o2.kind || "padding" === o2.kind || "array" === o2.kind && "number" === o2.itemType.kind && "number" == typeof o2.N ? new Ne(o2, r2, n2, i2, s2) : e2.error(`Type ${At(o2)} is not interpolatable.`);
          }
          evaluate(t2) {
            const e2 = this.labels, r2 = this.outputs;
            if (1 === e2.length)
              return r2[0].evaluate(t2);
            const n2 = this.input.evaluate(t2);
            if (n2 <= e2[0])
              return r2[0].evaluate(t2);
            const i2 = e2.length;
            if (n2 >= e2[i2 - 1])
              return r2[i2 - 1].evaluate(t2);
            const a2 = Ae(e2, n2), s2 = Ne.interpolationFactor(this.interpolation, n2, e2[a2], e2[a2 + 1]), o2 = r2[a2].evaluate(t2), l2 = r2[a2 + 1].evaluate(t2);
            return "interpolate" === this.operator ? Ie[this.type.kind.toLowerCase()](o2, l2, s2) : "interpolate-hcl" === this.operator ? qe.reverse(qe.interpolate(qe.forward(o2), qe.forward(l2), s2)) : Ue.reverse(Ue.interpolate(Ue.forward(o2), Ue.forward(l2), s2));
          }
          eachChild(t2) {
            t2(this.input);
            for (const e2 of this.outputs)
              t2(e2);
          }
          outputDefined() {
            return this.outputs.every((t2) => t2.outputDefined());
          }
        }
        function Ze(t2, e2, r2, n2) {
          const i2 = n2 - r2, a2 = t2 - r2;
          return 0 === i2 ? 0 : 1 === e2 ? a2 / i2 : (Math.pow(e2, a2) - 1) / (Math.pow(e2, i2) - 1);
        }
        class Ke {
          constructor(t2, e2) {
            this.type = t2, this.args = e2;
          }
          static parse(t2, e2) {
            if (t2.length < 2)
              return e2.error("Expectected at least one argument.");
            let r2 = null;
            const n2 = e2.expectedType;
            n2 && "value" !== n2.kind && (r2 = n2);
            const i2 = [];
            for (const n3 of t2.slice(1)) {
              const t3 = e2.parse(n3, 1 + i2.length, r2, void 0, { typeAnnotation: "omit" });
              if (!t3)
                return null;
              r2 = r2 || t3.type, i2.push(t3);
            }
            if (!r2)
              throw new Error("No output type");
            const a2 = n2 && i2.some((t3) => St(n2, t3.type));
            return new Ke(a2 ? gt : r2, i2);
          }
          evaluate(t2) {
            let e2, r2 = null, n2 = 0;
            for (const i2 of this.args)
              if (n2++, r2 = i2.evaluate(t2), r2 && r2 instanceof Rt && !r2.available && (e2 || (e2 = r2.name), r2 = null, n2 === this.args.length && (r2 = e2)), null !== r2)
                break;
            return r2;
          }
          eachChild(t2) {
            this.args.forEach(t2);
          }
          outputDefined() {
            return this.args.every((t2) => t2.outputDefined());
          }
        }
        class Ge {
          constructor(t2, e2) {
            this.type = e2.type, this.bindings = [].concat(t2), this.result = e2;
          }
          evaluate(t2) {
            return this.result.evaluate(t2);
          }
          eachChild(t2) {
            for (const e2 of this.bindings)
              t2(e2[1]);
            t2(this.result);
          }
          static parse(t2, e2) {
            if (t2.length < 4)
              return e2.error(`Expected at least 3 arguments, but found ${t2.length - 1} instead.`);
            const r2 = [];
            for (let n3 = 1; n3 < t2.length - 1; n3 += 2) {
              const i2 = t2[n3];
              if ("string" != typeof i2)
                return e2.error(`Expected string, but found ${typeof i2} instead.`, n3);
              if (/[^a-zA-Z0-9_]/.test(i2))
                return e2.error("Variable names must contain only alphanumeric characters or '_'.", n3);
              const a2 = e2.parse(t2[n3 + 1], n3 + 1);
              if (!a2)
                return null;
              r2.push([i2, a2]);
            }
            const n2 = e2.parse(t2[t2.length - 1], t2.length - 1, e2.expectedType, r2);
            return n2 ? new Ge(r2, n2) : null;
          }
          outputDefined() {
            return this.result.outputDefined();
          }
        }
        class Je {
          constructor(t2, e2, r2) {
            this.type = t2, this.index = e2, this.input = r2;
          }
          static parse(t2, e2) {
            if (3 !== t2.length)
              return e2.error(`Expected 2 arguments, but found ${t2.length - 1} instead.`);
            const r2 = e2.parse(t2[1], 1, pt), n2 = e2.parse(t2[2], 2, _t(e2.expectedType || gt));
            return r2 && n2 ? new Je(n2.type.itemType, r2, n2) : null;
          }
          evaluate(t2) {
            const e2 = this.index.evaluate(t2), r2 = this.input.evaluate(t2);
            if (e2 < 0)
              throw new Zt(`Array index out of bounds: ${e2} < 0.`);
            if (e2 >= r2.length)
              throw new Zt(`Array index out of bounds: ${e2} > ${r2.length - 1}.`);
            if (e2 !== Math.floor(e2))
              throw new Zt(`Array index must be an integer, but found ${e2} instead.`);
            return r2[e2];
          }
          eachChild(t2) {
            t2(this.index), t2(this.input);
          }
          outputDefined() {
            return false;
          }
        }
        class Xe {
          constructor(t2, e2) {
            this.type = dt, this.needle = t2, this.haystack = e2;
          }
          static parse(t2, e2) {
            if (3 !== t2.length)
              return e2.error(`Expected 2 arguments, but found ${t2.length - 1} instead.`);
            const r2 = e2.parse(t2[1], 1, gt), n2 = e2.parse(t2[2], 2, gt);
            return r2 && n2 ? It(r2.type, [dt, ft, pt, ht, gt]) ? new Xe(r2, n2) : e2.error(`Expected first argument to be of type boolean, string, number or null, but found ${At(r2.type)} instead`) : null;
          }
          evaluate(t2) {
            const e2 = this.needle.evaluate(t2), r2 = this.haystack.evaluate(t2);
            if (!r2)
              return false;
            if (!Mt(e2, ["boolean", "string", "number", "null"]))
              throw new Zt(`Expected first argument to be of type boolean, string, number or null, but found ${At(qt(e2))} instead.`);
            if (!Mt(r2, ["string", "array"]))
              throw new Zt(`Expected second argument to be of type array or string, but found ${At(qt(r2))} instead.`);
            return r2.indexOf(e2) >= 0;
          }
          eachChild(t2) {
            t2(this.needle), t2(this.haystack);
          }
          outputDefined() {
            return true;
          }
        }
        class Ye {
          constructor(t2, e2, r2) {
            this.type = pt, this.needle = t2, this.haystack = e2, this.fromIndex = r2;
          }
          static parse(t2, e2) {
            if (t2.length <= 2 || t2.length >= 5)
              return e2.error(`Expected 3 or 4 arguments, but found ${t2.length - 1} instead.`);
            const r2 = e2.parse(t2[1], 1, gt), n2 = e2.parse(t2[2], 2, gt);
            if (!r2 || !n2)
              return null;
            if (!It(r2.type, [dt, ft, pt, ht, gt]))
              return e2.error(`Expected first argument to be of type boolean, string, number or null, but found ${At(r2.type)} instead`);
            if (4 === t2.length) {
              const i2 = e2.parse(t2[3], 3, pt);
              return i2 ? new Ye(r2, n2, i2) : null;
            }
            return new Ye(r2, n2);
          }
          evaluate(t2) {
            const e2 = this.needle.evaluate(t2), r2 = this.haystack.evaluate(t2);
            if (!Mt(e2, ["boolean", "string", "number", "null"]))
              throw new Zt(`Expected first argument to be of type boolean, string, number or null, but found ${At(qt(e2))} instead.`);
            if (!Mt(r2, ["string", "array"]))
              throw new Zt(`Expected second argument to be of type array or string, but found ${At(qt(r2))} instead.`);
            if (this.fromIndex) {
              const n2 = this.fromIndex.evaluate(t2);
              return r2.indexOf(e2, n2);
            }
            return r2.indexOf(e2);
          }
          eachChild(t2) {
            t2(this.needle), t2(this.haystack), this.fromIndex && t2(this.fromIndex);
          }
          outputDefined() {
            return false;
          }
        }
        class He {
          constructor(t2, e2, r2, n2, i2, a2) {
            this.inputType = t2, this.type = e2, this.input = r2, this.cases = n2, this.outputs = i2, this.otherwise = a2;
          }
          static parse(t2, e2) {
            if (t2.length < 5)
              return e2.error(`Expected at least 4 arguments, but found only ${t2.length - 1}.`);
            if (t2.length % 2 != 1)
              return e2.error("Expected an even number of arguments.");
            let r2, n2;
            e2.expectedType && "value" !== e2.expectedType.kind && (n2 = e2.expectedType);
            const i2 = {}, a2 = [];
            for (let s3 = 2; s3 < t2.length - 1; s3 += 2) {
              let o3 = t2[s3];
              const l2 = t2[s3 + 1];
              Array.isArray(o3) || (o3 = [o3]);
              const u2 = e2.concat(s3);
              if (0 === o3.length)
                return u2.error("Expected at least one branch label.");
              for (const t3 of o3) {
                if ("number" != typeof t3 && "string" != typeof t3)
                  return u2.error("Branch labels must be numbers or strings.");
                if ("number" == typeof t3 && Math.abs(t3) > Number.MAX_SAFE_INTEGER)
                  return u2.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);
                if ("number" == typeof t3 && Math.floor(t3) !== t3)
                  return u2.error("Numeric branch labels must be integer values.");
                if (r2) {
                  if (u2.checkSubtype(r2, qt(t3)))
                    return null;
                } else
                  r2 = qt(t3);
                if (void 0 !== i2[String(t3)])
                  return u2.error("Branch labels must be unique.");
                i2[String(t3)] = a2.length;
              }
              const c3 = e2.parse(l2, s3, n2);
              if (!c3)
                return null;
              n2 = n2 || c3.type, a2.push(c3);
            }
            const s2 = e2.parse(t2[1], 1, gt);
            if (!s2)
              return null;
            const o2 = e2.parse(t2[t2.length - 1], t2.length - 1, n2);
            return o2 ? "value" !== s2.type.kind && e2.concat(1).checkSubtype(r2, s2.type) ? null : new He(r2, n2, s2, i2, a2, o2) : null;
          }
          evaluate(t2) {
            const e2 = this.input.evaluate(t2);
            return (qt(e2) === this.inputType && this.outputs[this.cases[e2]] || this.otherwise).evaluate(t2);
          }
          eachChild(t2) {
            t2(this.input), this.outputs.forEach(t2), t2(this.otherwise);
          }
          outputDefined() {
            return this.outputs.every((t2) => t2.outputDefined()) && this.otherwise.outputDefined();
          }
        }
        class We {
          constructor(t2, e2, r2) {
            this.type = t2, this.branches = e2, this.otherwise = r2;
          }
          static parse(t2, e2) {
            if (t2.length < 4)
              return e2.error(`Expected at least 3 arguments, but found only ${t2.length - 1}.`);
            if (t2.length % 2 != 0)
              return e2.error("Expected an odd number of arguments.");
            let r2;
            e2.expectedType && "value" !== e2.expectedType.kind && (r2 = e2.expectedType);
            const n2 = [];
            for (let i3 = 1; i3 < t2.length - 1; i3 += 2) {
              const a2 = e2.parse(t2[i3], i3, dt);
              if (!a2)
                return null;
              const s2 = e2.parse(t2[i3 + 1], i3 + 1, r2);
              if (!s2)
                return null;
              n2.push([a2, s2]), r2 = r2 || s2.type;
            }
            const i2 = e2.parse(t2[t2.length - 1], t2.length - 1, r2);
            if (!i2)
              return null;
            if (!r2)
              throw new Error("Can't infer output type");
            return new We(r2, n2, i2);
          }
          evaluate(t2) {
            for (const [e2, r2] of this.branches)
              if (e2.evaluate(t2))
                return r2.evaluate(t2);
            return this.otherwise.evaluate(t2);
          }
          eachChild(t2) {
            for (const [e2, r2] of this.branches)
              t2(e2), t2(r2);
            t2(this.otherwise);
          }
          outputDefined() {
            return this.branches.every(([t2, e2]) => e2.outputDefined()) && this.otherwise.outputDefined();
          }
        }
        class Qe {
          constructor(t2, e2, r2, n2) {
            this.type = t2, this.input = e2, this.beginIndex = r2, this.endIndex = n2;
          }
          static parse(t2, e2) {
            if (t2.length <= 2 || t2.length >= 5)
              return e2.error(`Expected 3 or 4 arguments, but found ${t2.length - 1} instead.`);
            const r2 = e2.parse(t2[1], 1, gt), n2 = e2.parse(t2[2], 2, pt);
            if (!r2 || !n2)
              return null;
            if (!It(r2.type, [_t(gt), ft, gt]))
              return e2.error(`Expected first argument to be of type array or string, but found ${At(r2.type)} instead`);
            if (4 === t2.length) {
              const i2 = e2.parse(t2[3], 3, pt);
              return i2 ? new Qe(r2.type, r2, n2, i2) : null;
            }
            return new Qe(r2.type, r2, n2);
          }
          evaluate(t2) {
            const e2 = this.input.evaluate(t2), r2 = this.beginIndex.evaluate(t2);
            if (!Mt(e2, ["string", "array"]))
              throw new Zt(`Expected first argument to be of type array or string, but found ${At(qt(e2))} instead.`);
            if (this.endIndex) {
              const n2 = this.endIndex.evaluate(t2);
              return e2.slice(r2, n2);
            }
            return e2.slice(r2);
          }
          eachChild(t2) {
            t2(this.input), t2(this.beginIndex), this.endIndex && t2(this.endIndex);
          }
          outputDefined() {
            return false;
          }
        }
        function tr(t2, e2) {
          return "==" === t2 || "!=" === t2 ? "boolean" === e2.kind || "string" === e2.kind || "number" === e2.kind || "null" === e2.kind || "value" === e2.kind : "string" === e2.kind || "number" === e2.kind || "value" === e2.kind;
        }
        function er(t2, e2, r2, n2) {
          return 0 === n2.compare(e2, r2);
        }
        function rr(t2, e2, r2) {
          const n2 = "==" !== t2 && "!=" !== t2;
          return class i2 {
            constructor(t3, e3, r3) {
              this.type = dt, this.lhs = t3, this.rhs = e3, this.collator = r3, this.hasUntypedArgument = "value" === t3.type.kind || "value" === e3.type.kind;
            }
            static parse(t3, e3) {
              if (3 !== t3.length && 4 !== t3.length)
                return e3.error("Expected two or three arguments.");
              const r3 = t3[0];
              let a2 = e3.parse(t3[1], 1, gt);
              if (!a2)
                return null;
              if (!tr(r3, a2.type))
                return e3.concat(1).error(`"${r3}" comparisons are not supported for type '${At(a2.type)}'.`);
              let s2 = e3.parse(t3[2], 2, gt);
              if (!s2)
                return null;
              if (!tr(r3, s2.type))
                return e3.concat(2).error(`"${r3}" comparisons are not supported for type '${At(s2.type)}'.`);
              if (a2.type.kind !== s2.type.kind && "value" !== a2.type.kind && "value" !== s2.type.kind)
                return e3.error(`Cannot compare types '${At(a2.type)}' and '${At(s2.type)}'.`);
              n2 && ("value" === a2.type.kind && "value" !== s2.type.kind ? a2 = new Gt(s2.type, [a2]) : "value" !== a2.type.kind && "value" === s2.type.kind && (s2 = new Gt(a2.type, [s2])));
              let o2 = null;
              if (4 === t3.length) {
                if ("string" !== a2.type.kind && "string" !== s2.type.kind && "value" !== a2.type.kind && "value" !== s2.type.kind)
                  return e3.error("Cannot use collator to compare non-string types.");
                if (o2 = e3.parse(t3[3], 3, xt), !o2)
                  return null;
              }
              return new i2(a2, s2, o2);
            }
            evaluate(i3) {
              const a2 = this.lhs.evaluate(i3), s2 = this.rhs.evaluate(i3);
              if (n2 && this.hasUntypedArgument) {
                const e3 = qt(a2), r3 = qt(s2);
                if (e3.kind !== r3.kind || "string" !== e3.kind && "number" !== e3.kind)
                  throw new Zt(`Expected arguments for "${t2}" to be (string, string) or (number, number), but found (${e3.kind}, ${r3.kind}) instead.`);
              }
              if (this.collator && !n2 && this.hasUntypedArgument) {
                const t3 = qt(a2), r3 = qt(s2);
                if ("string" !== t3.kind || "string" !== r3.kind)
                  return e2(i3, a2, s2);
              }
              return this.collator ? r2(i3, a2, s2, this.collator.evaluate(i3)) : e2(i3, a2, s2);
            }
            eachChild(t3) {
              t3(this.lhs), t3(this.rhs), this.collator && t3(this.collator);
            }
            outputDefined() {
              return true;
            }
          };
        }
        const nr = rr("==", function(t2, e2, r2) {
          return e2 === r2;
        }, er), ir = rr("!=", function(t2, e2, r2) {
          return e2 !== r2;
        }, function(t2, e2, r2, n2) {
          return !er(0, e2, r2, n2);
        }), ar = rr("<", function(t2, e2, r2) {
          return e2 < r2;
        }, function(t2, e2, r2, n2) {
          return n2.compare(e2, r2) < 0;
        }), sr = rr(">", function(t2, e2, r2) {
          return e2 > r2;
        }, function(t2, e2, r2, n2) {
          return n2.compare(e2, r2) > 0;
        }), or = rr("<=", function(t2, e2, r2) {
          return e2 <= r2;
        }, function(t2, e2, r2, n2) {
          return n2.compare(e2, r2) <= 0;
        }), lr = rr(">=", function(t2, e2, r2) {
          return e2 >= r2;
        }, function(t2, e2, r2, n2) {
          return n2.compare(e2, r2) >= 0;
        });
        class ur {
          constructor(t2, e2, r2, n2, i2) {
            this.type = ft, this.number = t2, this.locale = e2, this.currency = r2, this.minFractionDigits = n2, this.maxFractionDigits = i2;
          }
          static parse(t2, e2) {
            if (3 !== t2.length)
              return e2.error("Expected two arguments.");
            const r2 = e2.parse(t2[1], 1, pt);
            if (!r2)
              return null;
            const n2 = t2[2];
            if ("object" != typeof n2 || Array.isArray(n2))
              return e2.error("NumberFormat options argument must be an object.");
            let i2 = null;
            if (n2.locale && (i2 = e2.parse(n2.locale, 1, ft), !i2))
              return null;
            let a2 = null;
            if (n2.currency && (a2 = e2.parse(n2.currency, 1, ft), !a2))
              return null;
            let s2 = null;
            if (n2["min-fraction-digits"] && (s2 = e2.parse(n2["min-fraction-digits"], 1, pt), !s2))
              return null;
            let o2 = null;
            return n2["max-fraction-digits"] && (o2 = e2.parse(n2["max-fraction-digits"], 1, pt), !o2) ? null : new ur(r2, i2, a2, s2, o2);
          }
          evaluate(t2) {
            return new Intl.NumberFormat(this.locale ? this.locale.evaluate(t2) : [], { style: this.currency ? "currency" : "decimal", currency: this.currency ? this.currency.evaluate(t2) : void 0, minimumFractionDigits: this.minFractionDigits ? this.minFractionDigits.evaluate(t2) : void 0, maximumFractionDigits: this.maxFractionDigits ? this.maxFractionDigits.evaluate(t2) : void 0 }).format(this.number.evaluate(t2));
          }
          eachChild(t2) {
            t2(this.number), this.locale && t2(this.locale), this.currency && t2(this.currency), this.minFractionDigits && t2(this.minFractionDigits), this.maxFractionDigits && t2(this.maxFractionDigits);
          }
          outputDefined() {
            return false;
          }
        }
        class cr {
          constructor(t2) {
            this.type = vt, this.sections = t2;
          }
          static parse(t2, e2) {
            if (t2.length < 2)
              return e2.error("Expected at least one argument.");
            const r2 = t2[1];
            if (!Array.isArray(r2) && "object" == typeof r2)
              return e2.error("First argument must be an image or text section.");
            const n2 = [];
            let i2 = false;
            for (let r3 = 1; r3 <= t2.length - 1; ++r3) {
              const a2 = t2[r3];
              if (i2 && "object" == typeof a2 && !Array.isArray(a2)) {
                i2 = false;
                let t3 = null;
                if (a2["font-scale"] && (t3 = e2.parse(a2["font-scale"], 1, pt), !t3))
                  return null;
                let r4 = null;
                if (a2["text-font"] && (r4 = e2.parse(a2["text-font"], 1, _t(ft)), !r4))
                  return null;
                let s2 = null;
                if (a2["text-color"] && (s2 = e2.parse(a2["text-color"], 1, yt), !s2))
                  return null;
                const o2 = n2[n2.length - 1];
                o2.scale = t3, o2.font = r4, o2.textColor = s2;
              } else {
                const a3 = e2.parse(t2[r3], 1, gt);
                if (!a3)
                  return null;
                const s2 = a3.type.kind;
                if ("string" !== s2 && "value" !== s2 && "null" !== s2 && "resolvedImage" !== s2)
                  return e2.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");
                i2 = true, n2.push({ content: a3, scale: null, font: null, textColor: null });
              }
            }
            return new cr(n2);
          }
          evaluate(t2) {
            return new Dt(this.sections.map((e2) => {
              const r2 = e2.content.evaluate(t2);
              return qt(r2) === wt ? new Lt("", r2, null, null, null) : new Lt(jt(r2), null, e2.scale ? e2.scale.evaluate(t2) : null, e2.font ? e2.font.evaluate(t2).join(",") : null, e2.textColor ? e2.textColor.evaluate(t2) : null);
            }));
          }
          eachChild(t2) {
            for (const e2 of this.sections)
              t2(e2.content), e2.scale && t2(e2.scale), e2.font && t2(e2.font), e2.textColor && t2(e2.textColor);
          }
          outputDefined() {
            return false;
          }
        }
        class hr {
          constructor(t2) {
            this.type = wt, this.input = t2;
          }
          static parse(t2, e2) {
            if (2 !== t2.length)
              return e2.error("Expected two arguments.");
            const r2 = e2.parse(t2[1], 1, ft);
            return r2 ? new hr(r2) : e2.error("No image name provided.");
          }
          evaluate(t2) {
            const e2 = this.input.evaluate(t2), r2 = Rt.fromString(e2);
            return r2 && t2.availableImages && (r2.available = t2.availableImages.indexOf(e2) > -1), r2;
          }
          eachChild(t2) {
            t2(this.input);
          }
          outputDefined() {
            return false;
          }
        }
        class pr {
          constructor(t2) {
            this.type = pt, this.input = t2;
          }
          static parse(t2, e2) {
            if (2 !== t2.length)
              return e2.error(`Expected 1 argument, but found ${t2.length - 1} instead.`);
            const r2 = e2.parse(t2[1], 1);
            return r2 ? "array" !== r2.type.kind && "string" !== r2.type.kind && "value" !== r2.type.kind ? e2.error(`Expected argument of type string or array, but found ${At(r2.type)} instead.`) : new pr(r2) : null;
          }
          evaluate(t2) {
            const e2 = this.input.evaluate(t2);
            if ("string" == typeof e2)
              return e2.length;
            if (Array.isArray(e2))
              return e2.length;
            throw new Zt(`Expected value to be of type string or array, but found ${At(qt(e2))} instead.`);
          }
          eachChild(t2) {
            t2(this.input);
          }
          outputDefined() {
            return false;
          }
        }
        const fr = { "==": nr, "!=": ir, ">": sr, "<": ar, ">=": lr, "<=": or, array: Gt, at: Je, boolean: Gt, case: We, coalesce: Ke, collator: Qt, format: cr, image: hr, in: Xe, "index-of": Ye, interpolate: Ne, "interpolate-hcl": Ne, "interpolate-lab": Ne, length: pr, let: Ge, literal: Nt, match: He, number: Gt, "number-format": ur, object: Gt, slice: Qe, step: ke, string: Gt, "to-boolean": Xt, "to-color": Xt, "to-number": Xt, "to-string": Xt, var: be, within: me };
        function dr(t2, [e2, r2, n2, i2]) {
          e2 = e2.evaluate(t2), r2 = r2.evaluate(t2), n2 = n2.evaluate(t2);
          const a2 = i2 ? i2.evaluate(t2) : 1, s2 = Ot(e2, r2, n2, a2);
          if (s2)
            throw new Zt(s2);
          return new Ft(e2 / 255 * a2, r2 / 255 * a2, n2 / 255 * a2, a2);
        }
        function yr(t2, e2) {
          return t2 in e2;
        }
        function mr(t2, e2) {
          const r2 = e2[t2];
          return void 0 === r2 ? null : r2;
        }
        function gr(t2) {
          return { type: t2 };
        }
        function xr(t2) {
          return { result: "success", value: t2 };
        }
        function vr(t2) {
          return { result: "error", value: t2 };
        }
        function br(t2) {
          return "data-driven" === t2["property-type"] || "cross-faded-data-driven" === t2["property-type"];
        }
        function wr(t2) {
          return !!t2.expression && t2.expression.parameters.indexOf("zoom") > -1;
        }
        function _r(t2) {
          return !!t2.expression && t2.expression.interpolated;
        }
        function Ar(t2) {
          return t2 instanceof Number ? "number" : t2 instanceof String ? "string" : t2 instanceof Boolean ? "boolean" : Array.isArray(t2) ? "array" : null === t2 ? "null" : typeof t2;
        }
        function kr(t2) {
          return "object" == typeof t2 && null !== t2 && !Array.isArray(t2);
        }
        function Sr(t2) {
          return t2;
        }
        function Ir(t2, e2) {
          const r2 = "color" === e2.type, n2 = t2.stops && "object" == typeof t2.stops[0][0], i2 = n2 || !(n2 || void 0 !== t2.property), a2 = t2.type || (_r(e2) ? "exponential" : "interval");
          if (r2 || "padding" === e2.type) {
            const n3 = r2 ? Ft.parse : $t.parse;
            (t2 = st({}, t2)).stops && (t2.stops = t2.stops.map((t3) => [t3[0], n3(t3[1])])), t2.default = n3(t2.default ? t2.default : e2.default);
          }
          if (t2.colorSpace && "rgb" !== t2.colorSpace && !je[t2.colorSpace])
            throw new Error(`Unknown color space: ${t2.colorSpace}`);
          let s2, o2, l2;
          if ("exponential" === a2)
            s2 = Cr;
          else if ("interval" === a2)
            s2 = Br;
          else if ("categorical" === a2) {
            s2 = zr, o2 = /* @__PURE__ */ Object.create(null);
            for (const e3 of t2.stops)
              o2[e3[0]] = e3[1];
            l2 = typeof t2.stops[0][0];
          } else {
            if ("identity" !== a2)
              throw new Error(`Unknown function type "${a2}"`);
            s2 = Pr;
          }
          if (n2) {
            const r3 = {}, n3 = [];
            for (let e3 = 0; e3 < t2.stops.length; e3++) {
              const i4 = t2.stops[e3], a4 = i4[0].zoom;
              void 0 === r3[a4] && (r3[a4] = { zoom: a4, type: t2.type, property: t2.property, default: t2.default, stops: [] }, n3.push(a4)), r3[a4].stops.push([i4[0].value, i4[1]]);
            }
            const i3 = [];
            for (const t3 of n3)
              i3.push([r3[t3].zoom, Ir(r3[t3], e2)]);
            const a3 = { name: "linear" };
            return { kind: "composite", interpolationType: a3, interpolationFactor: Ne.interpolationFactor.bind(void 0, a3), zoomStops: i3.map((t3) => t3[0]), evaluate: ({ zoom: r4 }, n4) => Cr({ stops: i3, base: t2.base }, e2, r4).evaluate(r4, n4) };
          }
          if (i2) {
            const r3 = "exponential" === a2 ? { name: "exponential", base: void 0 !== t2.base ? t2.base : 1 } : null;
            return { kind: "camera", interpolationType: r3, interpolationFactor: Ne.interpolationFactor.bind(void 0, r3), zoomStops: t2.stops.map((t3) => t3[0]), evaluate: ({ zoom: r4 }) => s2(t2, e2, r4, o2, l2) };
          }
          return { kind: "source", evaluate(r3, n3) {
            const i3 = n3 && n3.properties ? n3.properties[t2.property] : void 0;
            return void 0 === i3 ? Mr(t2.default, e2.default) : s2(t2, e2, i3, o2, l2);
          } };
        }
        function Mr(t2, e2, r2) {
          return void 0 !== t2 ? t2 : void 0 !== e2 ? e2 : void 0 !== r2 ? r2 : void 0;
        }
        function zr(t2, e2, r2, n2, i2) {
          return Mr(typeof r2 === i2 ? n2[r2] : void 0, t2.default, e2.default);
        }
        function Br(t2, e2, r2) {
          if ("number" !== Ar(r2))
            return Mr(t2.default, e2.default);
          const n2 = t2.stops.length;
          if (1 === n2)
            return t2.stops[0][1];
          if (r2 <= t2.stops[0][0])
            return t2.stops[0][1];
          if (r2 >= t2.stops[n2 - 1][0])
            return t2.stops[n2 - 1][1];
          const i2 = Ae(t2.stops.map((t3) => t3[0]), r2);
          return t2.stops[i2][1];
        }
        function Cr(t2, e2, r2) {
          const n2 = void 0 !== t2.base ? t2.base : 1;
          if ("number" !== Ar(r2))
            return Mr(t2.default, e2.default);
          const i2 = t2.stops.length;
          if (1 === i2)
            return t2.stops[0][1];
          if (r2 <= t2.stops[0][0])
            return t2.stops[0][1];
          if (r2 >= t2.stops[i2 - 1][0])
            return t2.stops[i2 - 1][1];
          const a2 = Ae(t2.stops.map((t3) => t3[0]), r2), s2 = function(t3, e3, r3, n3) {
            const i3 = n3 - r3, a3 = t3 - r3;
            return 0 === i3 ? 0 : 1 === e3 ? a3 / i3 : (Math.pow(e3, a3) - 1) / (Math.pow(e3, i3) - 1);
          }(r2, n2, t2.stops[a2][0], t2.stops[a2 + 1][0]), o2 = t2.stops[a2][1], l2 = t2.stops[a2 + 1][1];
          let u2 = Ie[e2.type] || Sr;
          if (t2.colorSpace && "rgb" !== t2.colorSpace) {
            const e3 = je[t2.colorSpace];
            u2 = (t3, r3) => e3.reverse(e3.interpolate(e3.forward(t3), e3.forward(r3), s2));
          }
          return "function" == typeof o2.evaluate ? { evaluate(...t3) {
            const e3 = o2.evaluate.apply(void 0, t3), r3 = l2.evaluate.apply(void 0, t3);
            if (void 0 !== e3 && void 0 !== r3)
              return u2(e3, r3, s2);
          } } : u2(o2, l2, s2);
        }
        function Pr(t2, e2, r2) {
          switch (e2.type) {
            case "color":
              r2 = Ft.parse(r2);
              break;
            case "formatted":
              r2 = Dt.fromString(r2.toString());
              break;
            case "resolvedImage":
              r2 = Rt.fromString(r2.toString());
              break;
            case "padding":
              r2 = $t.parse(r2);
              break;
            default:
              Ar(r2) === e2.type || "enum" === e2.type && e2.values[r2] || (r2 = void 0);
          }
          return Mr(r2, t2.default, e2.default);
        }
        Wt.register(fr, { error: [{ kind: "error" }, [ft], (t2, [e2]) => {
          throw new Zt(e2.evaluate(t2));
        }], typeof: [ft, [gt], (t2, [e2]) => At(qt(e2.evaluate(t2)))], "to-rgba": [_t(pt, 4), [yt], (t2, [e2]) => e2.evaluate(t2).toArray()], rgb: [yt, [pt, pt, pt], dr], rgba: [yt, [pt, pt, pt, pt], dr], has: { type: dt, overloads: [[[ft], (t2, [e2]) => yr(e2.evaluate(t2), t2.properties())], [[ft, mt], (t2, [e2, r2]) => yr(e2.evaluate(t2), r2.evaluate(t2))]] }, get: { type: gt, overloads: [[[ft], (t2, [e2]) => mr(e2.evaluate(t2), t2.properties())], [[ft, mt], (t2, [e2, r2]) => mr(e2.evaluate(t2), r2.evaluate(t2))]] }, "feature-state": [gt, [ft], (t2, [e2]) => mr(e2.evaluate(t2), t2.featureState || {})], properties: [mt, [], (t2) => t2.properties()], "geometry-type": [ft, [], (t2) => t2.geometryType()], id: [gt, [], (t2) => t2.id()], zoom: [pt, [], (t2) => t2.globals.zoom], "heatmap-density": [pt, [], (t2) => t2.globals.heatmapDensity || 0], "line-progress": [pt, [], (t2) => t2.globals.lineProgress || 0], accumulated: [gt, [], (t2) => void 0 === t2.globals.accumulated ? null : t2.globals.accumulated], "+": [pt, gr(pt), (t2, e2) => {
          let r2 = 0;
          for (const n2 of e2)
            r2 += n2.evaluate(t2);
          return r2;
        }], "*": [pt, gr(pt), (t2, e2) => {
          let r2 = 1;
          for (const n2 of e2)
            r2 *= n2.evaluate(t2);
          return r2;
        }], "-": { type: pt, overloads: [[[pt, pt], (t2, [e2, r2]) => e2.evaluate(t2) - r2.evaluate(t2)], [[pt], (t2, [e2]) => -e2.evaluate(t2)]] }, "/": [pt, [pt, pt], (t2, [e2, r2]) => e2.evaluate(t2) / r2.evaluate(t2)], "%": [pt, [pt, pt], (t2, [e2, r2]) => e2.evaluate(t2) % r2.evaluate(t2)], ln2: [pt, [], () => Math.LN2], pi: [pt, [], () => Math.PI], e: [pt, [], () => Math.E], "^": [pt, [pt, pt], (t2, [e2, r2]) => Math.pow(e2.evaluate(t2), r2.evaluate(t2))], sqrt: [pt, [pt], (t2, [e2]) => Math.sqrt(e2.evaluate(t2))], log10: [pt, [pt], (t2, [e2]) => Math.log(e2.evaluate(t2)) / Math.LN10], ln: [pt, [pt], (t2, [e2]) => Math.log(e2.evaluate(t2))], log2: [pt, [pt], (t2, [e2]) => Math.log(e2.evaluate(t2)) / Math.LN2], sin: [pt, [pt], (t2, [e2]) => Math.sin(e2.evaluate(t2))], cos: [pt, [pt], (t2, [e2]) => Math.cos(e2.evaluate(t2))], tan: [pt, [pt], (t2, [e2]) => Math.tan(e2.evaluate(t2))], asin: [pt, [pt], (t2, [e2]) => Math.asin(e2.evaluate(t2))], acos: [pt, [pt], (t2, [e2]) => Math.acos(e2.evaluate(t2))], atan: [pt, [pt], (t2, [e2]) => Math.atan(e2.evaluate(t2))], min: [pt, gr(pt), (t2, e2) => Math.min(...e2.map((e3) => e3.evaluate(t2)))], max: [pt, gr(pt), (t2, e2) => Math.max(...e2.map((e3) => e3.evaluate(t2)))], abs: [pt, [pt], (t2, [e2]) => Math.abs(e2.evaluate(t2))], round: [pt, [pt], (t2, [e2]) => {
          const r2 = e2.evaluate(t2);
          return r2 < 0 ? -Math.round(-r2) : Math.round(r2);
        }], floor: [pt, [pt], (t2, [e2]) => Math.floor(e2.evaluate(t2))], ceil: [pt, [pt], (t2, [e2]) => Math.ceil(e2.evaluate(t2))], "filter-==": [dt, [ft, gt], (t2, [e2, r2]) => t2.properties()[e2.value] === r2.value], "filter-id-==": [dt, [gt], (t2, [e2]) => t2.id() === e2.value], "filter-type-==": [dt, [ft], (t2, [e2]) => t2.geometryType() === e2.value], "filter-<": [dt, [ft, gt], (t2, [e2, r2]) => {
          const n2 = t2.properties()[e2.value], i2 = r2.value;
          return typeof n2 == typeof i2 && n2 < i2;
        }], "filter-id-<": [dt, [gt], (t2, [e2]) => {
          const r2 = t2.id(), n2 = e2.value;
          return typeof r2 == typeof n2 && r2 < n2;
        }], "filter->": [dt, [ft, gt], (t2, [e2, r2]) => {
          const n2 = t2.properties()[e2.value], i2 = r2.value;
          return typeof n2 == typeof i2 && n2 > i2;
        }], "filter-id->": [dt, [gt], (t2, [e2]) => {
          const r2 = t2.id(), n2 = e2.value;
          return typeof r2 == typeof n2 && r2 > n2;
        }], "filter-<=": [dt, [ft, gt], (t2, [e2, r2]) => {
          const n2 = t2.properties()[e2.value], i2 = r2.value;
          return typeof n2 == typeof i2 && n2 <= i2;
        }], "filter-id-<=": [dt, [gt], (t2, [e2]) => {
          const r2 = t2.id(), n2 = e2.value;
          return typeof r2 == typeof n2 && r2 <= n2;
        }], "filter->=": [dt, [ft, gt], (t2, [e2, r2]) => {
          const n2 = t2.properties()[e2.value], i2 = r2.value;
          return typeof n2 == typeof i2 && n2 >= i2;
        }], "filter-id->=": [dt, [gt], (t2, [e2]) => {
          const r2 = t2.id(), n2 = e2.value;
          return typeof r2 == typeof n2 && r2 >= n2;
        }], "filter-has": [dt, [gt], (t2, [e2]) => e2.value in t2.properties()], "filter-has-id": [dt, [], (t2) => null !== t2.id() && void 0 !== t2.id()], "filter-type-in": [dt, [_t(ft)], (t2, [e2]) => e2.value.indexOf(t2.geometryType()) >= 0], "filter-id-in": [dt, [_t(gt)], (t2, [e2]) => e2.value.indexOf(t2.id()) >= 0], "filter-in-small": [dt, [ft, _t(gt)], (t2, [e2, r2]) => r2.value.indexOf(t2.properties()[e2.value]) >= 0], "filter-in-large": [dt, [ft, _t(gt)], (t2, [e2, r2]) => function(t3, e3, r3, n2) {
          for (; r3 <= n2; ) {
            const i2 = r3 + n2 >> 1;
            if (e3[i2] === t3)
              return true;
            e3[i2] > t3 ? n2 = i2 - 1 : r3 = i2 + 1;
          }
          return false;
        }(t2.properties()[e2.value], r2.value, 0, r2.value.length - 1)], all: { type: dt, overloads: [[[dt, dt], (t2, [e2, r2]) => e2.evaluate(t2) && r2.evaluate(t2)], [gr(dt), (t2, e2) => {
          for (const r2 of e2)
            if (!r2.evaluate(t2))
              return false;
          return true;
        }]] }, any: { type: dt, overloads: [[[dt, dt], (t2, [e2, r2]) => e2.evaluate(t2) || r2.evaluate(t2)], [gr(dt), (t2, e2) => {
          for (const r2 of e2)
            if (r2.evaluate(t2))
              return true;
          return false;
        }]] }, "!": [dt, [dt], (t2, [e2]) => !e2.evaluate(t2)], "is-supported-script": [dt, [ft], (t2, [e2]) => {
          const r2 = t2.globals && t2.globals.isSupportedScript;
          return !r2 || r2(e2.evaluate(t2));
        }], upcase: [ft, [ft], (t2, [e2]) => e2.evaluate(t2).toUpperCase()], downcase: [ft, [ft], (t2, [e2]) => e2.evaluate(t2).toLowerCase()], concat: [ft, gr(gt), (t2, e2) => e2.map((e3) => jt(e3.evaluate(t2))).join("")], "resolved-locale": [ft, [xt], (t2, [e2]) => e2.evaluate(t2).resolvedLocale()] });
        class Vr {
          constructor(t2, e2) {
            this.expression = t2, this._warningHistory = {}, this._evaluator = new Ht(), this._defaultValue = e2 ? function(t3) {
              return "color" === t3.type && kr(t3.default) ? new Ft(0, 0, 0, 0) : "color" === t3.type ? Ft.parse(t3.default) || null : "padding" === t3.type ? $t.parse(t3.default) || null : void 0 === t3.default ? null : t3.default;
            }(e2) : null, this._enumValues = e2 && "enum" === e2.type ? e2.values : null;
          }
          evaluateWithoutErrorHandling(t2, e2, r2, n2, i2, a2) {
            return this._evaluator.globals = t2, this._evaluator.feature = e2, this._evaluator.featureState = r2, this._evaluator.canonical = n2, this._evaluator.availableImages = i2 || null, this._evaluator.formattedSection = a2, this.expression.evaluate(this._evaluator);
          }
          evaluate(t2, e2, r2, n2, i2, a2) {
            this._evaluator.globals = t2, this._evaluator.feature = e2 || null, this._evaluator.featureState = r2 || null, this._evaluator.canonical = n2, this._evaluator.availableImages = i2 || null, this._evaluator.formattedSection = a2 || null;
            try {
              const t3 = this.expression.evaluate(this._evaluator);
              if (null == t3 || "number" == typeof t3 && t3 != t3)
                return this._defaultValue;
              if (this._enumValues && !(t3 in this._enumValues))
                throw new Zt(`Expected value to be one of ${Object.keys(this._enumValues).map((t4) => JSON.stringify(t4)).join(", ")}, but found ${JSON.stringify(t3)} instead.`);
              return t3;
            } catch (t3) {
              return this._warningHistory[t3.message] || (this._warningHistory[t3.message] = true, "undefined" != typeof console && console.warn(t3.message)), this._defaultValue;
            }
          }
        }
        function Er(t2) {
          return Array.isArray(t2) && t2.length > 0 && "string" == typeof t2[0] && t2[0] in fr;
        }
        function Fr(t2, e2) {
          const r2 = new we(fr, [], e2 ? function(t3) {
            const e3 = { color: yt, string: ft, number: pt, enum: ft, boolean: dt, formatted: vt, padding: bt, resolvedImage: wt };
            return "array" === t3.type ? _t(e3[t3.value] || gt, t3.length) : e3[t3.type];
          }(e2) : void 0), n2 = r2.parse(t2, void 0, void 0, void 0, e2 && "string" === e2.type ? { typeAnnotation: "coerce" } : void 0);
          return n2 ? xr(new Vr(n2, e2)) : vr(r2.errors);
        }
        class Tr {
          constructor(t2, e2) {
            this.kind = t2, this._styleExpression = e2, this.isStateDependent = "constant" !== t2 && !xe(e2.expression);
          }
          evaluateWithoutErrorHandling(t2, e2, r2, n2, i2, a2) {
            return this._styleExpression.evaluateWithoutErrorHandling(t2, e2, r2, n2, i2, a2);
          }
          evaluate(t2, e2, r2, n2, i2, a2) {
            return this._styleExpression.evaluate(t2, e2, r2, n2, i2, a2);
          }
        }
        class Lr {
          constructor(t2, e2, r2, n2) {
            this.kind = t2, this.zoomStops = r2, this._styleExpression = e2, this.isStateDependent = "camera" !== t2 && !xe(e2.expression), this.interpolationType = n2;
          }
          evaluateWithoutErrorHandling(t2, e2, r2, n2, i2, a2) {
            return this._styleExpression.evaluateWithoutErrorHandling(t2, e2, r2, n2, i2, a2);
          }
          evaluate(t2, e2, r2, n2, i2, a2) {
            return this._styleExpression.evaluate(t2, e2, r2, n2, i2, a2);
          }
          interpolationFactor(t2, e2, r2) {
            return this.interpolationType ? Ne.interpolationFactor(this.interpolationType, t2, e2, r2) : 0;
          }
        }
        function Dr(t2, e2) {
          const r2 = Fr(t2, e2);
          if ("error" === r2.result)
            return r2;
          const n2 = r2.value.expression, i2 = ge(n2);
          if (!i2 && !br(e2))
            return vr([new ut("", "data expressions not supported")]);
          const a2 = ve(n2, ["zoom"]);
          if (!a2 && !wr(e2))
            return vr([new ut("", "zoom expressions not supported")]);
          const s2 = Rr(n2);
          return s2 || a2 ? s2 instanceof ut ? vr([s2]) : s2 instanceof Ne && !_r(e2) ? vr([new ut("", '"interpolate" expressions cannot be used with this property')]) : xr(s2 ? new Lr(i2 ? "camera" : "composite", r2.value, s2.labels, s2 instanceof Ne ? s2.interpolation : void 0) : new Tr(i2 ? "constant" : "source", r2.value)) : vr([new ut("", '"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);
        }
        class $r {
          constructor(t2, e2) {
            this._parameters = t2, this._specification = e2, st(this, Ir(this._parameters, this._specification));
          }
          static deserialize(t2) {
            return new $r(t2._parameters, t2._specification);
          }
          static serialize(t2) {
            return { _parameters: t2._parameters, _specification: t2._specification };
          }
        }
        function Rr(t2) {
          let e2 = null;
          if (t2 instanceof Ge)
            e2 = Rr(t2.result);
          else if (t2 instanceof Ke) {
            for (const r2 of t2.args)
              if (e2 = Rr(r2), e2)
                break;
          } else
            (t2 instanceof ke || t2 instanceof Ne) && t2.input instanceof Wt && "zoom" === t2.input.name && (e2 = t2);
          return e2 instanceof ut || t2.eachChild((t3) => {
            const r2 = Rr(t3);
            r2 instanceof ut ? e2 = r2 : !e2 && r2 ? e2 = new ut("", '"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.') : e2 && r2 && e2 !== r2 && (e2 = new ut("", 'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'));
          }), e2;
        }
        function Or(t2) {
          const e2 = t2.key, r2 = t2.value, n2 = t2.valueSpec || {}, i2 = t2.objectElementValidators || {}, a2 = t2.style, s2 = t2.styleSpec;
          let o2 = [];
          const l2 = Ar(r2);
          if ("object" !== l2)
            return [new it(e2, r2, `object expected, ${l2} found`)];
          for (const t3 in r2) {
            const l3 = t3.split(".")[0], u2 = n2[l3] || n2["*"];
            let c3;
            if (i2[l3])
              c3 = i2[l3];
            else if (n2[l3])
              c3 = yn;
            else if (i2["*"])
              c3 = i2["*"];
            else {
              if (!n2["*"]) {
                o2.push(new it(e2, r2[t3], `unknown property "${t3}"`));
                continue;
              }
              c3 = yn;
            }
            o2 = o2.concat(c3({ key: (e2 ? `${e2}.` : e2) + t3, value: r2[t3], valueSpec: u2, style: a2, styleSpec: s2, object: r2, objectKey: t3 }, r2));
          }
          for (const t3 in n2)
            i2[t3] || n2[t3].required && void 0 === n2[t3].default && void 0 === r2[t3] && o2.push(new it(e2, r2, `missing required property "${t3}"`));
          return o2;
        }
        function Ur(t2) {
          const e2 = t2.value, r2 = t2.valueSpec, n2 = t2.style, i2 = t2.styleSpec, a2 = t2.key, s2 = t2.arrayElementValidator || yn;
          if ("array" !== Ar(e2))
            return [new it(a2, e2, `array expected, ${Ar(e2)} found`)];
          if (r2.length && e2.length !== r2.length)
            return [new it(a2, e2, `array length ${r2.length} expected, length ${e2.length} found`)];
          if (r2["min-length"] && e2.length < r2["min-length"])
            return [new it(a2, e2, `array length at least ${r2["min-length"]} expected, length ${e2.length} found`)];
          let o2 = { type: r2.value, values: r2.values };
          i2.$version < 7 && (o2.function = r2.function), "object" === Ar(r2.value) && (o2 = r2.value);
          let l2 = [];
          for (let t3 = 0; t3 < e2.length; t3++)
            l2 = l2.concat(s2({ array: e2, arrayIndex: t3, value: e2[t3], valueSpec: o2, style: n2, styleSpec: i2, key: `${a2}[${t3}]` }));
          return l2;
        }
        function qr(t2) {
          const e2 = t2.key, r2 = t2.value, n2 = t2.valueSpec;
          let i2 = Ar(r2);
          return "number" === i2 && r2 != r2 && (i2 = "NaN"), "number" !== i2 ? [new it(e2, r2, `number expected, ${i2} found`)] : "minimum" in n2 && r2 < n2.minimum ? [new it(e2, r2, `${r2} is less than the minimum value ${n2.minimum}`)] : "maximum" in n2 && r2 > n2.maximum ? [new it(e2, r2, `${r2} is greater than the maximum value ${n2.maximum}`)] : [];
        }
        function jr(t2) {
          const e2 = t2.valueSpec, r2 = ot(t2.value.type);
          let n2, i2, a2, s2 = {};
          const o2 = "categorical" !== r2 && void 0 === t2.value.property, l2 = !o2, u2 = "array" === Ar(t2.value.stops) && "array" === Ar(t2.value.stops[0]) && "object" === Ar(t2.value.stops[0][0]), c3 = Or({ key: t2.key, value: t2.value, valueSpec: t2.styleSpec.function, style: t2.style, styleSpec: t2.styleSpec, objectElementValidators: { stops: function(t3) {
            if ("identity" === r2)
              return [new it(t3.key, t3.value, 'identity function may not have a "stops" property')];
            let e3 = [];
            const n3 = t3.value;
            return e3 = e3.concat(Ur({ key: t3.key, value: n3, valueSpec: t3.valueSpec, style: t3.style, styleSpec: t3.styleSpec, arrayElementValidator: h2 })), "array" === Ar(n3) && 0 === n3.length && e3.push(new it(t3.key, n3, "array must have at least one stop")), e3;
          }, default: function(t3) {
            return yn({ key: t3.key, value: t3.value, valueSpec: e2, style: t3.style, styleSpec: t3.styleSpec });
          } } });
          return "identity" === r2 && o2 && c3.push(new it(t2.key, t2.value, 'missing required property "property"')), "identity" === r2 || t2.value.stops || c3.push(new it(t2.key, t2.value, 'missing required property "stops"')), "exponential" === r2 && t2.valueSpec.expression && !_r(t2.valueSpec) && c3.push(new it(t2.key, t2.value, "exponential functions not supported")), t2.styleSpec.$version >= 8 && (l2 && !br(t2.valueSpec) ? c3.push(new it(t2.key, t2.value, "property functions not supported")) : o2 && !wr(t2.valueSpec) && c3.push(new it(t2.key, t2.value, "zoom functions not supported"))), "categorical" !== r2 && !u2 || void 0 !== t2.value.property || c3.push(new it(t2.key, t2.value, '"property" property is required')), c3;
          function h2(t3) {
            let r3 = [];
            const n3 = t3.value, o3 = t3.key;
            if ("array" !== Ar(n3))
              return [new it(o3, n3, `array expected, ${Ar(n3)} found`)];
            if (2 !== n3.length)
              return [new it(o3, n3, `array length 2 expected, length ${n3.length} found`)];
            if (u2) {
              if ("object" !== Ar(n3[0]))
                return [new it(o3, n3, `object expected, ${Ar(n3[0])} found`)];
              if (void 0 === n3[0].zoom)
                return [new it(o3, n3, "object stop key must have zoom")];
              if (void 0 === n3[0].value)
                return [new it(o3, n3, "object stop key must have value")];
              if (a2 && a2 > ot(n3[0].zoom))
                return [new it(o3, n3[0].zoom, "stop zoom values must appear in ascending order")];
              ot(n3[0].zoom) !== a2 && (a2 = ot(n3[0].zoom), i2 = void 0, s2 = {}), r3 = r3.concat(Or({ key: `${o3}[0]`, value: n3[0], valueSpec: { zoom: {} }, style: t3.style, styleSpec: t3.styleSpec, objectElementValidators: { zoom: qr, value: p3 } }));
            } else
              r3 = r3.concat(p3({ key: `${o3}[0]`, value: n3[0], valueSpec: {}, style: t3.style, styleSpec: t3.styleSpec }, n3));
            return Er(lt(n3[1])) ? r3.concat([new it(`${o3}[1]`, n3[1], "expressions are not allowed in function stops.")]) : r3.concat(yn({ key: `${o3}[1]`, value: n3[1], valueSpec: e2, style: t3.style, styleSpec: t3.styleSpec }));
          }
          function p3(t3, a3) {
            const o3 = Ar(t3.value), l3 = ot(t3.value), u3 = null !== t3.value ? t3.value : a3;
            if (n2) {
              if (o3 !== n2)
                return [new it(t3.key, u3, `${o3} stop domain type must match previous stop domain type ${n2}`)];
            } else
              n2 = o3;
            if ("number" !== o3 && "string" !== o3 && "boolean" !== o3)
              return [new it(t3.key, u3, "stop domain value must be a number, string, or boolean")];
            if ("number" !== o3 && "categorical" !== r2) {
              let n3 = `number expected, ${o3} found`;
              return br(e2) && void 0 === r2 && (n3 += '\nIf you intended to use a categorical function, specify `"type": "categorical"`.'), [new it(t3.key, u3, n3)];
            }
            return "categorical" !== r2 || "number" !== o3 || isFinite(l3) && Math.floor(l3) === l3 ? "categorical" !== r2 && "number" === o3 && void 0 !== i2 && l3 < i2 ? [new it(t3.key, u3, "stop domain values must appear in ascending order")] : (i2 = l3, "categorical" === r2 && l3 in s2 ? [new it(t3.key, u3, "stop domain values must be unique")] : (s2[l3] = true, [])) : [new it(t3.key, u3, `integer expected, found ${l3}`)];
          }
        }
        function Nr(t2) {
          const e2 = ("property" === t2.expressionContext ? Dr : Fr)(lt(t2.value), t2.valueSpec);
          if ("error" === e2.result)
            return e2.value.map((e3) => new it(`${t2.key}${e3.key}`, t2.value, e3.message));
          const r2 = e2.value.expression || e2.value._styleExpression.expression;
          if ("property" === t2.expressionContext && "text-font" === t2.propertyKey && !r2.outputDefined())
            return [new it(t2.key, t2.value, `Invalid data expression for "${t2.propertyKey}". Output values must be contained as literals within the expression.`)];
          if ("property" === t2.expressionContext && "layout" === t2.propertyType && !xe(r2))
            return [new it(t2.key, t2.value, '"feature-state" data expressions are not supported with layout properties.')];
          if ("filter" === t2.expressionContext && !xe(r2))
            return [new it(t2.key, t2.value, '"feature-state" data expressions are not supported with filters.')];
          if (t2.expressionContext && 0 === t2.expressionContext.indexOf("cluster")) {
            if (!ve(r2, ["zoom", "feature-state"]))
              return [new it(t2.key, t2.value, '"zoom" and "feature-state" expressions are not supported with cluster properties.')];
            if ("cluster-initial" === t2.expressionContext && !ge(r2))
              return [new it(t2.key, t2.value, "Feature data expressions are not supported with initial expression part of cluster properties.")];
          }
          return [];
        }
        function Zr(t2) {
          const e2 = t2.key, r2 = t2.value, n2 = t2.valueSpec, i2 = [];
          return Array.isArray(n2.values) ? -1 === n2.values.indexOf(ot(r2)) && i2.push(new it(e2, r2, `expected one of [${n2.values.join(", ")}], ${JSON.stringify(r2)} found`)) : -1 === Object.keys(n2.values).indexOf(ot(r2)) && i2.push(new it(e2, r2, `expected one of [${Object.keys(n2.values).join(", ")}], ${JSON.stringify(r2)} found`)), i2;
        }
        function Kr(t2) {
          if (true === t2 || false === t2)
            return true;
          if (!Array.isArray(t2) || 0 === t2.length)
            return false;
          switch (t2[0]) {
            case "has":
              return t2.length >= 2 && "$id" !== t2[1] && "$type" !== t2[1];
            case "in":
              return t2.length >= 3 && ("string" != typeof t2[1] || Array.isArray(t2[2]));
            case "!in":
            case "!has":
            case "none":
              return false;
            case "==":
            case "!=":
            case ">":
            case ">=":
            case "<":
            case "<=":
              return 3 !== t2.length || Array.isArray(t2[1]) || Array.isArray(t2[2]);
            case "any":
            case "all":
              for (const e2 of t2.slice(1))
                if (!Kr(e2) && "boolean" != typeof e2)
                  return false;
              return true;
            default:
              return true;
          }
        }
        const Gr = { type: "boolean", default: false, transition: false, "property-type": "data-driven", expression: { interpolated: false, parameters: ["zoom", "feature"] } };
        function Jr(t2) {
          if (null == t2)
            return { filter: () => true, needGeometry: false };
          Kr(t2) || (t2 = Hr(t2));
          const e2 = Fr(t2, Gr);
          if ("error" === e2.result)
            throw new Error(e2.value.map((t3) => `${t3.key}: ${t3.message}`).join(", "));
          return { filter: (t3, r2, n2) => e2.value.evaluate(t3, r2, {}, n2), needGeometry: Yr(t2) };
        }
        function Xr(t2, e2) {
          return t2 < e2 ? -1 : t2 > e2 ? 1 : 0;
        }
        function Yr(t2) {
          if (!Array.isArray(t2))
            return false;
          if ("within" === t2[0])
            return true;
          for (let e2 = 1; e2 < t2.length; e2++)
            if (Yr(t2[e2]))
              return true;
          return false;
        }
        function Hr(t2) {
          if (!t2)
            return true;
          const e2 = t2[0];
          return t2.length <= 1 ? "any" !== e2 : "==" === e2 ? Wr(t2[1], t2[2], "==") : "!=" === e2 ? en(Wr(t2[1], t2[2], "==")) : "<" === e2 || ">" === e2 || "<=" === e2 || ">=" === e2 ? Wr(t2[1], t2[2], e2) : "any" === e2 ? (r2 = t2.slice(1), ["any"].concat(r2.map(Hr))) : "all" === e2 ? ["all"].concat(t2.slice(1).map(Hr)) : "none" === e2 ? ["all"].concat(t2.slice(1).map(Hr).map(en)) : "in" === e2 ? Qr(t2[1], t2.slice(2)) : "!in" === e2 ? en(Qr(t2[1], t2.slice(2))) : "has" === e2 ? tn(t2[1]) : "!has" === e2 ? en(tn(t2[1])) : "within" !== e2 || t2;
          var r2;
        }
        function Wr(t2, e2, r2) {
          switch (t2) {
            case "$type":
              return [`filter-type-${r2}`, e2];
            case "$id":
              return [`filter-id-${r2}`, e2];
            default:
              return [`filter-${r2}`, t2, e2];
          }
        }
        function Qr(t2, e2) {
          if (0 === e2.length)
            return false;
          switch (t2) {
            case "$type":
              return ["filter-type-in", ["literal", e2]];
            case "$id":
              return ["filter-id-in", ["literal", e2]];
            default:
              return e2.length > 200 && !e2.some((t3) => typeof t3 != typeof e2[0]) ? ["filter-in-large", t2, ["literal", e2.sort(Xr)]] : ["filter-in-small", t2, ["literal", e2]];
          }
        }
        function tn(t2) {
          switch (t2) {
            case "$type":
              return true;
            case "$id":
              return ["filter-has-id"];
            default:
              return ["filter-has", t2];
          }
        }
        function en(t2) {
          return ["!", t2];
        }
        function rn(t2) {
          return Kr(lt(t2.value)) ? Nr(st({}, t2, { expressionContext: "filter", valueSpec: { value: "boolean" } })) : nn(t2);
        }
        function nn(t2) {
          const e2 = t2.value, r2 = t2.key;
          if ("array" !== Ar(e2))
            return [new it(r2, e2, `array expected, ${Ar(e2)} found`)];
          const n2 = t2.styleSpec;
          let i2, a2 = [];
          if (e2.length < 1)
            return [new it(r2, e2, "filter array must have at least 1 element")];
          switch (a2 = a2.concat(Zr({ key: `${r2}[0]`, value: e2[0], valueSpec: n2.filter_operator, style: t2.style, styleSpec: t2.styleSpec })), ot(e2[0])) {
            case "<":
            case "<=":
            case ">":
            case ">=":
              e2.length >= 2 && "$type" === ot(e2[1]) && a2.push(new it(r2, e2, `"$type" cannot be use with operator "${e2[0]}"`));
            case "==":
            case "!=":
              3 !== e2.length && a2.push(new it(r2, e2, `filter array for operator "${e2[0]}" must have 3 elements`));
            case "in":
            case "!in":
              e2.length >= 2 && (i2 = Ar(e2[1]), "string" !== i2 && a2.push(new it(`${r2}[1]`, e2[1], `string expected, ${i2} found`)));
              for (let s2 = 2; s2 < e2.length; s2++)
                i2 = Ar(e2[s2]), "$type" === ot(e2[1]) ? a2 = a2.concat(Zr({ key: `${r2}[${s2}]`, value: e2[s2], valueSpec: n2.geometry_type, style: t2.style, styleSpec: t2.styleSpec })) : "string" !== i2 && "number" !== i2 && "boolean" !== i2 && a2.push(new it(`${r2}[${s2}]`, e2[s2], `string, number, or boolean expected, ${i2} found`));
              break;
            case "any":
            case "all":
            case "none":
              for (let n3 = 1; n3 < e2.length; n3++)
                a2 = a2.concat(nn({ key: `${r2}[${n3}]`, value: e2[n3], style: t2.style, styleSpec: t2.styleSpec }));
              break;
            case "has":
            case "!has":
              i2 = Ar(e2[1]), 2 !== e2.length ? a2.push(new it(r2, e2, `filter array for "${e2[0]}" operator must have 2 elements`)) : "string" !== i2 && a2.push(new it(`${r2}[1]`, e2[1], `string expected, ${i2} found`));
              break;
            case "within":
              i2 = Ar(e2[1]), 2 !== e2.length ? a2.push(new it(r2, e2, `filter array for "${e2[0]}" operator must have 2 elements`)) : "object" !== i2 && a2.push(new it(`${r2}[1]`, e2[1], `object expected, ${i2} found`));
          }
          return a2;
        }
        function an(t2, e2) {
          const r2 = t2.key, n2 = t2.style, i2 = t2.styleSpec, a2 = t2.value, s2 = t2.objectKey, o2 = i2[`${e2}_${t2.layerType}`];
          if (!o2)
            return [];
          const l2 = s2.match(/^(.*)-transition$/);
          if ("paint" === e2 && l2 && o2[l2[1]] && o2[l2[1]].transition)
            return yn({ key: r2, value: a2, valueSpec: i2.transition, style: n2, styleSpec: i2 });
          const u2 = t2.valueSpec || o2[s2];
          if (!u2)
            return [new it(r2, a2, `unknown property "${s2}"`)];
          let c3;
          if ("string" === Ar(a2) && br(u2) && !u2.tokens && (c3 = /^{([^}]+)}$/.exec(a2)))
            return [new it(r2, a2, `"${s2}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(c3[1])} }\`.`)];
          const h2 = [];
          return "symbol" === t2.layerType && ("text-field" === s2 && n2 && !n2.glyphs && h2.push(new it(r2, a2, 'use of "text-field" requires a style "glyphs" property')), "text-font" === s2 && kr(lt(a2)) && "identity" === ot(a2.type) && h2.push(new it(r2, a2, '"text-font" does not support identity functions'))), h2.concat(yn({ key: t2.key, value: a2, valueSpec: u2, style: n2, styleSpec: i2, expressionContext: "property", propertyType: e2, propertyKey: s2 }));
        }
        function sn(t2) {
          return an(t2, "paint");
        }
        function on2(t2) {
          return an(t2, "layout");
        }
        function ln(t2) {
          let e2 = [];
          const r2 = t2.value, n2 = t2.key, i2 = t2.style, a2 = t2.styleSpec;
          r2.type || r2.ref || e2.push(new it(n2, r2, 'either "type" or "ref" is required'));
          let s2 = ot(r2.type);
          const o2 = ot(r2.ref);
          if (r2.id) {
            const a3 = ot(r2.id);
            for (let s3 = 0; s3 < t2.arrayIndex; s3++) {
              const t3 = i2.layers[s3];
              ot(t3.id) === a3 && e2.push(new it(n2, r2.id, `duplicate layer id "${r2.id}", previously used at line ${t3.id.__line__}`));
            }
          }
          if ("ref" in r2) {
            let t3;
            ["type", "source", "source-layer", "filter", "layout"].forEach((t4) => {
              t4 in r2 && e2.push(new it(n2, r2[t4], `"${t4}" is prohibited for ref layers`));
            }), i2.layers.forEach((e3) => {
              ot(e3.id) === o2 && (t3 = e3);
            }), t3 ? t3.ref ? e2.push(new it(n2, r2.ref, "ref cannot reference another ref layer")) : s2 = ot(t3.type) : e2.push(new it(n2, r2.ref, `ref layer "${o2}" not found`));
          } else if ("background" !== s2)
            if (r2.source) {
              const t3 = i2.sources && i2.sources[r2.source], a3 = t3 && ot(t3.type);
              t3 ? "vector" === a3 && "raster" === s2 ? e2.push(new it(n2, r2.source, `layer "${r2.id}" requires a raster source`)) : "raster" === a3 && "raster" !== s2 ? e2.push(new it(n2, r2.source, `layer "${r2.id}" requires a vector source`)) : "vector" !== a3 || r2["source-layer"] ? "raster-dem" === a3 && "hillshade" !== s2 ? e2.push(new it(n2, r2.source, "raster-dem source can only be used with layer type 'hillshade'.")) : "line" !== s2 || !r2.paint || !r2.paint["line-gradient"] || "geojson" === a3 && t3.lineMetrics || e2.push(new it(n2, r2, `layer "${r2.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)) : e2.push(new it(n2, r2, `layer "${r2.id}" must specify a "source-layer"`)) : e2.push(new it(n2, r2.source, `source "${r2.source}" not found`));
            } else
              e2.push(new it(n2, r2, 'missing required property "source"'));
          return e2 = e2.concat(Or({ key: n2, value: r2, valueSpec: a2.layer, style: t2.style, styleSpec: t2.styleSpec, objectElementValidators: { "*": () => [], type: () => yn({ key: `${n2}.type`, value: r2.type, valueSpec: a2.layer.type, style: t2.style, styleSpec: t2.styleSpec, object: r2, objectKey: "type" }), filter: rn, layout: (t3) => Or({ layer: r2, key: t3.key, value: t3.value, style: t3.style, styleSpec: t3.styleSpec, objectElementValidators: { "*": (t4) => on2(st({ layerType: s2 }, t4)) } }), paint: (t3) => Or({ layer: r2, key: t3.key, value: t3.value, style: t3.style, styleSpec: t3.styleSpec, objectElementValidators: { "*": (t4) => sn(st({ layerType: s2 }, t4)) } }) } })), e2;
        }
        function un(t2) {
          const e2 = t2.value, r2 = t2.key, n2 = Ar(e2);
          return "string" !== n2 ? [new it(r2, e2, `string expected, ${n2} found`)] : [];
        }
        const cn = { promoteId: function({ key: t2, value: e2 }) {
          if ("string" === Ar(e2))
            return un({ key: t2, value: e2 });
          {
            const r2 = [];
            for (const n2 in e2)
              r2.push(...un({ key: `${t2}.${n2}`, value: e2[n2] }));
            return r2;
          }
        } };
        function hn(t2) {
          const e2 = t2.value, r2 = t2.key, n2 = t2.styleSpec, i2 = t2.style;
          if (!e2.type)
            return [new it(r2, e2, '"type" is required')];
          const a2 = ot(e2.type);
          let s2;
          switch (a2) {
            case "vector":
            case "raster":
            case "raster-dem":
              return s2 = Or({ key: r2, value: e2, valueSpec: n2[`source_${a2.replace("-", "_")}`], style: t2.style, styleSpec: n2, objectElementValidators: cn }), s2;
            case "geojson":
              if (s2 = Or({ key: r2, value: e2, valueSpec: n2.source_geojson, style: i2, styleSpec: n2, objectElementValidators: cn }), e2.cluster)
                for (const t3 in e2.clusterProperties) {
                  const [n3, i3] = e2.clusterProperties[t3], a3 = "string" == typeof n3 ? [n3, ["accumulated"], ["get", t3]] : n3;
                  s2.push(...Nr({ key: `${r2}.${t3}.map`, value: i3, expressionContext: "cluster-map" })), s2.push(...Nr({ key: `${r2}.${t3}.reduce`, value: a3, expressionContext: "cluster-reduce" }));
                }
              return s2;
            case "video":
              return Or({ key: r2, value: e2, valueSpec: n2.source_video, style: i2, styleSpec: n2 });
            case "image":
              return Or({ key: r2, value: e2, valueSpec: n2.source_image, style: i2, styleSpec: n2 });
            case "canvas":
              return [new it(r2, null, "Please use runtime APIs to add canvas sources, rather than including them in stylesheets.", "source.canvas")];
            default:
              return Zr({ key: `${r2}.type`, value: e2.type, valueSpec: { values: ["vector", "raster", "raster-dem", "geojson", "video", "image"] }, style: i2, styleSpec: n2 });
          }
        }
        function pn(t2) {
          const e2 = t2.value, r2 = t2.styleSpec, n2 = r2.light, i2 = t2.style;
          let a2 = [];
          const s2 = Ar(e2);
          if (void 0 === e2)
            return a2;
          if ("object" !== s2)
            return a2 = a2.concat([new it("light", e2, `object expected, ${s2} found`)]), a2;
          for (const t3 in e2) {
            const s3 = t3.match(/^(.*)-transition$/);
            a2 = a2.concat(s3 && n2[s3[1]] && n2[s3[1]].transition ? yn({ key: t3, value: e2[t3], valueSpec: r2.transition, style: i2, styleSpec: r2 }) : n2[t3] ? yn({ key: t3, value: e2[t3], valueSpec: n2[t3], style: i2, styleSpec: r2 }) : [new it(t3, e2[t3], `unknown property "${t3}"`)]);
          }
          return a2;
        }
        function fn(t2) {
          const e2 = t2.value, r2 = t2.styleSpec, n2 = r2.terrain, i2 = t2.style;
          let a2 = [];
          const s2 = Ar(e2);
          if (void 0 === e2)
            return a2;
          if ("object" !== s2)
            return a2 = a2.concat([new it("terrain", e2, `object expected, ${s2} found`)]), a2;
          for (const t3 in e2)
            a2 = a2.concat(n2[t3] ? yn({ key: t3, value: e2[t3], valueSpec: n2[t3], style: i2, styleSpec: r2 }) : [new it(t3, e2[t3], `unknown property "${t3}"`)]);
          return a2;
        }
        const dn = { "*": () => [], array: Ur, boolean: function(t2) {
          const e2 = t2.value, r2 = t2.key, n2 = Ar(e2);
          return "boolean" !== n2 ? [new it(r2, e2, `boolean expected, ${n2} found`)] : [];
        }, number: qr, color: function(t2) {
          const e2 = t2.key, r2 = t2.value, n2 = Ar(r2);
          return "string" !== n2 ? [new it(e2, r2, `color expected, ${n2} found`)] : null === zt(r2) ? [new it(e2, r2, `color expected, "${r2}" found`)] : [];
        }, constants: at, enum: Zr, filter: rn, function: jr, layer: ln, object: Or, source: hn, light: pn, terrain: fn, string: un, formatted: function(t2) {
          return 0 === un(t2).length ? [] : Nr(t2);
        }, resolvedImage: function(t2) {
          return 0 === un(t2).length ? [] : Nr(t2);
        }, padding: function(t2) {
          const e2 = t2.key, r2 = t2.value;
          if ("array" === Ar(r2)) {
            if (r2.length < 1 || r2.length > 4)
              return [new it(e2, r2, `padding requires 1 to 4 values; ${r2.length} values found`)];
            const t3 = { type: "number" };
            let n2 = [];
            for (let i2 = 0; i2 < r2.length; i2++)
              n2 = n2.concat(yn({ key: `${e2}[${i2}]`, value: r2[i2], valueSpec: t3 }));
            return n2;
          }
          return qr({ key: e2, value: r2, valueSpec: {} });
        } };
        function yn(t2) {
          const e2 = t2.value, r2 = t2.valueSpec, n2 = t2.styleSpec;
          return r2.expression && kr(ot(e2)) ? jr(t2) : r2.expression && Er(lt(e2)) ? Nr(t2) : r2.type && dn[r2.type] ? dn[r2.type](t2) : Or(st({}, t2, { valueSpec: r2.type ? n2[r2.type] : r2 }));
        }
        function mn(t2) {
          const e2 = t2.value, r2 = t2.key, n2 = un(t2);
          return n2.length || (-1 === e2.indexOf("{fontstack}") && n2.push(new it(r2, e2, '"glyphs" url must include a "{fontstack}" token')), -1 === e2.indexOf("{range}") && n2.push(new it(r2, e2, '"glyphs" url must include a "{range}" token'))), n2;
        }
        function gn(t2, e2 = nt) {
          let r2 = [];
          return r2 = r2.concat(yn({ key: "", value: t2, valueSpec: e2.$root, styleSpec: e2, style: t2, objectElementValidators: { glyphs: mn, "*": () => [] } })), t2.constants && (r2 = r2.concat(at({ key: "constants", value: t2.constants, style: t2, styleSpec: e2 }))), xn(r2);
        }
        function xn(t2) {
          return [].concat(t2).sort((t3, e2) => t3.line - e2.line);
        }
        function vn(t2) {
          return function(...e2) {
            return xn(t2.apply(this, e2));
          };
        }
        gn.source = vn(hn), gn.light = vn(pn), gn.terrain = vn(fn), gn.layer = vn(ln), gn.filter = vn(rn), gn.paintProperty = vn(sn), gn.layoutProperty = vn(on2);
        const bn = gn, wn = bn.light, _n = bn.paintProperty, An = bn.layoutProperty;
        function kn(t2, e2) {
          let r2 = false;
          if (e2 && e2.length)
            for (const n2 of e2)
              t2.fire(new et(new Error(n2.message))), r2 = true;
          return r2;
        }
        class Sn {
          constructor(t2, e2, r2) {
            const n2 = this.cells = [];
            if (t2 instanceof ArrayBuffer) {
              this.arrayBuffer = t2;
              const i3 = new Int32Array(this.arrayBuffer);
              t2 = i3[0], this.d = (e2 = i3[1]) + 2 * (r2 = i3[2]);
              for (let t3 = 0; t3 < this.d * this.d; t3++) {
                const e3 = i3[3 + t3], r3 = i3[3 + t3 + 1];
                n2.push(e3 === r3 ? null : i3.subarray(e3, r3));
              }
              const a2 = i3[3 + n2.length + 1];
              this.keys = i3.subarray(i3[3 + n2.length], a2), this.bboxes = i3.subarray(a2), this.insert = this._insertReadonly;
            } else {
              this.d = e2 + 2 * r2;
              for (let t3 = 0; t3 < this.d * this.d; t3++)
                n2.push([]);
              this.keys = [], this.bboxes = [];
            }
            this.n = e2, this.extent = t2, this.padding = r2, this.scale = e2 / t2, this.uid = 0;
            const i2 = r2 / e2 * t2;
            this.min = -i2, this.max = t2 + i2;
          }
          insert(t2, e2, r2, n2, i2) {
            this._forEachCell(e2, r2, n2, i2, this._insertCell, this.uid++, void 0, void 0), this.keys.push(t2), this.bboxes.push(e2), this.bboxes.push(r2), this.bboxes.push(n2), this.bboxes.push(i2);
          }
          _insertReadonly() {
            throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.");
          }
          _insertCell(t2, e2, r2, n2, i2, a2) {
            this.cells[i2].push(a2);
          }
          query(t2, e2, r2, n2, i2) {
            const a2 = this.min, s2 = this.max;
            if (t2 <= a2 && e2 <= a2 && s2 <= r2 && s2 <= n2 && !i2)
              return Array.prototype.slice.call(this.keys);
            {
              const a3 = [];
              return this._forEachCell(t2, e2, r2, n2, this._queryCell, a3, {}, i2), a3;
            }
          }
          _queryCell(t2, e2, r2, n2, i2, a2, s2, o2) {
            const l2 = this.cells[i2];
            if (null !== l2) {
              const i3 = this.keys, u2 = this.bboxes;
              for (let c3 = 0; c3 < l2.length; c3++) {
                const h2 = l2[c3];
                if (void 0 === s2[h2]) {
                  const l3 = 4 * h2;
                  (o2 ? o2(u2[l3 + 0], u2[l3 + 1], u2[l3 + 2], u2[l3 + 3]) : t2 <= u2[l3 + 2] && e2 <= u2[l3 + 3] && r2 >= u2[l3 + 0] && n2 >= u2[l3 + 1]) ? (s2[h2] = true, a2.push(i3[h2])) : s2[h2] = false;
                }
              }
            }
          }
          _forEachCell(t2, e2, r2, n2, i2, a2, s2, o2) {
            const l2 = this._convertToCellCoord(t2), u2 = this._convertToCellCoord(e2), c3 = this._convertToCellCoord(r2), h2 = this._convertToCellCoord(n2);
            for (let p3 = l2; p3 <= c3; p3++)
              for (let l3 = u2; l3 <= h2; l3++) {
                const u3 = this.d * l3 + p3;
                if ((!o2 || o2(this._convertFromCellCoord(p3), this._convertFromCellCoord(l3), this._convertFromCellCoord(p3 + 1), this._convertFromCellCoord(l3 + 1))) && i2.call(this, t2, e2, r2, n2, u3, a2, s2, o2))
                  return;
              }
          }
          _convertFromCellCoord(t2) {
            return (t2 - this.padding) / this.scale;
          }
          _convertToCellCoord(t2) {
            return Math.max(0, Math.min(this.d - 1, Math.floor(t2 * this.scale) + this.padding));
          }
          toArrayBuffer() {
            if (this.arrayBuffer)
              return this.arrayBuffer;
            const t2 = this.cells, e2 = 3 + this.cells.length + 1 + 1;
            let r2 = 0;
            for (let t3 = 0; t3 < this.cells.length; t3++)
              r2 += this.cells[t3].length;
            const n2 = new Int32Array(e2 + r2 + this.keys.length + this.bboxes.length);
            n2[0] = this.extent, n2[1] = this.n, n2[2] = this.padding;
            let i2 = e2;
            for (let e3 = 0; e3 < t2.length; e3++) {
              const r3 = t2[e3];
              n2[3 + e3] = i2, n2.set(r3, i2), i2 += r3.length;
            }
            return n2[3 + t2.length] = i2, n2.set(this.keys, i2), i2 += this.keys.length, n2[3 + t2.length + 1] = i2, n2.set(this.bboxes, i2), i2 += this.bboxes.length, n2.buffer;
          }
          static serialize(t2, e2) {
            const r2 = t2.toArrayBuffer();
            return e2 && e2.push(r2), { buffer: r2 };
          }
          static deserialize(t2) {
            return new Sn(t2.buffer);
          }
        }
        const In = {};
        function Mn(t2, e2, r2 = {}) {
          if (In[t2])
            throw new Error(`${t2} is already registered.`);
          Object.defineProperty(e2, "_classRegistryKey", { value: t2, writeable: false }), In[t2] = { klass: e2, omit: r2.omit || [], shallow: r2.shallow || [] };
        }
        Mn("Object", Object), Mn("TransferableGridIndex", Sn), Mn("Color", Ft), Mn("Error", Error), Mn("AJAXError", q), Mn("ResolvedImage", Rt), Mn("StylePropertyFunction", $r), Mn("StyleExpression", Vr, { omit: ["_evaluator"] }), Mn("ZoomDependentExpression", Lr), Mn("ZoomConstantExpression", Tr), Mn("CompoundExpression", Wt, { omit: ["_evaluate"] });
        for (const t2 in fr)
          fr[t2]._classRegistryKey || Mn(`Expression_${t2}`, fr[t2]);
        function zn(t2) {
          return t2 && "undefined" != typeof ArrayBuffer && (t2 instanceof ArrayBuffer || t2.constructor && "ArrayBuffer" === t2.constructor.name);
        }
        function Bn(t2, e2) {
          if (null == t2 || "boolean" == typeof t2 || "number" == typeof t2 || "string" == typeof t2 || t2 instanceof Boolean || t2 instanceof Number || t2 instanceof String || t2 instanceof Date || t2 instanceof RegExp || t2 instanceof Blob)
            return t2;
          if (zn(t2))
            return e2 && e2.push(t2), t2;
          if (A2(t2))
            return e2 && e2.push(t2), t2;
          if (ArrayBuffer.isView(t2)) {
            const r2 = t2;
            return e2 && e2.push(r2.buffer), r2;
          }
          if (t2 instanceof ImageData)
            return e2 && e2.push(t2.data.buffer), t2;
          if (Array.isArray(t2)) {
            const r2 = [];
            for (const n2 of t2)
              r2.push(Bn(n2, e2));
            return r2;
          }
          if ("object" == typeof t2) {
            const r2 = t2.constructor, n2 = r2._classRegistryKey;
            if (!n2)
              throw new Error("can't serialize object of unregistered class");
            if (!In[n2])
              throw new Error(`${n2} is not registered.`);
            const i2 = r2.serialize ? r2.serialize(t2, e2) : {};
            if (r2.serialize) {
              if (e2 && i2 === e2[e2.length - 1])
                throw new Error("statically serialized object won't survive transfer of $name property");
            } else {
              for (const r3 in t2) {
                if (!t2.hasOwnProperty(r3))
                  continue;
                if (In[n2].omit.indexOf(r3) >= 0)
                  continue;
                const a2 = t2[r3];
                i2[r3] = In[n2].shallow.indexOf(r3) >= 0 ? a2 : Bn(a2, e2);
              }
              t2 instanceof Error && (i2.message = t2.message);
            }
            if (i2.$name)
              throw new Error("$name property is reserved for worker serialization logic.");
            return "Object" !== n2 && (i2.$name = n2), i2;
          }
          throw new Error("can't serialize object of type " + typeof t2);
        }
        function Cn(t2) {
          if (null == t2 || "boolean" == typeof t2 || "number" == typeof t2 || "string" == typeof t2 || t2 instanceof Boolean || t2 instanceof Number || t2 instanceof String || t2 instanceof Date || t2 instanceof RegExp || t2 instanceof Blob || zn(t2) || A2(t2) || ArrayBuffer.isView(t2) || t2 instanceof ImageData)
            return t2;
          if (Array.isArray(t2))
            return t2.map(Cn);
          if ("object" == typeof t2) {
            const e2 = t2.$name || "Object";
            if (!In[e2])
              throw new Error(`can't deserialize unregistered class ${e2}`);
            const { klass: r2 } = In[e2];
            if (!r2)
              throw new Error(`can't deserialize unregistered class ${e2}`);
            if (r2.deserialize)
              return r2.deserialize(t2);
            const n2 = Object.create(r2.prototype);
            for (const r3 of Object.keys(t2)) {
              if ("$name" === r3)
                continue;
              const i2 = t2[r3];
              n2[r3] = In[e2].shallow.indexOf(r3) >= 0 ? i2 : Cn(i2);
            }
            return n2;
          }
          throw new Error("can't deserialize object of type " + typeof t2);
        }
        class Pn {
          constructor() {
            this.first = true;
          }
          update(t2, e2) {
            const r2 = Math.floor(t2);
            return this.first ? (this.first = false, this.lastIntegerZoom = r2, this.lastIntegerZoomTime = 0, this.lastZoom = t2, this.lastFloorZoom = r2, true) : (this.lastFloorZoom > r2 ? (this.lastIntegerZoom = r2 + 1, this.lastIntegerZoomTime = e2) : this.lastFloorZoom < r2 && (this.lastIntegerZoom = r2, this.lastIntegerZoomTime = e2), t2 !== this.lastZoom && (this.lastZoom = t2, this.lastFloorZoom = r2, true));
          }
        }
        const Vn = { "Latin-1 Supplement": (t2) => t2 >= 128 && t2 <= 255, Arabic: (t2) => t2 >= 1536 && t2 <= 1791, "Arabic Supplement": (t2) => t2 >= 1872 && t2 <= 1919, "Arabic Extended-A": (t2) => t2 >= 2208 && t2 <= 2303, "Hangul Jamo": (t2) => t2 >= 4352 && t2 <= 4607, "Unified Canadian Aboriginal Syllabics": (t2) => t2 >= 5120 && t2 <= 5759, Khmer: (t2) => t2 >= 6016 && t2 <= 6143, "Unified Canadian Aboriginal Syllabics Extended": (t2) => t2 >= 6320 && t2 <= 6399, "General Punctuation": (t2) => t2 >= 8192 && t2 <= 8303, "Letterlike Symbols": (t2) => t2 >= 8448 && t2 <= 8527, "Number Forms": (t2) => t2 >= 8528 && t2 <= 8591, "Miscellaneous Technical": (t2) => t2 >= 8960 && t2 <= 9215, "Control Pictures": (t2) => t2 >= 9216 && t2 <= 9279, "Optical Character Recognition": (t2) => t2 >= 9280 && t2 <= 9311, "Enclosed Alphanumerics": (t2) => t2 >= 9312 && t2 <= 9471, "Geometric Shapes": (t2) => t2 >= 9632 && t2 <= 9727, "Miscellaneous Symbols": (t2) => t2 >= 9728 && t2 <= 9983, "Miscellaneous Symbols and Arrows": (t2) => t2 >= 11008 && t2 <= 11263, "CJK Radicals Supplement": (t2) => t2 >= 11904 && t2 <= 12031, "Kangxi Radicals": (t2) => t2 >= 12032 && t2 <= 12255, "Ideographic Description Characters": (t2) => t2 >= 12272 && t2 <= 12287, "CJK Symbols and Punctuation": (t2) => t2 >= 12288 && t2 <= 12351, Hiragana: (t2) => t2 >= 12352 && t2 <= 12447, Katakana: (t2) => t2 >= 12448 && t2 <= 12543, Bopomofo: (t2) => t2 >= 12544 && t2 <= 12591, "Hangul Compatibility Jamo": (t2) => t2 >= 12592 && t2 <= 12687, Kanbun: (t2) => t2 >= 12688 && t2 <= 12703, "Bopomofo Extended": (t2) => t2 >= 12704 && t2 <= 12735, "CJK Strokes": (t2) => t2 >= 12736 && t2 <= 12783, "Katakana Phonetic Extensions": (t2) => t2 >= 12784 && t2 <= 12799, "Enclosed CJK Letters and Months": (t2) => t2 >= 12800 && t2 <= 13055, "CJK Compatibility": (t2) => t2 >= 13056 && t2 <= 13311, "CJK Unified Ideographs Extension A": (t2) => t2 >= 13312 && t2 <= 19903, "Yijing Hexagram Symbols": (t2) => t2 >= 19904 && t2 <= 19967, "CJK Unified Ideographs": (t2) => t2 >= 19968 && t2 <= 40959, "Yi Syllables": (t2) => t2 >= 40960 && t2 <= 42127, "Yi Radicals": (t2) => t2 >= 42128 && t2 <= 42191, "Hangul Jamo Extended-A": (t2) => t2 >= 43360 && t2 <= 43391, "Hangul Syllables": (t2) => t2 >= 44032 && t2 <= 55215, "Hangul Jamo Extended-B": (t2) => t2 >= 55216 && t2 <= 55295, "Private Use Area": (t2) => t2 >= 57344 && t2 <= 63743, "CJK Compatibility Ideographs": (t2) => t2 >= 63744 && t2 <= 64255, "Arabic Presentation Forms-A": (t2) => t2 >= 64336 && t2 <= 65023, "Vertical Forms": (t2) => t2 >= 65040 && t2 <= 65055, "CJK Compatibility Forms": (t2) => t2 >= 65072 && t2 <= 65103, "Small Form Variants": (t2) => t2 >= 65104 && t2 <= 65135, "Arabic Presentation Forms-B": (t2) => t2 >= 65136 && t2 <= 65279, "Halfwidth and Fullwidth Forms": (t2) => t2 >= 65280 && t2 <= 65519 };
        function En(t2) {
          for (const e2 of t2)
            if (Ln(e2.charCodeAt(0)))
              return true;
          return false;
        }
        function Fn(t2) {
          for (const e2 of t2)
            if (!Tn(e2.charCodeAt(0)))
              return false;
          return true;
        }
        function Tn(t2) {
          return !(Vn.Arabic(t2) || Vn["Arabic Supplement"](t2) || Vn["Arabic Extended-A"](t2) || Vn["Arabic Presentation Forms-A"](t2) || Vn["Arabic Presentation Forms-B"](t2));
        }
        function Ln(t2) {
          return !(746 !== t2 && 747 !== t2 && (t2 < 4352 || !(Vn["Bopomofo Extended"](t2) || Vn.Bopomofo(t2) || Vn["CJK Compatibility Forms"](t2) && !(t2 >= 65097 && t2 <= 65103) || Vn["CJK Compatibility Ideographs"](t2) || Vn["CJK Compatibility"](t2) || Vn["CJK Radicals Supplement"](t2) || Vn["CJK Strokes"](t2) || !(!Vn["CJK Symbols and Punctuation"](t2) || t2 >= 12296 && t2 <= 12305 || t2 >= 12308 && t2 <= 12319 || 12336 === t2) || Vn["CJK Unified Ideographs Extension A"](t2) || Vn["CJK Unified Ideographs"](t2) || Vn["Enclosed CJK Letters and Months"](t2) || Vn["Hangul Compatibility Jamo"](t2) || Vn["Hangul Jamo Extended-A"](t2) || Vn["Hangul Jamo Extended-B"](t2) || Vn["Hangul Jamo"](t2) || Vn["Hangul Syllables"](t2) || Vn.Hiragana(t2) || Vn["Ideographic Description Characters"](t2) || Vn.Kanbun(t2) || Vn["Kangxi Radicals"](t2) || Vn["Katakana Phonetic Extensions"](t2) || Vn.Katakana(t2) && 12540 !== t2 || !(!Vn["Halfwidth and Fullwidth Forms"](t2) || 65288 === t2 || 65289 === t2 || 65293 === t2 || t2 >= 65306 && t2 <= 65310 || 65339 === t2 || 65341 === t2 || 65343 === t2 || t2 >= 65371 && t2 <= 65503 || 65507 === t2 || t2 >= 65512 && t2 <= 65519) || !(!Vn["Small Form Variants"](t2) || t2 >= 65112 && t2 <= 65118 || t2 >= 65123 && t2 <= 65126) || Vn["Unified Canadian Aboriginal Syllabics"](t2) || Vn["Unified Canadian Aboriginal Syllabics Extended"](t2) || Vn["Vertical Forms"](t2) || Vn["Yijing Hexagram Symbols"](t2) || Vn["Yi Syllables"](t2) || Vn["Yi Radicals"](t2))));
        }
        function Dn(t2) {
          return !(Ln(t2) || function(t3) {
            return !!(Vn["Latin-1 Supplement"](t3) && (167 === t3 || 169 === t3 || 174 === t3 || 177 === t3 || 188 === t3 || 189 === t3 || 190 === t3 || 215 === t3 || 247 === t3) || Vn["General Punctuation"](t3) && (8214 === t3 || 8224 === t3 || 8225 === t3 || 8240 === t3 || 8241 === t3 || 8251 === t3 || 8252 === t3 || 8258 === t3 || 8263 === t3 || 8264 === t3 || 8265 === t3 || 8273 === t3) || Vn["Letterlike Symbols"](t3) || Vn["Number Forms"](t3) || Vn["Miscellaneous Technical"](t3) && (t3 >= 8960 && t3 <= 8967 || t3 >= 8972 && t3 <= 8991 || t3 >= 8996 && t3 <= 9e3 || 9003 === t3 || t3 >= 9085 && t3 <= 9114 || t3 >= 9150 && t3 <= 9165 || 9167 === t3 || t3 >= 9169 && t3 <= 9179 || t3 >= 9186 && t3 <= 9215) || Vn["Control Pictures"](t3) && 9251 !== t3 || Vn["Optical Character Recognition"](t3) || Vn["Enclosed Alphanumerics"](t3) || Vn["Geometric Shapes"](t3) || Vn["Miscellaneous Symbols"](t3) && !(t3 >= 9754 && t3 <= 9759) || Vn["Miscellaneous Symbols and Arrows"](t3) && (t3 >= 11026 && t3 <= 11055 || t3 >= 11088 && t3 <= 11097 || t3 >= 11192 && t3 <= 11243) || Vn["CJK Symbols and Punctuation"](t3) || Vn.Katakana(t3) || Vn["Private Use Area"](t3) || Vn["CJK Compatibility Forms"](t3) || Vn["Small Form Variants"](t3) || Vn["Halfwidth and Fullwidth Forms"](t3) || 8734 === t3 || 8756 === t3 || 8757 === t3 || t3 >= 9984 && t3 <= 10087 || t3 >= 10102 && t3 <= 10131 || 65532 === t3 || 65533 === t3);
          }(t2));
        }
        function $n(t2) {
          return t2 >= 1424 && t2 <= 2303 || Vn["Arabic Presentation Forms-A"](t2) || Vn["Arabic Presentation Forms-B"](t2);
        }
        function Rn(t2, e2) {
          return !(!e2 && $n(t2) || t2 >= 2304 && t2 <= 3583 || t2 >= 3840 && t2 <= 4255 || Vn.Khmer(t2));
        }
        function On(t2) {
          for (const e2 of t2)
            if ($n(e2.charCodeAt(0)))
              return true;
          return false;
        }
        const Un = "deferred", qn = "loading", jn = "loaded";
        let Nn = null, Zn = "unavailable", Kn = null;
        const Gn = function(t2) {
          t2 && "string" == typeof t2 && t2.indexOf("NetworkError") > -1 && (Zn = "error"), Nn && Nn(t2);
        };
        function Jn() {
          Xn.fire(new tt("pluginStateChange", { pluginStatus: Zn, pluginURL: Kn }));
        }
        const Xn = new rt(), Yn = function() {
          return Zn;
        }, Hn = function() {
          if (Zn !== Un || !Kn)
            throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");
          Zn = qn, Jn(), Kn && K({ url: Kn }, (t2) => {
            t2 ? Gn(t2) : (Zn = jn, Jn());
          });
        }, Wn = { applyArabicShaping: null, processBidirectionalText: null, processStyledBidirectionalText: null, isLoaded: () => Zn === jn || null != Wn.applyArabicShaping, isLoading: () => Zn === qn, setState(t2) {
          if (!g())
            throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");
          Zn = t2.pluginStatus, Kn = t2.pluginURL;
        }, isParsed() {
          if (!g())
            throw new Error("rtl-text-plugin is only parsed on the worker-threads");
          return null != Wn.applyArabicShaping && null != Wn.processBidirectionalText && null != Wn.processStyledBidirectionalText;
        }, getPluginURL() {
          if (!g())
            throw new Error("rtl-text-plugin url can only be queried from the worker threads");
          return Kn;
        } };
        class Qn {
          constructor(t2, e2) {
            this.zoom = t2, e2 ? (this.now = e2.now, this.fadeDuration = e2.fadeDuration, this.zoomHistory = e2.zoomHistory, this.transition = e2.transition) : (this.now = 0, this.fadeDuration = 0, this.zoomHistory = new Pn(), this.transition = {});
          }
          isSupportedScript(t2) {
            return function(t3, e2) {
              for (const r2 of t3)
                if (!Rn(r2.charCodeAt(0), e2))
                  return false;
              return true;
            }(t2, Wn.isLoaded());
          }
          crossFadingFactor() {
            return 0 === this.fadeDuration ? 1 : Math.min((this.now - this.zoomHistory.lastIntegerZoomTime) / this.fadeDuration, 1);
          }
          getCrossfadeParameters() {
            const t2 = this.zoom, e2 = t2 - Math.floor(t2), r2 = this.crossFadingFactor();
            return t2 > this.zoomHistory.lastIntegerZoom ? { fromScale: 2, toScale: 1, t: e2 + (1 - e2) * r2 } : { fromScale: 0.5, toScale: 1, t: 1 - (1 - r2) * e2 };
          }
        }
        class ti {
          constructor(t2, e2) {
            this.property = t2, this.value = e2, this.expression = function(t3, e3) {
              if (kr(t3))
                return new $r(t3, e3);
              if (Er(t3)) {
                const r2 = Dr(t3, e3);
                if ("error" === r2.result)
                  throw new Error(r2.value.map((t4) => `${t4.key}: ${t4.message}`).join(", "));
                return r2.value;
              }
              {
                let r2 = t3;
                return "color" === e3.type && "string" == typeof t3 ? r2 = Ft.parse(t3) : "padding" !== e3.type || "number" != typeof t3 && !Array.isArray(t3) || (r2 = $t.parse(t3)), { kind: "constant", evaluate: () => r2 };
              }
            }(void 0 === e2 ? t2.specification.default : e2, t2.specification);
          }
          isDataDriven() {
            return "source" === this.expression.kind || "composite" === this.expression.kind;
          }
          possiblyEvaluate(t2, e2, r2) {
            return this.property.possiblyEvaluate(this, t2, e2, r2);
          }
        }
        class ei {
          constructor(t2) {
            this.property = t2, this.value = new ti(t2, void 0);
          }
          transitioned(t2, e2) {
            return new ni(this.property, this.value, e2, o({}, t2.transition, this.transition), t2.now);
          }
          untransitioned() {
            return new ni(this.property, this.value, null, {}, 0);
          }
        }
        class ri {
          constructor(t2) {
            this._properties = t2, this._values = Object.create(t2.defaultTransitionablePropertyValues);
          }
          getValue(t2) {
            return p2(this._values[t2].value.value);
          }
          setValue(t2, e2) {
            Object.prototype.hasOwnProperty.call(this._values, t2) || (this._values[t2] = new ei(this._values[t2].property)), this._values[t2].value = new ti(this._values[t2].property, null === e2 ? void 0 : p2(e2));
          }
          getTransition(t2) {
            return p2(this._values[t2].transition);
          }
          setTransition(t2, e2) {
            Object.prototype.hasOwnProperty.call(this._values, t2) || (this._values[t2] = new ei(this._values[t2].property)), this._values[t2].transition = p2(e2) || void 0;
          }
          serialize() {
            const t2 = {};
            for (const e2 of Object.keys(this._values)) {
              const r2 = this.getValue(e2);
              void 0 !== r2 && (t2[e2] = r2);
              const n2 = this.getTransition(e2);
              void 0 !== n2 && (t2[`${e2}-transition`] = n2);
            }
            return t2;
          }
          transitioned(t2, e2) {
            const r2 = new ii(this._properties);
            for (const n2 of Object.keys(this._values))
              r2._values[n2] = this._values[n2].transitioned(t2, e2._values[n2]);
            return r2;
          }
          untransitioned() {
            const t2 = new ii(this._properties);
            for (const e2 of Object.keys(this._values))
              t2._values[e2] = this._values[e2].untransitioned();
            return t2;
          }
        }
        class ni {
          constructor(t2, e2, r2, n2, i2) {
            this.property = t2, this.value = e2, this.begin = i2 + n2.delay || 0, this.end = this.begin + n2.duration || 0, t2.specification.transition && (n2.delay || n2.duration) && (this.prior = r2);
          }
          possiblyEvaluate(t2, e2, r2) {
            const n2 = t2.now || 0, i2 = this.value.possiblyEvaluate(t2, e2, r2), a2 = this.prior;
            if (a2) {
              if (n2 > this.end)
                return this.prior = null, i2;
              if (this.value.isDataDriven())
                return this.prior = null, i2;
              if (n2 < this.begin)
                return a2.possiblyEvaluate(t2, e2, r2);
              {
                const s2 = (n2 - this.begin) / (this.end - this.begin);
                return this.property.interpolate(a2.possiblyEvaluate(t2, e2, r2), i2, function(t3) {
                  if (t3 <= 0)
                    return 0;
                  if (t3 >= 1)
                    return 1;
                  const e3 = t3 * t3, r3 = e3 * t3;
                  return 4 * (t3 < 0.5 ? r3 : 3 * (t3 - e3) + r3 - 0.75);
                }(s2));
              }
            }
            return i2;
          }
        }
        class ii {
          constructor(t2) {
            this._properties = t2, this._values = Object.create(t2.defaultTransitioningPropertyValues);
          }
          possiblyEvaluate(t2, e2, r2) {
            const n2 = new oi(this._properties);
            for (const i2 of Object.keys(this._values))
              n2._values[i2] = this._values[i2].possiblyEvaluate(t2, e2, r2);
            return n2;
          }
          hasTransition() {
            for (const t2 of Object.keys(this._values))
              if (this._values[t2].prior)
                return true;
            return false;
          }
        }
        class ai {
          constructor(t2) {
            this._properties = t2, this._values = Object.create(t2.defaultPropertyValues);
          }
          getValue(t2) {
            return p2(this._values[t2].value);
          }
          setValue(t2, e2) {
            this._values[t2] = new ti(this._values[t2].property, null === e2 ? void 0 : p2(e2));
          }
          serialize() {
            const t2 = {};
            for (const e2 of Object.keys(this._values)) {
              const r2 = this.getValue(e2);
              void 0 !== r2 && (t2[e2] = r2);
            }
            return t2;
          }
          possiblyEvaluate(t2, e2, r2) {
            const n2 = new oi(this._properties);
            for (const i2 of Object.keys(this._values))
              n2._values[i2] = this._values[i2].possiblyEvaluate(t2, e2, r2);
            return n2;
          }
        }
        class si {
          constructor(t2, e2, r2) {
            this.property = t2, this.value = e2, this.parameters = r2;
          }
          isConstant() {
            return "constant" === this.value.kind;
          }
          constantOr(t2) {
            return "constant" === this.value.kind ? this.value.value : t2;
          }
          evaluate(t2, e2, r2, n2) {
            return this.property.evaluate(this.value, this.parameters, t2, e2, r2, n2);
          }
        }
        class oi {
          constructor(t2) {
            this._properties = t2, this._values = Object.create(t2.defaultPossiblyEvaluatedValues);
          }
          get(t2) {
            return this._values[t2];
          }
        }
        class li {
          constructor(t2) {
            this.specification = t2;
          }
          possiblyEvaluate(t2, e2) {
            if (t2.isDataDriven())
              throw new Error("Value should not be data driven");
            return t2.expression.evaluate(e2);
          }
          interpolate(t2, e2, r2) {
            const n2 = Ie[this.specification.type];
            return n2 ? n2(t2, e2, r2) : t2;
          }
        }
        class ui {
          constructor(t2, e2) {
            this.specification = t2, this.overrides = e2;
          }
          possiblyEvaluate(t2, e2, r2, n2) {
            return new si(this, "constant" === t2.expression.kind || "camera" === t2.expression.kind ? { kind: "constant", value: t2.expression.evaluate(e2, null, {}, r2, n2) } : t2.expression, e2);
          }
          interpolate(t2, e2, r2) {
            if ("constant" !== t2.value.kind || "constant" !== e2.value.kind)
              return t2;
            if (void 0 === t2.value.value || void 0 === e2.value.value)
              return new si(this, { kind: "constant", value: void 0 }, t2.parameters);
            const n2 = Ie[this.specification.type];
            return n2 ? new si(this, { kind: "constant", value: n2(t2.value.value, e2.value.value, r2) }, t2.parameters) : t2;
          }
          evaluate(t2, e2, r2, n2, i2, a2) {
            return "constant" === t2.kind ? t2.value : t2.evaluate(e2, r2, n2, i2, a2);
          }
        }
        class ci extends ui {
          possiblyEvaluate(t2, e2, r2, n2) {
            if (void 0 === t2.value)
              return new si(this, { kind: "constant", value: void 0 }, e2);
            if ("constant" === t2.expression.kind) {
              const i2 = t2.expression.evaluate(e2, null, {}, r2, n2), a2 = "resolvedImage" === t2.property.specification.type && "string" != typeof i2 ? i2.name : i2, s2 = this._calculate(a2, a2, a2, e2);
              return new si(this, { kind: "constant", value: s2 }, e2);
            }
            if ("camera" === t2.expression.kind) {
              const r3 = this._calculate(t2.expression.evaluate({ zoom: e2.zoom - 1 }), t2.expression.evaluate({ zoom: e2.zoom }), t2.expression.evaluate({ zoom: e2.zoom + 1 }), e2);
              return new si(this, { kind: "constant", value: r3 }, e2);
            }
            return new si(this, t2.expression, e2);
          }
          evaluate(t2, e2, r2, n2, i2, a2) {
            if ("source" === t2.kind) {
              const s2 = t2.evaluate(e2, r2, n2, i2, a2);
              return this._calculate(s2, s2, s2, e2);
            }
            return "composite" === t2.kind ? this._calculate(t2.evaluate({ zoom: Math.floor(e2.zoom) - 1 }, r2, n2), t2.evaluate({ zoom: Math.floor(e2.zoom) }, r2, n2), t2.evaluate({ zoom: Math.floor(e2.zoom) + 1 }, r2, n2), e2) : t2.value;
          }
          _calculate(t2, e2, r2, n2) {
            return n2.zoom > n2.zoomHistory.lastIntegerZoom ? { from: t2, to: e2 } : { from: r2, to: e2 };
          }
          interpolate(t2) {
            return t2;
          }
        }
        class hi {
          constructor(t2) {
            this.specification = t2;
          }
          possiblyEvaluate(t2, e2, r2, n2) {
            if (void 0 !== t2.value) {
              if ("constant" === t2.expression.kind) {
                const i2 = t2.expression.evaluate(e2, null, {}, r2, n2);
                return this._calculate(i2, i2, i2, e2);
              }
              return this._calculate(t2.expression.evaluate(new Qn(Math.floor(e2.zoom - 1), e2)), t2.expression.evaluate(new Qn(Math.floor(e2.zoom), e2)), t2.expression.evaluate(new Qn(Math.floor(e2.zoom + 1), e2)), e2);
            }
          }
          _calculate(t2, e2, r2, n2) {
            return n2.zoom > n2.zoomHistory.lastIntegerZoom ? { from: t2, to: e2 } : { from: r2, to: e2 };
          }
          interpolate(t2) {
            return t2;
          }
        }
        class pi {
          constructor(t2) {
            this.specification = t2;
          }
          possiblyEvaluate(t2, e2, r2, n2) {
            return !!t2.expression.evaluate(e2, null, {}, r2, n2);
          }
          interpolate() {
            return false;
          }
        }
        class fi {
          constructor(t2) {
            this.properties = t2, this.defaultPropertyValues = {}, this.defaultTransitionablePropertyValues = {}, this.defaultTransitioningPropertyValues = {}, this.defaultPossiblyEvaluatedValues = {}, this.overridableProperties = [];
            for (const e2 in t2) {
              const r2 = t2[e2];
              r2.specification.overridable && this.overridableProperties.push(e2);
              const n2 = this.defaultPropertyValues[e2] = new ti(r2, void 0), i2 = this.defaultTransitionablePropertyValues[e2] = new ei(r2);
              this.defaultTransitioningPropertyValues[e2] = i2.untransitioned(), this.defaultPossiblyEvaluatedValues[e2] = n2.possiblyEvaluate({});
            }
          }
        }
        Mn("DataDrivenProperty", ui), Mn("DataConstantProperty", li), Mn("CrossFadedDataDrivenProperty", ci), Mn("CrossFadedProperty", hi), Mn("ColorRampProperty", pi);
        const di = "-transition";
        class yi extends rt {
          constructor(t2, e2) {
            if (super(), this.id = t2.id, this.type = t2.type, this._featureFilter = { filter: () => true, needGeometry: false }, "custom" !== t2.type && (this.metadata = t2.metadata, this.minzoom = t2.minzoom, this.maxzoom = t2.maxzoom, "background" !== t2.type && (this.source = t2.source, this.sourceLayer = t2["source-layer"], this.filter = t2.filter), e2.layout && (this._unevaluatedLayout = new ai(e2.layout)), e2.paint)) {
              this._transitionablePaint = new ri(e2.paint);
              for (const e3 in t2.paint)
                this.setPaintProperty(e3, t2.paint[e3], { validate: false });
              for (const e3 in t2.layout)
                this.setLayoutProperty(e3, t2.layout[e3], { validate: false });
              this._transitioningPaint = this._transitionablePaint.untransitioned(), this.paint = new oi(e2.paint);
            }
          }
          getCrossfadeParameters() {
            return this._crossfadeParameters;
          }
          getLayoutProperty(t2) {
            return "visibility" === t2 ? this.visibility : this._unevaluatedLayout.getValue(t2);
          }
          setLayoutProperty(t2, e2, r2 = {}) {
            null != e2 && this._validate(An, `layers.${this.id}.layout.${t2}`, t2, e2, r2) || ("visibility" !== t2 ? this._unevaluatedLayout.setValue(t2, e2) : this.visibility = e2);
          }
          getPaintProperty(t2) {
            return t2.endsWith(di) ? this._transitionablePaint.getTransition(t2.slice(0, -di.length)) : this._transitionablePaint.getValue(t2);
          }
          setPaintProperty(t2, e2, r2 = {}) {
            if (null != e2 && this._validate(_n, `layers.${this.id}.paint.${t2}`, t2, e2, r2))
              return false;
            if (t2.endsWith(di))
              return this._transitionablePaint.setTransition(t2.slice(0, -di.length), e2 || void 0), false;
            {
              const r3 = this._transitionablePaint._values[t2], n2 = "cross-faded-data-driven" === r3.property.specification["property-type"], i2 = r3.value.isDataDriven(), a2 = r3.value;
              this._transitionablePaint.setValue(t2, e2), this._handleSpecialPaintPropertyUpdate(t2);
              const s2 = this._transitionablePaint._values[t2].value;
              return s2.isDataDriven() || i2 || n2 || this._handleOverridablePaintPropertyUpdate(t2, a2, s2);
            }
          }
          _handleSpecialPaintPropertyUpdate(t2) {
          }
          _handleOverridablePaintPropertyUpdate(t2, e2, r2) {
            return false;
          }
          isHidden(t2) {
            return !!(this.minzoom && t2 < this.minzoom) || !!(this.maxzoom && t2 >= this.maxzoom) || "none" === this.visibility;
          }
          updateTransitions(t2) {
            this._transitioningPaint = this._transitionablePaint.transitioned(t2, this._transitioningPaint);
          }
          hasTransition() {
            return this._transitioningPaint.hasTransition();
          }
          recalculate(t2, e2) {
            t2.getCrossfadeParameters && (this._crossfadeParameters = t2.getCrossfadeParameters()), this._unevaluatedLayout && (this.layout = this._unevaluatedLayout.possiblyEvaluate(t2, void 0, e2)), this.paint = this._transitioningPaint.possiblyEvaluate(t2, void 0, e2);
          }
          serialize() {
            const t2 = { id: this.id, type: this.type, source: this.source, "source-layer": this.sourceLayer, metadata: this.metadata, minzoom: this.minzoom, maxzoom: this.maxzoom, filter: this.filter, layout: this._unevaluatedLayout && this._unevaluatedLayout.serialize(), paint: this._transitionablePaint && this._transitionablePaint.serialize() };
            return this.visibility && (t2.layout = t2.layout || {}, t2.layout.visibility = this.visibility), h(t2, (t3, e2) => !(void 0 === t3 || "layout" === e2 && !Object.keys(t3).length || "paint" === e2 && !Object.keys(t3).length));
          }
          _validate(t2, e2, r2, n2, i2 = {}) {
            return (!i2 || false !== i2.validate) && kn(this, t2.call(bn, { key: e2, layerType: this.type, objectKey: r2, value: n2, styleSpec: nt, style: { glyphs: true, sprite: true } }));
          }
          is3D() {
            return false;
          }
          isTileClipped() {
            return false;
          }
          hasOffscreenPass() {
            return false;
          }
          resize() {
          }
          isStateDependent() {
            for (const t2 in this.paint._values) {
              const e2 = this.paint.get(t2);
              if (e2 instanceof si && br(e2.property.specification) && ("source" === e2.value.kind || "composite" === e2.value.kind) && e2.value.isStateDependent)
                return true;
            }
            return false;
          }
        }
        const mi = { Int8: Int8Array, Uint8: Uint8Array, Int16: Int16Array, Uint16: Uint16Array, Int32: Int32Array, Uint32: Uint32Array, Float32: Float32Array };
        class gi {
          constructor(t2, e2) {
            this._structArray = t2, this._pos1 = e2 * this.size, this._pos2 = this._pos1 / 2, this._pos4 = this._pos1 / 4, this._pos8 = this._pos1 / 8;
          }
        }
        class xi {
          constructor() {
            this.isTransferred = false, this.capacity = -1, this.resize(0);
          }
          static serialize(t2, e2) {
            return t2._trim(), e2 && (t2.isTransferred = true, e2.push(t2.arrayBuffer)), { length: t2.length, arrayBuffer: t2.arrayBuffer };
          }
          static deserialize(t2) {
            const e2 = Object.create(this.prototype);
            return e2.arrayBuffer = t2.arrayBuffer, e2.length = t2.length, e2.capacity = t2.arrayBuffer.byteLength / e2.bytesPerElement, e2._refreshViews(), e2;
          }
          _trim() {
            this.length !== this.capacity && (this.capacity = this.length, this.arrayBuffer = this.arrayBuffer.slice(0, this.length * this.bytesPerElement), this._refreshViews());
          }
          clear() {
            this.length = 0;
          }
          resize(t2) {
            this.reserve(t2), this.length = t2;
          }
          reserve(t2) {
            if (t2 > this.capacity) {
              this.capacity = Math.max(t2, Math.floor(5 * this.capacity), 128), this.arrayBuffer = new ArrayBuffer(this.capacity * this.bytesPerElement);
              const e2 = this.uint8;
              this._refreshViews(), e2 && this.uint8.set(e2);
            }
          }
          _refreshViews() {
            throw new Error("_refreshViews() must be implemented by each concrete StructArray layout");
          }
        }
        function vi(t2, e2 = 1) {
          let r2 = 0, n2 = 0;
          return { members: t2.map((t3) => {
            const i2 = mi[t3.type].BYTES_PER_ELEMENT, a2 = r2 = bi(r2, Math.max(e2, i2)), s2 = t3.components || 1;
            return n2 = Math.max(n2, i2), r2 += i2 * s2, { name: t3.name, type: t3.type, components: s2, offset: a2 };
          }), size: bi(r2, Math.max(n2, e2)), alignment: e2 };
        }
        function bi(t2, e2) {
          return Math.ceil(t2 / e2) * e2;
        }
        class wi extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2) {
            const r2 = this.length;
            return this.resize(r2 + 1), this.emplace(r2, t2, e2);
          }
          emplace(t2, e2, r2) {
            const n2 = 2 * t2;
            return this.int16[n2 + 0] = e2, this.int16[n2 + 1] = r2, t2;
          }
        }
        wi.prototype.bytesPerElement = 4, Mn("StructArrayLayout2i4", wi);
        class _i extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2, n2) {
            const i2 = this.length;
            return this.resize(i2 + 1), this.emplace(i2, t2, e2, r2, n2);
          }
          emplace(t2, e2, r2, n2, i2) {
            const a2 = 4 * t2;
            return this.int16[a2 + 0] = e2, this.int16[a2 + 1] = r2, this.int16[a2 + 2] = n2, this.int16[a2 + 3] = i2, t2;
          }
        }
        _i.prototype.bytesPerElement = 8, Mn("StructArrayLayout4i8", _i);
        class Ai extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2, n2, i2, a2) {
            const s2 = this.length;
            return this.resize(s2 + 1), this.emplace(s2, t2, e2, r2, n2, i2, a2);
          }
          emplace(t2, e2, r2, n2, i2, a2, s2) {
            const o2 = 6 * t2;
            return this.int16[o2 + 0] = e2, this.int16[o2 + 1] = r2, this.int16[o2 + 2] = n2, this.int16[o2 + 3] = i2, this.int16[o2 + 4] = a2, this.int16[o2 + 5] = s2, t2;
          }
        }
        Ai.prototype.bytesPerElement = 12, Mn("StructArrayLayout2i4i12", Ai);
        class ki extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2, n2, i2, a2) {
            const s2 = this.length;
            return this.resize(s2 + 1), this.emplace(s2, t2, e2, r2, n2, i2, a2);
          }
          emplace(t2, e2, r2, n2, i2, a2, s2) {
            const o2 = 4 * t2, l2 = 8 * t2;
            return this.int16[o2 + 0] = e2, this.int16[o2 + 1] = r2, this.uint8[l2 + 4] = n2, this.uint8[l2 + 5] = i2, this.uint8[l2 + 6] = a2, this.uint8[l2 + 7] = s2, t2;
          }
        }
        ki.prototype.bytesPerElement = 8, Mn("StructArrayLayout2i4ub8", ki);
        class Si extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2) {
            const r2 = this.length;
            return this.resize(r2 + 1), this.emplace(r2, t2, e2);
          }
          emplace(t2, e2, r2) {
            const n2 = 2 * t2;
            return this.float32[n2 + 0] = e2, this.float32[n2 + 1] = r2, t2;
          }
        }
        Si.prototype.bytesPerElement = 8, Mn("StructArrayLayout2f8", Si);
        class Ii extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2, n2, i2, a2, s2, o2, l2, u2) {
            const c3 = this.length;
            return this.resize(c3 + 1), this.emplace(c3, t2, e2, r2, n2, i2, a2, s2, o2, l2, u2);
          }
          emplace(t2, e2, r2, n2, i2, a2, s2, o2, l2, u2, c3) {
            const h2 = 10 * t2;
            return this.uint16[h2 + 0] = e2, this.uint16[h2 + 1] = r2, this.uint16[h2 + 2] = n2, this.uint16[h2 + 3] = i2, this.uint16[h2 + 4] = a2, this.uint16[h2 + 5] = s2, this.uint16[h2 + 6] = o2, this.uint16[h2 + 7] = l2, this.uint16[h2 + 8] = u2, this.uint16[h2 + 9] = c3, t2;
          }
        }
        Ii.prototype.bytesPerElement = 20, Mn("StructArrayLayout10ui20", Ii);
        class Mi extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2, n2, i2, a2, s2, o2, l2, u2, c3, h2) {
            const p3 = this.length;
            return this.resize(p3 + 1), this.emplace(p3, t2, e2, r2, n2, i2, a2, s2, o2, l2, u2, c3, h2);
          }
          emplace(t2, e2, r2, n2, i2, a2, s2, o2, l2, u2, c3, h2, p3) {
            const f2 = 12 * t2;
            return this.int16[f2 + 0] = e2, this.int16[f2 + 1] = r2, this.int16[f2 + 2] = n2, this.int16[f2 + 3] = i2, this.uint16[f2 + 4] = a2, this.uint16[f2 + 5] = s2, this.uint16[f2 + 6] = o2, this.uint16[f2 + 7] = l2, this.int16[f2 + 8] = u2, this.int16[f2 + 9] = c3, this.int16[f2 + 10] = h2, this.int16[f2 + 11] = p3, t2;
          }
        }
        Mi.prototype.bytesPerElement = 24, Mn("StructArrayLayout4i4ui4i24", Mi);
        class zi extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2) {
            const n2 = this.length;
            return this.resize(n2 + 1), this.emplace(n2, t2, e2, r2);
          }
          emplace(t2, e2, r2, n2) {
            const i2 = 3 * t2;
            return this.float32[i2 + 0] = e2, this.float32[i2 + 1] = r2, this.float32[i2 + 2] = n2, t2;
          }
        }
        zi.prototype.bytesPerElement = 12, Mn("StructArrayLayout3f12", zi);
        class Bi extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer);
          }
          emplaceBack(t2) {
            const e2 = this.length;
            return this.resize(e2 + 1), this.emplace(e2, t2);
          }
          emplace(t2, e2) {
            return this.uint32[1 * t2 + 0] = e2, t2;
          }
        }
        Bi.prototype.bytesPerElement = 4, Mn("StructArrayLayout1ul4", Bi);
        class Ci extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2, n2, i2, a2, s2, o2, l2) {
            const u2 = this.length;
            return this.resize(u2 + 1), this.emplace(u2, t2, e2, r2, n2, i2, a2, s2, o2, l2);
          }
          emplace(t2, e2, r2, n2, i2, a2, s2, o2, l2, u2) {
            const c3 = 10 * t2, h2 = 5 * t2;
            return this.int16[c3 + 0] = e2, this.int16[c3 + 1] = r2, this.int16[c3 + 2] = n2, this.int16[c3 + 3] = i2, this.int16[c3 + 4] = a2, this.int16[c3 + 5] = s2, this.uint32[h2 + 3] = o2, this.uint16[c3 + 8] = l2, this.uint16[c3 + 9] = u2, t2;
          }
        }
        Ci.prototype.bytesPerElement = 20, Mn("StructArrayLayout6i1ul2ui20", Ci);
        class Pi extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2, n2, i2, a2) {
            const s2 = this.length;
            return this.resize(s2 + 1), this.emplace(s2, t2, e2, r2, n2, i2, a2);
          }
          emplace(t2, e2, r2, n2, i2, a2, s2) {
            const o2 = 6 * t2;
            return this.int16[o2 + 0] = e2, this.int16[o2 + 1] = r2, this.int16[o2 + 2] = n2, this.int16[o2 + 3] = i2, this.int16[o2 + 4] = a2, this.int16[o2 + 5] = s2, t2;
          }
        }
        Pi.prototype.bytesPerElement = 12, Mn("StructArrayLayout2i2i2i12", Pi);
        class Vi extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2, n2, i2) {
            const a2 = this.length;
            return this.resize(a2 + 1), this.emplace(a2, t2, e2, r2, n2, i2);
          }
          emplace(t2, e2, r2, n2, i2, a2) {
            const s2 = 4 * t2, o2 = 8 * t2;
            return this.float32[s2 + 0] = e2, this.float32[s2 + 1] = r2, this.float32[s2 + 2] = n2, this.int16[o2 + 6] = i2, this.int16[o2 + 7] = a2, t2;
          }
        }
        Vi.prototype.bytesPerElement = 16, Mn("StructArrayLayout2f1f2i16", Vi);
        class Ei extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2, n2) {
            const i2 = this.length;
            return this.resize(i2 + 1), this.emplace(i2, t2, e2, r2, n2);
          }
          emplace(t2, e2, r2, n2, i2) {
            const a2 = 12 * t2, s2 = 3 * t2;
            return this.uint8[a2 + 0] = e2, this.uint8[a2 + 1] = r2, this.float32[s2 + 1] = n2, this.float32[s2 + 2] = i2, t2;
          }
        }
        Ei.prototype.bytesPerElement = 12, Mn("StructArrayLayout2ub2f12", Ei);
        class Fi extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2) {
            const n2 = this.length;
            return this.resize(n2 + 1), this.emplace(n2, t2, e2, r2);
          }
          emplace(t2, e2, r2, n2) {
            const i2 = 3 * t2;
            return this.uint16[i2 + 0] = e2, this.uint16[i2 + 1] = r2, this.uint16[i2 + 2] = n2, t2;
          }
        }
        Fi.prototype.bytesPerElement = 6, Mn("StructArrayLayout3ui6", Fi);
        class Ti extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2, n2, i2, a2, s2, o2, l2, u2, c3, h2, p3, f2, d2, y3, m2) {
            const g2 = this.length;
            return this.resize(g2 + 1), this.emplace(g2, t2, e2, r2, n2, i2, a2, s2, o2, l2, u2, c3, h2, p3, f2, d2, y3, m2);
          }
          emplace(t2, e2, r2, n2, i2, a2, s2, o2, l2, u2, c3, h2, p3, f2, d2, y3, m2, g2) {
            const x2 = 24 * t2, v3 = 12 * t2, b2 = 48 * t2;
            return this.int16[x2 + 0] = e2, this.int16[x2 + 1] = r2, this.uint16[x2 + 2] = n2, this.uint16[x2 + 3] = i2, this.uint32[v3 + 2] = a2, this.uint32[v3 + 3] = s2, this.uint32[v3 + 4] = o2, this.uint16[x2 + 10] = l2, this.uint16[x2 + 11] = u2, this.uint16[x2 + 12] = c3, this.float32[v3 + 7] = h2, this.float32[v3 + 8] = p3, this.uint8[b2 + 36] = f2, this.uint8[b2 + 37] = d2, this.uint8[b2 + 38] = y3, this.uint32[v3 + 10] = m2, this.int16[x2 + 22] = g2, t2;
          }
        }
        Ti.prototype.bytesPerElement = 48, Mn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48", Ti);
        class Li extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2, n2, i2, a2, s2, o2, l2, u2, c3, h2, p3, f2, d2, y3, m2, g2, x2, v3, b2, w2, _2, A3, k2, S2, I3, M2) {
            const z2 = this.length;
            return this.resize(z2 + 1), this.emplace(z2, t2, e2, r2, n2, i2, a2, s2, o2, l2, u2, c3, h2, p3, f2, d2, y3, m2, g2, x2, v3, b2, w2, _2, A3, k2, S2, I3, M2);
          }
          emplace(t2, e2, r2, n2, i2, a2, s2, o2, l2, u2, c3, h2, p3, f2, d2, y3, m2, g2, x2, v3, b2, w2, _2, A3, k2, S2, I3, M2, z2) {
            const B2 = 34 * t2, C2 = 17 * t2;
            return this.int16[B2 + 0] = e2, this.int16[B2 + 1] = r2, this.int16[B2 + 2] = n2, this.int16[B2 + 3] = i2, this.int16[B2 + 4] = a2, this.int16[B2 + 5] = s2, this.int16[B2 + 6] = o2, this.int16[B2 + 7] = l2, this.uint16[B2 + 8] = u2, this.uint16[B2 + 9] = c3, this.uint16[B2 + 10] = h2, this.uint16[B2 + 11] = p3, this.uint16[B2 + 12] = f2, this.uint16[B2 + 13] = d2, this.uint16[B2 + 14] = y3, this.uint16[B2 + 15] = m2, this.uint16[B2 + 16] = g2, this.uint16[B2 + 17] = x2, this.uint16[B2 + 18] = v3, this.uint16[B2 + 19] = b2, this.uint16[B2 + 20] = w2, this.uint16[B2 + 21] = _2, this.uint16[B2 + 22] = A3, this.uint32[C2 + 12] = k2, this.float32[C2 + 13] = S2, this.float32[C2 + 14] = I3, this.float32[C2 + 15] = M2, this.float32[C2 + 16] = z2, t2;
          }
        }
        Li.prototype.bytesPerElement = 68, Mn("StructArrayLayout8i15ui1ul4f68", Li);
        class Di extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
          }
          emplaceBack(t2) {
            const e2 = this.length;
            return this.resize(e2 + 1), this.emplace(e2, t2);
          }
          emplace(t2, e2) {
            return this.float32[1 * t2 + 0] = e2, t2;
          }
        }
        Di.prototype.bytesPerElement = 4, Mn("StructArrayLayout1f4", Di);
        class $i extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2) {
            const n2 = this.length;
            return this.resize(n2 + 1), this.emplace(n2, t2, e2, r2);
          }
          emplace(t2, e2, r2, n2) {
            const i2 = 3 * t2;
            return this.int16[i2 + 0] = e2, this.int16[i2 + 1] = r2, this.int16[i2 + 2] = n2, t2;
          }
        }
        $i.prototype.bytesPerElement = 6, Mn("StructArrayLayout3i6", $i);
        class Ri extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2) {
            const n2 = this.length;
            return this.resize(n2 + 1), this.emplace(n2, t2, e2, r2);
          }
          emplace(t2, e2, r2, n2) {
            const i2 = 4 * t2;
            return this.uint32[2 * t2 + 0] = e2, this.uint16[i2 + 2] = r2, this.uint16[i2 + 3] = n2, t2;
          }
        }
        Ri.prototype.bytesPerElement = 8, Mn("StructArrayLayout1ul2ui8", Ri);
        class Oi extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2) {
            const r2 = this.length;
            return this.resize(r2 + 1), this.emplace(r2, t2, e2);
          }
          emplace(t2, e2, r2) {
            const n2 = 2 * t2;
            return this.uint16[n2 + 0] = e2, this.uint16[n2 + 1] = r2, t2;
          }
        }
        Oi.prototype.bytesPerElement = 4, Mn("StructArrayLayout2ui4", Oi);
        class Ui extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
          }
          emplaceBack(t2) {
            const e2 = this.length;
            return this.resize(e2 + 1), this.emplace(e2, t2);
          }
          emplace(t2, e2) {
            return this.uint16[1 * t2 + 0] = e2, t2;
          }
        }
        Ui.prototype.bytesPerElement = 2, Mn("StructArrayLayout1ui2", Ui);
        class qi extends xi {
          _refreshViews() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
          }
          emplaceBack(t2, e2, r2, n2) {
            const i2 = this.length;
            return this.resize(i2 + 1), this.emplace(i2, t2, e2, r2, n2);
          }
          emplace(t2, e2, r2, n2, i2) {
            const a2 = 4 * t2;
            return this.float32[a2 + 0] = e2, this.float32[a2 + 1] = r2, this.float32[a2 + 2] = n2, this.float32[a2 + 3] = i2, t2;
          }
        }
        qi.prototype.bytesPerElement = 16, Mn("StructArrayLayout4f16", qi);
        class ji extends gi {
          get anchorPointX() {
            return this._structArray.int16[this._pos2 + 0];
          }
          get anchorPointY() {
            return this._structArray.int16[this._pos2 + 1];
          }
          get x1() {
            return this._structArray.int16[this._pos2 + 2];
          }
          get y1() {
            return this._structArray.int16[this._pos2 + 3];
          }
          get x2() {
            return this._structArray.int16[this._pos2 + 4];
          }
          get y2() {
            return this._structArray.int16[this._pos2 + 5];
          }
          get featureIndex() {
            return this._structArray.uint32[this._pos4 + 3];
          }
          get sourceLayerIndex() {
            return this._structArray.uint16[this._pos2 + 8];
          }
          get bucketIndex() {
            return this._structArray.uint16[this._pos2 + 9];
          }
          get anchorPoint() {
            return new S(this.anchorPointX, this.anchorPointY);
          }
        }
        ji.prototype.size = 20;
        class Ni extends Ci {
          get(t2) {
            return new ji(this, t2);
          }
        }
        Mn("CollisionBoxArray", Ni);
        class Zi extends gi {
          get anchorX() {
            return this._structArray.int16[this._pos2 + 0];
          }
          get anchorY() {
            return this._structArray.int16[this._pos2 + 1];
          }
          get glyphStartIndex() {
            return this._structArray.uint16[this._pos2 + 2];
          }
          get numGlyphs() {
            return this._structArray.uint16[this._pos2 + 3];
          }
          get vertexStartIndex() {
            return this._structArray.uint32[this._pos4 + 2];
          }
          get lineStartIndex() {
            return this._structArray.uint32[this._pos4 + 3];
          }
          get lineLength() {
            return this._structArray.uint32[this._pos4 + 4];
          }
          get segment() {
            return this._structArray.uint16[this._pos2 + 10];
          }
          get lowerSize() {
            return this._structArray.uint16[this._pos2 + 11];
          }
          get upperSize() {
            return this._structArray.uint16[this._pos2 + 12];
          }
          get lineOffsetX() {
            return this._structArray.float32[this._pos4 + 7];
          }
          get lineOffsetY() {
            return this._structArray.float32[this._pos4 + 8];
          }
          get writingMode() {
            return this._structArray.uint8[this._pos1 + 36];
          }
          get placedOrientation() {
            return this._structArray.uint8[this._pos1 + 37];
          }
          set placedOrientation(t2) {
            this._structArray.uint8[this._pos1 + 37] = t2;
          }
          get hidden() {
            return this._structArray.uint8[this._pos1 + 38];
          }
          set hidden(t2) {
            this._structArray.uint8[this._pos1 + 38] = t2;
          }
          get crossTileID() {
            return this._structArray.uint32[this._pos4 + 10];
          }
          set crossTileID(t2) {
            this._structArray.uint32[this._pos4 + 10] = t2;
          }
          get associatedIconIndex() {
            return this._structArray.int16[this._pos2 + 22];
          }
        }
        Zi.prototype.size = 48;
        class Ki extends Ti {
          get(t2) {
            return new Zi(this, t2);
          }
        }
        Mn("PlacedSymbolArray", Ki);
        class Gi extends gi {
          get anchorX() {
            return this._structArray.int16[this._pos2 + 0];
          }
          get anchorY() {
            return this._structArray.int16[this._pos2 + 1];
          }
          get rightJustifiedTextSymbolIndex() {
            return this._structArray.int16[this._pos2 + 2];
          }
          get centerJustifiedTextSymbolIndex() {
            return this._structArray.int16[this._pos2 + 3];
          }
          get leftJustifiedTextSymbolIndex() {
            return this._structArray.int16[this._pos2 + 4];
          }
          get verticalPlacedTextSymbolIndex() {
            return this._structArray.int16[this._pos2 + 5];
          }
          get placedIconSymbolIndex() {
            return this._structArray.int16[this._pos2 + 6];
          }
          get verticalPlacedIconSymbolIndex() {
            return this._structArray.int16[this._pos2 + 7];
          }
          get key() {
            return this._structArray.uint16[this._pos2 + 8];
          }
          get textBoxStartIndex() {
            return this._structArray.uint16[this._pos2 + 9];
          }
          get textBoxEndIndex() {
            return this._structArray.uint16[this._pos2 + 10];
          }
          get verticalTextBoxStartIndex() {
            return this._structArray.uint16[this._pos2 + 11];
          }
          get verticalTextBoxEndIndex() {
            return this._structArray.uint16[this._pos2 + 12];
          }
          get iconBoxStartIndex() {
            return this._structArray.uint16[this._pos2 + 13];
          }
          get iconBoxEndIndex() {
            return this._structArray.uint16[this._pos2 + 14];
          }
          get verticalIconBoxStartIndex() {
            return this._structArray.uint16[this._pos2 + 15];
          }
          get verticalIconBoxEndIndex() {
            return this._structArray.uint16[this._pos2 + 16];
          }
          get featureIndex() {
            return this._structArray.uint16[this._pos2 + 17];
          }
          get numHorizontalGlyphVertices() {
            return this._structArray.uint16[this._pos2 + 18];
          }
          get numVerticalGlyphVertices() {
            return this._structArray.uint16[this._pos2 + 19];
          }
          get numIconVertices() {
            return this._structArray.uint16[this._pos2 + 20];
          }
          get numVerticalIconVertices() {
            return this._structArray.uint16[this._pos2 + 21];
          }
          get useRuntimeCollisionCircles() {
            return this._structArray.uint16[this._pos2 + 22];
          }
          get crossTileID() {
            return this._structArray.uint32[this._pos4 + 12];
          }
          set crossTileID(t2) {
            this._structArray.uint32[this._pos4 + 12] = t2;
          }
          get textBoxScale() {
            return this._structArray.float32[this._pos4 + 13];
          }
          get textOffset0() {
            return this._structArray.float32[this._pos4 + 14];
          }
          get textOffset1() {
            return this._structArray.float32[this._pos4 + 15];
          }
          get collisionCircleDiameter() {
            return this._structArray.float32[this._pos4 + 16];
          }
        }
        Gi.prototype.size = 68;
        class Ji extends Li {
          get(t2) {
            return new Gi(this, t2);
          }
        }
        Mn("SymbolInstanceArray", Ji);
        class Xi extends Di {
          getoffsetX(t2) {
            return this.float32[1 * t2 + 0];
          }
        }
        Mn("GlyphOffsetArray", Xi);
        class Yi extends $i {
          getx(t2) {
            return this.int16[3 * t2 + 0];
          }
          gety(t2) {
            return this.int16[3 * t2 + 1];
          }
          gettileUnitDistanceFromAnchor(t2) {
            return this.int16[3 * t2 + 2];
          }
        }
        Mn("SymbolLineVertexArray", Yi);
        class Hi extends gi {
          get featureIndex() {
            return this._structArray.uint32[this._pos4 + 0];
          }
          get sourceLayerIndex() {
            return this._structArray.uint16[this._pos2 + 2];
          }
          get bucketIndex() {
            return this._structArray.uint16[this._pos2 + 3];
          }
        }
        Hi.prototype.size = 8;
        class Wi extends Ri {
          get(t2) {
            return new Hi(this, t2);
          }
        }
        Mn("FeatureIndexArray", Wi);
        class Qi extends wi {
        }
        class ta extends wi {
        }
        class ea extends wi {
        }
        class ra extends Ai {
        }
        class na extends ki {
        }
        class ia extends Si {
        }
        class aa extends Ii {
        }
        class sa extends Mi {
        }
        class oa extends zi {
        }
        class la extends Bi {
        }
        class ua2 extends Pi {
        }
        class ca extends Ei {
        }
        class ha extends Fi {
        }
        class pa extends Oi {
        }
        const fa = vi([{ name: "a_pos", components: 2, type: "Int16" }], 4), { members: da } = fa;
        class ya {
          constructor(t2 = []) {
            this.segments = t2;
          }
          prepareSegment(t2, e2, r2, n2) {
            let i2 = this.segments[this.segments.length - 1];
            return t2 > ya.MAX_VERTEX_ARRAY_LENGTH && d(`Max vertices per segment is ${ya.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t2}`), (!i2 || i2.vertexLength + t2 > ya.MAX_VERTEX_ARRAY_LENGTH || i2.sortKey !== n2) && (i2 = { vertexOffset: e2.length, primitiveOffset: r2.length, vertexLength: 0, primitiveLength: 0 }, void 0 !== n2 && (i2.sortKey = n2), this.segments.push(i2)), i2;
          }
          get() {
            return this.segments;
          }
          destroy() {
            for (const t2 of this.segments)
              for (const e2 in t2.vaos)
                t2.vaos[e2].destroy();
          }
          static simpleSegment(t2, e2, r2, n2) {
            return new ya([{ vertexOffset: t2, primitiveOffset: e2, vertexLength: r2, primitiveLength: n2, vaos: {}, sortKey: 0 }]);
          }
        }
        function ma(t2, e2) {
          return 256 * (t2 = a(Math.floor(t2), 0, 255)) + a(Math.floor(e2), 0, 255);
        }
        ya.MAX_VERTEX_ARRAY_LENGTH = Math.pow(2, 16) - 1, Mn("SegmentVector", ya);
        const ga = vi([{ name: "a_pattern_from", components: 4, type: "Uint16" }, { name: "a_pattern_to", components: 4, type: "Uint16" }, { name: "a_pixel_ratio_from", components: 1, type: "Uint16" }, { name: "a_pixel_ratio_to", components: 1, type: "Uint16" }]);
        var xa = { exports: {} }, va = { exports: {} };
        va.exports = function(t2, e2) {
          var r2, n2, i2, a2, s2, o2, l2, u2;
          for (n2 = t2.length - (r2 = 3 & t2.length), i2 = e2, s2 = 3432918353, o2 = 461845907, u2 = 0; u2 < n2; )
            l2 = 255 & t2.charCodeAt(u2) | (255 & t2.charCodeAt(++u2)) << 8 | (255 & t2.charCodeAt(++u2)) << 16 | (255 & t2.charCodeAt(++u2)) << 24, ++u2, i2 = 27492 + (65535 & (a2 = 5 * (65535 & (i2 = (i2 ^= l2 = (65535 & (l2 = (l2 = (65535 & l2) * s2 + (((l2 >>> 16) * s2 & 65535) << 16) & 4294967295) << 15 | l2 >>> 17)) * o2 + (((l2 >>> 16) * o2 & 65535) << 16) & 4294967295) << 13 | i2 >>> 19)) + ((5 * (i2 >>> 16) & 65535) << 16) & 4294967295)) + ((58964 + (a2 >>> 16) & 65535) << 16);
          switch (l2 = 0, r2) {
            case 3:
              l2 ^= (255 & t2.charCodeAt(u2 + 2)) << 16;
            case 2:
              l2 ^= (255 & t2.charCodeAt(u2 + 1)) << 8;
            case 1:
              i2 ^= l2 = (65535 & (l2 = (l2 = (65535 & (l2 ^= 255 & t2.charCodeAt(u2))) * s2 + (((l2 >>> 16) * s2 & 65535) << 16) & 4294967295) << 15 | l2 >>> 17)) * o2 + (((l2 >>> 16) * o2 & 65535) << 16) & 4294967295;
          }
          return i2 ^= t2.length, i2 = 2246822507 * (65535 & (i2 ^= i2 >>> 16)) + ((2246822507 * (i2 >>> 16) & 65535) << 16) & 4294967295, i2 = 3266489909 * (65535 & (i2 ^= i2 >>> 13)) + ((3266489909 * (i2 >>> 16) & 65535) << 16) & 4294967295, (i2 ^= i2 >>> 16) >>> 0;
        };
        var ba = { exports: {} };
        ba.exports = function(t2, e2) {
          for (var r2, n2 = t2.length, i2 = e2 ^ n2, a2 = 0; n2 >= 4; )
            r2 = 1540483477 * (65535 & (r2 = 255 & t2.charCodeAt(a2) | (255 & t2.charCodeAt(++a2)) << 8 | (255 & t2.charCodeAt(++a2)) << 16 | (255 & t2.charCodeAt(++a2)) << 24)) + ((1540483477 * (r2 >>> 16) & 65535) << 16), i2 = 1540483477 * (65535 & i2) + ((1540483477 * (i2 >>> 16) & 65535) << 16) ^ (r2 = 1540483477 * (65535 & (r2 ^= r2 >>> 24)) + ((1540483477 * (r2 >>> 16) & 65535) << 16)), n2 -= 4, ++a2;
          switch (n2) {
            case 3:
              i2 ^= (255 & t2.charCodeAt(a2 + 2)) << 16;
            case 2:
              i2 ^= (255 & t2.charCodeAt(a2 + 1)) << 8;
            case 1:
              i2 = 1540483477 * (65535 & (i2 ^= 255 & t2.charCodeAt(a2))) + ((1540483477 * (i2 >>> 16) & 65535) << 16);
          }
          return i2 = 1540483477 * (65535 & (i2 ^= i2 >>> 13)) + ((1540483477 * (i2 >>> 16) & 65535) << 16), (i2 ^= i2 >>> 15) >>> 0;
        };
        var wa = va.exports, _a = ba.exports;
        xa.exports = wa, xa.exports.murmur3 = wa, xa.exports.murmur2 = _a;
        class Aa {
          constructor() {
            this.ids = [], this.positions = [], this.indexed = false;
          }
          add(t2, e2, r2, n2) {
            this.ids.push(ka(t2)), this.positions.push(e2, r2, n2);
          }
          getPositions(t2) {
            if (!this.indexed)
              throw new Error("Trying to get index, but feature positions are not indexed");
            const e2 = ka(t2);
            let r2 = 0, n2 = this.ids.length - 1;
            for (; r2 < n2; ) {
              const t3 = r2 + n2 >> 1;
              this.ids[t3] >= e2 ? n2 = t3 : r2 = t3 + 1;
            }
            const i2 = [];
            for (; this.ids[r2] === e2; )
              i2.push({ index: this.positions[3 * r2], start: this.positions[3 * r2 + 1], end: this.positions[3 * r2 + 2] }), r2++;
            return i2;
          }
          static serialize(t2, e2) {
            const r2 = new Float64Array(t2.ids), n2 = new Uint32Array(t2.positions);
            return Sa(r2, n2, 0, r2.length - 1), e2 && e2.push(r2.buffer, n2.buffer), { ids: r2, positions: n2 };
          }
          static deserialize(t2) {
            const e2 = new Aa();
            return e2.ids = t2.ids, e2.positions = t2.positions, e2.indexed = true, e2;
          }
        }
        function ka(t2) {
          const e2 = +t2;
          return !isNaN(e2) && e2 <= Number.MAX_SAFE_INTEGER ? e2 : xa.exports(String(t2));
        }
        function Sa(t2, e2, r2, n2) {
          for (; r2 < n2; ) {
            const i2 = t2[r2 + n2 >> 1];
            let a2 = r2 - 1, s2 = n2 + 1;
            for (; ; ) {
              do {
                a2++;
              } while (t2[a2] < i2);
              do {
                s2--;
              } while (t2[s2] > i2);
              if (a2 >= s2)
                break;
              Ia(t2, a2, s2), Ia(e2, 3 * a2, 3 * s2), Ia(e2, 3 * a2 + 1, 3 * s2 + 1), Ia(e2, 3 * a2 + 2, 3 * s2 + 2);
            }
            s2 - r2 < n2 - s2 ? (Sa(t2, e2, r2, s2), r2 = s2 + 1) : (Sa(t2, e2, s2 + 1, n2), n2 = s2);
          }
        }
        function Ia(t2, e2, r2) {
          const n2 = t2[e2];
          t2[e2] = t2[r2], t2[r2] = n2;
        }
        Mn("FeaturePositionMap", Aa);
        class Ma {
          constructor(t2, e2) {
            this.gl = t2.gl, this.location = e2;
          }
        }
        class za extends Ma {
          constructor(t2, e2) {
            super(t2, e2), this.current = 0;
          }
          set(t2) {
            this.current !== t2 && (this.current = t2, this.gl.uniform1f(this.location, t2));
          }
        }
        class Ba extends Ma {
          constructor(t2, e2) {
            super(t2, e2), this.current = [0, 0, 0, 0];
          }
          set(t2) {
            t2[0] === this.current[0] && t2[1] === this.current[1] && t2[2] === this.current[2] && t2[3] === this.current[3] || (this.current = t2, this.gl.uniform4f(this.location, t2[0], t2[1], t2[2], t2[3]));
          }
        }
        class Ca extends Ma {
          constructor(t2, e2) {
            super(t2, e2), this.current = Ft.transparent;
          }
          set(t2) {
            t2.r === this.current.r && t2.g === this.current.g && t2.b === this.current.b && t2.a === this.current.a || (this.current = t2, this.gl.uniform4f(this.location, t2.r, t2.g, t2.b, t2.a));
          }
        }
        const Pa = new Float32Array(16);
        function Va(t2) {
          return [ma(255 * t2.r, 255 * t2.g), ma(255 * t2.b, 255 * t2.a)];
        }
        class Ea {
          constructor(t2, e2, r2) {
            this.value = t2, this.uniformNames = e2.map((t3) => `u_${t3}`), this.type = r2;
          }
          setUniform(t2, e2, r2) {
            t2.set(r2.constantOr(this.value));
          }
          getBinding(t2, e2, r2) {
            return "color" === this.type ? new Ca(t2, e2) : new za(t2, e2);
          }
        }
        class Fa {
          constructor(t2, e2) {
            this.uniformNames = e2.map((t3) => `u_${t3}`), this.patternFrom = null, this.patternTo = null, this.pixelRatioFrom = 1, this.pixelRatioTo = 1;
          }
          setConstantPatternPositions(t2, e2) {
            this.pixelRatioFrom = e2.pixelRatio, this.pixelRatioTo = t2.pixelRatio, this.patternFrom = e2.tlbr, this.patternTo = t2.tlbr;
          }
          setUniform(t2, e2, r2, n2) {
            const i2 = "u_pattern_to" === n2 ? this.patternTo : "u_pattern_from" === n2 ? this.patternFrom : "u_pixel_ratio_to" === n2 ? this.pixelRatioTo : "u_pixel_ratio_from" === n2 ? this.pixelRatioFrom : null;
            i2 && t2.set(i2);
          }
          getBinding(t2, e2, r2) {
            return "u_pattern" === r2.substr(0, 9) ? new Ba(t2, e2) : new za(t2, e2);
          }
        }
        class Ta {
          constructor(t2, e2, r2, n2) {
            this.expression = t2, this.type = r2, this.maxValue = 0, this.paintVertexAttributes = e2.map((t3) => ({ name: `a_${t3}`, type: "Float32", components: "color" === r2 ? 2 : 1, offset: 0 })), this.paintVertexArray = new n2();
          }
          populatePaintArray(t2, e2, r2, n2, i2) {
            const a2 = this.paintVertexArray.length, s2 = this.expression.evaluate(new Qn(0), e2, {}, n2, [], i2);
            this.paintVertexArray.resize(t2), this._setPaintValue(a2, t2, s2);
          }
          updatePaintArray(t2, e2, r2, n2) {
            const i2 = this.expression.evaluate({ zoom: 0 }, r2, n2);
            this._setPaintValue(t2, e2, i2);
          }
          _setPaintValue(t2, e2, r2) {
            if ("color" === this.type) {
              const n2 = Va(r2);
              for (let r3 = t2; r3 < e2; r3++)
                this.paintVertexArray.emplace(r3, n2[0], n2[1]);
            } else {
              for (let n2 = t2; n2 < e2; n2++)
                this.paintVertexArray.emplace(n2, r2);
              this.maxValue = Math.max(this.maxValue, Math.abs(r2));
            }
          }
          upload(t2) {
            this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = t2.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent));
          }
          destroy() {
            this.paintVertexBuffer && this.paintVertexBuffer.destroy();
          }
        }
        class La {
          constructor(t2, e2, r2, n2, i2, a2) {
            this.expression = t2, this.uniformNames = e2.map((t3) => `u_${t3}_t`), this.type = r2, this.useIntegerZoom = n2, this.zoom = i2, this.maxValue = 0, this.paintVertexAttributes = e2.map((t3) => ({ name: `a_${t3}`, type: "Float32", components: "color" === r2 ? 4 : 2, offset: 0 })), this.paintVertexArray = new a2();
          }
          populatePaintArray(t2, e2, r2, n2, i2) {
            const a2 = this.expression.evaluate(new Qn(this.zoom), e2, {}, n2, [], i2), s2 = this.expression.evaluate(new Qn(this.zoom + 1), e2, {}, n2, [], i2), o2 = this.paintVertexArray.length;
            this.paintVertexArray.resize(t2), this._setPaintValue(o2, t2, a2, s2);
          }
          updatePaintArray(t2, e2, r2, n2) {
            const i2 = this.expression.evaluate({ zoom: this.zoom }, r2, n2), a2 = this.expression.evaluate({ zoom: this.zoom + 1 }, r2, n2);
            this._setPaintValue(t2, e2, i2, a2);
          }
          _setPaintValue(t2, e2, r2, n2) {
            if ("color" === this.type) {
              const i2 = Va(r2), a2 = Va(n2);
              for (let r3 = t2; r3 < e2; r3++)
                this.paintVertexArray.emplace(r3, i2[0], i2[1], a2[0], a2[1]);
            } else {
              for (let i2 = t2; i2 < e2; i2++)
                this.paintVertexArray.emplace(i2, r2, n2);
              this.maxValue = Math.max(this.maxValue, Math.abs(r2), Math.abs(n2));
            }
          }
          upload(t2) {
            this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = t2.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent));
          }
          destroy() {
            this.paintVertexBuffer && this.paintVertexBuffer.destroy();
          }
          setUniform(t2, e2) {
            const r2 = this.useIntegerZoom ? Math.floor(e2.zoom) : e2.zoom, n2 = a(this.expression.interpolationFactor(r2, this.zoom, this.zoom + 1), 0, 1);
            t2.set(n2);
          }
          getBinding(t2, e2, r2) {
            return new za(t2, e2);
          }
        }
        class Da {
          constructor(t2, e2, r2, n2, i2, a2) {
            this.expression = t2, this.type = e2, this.useIntegerZoom = r2, this.zoom = n2, this.layerId = a2, this.zoomInPaintVertexArray = new i2(), this.zoomOutPaintVertexArray = new i2();
          }
          populatePaintArray(t2, e2, r2) {
            const n2 = this.zoomInPaintVertexArray.length;
            this.zoomInPaintVertexArray.resize(t2), this.zoomOutPaintVertexArray.resize(t2), this._setPaintValues(n2, t2, e2.patterns && e2.patterns[this.layerId], r2);
          }
          updatePaintArray(t2, e2, r2, n2, i2) {
            this._setPaintValues(t2, e2, r2.patterns && r2.patterns[this.layerId], i2);
          }
          _setPaintValues(t2, e2, r2, n2) {
            if (!n2 || !r2)
              return;
            const { min: i2, mid: a2, max: s2 } = r2, o2 = n2[i2], l2 = n2[a2], u2 = n2[s2];
            if (o2 && l2 && u2)
              for (let r3 = t2; r3 < e2; r3++)
                this.zoomInPaintVertexArray.emplace(r3, l2.tl[0], l2.tl[1], l2.br[0], l2.br[1], o2.tl[0], o2.tl[1], o2.br[0], o2.br[1], l2.pixelRatio, o2.pixelRatio), this.zoomOutPaintVertexArray.emplace(r3, l2.tl[0], l2.tl[1], l2.br[0], l2.br[1], u2.tl[0], u2.tl[1], u2.br[0], u2.br[1], l2.pixelRatio, u2.pixelRatio);
          }
          upload(t2) {
            this.zoomInPaintVertexArray && this.zoomInPaintVertexArray.arrayBuffer && this.zoomOutPaintVertexArray && this.zoomOutPaintVertexArray.arrayBuffer && (this.zoomInPaintVertexBuffer = t2.createVertexBuffer(this.zoomInPaintVertexArray, ga.members, this.expression.isStateDependent), this.zoomOutPaintVertexBuffer = t2.createVertexBuffer(this.zoomOutPaintVertexArray, ga.members, this.expression.isStateDependent));
          }
          destroy() {
            this.zoomOutPaintVertexBuffer && this.zoomOutPaintVertexBuffer.destroy(), this.zoomInPaintVertexBuffer && this.zoomInPaintVertexBuffer.destroy();
          }
        }
        class $a {
          constructor(t2, e2, r2) {
            this.binders = {}, this._buffers = [];
            const n2 = [];
            for (const i2 in t2.paint._values) {
              if (!r2(i2))
                continue;
              const a2 = t2.paint.get(i2);
              if (!(a2 instanceof si && br(a2.property.specification)))
                continue;
              const s2 = Oa(i2, t2.type), o2 = a2.value, l2 = a2.property.specification.type, u2 = a2.property.useIntegerZoom, c3 = a2.property.specification["property-type"], h2 = "cross-faded" === c3 || "cross-faded-data-driven" === c3;
              if ("constant" === o2.kind)
                this.binders[i2] = h2 ? new Fa(o2.value, s2) : new Ea(o2.value, s2, l2), n2.push(`/u_${i2}`);
              else if ("source" === o2.kind || h2) {
                const r3 = Ua(i2, l2, "source");
                this.binders[i2] = h2 ? new Da(o2, l2, u2, e2, r3, t2.id) : new Ta(o2, s2, l2, r3), n2.push(`/a_${i2}`);
              } else {
                const t3 = Ua(i2, l2, "composite");
                this.binders[i2] = new La(o2, s2, l2, u2, e2, t3), n2.push(`/z_${i2}`);
              }
            }
            this.cacheKey = n2.sort().join("");
          }
          getMaxValue(t2) {
            const e2 = this.binders[t2];
            return e2 instanceof Ta || e2 instanceof La ? e2.maxValue : 0;
          }
          populatePaintArrays(t2, e2, r2, n2, i2) {
            for (const a2 in this.binders) {
              const s2 = this.binders[a2];
              (s2 instanceof Ta || s2 instanceof La || s2 instanceof Da) && s2.populatePaintArray(t2, e2, r2, n2, i2);
            }
          }
          setConstantPatternPositions(t2, e2) {
            for (const r2 in this.binders) {
              const n2 = this.binders[r2];
              n2 instanceof Fa && n2.setConstantPatternPositions(t2, e2);
            }
          }
          updatePaintArrays(t2, e2, r2, n2, i2) {
            let a2 = false;
            for (const s2 in t2) {
              const o2 = e2.getPositions(s2);
              for (const e3 of o2) {
                const o3 = r2.feature(e3.index);
                for (const r3 in this.binders) {
                  const l2 = this.binders[r3];
                  if ((l2 instanceof Ta || l2 instanceof La || l2 instanceof Da) && true === l2.expression.isStateDependent) {
                    const u2 = n2.paint.get(r3);
                    l2.expression = u2.value, l2.updatePaintArray(e3.start, e3.end, o3, t2[s2], i2), a2 = true;
                  }
                }
              }
            }
            return a2;
          }
          defines() {
            const t2 = [];
            for (const e2 in this.binders) {
              const r2 = this.binders[e2];
              (r2 instanceof Ea || r2 instanceof Fa) && t2.push(...r2.uniformNames.map((t3) => `#define HAS_UNIFORM_${t3}`));
            }
            return t2;
          }
          getBinderAttributes() {
            const t2 = [];
            for (const e2 in this.binders) {
              const r2 = this.binders[e2];
              if (r2 instanceof Ta || r2 instanceof La)
                for (let e3 = 0; e3 < r2.paintVertexAttributes.length; e3++)
                  t2.push(r2.paintVertexAttributes[e3].name);
              else if (r2 instanceof Da)
                for (let e3 = 0; e3 < ga.members.length; e3++)
                  t2.push(ga.members[e3].name);
            }
            return t2;
          }
          getBinderUniforms() {
            const t2 = [];
            for (const e2 in this.binders) {
              const r2 = this.binders[e2];
              if (r2 instanceof Ea || r2 instanceof Fa || r2 instanceof La)
                for (const e3 of r2.uniformNames)
                  t2.push(e3);
            }
            return t2;
          }
          getPaintVertexBuffers() {
            return this._buffers;
          }
          getUniforms(t2, e2) {
            const r2 = [];
            for (const n2 in this.binders) {
              const i2 = this.binders[n2];
              if (i2 instanceof Ea || i2 instanceof Fa || i2 instanceof La) {
                for (const a2 of i2.uniformNames)
                  if (e2[a2]) {
                    const s2 = i2.getBinding(t2, e2[a2], a2);
                    r2.push({ name: a2, property: n2, binding: s2 });
                  }
              }
            }
            return r2;
          }
          setUniforms(t2, e2, r2, n2) {
            for (const { name: t3, property: i2, binding: a2 } of e2)
              this.binders[i2].setUniform(a2, n2, r2.get(i2), t3);
          }
          updatePaintBuffers(t2) {
            this._buffers = [];
            for (const e2 in this.binders) {
              const r2 = this.binders[e2];
              if (t2 && r2 instanceof Da) {
                const e3 = 2 === t2.fromScale ? r2.zoomInPaintVertexBuffer : r2.zoomOutPaintVertexBuffer;
                e3 && this._buffers.push(e3);
              } else
                (r2 instanceof Ta || r2 instanceof La) && r2.paintVertexBuffer && this._buffers.push(r2.paintVertexBuffer);
            }
          }
          upload(t2) {
            for (const e2 in this.binders) {
              const r2 = this.binders[e2];
              (r2 instanceof Ta || r2 instanceof La || r2 instanceof Da) && r2.upload(t2);
            }
            this.updatePaintBuffers();
          }
          destroy() {
            for (const t2 in this.binders) {
              const e2 = this.binders[t2];
              (e2 instanceof Ta || e2 instanceof La || e2 instanceof Da) && e2.destroy();
            }
          }
        }
        class Ra {
          constructor(t2, e2, r2 = () => true) {
            this.programConfigurations = {};
            for (const n2 of t2)
              this.programConfigurations[n2.id] = new $a(n2, e2, r2);
            this.needsUpload = false, this._featureMap = new Aa(), this._bufferOffset = 0;
          }
          populatePaintArrays(t2, e2, r2, n2, i2, a2) {
            for (const r3 in this.programConfigurations)
              this.programConfigurations[r3].populatePaintArrays(t2, e2, n2, i2, a2);
            void 0 !== e2.id && this._featureMap.add(e2.id, r2, this._bufferOffset, t2), this._bufferOffset = t2, this.needsUpload = true;
          }
          updatePaintArrays(t2, e2, r2, n2) {
            for (const i2 of r2)
              this.needsUpload = this.programConfigurations[i2.id].updatePaintArrays(t2, this._featureMap, e2, i2, n2) || this.needsUpload;
          }
          get(t2) {
            return this.programConfigurations[t2];
          }
          upload(t2) {
            if (this.needsUpload) {
              for (const e2 in this.programConfigurations)
                this.programConfigurations[e2].upload(t2);
              this.needsUpload = false;
            }
          }
          destroy() {
            for (const t2 in this.programConfigurations)
              this.programConfigurations[t2].destroy();
          }
        }
        function Oa(t2, e2) {
          return { "text-opacity": ["opacity"], "icon-opacity": ["opacity"], "text-color": ["fill_color"], "icon-color": ["fill_color"], "text-halo-color": ["halo_color"], "icon-halo-color": ["halo_color"], "text-halo-blur": ["halo_blur"], "icon-halo-blur": ["halo_blur"], "text-halo-width": ["halo_width"], "icon-halo-width": ["halo_width"], "line-gap-width": ["gapwidth"], "line-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"], "fill-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"], "fill-extrusion-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"] }[t2] || [t2.replace(`${e2}-`, "").replace(/-/g, "_")];
        }
        function Ua(t2, e2, r2) {
          const n2 = { color: { source: Si, composite: qi }, number: { source: Di, composite: Si } }, i2 = function(t3) {
            return { "line-pattern": { source: aa, composite: aa }, "fill-pattern": { source: aa, composite: aa }, "fill-extrusion-pattern": { source: aa, composite: aa } }[t3];
          }(t2);
          return i2 && i2[r2] || n2[e2][r2];
        }
        Mn("ConstantBinder", Ea), Mn("CrossFadedConstantBinder", Fa), Mn("SourceExpressionBinder", Ta), Mn("CrossFadedCompositeBinder", Da), Mn("CompositeExpressionBinder", La), Mn("ProgramConfiguration", $a, { omit: ["_buffers"] }), Mn("ProgramConfigurationSet", Ra);
        var qa = 8192;
        const ja = Math.pow(2, 14) - 1, Na = -ja - 1;
        function Za(t2) {
          const e2 = qa / t2.extent, r2 = t2.loadGeometry();
          for (let t3 = 0; t3 < r2.length; t3++) {
            const n2 = r2[t3];
            for (let t4 = 0; t4 < n2.length; t4++) {
              const r3 = n2[t4], i2 = Math.round(r3.x * e2), s2 = Math.round(r3.y * e2);
              r3.x = a(i2, Na, ja), r3.y = a(s2, Na, ja), (i2 < r3.x || i2 > r3.x + 1 || s2 < r3.y || s2 > r3.y + 1) && d("Geometry exceeds allowed extent, reduce your vector tile buffer size");
            }
          }
          return r2;
        }
        function Ka(t2, e2) {
          return { type: t2.type, id: t2.id, properties: t2.properties, geometry: e2 ? Za(t2) : [] };
        }
        function Ga(t2, e2, r2, n2, i2) {
          t2.emplaceBack(2 * e2 + (n2 + 1) / 2, 2 * r2 + (i2 + 1) / 2);
        }
        class Ja {
          constructor(t2) {
            this.zoom = t2.zoom, this.overscaling = t2.overscaling, this.layers = t2.layers, this.layerIds = this.layers.map((t3) => t3.id), this.index = t2.index, this.hasPattern = false, this.layoutVertexArray = new ta(), this.indexArray = new ha(), this.segments = new ya(), this.programConfigurations = new Ra(t2.layers, t2.zoom), this.stateDependentLayerIds = this.layers.filter((t3) => t3.isStateDependent()).map((t3) => t3.id);
          }
          populate(t2, e2, r2) {
            const n2 = this.layers[0], i2 = [];
            let a2 = null, s2 = false;
            "circle" === n2.type && (a2 = n2.layout.get("circle-sort-key"), s2 = !a2.isConstant());
            for (const { feature: e3, id: n3, index: o2, sourceLayerIndex: l2 } of t2) {
              const t3 = this.layers[0]._featureFilter.needGeometry, u2 = Ka(e3, t3);
              if (!this.layers[0]._featureFilter.filter(new Qn(this.zoom), u2, r2))
                continue;
              const c3 = s2 ? a2.evaluate(u2, {}, r2) : void 0, h2 = { id: n3, properties: e3.properties, type: e3.type, sourceLayerIndex: l2, index: o2, geometry: t3 ? u2.geometry : Za(e3), patterns: {}, sortKey: c3 };
              i2.push(h2);
            }
            s2 && i2.sort((t3, e3) => t3.sortKey - e3.sortKey);
            for (const n3 of i2) {
              const { geometry: i3, index: a3, sourceLayerIndex: s3 } = n3, o2 = t2[a3].feature;
              this.addFeature(n3, i3, a3, r2), e2.featureIndex.insert(o2, i3, a3, s3, this.index);
            }
          }
          update(t2, e2, r2) {
            this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t2, e2, this.stateDependentLayers, r2);
          }
          isEmpty() {
            return 0 === this.layoutVertexArray.length;
          }
          uploadPending() {
            return !this.uploaded || this.programConfigurations.needsUpload;
          }
          upload(t2) {
            this.uploaded || (this.layoutVertexBuffer = t2.createVertexBuffer(this.layoutVertexArray, da), this.indexBuffer = t2.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t2), this.uploaded = true;
          }
          destroy() {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
          }
          addFeature(t2, e2, r2, n2) {
            for (const r3 of e2)
              for (const e3 of r3) {
                const r4 = e3.x, n3 = e3.y;
                if (r4 < 0 || r4 >= qa || n3 < 0 || n3 >= qa)
                  continue;
                const i2 = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray, t2.sortKey), a2 = i2.vertexLength;
                Ga(this.layoutVertexArray, r4, n3, -1, -1), Ga(this.layoutVertexArray, r4, n3, 1, -1), Ga(this.layoutVertexArray, r4, n3, 1, 1), Ga(this.layoutVertexArray, r4, n3, -1, 1), this.indexArray.emplaceBack(a2, a2 + 1, a2 + 2), this.indexArray.emplaceBack(a2, a2 + 3, a2 + 2), i2.vertexLength += 4, i2.primitiveLength += 2;
              }
            this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t2, r2, {}, n2);
          }
        }
        function Xa(t2, e2) {
          for (let r2 = 0; r2 < t2.length; r2++)
            if (is(e2, t2[r2]))
              return true;
          for (let r2 = 0; r2 < e2.length; r2++)
            if (is(t2, e2[r2]))
              return true;
          return !!Qa(t2, e2);
        }
        function Ya(t2, e2, r2) {
          return !!is(t2, e2) || !!es(e2, t2, r2);
        }
        function Ha(t2, e2) {
          if (1 === t2.length)
            return ns(e2, t2[0]);
          for (let r2 = 0; r2 < e2.length; r2++) {
            const n2 = e2[r2];
            for (let e3 = 0; e3 < n2.length; e3++)
              if (is(t2, n2[e3]))
                return true;
          }
          for (let r2 = 0; r2 < t2.length; r2++)
            if (ns(e2, t2[r2]))
              return true;
          for (let r2 = 0; r2 < e2.length; r2++)
            if (Qa(t2, e2[r2]))
              return true;
          return false;
        }
        function Wa(t2, e2, r2) {
          if (t2.length > 1) {
            if (Qa(t2, e2))
              return true;
            for (let n2 = 0; n2 < e2.length; n2++)
              if (es(e2[n2], t2, r2))
                return true;
          }
          for (let n2 = 0; n2 < t2.length; n2++)
            if (es(t2[n2], e2, r2))
              return true;
          return false;
        }
        function Qa(t2, e2) {
          if (0 === t2.length || 0 === e2.length)
            return false;
          for (let r2 = 0; r2 < t2.length - 1; r2++) {
            const n2 = t2[r2], i2 = t2[r2 + 1];
            for (let t3 = 0; t3 < e2.length - 1; t3++)
              if (ts(n2, i2, e2[t3], e2[t3 + 1]))
                return true;
          }
          return false;
        }
        function ts(t2, e2, r2, n2) {
          return y2(t2, r2, n2) !== y2(e2, r2, n2) && y2(t2, e2, r2) !== y2(t2, e2, n2);
        }
        function es(t2, e2, r2) {
          const n2 = r2 * r2;
          if (1 === e2.length)
            return t2.distSqr(e2[0]) < n2;
          for (let r3 = 1; r3 < e2.length; r3++)
            if (rs(t2, e2[r3 - 1], e2[r3]) < n2)
              return true;
          return false;
        }
        function rs(t2, e2, r2) {
          const n2 = e2.distSqr(r2);
          if (0 === n2)
            return t2.distSqr(e2);
          const i2 = ((t2.x - e2.x) * (r2.x - e2.x) + (t2.y - e2.y) * (r2.y - e2.y)) / n2;
          return t2.distSqr(i2 < 0 ? e2 : i2 > 1 ? r2 : r2.sub(e2)._mult(i2)._add(e2));
        }
        function ns(t2, e2) {
          let r2, n2, i2, a2 = false;
          for (let s2 = 0; s2 < t2.length; s2++) {
            r2 = t2[s2];
            for (let t3 = 0, s3 = r2.length - 1; t3 < r2.length; s3 = t3++)
              n2 = r2[t3], i2 = r2[s3], n2.y > e2.y != i2.y > e2.y && e2.x < (i2.x - n2.x) * (e2.y - n2.y) / (i2.y - n2.y) + n2.x && (a2 = !a2);
          }
          return a2;
        }
        function is(t2, e2) {
          let r2 = false;
          for (let n2 = 0, i2 = t2.length - 1; n2 < t2.length; i2 = n2++) {
            const a2 = t2[n2], s2 = t2[i2];
            a2.y > e2.y != s2.y > e2.y && e2.x < (s2.x - a2.x) * (e2.y - a2.y) / (s2.y - a2.y) + a2.x && (r2 = !r2);
          }
          return r2;
        }
        function as(t2, e2, r2) {
          const n2 = r2[0], i2 = r2[2];
          if (t2.x < n2.x && e2.x < n2.x || t2.x > i2.x && e2.x > i2.x || t2.y < n2.y && e2.y < n2.y || t2.y > i2.y && e2.y > i2.y)
            return false;
          const a2 = y2(t2, e2, r2[0]);
          return a2 !== y2(t2, e2, r2[1]) || a2 !== y2(t2, e2, r2[2]) || a2 !== y2(t2, e2, r2[3]);
        }
        function ss(t2, e2, r2) {
          const n2 = e2.paint.get(t2).value;
          return "constant" === n2.kind ? n2.value : r2.programConfigurations.get(e2.id).getMaxValue(t2);
        }
        function os(t2) {
          return Math.sqrt(t2[0] * t2[0] + t2[1] * t2[1]);
        }
        function ls(t2, e2, r2, n2, i2) {
          if (!e2[0] && !e2[1])
            return t2;
          const a2 = S.convert(e2)._mult(i2);
          "viewport" === r2 && a2._rotate(-n2);
          const s2 = [];
          for (let e3 = 0; e3 < t2.length; e3++)
            s2.push(t2[e3].sub(a2));
          return s2;
        }
        Mn("CircleBucket", Ja, { omit: ["layers"] });
        const us = new fi({ "circle-sort-key": new ui(nt.layout_circle["circle-sort-key"]) });
        var cs = { paint: new fi({ "circle-radius": new ui(nt.paint_circle["circle-radius"]), "circle-color": new ui(nt.paint_circle["circle-color"]), "circle-blur": new ui(nt.paint_circle["circle-blur"]), "circle-opacity": new ui(nt.paint_circle["circle-opacity"]), "circle-translate": new li(nt.paint_circle["circle-translate"]), "circle-translate-anchor": new li(nt.paint_circle["circle-translate-anchor"]), "circle-pitch-scale": new li(nt.paint_circle["circle-pitch-scale"]), "circle-pitch-alignment": new li(nt.paint_circle["circle-pitch-alignment"]), "circle-stroke-width": new ui(nt.paint_circle["circle-stroke-width"]), "circle-stroke-color": new ui(nt.paint_circle["circle-stroke-color"]), "circle-stroke-opacity": new ui(nt.paint_circle["circle-stroke-opacity"]) }), layout: us }, hs = 1e-6, ps = "undefined" != typeof Float32Array ? Float32Array : Array;
        function fs() {
          var t2 = new ps(9);
          return ps != Float32Array && (t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[5] = 0, t2[6] = 0, t2[7] = 0), t2[0] = 1, t2[4] = 1, t2[8] = 1, t2;
        }
        function ds(t2) {
          return t2[0] = 1, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[5] = 1, t2[6] = 0, t2[7] = 0, t2[8] = 0, t2[9] = 0, t2[10] = 1, t2[11] = 0, t2[12] = 0, t2[13] = 0, t2[14] = 0, t2[15] = 1, t2;
        }
        function ys(t2, e2, r2) {
          var n2 = e2[0], i2 = e2[1], a2 = e2[2], s2 = e2[3], o2 = e2[4], l2 = e2[5], u2 = e2[6], c3 = e2[7], h2 = e2[8], p3 = e2[9], f2 = e2[10], d2 = e2[11], y3 = e2[12], m2 = e2[13], g2 = e2[14], x2 = e2[15], v3 = r2[0], b2 = r2[1], w2 = r2[2], _2 = r2[3];
          return t2[0] = v3 * n2 + b2 * o2 + w2 * h2 + _2 * y3, t2[1] = v3 * i2 + b2 * l2 + w2 * p3 + _2 * m2, t2[2] = v3 * a2 + b2 * u2 + w2 * f2 + _2 * g2, t2[3] = v3 * s2 + b2 * c3 + w2 * d2 + _2 * x2, t2[4] = (v3 = r2[4]) * n2 + (b2 = r2[5]) * o2 + (w2 = r2[6]) * h2 + (_2 = r2[7]) * y3, t2[5] = v3 * i2 + b2 * l2 + w2 * p3 + _2 * m2, t2[6] = v3 * a2 + b2 * u2 + w2 * f2 + _2 * g2, t2[7] = v3 * s2 + b2 * c3 + w2 * d2 + _2 * x2, t2[8] = (v3 = r2[8]) * n2 + (b2 = r2[9]) * o2 + (w2 = r2[10]) * h2 + (_2 = r2[11]) * y3, t2[9] = v3 * i2 + b2 * l2 + w2 * p3 + _2 * m2, t2[10] = v3 * a2 + b2 * u2 + w2 * f2 + _2 * g2, t2[11] = v3 * s2 + b2 * c3 + w2 * d2 + _2 * x2, t2[12] = (v3 = r2[12]) * n2 + (b2 = r2[13]) * o2 + (w2 = r2[14]) * h2 + (_2 = r2[15]) * y3, t2[13] = v3 * i2 + b2 * l2 + w2 * p3 + _2 * m2, t2[14] = v3 * a2 + b2 * u2 + w2 * f2 + _2 * g2, t2[15] = v3 * s2 + b2 * c3 + w2 * d2 + _2 * x2, t2;
        }
        Math.hypot || (Math.hypot = function() {
          for (var t2 = 0, e2 = arguments.length; e2--; )
            t2 += arguments[e2] * arguments[e2];
          return Math.sqrt(t2);
        });
        var ms, gs = ys;
        function xs() {
          var t2 = new ps(3);
          return ps != Float32Array && (t2[0] = 0, t2[1] = 0, t2[2] = 0), t2;
        }
        function vs(t2, e2, r2) {
          var n2 = new ps(3);
          return n2[0] = t2, n2[1] = e2, n2[2] = r2, n2;
        }
        function bs(t2, e2, r2) {
          var n2 = e2[0], i2 = e2[1], a2 = e2[2], s2 = e2[3];
          return t2[0] = r2[0] * n2 + r2[4] * i2 + r2[8] * a2 + r2[12] * s2, t2[1] = r2[1] * n2 + r2[5] * i2 + r2[9] * a2 + r2[13] * s2, t2[2] = r2[2] * n2 + r2[6] * i2 + r2[10] * a2 + r2[14] * s2, t2[3] = r2[3] * n2 + r2[7] * i2 + r2[11] * a2 + r2[15] * s2, t2;
        }
        function ws() {
          var t2 = new ps(4);
          return ps != Float32Array && (t2[0] = 0, t2[1] = 0, t2[2] = 0), t2[3] = 1, t2;
        }
        function _s(t2, e2) {
          const r2 = bs([], [t2.x, t2.y, 0, 1], e2);
          return new S(r2[0] / r2[3], r2[1] / r2[3]);
        }
        xs(), ms = new ps(4), ps != Float32Array && (ms[0] = 0, ms[1] = 0, ms[2] = 0, ms[3] = 0), xs(), vs(1, 0, 0), vs(0, 1, 0), ws(), ws(), fs(), function() {
          var t2;
          t2 = new ps(2), ps != Float32Array && (t2[0] = 0, t2[1] = 0);
        }();
        class As extends Ja {
        }
        Mn("HeatmapBucket", As, { omit: ["layers"] });
        var ks = { paint: new fi({ "heatmap-radius": new ui(nt.paint_heatmap["heatmap-radius"]), "heatmap-weight": new ui(nt.paint_heatmap["heatmap-weight"]), "heatmap-intensity": new li(nt.paint_heatmap["heatmap-intensity"]), "heatmap-color": new pi(nt.paint_heatmap["heatmap-color"]), "heatmap-opacity": new li(nt.paint_heatmap["heatmap-opacity"]) }) };
        function Ss(t2, { width: e2, height: r2 }, n2, i2) {
          if (i2) {
            if (i2 instanceof Uint8ClampedArray)
              i2 = new Uint8Array(i2.buffer);
            else if (i2.length !== e2 * r2 * n2)
              throw new RangeError(`mismatched image size. expected: ${i2.length} but got: ${e2 * r2 * n2}`);
          } else
            i2 = new Uint8Array(e2 * r2 * n2);
          return t2.width = e2, t2.height = r2, t2.data = i2, t2;
        }
        function Is(t2, { width: e2, height: r2 }, n2) {
          if (e2 === t2.width && r2 === t2.height)
            return;
          const i2 = Ss({}, { width: e2, height: r2 }, n2);
          Ms(t2, i2, { x: 0, y: 0 }, { x: 0, y: 0 }, { width: Math.min(t2.width, e2), height: Math.min(t2.height, r2) }, n2), t2.width = e2, t2.height = r2, t2.data = i2.data;
        }
        function Ms(t2, e2, r2, n2, i2, a2) {
          if (0 === i2.width || 0 === i2.height)
            return e2;
          if (i2.width > t2.width || i2.height > t2.height || r2.x > t2.width - i2.width || r2.y > t2.height - i2.height)
            throw new RangeError("out of range source coordinates for image copy");
          if (i2.width > e2.width || i2.height > e2.height || n2.x > e2.width - i2.width || n2.y > e2.height - i2.height)
            throw new RangeError("out of range destination coordinates for image copy");
          const s2 = t2.data, o2 = e2.data;
          if (s2 === o2)
            throw new Error("srcData equals dstData, so image is already copied");
          for (let l2 = 0; l2 < i2.height; l2++) {
            const u2 = ((r2.y + l2) * t2.width + r2.x) * a2, c3 = ((n2.y + l2) * e2.width + n2.x) * a2;
            for (let t3 = 0; t3 < i2.width * a2; t3++)
              o2[c3 + t3] = s2[u2 + t3];
          }
          return e2;
        }
        class zs {
          constructor(t2, e2) {
            Ss(this, t2, 1, e2);
          }
          resize(t2) {
            Is(this, t2, 1);
          }
          clone() {
            return new zs({ width: this.width, height: this.height }, new Uint8Array(this.data));
          }
          static copy(t2, e2, r2, n2, i2) {
            Ms(t2, e2, r2, n2, i2, 1);
          }
        }
        class Bs {
          constructor(t2, e2) {
            Ss(this, t2, 4, e2);
          }
          resize(t2) {
            Is(this, t2, 4);
          }
          replace(t2, e2) {
            e2 ? this.data.set(t2) : this.data = t2 instanceof Uint8ClampedArray ? new Uint8Array(t2.buffer) : t2;
          }
          clone() {
            return new Bs({ width: this.width, height: this.height }, new Uint8Array(this.data));
          }
          static copy(t2, e2, r2, n2, i2) {
            Ms(t2, e2, r2, n2, i2, 4);
          }
        }
        function Cs(t2) {
          const e2 = {}, r2 = t2.resolution || 256, n2 = t2.clips ? t2.clips.length : 1, i2 = t2.image || new Bs({ width: r2, height: n2 });
          if (Math.log(r2) / Math.LN2 % 1 != 0)
            throw new Error(`width is not a power of 2 - ${r2}`);
          const a2 = (r3, n3, a3) => {
            e2[t2.evaluationKey] = a3;
            const s2 = t2.expression.evaluate(e2);
            i2.data[r3 + n3 + 0] = Math.floor(255 * s2.r / s2.a), i2.data[r3 + n3 + 1] = Math.floor(255 * s2.g / s2.a), i2.data[r3 + n3 + 2] = Math.floor(255 * s2.b / s2.a), i2.data[r3 + n3 + 3] = Math.floor(255 * s2.a);
          };
          if (t2.clips)
            for (let e3 = 0, i3 = 0; e3 < n2; ++e3, i3 += 4 * r2)
              for (let n3 = 0, s2 = 0; n3 < r2; n3++, s2 += 4) {
                const o2 = n3 / (r2 - 1), { start: l2, end: u2 } = t2.clips[e3];
                a2(i3, s2, l2 * (1 - o2) + u2 * o2);
              }
          else
            for (let t3 = 0, e3 = 0; t3 < r2; t3++, e3 += 4)
              a2(0, e3, t3 / (r2 - 1));
          return i2;
        }
        Mn("AlphaImage", zs), Mn("RGBAImage", Bs);
        var Ps = { paint: new fi({ "hillshade-illumination-direction": new li(nt.paint_hillshade["hillshade-illumination-direction"]), "hillshade-illumination-anchor": new li(nt.paint_hillshade["hillshade-illumination-anchor"]), "hillshade-exaggeration": new li(nt.paint_hillshade["hillshade-exaggeration"]), "hillshade-shadow-color": new li(nt.paint_hillshade["hillshade-shadow-color"]), "hillshade-highlight-color": new li(nt.paint_hillshade["hillshade-highlight-color"]), "hillshade-accent-color": new li(nt.paint_hillshade["hillshade-accent-color"]) }) };
        const Vs = vi([{ name: "a_pos", components: 2, type: "Int16" }], 4), { members: Es } = Vs;
        var Fs = { exports: {} };
        function Ts(t2, e2, r2) {
          r2 = r2 || 2;
          var n2, i2, a2, s2, o2, l2, u2, c3 = e2 && e2.length, h2 = c3 ? e2[0] * r2 : t2.length, p3 = Ls(t2, 0, h2, r2, true), f2 = [];
          if (!p3 || p3.next === p3.prev)
            return f2;
          if (c3 && (p3 = function(t3, e3, r3, n3) {
            var i3, a3, s3, o3 = [];
            for (i3 = 0, a3 = e3.length; i3 < a3; i3++)
              (s3 = Ls(t3, e3[i3] * n3, i3 < a3 - 1 ? e3[i3 + 1] * n3 : t3.length, n3, false)) === s3.next && (s3.steiner = true), o3.push(Gs(s3));
            for (o3.sort(js), i3 = 0; i3 < o3.length; i3++)
              r3 = Ns(o3[i3], r3);
            return r3;
          }(t2, e2, p3, r2)), t2.length > 80 * r2) {
            n2 = a2 = t2[0], i2 = s2 = t2[1];
            for (var d2 = r2; d2 < h2; d2 += r2)
              (o2 = t2[d2]) < n2 && (n2 = o2), (l2 = t2[d2 + 1]) < i2 && (i2 = l2), o2 > a2 && (a2 = o2), l2 > s2 && (s2 = l2);
            u2 = 0 !== (u2 = Math.max(a2 - n2, s2 - i2)) ? 32767 / u2 : 0;
          }
          return $s(p3, f2, r2, n2, i2, u2, 0), f2;
        }
        function Ls(t2, e2, r2, n2, i2) {
          var a2, s2;
          if (i2 === so(t2, e2, r2, n2) > 0)
            for (a2 = e2; a2 < r2; a2 += n2)
              s2 = no(a2, t2[a2], t2[a2 + 1], s2);
          else
            for (a2 = r2 - n2; a2 >= e2; a2 -= n2)
              s2 = no(a2, t2[a2], t2[a2 + 1], s2);
          return s2 && Hs(s2, s2.next) && (io(s2), s2 = s2.next), s2;
        }
        function Ds(t2, e2) {
          if (!t2)
            return t2;
          e2 || (e2 = t2);
          var r2, n2 = t2;
          do {
            if (r2 = false, n2.steiner || !Hs(n2, n2.next) && 0 !== Ys(n2.prev, n2, n2.next))
              n2 = n2.next;
            else {
              if (io(n2), (n2 = e2 = n2.prev) === n2.next)
                break;
              r2 = true;
            }
          } while (r2 || n2 !== e2);
          return e2;
        }
        function $s(t2, e2, r2, n2, i2, a2, s2) {
          if (t2) {
            !s2 && a2 && function(t3, e3, r3, n3) {
              var i3 = t3;
              do {
                0 === i3.z && (i3.z = Ks(i3.x, i3.y, e3, r3, n3)), i3.prevZ = i3.prev, i3.nextZ = i3.next, i3 = i3.next;
              } while (i3 !== t3);
              i3.prevZ.nextZ = null, i3.prevZ = null, function(t4) {
                var e4, r4, n4, i4, a3, s3, o3, l3, u3 = 1;
                do {
                  for (r4 = t4, t4 = null, a3 = null, s3 = 0; r4; ) {
                    for (s3++, n4 = r4, o3 = 0, e4 = 0; e4 < u3 && (o3++, n4 = n4.nextZ); e4++)
                      ;
                    for (l3 = u3; o3 > 0 || l3 > 0 && n4; )
                      0 !== o3 && (0 === l3 || !n4 || r4.z <= n4.z) ? (i4 = r4, r4 = r4.nextZ, o3--) : (i4 = n4, n4 = n4.nextZ, l3--), a3 ? a3.nextZ = i4 : t4 = i4, i4.prevZ = a3, a3 = i4;
                    r4 = n4;
                  }
                  a3.nextZ = null, u3 *= 2;
                } while (s3 > 1);
              }(i3);
            }(t2, n2, i2, a2);
            for (var o2, l2, u2 = t2; t2.prev !== t2.next; )
              if (o2 = t2.prev, l2 = t2.next, a2 ? Os(t2, n2, i2, a2) : Rs(t2))
                e2.push(o2.i / r2 | 0), e2.push(t2.i / r2 | 0), e2.push(l2.i / r2 | 0), io(t2), t2 = l2.next, u2 = l2.next;
              else if ((t2 = l2) === u2) {
                s2 ? 1 === s2 ? $s(t2 = Us(Ds(t2), e2, r2), e2, r2, n2, i2, a2, 2) : 2 === s2 && qs(t2, e2, r2, n2, i2, a2) : $s(Ds(t2), e2, r2, n2, i2, a2, 1);
                break;
              }
          }
        }
        function Rs(t2) {
          var e2 = t2.prev, r2 = t2, n2 = t2.next;
          if (Ys(e2, r2, n2) >= 0)
            return false;
          for (var i2 = e2.x, a2 = r2.x, s2 = n2.x, o2 = e2.y, l2 = r2.y, u2 = n2.y, c3 = i2 < a2 ? i2 < s2 ? i2 : s2 : a2 < s2 ? a2 : s2, h2 = o2 < l2 ? o2 < u2 ? o2 : u2 : l2 < u2 ? l2 : u2, p3 = i2 > a2 ? i2 > s2 ? i2 : s2 : a2 > s2 ? a2 : s2, f2 = o2 > l2 ? o2 > u2 ? o2 : u2 : l2 > u2 ? l2 : u2, d2 = n2.next; d2 !== e2; ) {
            if (d2.x >= c3 && d2.x <= p3 && d2.y >= h2 && d2.y <= f2 && Js(i2, o2, a2, l2, s2, u2, d2.x, d2.y) && Ys(d2.prev, d2, d2.next) >= 0)
              return false;
            d2 = d2.next;
          }
          return true;
        }
        function Os(t2, e2, r2, n2) {
          var i2 = t2.prev, a2 = t2, s2 = t2.next;
          if (Ys(i2, a2, s2) >= 0)
            return false;
          for (var o2 = i2.x, l2 = a2.x, u2 = s2.x, c3 = i2.y, h2 = a2.y, p3 = s2.y, f2 = o2 < l2 ? o2 < u2 ? o2 : u2 : l2 < u2 ? l2 : u2, d2 = c3 < h2 ? c3 < p3 ? c3 : p3 : h2 < p3 ? h2 : p3, y3 = o2 > l2 ? o2 > u2 ? o2 : u2 : l2 > u2 ? l2 : u2, m2 = c3 > h2 ? c3 > p3 ? c3 : p3 : h2 > p3 ? h2 : p3, g2 = Ks(f2, d2, e2, r2, n2), x2 = Ks(y3, m2, e2, r2, n2), v3 = t2.prevZ, b2 = t2.nextZ; v3 && v3.z >= g2 && b2 && b2.z <= x2; ) {
            if (v3.x >= f2 && v3.x <= y3 && v3.y >= d2 && v3.y <= m2 && v3 !== i2 && v3 !== s2 && Js(o2, c3, l2, h2, u2, p3, v3.x, v3.y) && Ys(v3.prev, v3, v3.next) >= 0)
              return false;
            if (v3 = v3.prevZ, b2.x >= f2 && b2.x <= y3 && b2.y >= d2 && b2.y <= m2 && b2 !== i2 && b2 !== s2 && Js(o2, c3, l2, h2, u2, p3, b2.x, b2.y) && Ys(b2.prev, b2, b2.next) >= 0)
              return false;
            b2 = b2.nextZ;
          }
          for (; v3 && v3.z >= g2; ) {
            if (v3.x >= f2 && v3.x <= y3 && v3.y >= d2 && v3.y <= m2 && v3 !== i2 && v3 !== s2 && Js(o2, c3, l2, h2, u2, p3, v3.x, v3.y) && Ys(v3.prev, v3, v3.next) >= 0)
              return false;
            v3 = v3.prevZ;
          }
          for (; b2 && b2.z <= x2; ) {
            if (b2.x >= f2 && b2.x <= y3 && b2.y >= d2 && b2.y <= m2 && b2 !== i2 && b2 !== s2 && Js(o2, c3, l2, h2, u2, p3, b2.x, b2.y) && Ys(b2.prev, b2, b2.next) >= 0)
              return false;
            b2 = b2.nextZ;
          }
          return true;
        }
        function Us(t2, e2, r2) {
          var n2 = t2;
          do {
            var i2 = n2.prev, a2 = n2.next.next;
            !Hs(i2, a2) && Ws(i2, n2, n2.next, a2) && eo(i2, a2) && eo(a2, i2) && (e2.push(i2.i / r2 | 0), e2.push(n2.i / r2 | 0), e2.push(a2.i / r2 | 0), io(n2), io(n2.next), n2 = t2 = a2), n2 = n2.next;
          } while (n2 !== t2);
          return Ds(n2);
        }
        function qs(t2, e2, r2, n2, i2, a2) {
          var s2 = t2;
          do {
            for (var o2 = s2.next.next; o2 !== s2.prev; ) {
              if (s2.i !== o2.i && Xs(s2, o2)) {
                var l2 = ro(s2, o2);
                return s2 = Ds(s2, s2.next), l2 = Ds(l2, l2.next), $s(s2, e2, r2, n2, i2, a2, 0), void $s(l2, e2, r2, n2, i2, a2, 0);
              }
              o2 = o2.next;
            }
            s2 = s2.next;
          } while (s2 !== t2);
        }
        function js(t2, e2) {
          return t2.x - e2.x;
        }
        function Ns(t2, e2) {
          var r2 = function(t3, e3) {
            var r3, n3 = e3, i2 = t3.x, a2 = t3.y, s2 = -1 / 0;
            do {
              if (a2 <= n3.y && a2 >= n3.next.y && n3.next.y !== n3.y) {
                var o2 = n3.x + (a2 - n3.y) * (n3.next.x - n3.x) / (n3.next.y - n3.y);
                if (o2 <= i2 && o2 > s2 && (s2 = o2, r3 = n3.x < n3.next.x ? n3 : n3.next, o2 === i2))
                  return r3;
              }
              n3 = n3.next;
            } while (n3 !== e3);
            if (!r3)
              return null;
            var l2, u2 = r3, c3 = r3.x, h2 = r3.y, p3 = 1 / 0;
            n3 = r3;
            do {
              i2 >= n3.x && n3.x >= c3 && i2 !== n3.x && Js(a2 < h2 ? i2 : s2, a2, c3, h2, a2 < h2 ? s2 : i2, a2, n3.x, n3.y) && (l2 = Math.abs(a2 - n3.y) / (i2 - n3.x), eo(n3, t3) && (l2 < p3 || l2 === p3 && (n3.x > r3.x || n3.x === r3.x && Zs(r3, n3))) && (r3 = n3, p3 = l2)), n3 = n3.next;
            } while (n3 !== u2);
            return r3;
          }(t2, e2);
          if (!r2)
            return e2;
          var n2 = ro(r2, t2);
          return Ds(n2, n2.next), Ds(r2, r2.next);
        }
        function Zs(t2, e2) {
          return Ys(t2.prev, t2, e2.prev) < 0 && Ys(e2.next, t2, t2.next) < 0;
        }
        function Ks(t2, e2, r2, n2, i2) {
          return (t2 = 1431655765 & ((t2 = 858993459 & ((t2 = 252645135 & ((t2 = 16711935 & ((t2 = (t2 - r2) * i2 | 0) | t2 << 8)) | t2 << 4)) | t2 << 2)) | t2 << 1)) | (e2 = 1431655765 & ((e2 = 858993459 & ((e2 = 252645135 & ((e2 = 16711935 & ((e2 = (e2 - n2) * i2 | 0) | e2 << 8)) | e2 << 4)) | e2 << 2)) | e2 << 1)) << 1;
        }
        function Gs(t2) {
          var e2 = t2, r2 = t2;
          do {
            (e2.x < r2.x || e2.x === r2.x && e2.y < r2.y) && (r2 = e2), e2 = e2.next;
          } while (e2 !== t2);
          return r2;
        }
        function Js(t2, e2, r2, n2, i2, a2, s2, o2) {
          return (i2 - s2) * (e2 - o2) >= (t2 - s2) * (a2 - o2) && (t2 - s2) * (n2 - o2) >= (r2 - s2) * (e2 - o2) && (r2 - s2) * (a2 - o2) >= (i2 - s2) * (n2 - o2);
        }
        function Xs(t2, e2) {
          return t2.next.i !== e2.i && t2.prev.i !== e2.i && !function(t3, e3) {
            var r2 = t3;
            do {
              if (r2.i !== t3.i && r2.next.i !== t3.i && r2.i !== e3.i && r2.next.i !== e3.i && Ws(r2, r2.next, t3, e3))
                return true;
              r2 = r2.next;
            } while (r2 !== t3);
            return false;
          }(t2, e2) && (eo(t2, e2) && eo(e2, t2) && function(t3, e3) {
            var r2 = t3, n2 = false, i2 = (t3.x + e3.x) / 2, a2 = (t3.y + e3.y) / 2;
            do {
              r2.y > a2 != r2.next.y > a2 && r2.next.y !== r2.y && i2 < (r2.next.x - r2.x) * (a2 - r2.y) / (r2.next.y - r2.y) + r2.x && (n2 = !n2), r2 = r2.next;
            } while (r2 !== t3);
            return n2;
          }(t2, e2) && (Ys(t2.prev, t2, e2.prev) || Ys(t2, e2.prev, e2)) || Hs(t2, e2) && Ys(t2.prev, t2, t2.next) > 0 && Ys(e2.prev, e2, e2.next) > 0);
        }
        function Ys(t2, e2, r2) {
          return (e2.y - t2.y) * (r2.x - e2.x) - (e2.x - t2.x) * (r2.y - e2.y);
        }
        function Hs(t2, e2) {
          return t2.x === e2.x && t2.y === e2.y;
        }
        function Ws(t2, e2, r2, n2) {
          var i2 = to(Ys(t2, e2, r2)), a2 = to(Ys(t2, e2, n2)), s2 = to(Ys(r2, n2, t2)), o2 = to(Ys(r2, n2, e2));
          return i2 !== a2 && s2 !== o2 || !(0 !== i2 || !Qs(t2, r2, e2)) || !(0 !== a2 || !Qs(t2, n2, e2)) || !(0 !== s2 || !Qs(r2, t2, n2)) || !(0 !== o2 || !Qs(r2, e2, n2));
        }
        function Qs(t2, e2, r2) {
          return e2.x <= Math.max(t2.x, r2.x) && e2.x >= Math.min(t2.x, r2.x) && e2.y <= Math.max(t2.y, r2.y) && e2.y >= Math.min(t2.y, r2.y);
        }
        function to(t2) {
          return t2 > 0 ? 1 : t2 < 0 ? -1 : 0;
        }
        function eo(t2, e2) {
          return Ys(t2.prev, t2, t2.next) < 0 ? Ys(t2, e2, t2.next) >= 0 && Ys(t2, t2.prev, e2) >= 0 : Ys(t2, e2, t2.prev) < 0 || Ys(t2, t2.next, e2) < 0;
        }
        function ro(t2, e2) {
          var r2 = new ao(t2.i, t2.x, t2.y), n2 = new ao(e2.i, e2.x, e2.y), i2 = t2.next, a2 = e2.prev;
          return t2.next = e2, e2.prev = t2, r2.next = i2, i2.prev = r2, n2.next = r2, r2.prev = n2, a2.next = n2, n2.prev = a2, n2;
        }
        function no(t2, e2, r2, n2) {
          var i2 = new ao(t2, e2, r2);
          return n2 ? (i2.next = n2.next, i2.prev = n2, n2.next.prev = i2, n2.next = i2) : (i2.prev = i2, i2.next = i2), i2;
        }
        function io(t2) {
          t2.next.prev = t2.prev, t2.prev.next = t2.next, t2.prevZ && (t2.prevZ.nextZ = t2.nextZ), t2.nextZ && (t2.nextZ.prevZ = t2.prevZ);
        }
        function ao(t2, e2, r2) {
          this.i = t2, this.x = e2, this.y = r2, this.prev = null, this.next = null, this.z = 0, this.prevZ = null, this.nextZ = null, this.steiner = false;
        }
        function so(t2, e2, r2, n2) {
          for (var i2 = 0, a2 = e2, s2 = r2 - n2; a2 < r2; a2 += n2)
            i2 += (t2[s2] - t2[a2]) * (t2[a2 + 1] + t2[s2 + 1]), s2 = a2;
          return i2;
        }
        function oo(t2, e2, r2, n2, i2) {
          lo(t2, e2, r2 || 0, n2 || t2.length - 1, i2 || co);
        }
        function lo(t2, e2, r2, n2, i2) {
          for (; n2 > r2; ) {
            if (n2 - r2 > 600) {
              var a2 = n2 - r2 + 1, s2 = e2 - r2 + 1, o2 = Math.log(a2), l2 = 0.5 * Math.exp(2 * o2 / 3), u2 = 0.5 * Math.sqrt(o2 * l2 * (a2 - l2) / a2) * (s2 - a2 / 2 < 0 ? -1 : 1);
              lo(t2, e2, Math.max(r2, Math.floor(e2 - s2 * l2 / a2 + u2)), Math.min(n2, Math.floor(e2 + (a2 - s2) * l2 / a2 + u2)), i2);
            }
            var c3 = t2[e2], h2 = r2, p3 = n2;
            for (uo(t2, r2, e2), i2(t2[n2], c3) > 0 && uo(t2, r2, n2); h2 < p3; ) {
              for (uo(t2, h2, p3), h2++, p3--; i2(t2[h2], c3) < 0; )
                h2++;
              for (; i2(t2[p3], c3) > 0; )
                p3--;
            }
            0 === i2(t2[r2], c3) ? uo(t2, r2, p3) : uo(t2, ++p3, n2), p3 <= e2 && (r2 = p3 + 1), e2 <= p3 && (n2 = p3 - 1);
          }
        }
        function uo(t2, e2, r2) {
          var n2 = t2[e2];
          t2[e2] = t2[r2], t2[r2] = n2;
        }
        function co(t2, e2) {
          return t2 < e2 ? -1 : t2 > e2 ? 1 : 0;
        }
        function ho(t2, e2) {
          const r2 = t2.length;
          if (r2 <= 1)
            return [t2];
          const n2 = [];
          let i2, a2;
          for (let e3 = 0; e3 < r2; e3++) {
            const r3 = m(t2[e3]);
            0 !== r3 && (t2[e3].area = Math.abs(r3), void 0 === a2 && (a2 = r3 < 0), a2 === r3 < 0 ? (i2 && n2.push(i2), i2 = [t2[e3]]) : i2.push(t2[e3]));
          }
          if (i2 && n2.push(i2), e2 > 1)
            for (let t3 = 0; t3 < n2.length; t3++)
              n2[t3].length <= e2 || (oo(n2[t3], e2, 1, n2[t3].length - 1, po), n2[t3] = n2[t3].slice(0, e2));
          return n2;
        }
        function po(t2, e2) {
          return e2.area - t2.area;
        }
        function fo(t2, e2, r2) {
          const n2 = r2.patternDependencies;
          let i2 = false;
          for (const r3 of e2) {
            const e3 = r3.paint.get(`${t2}-pattern`);
            e3.isConstant() || (i2 = true);
            const a2 = e3.constantOr(null);
            a2 && (i2 = true, n2[a2.to] = true, n2[a2.from] = true);
          }
          return i2;
        }
        function yo(t2, e2, r2, n2, i2) {
          const a2 = i2.patternDependencies;
          for (const s2 of e2) {
            const e3 = s2.paint.get(`${t2}-pattern`).value;
            if ("constant" !== e3.kind) {
              let t3 = e3.evaluate({ zoom: n2 - 1 }, r2, {}, i2.availableImages), o2 = e3.evaluate({ zoom: n2 }, r2, {}, i2.availableImages), l2 = e3.evaluate({ zoom: n2 + 1 }, r2, {}, i2.availableImages);
              t3 = t3 && t3.name ? t3.name : t3, o2 = o2 && o2.name ? o2.name : o2, l2 = l2 && l2.name ? l2.name : l2, a2[t3] = true, a2[o2] = true, a2[l2] = true, r2.patterns[s2.id] = { min: t3, mid: o2, max: l2 };
            }
          }
          return r2;
        }
        Fs.exports = Ts, Fs.exports.default = Ts, Ts.deviation = function(t2, e2, r2, n2) {
          var i2 = e2 && e2.length, a2 = Math.abs(so(t2, 0, i2 ? e2[0] * r2 : t2.length, r2));
          if (i2)
            for (var s2 = 0, o2 = e2.length; s2 < o2; s2++)
              a2 -= Math.abs(so(t2, e2[s2] * r2, s2 < o2 - 1 ? e2[s2 + 1] * r2 : t2.length, r2));
          var l2 = 0;
          for (s2 = 0; s2 < n2.length; s2 += 3) {
            var u2 = n2[s2] * r2, c3 = n2[s2 + 1] * r2, h2 = n2[s2 + 2] * r2;
            l2 += Math.abs((t2[u2] - t2[h2]) * (t2[c3 + 1] - t2[u2 + 1]) - (t2[u2] - t2[c3]) * (t2[h2 + 1] - t2[u2 + 1]));
          }
          return 0 === a2 && 0 === l2 ? 0 : Math.abs((l2 - a2) / a2);
        }, Ts.flatten = function(t2) {
          for (var e2 = t2[0][0].length, r2 = { vertices: [], holes: [], dimensions: e2 }, n2 = 0, i2 = 0; i2 < t2.length; i2++) {
            for (var a2 = 0; a2 < t2[i2].length; a2++)
              for (var s2 = 0; s2 < e2; s2++)
                r2.vertices.push(t2[i2][a2][s2]);
            i2 > 0 && r2.holes.push(n2 += t2[i2 - 1].length);
          }
          return r2;
        };
        class mo {
          constructor(t2) {
            this.zoom = t2.zoom, this.overscaling = t2.overscaling, this.layers = t2.layers, this.layerIds = this.layers.map((t3) => t3.id), this.index = t2.index, this.hasPattern = false, this.patternFeatures = [], this.layoutVertexArray = new ea(), this.indexArray = new ha(), this.indexArray2 = new pa(), this.programConfigurations = new Ra(t2.layers, t2.zoom), this.segments = new ya(), this.segments2 = new ya(), this.stateDependentLayerIds = this.layers.filter((t3) => t3.isStateDependent()).map((t3) => t3.id);
          }
          populate(t2, e2, r2) {
            this.hasPattern = fo("fill", this.layers, e2);
            const n2 = this.layers[0].layout.get("fill-sort-key"), i2 = !n2.isConstant(), a2 = [];
            for (const { feature: s2, id: o2, index: l2, sourceLayerIndex: u2 } of t2) {
              const t3 = this.layers[0]._featureFilter.needGeometry, c3 = Ka(s2, t3);
              if (!this.layers[0]._featureFilter.filter(new Qn(this.zoom), c3, r2))
                continue;
              const h2 = i2 ? n2.evaluate(c3, {}, r2, e2.availableImages) : void 0, p3 = { id: o2, properties: s2.properties, type: s2.type, sourceLayerIndex: u2, index: l2, geometry: t3 ? c3.geometry : Za(s2), patterns: {}, sortKey: h2 };
              a2.push(p3);
            }
            i2 && a2.sort((t3, e3) => t3.sortKey - e3.sortKey);
            for (const n3 of a2) {
              const { geometry: i3, index: a3, sourceLayerIndex: s2 } = n3;
              if (this.hasPattern) {
                const t3 = yo("fill", this.layers, n3, this.zoom, e2);
                this.patternFeatures.push(t3);
              } else
                this.addFeature(n3, i3, a3, r2, {});
              e2.featureIndex.insert(t2[a3].feature, i3, a3, s2, this.index);
            }
          }
          update(t2, e2, r2) {
            this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t2, e2, this.stateDependentLayers, r2);
          }
          addFeatures(t2, e2, r2) {
            for (const t3 of this.patternFeatures)
              this.addFeature(t3, t3.geometry, t3.index, e2, r2);
          }
          isEmpty() {
            return 0 === this.layoutVertexArray.length;
          }
          uploadPending() {
            return !this.uploaded || this.programConfigurations.needsUpload;
          }
          upload(t2) {
            this.uploaded || (this.layoutVertexBuffer = t2.createVertexBuffer(this.layoutVertexArray, Es), this.indexBuffer = t2.createIndexBuffer(this.indexArray), this.indexBuffer2 = t2.createIndexBuffer(this.indexArray2)), this.programConfigurations.upload(t2), this.uploaded = true;
          }
          destroy() {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.indexBuffer2.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.segments2.destroy());
          }
          addFeature(t2, e2, r2, n2, i2) {
            for (const t3 of ho(e2, 500)) {
              let e3 = 0;
              for (const r4 of t3)
                e3 += r4.length;
              const r3 = this.segments.prepareSegment(e3, this.layoutVertexArray, this.indexArray), n3 = r3.vertexLength, i3 = [], a2 = [];
              for (const e4 of t3) {
                if (0 === e4.length)
                  continue;
                e4 !== t3[0] && a2.push(i3.length / 2);
                const r4 = this.segments2.prepareSegment(e4.length, this.layoutVertexArray, this.indexArray2), n4 = r4.vertexLength;
                this.layoutVertexArray.emplaceBack(e4[0].x, e4[0].y), this.indexArray2.emplaceBack(n4 + e4.length - 1, n4), i3.push(e4[0].x), i3.push(e4[0].y);
                for (let t4 = 1; t4 < e4.length; t4++)
                  this.layoutVertexArray.emplaceBack(e4[t4].x, e4[t4].y), this.indexArray2.emplaceBack(n4 + t4 - 1, n4 + t4), i3.push(e4[t4].x), i3.push(e4[t4].y);
                r4.vertexLength += e4.length, r4.primitiveLength += e4.length;
              }
              const s2 = Fs.exports(i3, a2);
              for (let t4 = 0; t4 < s2.length; t4 += 3)
                this.indexArray.emplaceBack(n3 + s2[t4], n3 + s2[t4 + 1], n3 + s2[t4 + 2]);
              r3.vertexLength += e3, r3.primitiveLength += s2.length / 3;
            }
            this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t2, r2, i2, n2);
          }
        }
        Mn("FillBucket", mo, { omit: ["layers", "patternFeatures"] });
        const go = new fi({ "fill-sort-key": new ui(nt.layout_fill["fill-sort-key"]) });
        var xo = { paint: new fi({ "fill-antialias": new li(nt.paint_fill["fill-antialias"]), "fill-opacity": new ui(nt.paint_fill["fill-opacity"]), "fill-color": new ui(nt.paint_fill["fill-color"]), "fill-outline-color": new ui(nt.paint_fill["fill-outline-color"]), "fill-translate": new li(nt.paint_fill["fill-translate"]), "fill-translate-anchor": new li(nt.paint_fill["fill-translate-anchor"]), "fill-pattern": new ci(nt.paint_fill["fill-pattern"]) }), layout: go };
        const vo = vi([{ name: "a_pos", components: 2, type: "Int16" }, { name: "a_normal_ed", components: 4, type: "Int16" }], 4), bo = vi([{ name: "a_centroid", components: 2, type: "Int16" }], 4), { members: wo } = vo;
        var _o = {}, Ao = S, ko = So;
        function So(t2, e2, r2, n2, i2) {
          this.properties = {}, this.extent = r2, this.type = 0, this._pbf = t2, this._geometry = -1, this._keys = n2, this._values = i2, t2.readFields(Io, this, e2);
        }
        function Io(t2, e2, r2) {
          1 == t2 ? e2.id = r2.readVarint() : 2 == t2 ? function(t3, e3) {
            for (var r3 = t3.readVarint() + t3.pos; t3.pos < r3; ) {
              var n2 = e3._keys[t3.readVarint()], i2 = e3._values[t3.readVarint()];
              e3.properties[n2] = i2;
            }
          }(r2, e2) : 3 == t2 ? e2.type = r2.readVarint() : 4 == t2 && (e2._geometry = r2.pos);
        }
        function Mo(t2) {
          for (var e2, r2, n2 = 0, i2 = 0, a2 = t2.length, s2 = a2 - 1; i2 < a2; s2 = i2++)
            n2 += ((r2 = t2[s2]).x - (e2 = t2[i2]).x) * (e2.y + r2.y);
          return n2;
        }
        So.types = ["Unknown", "Point", "LineString", "Polygon"], So.prototype.loadGeometry = function() {
          var t2 = this._pbf;
          t2.pos = this._geometry;
          for (var e2, r2 = t2.readVarint() + t2.pos, n2 = 1, i2 = 0, a2 = 0, s2 = 0, o2 = []; t2.pos < r2; ) {
            if (i2 <= 0) {
              var l2 = t2.readVarint();
              n2 = 7 & l2, i2 = l2 >> 3;
            }
            if (i2--, 1 === n2 || 2 === n2)
              a2 += t2.readSVarint(), s2 += t2.readSVarint(), 1 === n2 && (e2 && o2.push(e2), e2 = []), e2.push(new Ao(a2, s2));
            else {
              if (7 !== n2)
                throw new Error("unknown command " + n2);
              e2 && e2.push(e2[0].clone());
            }
          }
          return e2 && o2.push(e2), o2;
        }, So.prototype.bbox = function() {
          var t2 = this._pbf;
          t2.pos = this._geometry;
          for (var e2 = t2.readVarint() + t2.pos, r2 = 1, n2 = 0, i2 = 0, a2 = 0, s2 = 1 / 0, o2 = -1 / 0, l2 = 1 / 0, u2 = -1 / 0; t2.pos < e2; ) {
            if (n2 <= 0) {
              var c3 = t2.readVarint();
              r2 = 7 & c3, n2 = c3 >> 3;
            }
            if (n2--, 1 === r2 || 2 === r2)
              (i2 += t2.readSVarint()) < s2 && (s2 = i2), i2 > o2 && (o2 = i2), (a2 += t2.readSVarint()) < l2 && (l2 = a2), a2 > u2 && (u2 = a2);
            else if (7 !== r2)
              throw new Error("unknown command " + r2);
          }
          return [s2, l2, o2, u2];
        }, So.prototype.toGeoJSON = function(t2, e2, r2) {
          var n2, i2, a2 = this.extent * Math.pow(2, r2), s2 = this.extent * t2, o2 = this.extent * e2, l2 = this.loadGeometry(), u2 = So.types[this.type];
          function c3(t3) {
            for (var e3 = 0; e3 < t3.length; e3++) {
              var r3 = t3[e3];
              t3[e3] = [360 * (r3.x + s2) / a2 - 180, 360 / Math.PI * Math.atan(Math.exp((180 - 360 * (r3.y + o2) / a2) * Math.PI / 180)) - 90];
            }
          }
          switch (this.type) {
            case 1:
              var h2 = [];
              for (n2 = 0; n2 < l2.length; n2++)
                h2[n2] = l2[n2][0];
              c3(l2 = h2);
              break;
            case 2:
              for (n2 = 0; n2 < l2.length; n2++)
                c3(l2[n2]);
              break;
            case 3:
              for (l2 = function(t3) {
                var e3 = t3.length;
                if (e3 <= 1)
                  return [t3];
                for (var r3, n3, i3 = [], a3 = 0; a3 < e3; a3++) {
                  var s3 = Mo(t3[a3]);
                  0 !== s3 && (void 0 === n3 && (n3 = s3 < 0), n3 === s3 < 0 ? (r3 && i3.push(r3), r3 = [t3[a3]]) : r3.push(t3[a3]));
                }
                return r3 && i3.push(r3), i3;
              }(l2), n2 = 0; n2 < l2.length; n2++)
                for (i2 = 0; i2 < l2[n2].length; i2++)
                  c3(l2[n2][i2]);
          }
          1 === l2.length ? l2 = l2[0] : u2 = "Multi" + u2;
          var p3 = { type: "Feature", geometry: { type: u2, coordinates: l2 }, properties: this.properties };
          return "id" in this && (p3.id = this.id), p3;
        };
        var zo = ko, Bo = Co;
        function Co(t2, e2) {
          this.version = 1, this.name = null, this.extent = 4096, this.length = 0, this._pbf = t2, this._keys = [], this._values = [], this._features = [], t2.readFields(Po, this, e2), this.length = this._features.length;
        }
        function Po(t2, e2, r2) {
          15 === t2 ? e2.version = r2.readVarint() : 1 === t2 ? e2.name = r2.readString() : 5 === t2 ? e2.extent = r2.readVarint() : 2 === t2 ? e2._features.push(r2.pos) : 3 === t2 ? e2._keys.push(r2.readString()) : 4 === t2 && e2._values.push(function(t3) {
            for (var e3 = null, r3 = t3.readVarint() + t3.pos; t3.pos < r3; ) {
              var n2 = t3.readVarint() >> 3;
              e3 = 1 === n2 ? t3.readString() : 2 === n2 ? t3.readFloat() : 3 === n2 ? t3.readDouble() : 4 === n2 ? t3.readVarint64() : 5 === n2 ? t3.readVarint() : 6 === n2 ? t3.readSVarint() : 7 === n2 ? t3.readBoolean() : null;
            }
            return e3;
          }(r2));
        }
        Co.prototype.feature = function(t2) {
          if (t2 < 0 || t2 >= this._features.length)
            throw new Error("feature index out of bounds");
          this._pbf.pos = this._features[t2];
          var e2 = this._pbf.readVarint() + this._pbf.pos;
          return new zo(this._pbf, e2, this.extent, this._keys, this._values);
        };
        var Vo = Bo;
        function Eo(t2, e2, r2) {
          if (3 === t2) {
            var n2 = new Vo(r2, r2.readVarint() + r2.pos);
            n2.length && (e2[n2.name] = n2);
          }
        }
        _o.VectorTile = function(t2, e2) {
          this.layers = t2.readFields(Eo, {}, e2);
        }, _o.VectorTileFeature = ko, _o.VectorTileLayer = Bo;
        const Fo = _o.VectorTileFeature.types, To = Math.pow(2, 13);
        function Lo(t2, e2, r2, n2, i2, a2, s2, o2) {
          t2.emplaceBack(e2, r2, 2 * Math.floor(n2 * To) + s2, i2 * To * 2, a2 * To * 2, Math.round(o2));
        }
        class Do {
          constructor(t2) {
            this.zoom = t2.zoom, this.overscaling = t2.overscaling, this.layers = t2.layers, this.layerIds = this.layers.map((t3) => t3.id), this.index = t2.index, this.hasPattern = false, this.layoutVertexArray = new ra(), this.centroidVertexArray = new Qi(), this.indexArray = new ha(), this.programConfigurations = new Ra(t2.layers, t2.zoom), this.segments = new ya(), this.stateDependentLayerIds = this.layers.filter((t3) => t3.isStateDependent()).map((t3) => t3.id);
          }
          populate(t2, e2, r2) {
            this.features = [], this.hasPattern = fo("fill-extrusion", this.layers, e2);
            for (const { feature: n2, id: i2, index: a2, sourceLayerIndex: s2 } of t2) {
              const t3 = this.layers[0]._featureFilter.needGeometry, o2 = Ka(n2, t3);
              if (!this.layers[0]._featureFilter.filter(new Qn(this.zoom), o2, r2))
                continue;
              const l2 = { id: i2, sourceLayerIndex: s2, index: a2, geometry: t3 ? o2.geometry : Za(n2), properties: n2.properties, type: n2.type, patterns: {} };
              this.hasPattern ? this.features.push(yo("fill-extrusion", this.layers, l2, this.zoom, e2)) : this.addFeature(l2, l2.geometry, a2, r2, {}), e2.featureIndex.insert(n2, l2.geometry, a2, s2, this.index, true);
            }
          }
          addFeatures(t2, e2, r2) {
            for (const t3 of this.features) {
              const { geometry: n2 } = t3;
              this.addFeature(t3, n2, t3.index, e2, r2);
            }
          }
          update(t2, e2, r2) {
            this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t2, e2, this.stateDependentLayers, r2);
          }
          isEmpty() {
            return 0 === this.layoutVertexArray.length && 0 === this.centroidVertexArray.length;
          }
          uploadPending() {
            return !this.uploaded || this.programConfigurations.needsUpload;
          }
          upload(t2) {
            this.uploaded || (this.layoutVertexBuffer = t2.createVertexBuffer(this.layoutVertexArray, wo), this.centroidVertexBuffer = t2.createVertexBuffer(this.centroidVertexArray, bo.members, true), this.indexBuffer = t2.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t2), this.uploaded = true;
          }
          destroy() {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.centroidVertexBuffer.destroy());
          }
          addFeature(t2, e2, r2, n2, i2) {
            const a2 = { x: 0, y: 0, vertexCount: 0 };
            for (const r3 of ho(e2, 500)) {
              let e3 = 0;
              for (const t3 of r3)
                e3 += t3.length;
              let n3 = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray);
              for (const t3 of r3) {
                if (0 === t3.length)
                  continue;
                if (Ro(t3))
                  continue;
                let e4 = 0;
                for (let r4 = 0; r4 < t3.length; r4++) {
                  const i4 = t3[r4];
                  if (r4 >= 1) {
                    const s3 = t3[r4 - 1];
                    if (!$o(i4, s3)) {
                      n3.vertexLength + 4 > ya.MAX_VERTEX_ARRAY_LENGTH && (n3 = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray));
                      const t4 = i4.sub(s3)._perp()._unit(), r5 = s3.dist(i4);
                      e4 + r5 > 32768 && (e4 = 0), Lo(this.layoutVertexArray, i4.x, i4.y, t4.x, t4.y, 0, 0, e4), Lo(this.layoutVertexArray, i4.x, i4.y, t4.x, t4.y, 0, 1, e4), a2.x += 2 * i4.x, a2.y += 2 * i4.y, a2.vertexCount += 2, e4 += r5, Lo(this.layoutVertexArray, s3.x, s3.y, t4.x, t4.y, 0, 0, e4), Lo(this.layoutVertexArray, s3.x, s3.y, t4.x, t4.y, 0, 1, e4), a2.x += 2 * s3.x, a2.y += 2 * s3.y, a2.vertexCount += 2;
                      const o3 = n3.vertexLength;
                      this.indexArray.emplaceBack(o3, o3 + 2, o3 + 1), this.indexArray.emplaceBack(o3 + 1, o3 + 2, o3 + 3), n3.vertexLength += 4, n3.primitiveLength += 2;
                    }
                  }
                }
              }
              if (n3.vertexLength + e3 > ya.MAX_VERTEX_ARRAY_LENGTH && (n3 = this.segments.prepareSegment(e3, this.layoutVertexArray, this.indexArray)), "Polygon" !== Fo[t2.type])
                continue;
              const i3 = [], s2 = [], o2 = n3.vertexLength;
              for (const t3 of r3)
                if (0 !== t3.length) {
                  t3 !== r3[0] && s2.push(i3.length / 2);
                  for (let e4 = 0; e4 < t3.length; e4++) {
                    const r4 = t3[e4];
                    Lo(this.layoutVertexArray, r4.x, r4.y, 0, 0, 1, 1, 0), a2.x += r4.x, a2.y += r4.y, a2.vertexCount += 1, i3.push(r4.x), i3.push(r4.y);
                  }
                }
              const l2 = Fs.exports(i3, s2);
              for (let t3 = 0; t3 < l2.length; t3 += 3)
                this.indexArray.emplaceBack(o2 + l2[t3], o2 + l2[t3 + 2], o2 + l2[t3 + 1]);
              n3.primitiveLength += l2.length / 3, n3.vertexLength += e3;
            }
            for (let t3 = 0; t3 < a2.vertexCount; t3++)
              this.centroidVertexArray.emplaceBack(Math.floor(a2.x / a2.vertexCount), Math.floor(a2.y / a2.vertexCount));
            this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t2, r2, i2, n2);
          }
        }
        function $o(t2, e2) {
          return t2.x === e2.x && (t2.x < 0 || t2.x > qa) || t2.y === e2.y && (t2.y < 0 || t2.y > qa);
        }
        function Ro(t2) {
          return t2.every((t3) => t3.x < 0) || t2.every((t3) => t3.x > qa) || t2.every((t3) => t3.y < 0) || t2.every((t3) => t3.y > qa);
        }
        Mn("FillExtrusionBucket", Do, { omit: ["layers", "features"] });
        var Oo = { paint: new fi({ "fill-extrusion-opacity": new li(nt["paint_fill-extrusion"]["fill-extrusion-opacity"]), "fill-extrusion-color": new ui(nt["paint_fill-extrusion"]["fill-extrusion-color"]), "fill-extrusion-translate": new li(nt["paint_fill-extrusion"]["fill-extrusion-translate"]), "fill-extrusion-translate-anchor": new li(nt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]), "fill-extrusion-pattern": new ci(nt["paint_fill-extrusion"]["fill-extrusion-pattern"]), "fill-extrusion-height": new ui(nt["paint_fill-extrusion"]["fill-extrusion-height"]), "fill-extrusion-base": new ui(nt["paint_fill-extrusion"]["fill-extrusion-base"]), "fill-extrusion-vertical-gradient": new li(nt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]) }) };
        function Uo(t2, e2) {
          return t2.x * e2.x + t2.y * e2.y;
        }
        function qo(t2, e2) {
          if (1 === t2.length) {
            let r2 = 0;
            const n2 = e2[r2++];
            let i2;
            for (; !i2 || n2.equals(i2); )
              if (i2 = e2[r2++], !i2)
                return 1 / 0;
            for (; r2 < e2.length; r2++) {
              const a2 = e2[r2], s2 = t2[0], o2 = i2.sub(n2), l2 = a2.sub(n2), u2 = s2.sub(n2), c3 = Uo(o2, o2), h2 = Uo(o2, l2), p3 = Uo(l2, l2), f2 = Uo(u2, o2), d2 = Uo(u2, l2), y3 = c3 * p3 - h2 * h2, m2 = (p3 * f2 - h2 * d2) / y3, g2 = (c3 * d2 - h2 * f2) / y3, x2 = n2.z * (1 - m2 - g2) + i2.z * m2 + a2.z * g2;
              if (isFinite(x2))
                return x2;
            }
            return 1 / 0;
          }
          {
            let t3 = 1 / 0;
            for (const r2 of e2)
              t3 = Math.min(t3, r2.z);
            return t3;
          }
        }
        const jo = vi([{ name: "a_pos_normal", components: 2, type: "Int16" }, { name: "a_data", components: 4, type: "Uint8" }], 4), { members: No } = jo, Zo = vi([{ name: "a_uv_x", components: 1, type: "Float32" }, { name: "a_split_index", components: 1, type: "Float32" }]), { members: Ko } = Zo, Go = _o.VectorTileFeature.types, Jo = Math.cos(Math.PI / 180 * 37.5), Xo = Math.pow(2, 14) / 0.5;
        class Yo {
          constructor(t2) {
            this.zoom = t2.zoom, this.overscaling = t2.overscaling, this.layers = t2.layers, this.layerIds = this.layers.map((t3) => t3.id), this.index = t2.index, this.hasPattern = false, this.patternFeatures = [], this.lineClipsArray = [], this.gradients = {}, this.layers.forEach((t3) => {
              this.gradients[t3.id] = {};
            }), this.layoutVertexArray = new na(), this.layoutVertexArray2 = new ia(), this.indexArray = new ha(), this.programConfigurations = new Ra(t2.layers, t2.zoom), this.segments = new ya(), this.maxLineLength = 0, this.stateDependentLayerIds = this.layers.filter((t3) => t3.isStateDependent()).map((t3) => t3.id);
          }
          populate(t2, e2, r2) {
            this.hasPattern = fo("line", this.layers, e2);
            const n2 = this.layers[0].layout.get("line-sort-key"), i2 = !n2.isConstant(), a2 = [];
            for (const { feature: e3, id: s2, index: o2, sourceLayerIndex: l2 } of t2) {
              const t3 = this.layers[0]._featureFilter.needGeometry, u2 = Ka(e3, t3);
              if (!this.layers[0]._featureFilter.filter(new Qn(this.zoom), u2, r2))
                continue;
              const c3 = i2 ? n2.evaluate(u2, {}, r2) : void 0, h2 = { id: s2, properties: e3.properties, type: e3.type, sourceLayerIndex: l2, index: o2, geometry: t3 ? u2.geometry : Za(e3), patterns: {}, sortKey: c3 };
              a2.push(h2);
            }
            i2 && a2.sort((t3, e3) => t3.sortKey - e3.sortKey);
            for (const n3 of a2) {
              const { geometry: i3, index: a3, sourceLayerIndex: s2 } = n3;
              if (this.hasPattern) {
                const t3 = yo("line", this.layers, n3, this.zoom, e2);
                this.patternFeatures.push(t3);
              } else
                this.addFeature(n3, i3, a3, r2, {});
              e2.featureIndex.insert(t2[a3].feature, i3, a3, s2, this.index);
            }
          }
          update(t2, e2, r2) {
            this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t2, e2, this.stateDependentLayers, r2);
          }
          addFeatures(t2, e2, r2) {
            for (const t3 of this.patternFeatures)
              this.addFeature(t3, t3.geometry, t3.index, e2, r2);
          }
          isEmpty() {
            return 0 === this.layoutVertexArray.length;
          }
          uploadPending() {
            return !this.uploaded || this.programConfigurations.needsUpload;
          }
          upload(t2) {
            this.uploaded || (0 !== this.layoutVertexArray2.length && (this.layoutVertexBuffer2 = t2.createVertexBuffer(this.layoutVertexArray2, Ko)), this.layoutVertexBuffer = t2.createVertexBuffer(this.layoutVertexArray, No), this.indexBuffer = t2.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t2), this.uploaded = true;
          }
          destroy() {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
          }
          lineFeatureClips(t2) {
            if (t2.properties && Object.prototype.hasOwnProperty.call(t2.properties, "mapbox_clip_start") && Object.prototype.hasOwnProperty.call(t2.properties, "mapbox_clip_end"))
              return { start: +t2.properties.mapbox_clip_start, end: +t2.properties.mapbox_clip_end };
          }
          addFeature(t2, e2, r2, n2, i2) {
            const a2 = this.layers[0].layout, s2 = a2.get("line-join").evaluate(t2, {}), o2 = a2.get("line-cap"), l2 = a2.get("line-miter-limit"), u2 = a2.get("line-round-limit");
            this.lineClips = this.lineFeatureClips(t2);
            for (const r3 of e2)
              this.addLine(r3, t2, s2, o2, l2, u2);
            this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t2, r2, i2, n2);
          }
          addLine(t2, e2, r2, n2, i2, a2) {
            if (this.distance = 0, this.scaledDistance = 0, this.totalDistance = 0, this.lineClips) {
              this.lineClipsArray.push(this.lineClips);
              for (let e3 = 0; e3 < t2.length - 1; e3++)
                this.totalDistance += t2[e3].dist(t2[e3 + 1]);
              this.updateScaledDistance(), this.maxLineLength = Math.max(this.maxLineLength, this.totalDistance);
            }
            const s2 = "Polygon" === Go[e2.type];
            let o2 = t2.length;
            for (; o2 >= 2 && t2[o2 - 1].equals(t2[o2 - 2]); )
              o2--;
            let l2 = 0;
            for (; l2 < o2 - 1 && t2[l2].equals(t2[l2 + 1]); )
              l2++;
            if (o2 < (s2 ? 3 : 2))
              return;
            "bevel" === r2 && (i2 = 1.05);
            const u2 = this.overscaling <= 16 ? 122880 / (512 * this.overscaling) : 0, c3 = this.segments.prepareSegment(10 * o2, this.layoutVertexArray, this.indexArray);
            let h2, p3, f2, d2, y3;
            this.e1 = this.e2 = -1, s2 && (h2 = t2[o2 - 2], y3 = t2[l2].sub(h2)._unit()._perp());
            for (let e3 = l2; e3 < o2; e3++) {
              if (f2 = e3 === o2 - 1 ? s2 ? t2[l2 + 1] : void 0 : t2[e3 + 1], f2 && t2[e3].equals(f2))
                continue;
              y3 && (d2 = y3), h2 && (p3 = h2), h2 = t2[e3], y3 = f2 ? f2.sub(h2)._unit()._perp() : d2, d2 = d2 || y3;
              let m2 = d2.add(y3);
              0 === m2.x && 0 === m2.y || m2._unit();
              const g2 = d2.x * y3.x + d2.y * y3.y, x2 = m2.x * y3.x + m2.y * y3.y, v3 = 0 !== x2 ? 1 / x2 : 1 / 0, b2 = 2 * Math.sqrt(2 - 2 * x2), w2 = x2 < Jo && p3 && f2, _2 = d2.x * y3.y - d2.y * y3.x > 0;
              if (w2 && e3 > l2) {
                const t3 = h2.dist(p3);
                if (t3 > 2 * u2) {
                  const e4 = h2.sub(h2.sub(p3)._mult(u2 / t3)._round());
                  this.updateDistance(p3, e4), this.addCurrentVertex(e4, d2, 0, 0, c3), p3 = e4;
                }
              }
              const A3 = p3 && f2;
              let k2 = A3 ? r2 : s2 ? "butt" : n2;
              if (A3 && "round" === k2 && (v3 < a2 ? k2 = "miter" : v3 <= 2 && (k2 = "fakeround")), "miter" === k2 && v3 > i2 && (k2 = "bevel"), "bevel" === k2 && (v3 > 2 && (k2 = "flipbevel"), v3 < i2 && (k2 = "miter")), p3 && this.updateDistance(p3, h2), "miter" === k2)
                m2._mult(v3), this.addCurrentVertex(h2, m2, 0, 0, c3);
              else if ("flipbevel" === k2) {
                if (v3 > 100)
                  m2 = y3.mult(-1);
                else {
                  const t3 = v3 * d2.add(y3).mag() / d2.sub(y3).mag();
                  m2._perp()._mult(t3 * (_2 ? -1 : 1));
                }
                this.addCurrentVertex(h2, m2, 0, 0, c3), this.addCurrentVertex(h2, m2.mult(-1), 0, 0, c3);
              } else if ("bevel" === k2 || "fakeround" === k2) {
                const t3 = -Math.sqrt(v3 * v3 - 1), e4 = _2 ? t3 : 0, r3 = _2 ? 0 : t3;
                if (p3 && this.addCurrentVertex(h2, d2, e4, r3, c3), "fakeround" === k2) {
                  const t4 = Math.round(180 * b2 / Math.PI / 20);
                  for (let e5 = 1; e5 < t4; e5++) {
                    let r4 = e5 / t4;
                    if (0.5 !== r4) {
                      const t5 = r4 - 0.5;
                      r4 += r4 * t5 * (r4 - 1) * ((1.0904 + g2 * (g2 * (3.55645 - 1.43519 * g2) - 3.2452)) * t5 * t5 + (0.848013 + g2 * (0.215638 * g2 - 1.06021)));
                    }
                    const n3 = y3.sub(d2)._mult(r4)._add(d2)._unit()._mult(_2 ? -1 : 1);
                    this.addHalfVertex(h2, n3.x, n3.y, false, _2, 0, c3);
                  }
                }
                f2 && this.addCurrentVertex(h2, y3, -e4, -r3, c3);
              } else if ("butt" === k2)
                this.addCurrentVertex(h2, m2, 0, 0, c3);
              else if ("square" === k2) {
                const t3 = p3 ? 1 : -1;
                this.addCurrentVertex(h2, m2, t3, t3, c3);
              } else
                "round" === k2 && (p3 && (this.addCurrentVertex(h2, d2, 0, 0, c3), this.addCurrentVertex(h2, d2, 1, 1, c3, true)), f2 && (this.addCurrentVertex(h2, y3, -1, -1, c3, true), this.addCurrentVertex(h2, y3, 0, 0, c3)));
              if (w2 && e3 < o2 - 1) {
                const t3 = h2.dist(f2);
                if (t3 > 2 * u2) {
                  const e4 = h2.add(f2.sub(h2)._mult(u2 / t3)._round());
                  this.updateDistance(h2, e4), this.addCurrentVertex(e4, y3, 0, 0, c3), h2 = e4;
                }
              }
            }
          }
          addCurrentVertex(t2, e2, r2, n2, i2, a2 = false) {
            const s2 = e2.y * n2 - e2.x, o2 = -e2.y - e2.x * n2;
            this.addHalfVertex(t2, e2.x + e2.y * r2, e2.y - e2.x * r2, a2, false, r2, i2), this.addHalfVertex(t2, s2, o2, a2, true, -n2, i2), this.distance > Xo / 2 && 0 === this.totalDistance && (this.distance = 0, this.addCurrentVertex(t2, e2, r2, n2, i2, a2));
          }
          addHalfVertex({ x: t2, y: e2 }, r2, n2, i2, a2, s2, o2) {
            const l2 = 0.5 * (this.lineClips ? this.scaledDistance * (Xo - 1) : this.scaledDistance);
            this.layoutVertexArray.emplaceBack((t2 << 1) + (i2 ? 1 : 0), (e2 << 1) + (a2 ? 1 : 0), Math.round(63 * r2) + 128, Math.round(63 * n2) + 128, 1 + (0 === s2 ? 0 : s2 < 0 ? -1 : 1) | (63 & l2) << 2, l2 >> 6), this.lineClips && this.layoutVertexArray2.emplaceBack((this.scaledDistance - this.lineClips.start) / (this.lineClips.end - this.lineClips.start), this.lineClipsArray.length);
            const u2 = o2.vertexLength++;
            this.e1 >= 0 && this.e2 >= 0 && (this.indexArray.emplaceBack(this.e1, this.e2, u2), o2.primitiveLength++), a2 ? this.e2 = u2 : this.e1 = u2;
          }
          updateScaledDistance() {
            this.scaledDistance = this.lineClips ? this.lineClips.start + (this.lineClips.end - this.lineClips.start) * this.distance / this.totalDistance : this.distance;
          }
          updateDistance(t2, e2) {
            this.distance += t2.dist(e2), this.updateScaledDistance();
          }
        }
        Mn("LineBucket", Yo, { omit: ["layers", "patternFeatures"] });
        const Ho = new fi({ "line-cap": new li(nt.layout_line["line-cap"]), "line-join": new ui(nt.layout_line["line-join"]), "line-miter-limit": new li(nt.layout_line["line-miter-limit"]), "line-round-limit": new li(nt.layout_line["line-round-limit"]), "line-sort-key": new ui(nt.layout_line["line-sort-key"]) });
        var Wo = { paint: new fi({ "line-opacity": new ui(nt.paint_line["line-opacity"]), "line-color": new ui(nt.paint_line["line-color"]), "line-translate": new li(nt.paint_line["line-translate"]), "line-translate-anchor": new li(nt.paint_line["line-translate-anchor"]), "line-width": new ui(nt.paint_line["line-width"]), "line-gap-width": new ui(nt.paint_line["line-gap-width"]), "line-offset": new ui(nt.paint_line["line-offset"]), "line-blur": new ui(nt.paint_line["line-blur"]), "line-dasharray": new hi(nt.paint_line["line-dasharray"]), "line-pattern": new ci(nt.paint_line["line-pattern"]), "line-gradient": new pi(nt.paint_line["line-gradient"]) }), layout: Ho };
        const Qo = new class extends ui {
          possiblyEvaluate(t2, e2) {
            return e2 = new Qn(Math.floor(e2.zoom), { now: e2.now, fadeDuration: e2.fadeDuration, zoomHistory: e2.zoomHistory, transition: e2.transition }), super.possiblyEvaluate(t2, e2);
          }
          evaluate(t2, e2, r2, n2) {
            return e2 = o({}, e2, { zoom: Math.floor(e2.zoom) }), super.evaluate(t2, e2, r2, n2);
          }
        }(Wo.paint.properties["line-width"].specification);
        function tl(t2, e2) {
          return e2 > 0 ? e2 + 2 * t2 : t2;
        }
        Qo.useIntegerZoom = true;
        const el = vi([{ name: "a_pos_offset", components: 4, type: "Int16" }, { name: "a_data", components: 4, type: "Uint16" }, { name: "a_pixeloffset", components: 4, type: "Int16" }], 4), rl = vi([{ name: "a_projected_pos", components: 3, type: "Float32" }], 4);
        vi([{ name: "a_fade_opacity", components: 1, type: "Uint32" }], 4);
        const nl = vi([{ name: "a_placed", components: 2, type: "Uint8" }, { name: "a_shift", components: 2, type: "Float32" }]);
        vi([{ type: "Int16", name: "anchorPointX" }, { type: "Int16", name: "anchorPointY" }, { type: "Int16", name: "x1" }, { type: "Int16", name: "y1" }, { type: "Int16", name: "x2" }, { type: "Int16", name: "y2" }, { type: "Uint32", name: "featureIndex" }, { type: "Uint16", name: "sourceLayerIndex" }, { type: "Uint16", name: "bucketIndex" }]);
        const il = vi([{ name: "a_pos", components: 2, type: "Int16" }, { name: "a_anchor_pos", components: 2, type: "Int16" }, { name: "a_extrude", components: 2, type: "Int16" }], 4), al = vi([{ name: "a_pos", components: 2, type: "Float32" }, { name: "a_radius", components: 1, type: "Float32" }, { name: "a_flags", components: 2, type: "Int16" }], 4);
        function sl(t2, e2, r2) {
          return t2.sections.forEach((t3) => {
            t3.text = function(t4, e3, r3) {
              const n2 = e3.layout.get("text-transform").evaluate(r3, {});
              return "uppercase" === n2 ? t4 = t4.toLocaleUpperCase() : "lowercase" === n2 && (t4 = t4.toLocaleLowerCase()), Wn.applyArabicShaping && (t4 = Wn.applyArabicShaping(t4)), t4;
            }(t3.text, e2, r2);
          }), t2;
        }
        vi([{ name: "triangle", components: 3, type: "Uint16" }]), vi([{ type: "Int16", name: "anchorX" }, { type: "Int16", name: "anchorY" }, { type: "Uint16", name: "glyphStartIndex" }, { type: "Uint16", name: "numGlyphs" }, { type: "Uint32", name: "vertexStartIndex" }, { type: "Uint32", name: "lineStartIndex" }, { type: "Uint32", name: "lineLength" }, { type: "Uint16", name: "segment" }, { type: "Uint16", name: "lowerSize" }, { type: "Uint16", name: "upperSize" }, { type: "Float32", name: "lineOffsetX" }, { type: "Float32", name: "lineOffsetY" }, { type: "Uint8", name: "writingMode" }, { type: "Uint8", name: "placedOrientation" }, { type: "Uint8", name: "hidden" }, { type: "Uint32", name: "crossTileID" }, { type: "Int16", name: "associatedIconIndex" }]), vi([{ type: "Int16", name: "anchorX" }, { type: "Int16", name: "anchorY" }, { type: "Int16", name: "rightJustifiedTextSymbolIndex" }, { type: "Int16", name: "centerJustifiedTextSymbolIndex" }, { type: "Int16", name: "leftJustifiedTextSymbolIndex" }, { type: "Int16", name: "verticalPlacedTextSymbolIndex" }, { type: "Int16", name: "placedIconSymbolIndex" }, { type: "Int16", name: "verticalPlacedIconSymbolIndex" }, { type: "Uint16", name: "key" }, { type: "Uint16", name: "textBoxStartIndex" }, { type: "Uint16", name: "textBoxEndIndex" }, { type: "Uint16", name: "verticalTextBoxStartIndex" }, { type: "Uint16", name: "verticalTextBoxEndIndex" }, { type: "Uint16", name: "iconBoxStartIndex" }, { type: "Uint16", name: "iconBoxEndIndex" }, { type: "Uint16", name: "verticalIconBoxStartIndex" }, { type: "Uint16", name: "verticalIconBoxEndIndex" }, { type: "Uint16", name: "featureIndex" }, { type: "Uint16", name: "numHorizontalGlyphVertices" }, { type: "Uint16", name: "numVerticalGlyphVertices" }, { type: "Uint16", name: "numIconVertices" }, { type: "Uint16", name: "numVerticalIconVertices" }, { type: "Uint16", name: "useRuntimeCollisionCircles" }, { type: "Uint32", name: "crossTileID" }, { type: "Float32", name: "textBoxScale" }, { type: "Float32", components: 2, name: "textOffset" }, { type: "Float32", name: "collisionCircleDiameter" }]), vi([{ type: "Float32", name: "offsetX" }]), vi([{ type: "Int16", name: "x" }, { type: "Int16", name: "y" }, { type: "Int16", name: "tileUnitDistanceFromAnchor" }]);
        const ol2 = { "!": "\uFE15", "#": "\uFF03", $: "\uFF04", "%": "\uFF05", "&": "\uFF06", "(": "\uFE35", ")": "\uFE36", "*": "\uFF0A", "+": "\uFF0B", ",": "\uFE10", "-": "\uFE32", ".": "\u30FB", "/": "\uFF0F", ":": "\uFE13", ";": "\uFE14", "<": "\uFE3F", "=": "\uFF1D", ">": "\uFE40", "?": "\uFE16", "@": "\uFF20", "[": "\uFE47", "\\": "\uFF3C", "]": "\uFE48", "^": "\uFF3E", _: "\uFE33", "`": "\uFF40", "{": "\uFE37", "|": "\u2015", "}": "\uFE38", "~": "\uFF5E", "\xA2": "\uFFE0", "\xA3": "\uFFE1", "\xA5": "\uFFE5", "\xA6": "\uFFE4", "\xAC": "\uFFE2", "\xAF": "\uFFE3", "\u2013": "\uFE32", "\u2014": "\uFE31", "\u2018": "\uFE43", "\u2019": "\uFE44", "\u201C": "\uFE41", "\u201D": "\uFE42", "\u2026": "\uFE19", "\u2027": "\u30FB", "\u20A9": "\uFFE6", "\u3001": "\uFE11", "\u3002": "\uFE12", "\u3008": "\uFE3F", "\u3009": "\uFE40", "\u300A": "\uFE3D", "\u300B": "\uFE3E", "\u300C": "\uFE41", "\u300D": "\uFE42", "\u300E": "\uFE43", "\u300F": "\uFE44", "\u3010": "\uFE3B", "\u3011": "\uFE3C", "\u3014": "\uFE39", "\u3015": "\uFE3A", "\u3016": "\uFE17", "\u3017": "\uFE18", "\uFF01": "\uFE15", "\uFF08": "\uFE35", "\uFF09": "\uFE36", "\uFF0C": "\uFE10", "\uFF0D": "\uFE32", "\uFF0E": "\u30FB", "\uFF1A": "\uFE13", "\uFF1B": "\uFE14", "\uFF1C": "\uFE3F", "\uFF1E": "\uFE40", "\uFF1F": "\uFE16", "\uFF3B": "\uFE47", "\uFF3D": "\uFE48", "\uFF3F": "\uFE33", "\uFF5B": "\uFE37", "\uFF5C": "\u2015", "\uFF5D": "\uFE38", "\uFF5F": "\uFE35", "\uFF60": "\uFE36", "\uFF61": "\uFE12", "\uFF62": "\uFE41", "\uFF63": "\uFE42" };
        var ll = 24, ul = pl, cl = function(t2, e2, r2, n2, i2) {
          var a2, s2, o2 = 8 * i2 - n2 - 1, l2 = (1 << o2) - 1, u2 = l2 >> 1, c3 = -7, h2 = r2 ? i2 - 1 : 0, p3 = r2 ? -1 : 1, f2 = t2[e2 + h2];
          for (h2 += p3, a2 = f2 & (1 << -c3) - 1, f2 >>= -c3, c3 += o2; c3 > 0; a2 = 256 * a2 + t2[e2 + h2], h2 += p3, c3 -= 8)
            ;
          for (s2 = a2 & (1 << -c3) - 1, a2 >>= -c3, c3 += n2; c3 > 0; s2 = 256 * s2 + t2[e2 + h2], h2 += p3, c3 -= 8)
            ;
          if (0 === a2)
            a2 = 1 - u2;
          else {
            if (a2 === l2)
              return s2 ? NaN : 1 / 0 * (f2 ? -1 : 1);
            s2 += Math.pow(2, n2), a2 -= u2;
          }
          return (f2 ? -1 : 1) * s2 * Math.pow(2, a2 - n2);
        }, hl = function(t2, e2, r2, n2, i2, a2) {
          var s2, o2, l2, u2 = 8 * a2 - i2 - 1, c3 = (1 << u2) - 1, h2 = c3 >> 1, p3 = 23 === i2 ? Math.pow(2, -24) - Math.pow(2, -77) : 0, f2 = n2 ? 0 : a2 - 1, d2 = n2 ? 1 : -1, y3 = e2 < 0 || 0 === e2 && 1 / e2 < 0 ? 1 : 0;
          for (e2 = Math.abs(e2), isNaN(e2) || e2 === 1 / 0 ? (o2 = isNaN(e2) ? 1 : 0, s2 = c3) : (s2 = Math.floor(Math.log(e2) / Math.LN2), e2 * (l2 = Math.pow(2, -s2)) < 1 && (s2--, l2 *= 2), (e2 += s2 + h2 >= 1 ? p3 / l2 : p3 * Math.pow(2, 1 - h2)) * l2 >= 2 && (s2++, l2 /= 2), s2 + h2 >= c3 ? (o2 = 0, s2 = c3) : s2 + h2 >= 1 ? (o2 = (e2 * l2 - 1) * Math.pow(2, i2), s2 += h2) : (o2 = e2 * Math.pow(2, h2 - 1) * Math.pow(2, i2), s2 = 0)); i2 >= 8; t2[r2 + f2] = 255 & o2, f2 += d2, o2 /= 256, i2 -= 8)
            ;
          for (s2 = s2 << i2 | o2, u2 += i2; u2 > 0; t2[r2 + f2] = 255 & s2, f2 += d2, s2 /= 256, u2 -= 8)
            ;
          t2[r2 + f2 - d2] |= 128 * y3;
        };
        function pl(t2) {
          this.buf = ArrayBuffer.isView && ArrayBuffer.isView(t2) ? t2 : new Uint8Array(t2 || 0), this.pos = 0, this.type = 0, this.length = this.buf.length;
        }
        pl.Varint = 0, pl.Fixed64 = 1, pl.Bytes = 2, pl.Fixed32 = 5;
        var fl, dl = 4294967296, yl = 1 / dl, ml = "undefined" == typeof TextDecoder ? null : new TextDecoder("utf8");
        function gl(t2) {
          return t2.type === pl.Bytes ? t2.readVarint() + t2.pos : t2.pos + 1;
        }
        function xl(t2, e2, r2) {
          return r2 ? 4294967296 * e2 + (t2 >>> 0) : 4294967296 * (e2 >>> 0) + (t2 >>> 0);
        }
        function vl(t2, e2, r2) {
          var n2 = e2 <= 16383 ? 1 : e2 <= 2097151 ? 2 : e2 <= 268435455 ? 3 : Math.floor(Math.log(e2) / (7 * Math.LN2));
          r2.realloc(n2);
          for (var i2 = r2.pos - 1; i2 >= t2; i2--)
            r2.buf[i2 + n2] = r2.buf[i2];
        }
        function bl(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeVarint(t2[r2]);
        }
        function wl(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeSVarint(t2[r2]);
        }
        function _l(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeFloat(t2[r2]);
        }
        function Al(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeDouble(t2[r2]);
        }
        function kl(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeBoolean(t2[r2]);
        }
        function Sl(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeFixed32(t2[r2]);
        }
        function Il(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeSFixed32(t2[r2]);
        }
        function Ml(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeFixed64(t2[r2]);
        }
        function zl(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeSFixed64(t2[r2]);
        }
        function Bl(t2, e2) {
          return (t2[e2] | t2[e2 + 1] << 8 | t2[e2 + 2] << 16) + 16777216 * t2[e2 + 3];
        }
        function Cl(t2, e2, r2) {
          t2[r2] = e2, t2[r2 + 1] = e2 >>> 8, t2[r2 + 2] = e2 >>> 16, t2[r2 + 3] = e2 >>> 24;
        }
        function Pl(t2, e2) {
          return (t2[e2] | t2[e2 + 1] << 8 | t2[e2 + 2] << 16) + (t2[e2 + 3] << 24);
        }
        function Vl(t2, e2, r2) {
          1 === t2 && r2.readMessage(El, e2);
        }
        function El(t2, e2, r2) {
          if (3 === t2) {
            const { id: t3, bitmap: n2, width: i2, height: a2, left: s2, top: o2, advance: l2 } = r2.readMessage(Fl, {});
            e2.push({ id: t3, bitmap: new zs({ width: i2 + 6, height: a2 + 6 }, n2), metrics: { width: i2, height: a2, left: s2, top: o2, advance: l2 } });
          }
        }
        function Fl(t2, e2, r2) {
          1 === t2 ? e2.id = r2.readVarint() : 2 === t2 ? e2.bitmap = r2.readBytes() : 3 === t2 ? e2.width = r2.readVarint() : 4 === t2 ? e2.height = r2.readVarint() : 5 === t2 ? e2.left = r2.readSVarint() : 6 === t2 ? e2.top = r2.readSVarint() : 7 === t2 && (e2.advance = r2.readVarint());
        }
        function Tl(t2) {
          let e2 = 0, r2 = 0;
          for (const n3 of t2)
            e2 += n3.w * n3.h, r2 = Math.max(r2, n3.w);
          t2.sort((t3, e3) => e3.h - t3.h);
          const n2 = [{ x: 0, y: 0, w: Math.max(Math.ceil(Math.sqrt(e2 / 0.95)), r2), h: 1 / 0 }];
          let i2 = 0, a2 = 0;
          for (const e3 of t2)
            for (let t3 = n2.length - 1; t3 >= 0; t3--) {
              const r3 = n2[t3];
              if (!(e3.w > r3.w || e3.h > r3.h)) {
                if (e3.x = r3.x, e3.y = r3.y, a2 = Math.max(a2, e3.y + e3.h), i2 = Math.max(i2, e3.x + e3.w), e3.w === r3.w && e3.h === r3.h) {
                  const e4 = n2.pop();
                  t3 < n2.length && (n2[t3] = e4);
                } else
                  e3.h === r3.h ? (r3.x += e3.w, r3.w -= e3.w) : e3.w === r3.w ? (r3.y += e3.h, r3.h -= e3.h) : (n2.push({ x: r3.x + e3.w, y: r3.y, w: r3.w - e3.w, h: e3.h }), r3.y += e3.h, r3.h -= e3.h);
                break;
              }
            }
          return { w: i2, h: a2, fill: e2 / (i2 * a2) || 0 };
        }
        pl.prototype = { destroy: function() {
          this.buf = null;
        }, readFields: function(t2, e2, r2) {
          for (r2 = r2 || this.length; this.pos < r2; ) {
            var n2 = this.readVarint(), i2 = n2 >> 3, a2 = this.pos;
            this.type = 7 & n2, t2(i2, e2, this), this.pos === a2 && this.skip(n2);
          }
          return e2;
        }, readMessage: function(t2, e2) {
          return this.readFields(t2, e2, this.readVarint() + this.pos);
        }, readFixed32: function() {
          var t2 = Bl(this.buf, this.pos);
          return this.pos += 4, t2;
        }, readSFixed32: function() {
          var t2 = Pl(this.buf, this.pos);
          return this.pos += 4, t2;
        }, readFixed64: function() {
          var t2 = Bl(this.buf, this.pos) + Bl(this.buf, this.pos + 4) * dl;
          return this.pos += 8, t2;
        }, readSFixed64: function() {
          var t2 = Bl(this.buf, this.pos) + Pl(this.buf, this.pos + 4) * dl;
          return this.pos += 8, t2;
        }, readFloat: function() {
          var t2 = cl(this.buf, this.pos, true, 23, 4);
          return this.pos += 4, t2;
        }, readDouble: function() {
          var t2 = cl(this.buf, this.pos, true, 52, 8);
          return this.pos += 8, t2;
        }, readVarint: function(t2) {
          var e2, r2, n2 = this.buf;
          return e2 = 127 & (r2 = n2[this.pos++]), r2 < 128 ? e2 : (e2 |= (127 & (r2 = n2[this.pos++])) << 7, r2 < 128 ? e2 : (e2 |= (127 & (r2 = n2[this.pos++])) << 14, r2 < 128 ? e2 : (e2 |= (127 & (r2 = n2[this.pos++])) << 21, r2 < 128 ? e2 : function(t3, e3, r3) {
            var n3, i2, a2 = r3.buf;
            if (n3 = (112 & (i2 = a2[r3.pos++])) >> 4, i2 < 128)
              return xl(t3, n3, e3);
            if (n3 |= (127 & (i2 = a2[r3.pos++])) << 3, i2 < 128)
              return xl(t3, n3, e3);
            if (n3 |= (127 & (i2 = a2[r3.pos++])) << 10, i2 < 128)
              return xl(t3, n3, e3);
            if (n3 |= (127 & (i2 = a2[r3.pos++])) << 17, i2 < 128)
              return xl(t3, n3, e3);
            if (n3 |= (127 & (i2 = a2[r3.pos++])) << 24, i2 < 128)
              return xl(t3, n3, e3);
            if (n3 |= (1 & (i2 = a2[r3.pos++])) << 31, i2 < 128)
              return xl(t3, n3, e3);
            throw new Error("Expected varint not more than 10 bytes");
          }(e2 |= (15 & (r2 = n2[this.pos])) << 28, t2, this))));
        }, readVarint64: function() {
          return this.readVarint(true);
        }, readSVarint: function() {
          var t2 = this.readVarint();
          return t2 % 2 == 1 ? (t2 + 1) / -2 : t2 / 2;
        }, readBoolean: function() {
          return Boolean(this.readVarint());
        }, readString: function() {
          var t2 = this.readVarint() + this.pos, e2 = this.pos;
          return this.pos = t2, t2 - e2 >= 12 && ml ? function(t3, e3, r2) {
            return ml.decode(t3.subarray(e3, r2));
          }(this.buf, e2, t2) : function(t3, e3, r2) {
            for (var n2 = "", i2 = e3; i2 < r2; ) {
              var a2, s2, o2, l2 = t3[i2], u2 = null, c3 = l2 > 239 ? 4 : l2 > 223 ? 3 : l2 > 191 ? 2 : 1;
              if (i2 + c3 > r2)
                break;
              1 === c3 ? l2 < 128 && (u2 = l2) : 2 === c3 ? 128 == (192 & (a2 = t3[i2 + 1])) && (u2 = (31 & l2) << 6 | 63 & a2) <= 127 && (u2 = null) : 3 === c3 ? (s2 = t3[i2 + 2], 128 == (192 & (a2 = t3[i2 + 1])) && 128 == (192 & s2) && ((u2 = (15 & l2) << 12 | (63 & a2) << 6 | 63 & s2) <= 2047 || u2 >= 55296 && u2 <= 57343) && (u2 = null)) : 4 === c3 && (s2 = t3[i2 + 2], o2 = t3[i2 + 3], 128 == (192 & (a2 = t3[i2 + 1])) && 128 == (192 & s2) && 128 == (192 & o2) && ((u2 = (15 & l2) << 18 | (63 & a2) << 12 | (63 & s2) << 6 | 63 & o2) <= 65535 || u2 >= 1114112) && (u2 = null)), null === u2 ? (u2 = 65533, c3 = 1) : u2 > 65535 && (u2 -= 65536, n2 += String.fromCharCode(u2 >>> 10 & 1023 | 55296), u2 = 56320 | 1023 & u2), n2 += String.fromCharCode(u2), i2 += c3;
            }
            return n2;
          }(this.buf, e2, t2);
        }, readBytes: function() {
          var t2 = this.readVarint() + this.pos, e2 = this.buf.subarray(this.pos, t2);
          return this.pos = t2, e2;
        }, readPackedVarint: function(t2, e2) {
          if (this.type !== pl.Bytes)
            return t2.push(this.readVarint(e2));
          var r2 = gl(this);
          for (t2 = t2 || []; this.pos < r2; )
            t2.push(this.readVarint(e2));
          return t2;
        }, readPackedSVarint: function(t2) {
          if (this.type !== pl.Bytes)
            return t2.push(this.readSVarint());
          var e2 = gl(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readSVarint());
          return t2;
        }, readPackedBoolean: function(t2) {
          if (this.type !== pl.Bytes)
            return t2.push(this.readBoolean());
          var e2 = gl(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readBoolean());
          return t2;
        }, readPackedFloat: function(t2) {
          if (this.type !== pl.Bytes)
            return t2.push(this.readFloat());
          var e2 = gl(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readFloat());
          return t2;
        }, readPackedDouble: function(t2) {
          if (this.type !== pl.Bytes)
            return t2.push(this.readDouble());
          var e2 = gl(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readDouble());
          return t2;
        }, readPackedFixed32: function(t2) {
          if (this.type !== pl.Bytes)
            return t2.push(this.readFixed32());
          var e2 = gl(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readFixed32());
          return t2;
        }, readPackedSFixed32: function(t2) {
          if (this.type !== pl.Bytes)
            return t2.push(this.readSFixed32());
          var e2 = gl(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readSFixed32());
          return t2;
        }, readPackedFixed64: function(t2) {
          if (this.type !== pl.Bytes)
            return t2.push(this.readFixed64());
          var e2 = gl(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readFixed64());
          return t2;
        }, readPackedSFixed64: function(t2) {
          if (this.type !== pl.Bytes)
            return t2.push(this.readSFixed64());
          var e2 = gl(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readSFixed64());
          return t2;
        }, skip: function(t2) {
          var e2 = 7 & t2;
          if (e2 === pl.Varint)
            for (; this.buf[this.pos++] > 127; )
              ;
          else if (e2 === pl.Bytes)
            this.pos = this.readVarint() + this.pos;
          else if (e2 === pl.Fixed32)
            this.pos += 4;
          else {
            if (e2 !== pl.Fixed64)
              throw new Error("Unimplemented type: " + e2);
            this.pos += 8;
          }
        }, writeTag: function(t2, e2) {
          this.writeVarint(t2 << 3 | e2);
        }, realloc: function(t2) {
          for (var e2 = this.length || 16; e2 < this.pos + t2; )
            e2 *= 2;
          if (e2 !== this.length) {
            var r2 = new Uint8Array(e2);
            r2.set(this.buf), this.buf = r2, this.length = e2;
          }
        }, finish: function() {
          return this.length = this.pos, this.pos = 0, this.buf.subarray(0, this.length);
        }, writeFixed32: function(t2) {
          this.realloc(4), Cl(this.buf, t2, this.pos), this.pos += 4;
        }, writeSFixed32: function(t2) {
          this.realloc(4), Cl(this.buf, t2, this.pos), this.pos += 4;
        }, writeFixed64: function(t2) {
          this.realloc(8), Cl(this.buf, -1 & t2, this.pos), Cl(this.buf, Math.floor(t2 * yl), this.pos + 4), this.pos += 8;
        }, writeSFixed64: function(t2) {
          this.realloc(8), Cl(this.buf, -1 & t2, this.pos), Cl(this.buf, Math.floor(t2 * yl), this.pos + 4), this.pos += 8;
        }, writeVarint: function(t2) {
          (t2 = +t2 || 0) > 268435455 || t2 < 0 ? function(t3, e2) {
            var r2, n2;
            if (t3 >= 0 ? (r2 = t3 % 4294967296 | 0, n2 = t3 / 4294967296 | 0) : (n2 = ~(-t3 / 4294967296), 4294967295 ^ (r2 = ~(-t3 % 4294967296)) ? r2 = r2 + 1 | 0 : (r2 = 0, n2 = n2 + 1 | 0)), t3 >= 18446744073709552e3 || t3 < -18446744073709552e3)
              throw new Error("Given varint doesn't fit into 10 bytes");
            e2.realloc(10), function(t4, e3, r3) {
              r3.buf[r3.pos++] = 127 & t4 | 128, t4 >>>= 7, r3.buf[r3.pos++] = 127 & t4 | 128, t4 >>>= 7, r3.buf[r3.pos++] = 127 & t4 | 128, t4 >>>= 7, r3.buf[r3.pos++] = 127 & t4 | 128, r3.buf[r3.pos] = 127 & (t4 >>>= 7);
            }(r2, 0, e2), function(t4, e3) {
              var r3 = (7 & t4) << 4;
              e3.buf[e3.pos++] |= r3 | ((t4 >>>= 3) ? 128 : 0), t4 && (e3.buf[e3.pos++] = 127 & t4 | ((t4 >>>= 7) ? 128 : 0), t4 && (e3.buf[e3.pos++] = 127 & t4 | ((t4 >>>= 7) ? 128 : 0), t4 && (e3.buf[e3.pos++] = 127 & t4 | ((t4 >>>= 7) ? 128 : 0), t4 && (e3.buf[e3.pos++] = 127 & t4 | ((t4 >>>= 7) ? 128 : 0), t4 && (e3.buf[e3.pos++] = 127 & t4)))));
            }(n2, e2);
          }(t2, this) : (this.realloc(4), this.buf[this.pos++] = 127 & t2 | (t2 > 127 ? 128 : 0), t2 <= 127 || (this.buf[this.pos++] = 127 & (t2 >>>= 7) | (t2 > 127 ? 128 : 0), t2 <= 127 || (this.buf[this.pos++] = 127 & (t2 >>>= 7) | (t2 > 127 ? 128 : 0), t2 <= 127 || (this.buf[this.pos++] = t2 >>> 7 & 127))));
        }, writeSVarint: function(t2) {
          this.writeVarint(t2 < 0 ? 2 * -t2 - 1 : 2 * t2);
        }, writeBoolean: function(t2) {
          this.writeVarint(Boolean(t2));
        }, writeString: function(t2) {
          t2 = String(t2), this.realloc(4 * t2.length), this.pos++;
          var e2 = this.pos;
          this.pos = function(t3, e3, r3) {
            for (var n2, i2, a2 = 0; a2 < e3.length; a2++) {
              if ((n2 = e3.charCodeAt(a2)) > 55295 && n2 < 57344) {
                if (!i2) {
                  n2 > 56319 || a2 + 1 === e3.length ? (t3[r3++] = 239, t3[r3++] = 191, t3[r3++] = 189) : i2 = n2;
                  continue;
                }
                if (n2 < 56320) {
                  t3[r3++] = 239, t3[r3++] = 191, t3[r3++] = 189, i2 = n2;
                  continue;
                }
                n2 = i2 - 55296 << 10 | n2 - 56320 | 65536, i2 = null;
              } else
                i2 && (t3[r3++] = 239, t3[r3++] = 191, t3[r3++] = 189, i2 = null);
              n2 < 128 ? t3[r3++] = n2 : (n2 < 2048 ? t3[r3++] = n2 >> 6 | 192 : (n2 < 65536 ? t3[r3++] = n2 >> 12 | 224 : (t3[r3++] = n2 >> 18 | 240, t3[r3++] = n2 >> 12 & 63 | 128), t3[r3++] = n2 >> 6 & 63 | 128), t3[r3++] = 63 & n2 | 128);
            }
            return r3;
          }(this.buf, t2, this.pos);
          var r2 = this.pos - e2;
          r2 >= 128 && vl(e2, r2, this), this.pos = e2 - 1, this.writeVarint(r2), this.pos += r2;
        }, writeFloat: function(t2) {
          this.realloc(4), hl(this.buf, t2, this.pos, true, 23, 4), this.pos += 4;
        }, writeDouble: function(t2) {
          this.realloc(8), hl(this.buf, t2, this.pos, true, 52, 8), this.pos += 8;
        }, writeBytes: function(t2) {
          var e2 = t2.length;
          this.writeVarint(e2), this.realloc(e2);
          for (var r2 = 0; r2 < e2; r2++)
            this.buf[this.pos++] = t2[r2];
        }, writeRawMessage: function(t2, e2) {
          this.pos++;
          var r2 = this.pos;
          t2(e2, this);
          var n2 = this.pos - r2;
          n2 >= 128 && vl(r2, n2, this), this.pos = r2 - 1, this.writeVarint(n2), this.pos += n2;
        }, writeMessage: function(t2, e2, r2) {
          this.writeTag(t2, pl.Bytes), this.writeRawMessage(e2, r2);
        }, writePackedVarint: function(t2, e2) {
          e2.length && this.writeMessage(t2, bl, e2);
        }, writePackedSVarint: function(t2, e2) {
          e2.length && this.writeMessage(t2, wl, e2);
        }, writePackedBoolean: function(t2, e2) {
          e2.length && this.writeMessage(t2, kl, e2);
        }, writePackedFloat: function(t2, e2) {
          e2.length && this.writeMessage(t2, _l, e2);
        }, writePackedDouble: function(t2, e2) {
          e2.length && this.writeMessage(t2, Al, e2);
        }, writePackedFixed32: function(t2, e2) {
          e2.length && this.writeMessage(t2, Sl, e2);
        }, writePackedSFixed32: function(t2, e2) {
          e2.length && this.writeMessage(t2, Il, e2);
        }, writePackedFixed64: function(t2, e2) {
          e2.length && this.writeMessage(t2, Ml, e2);
        }, writePackedSFixed64: function(t2, e2) {
          e2.length && this.writeMessage(t2, zl, e2);
        }, writeBytesField: function(t2, e2) {
          this.writeTag(t2, pl.Bytes), this.writeBytes(e2);
        }, writeFixed32Field: function(t2, e2) {
          this.writeTag(t2, pl.Fixed32), this.writeFixed32(e2);
        }, writeSFixed32Field: function(t2, e2) {
          this.writeTag(t2, pl.Fixed32), this.writeSFixed32(e2);
        }, writeFixed64Field: function(t2, e2) {
          this.writeTag(t2, pl.Fixed64), this.writeFixed64(e2);
        }, writeSFixed64Field: function(t2, e2) {
          this.writeTag(t2, pl.Fixed64), this.writeSFixed64(e2);
        }, writeVarintField: function(t2, e2) {
          this.writeTag(t2, pl.Varint), this.writeVarint(e2);
        }, writeSVarintField: function(t2, e2) {
          this.writeTag(t2, pl.Varint), this.writeSVarint(e2);
        }, writeStringField: function(t2, e2) {
          this.writeTag(t2, pl.Bytes), this.writeString(e2);
        }, writeFloatField: function(t2, e2) {
          this.writeTag(t2, pl.Fixed32), this.writeFloat(e2);
        }, writeDoubleField: function(t2, e2) {
          this.writeTag(t2, pl.Fixed64), this.writeDouble(e2);
        }, writeBooleanField: function(t2, e2) {
          this.writeVarintField(t2, Boolean(e2));
        } };
        class Ll {
          constructor(t2, { pixelRatio: e2, version: r2, stretchX: n2, stretchY: i2, content: a2 }) {
            this.paddedRect = t2, this.pixelRatio = e2, this.stretchX = n2, this.stretchY = i2, this.content = a2, this.version = r2;
          }
          get tl() {
            return [this.paddedRect.x + 1, this.paddedRect.y + 1];
          }
          get br() {
            return [this.paddedRect.x + this.paddedRect.w - 1, this.paddedRect.y + this.paddedRect.h - 1];
          }
          get tlbr() {
            return this.tl.concat(this.br);
          }
          get displaySize() {
            return [(this.paddedRect.w - 2) / this.pixelRatio, (this.paddedRect.h - 2) / this.pixelRatio];
          }
        }
        class Dl {
          constructor(t2, e2) {
            const r2 = {}, n2 = {};
            this.haveRenderCallbacks = [];
            const i2 = [];
            this.addImages(t2, r2, i2), this.addImages(e2, n2, i2);
            const { w: a2, h: s2 } = Tl(i2), o2 = new Bs({ width: a2 || 1, height: s2 || 1 });
            for (const e3 in t2) {
              const n3 = t2[e3], i3 = r2[e3].paddedRect;
              Bs.copy(n3.data, o2, { x: 0, y: 0 }, { x: i3.x + 1, y: i3.y + 1 }, n3.data);
            }
            for (const t3 in e2) {
              const r3 = e2[t3], i3 = n2[t3].paddedRect, a3 = i3.x + 1, s3 = i3.y + 1, l2 = r3.data.width, u2 = r3.data.height;
              Bs.copy(r3.data, o2, { x: 0, y: 0 }, { x: a3, y: s3 }, r3.data), Bs.copy(r3.data, o2, { x: 0, y: u2 - 1 }, { x: a3, y: s3 - 1 }, { width: l2, height: 1 }), Bs.copy(r3.data, o2, { x: 0, y: 0 }, { x: a3, y: s3 + u2 }, { width: l2, height: 1 }), Bs.copy(r3.data, o2, { x: l2 - 1, y: 0 }, { x: a3 - 1, y: s3 }, { width: 1, height: u2 }), Bs.copy(r3.data, o2, { x: 0, y: 0 }, { x: a3 + l2, y: s3 }, { width: 1, height: u2 });
            }
            this.image = o2, this.iconPositions = r2, this.patternPositions = n2;
          }
          addImages(t2, e2, r2) {
            for (const n2 in t2) {
              const i2 = t2[n2], a2 = { x: 0, y: 0, w: i2.data.width + 2, h: i2.data.height + 2 };
              r2.push(a2), e2[n2] = new Ll(a2, i2), i2.hasRenderCallback && this.haveRenderCallbacks.push(n2);
            }
          }
          patchUpdatedImages(t2, e2) {
            t2.dispatchRenderCallbacks(this.haveRenderCallbacks);
            for (const r2 in t2.updatedImages)
              this.patchUpdatedImage(this.iconPositions[r2], t2.getImage(r2), e2), this.patchUpdatedImage(this.patternPositions[r2], t2.getImage(r2), e2);
          }
          patchUpdatedImage(t2, e2, r2) {
            if (!t2 || !e2)
              return;
            if (t2.version === e2.version)
              return;
            t2.version = e2.version;
            const [n2, i2] = t2.tl;
            r2.update(e2.data, void 0, { x: n2, y: i2 });
          }
        }
        Mn("ImagePosition", Ll), Mn("ImageAtlas", Dl), t.WritingMode = void 0, (fl = t.WritingMode || (t.WritingMode = {}))[fl.none = 0] = "none", fl[fl.horizontal = 1] = "horizontal", fl[fl.vertical = 2] = "vertical", fl[fl.horizontalOnly = 3] = "horizontalOnly";
        const $l = -17;
        class Rl {
          constructor() {
            this.scale = 1, this.fontStack = "", this.imageName = null;
          }
          static forText(t2, e2) {
            const r2 = new Rl();
            return r2.scale = t2 || 1, r2.fontStack = e2, r2;
          }
          static forImage(t2) {
            const e2 = new Rl();
            return e2.imageName = t2, e2;
          }
        }
        class Ol {
          constructor() {
            this.text = "", this.sectionIndex = [], this.sections = [], this.imageSectionID = null;
          }
          static fromFeature(t2, e2) {
            const r2 = new Ol();
            for (let n2 = 0; n2 < t2.sections.length; n2++) {
              const i2 = t2.sections[n2];
              i2.image ? r2.addImageSection(i2) : r2.addTextSection(i2, e2);
            }
            return r2;
          }
          length() {
            return this.text.length;
          }
          getSection(t2) {
            return this.sections[this.sectionIndex[t2]];
          }
          getSectionIndex(t2) {
            return this.sectionIndex[t2];
          }
          getCharCode(t2) {
            return this.text.charCodeAt(t2);
          }
          verticalizePunctuation() {
            this.text = function(t2) {
              let e2 = "";
              for (let r2 = 0; r2 < t2.length; r2++) {
                const n2 = t2.charCodeAt(r2 + 1) || null, i2 = t2.charCodeAt(r2 - 1) || null;
                e2 += n2 && Dn(n2) && !ol2[t2[r2 + 1]] || i2 && Dn(i2) && !ol2[t2[r2 - 1]] || !ol2[t2[r2]] ? t2[r2] : ol2[t2[r2]];
              }
              return e2;
            }(this.text);
          }
          trim() {
            let t2 = 0;
            for (let e3 = 0; e3 < this.text.length && ql[this.text.charCodeAt(e3)]; e3++)
              t2++;
            let e2 = this.text.length;
            for (let r2 = this.text.length - 1; r2 >= 0 && r2 >= t2 && ql[this.text.charCodeAt(r2)]; r2--)
              e2--;
            this.text = this.text.substring(t2, e2), this.sectionIndex = this.sectionIndex.slice(t2, e2);
          }
          substring(t2, e2) {
            const r2 = new Ol();
            return r2.text = this.text.substring(t2, e2), r2.sectionIndex = this.sectionIndex.slice(t2, e2), r2.sections = this.sections, r2;
          }
          toString() {
            return this.text;
          }
          getMaxScale() {
            return this.sectionIndex.reduce((t2, e2) => Math.max(t2, this.sections[e2].scale), 0);
          }
          addTextSection(t2, e2) {
            this.text += t2.text, this.sections.push(Rl.forText(t2.scale, t2.fontStack || e2));
            const r2 = this.sections.length - 1;
            for (let e3 = 0; e3 < t2.text.length; ++e3)
              this.sectionIndex.push(r2);
          }
          addImageSection(t2) {
            const e2 = t2.image ? t2.image.name : "";
            if (0 === e2.length)
              return void d("Can't add FormattedSection with an empty image.");
            const r2 = this.getNextImageSectionCharCode();
            r2 ? (this.text += String.fromCharCode(r2), this.sections.push(Rl.forImage(e2)), this.sectionIndex.push(this.sections.length - 1)) : d("Reached maximum number of images 6401");
          }
          getNextImageSectionCharCode() {
            return this.imageSectionID ? this.imageSectionID >= 63743 ? null : ++this.imageSectionID : (this.imageSectionID = 57344, this.imageSectionID);
          }
        }
        function Ul(e2, r2, n2, i2, a2, s2, o2, l2, u2, c3, h2, p3, f2, d2, y3, m2) {
          const g2 = Ol.fromFeature(e2, a2);
          let x2;
          p3 === t.WritingMode.vertical && g2.verticalizePunctuation();
          const { processBidirectionalText: v3, processStyledBidirectionalText: b2 } = Wn;
          if (v3 && 1 === g2.sections.length) {
            x2 = [];
            const t2 = v3(g2.toString(), Xl(g2, c3, s2, r2, i2, d2, y3));
            for (const e3 of t2) {
              const t3 = new Ol();
              t3.text = e3, t3.sections = g2.sections;
              for (let r3 = 0; r3 < e3.length; r3++)
                t3.sectionIndex.push(0);
              x2.push(t3);
            }
          } else if (b2) {
            x2 = [];
            const t2 = b2(g2.text, g2.sectionIndex, Xl(g2, c3, s2, r2, i2, d2, y3));
            for (const e3 of t2) {
              const t3 = new Ol();
              t3.text = e3[0], t3.sectionIndex = e3[1], t3.sections = g2.sections, x2.push(t3);
            }
          } else
            x2 = function(t2, e3) {
              const r3 = [], n3 = t2.text;
              let i3 = 0;
              for (const n4 of e3)
                r3.push(t2.substring(i3, n4)), i3 = n4;
              return i3 < n3.length && r3.push(t2.substring(i3, n3.length)), r3;
            }(g2, Xl(g2, c3, s2, r2, i2, d2, y3));
          const w2 = [], _2 = { positionedLines: w2, text: g2.toString(), top: h2[1], bottom: h2[1], left: h2[0], right: h2[0], writingMode: p3, iconsInText: false, verticalizable: false };
          return function(e3, r3, n3, i3, a3, s3, o3, l3, u3, c4, h3, p4) {
            let f3 = 0, d3 = $l, y4 = 0, m3 = 0;
            const g3 = "right" === l3 ? 1 : "left" === l3 ? 0 : 0.5;
            let x3 = 0;
            for (const o4 of a3) {
              o4.trim();
              const a4 = o4.getMaxScale(), l4 = (a4 - 1) * ll, b4 = { positionedGlyphs: [], lineOffset: 0 };
              e3.positionedLines[x3] = b4;
              const w4 = b4.positionedGlyphs;
              let _4 = 0;
              if (!o4.length()) {
                d3 += s3, ++x3;
                continue;
              }
              for (let s4 = 0; s4 < o4.length(); s4++) {
                const y5 = o4.getSection(s4), m4 = o4.getSectionIndex(s4), g4 = o4.getCharCode(s4);
                let x4 = 0, b5 = null, A4 = null, k2 = null, S2 = ll;
                const I3 = !(u3 === t.WritingMode.horizontal || !h3 && !Ln(g4) || h3 && (ql[g4] || (v4 = g4, Vn.Arabic(v4) || Vn["Arabic Supplement"](v4) || Vn["Arabic Extended-A"](v4) || Vn["Arabic Presentation Forms-A"](v4) || Vn["Arabic Presentation Forms-B"](v4))));
                if (y5.imageName) {
                  const t2 = i3[y5.imageName];
                  if (!t2)
                    continue;
                  k2 = y5.imageName, e3.iconsInText = e3.iconsInText || true, A4 = t2.paddedRect;
                  const r4 = t2.displaySize;
                  y5.scale = y5.scale * ll / p4, b5 = { width: r4[0], height: r4[1], left: 1, top: -3, advance: I3 ? r4[1] : r4[0] }, x4 = l4 + (ll - r4[1] * y5.scale), S2 = b5.advance;
                  const n4 = I3 ? r4[0] * y5.scale - ll * a4 : r4[1] * y5.scale - ll * a4;
                  n4 > 0 && n4 > _4 && (_4 = n4);
                } else {
                  const t2 = n3[y5.fontStack], e4 = t2 && t2[g4];
                  if (e4 && e4.rect)
                    A4 = e4.rect, b5 = e4.metrics;
                  else {
                    const t3 = r3[y5.fontStack], e5 = t3 && t3[g4];
                    if (!e5)
                      continue;
                    b5 = e5.metrics;
                  }
                  x4 = (a4 - y5.scale) * ll;
                }
                I3 ? (e3.verticalizable = true, w4.push({ glyph: g4, imageName: k2, x: f3, y: d3 + x4, vertical: I3, scale: y5.scale, fontStack: y5.fontStack, sectionIndex: m4, metrics: b5, rect: A4 }), f3 += S2 * y5.scale + c4) : (w4.push({ glyph: g4, imageName: k2, x: f3, y: d3 + x4, vertical: I3, scale: y5.scale, fontStack: y5.fontStack, sectionIndex: m4, metrics: b5, rect: A4 }), f3 += b5.advance * y5.scale + c4);
              }
              0 !== w4.length && (y4 = Math.max(f3 - c4, y4), Hl(w4, 0, w4.length - 1, g3, _4)), f3 = 0;
              const A3 = s3 * a4 + _4;
              b4.lineOffset = Math.max(_4, l4), d3 += A3, m3 = Math.max(A3, m3), ++x3;
            }
            var v4;
            const b3 = d3 - $l, { horizontalAlign: w3, verticalAlign: _3 } = Yl(o3);
            (function(t2, e4, r4, n4, i4, a4, s4, o4, l4) {
              const u4 = (e4 - r4) * i4;
              let c5 = 0;
              c5 = a4 !== s4 ? -o4 * n4 - $l : (-n4 * l4 + 0.5) * s4;
              for (const e5 of t2)
                for (const t3 of e5.positionedGlyphs)
                  t3.x += u4, t3.y += c5;
            })(e3.positionedLines, g3, w3, _3, y4, m3, s3, b3, a3.length), e3.top += -_3 * b3, e3.bottom = e3.top + b3, e3.left += -w3 * y4, e3.right = e3.left + y4;
          }(_2, r2, n2, i2, x2, o2, l2, u2, p3, c3, f2, m2), !function(t2) {
            for (const e3 of t2)
              if (0 !== e3.positionedGlyphs.length)
                return false;
            return true;
          }(w2) && _2;
        }
        const ql = { 9: true, 10: true, 11: true, 12: true, 13: true, 32: true }, jl = { 10: true, 32: true, 38: true, 40: true, 41: true, 43: true, 45: true, 47: true, 173: true, 183: true, 8203: true, 8208: true, 8211: true, 8231: true };
        function Nl(t2, e2, r2, n2, i2, a2) {
          if (e2.imageName) {
            const t3 = n2[e2.imageName];
            return t3 ? t3.displaySize[0] * e2.scale * ll / a2 + i2 : 0;
          }
          {
            const n3 = r2[e2.fontStack], a3 = n3 && n3[t2];
            return a3 ? a3.metrics.advance * e2.scale + i2 : 0;
          }
        }
        function Zl(t2, e2, r2, n2) {
          const i2 = Math.pow(t2 - e2, 2);
          return n2 ? t2 < e2 ? i2 / 2 : 2 * i2 : i2 + Math.abs(r2) * r2;
        }
        function Kl(t2, e2, r2) {
          let n2 = 0;
          return 10 === t2 && (n2 -= 1e4), r2 && (n2 += 150), 40 !== t2 && 65288 !== t2 || (n2 += 50), 41 !== e2 && 65289 !== e2 || (n2 += 50), n2;
        }
        function Gl(t2, e2, r2, n2, i2, a2) {
          let s2 = null, o2 = Zl(e2, r2, i2, a2);
          for (const t3 of n2) {
            const n3 = Zl(e2 - t3.x, r2, i2, a2) + t3.badness;
            n3 <= o2 && (s2 = t3, o2 = n3);
          }
          return { index: t2, x: e2, priorBreak: s2, badness: o2 };
        }
        function Jl(t2) {
          return t2 ? Jl(t2.priorBreak).concat(t2.index) : [];
        }
        function Xl(t2, e2, r2, n2, i2, a2, s2) {
          if ("point" !== a2)
            return [];
          if (!t2)
            return [];
          const o2 = [], l2 = function(t3, e3, r3, n3, i3, a3) {
            let s3 = 0;
            for (let r4 = 0; r4 < t3.length(); r4++) {
              const o3 = t3.getSection(r4);
              s3 += Nl(t3.getCharCode(r4), o3, n3, i3, e3, a3);
            }
            return s3 / Math.max(1, Math.ceil(s3 / r3));
          }(t2, e2, r2, n2, i2, s2), u2 = t2.text.indexOf("\u200B") >= 0;
          let c3 = 0;
          for (let r3 = 0; r3 < t2.length(); r3++) {
            const a3 = t2.getSection(r3), p3 = t2.getCharCode(r3);
            if (ql[p3] || (c3 += Nl(p3, a3, n2, i2, e2, s2)), r3 < t2.length() - 1) {
              const e3 = !((h2 = p3) < 11904 || !(Vn["Bopomofo Extended"](h2) || Vn.Bopomofo(h2) || Vn["CJK Compatibility Forms"](h2) || Vn["CJK Compatibility Ideographs"](h2) || Vn["CJK Compatibility"](h2) || Vn["CJK Radicals Supplement"](h2) || Vn["CJK Strokes"](h2) || Vn["CJK Symbols and Punctuation"](h2) || Vn["CJK Unified Ideographs Extension A"](h2) || Vn["CJK Unified Ideographs"](h2) || Vn["Enclosed CJK Letters and Months"](h2) || Vn["Halfwidth and Fullwidth Forms"](h2) || Vn.Hiragana(h2) || Vn["Ideographic Description Characters"](h2) || Vn["Kangxi Radicals"](h2) || Vn["Katakana Phonetic Extensions"](h2) || Vn.Katakana(h2) || Vn["Vertical Forms"](h2) || Vn["Yi Radicals"](h2) || Vn["Yi Syllables"](h2)));
              (jl[p3] || e3 || a3.imageName) && o2.push(Gl(r3 + 1, c3, l2, o2, Kl(p3, t2.getCharCode(r3 + 1), e3 && u2), false));
            }
          }
          var h2;
          return Jl(Gl(t2.length(), c3, l2, o2, 0, true));
        }
        function Yl(t2) {
          let e2 = 0.5, r2 = 0.5;
          switch (t2) {
            case "right":
            case "top-right":
            case "bottom-right":
              e2 = 1;
              break;
            case "left":
            case "top-left":
            case "bottom-left":
              e2 = 0;
          }
          switch (t2) {
            case "bottom":
            case "bottom-right":
            case "bottom-left":
              r2 = 1;
              break;
            case "top":
            case "top-right":
            case "top-left":
              r2 = 0;
          }
          return { horizontalAlign: e2, verticalAlign: r2 };
        }
        function Hl(t2, e2, r2, n2, i2) {
          if (!n2 && !i2)
            return;
          const a2 = t2[r2], s2 = (t2[r2].x + a2.metrics.advance * a2.scale) * n2;
          for (let n3 = e2; n3 <= r2; n3++)
            t2[n3].x -= s2, t2[n3].y += i2;
        }
        function Wl(t2, e2, r2) {
          const { horizontalAlign: n2, verticalAlign: i2 } = Yl(r2), a2 = e2[0] - t2.displaySize[0] * n2, s2 = e2[1] - t2.displaySize[1] * i2;
          return { image: t2, top: s2, bottom: s2 + t2.displaySize[1], left: a2, right: a2 + t2.displaySize[0] };
        }
        function Ql(t2, e2, r2, n2, i2, a2) {
          const s2 = t2.image;
          let o2;
          if (s2.content) {
            const t3 = s2.content, e3 = s2.pixelRatio || 1;
            o2 = [t3[0] / e3, t3[1] / e3, s2.displaySize[0] - t3[2] / e3, s2.displaySize[1] - t3[3] / e3];
          }
          const l2 = e2.left * a2, u2 = e2.right * a2;
          let c3, h2, p3, f2;
          "width" === r2 || "both" === r2 ? (f2 = i2[0] + l2 - n2[3], h2 = i2[0] + u2 + n2[1]) : (f2 = i2[0] + (l2 + u2 - s2.displaySize[0]) / 2, h2 = f2 + s2.displaySize[0]);
          const d2 = e2.top * a2, y3 = e2.bottom * a2;
          return "height" === r2 || "both" === r2 ? (c3 = i2[1] + d2 - n2[0], p3 = i2[1] + y3 + n2[2]) : (c3 = i2[1] + (d2 + y3 - s2.displaySize[1]) / 2, p3 = c3 + s2.displaySize[1]), { image: s2, top: c3, right: h2, bottom: p3, left: f2, collisionPadding: o2 };
        }
        const tu = 128;
        function eu(t2, e2) {
          const { expression: r2 } = e2;
          if ("constant" === r2.kind)
            return { kind: "constant", layoutSize: r2.evaluate(new Qn(t2 + 1)) };
          if ("source" === r2.kind)
            return { kind: "source" };
          {
            const { zoomStops: e3, interpolationType: n2 } = r2;
            let i2 = 0;
            for (; i2 < e3.length && e3[i2] <= t2; )
              i2++;
            i2 = Math.max(0, i2 - 1);
            let a2 = i2;
            for (; a2 < e3.length && e3[a2] < t2 + 1; )
              a2++;
            a2 = Math.min(e3.length - 1, a2);
            const s2 = e3[i2], o2 = e3[a2];
            return "composite" === r2.kind ? { kind: "composite", minZoom: s2, maxZoom: o2, interpolationType: n2 } : { kind: "camera", minZoom: s2, maxZoom: o2, minSize: r2.evaluate(new Qn(s2)), maxSize: r2.evaluate(new Qn(o2)), interpolationType: n2 };
          }
        }
        class ru extends S {
          constructor(t2, e2, r2, n2) {
            super(t2, e2), this.angle = r2, void 0 !== n2 && (this.segment = n2);
          }
          clone() {
            return new ru(this.x, this.y, this.angle, this.segment);
          }
        }
        function nu(t2, e2, r2, n2, i2) {
          if (void 0 === e2.segment)
            return true;
          let a2 = e2, s2 = e2.segment + 1, o2 = 0;
          for (; o2 > -r2 / 2; ) {
            if (s2--, s2 < 0)
              return false;
            o2 -= t2[s2].dist(a2), a2 = t2[s2];
          }
          o2 += t2[s2].dist(t2[s2 + 1]), s2++;
          const l2 = [];
          let u2 = 0;
          for (; o2 < r2 / 2; ) {
            const e3 = t2[s2], r3 = t2[s2 + 1];
            if (!r3)
              return false;
            let a3 = t2[s2 - 1].angleTo(e3) - e3.angleTo(r3);
            for (a3 = Math.abs((a3 + 3 * Math.PI) % (2 * Math.PI) - Math.PI), l2.push({ distance: o2, angleDelta: a3 }), u2 += a3; o2 - l2[0].distance > n2; )
              u2 -= l2.shift().angleDelta;
            if (u2 > i2)
              return false;
            s2++, o2 += e3.dist(r3);
          }
          return true;
        }
        function iu(t2) {
          let e2 = 0;
          for (let r2 = 0; r2 < t2.length - 1; r2++)
            e2 += t2[r2].dist(t2[r2 + 1]);
          return e2;
        }
        function au(t2, e2, r2) {
          return t2 ? 0.6 * e2 * r2 : 0;
        }
        function su(t2, e2) {
          return Math.max(t2 ? t2.right - t2.left : 0, e2 ? e2.right - e2.left : 0);
        }
        function ou(t2, e2, r2, n2, i2, a2) {
          const s2 = au(r2, i2, a2), o2 = su(r2, n2) * a2;
          let l2 = 0;
          const u2 = iu(t2) / 2;
          for (let r3 = 0; r3 < t2.length - 1; r3++) {
            const n3 = t2[r3], i3 = t2[r3 + 1], a3 = n3.dist(i3);
            if (l2 + a3 > u2) {
              const c3 = (u2 - l2) / a3, h2 = Se(n3.x, i3.x, c3), p3 = Se(n3.y, i3.y, c3), f2 = new ru(h2, p3, i3.angleTo(n3), r3);
              return f2._round(), !s2 || nu(t2, f2, o2, s2, e2) ? f2 : void 0;
            }
            l2 += a3;
          }
        }
        function lu(t2, e2, r2, n2, i2, a2, s2, o2, l2) {
          const u2 = au(n2, a2, s2), c3 = su(n2, i2), h2 = c3 * s2, p3 = 0 === t2[0].x || t2[0].x === l2 || 0 === t2[0].y || t2[0].y === l2;
          return e2 - h2 < e2 / 4 && (e2 = h2 + e2 / 4), uu(t2, p3 ? e2 / 2 * o2 % e2 : (c3 / 2 + 2 * a2) * s2 * o2 % e2, e2, u2, r2, h2, p3, false, l2);
        }
        function uu(t2, e2, r2, n2, i2, a2, s2, o2, l2) {
          const u2 = a2 / 2, c3 = iu(t2);
          let h2 = 0, p3 = e2 - r2, f2 = [];
          for (let e3 = 0; e3 < t2.length - 1; e3++) {
            const s3 = t2[e3], o3 = t2[e3 + 1], d2 = s3.dist(o3), y3 = o3.angleTo(s3);
            for (; p3 + r2 < h2 + d2; ) {
              p3 += r2;
              const m2 = (p3 - h2) / d2, g2 = Se(s3.x, o3.x, m2), x2 = Se(s3.y, o3.y, m2);
              if (g2 >= 0 && g2 < l2 && x2 >= 0 && x2 < l2 && p3 - u2 >= 0 && p3 + u2 <= c3) {
                const r3 = new ru(g2, x2, y3, e3);
                r3._round(), n2 && !nu(t2, r3, a2, n2, i2) || f2.push(r3);
              }
            }
            h2 += d2;
          }
          return o2 || f2.length || s2 || (f2 = uu(t2, h2 / 2, r2, n2, i2, a2, s2, true, l2)), f2;
        }
        function cu(t2, e2, r2, n2, i2) {
          const a2 = [];
          for (let s2 = 0; s2 < t2.length; s2++) {
            const o2 = t2[s2];
            let l2;
            for (let t3 = 0; t3 < o2.length - 1; t3++) {
              let s3 = o2[t3], u2 = o2[t3 + 1];
              s3.x < e2 && u2.x < e2 || (s3.x < e2 ? s3 = new S(e2, s3.y + (e2 - s3.x) / (u2.x - s3.x) * (u2.y - s3.y))._round() : u2.x < e2 && (u2 = new S(e2, s3.y + (e2 - s3.x) / (u2.x - s3.x) * (u2.y - s3.y))._round()), s3.y < r2 && u2.y < r2 || (s3.y < r2 ? s3 = new S(s3.x + (r2 - s3.y) / (u2.y - s3.y) * (u2.x - s3.x), r2)._round() : u2.y < r2 && (u2 = new S(s3.x + (r2 - s3.y) / (u2.y - s3.y) * (u2.x - s3.x), r2)._round()), s3.x >= n2 && u2.x >= n2 || (s3.x >= n2 ? s3 = new S(n2, s3.y + (n2 - s3.x) / (u2.x - s3.x) * (u2.y - s3.y))._round() : u2.x >= n2 && (u2 = new S(n2, s3.y + (n2 - s3.x) / (u2.x - s3.x) * (u2.y - s3.y))._round()), s3.y >= i2 && u2.y >= i2 || (s3.y >= i2 ? s3 = new S(s3.x + (i2 - s3.y) / (u2.y - s3.y) * (u2.x - s3.x), i2)._round() : u2.y >= i2 && (u2 = new S(s3.x + (i2 - s3.y) / (u2.y - s3.y) * (u2.x - s3.x), i2)._round()), l2 && s3.equals(l2[l2.length - 1]) || (l2 = [s3], a2.push(l2)), l2.push(u2)))));
            }
          }
          return a2;
        }
        function hu(t2, e2, r2, n2) {
          const i2 = [], a2 = t2.image, s2 = a2.pixelRatio, o2 = a2.paddedRect.w - 2, l2 = a2.paddedRect.h - 2, u2 = t2.right - t2.left, c3 = t2.bottom - t2.top, h2 = a2.stretchX || [[0, o2]], p3 = a2.stretchY || [[0, l2]], f2 = (t3, e3) => t3 + e3[1] - e3[0], d2 = h2.reduce(f2, 0), y3 = p3.reduce(f2, 0), m2 = o2 - d2, g2 = l2 - y3;
          let x2 = 0, v3 = d2, b2 = 0, w2 = y3, _2 = 0, A3 = m2, k2 = 0, I3 = g2;
          if (a2.content && n2) {
            const t3 = a2.content;
            x2 = pu(h2, 0, t3[0]), b2 = pu(p3, 0, t3[1]), v3 = pu(h2, t3[0], t3[2]), w2 = pu(p3, t3[1], t3[3]), _2 = t3[0] - x2, k2 = t3[1] - b2, A3 = t3[2] - t3[0] - v3, I3 = t3[3] - t3[1] - w2;
          }
          const M2 = (n3, i3, o3, l3) => {
            const h3 = du(n3.stretch - x2, v3, u2, t2.left), p4 = yu(n3.fixed - _2, A3, n3.stretch, d2), f3 = du(i3.stretch - b2, w2, c3, t2.top), m3 = yu(i3.fixed - k2, I3, i3.stretch, y3), g3 = du(o3.stretch - x2, v3, u2, t2.left), M3 = yu(o3.fixed - _2, A3, o3.stretch, d2), z2 = du(l3.stretch - b2, w2, c3, t2.top), B2 = yu(l3.fixed - k2, I3, l3.stretch, y3), C2 = new S(h3, f3), P2 = new S(g3, f3), V3 = new S(g3, z2), E2 = new S(h3, z2), F2 = new S(p4 / s2, m3 / s2), T2 = new S(M3 / s2, B2 / s2), L2 = e2 * Math.PI / 180;
            if (L2) {
              const t3 = Math.sin(L2), e3 = Math.cos(L2), r3 = [e3, -t3, t3, e3];
              C2._matMult(r3), P2._matMult(r3), E2._matMult(r3), V3._matMult(r3);
            }
            const D2 = n3.stretch + n3.fixed, $2 = i3.stretch + i3.fixed;
            return { tl: C2, tr: P2, bl: E2, br: V3, tex: { x: a2.paddedRect.x + 1 + D2, y: a2.paddedRect.y + 1 + $2, w: o3.stretch + o3.fixed - D2, h: l3.stretch + l3.fixed - $2 }, writingMode: void 0, glyphOffset: [0, 0], sectionIndex: 0, pixelOffsetTL: F2, pixelOffsetBR: T2, minFontScaleX: A3 / s2 / u2, minFontScaleY: I3 / s2 / c3, isSDF: r2 };
          };
          if (n2 && (a2.stretchX || a2.stretchY)) {
            const t3 = fu(h2, m2, d2), e3 = fu(p3, g2, y3);
            for (let r3 = 0; r3 < t3.length - 1; r3++) {
              const n3 = t3[r3], a3 = t3[r3 + 1];
              for (let t4 = 0; t4 < e3.length - 1; t4++)
                i2.push(M2(n3, e3[t4], a3, e3[t4 + 1]));
            }
          } else
            i2.push(M2({ fixed: 0, stretch: -1 }, { fixed: 0, stretch: -1 }, { fixed: 0, stretch: o2 + 1 }, { fixed: 0, stretch: l2 + 1 }));
          return i2;
        }
        function pu(t2, e2, r2) {
          let n2 = 0;
          for (const i2 of t2)
            n2 += Math.max(e2, Math.min(r2, i2[1])) - Math.max(e2, Math.min(r2, i2[0]));
          return n2;
        }
        function fu(t2, e2, r2) {
          const n2 = [{ fixed: -1, stretch: 0 }];
          for (const [e3, r3] of t2) {
            const t3 = n2[n2.length - 1];
            n2.push({ fixed: e3 - t3.stretch, stretch: t3.stretch }), n2.push({ fixed: e3 - t3.stretch, stretch: t3.stretch + (r3 - e3) });
          }
          return n2.push({ fixed: e2 + 1, stretch: r2 }), n2;
        }
        function du(t2, e2, r2, n2) {
          return t2 / e2 * r2 + n2;
        }
        function yu(t2, e2, r2, n2) {
          return t2 - e2 * r2 / n2;
        }
        Mn("Anchor", ru);
        class mu {
          constructor(t2, e2, r2, n2, i2, a2, s2, o2, l2, u2) {
            if (this.boxStartIndex = t2.length, l2) {
              let t3 = a2.top, e3 = a2.bottom;
              const r3 = a2.collisionPadding;
              r3 && (t3 -= r3[1], e3 += r3[3]);
              let n3 = e3 - t3;
              n3 > 0 && (n3 = Math.max(10, n3), this.circleDiameter = n3);
            } else {
              let l3 = a2.top * s2 - o2[0], c3 = a2.bottom * s2 + o2[2], h2 = a2.left * s2 - o2[3], p3 = a2.right * s2 + o2[1];
              const f2 = a2.collisionPadding;
              if (f2 && (h2 -= f2[0] * s2, l3 -= f2[1] * s2, p3 += f2[2] * s2, c3 += f2[3] * s2), u2) {
                const t3 = new S(h2, l3), e3 = new S(p3, l3), r3 = new S(h2, c3), n3 = new S(p3, c3), i3 = u2 * Math.PI / 180;
                t3._rotate(i3), e3._rotate(i3), r3._rotate(i3), n3._rotate(i3), h2 = Math.min(t3.x, e3.x, r3.x, n3.x), p3 = Math.max(t3.x, e3.x, r3.x, n3.x), l3 = Math.min(t3.y, e3.y, r3.y, n3.y), c3 = Math.max(t3.y, e3.y, r3.y, n3.y);
              }
              t2.emplaceBack(e2.x, e2.y, h2, l3, p3, c3, r2, n2, i2);
            }
            this.boxEndIndex = t2.length;
          }
        }
        class gu {
          constructor(t2 = [], e2 = xu) {
            if (this.data = t2, this.length = this.data.length, this.compare = e2, this.length > 0)
              for (let t3 = (this.length >> 1) - 1; t3 >= 0; t3--)
                this._down(t3);
          }
          push(t2) {
            this.data.push(t2), this.length++, this._up(this.length - 1);
          }
          pop() {
            if (0 === this.length)
              return;
            const t2 = this.data[0], e2 = this.data.pop();
            return this.length--, this.length > 0 && (this.data[0] = e2, this._down(0)), t2;
          }
          peek() {
            return this.data[0];
          }
          _up(t2) {
            const { data: e2, compare: r2 } = this, n2 = e2[t2];
            for (; t2 > 0; ) {
              const i2 = t2 - 1 >> 1, a2 = e2[i2];
              if (r2(n2, a2) >= 0)
                break;
              e2[t2] = a2, t2 = i2;
            }
            e2[t2] = n2;
          }
          _down(t2) {
            const { data: e2, compare: r2 } = this, n2 = this.length >> 1, i2 = e2[t2];
            for (; t2 < n2; ) {
              let n3 = 1 + (t2 << 1), a2 = e2[n3];
              const s2 = n3 + 1;
              if (s2 < this.length && r2(e2[s2], a2) < 0 && (n3 = s2, a2 = e2[s2]), r2(a2, i2) >= 0)
                break;
              e2[t2] = a2, t2 = n3;
            }
            e2[t2] = i2;
          }
        }
        function xu(t2, e2) {
          return t2 < e2 ? -1 : t2 > e2 ? 1 : 0;
        }
        function vu(t2, e2 = 1, r2 = false) {
          let n2 = 1 / 0, i2 = 1 / 0, a2 = -1 / 0, s2 = -1 / 0;
          const o2 = t2[0];
          for (let t3 = 0; t3 < o2.length; t3++) {
            const e3 = o2[t3];
            (!t3 || e3.x < n2) && (n2 = e3.x), (!t3 || e3.y < i2) && (i2 = e3.y), (!t3 || e3.x > a2) && (a2 = e3.x), (!t3 || e3.y > s2) && (s2 = e3.y);
          }
          const l2 = Math.min(a2 - n2, s2 - i2);
          let u2 = l2 / 2;
          const c3 = new gu([], bu);
          if (0 === l2)
            return new S(n2, i2);
          for (let e3 = n2; e3 < a2; e3 += l2)
            for (let r3 = i2; r3 < s2; r3 += l2)
              c3.push(new wu(e3 + u2, r3 + u2, u2, t2));
          let h2 = function(t3) {
            let e3 = 0, r3 = 0, n3 = 0;
            const i3 = t3[0];
            for (let t4 = 0, a3 = i3.length, s3 = a3 - 1; t4 < a3; s3 = t4++) {
              const a4 = i3[t4], o3 = i3[s3], l3 = a4.x * o3.y - o3.x * a4.y;
              r3 += (a4.x + o3.x) * l3, n3 += (a4.y + o3.y) * l3, e3 += 3 * l3;
            }
            return new wu(r3 / e3, n3 / e3, 0, t3);
          }(t2), p3 = c3.length;
          for (; c3.length; ) {
            const n3 = c3.pop();
            (n3.d > h2.d || !h2.d) && (h2 = n3, r2 && console.log("found best %d after %d probes", Math.round(1e4 * n3.d) / 1e4, p3)), n3.max - h2.d <= e2 || (u2 = n3.h / 2, c3.push(new wu(n3.p.x - u2, n3.p.y - u2, u2, t2)), c3.push(new wu(n3.p.x + u2, n3.p.y - u2, u2, t2)), c3.push(new wu(n3.p.x - u2, n3.p.y + u2, u2, t2)), c3.push(new wu(n3.p.x + u2, n3.p.y + u2, u2, t2)), p3 += 4);
          }
          return r2 && (console.log(`num probes: ${p3}`), console.log(`best distance: ${h2.d}`)), h2.p;
        }
        function bu(t2, e2) {
          return e2.max - t2.max;
        }
        function wu(t2, e2, r2, n2) {
          this.p = new S(t2, e2), this.h = r2, this.d = function(t3, e3) {
            let r3 = false, n3 = 1 / 0;
            for (let i2 = 0; i2 < e3.length; i2++) {
              const a2 = e3[i2];
              for (let e4 = 0, i3 = a2.length, s2 = i3 - 1; e4 < i3; s2 = e4++) {
                const i4 = a2[e4], o2 = a2[s2];
                i4.y > t3.y != o2.y > t3.y && t3.x < (o2.x - i4.x) * (t3.y - i4.y) / (o2.y - i4.y) + i4.x && (r3 = !r3), n3 = Math.min(n3, rs(t3, i4, o2));
              }
            }
            return (r3 ? 1 : -1) * Math.sqrt(n3);
          }(this.p, n2), this.max = this.d + this.h * Math.SQRT2;
        }
        const _u = Number.POSITIVE_INFINITY;
        function Au(t2, e2) {
          return e2[1] !== _u ? function(t3, e3, r2) {
            let n2 = 0, i2 = 0;
            switch (e3 = Math.abs(e3), r2 = Math.abs(r2), t3) {
              case "top-right":
              case "top-left":
              case "top":
                i2 = r2 - 7;
                break;
              case "bottom-right":
              case "bottom-left":
              case "bottom":
                i2 = 7 - r2;
            }
            switch (t3) {
              case "top-right":
              case "bottom-right":
              case "right":
                n2 = -e3;
                break;
              case "top-left":
              case "bottom-left":
              case "left":
                n2 = e3;
            }
            return [n2, i2];
          }(t2, e2[0], e2[1]) : function(t3, e3) {
            let r2 = 0, n2 = 0;
            e3 < 0 && (e3 = 0);
            const i2 = e3 / Math.sqrt(2);
            switch (t3) {
              case "top-right":
              case "top-left":
                n2 = i2 - 7;
                break;
              case "bottom-right":
              case "bottom-left":
                n2 = 7 - i2;
                break;
              case "bottom":
                n2 = 7 - e3;
                break;
              case "top":
                n2 = e3 - 7;
            }
            switch (t3) {
              case "top-right":
              case "bottom-right":
                r2 = -i2;
                break;
              case "top-left":
              case "bottom-left":
                r2 = i2;
                break;
              case "left":
                r2 = e3;
                break;
              case "right":
                r2 = -e3;
            }
            return [r2, n2];
          }(t2, e2[0]);
        }
        function ku(t2) {
          switch (t2) {
            case "right":
            case "top-right":
            case "bottom-right":
              return "right";
            case "left":
            case "top-left":
            case "bottom-left":
              return "left";
          }
          return "center";
        }
        function Su(e2, r2, n2, i2, a2, s2, o2, l2, u2, c3, h2) {
          let p3 = s2.textMaxSize.evaluate(r2, {});
          void 0 === p3 && (p3 = o2);
          const f2 = e2.layers[0].layout, y3 = f2.get("icon-offset").evaluate(r2, {}, h2), m2 = zu(n2.horizontal), g2 = o2 / 24, x2 = e2.tilePixelRatio * g2, v3 = e2.tilePixelRatio * p3 / 24, b2 = e2.tilePixelRatio * l2, w2 = e2.tilePixelRatio * f2.get("symbol-spacing"), _2 = f2.get("text-padding") * e2.tilePixelRatio, A3 = function(t2, e3, r3, n3 = 1) {
            const i3 = t2.get("icon-padding").evaluate(e3, {}, r3), a3 = i3 && i3.values;
            return [a3[0] * n3, a3[1] * n3, a3[2] * n3, a3[3] * n3];
          }(f2, r2, h2, e2.tilePixelRatio), k2 = f2.get("text-max-angle") / 180 * Math.PI, S2 = "viewport" !== f2.get("text-rotation-alignment") && "point" !== f2.get("symbol-placement"), I3 = "map" === f2.get("icon-rotation-alignment") && "point" !== f2.get("symbol-placement"), M2 = f2.get("symbol-placement"), z2 = w2 / 2, B2 = f2.get("icon-text-fit");
          let C2;
          i2 && "none" !== B2 && (e2.allowVerticalPlacement && n2.vertical && (C2 = Ql(i2, n2.vertical, B2, f2.get("icon-text-fit-padding"), y3, g2)), m2 && (i2 = Ql(i2, m2, B2, f2.get("icon-text-fit-padding"), y3, g2)));
          const P2 = (l3, p4) => {
            p4.x < 0 || p4.x >= qa || p4.y < 0 || p4.y >= qa || function(e3, r3, n3, i3, a3, s3, o3, l4, u3, c4, h3, p5, f3, y4, m3, g3, x3, v4, b3, w3, _3, A4, k3, S3, I4) {
              const M3 = e3.addToLineVertexArray(r3, n3);
              let z3, B3, C3, P3, V3 = 0, E2 = 0, F2 = 0, T2 = 0, L2 = -1, D2 = -1;
              const $2 = {};
              let R2 = xa.exports(""), O3 = 0, U2 = 0;
              if (void 0 === l4._unevaluatedLayout.getValue("text-radial-offset") ? [O3, U2] = l4.layout.get("text-offset").evaluate(_3, {}, S3).map((t2) => t2 * ll) : (O3 = l4.layout.get("text-radial-offset").evaluate(_3, {}, S3) * ll, U2 = _u), e3.allowVerticalPlacement && i3.vertical) {
                const t2 = l4.layout.get("text-rotate").evaluate(_3, {}, S3) + 90;
                C3 = new mu(u3, r3, c4, h3, p5, i3.vertical, f3, y4, m3, t2), o3 && (P3 = new mu(u3, r3, c4, h3, p5, o3, x3, v4, m3, t2));
              }
              if (a3) {
                const n4 = l4.layout.get("icon-rotate").evaluate(_3, {}), i4 = "none" !== l4.layout.get("icon-text-fit"), s4 = hu(a3, n4, k3, i4), f4 = o3 ? hu(o3, n4, k3, i4) : void 0;
                B3 = new mu(u3, r3, c4, h3, p5, a3, x3, v4, false, n4), V3 = 4 * s4.length;
                const y5 = e3.iconSizeData;
                let m4 = null;
                "source" === y5.kind ? (m4 = [tu * l4.layout.get("icon-size").evaluate(_3, {})], m4[0] > Iu && d(`${e3.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)) : "composite" === y5.kind && (m4 = [tu * A4.compositeIconSizes[0].evaluate(_3, {}, S3), tu * A4.compositeIconSizes[1].evaluate(_3, {}, S3)], (m4[0] > Iu || m4[1] > Iu) && d(`${e3.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)), e3.addSymbols(e3.icon, s4, m4, w3, b3, _3, t.WritingMode.none, r3, M3.lineStartIndex, M3.lineLength, -1, S3), L2 = e3.icon.placedSymbolArray.length - 1, f4 && (E2 = 4 * f4.length, e3.addSymbols(e3.icon, f4, m4, w3, b3, _3, t.WritingMode.vertical, r3, M3.lineStartIndex, M3.lineLength, -1, S3), D2 = e3.icon.placedSymbolArray.length - 1);
              }
              const q2 = Object.keys(i3.horizontal);
              for (const n4 of q2) {
                const a4 = i3.horizontal[n4];
                if (!z3) {
                  R2 = xa.exports(a4.text);
                  const t2 = l4.layout.get("text-rotate").evaluate(_3, {}, S3);
                  z3 = new mu(u3, r3, c4, h3, p5, a4, f3, y4, m3, t2);
                }
                const o4 = 1 === a4.positionedLines.length;
                if (F2 += Mu(e3, r3, a4, s3, l4, m3, _3, g3, M3, i3.vertical ? t.WritingMode.horizontal : t.WritingMode.horizontalOnly, o4 ? q2 : [n4], $2, L2, A4, S3), o4)
                  break;
              }
              i3.vertical && (T2 += Mu(e3, r3, i3.vertical, s3, l4, m3, _3, g3, M3, t.WritingMode.vertical, ["vertical"], $2, D2, A4, S3));
              const j2 = z3 ? z3.boxStartIndex : e3.collisionBoxArray.length, N2 = z3 ? z3.boxEndIndex : e3.collisionBoxArray.length, Z3 = C3 ? C3.boxStartIndex : e3.collisionBoxArray.length, K2 = C3 ? C3.boxEndIndex : e3.collisionBoxArray.length, G2 = B3 ? B3.boxStartIndex : e3.collisionBoxArray.length, J2 = B3 ? B3.boxEndIndex : e3.collisionBoxArray.length, X2 = P3 ? P3.boxStartIndex : e3.collisionBoxArray.length, Y2 = P3 ? P3.boxEndIndex : e3.collisionBoxArray.length;
              let H2 = -1;
              const W2 = (t2, e4) => t2 && t2.circleDiameter ? Math.max(t2.circleDiameter, e4) : e4;
              H2 = W2(z3, H2), H2 = W2(C3, H2), H2 = W2(B3, H2), H2 = W2(P3, H2);
              const Q2 = H2 > -1 ? 1 : 0;
              Q2 && (H2 *= I4 / ll), e3.glyphOffsetArray.length >= Du.MAX_GLYPHS && d("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"), void 0 !== _3.sortKey && e3.addToSortKeyRanges(e3.symbolInstances.length, _3.sortKey), e3.symbolInstances.emplaceBack(r3.x, r3.y, $2.right >= 0 ? $2.right : -1, $2.center >= 0 ? $2.center : -1, $2.left >= 0 ? $2.left : -1, $2.vertical || -1, L2, D2, R2, j2, N2, Z3, K2, G2, J2, X2, Y2, c4, F2, T2, V3, E2, Q2, 0, f3, O3, U2, H2);
            }(e2, p4, l3, n2, i2, a2, C2, e2.layers[0], e2.collisionBoxArray, r2.index, r2.sourceLayerIndex, e2.index, x2, [_2, _2, _2, _2], S2, u2, b2, A3, I3, y3, r2, s2, c3, h2, o2);
          };
          if ("line" === M2)
            for (const t2 of cu(r2.geometry, 0, 0, qa, qa)) {
              const r3 = lu(t2, w2, k2, n2.vertical || m2, i2, 24, v3, e2.overscaling, qa);
              for (const n3 of r3) {
                const r4 = m2;
                r4 && Bu(e2, r4.text, z2, n3) || P2(t2, n3);
              }
            }
          else if ("line-center" === M2) {
            for (const t2 of r2.geometry)
              if (t2.length > 1) {
                const e3 = ou(t2, k2, n2.vertical || m2, i2, 24, v3);
                e3 && P2(t2, e3);
              }
          } else if ("Polygon" === r2.type)
            for (const t2 of ho(r2.geometry, 0)) {
              const e3 = vu(t2, 16);
              P2(t2[0], new ru(e3.x, e3.y, 0));
            }
          else if ("LineString" === r2.type)
            for (const t2 of r2.geometry)
              P2(t2, new ru(t2[0].x, t2[0].y, 0));
          else if ("Point" === r2.type)
            for (const t2 of r2.geometry)
              for (const e3 of t2)
                P2([e3], new ru(e3.x, e3.y, 0));
        }
        const Iu = 32640;
        function Mu(t2, e2, r2, n2, i2, a2, s2, o2, l2, u2, c3, h2, p3, f2, y3) {
          const m2 = function(t3, e3, r3, n3, i3, a3, s3, o3) {
            const l3 = n3.layout.get("text-rotate").evaluate(a3, {}) * Math.PI / 180, u3 = [];
            for (const t4 of e3.positionedLines)
              for (const n4 of t4.positionedGlyphs) {
                if (!n4.rect)
                  continue;
                const a4 = n4.rect || {};
                let c4 = 4, h3 = true, p4 = 1, f3 = 0;
                const d2 = (i3 || o3) && n4.vertical, y4 = n4.metrics.advance * n4.scale / 2;
                if (o3 && e3.verticalizable) {
                  const e4 = (n4.scale - 1) * ll, r4 = (ll - n4.metrics.width * n4.scale) / 2;
                  f3 = t4.lineOffset / 2 - (n4.imageName ? -r4 : e4);
                }
                if (n4.imageName) {
                  const t5 = s3[n4.imageName];
                  h3 = t5.sdf, p4 = t5.pixelRatio, c4 = 1 / p4;
                }
                const m3 = i3 ? [n4.x + y4, n4.y] : [0, 0];
                let g3 = i3 ? [0, 0] : [n4.x + y4 + r3[0], n4.y + r3[1] - f3], x3 = [0, 0];
                d2 && (x3 = g3, g3 = [0, 0]);
                const v3 = (n4.metrics.left - c4) * n4.scale - y4 + g3[0], b2 = (-n4.metrics.top - c4) * n4.scale + g3[1], w2 = v3 + a4.w * n4.scale / p4, _2 = b2 + a4.h * n4.scale / p4, A3 = new S(v3, b2), k2 = new S(w2, b2), I3 = new S(v3, _2), M2 = new S(w2, _2);
                if (d2) {
                  const t5 = new S(-y4, y4 - $l), e4 = -Math.PI / 2, r4 = 12 - y4, i4 = new S(22 - r4, -(n4.imageName ? r4 : 0)), a5 = new S(...x3);
                  A3._rotateAround(e4, t5)._add(i4)._add(a5), k2._rotateAround(e4, t5)._add(i4)._add(a5), I3._rotateAround(e4, t5)._add(i4)._add(a5), M2._rotateAround(e4, t5)._add(i4)._add(a5);
                }
                if (l3) {
                  const t5 = Math.sin(l3), e4 = Math.cos(l3), r4 = [e4, -t5, t5, e4];
                  A3._matMult(r4), k2._matMult(r4), I3._matMult(r4), M2._matMult(r4);
                }
                const z2 = new S(0, 0), B2 = new S(0, 0);
                u3.push({ tl: A3, tr: k2, bl: I3, br: M2, tex: a4, writingMode: e3.writingMode, glyphOffset: m3, sectionIndex: n4.sectionIndex, isSDF: h3, pixelOffsetTL: z2, pixelOffsetBR: B2, minFontScaleX: 0, minFontScaleY: 0 });
              }
            return u3;
          }(0, r2, o2, i2, a2, s2, n2, t2.allowVerticalPlacement), g2 = t2.textSizeData;
          let x2 = null;
          "source" === g2.kind ? (x2 = [tu * i2.layout.get("text-size").evaluate(s2, {})], x2[0] > Iu && d(`${t2.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)) : "composite" === g2.kind && (x2 = [tu * f2.compositeTextSizes[0].evaluate(s2, {}, y3), tu * f2.compositeTextSizes[1].evaluate(s2, {}, y3)], (x2[0] > Iu || x2[1] > Iu) && d(`${t2.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)), t2.addSymbols(t2.text, m2, x2, o2, a2, s2, u2, e2, l2.lineStartIndex, l2.lineLength, p3, y3);
          for (const e3 of c3)
            h2[e3] = t2.text.placedSymbolArray.length - 1;
          return 4 * m2.length;
        }
        function zu(t2) {
          for (const e2 in t2)
            return t2[e2];
          return null;
        }
        function Bu(t2, e2, r2, n2) {
          const i2 = t2.compareText;
          if (e2 in i2) {
            const t3 = i2[e2];
            for (let e3 = t3.length - 1; e3 >= 0; e3--)
              if (n2.dist(t3[e3]) < r2)
                return true;
          } else
            i2[e2] = [];
          return i2[e2].push(n2), false;
        }
        const Cu = _o.VectorTileFeature.types, Pu = [{ name: "a_fade_opacity", components: 1, type: "Uint8", offset: 0 }];
        function Vu(t2, e2, r2, n2, i2, a2, s2, o2, l2, u2, c3, h2, p3) {
          const f2 = o2 ? Math.min(Iu, Math.round(o2[0])) : 0, d2 = o2 ? Math.min(Iu, Math.round(o2[1])) : 0;
          t2.emplaceBack(e2, r2, Math.round(32 * n2), Math.round(32 * i2), a2, s2, (f2 << 1) + (l2 ? 1 : 0), d2, 16 * u2, 16 * c3, 256 * h2, 256 * p3);
        }
        function Eu(t2, e2, r2) {
          t2.emplaceBack(e2.x, e2.y, r2), t2.emplaceBack(e2.x, e2.y, r2), t2.emplaceBack(e2.x, e2.y, r2), t2.emplaceBack(e2.x, e2.y, r2);
        }
        function Fu(t2) {
          for (const e2 of t2.sections)
            if (On(e2.text))
              return true;
          return false;
        }
        class Tu {
          constructor(t2) {
            this.layoutVertexArray = new sa(), this.indexArray = new ha(), this.programConfigurations = t2, this.segments = new ya(), this.dynamicLayoutVertexArray = new oa(), this.opacityVertexArray = new la(), this.placedSymbolArray = new Ki();
          }
          isEmpty() {
            return 0 === this.layoutVertexArray.length && 0 === this.indexArray.length && 0 === this.dynamicLayoutVertexArray.length && 0 === this.opacityVertexArray.length;
          }
          upload(t2, e2, r2, n2) {
            this.isEmpty() || (r2 && (this.layoutVertexBuffer = t2.createVertexBuffer(this.layoutVertexArray, el.members), this.indexBuffer = t2.createIndexBuffer(this.indexArray, e2), this.dynamicLayoutVertexBuffer = t2.createVertexBuffer(this.dynamicLayoutVertexArray, rl.members, true), this.opacityVertexBuffer = t2.createVertexBuffer(this.opacityVertexArray, Pu, true), this.opacityVertexBuffer.itemSize = 1), (r2 || n2) && this.programConfigurations.upload(t2));
          }
          destroy() {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.dynamicLayoutVertexBuffer.destroy(), this.opacityVertexBuffer.destroy());
          }
        }
        Mn("SymbolBuffers", Tu);
        class Lu {
          constructor(t2, e2, r2) {
            this.layoutVertexArray = new t2(), this.layoutAttributes = e2, this.indexArray = new r2(), this.segments = new ya(), this.collisionVertexArray = new ca();
          }
          upload(t2) {
            this.layoutVertexBuffer = t2.createVertexBuffer(this.layoutVertexArray, this.layoutAttributes), this.indexBuffer = t2.createIndexBuffer(this.indexArray), this.collisionVertexBuffer = t2.createVertexBuffer(this.collisionVertexArray, nl.members, true);
          }
          destroy() {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.segments.destroy(), this.collisionVertexBuffer.destroy());
          }
        }
        Mn("CollisionBuffers", Lu);
        class Du {
          constructor(e2) {
            this.collisionBoxArray = e2.collisionBoxArray, this.zoom = e2.zoom, this.overscaling = e2.overscaling, this.layers = e2.layers, this.layerIds = this.layers.map((t2) => t2.id), this.index = e2.index, this.pixelRatio = e2.pixelRatio, this.sourceLayerIndex = e2.sourceLayerIndex, this.hasPattern = false, this.hasRTLText = false, this.sortKeyRanges = [], this.collisionCircleArray = [], this.placementInvProjMatrix = ds([]), this.placementViewportMatrix = ds([]);
            const r2 = this.layers[0]._unevaluatedLayout._values;
            this.textSizeData = eu(this.zoom, r2["text-size"]), this.iconSizeData = eu(this.zoom, r2["icon-size"]);
            const n2 = this.layers[0].layout, i2 = n2.get("symbol-sort-key"), a2 = n2.get("symbol-z-order");
            this.canOverlap = "never" !== qu(n2, "text-overlap", "text-allow-overlap") || "never" !== qu(n2, "icon-overlap", "icon-allow-overlap") || n2.get("text-ignore-placement") || n2.get("icon-ignore-placement"), this.sortFeaturesByKey = "viewport-y" !== a2 && !i2.isConstant(), this.sortFeaturesByY = ("viewport-y" === a2 || "auto" === a2 && !this.sortFeaturesByKey) && this.canOverlap, "point" === n2.get("symbol-placement") && (this.writingModes = n2.get("text-writing-mode").map((e3) => t.WritingMode[e3])), this.stateDependentLayerIds = this.layers.filter((t2) => t2.isStateDependent()).map((t2) => t2.id), this.sourceID = e2.sourceID;
          }
          createArrays() {
            this.text = new Tu(new Ra(this.layers, this.zoom, (t2) => /^text/.test(t2))), this.icon = new Tu(new Ra(this.layers, this.zoom, (t2) => /^icon/.test(t2))), this.glyphOffsetArray = new Xi(), this.lineVertexArray = new Yi(), this.symbolInstances = new Ji();
          }
          calculateGlyphDependencies(t2, e2, r2, n2, i2) {
            for (let a2 = 0; a2 < t2.length; a2++)
              if (e2[t2.charCodeAt(a2)] = true, (r2 || n2) && i2) {
                const r3 = ol2[t2.charAt(a2)];
                r3 && (e2[r3.charCodeAt(0)] = true);
              }
          }
          populate(e2, r2, n2) {
            const i2 = this.layers[0], a2 = i2.layout, s2 = a2.get("text-font"), o2 = a2.get("text-field"), l2 = a2.get("icon-image"), u2 = ("constant" !== o2.value.kind || o2.value.value instanceof Dt && !o2.value.value.isEmpty() || o2.value.value.toString().length > 0) && ("constant" !== s2.value.kind || s2.value.value.length > 0), c3 = "constant" !== l2.value.kind || !!l2.value.value || Object.keys(l2.parameters).length > 0, h2 = a2.get("symbol-sort-key");
            if (this.features = [], !u2 && !c3)
              return;
            const p3 = r2.iconDependencies, f2 = r2.glyphDependencies, d2 = r2.availableImages, y3 = new Qn(this.zoom);
            for (const { feature: r3, id: o3, index: l3, sourceLayerIndex: m2 } of e2) {
              const e3 = i2._featureFilter.needGeometry, g2 = Ka(r3, e3);
              if (!i2._featureFilter.filter(y3, g2, n2))
                continue;
              let x2, v3;
              if (e3 || (g2.geometry = Za(r3)), u2) {
                const t2 = i2.getValueAndResolveTokens("text-field", g2, n2, d2), e4 = Dt.factory(t2);
                Fu(e4) && (this.hasRTLText = true), (!this.hasRTLText || "unavailable" === Yn() || this.hasRTLText && Wn.isParsed()) && (x2 = sl(e4, i2, g2));
              }
              if (c3) {
                const t2 = i2.getValueAndResolveTokens("icon-image", g2, n2, d2);
                v3 = t2 instanceof Rt ? t2 : Rt.fromString(t2);
              }
              if (!x2 && !v3)
                continue;
              const b2 = this.sortFeaturesByKey ? h2.evaluate(g2, {}, n2) : void 0;
              if (this.features.push({ id: o3, text: x2, icon: v3, index: l3, sourceLayerIndex: m2, geometry: g2.geometry, properties: r3.properties, type: Cu[r3.type], sortKey: b2 }), v3 && (p3[v3.name] = true), x2) {
                const e4 = s2.evaluate(g2, {}, n2).join(","), r4 = "viewport" !== a2.get("text-rotation-alignment") && "point" !== a2.get("symbol-placement");
                this.allowVerticalPlacement = this.writingModes && this.writingModes.indexOf(t.WritingMode.vertical) >= 0;
                for (const t2 of x2.sections)
                  if (t2.image)
                    p3[t2.image.name] = true;
                  else {
                    const n3 = En(x2.toString()), i3 = t2.fontStack || e4, a3 = f2[i3] = f2[i3] || {};
                    this.calculateGlyphDependencies(t2.text, a3, r4, this.allowVerticalPlacement, n3);
                  }
              }
            }
            "line" === a2.get("symbol-placement") && (this.features = function(t2) {
              const e3 = {}, r3 = {}, n3 = [];
              let i3 = 0;
              function a3(e4) {
                n3.push(t2[e4]), i3++;
              }
              function s3(t3, e4, i4) {
                const a4 = r3[t3];
                return delete r3[t3], r3[e4] = a4, n3[a4].geometry[0].pop(), n3[a4].geometry[0] = n3[a4].geometry[0].concat(i4[0]), a4;
              }
              function o3(t3, r4, i4) {
                const a4 = e3[r4];
                return delete e3[r4], e3[t3] = a4, n3[a4].geometry[0].shift(), n3[a4].geometry[0] = i4[0].concat(n3[a4].geometry[0]), a4;
              }
              function l3(t3, e4, r4) {
                const n4 = r4 ? e4[0][e4[0].length - 1] : e4[0][0];
                return `${t3}:${n4.x}:${n4.y}`;
              }
              for (let u3 = 0; u3 < t2.length; u3++) {
                const c4 = t2[u3], h3 = c4.geometry, p4 = c4.text ? c4.text.toString() : null;
                if (!p4) {
                  a3(u3);
                  continue;
                }
                const f3 = l3(p4, h3), d3 = l3(p4, h3, true);
                if (f3 in r3 && d3 in e3 && r3[f3] !== e3[d3]) {
                  const t3 = o3(f3, d3, h3), i4 = s3(f3, d3, n3[t3].geometry);
                  delete e3[f3], delete r3[d3], r3[l3(p4, n3[i4].geometry, true)] = i4, n3[t3].geometry = null;
                } else
                  f3 in r3 ? s3(f3, d3, h3) : d3 in e3 ? o3(f3, d3, h3) : (a3(u3), e3[f3] = i3 - 1, r3[d3] = i3 - 1);
              }
              return n3.filter((t3) => t3.geometry);
            }(this.features)), this.sortFeaturesByKey && this.features.sort((t2, e3) => t2.sortKey - e3.sortKey);
          }
          update(t2, e2, r2) {
            this.stateDependentLayers.length && (this.text.programConfigurations.updatePaintArrays(t2, e2, this.layers, r2), this.icon.programConfigurations.updatePaintArrays(t2, e2, this.layers, r2));
          }
          isEmpty() {
            return 0 === this.symbolInstances.length && !this.hasRTLText;
          }
          uploadPending() {
            return !this.uploaded || this.text.programConfigurations.needsUpload || this.icon.programConfigurations.needsUpload;
          }
          upload(t2) {
            !this.uploaded && this.hasDebugData() && (this.textCollisionBox.upload(t2), this.iconCollisionBox.upload(t2)), this.text.upload(t2, this.sortFeaturesByY, !this.uploaded, this.text.programConfigurations.needsUpload), this.icon.upload(t2, this.sortFeaturesByY, !this.uploaded, this.icon.programConfigurations.needsUpload), this.uploaded = true;
          }
          destroyDebugData() {
            this.textCollisionBox.destroy(), this.iconCollisionBox.destroy();
          }
          destroy() {
            this.text.destroy(), this.icon.destroy(), this.hasDebugData() && this.destroyDebugData();
          }
          addToLineVertexArray(t2, e2) {
            const r2 = this.lineVertexArray.length;
            if (void 0 !== t2.segment) {
              let r3 = t2.dist(e2[t2.segment + 1]), n2 = t2.dist(e2[t2.segment]);
              const i2 = {};
              for (let n3 = t2.segment + 1; n3 < e2.length; n3++)
                i2[n3] = { x: e2[n3].x, y: e2[n3].y, tileUnitDistanceFromAnchor: r3 }, n3 < e2.length - 1 && (r3 += e2[n3 + 1].dist(e2[n3]));
              for (let r4 = t2.segment || 0; r4 >= 0; r4--)
                i2[r4] = { x: e2[r4].x, y: e2[r4].y, tileUnitDistanceFromAnchor: n2 }, r4 > 0 && (n2 += e2[r4 - 1].dist(e2[r4]));
              for (let t3 = 0; t3 < e2.length; t3++) {
                const e3 = i2[t3];
                this.lineVertexArray.emplaceBack(e3.x, e3.y, e3.tileUnitDistanceFromAnchor);
              }
            }
            return { lineStartIndex: r2, lineLength: this.lineVertexArray.length - r2 };
          }
          addSymbols(e2, r2, n2, i2, a2, s2, o2, l2, u2, c3, h2, p3) {
            const f2 = e2.indexArray, d2 = e2.layoutVertexArray, y3 = e2.segments.prepareSegment(4 * r2.length, d2, f2, this.canOverlap ? s2.sortKey : void 0), m2 = this.glyphOffsetArray.length, g2 = y3.vertexLength, x2 = this.allowVerticalPlacement && o2 === t.WritingMode.vertical ? Math.PI / 2 : 0, v3 = s2.text && s2.text.sections;
            for (let t2 = 0; t2 < r2.length; t2++) {
              const { tl: i3, tr: a3, bl: o3, br: u3, tex: c4, pixelOffsetTL: h3, pixelOffsetBR: m3, minFontScaleX: g3, minFontScaleY: b2, glyphOffset: w2, isSDF: _2, sectionIndex: A3 } = r2[t2], k2 = y3.vertexLength, S2 = w2[1];
              Vu(d2, l2.x, l2.y, i3.x, S2 + i3.y, c4.x, c4.y, n2, _2, h3.x, h3.y, g3, b2), Vu(d2, l2.x, l2.y, a3.x, S2 + a3.y, c4.x + c4.w, c4.y, n2, _2, m3.x, h3.y, g3, b2), Vu(d2, l2.x, l2.y, o3.x, S2 + o3.y, c4.x, c4.y + c4.h, n2, _2, h3.x, m3.y, g3, b2), Vu(d2, l2.x, l2.y, u3.x, S2 + u3.y, c4.x + c4.w, c4.y + c4.h, n2, _2, m3.x, m3.y, g3, b2), Eu(e2.dynamicLayoutVertexArray, l2, x2), f2.emplaceBack(k2, k2 + 1, k2 + 2), f2.emplaceBack(k2 + 1, k2 + 2, k2 + 3), y3.vertexLength += 4, y3.primitiveLength += 2, this.glyphOffsetArray.emplaceBack(w2[0]), t2 !== r2.length - 1 && A3 === r2[t2 + 1].sectionIndex || e2.programConfigurations.populatePaintArrays(d2.length, s2, s2.index, {}, p3, v3 && v3[A3]);
            }
            e2.placedSymbolArray.emplaceBack(l2.x, l2.y, m2, this.glyphOffsetArray.length - m2, g2, u2, c3, l2.segment, n2 ? n2[0] : 0, n2 ? n2[1] : 0, i2[0], i2[1], o2, 0, false, 0, h2);
          }
          _addCollisionDebugVertex(t2, e2, r2, n2, i2, a2) {
            return e2.emplaceBack(0, 0), t2.emplaceBack(r2.x, r2.y, n2, i2, Math.round(a2.x), Math.round(a2.y));
          }
          addCollisionDebugVertices(t2, e2, r2, n2, i2, a2, s2) {
            const o2 = i2.segments.prepareSegment(4, i2.layoutVertexArray, i2.indexArray), l2 = o2.vertexLength, u2 = i2.layoutVertexArray, c3 = i2.collisionVertexArray, h2 = s2.anchorX, p3 = s2.anchorY;
            this._addCollisionDebugVertex(u2, c3, a2, h2, p3, new S(t2, e2)), this._addCollisionDebugVertex(u2, c3, a2, h2, p3, new S(r2, e2)), this._addCollisionDebugVertex(u2, c3, a2, h2, p3, new S(r2, n2)), this._addCollisionDebugVertex(u2, c3, a2, h2, p3, new S(t2, n2)), o2.vertexLength += 4;
            const f2 = i2.indexArray;
            f2.emplaceBack(l2, l2 + 1), f2.emplaceBack(l2 + 1, l2 + 2), f2.emplaceBack(l2 + 2, l2 + 3), f2.emplaceBack(l2 + 3, l2), o2.primitiveLength += 4;
          }
          addDebugCollisionBoxes(t2, e2, r2, n2) {
            for (let i2 = t2; i2 < e2; i2++) {
              const t3 = this.collisionBoxArray.get(i2);
              this.addCollisionDebugVertices(t3.x1, t3.y1, t3.x2, t3.y2, n2 ? this.textCollisionBox : this.iconCollisionBox, t3.anchorPoint, r2);
            }
          }
          generateCollisionDebugBuffers() {
            this.hasDebugData() && this.destroyDebugData(), this.textCollisionBox = new Lu(ua2, il.members, pa), this.iconCollisionBox = new Lu(ua2, il.members, pa);
            for (let t2 = 0; t2 < this.symbolInstances.length; t2++) {
              const e2 = this.symbolInstances.get(t2);
              this.addDebugCollisionBoxes(e2.textBoxStartIndex, e2.textBoxEndIndex, e2, true), this.addDebugCollisionBoxes(e2.verticalTextBoxStartIndex, e2.verticalTextBoxEndIndex, e2, true), this.addDebugCollisionBoxes(e2.iconBoxStartIndex, e2.iconBoxEndIndex, e2, false), this.addDebugCollisionBoxes(e2.verticalIconBoxStartIndex, e2.verticalIconBoxEndIndex, e2, false);
            }
          }
          _deserializeCollisionBoxesForSymbol(t2, e2, r2, n2, i2, a2, s2, o2, l2) {
            const u2 = {};
            for (let n3 = e2; n3 < r2; n3++) {
              const e3 = t2.get(n3);
              u2.textBox = { x1: e3.x1, y1: e3.y1, x2: e3.x2, y2: e3.y2, anchorPointX: e3.anchorPointX, anchorPointY: e3.anchorPointY }, u2.textFeatureIndex = e3.featureIndex;
              break;
            }
            for (let e3 = n2; e3 < i2; e3++) {
              const r3 = t2.get(e3);
              u2.verticalTextBox = { x1: r3.x1, y1: r3.y1, x2: r3.x2, y2: r3.y2, anchorPointX: r3.anchorPointX, anchorPointY: r3.anchorPointY }, u2.verticalTextFeatureIndex = r3.featureIndex;
              break;
            }
            for (let e3 = a2; e3 < s2; e3++) {
              const r3 = t2.get(e3);
              u2.iconBox = { x1: r3.x1, y1: r3.y1, x2: r3.x2, y2: r3.y2, anchorPointX: r3.anchorPointX, anchorPointY: r3.anchorPointY }, u2.iconFeatureIndex = r3.featureIndex;
              break;
            }
            for (let e3 = o2; e3 < l2; e3++) {
              const r3 = t2.get(e3);
              u2.verticalIconBox = { x1: r3.x1, y1: r3.y1, x2: r3.x2, y2: r3.y2, anchorPointX: r3.anchorPointX, anchorPointY: r3.anchorPointY }, u2.verticalIconFeatureIndex = r3.featureIndex;
              break;
            }
            return u2;
          }
          deserializeCollisionBoxes(t2) {
            this.collisionArrays = [];
            for (let e2 = 0; e2 < this.symbolInstances.length; e2++) {
              const r2 = this.symbolInstances.get(e2);
              this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t2, r2.textBoxStartIndex, r2.textBoxEndIndex, r2.verticalTextBoxStartIndex, r2.verticalTextBoxEndIndex, r2.iconBoxStartIndex, r2.iconBoxEndIndex, r2.verticalIconBoxStartIndex, r2.verticalIconBoxEndIndex));
            }
          }
          hasTextData() {
            return this.text.segments.get().length > 0;
          }
          hasIconData() {
            return this.icon.segments.get().length > 0;
          }
          hasDebugData() {
            return this.textCollisionBox && this.iconCollisionBox;
          }
          hasTextCollisionBoxData() {
            return this.hasDebugData() && this.textCollisionBox.segments.get().length > 0;
          }
          hasIconCollisionBoxData() {
            return this.hasDebugData() && this.iconCollisionBox.segments.get().length > 0;
          }
          addIndicesForPlacedSymbol(t2, e2) {
            const r2 = t2.placedSymbolArray.get(e2), n2 = r2.vertexStartIndex + 4 * r2.numGlyphs;
            for (let e3 = r2.vertexStartIndex; e3 < n2; e3 += 4)
              t2.indexArray.emplaceBack(e3, e3 + 1, e3 + 2), t2.indexArray.emplaceBack(e3 + 1, e3 + 2, e3 + 3);
          }
          getSortedSymbolIndexes(t2) {
            if (this.sortedAngle === t2 && void 0 !== this.symbolInstanceIndexes)
              return this.symbolInstanceIndexes;
            const e2 = Math.sin(t2), r2 = Math.cos(t2), n2 = [], i2 = [], a2 = [];
            for (let t3 = 0; t3 < this.symbolInstances.length; ++t3) {
              a2.push(t3);
              const s2 = this.symbolInstances.get(t3);
              n2.push(0 | Math.round(e2 * s2.anchorX + r2 * s2.anchorY)), i2.push(s2.featureIndex);
            }
            return a2.sort((t3, e3) => n2[t3] - n2[e3] || i2[e3] - i2[t3]), a2;
          }
          addToSortKeyRanges(t2, e2) {
            const r2 = this.sortKeyRanges[this.sortKeyRanges.length - 1];
            r2 && r2.sortKey === e2 ? r2.symbolInstanceEnd = t2 + 1 : this.sortKeyRanges.push({ sortKey: e2, symbolInstanceStart: t2, symbolInstanceEnd: t2 + 1 });
          }
          sortFeatures(t2) {
            if (this.sortFeaturesByY && this.sortedAngle !== t2 && !(this.text.segments.get().length > 1 || this.icon.segments.get().length > 1)) {
              this.symbolInstanceIndexes = this.getSortedSymbolIndexes(t2), this.sortedAngle = t2, this.text.indexArray.clear(), this.icon.indexArray.clear(), this.featureSortOrder = [];
              for (const t3 of this.symbolInstanceIndexes) {
                const e2 = this.symbolInstances.get(t3);
                this.featureSortOrder.push(e2.featureIndex), [e2.rightJustifiedTextSymbolIndex, e2.centerJustifiedTextSymbolIndex, e2.leftJustifiedTextSymbolIndex].forEach((t4, e3, r2) => {
                  t4 >= 0 && r2.indexOf(t4) === e3 && this.addIndicesForPlacedSymbol(this.text, t4);
                }), e2.verticalPlacedTextSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.text, e2.verticalPlacedTextSymbolIndex), e2.placedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, e2.placedIconSymbolIndex), e2.verticalPlacedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, e2.verticalPlacedIconSymbolIndex);
              }
              this.text.indexBuffer && this.text.indexBuffer.updateData(this.text.indexArray), this.icon.indexBuffer && this.icon.indexBuffer.updateData(this.icon.indexArray);
            }
          }
        }
        Mn("SymbolBucket", Du, { omit: ["layers", "collisionBoxArray", "features", "compareText"] }), Du.MAX_GLYPHS = 65535, Du.addDynamicAttributes = Eu;
        const $u = new fi({ "symbol-placement": new li(nt.layout_symbol["symbol-placement"]), "symbol-spacing": new li(nt.layout_symbol["symbol-spacing"]), "symbol-avoid-edges": new li(nt.layout_symbol["symbol-avoid-edges"]), "symbol-sort-key": new ui(nt.layout_symbol["symbol-sort-key"]), "symbol-z-order": new li(nt.layout_symbol["symbol-z-order"]), "icon-allow-overlap": new li(nt.layout_symbol["icon-allow-overlap"]), "icon-overlap": new li(nt.layout_symbol["icon-overlap"]), "icon-ignore-placement": new li(nt.layout_symbol["icon-ignore-placement"]), "icon-optional": new li(nt.layout_symbol["icon-optional"]), "icon-rotation-alignment": new li(nt.layout_symbol["icon-rotation-alignment"]), "icon-size": new ui(nt.layout_symbol["icon-size"]), "icon-text-fit": new li(nt.layout_symbol["icon-text-fit"]), "icon-text-fit-padding": new li(nt.layout_symbol["icon-text-fit-padding"]), "icon-image": new ui(nt.layout_symbol["icon-image"]), "icon-rotate": new ui(nt.layout_symbol["icon-rotate"]), "icon-padding": new ui(nt.layout_symbol["icon-padding"]), "icon-keep-upright": new li(nt.layout_symbol["icon-keep-upright"]), "icon-offset": new ui(nt.layout_symbol["icon-offset"]), "icon-anchor": new ui(nt.layout_symbol["icon-anchor"]), "icon-pitch-alignment": new li(nt.layout_symbol["icon-pitch-alignment"]), "text-pitch-alignment": new li(nt.layout_symbol["text-pitch-alignment"]), "text-rotation-alignment": new li(nt.layout_symbol["text-rotation-alignment"]), "text-field": new ui(nt.layout_symbol["text-field"]), "text-font": new ui(nt.layout_symbol["text-font"]), "text-size": new ui(nt.layout_symbol["text-size"]), "text-max-width": new ui(nt.layout_symbol["text-max-width"]), "text-line-height": new li(nt.layout_symbol["text-line-height"]), "text-letter-spacing": new ui(nt.layout_symbol["text-letter-spacing"]), "text-justify": new ui(nt.layout_symbol["text-justify"]), "text-radial-offset": new ui(nt.layout_symbol["text-radial-offset"]), "text-variable-anchor": new li(nt.layout_symbol["text-variable-anchor"]), "text-anchor": new ui(nt.layout_symbol["text-anchor"]), "text-max-angle": new li(nt.layout_symbol["text-max-angle"]), "text-writing-mode": new li(nt.layout_symbol["text-writing-mode"]), "text-rotate": new ui(nt.layout_symbol["text-rotate"]), "text-padding": new li(nt.layout_symbol["text-padding"]), "text-keep-upright": new li(nt.layout_symbol["text-keep-upright"]), "text-transform": new ui(nt.layout_symbol["text-transform"]), "text-offset": new ui(nt.layout_symbol["text-offset"]), "text-allow-overlap": new li(nt.layout_symbol["text-allow-overlap"]), "text-overlap": new li(nt.layout_symbol["text-overlap"]), "text-ignore-placement": new li(nt.layout_symbol["text-ignore-placement"]), "text-optional": new li(nt.layout_symbol["text-optional"]) });
        var Ru = { paint: new fi({ "icon-opacity": new ui(nt.paint_symbol["icon-opacity"]), "icon-color": new ui(nt.paint_symbol["icon-color"]), "icon-halo-color": new ui(nt.paint_symbol["icon-halo-color"]), "icon-halo-width": new ui(nt.paint_symbol["icon-halo-width"]), "icon-halo-blur": new ui(nt.paint_symbol["icon-halo-blur"]), "icon-translate": new li(nt.paint_symbol["icon-translate"]), "icon-translate-anchor": new li(nt.paint_symbol["icon-translate-anchor"]), "text-opacity": new ui(nt.paint_symbol["text-opacity"]), "text-color": new ui(nt.paint_symbol["text-color"], { runtimeType: yt, getOverride: (t2) => t2.textColor, hasOverride: (t2) => !!t2.textColor }), "text-halo-color": new ui(nt.paint_symbol["text-halo-color"]), "text-halo-width": new ui(nt.paint_symbol["text-halo-width"]), "text-halo-blur": new ui(nt.paint_symbol["text-halo-blur"]), "text-translate": new li(nt.paint_symbol["text-translate"]), "text-translate-anchor": new li(nt.paint_symbol["text-translate-anchor"]) }), layout: $u };
        class Ou {
          constructor(t2) {
            if (void 0 === t2.property.overrides)
              throw new Error("overrides must be provided to instantiate FormatSectionOverride class");
            this.type = t2.property.overrides ? t2.property.overrides.runtimeType : ht, this.defaultValue = t2;
          }
          evaluate(t2) {
            if (t2.formattedSection) {
              const e2 = this.defaultValue.property.overrides;
              if (e2 && e2.hasOverride(t2.formattedSection))
                return e2.getOverride(t2.formattedSection);
            }
            return t2.feature && t2.featureState ? this.defaultValue.evaluate(t2.feature, t2.featureState) : this.defaultValue.property.specification.default;
          }
          eachChild(t2) {
            this.defaultValue.isConstant() || t2(this.defaultValue.value._styleExpression.expression);
          }
          outputDefined() {
            return false;
          }
          serialize() {
            return null;
          }
        }
        Mn("FormatSectionOverride", Ou, { omit: ["defaultValue"] });
        class Uu extends yi {
          constructor(t2) {
            super(t2, Ru);
          }
          recalculate(t2, e2) {
            if (super.recalculate(t2, e2), "auto" === this.layout.get("icon-rotation-alignment") && (this.layout._values["icon-rotation-alignment"] = "point" !== this.layout.get("symbol-placement") ? "map" : "viewport"), "auto" === this.layout.get("text-rotation-alignment") && (this.layout._values["text-rotation-alignment"] = "point" !== this.layout.get("symbol-placement") ? "map" : "viewport"), "auto" === this.layout.get("text-pitch-alignment") && (this.layout._values["text-pitch-alignment"] = "map" === this.layout.get("text-rotation-alignment") ? "map" : "viewport"), "auto" === this.layout.get("icon-pitch-alignment") && (this.layout._values["icon-pitch-alignment"] = this.layout.get("icon-rotation-alignment")), "point" === this.layout.get("symbol-placement")) {
              const t3 = this.layout.get("text-writing-mode");
              if (t3) {
                const e3 = [];
                for (const r2 of t3)
                  e3.indexOf(r2) < 0 && e3.push(r2);
                this.layout._values["text-writing-mode"] = e3;
              } else
                this.layout._values["text-writing-mode"] = ["horizontal"];
            }
            this._setPaintOverrides();
          }
          getValueAndResolveTokens(t2, e2, r2, n2) {
            const i2 = this.layout.get(t2).evaluate(e2, {}, r2, n2), a2 = this._unevaluatedLayout._values[t2];
            return a2.isDataDriven() || Er(a2.value) || !i2 ? i2 : function(t3, e3) {
              return e3.replace(/{([^{}]+)}/g, (e4, r3) => r3 in t3 ? String(t3[r3]) : "");
            }(e2.properties, i2);
          }
          createBucket(t2) {
            return new Du(t2);
          }
          queryRadius() {
            return 0;
          }
          queryIntersectsFeature() {
            throw new Error("Should take a different path in FeatureIndex");
          }
          _setPaintOverrides() {
            for (const t2 of Ru.paint.overridableProperties) {
              if (!Uu.hasPaintOverride(this.layout, t2))
                continue;
              const e2 = this.paint.get(t2), r2 = new Ou(e2), n2 = new Vr(r2, e2.property.specification);
              let i2 = null;
              i2 = "constant" === e2.value.kind || "source" === e2.value.kind ? new Tr("source", n2) : new Lr("composite", n2, e2.value.zoomStops), this.paint._values[t2] = new si(e2.property, i2, e2.parameters);
            }
          }
          _handleOverridablePaintPropertyUpdate(t2, e2, r2) {
            return !(!this.layout || e2.isDataDriven() || r2.isDataDriven()) && Uu.hasPaintOverride(this.layout, t2);
          }
          static hasPaintOverride(t2, e2) {
            const r2 = t2.get("text-field"), n2 = Ru.paint.properties[e2];
            let i2 = false;
            const a2 = (t3) => {
              for (const e3 of t3)
                if (n2.overrides && n2.overrides.hasOverride(e3))
                  return void (i2 = true);
            };
            if ("constant" === r2.value.kind && r2.value.value instanceof Dt)
              a2(r2.value.value.sections);
            else if ("source" === r2.value.kind) {
              const t3 = (e4) => {
                i2 || (e4 instanceof Nt && qt(e4.value) === vt ? a2(e4.value.sections) : e4 instanceof cr ? a2(e4.sections) : e4.eachChild(t3));
              }, e3 = r2.value;
              e3._styleExpression && t3(e3._styleExpression.expression);
            }
            return i2;
          }
        }
        function qu(t2, e2, r2) {
          let n2 = "never";
          const i2 = t2.get(e2);
          return i2 ? n2 = i2 : t2.get(r2) && (n2 = "always"), n2;
        }
        var ju = { paint: new fi({ "background-color": new li(nt.paint_background["background-color"]), "background-pattern": new hi(nt.paint_background["background-pattern"]), "background-opacity": new li(nt.paint_background["background-opacity"]) }) }, Nu = { paint: new fi({ "raster-opacity": new li(nt.paint_raster["raster-opacity"]), "raster-hue-rotate": new li(nt.paint_raster["raster-hue-rotate"]), "raster-brightness-min": new li(nt.paint_raster["raster-brightness-min"]), "raster-brightness-max": new li(nt.paint_raster["raster-brightness-max"]), "raster-saturation": new li(nt.paint_raster["raster-saturation"]), "raster-contrast": new li(nt.paint_raster["raster-contrast"]), "raster-resampling": new li(nt.paint_raster["raster-resampling"]), "raster-fade-duration": new li(nt.paint_raster["raster-fade-duration"]) }) };
        class Zu extends yi {
          constructor(t2) {
            super(t2, {}), this.onAdd = (t3) => {
              this.implementation.onAdd && this.implementation.onAdd(t3, t3.painter.context.gl);
            }, this.onRemove = (t3) => {
              this.implementation.onRemove && this.implementation.onRemove(t3, t3.painter.context.gl);
            }, this.implementation = t2;
          }
          is3D() {
            return "3d" === this.implementation.renderingMode;
          }
          hasOffscreenPass() {
            return void 0 !== this.implementation.prerender;
          }
          recalculate() {
          }
          updateTransitions() {
          }
          hasTransition() {
            return false;
          }
          serialize() {
            throw new Error("Custom layers cannot be serialized");
          }
        }
        const Ku = { circle: class extends yi {
          constructor(t2) {
            super(t2, cs);
          }
          createBucket(t2) {
            return new Ja(t2);
          }
          queryRadius(t2) {
            const e2 = t2;
            return ss("circle-radius", this, e2) + ss("circle-stroke-width", this, e2) + os(this.paint.get("circle-translate"));
          }
          queryIntersectsFeature(t2, e2, r2, n2, i2, a2, s2, o2) {
            const l2 = ls(t2, this.paint.get("circle-translate"), this.paint.get("circle-translate-anchor"), a2.angle, s2), u2 = this.paint.get("circle-radius").evaluate(e2, r2) + this.paint.get("circle-stroke-width").evaluate(e2, r2), c3 = "map" === this.paint.get("circle-pitch-alignment"), h2 = c3 ? l2 : function(t3, e3) {
              return t3.map((t4) => _s(t4, e3));
            }(l2, o2), p3 = c3 ? u2 * s2 : u2;
            for (const t3 of n2)
              for (const e3 of t3) {
                const t4 = c3 ? e3 : _s(e3, o2);
                let r3 = p3;
                const n3 = bs([], [e3.x, e3.y, 0, 1], o2);
                if ("viewport" === this.paint.get("circle-pitch-scale") && "map" === this.paint.get("circle-pitch-alignment") ? r3 *= n3[3] / a2.cameraToCenterDistance : "map" === this.paint.get("circle-pitch-scale") && "viewport" === this.paint.get("circle-pitch-alignment") && (r3 *= a2.cameraToCenterDistance / n3[3]), Ya(h2, t4, r3))
                  return true;
              }
            return false;
          }
        }, heatmap: class extends yi {
          constructor(t2) {
            super(t2, ks), this._updateColorRamp();
          }
          createBucket(t2) {
            return new As(t2);
          }
          _handleSpecialPaintPropertyUpdate(t2) {
            "heatmap-color" === t2 && this._updateColorRamp();
          }
          _updateColorRamp() {
            this.colorRamp = Cs({ expression: this._transitionablePaint._values["heatmap-color"].value.expression, evaluationKey: "heatmapDensity", image: this.colorRamp }), this.colorRampTexture = null;
          }
          resize() {
            this.heatmapFbo && (this.heatmapFbo.destroy(), this.heatmapFbo = null);
          }
          queryRadius() {
            return 0;
          }
          queryIntersectsFeature() {
            return false;
          }
          hasOffscreenPass() {
            return 0 !== this.paint.get("heatmap-opacity") && "none" !== this.visibility;
          }
        }, hillshade: class extends yi {
          constructor(t2) {
            super(t2, Ps);
          }
          hasOffscreenPass() {
            return 0 !== this.paint.get("hillshade-exaggeration") && "none" !== this.visibility;
          }
        }, fill: class extends yi {
          constructor(t2) {
            super(t2, xo);
          }
          recalculate(t2, e2) {
            super.recalculate(t2, e2);
            const r2 = this.paint._values["fill-outline-color"];
            "constant" === r2.value.kind && void 0 === r2.value.value && (this.paint._values["fill-outline-color"] = this.paint._values["fill-color"]);
          }
          createBucket(t2) {
            return new mo(t2);
          }
          queryRadius() {
            return os(this.paint.get("fill-translate"));
          }
          queryIntersectsFeature(t2, e2, r2, n2, i2, a2, s2) {
            return Ha(ls(t2, this.paint.get("fill-translate"), this.paint.get("fill-translate-anchor"), a2.angle, s2), n2);
          }
          isTileClipped() {
            return true;
          }
        }, "fill-extrusion": class extends yi {
          constructor(t2) {
            super(t2, Oo);
          }
          createBucket(t2) {
            return new Do(t2);
          }
          queryRadius() {
            return os(this.paint.get("fill-extrusion-translate"));
          }
          is3D() {
            return true;
          }
          queryIntersectsFeature(t2, e2, r2, n2, i2, a2, s2, o2) {
            const l2 = ls(t2, this.paint.get("fill-extrusion-translate"), this.paint.get("fill-extrusion-translate-anchor"), a2.angle, s2), u2 = this.paint.get("fill-extrusion-height").evaluate(e2, r2), c3 = this.paint.get("fill-extrusion-base").evaluate(e2, r2), h2 = function(t3, e3, r3, n3) {
              const i3 = [];
              for (const r4 of t3) {
                const t4 = [r4.x, r4.y, 0, 1];
                bs(t4, t4, e3), i3.push(new S(t4[0] / t4[3], t4[1] / t4[3]));
              }
              return i3;
            }(l2, o2), p3 = function(t3, e3, r3, n3) {
              const i3 = [], a3 = [], s3 = n3[8] * e3, o3 = n3[9] * e3, l3 = n3[10] * e3, u3 = n3[11] * e3, c4 = n3[8] * r3, h3 = n3[9] * r3, p4 = n3[10] * r3, f2 = n3[11] * r3;
              for (const e4 of t3) {
                const t4 = [], r4 = [];
                for (const i4 of e4) {
                  const e5 = i4.x, a4 = i4.y, d2 = n3[0] * e5 + n3[4] * a4 + n3[12], y3 = n3[1] * e5 + n3[5] * a4 + n3[13], m2 = n3[2] * e5 + n3[6] * a4 + n3[14], g2 = n3[3] * e5 + n3[7] * a4 + n3[15], x2 = m2 + l3, v3 = g2 + u3, b2 = d2 + c4, w2 = y3 + h3, _2 = m2 + p4, A3 = g2 + f2, k2 = new S((d2 + s3) / v3, (y3 + o3) / v3);
                  k2.z = x2 / v3, t4.push(k2);
                  const I3 = new S(b2 / A3, w2 / A3);
                  I3.z = _2 / A3, r4.push(I3);
                }
                i3.push(t4), a3.push(r4);
              }
              return [i3, a3];
            }(n2, c3, u2, o2);
            return function(t3, e3, r3) {
              let n3 = 1 / 0;
              Ha(r3, e3) && (n3 = qo(r3, e3[0]));
              for (let i3 = 0; i3 < e3.length; i3++) {
                const a3 = e3[i3], s3 = t3[i3];
                for (let t4 = 0; t4 < a3.length - 1; t4++) {
                  const e4 = a3[t4], i4 = [e4, a3[t4 + 1], s3[t4 + 1], s3[t4], e4];
                  Xa(r3, i4) && (n3 = Math.min(n3, qo(r3, i4)));
                }
              }
              return n3 !== 1 / 0 && n3;
            }(p3[0], p3[1], h2);
          }
        }, line: class extends yi {
          constructor(t2) {
            super(t2, Wo), this.gradientVersion = 0;
          }
          _handleSpecialPaintPropertyUpdate(t2) {
            "line-gradient" === t2 && (this.stepInterpolant = this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof ke, this.gradientVersion = (this.gradientVersion + 1) % Number.MAX_SAFE_INTEGER);
          }
          gradientExpression() {
            return this._transitionablePaint._values["line-gradient"].value.expression;
          }
          recalculate(t2, e2) {
            super.recalculate(t2, e2), this.paint._values["line-floorwidth"] = Qo.possiblyEvaluate(this._transitioningPaint._values["line-width"].value, t2);
          }
          createBucket(t2) {
            return new Yo(t2);
          }
          queryRadius(t2) {
            const e2 = t2, r2 = tl(ss("line-width", this, e2), ss("line-gap-width", this, e2)), n2 = ss("line-offset", this, e2);
            return r2 / 2 + Math.abs(n2) + os(this.paint.get("line-translate"));
          }
          queryIntersectsFeature(t2, e2, r2, n2, i2, a2, s2) {
            const o2 = ls(t2, this.paint.get("line-translate"), this.paint.get("line-translate-anchor"), a2.angle, s2), l2 = s2 / 2 * tl(this.paint.get("line-width").evaluate(e2, r2), this.paint.get("line-gap-width").evaluate(e2, r2)), u2 = this.paint.get("line-offset").evaluate(e2, r2);
            return u2 && (n2 = function(t3, e3) {
              const r3 = [];
              for (let n3 = 0; n3 < t3.length; n3++) {
                const i3 = t3[n3], a3 = [];
                for (let t4 = 0; t4 < i3.length; t4++) {
                  const r4 = i3[t4 - 1], n4 = i3[t4], s3 = i3[t4 + 1], o3 = 0 === t4 ? new S(0, 0) : n4.sub(r4)._unit()._perp(), l3 = t4 === i3.length - 1 ? new S(0, 0) : s3.sub(n4)._unit()._perp(), u3 = o3._add(l3)._unit(), c3 = u3.x * l3.x + u3.y * l3.y;
                  0 !== c3 && u3._mult(1 / c3), a3.push(u3._mult(e3)._add(n4));
                }
                r3.push(a3);
              }
              return r3;
            }(n2, u2 * s2)), function(t3, e3, r3) {
              for (let n3 = 0; n3 < e3.length; n3++) {
                const i3 = e3[n3];
                if (t3.length >= 3) {
                  for (let e4 = 0; e4 < i3.length; e4++)
                    if (is(t3, i3[e4]))
                      return true;
                }
                if (Wa(t3, i3, r3))
                  return true;
              }
              return false;
            }(o2, n2, l2);
          }
          isTileClipped() {
            return true;
          }
        }, symbol: Uu, background: class extends yi {
          constructor(t2) {
            super(t2, ju);
          }
        }, raster: class extends yi {
          constructor(t2) {
            super(t2, Nu);
          }
        } };
        class Gu {
          constructor(t2) {
            this._callback = t2, this._triggered = false, "undefined" != typeof MessageChannel && (this._channel = new MessageChannel(), this._channel.port2.onmessage = () => {
              this._triggered = false, this._callback();
            });
          }
          trigger() {
            this._triggered || (this._triggered = true, this._channel ? this._channel.port1.postMessage(true) : setTimeout(() => {
              this._triggered = false, this._callback();
            }, 0));
          }
          remove() {
            delete this._channel, this._callback = () => {
            };
          }
        }
        const Ju = 63710088e-1;
        class Xu {
          constructor(t2, e2) {
            if (isNaN(t2) || isNaN(e2))
              throw new Error(`Invalid LngLat object: (${t2}, ${e2})`);
            if (this.lng = +t2, this.lat = +e2, this.lat > 90 || this.lat < -90)
              throw new Error("Invalid LngLat latitude value: must be between -90 and 90");
          }
          wrap() {
            return new Xu(s(this.lng, -180, 180), this.lat);
          }
          toArray() {
            return [this.lng, this.lat];
          }
          toString() {
            return `LngLat(${this.lng}, ${this.lat})`;
          }
          distanceTo(t2) {
            const e2 = Math.PI / 180, r2 = this.lat * e2, n2 = t2.lat * e2, i2 = Math.sin(r2) * Math.sin(n2) + Math.cos(r2) * Math.cos(n2) * Math.cos((t2.lng - this.lng) * e2);
            return Ju * Math.acos(Math.min(i2, 1));
          }
          toBounds(t2 = 0) {
            const e2 = 360 * t2 / 40075017, r2 = e2 / Math.cos(Math.PI / 180 * this.lat);
            return new Yu(new Xu(this.lng - r2, this.lat - e2), new Xu(this.lng + r2, this.lat + e2));
          }
          static convert(t2) {
            if (t2 instanceof Xu)
              return t2;
            if (Array.isArray(t2) && (2 === t2.length || 3 === t2.length))
              return new Xu(Number(t2[0]), Number(t2[1]));
            if (!Array.isArray(t2) && "object" == typeof t2 && null !== t2)
              return new Xu(Number("lng" in t2 ? t2.lng : t2.lon), Number(t2.lat));
            throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]");
          }
        }
        class Yu {
          constructor(t2, e2) {
            t2 && (e2 ? this.setSouthWest(t2).setNorthEast(e2) : 4 === t2.length ? this.setSouthWest([t2[0], t2[1]]).setNorthEast([t2[2], t2[3]]) : this.setSouthWest(t2[0]).setNorthEast(t2[1]));
          }
          setNorthEast(t2) {
            return this._ne = t2 instanceof Xu ? new Xu(t2.lng, t2.lat) : Xu.convert(t2), this;
          }
          setSouthWest(t2) {
            return this._sw = t2 instanceof Xu ? new Xu(t2.lng, t2.lat) : Xu.convert(t2), this;
          }
          extend(t2) {
            const e2 = this._sw, r2 = this._ne;
            let n2, i2;
            if (t2 instanceof Xu)
              n2 = t2, i2 = t2;
            else {
              if (!(t2 instanceof Yu))
                return Array.isArray(t2) ? 4 === t2.length || t2.every(Array.isArray) ? this.extend(Yu.convert(t2)) : this.extend(Xu.convert(t2)) : this;
              if (n2 = t2._sw, i2 = t2._ne, !n2 || !i2)
                return this;
            }
            return e2 || r2 ? (e2.lng = Math.min(n2.lng, e2.lng), e2.lat = Math.min(n2.lat, e2.lat), r2.lng = Math.max(i2.lng, r2.lng), r2.lat = Math.max(i2.lat, r2.lat)) : (this._sw = new Xu(n2.lng, n2.lat), this._ne = new Xu(i2.lng, i2.lat)), this;
          }
          getCenter() {
            return new Xu((this._sw.lng + this._ne.lng) / 2, (this._sw.lat + this._ne.lat) / 2);
          }
          getSouthWest() {
            return this._sw;
          }
          getNorthEast() {
            return this._ne;
          }
          getNorthWest() {
            return new Xu(this.getWest(), this.getNorth());
          }
          getSouthEast() {
            return new Xu(this.getEast(), this.getSouth());
          }
          getWest() {
            return this._sw.lng;
          }
          getSouth() {
            return this._sw.lat;
          }
          getEast() {
            return this._ne.lng;
          }
          getNorth() {
            return this._ne.lat;
          }
          toArray() {
            return [this._sw.toArray(), this._ne.toArray()];
          }
          toString() {
            return `LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`;
          }
          isEmpty() {
            return !(this._sw && this._ne);
          }
          contains(t2) {
            const { lng: e2, lat: r2 } = Xu.convert(t2);
            let n2 = this._sw.lng <= e2 && e2 <= this._ne.lng;
            return this._sw.lng > this._ne.lng && (n2 = this._sw.lng >= e2 && e2 >= this._ne.lng), this._sw.lat <= r2 && r2 <= this._ne.lat && n2;
          }
          static convert(t2) {
            return t2 instanceof Yu ? t2 : t2 ? new Yu(t2) : t2;
          }
        }
        const Hu = 2 * Math.PI * Ju;
        function Wu(t2) {
          return Hu * Math.cos(t2 * Math.PI / 180);
        }
        function Qu(t2) {
          return (180 + t2) / 360;
        }
        function tc(t2) {
          return (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + t2 * Math.PI / 360))) / 360;
        }
        function ec(t2, e2) {
          return t2 / Wu(e2);
        }
        function rc(t2) {
          return 360 / Math.PI * Math.atan(Math.exp((180 - 360 * t2) * Math.PI / 180)) - 90;
        }
        class nc {
          constructor(t2, e2, r2 = 0) {
            this.x = +t2, this.y = +e2, this.z = +r2;
          }
          static fromLngLat(t2, e2 = 0) {
            const r2 = Xu.convert(t2);
            return new nc(Qu(r2.lng), tc(r2.lat), ec(e2, r2.lat));
          }
          toLngLat() {
            return new Xu(360 * this.x - 180, rc(this.y));
          }
          toAltitude() {
            return this.z * Wu(rc(this.y));
          }
          meterInMercatorCoordinateUnits() {
            return 1 / Hu * (t2 = rc(this.y), 1 / Math.cos(t2 * Math.PI / 180));
            var t2;
          }
        }
        function ic(t2, e2, r2) {
          var n2 = 2 * Math.PI * 6378137 / 256 / Math.pow(2, r2);
          return [t2 * n2 - 2 * Math.PI * 6378137 / 2, e2 * n2 - 2 * Math.PI * 6378137 / 2];
        }
        class ac {
          constructor(t2, e2, r2) {
            if (t2 < 0 || t2 > 25 || r2 < 0 || r2 >= Math.pow(2, t2) || e2 < 0 || e2 >= Math.pow(2, t2))
              throw new Error(`x=${e2}, y=${r2}, z=${t2} outside of bounds. 0<=x<${Math.pow(2, t2)}, 0<=y<${Math.pow(2, t2)} 0<=z<=25 `);
            this.z = t2, this.x = e2, this.y = r2, this.key = lc(0, t2, t2, e2, r2);
          }
          equals(t2) {
            return this.z === t2.z && this.x === t2.x && this.y === t2.y;
          }
          url(t2, e2, r2) {
            const n2 = (a2 = this.y, s2 = this.z, o2 = ic(256 * (i2 = this.x), 256 * (a2 = Math.pow(2, s2) - a2 - 1), s2), l2 = ic(256 * (i2 + 1), 256 * (a2 + 1), s2), o2[0] + "," + o2[1] + "," + l2[0] + "," + l2[1]);
            var i2, a2, s2, o2, l2;
            const u2 = function(t3, e3, r3) {
              let n3, i3 = "";
              for (let a3 = t3; a3 > 0; a3--)
                n3 = 1 << a3 - 1, i3 += (e3 & n3 ? 1 : 0) + (r3 & n3 ? 2 : 0);
              return i3;
            }(this.z, this.x, this.y);
            return t2[(this.x + this.y) % t2.length].replace(/{prefix}/g, (this.x % 16).toString(16) + (this.y % 16).toString(16)).replace(/{z}/g, String(this.z)).replace(/{x}/g, String(this.x)).replace(/{y}/g, String("tms" === r2 ? Math.pow(2, this.z) - this.y - 1 : this.y)).replace(/{ratio}/g, e2 > 1 ? "@2x" : "").replace(/{quadkey}/g, u2).replace(/{bbox-epsg-3857}/g, n2);
          }
          isChildOf(t2) {
            const e2 = this.z - t2.z;
            return e2 > 0 && t2.x === this.x >> e2 && t2.y === this.y >> e2;
          }
          getTilePoint(t2) {
            const e2 = Math.pow(2, this.z);
            return new S((t2.x * e2 - this.x) * qa, (t2.y * e2 - this.y) * qa);
          }
          toString() {
            return `${this.z}/${this.x}/${this.y}`;
          }
        }
        class sc {
          constructor(t2, e2) {
            this.wrap = t2, this.canonical = e2, this.key = lc(t2, e2.z, e2.z, e2.x, e2.y);
          }
        }
        class oc {
          constructor(t2, e2, r2, n2, i2) {
            if (t2 < r2)
              throw new Error(`overscaledZ should be >= z; overscaledZ = ${t2}; z = ${r2}`);
            this.overscaledZ = t2, this.wrap = e2, this.canonical = new ac(r2, +n2, +i2), this.key = lc(e2, t2, r2, n2, i2);
          }
          clone() {
            return new oc(this.overscaledZ, this.wrap, this.canonical.z, this.canonical.x, this.canonical.y);
          }
          equals(t2) {
            return this.overscaledZ === t2.overscaledZ && this.wrap === t2.wrap && this.canonical.equals(t2.canonical);
          }
          scaledTo(t2) {
            if (t2 > this.overscaledZ)
              throw new Error(`targetZ > this.overscaledZ; targetZ = ${t2}; overscaledZ = ${this.overscaledZ}`);
            const e2 = this.canonical.z - t2;
            return t2 > this.canonical.z ? new oc(t2, this.wrap, this.canonical.z, this.canonical.x, this.canonical.y) : new oc(t2, this.wrap, t2, this.canonical.x >> e2, this.canonical.y >> e2);
          }
          calculateScaledKey(t2, e2) {
            if (t2 > this.overscaledZ)
              throw new Error(`targetZ > this.overscaledZ; targetZ = ${t2}; overscaledZ = ${this.overscaledZ}`);
            const r2 = this.canonical.z - t2;
            return t2 > this.canonical.z ? lc(this.wrap * +e2, t2, this.canonical.z, this.canonical.x, this.canonical.y) : lc(this.wrap * +e2, t2, t2, this.canonical.x >> r2, this.canonical.y >> r2);
          }
          isChildOf(t2) {
            if (t2.wrap !== this.wrap)
              return false;
            const e2 = this.canonical.z - t2.canonical.z;
            return 0 === t2.overscaledZ || t2.overscaledZ < this.overscaledZ && t2.canonical.x === this.canonical.x >> e2 && t2.canonical.y === this.canonical.y >> e2;
          }
          children(t2) {
            if (this.overscaledZ >= t2)
              return [new oc(this.overscaledZ + 1, this.wrap, this.canonical.z, this.canonical.x, this.canonical.y)];
            const e2 = this.canonical.z + 1, r2 = 2 * this.canonical.x, n2 = 2 * this.canonical.y;
            return [new oc(e2, this.wrap, e2, r2, n2), new oc(e2, this.wrap, e2, r2 + 1, n2), new oc(e2, this.wrap, e2, r2, n2 + 1), new oc(e2, this.wrap, e2, r2 + 1, n2 + 1)];
          }
          isLessThan(t2) {
            return this.wrap < t2.wrap || !(this.wrap > t2.wrap) && (this.overscaledZ < t2.overscaledZ || !(this.overscaledZ > t2.overscaledZ) && (this.canonical.x < t2.canonical.x || !(this.canonical.x > t2.canonical.x) && this.canonical.y < t2.canonical.y));
          }
          wrapped() {
            return new oc(this.overscaledZ, 0, this.canonical.z, this.canonical.x, this.canonical.y);
          }
          unwrapTo(t2) {
            return new oc(this.overscaledZ, t2, this.canonical.z, this.canonical.x, this.canonical.y);
          }
          overscaleFactor() {
            return Math.pow(2, this.overscaledZ - this.canonical.z);
          }
          toUnwrapped() {
            return new sc(this.wrap, this.canonical);
          }
          toString() {
            return `${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`;
          }
          getTilePoint(t2) {
            return this.canonical.getTilePoint(new nc(t2.x - this.wrap, t2.y));
          }
        }
        function lc(t2, e2, r2, n2, i2) {
          (t2 *= 2) < 0 && (t2 = -1 * t2 - 1);
          const a2 = 1 << r2;
          return (a2 * a2 * t2 + a2 * i2 + n2).toString(36) + r2.toString(36) + e2.toString(36);
        }
        Mn("CanonicalTileID", ac), Mn("OverscaledTileID", oc, { omit: ["posMatrix"] });
        class uc {
          constructor(t2, e2, r2) {
            if (this.uid = t2, e2.height !== e2.width)
              throw new RangeError("DEM tiles must be square");
            if (r2 && "mapbox" !== r2 && "terrarium" !== r2)
              return void d(`"${r2}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);
            this.stride = e2.height;
            const n2 = this.dim = e2.height - 2;
            this.data = new Uint32Array(e2.data.buffer), this.encoding = r2 || "mapbox";
            for (let t3 = 0; t3 < n2; t3++)
              this.data[this._idx(-1, t3)] = this.data[this._idx(0, t3)], this.data[this._idx(n2, t3)] = this.data[this._idx(n2 - 1, t3)], this.data[this._idx(t3, -1)] = this.data[this._idx(t3, 0)], this.data[this._idx(t3, n2)] = this.data[this._idx(t3, n2 - 1)];
            this.data[this._idx(-1, -1)] = this.data[this._idx(0, 0)], this.data[this._idx(n2, -1)] = this.data[this._idx(n2 - 1, 0)], this.data[this._idx(-1, n2)] = this.data[this._idx(0, n2 - 1)], this.data[this._idx(n2, n2)] = this.data[this._idx(n2 - 1, n2 - 1)], this.min = Number.MAX_SAFE_INTEGER, this.max = Number.MIN_SAFE_INTEGER;
            for (let t3 = 0; t3 < n2; t3++)
              for (let e3 = 0; e3 < n2; e3++) {
                const r3 = this.get(t3, e3);
                r3 > this.max && (this.max = r3), r3 < this.min && (this.min = r3);
              }
          }
          get(t2, e2) {
            const r2 = new Uint8Array(this.data.buffer), n2 = 4 * this._idx(t2, e2);
            return ("terrarium" === this.encoding ? this._unpackTerrarium : this._unpackMapbox)(r2[n2], r2[n2 + 1], r2[n2 + 2]);
          }
          getUnpackVector() {
            return "terrarium" === this.encoding ? [256, 1, 1 / 256, 32768] : [6553.6, 25.6, 0.1, 1e4];
          }
          _idx(t2, e2) {
            if (t2 < -1 || t2 >= this.dim + 1 || e2 < -1 || e2 >= this.dim + 1)
              throw new RangeError("out of range source coordinates for DEM data");
            return (e2 + 1) * this.stride + (t2 + 1);
          }
          _unpackMapbox(t2, e2, r2) {
            return (256 * t2 * 256 + 256 * e2 + r2) / 10 - 1e4;
          }
          _unpackTerrarium(t2, e2, r2) {
            return 256 * t2 + e2 + r2 / 256 - 32768;
          }
          getPixels() {
            return new Bs({ width: this.stride, height: this.stride }, new Uint8Array(this.data.buffer));
          }
          backfillBorder(t2, e2, r2) {
            if (this.dim !== t2.dim)
              throw new Error("dem dimension mismatch");
            let n2 = e2 * this.dim, i2 = e2 * this.dim + this.dim, a2 = r2 * this.dim, s2 = r2 * this.dim + this.dim;
            switch (e2) {
              case -1:
                n2 = i2 - 1;
                break;
              case 1:
                i2 = n2 + 1;
            }
            switch (r2) {
              case -1:
                a2 = s2 - 1;
                break;
              case 1:
                s2 = a2 + 1;
            }
            const o2 = -e2 * this.dim, l2 = -r2 * this.dim;
            for (let e3 = a2; e3 < s2; e3++)
              for (let r3 = n2; r3 < i2; r3++)
                this.data[this._idx(r3, e3)] = t2.data[this._idx(r3 + o2, e3 + l2)];
          }
        }
        Mn("DEMData", uc);
        class cc {
          constructor(t2) {
            this._stringToNumber = {}, this._numberToString = [];
            for (let e2 = 0; e2 < t2.length; e2++) {
              const r2 = t2[e2];
              this._stringToNumber[r2] = e2, this._numberToString[e2] = r2;
            }
          }
          encode(t2) {
            return this._stringToNumber[t2];
          }
          decode(t2) {
            if (t2 >= this._numberToString.length)
              throw new Error(`Out of bounds. Index requested n=${t2} can't be >= this._numberToString.length ${this._numberToString.length}`);
            return this._numberToString[t2];
          }
        }
        class hc {
          constructor(t2, e2, r2, n2, i2) {
            this.type = "Feature", this._vectorTileFeature = t2, t2._z = e2, t2._x = r2, t2._y = n2, this.properties = t2.properties, this.id = i2;
          }
          get geometry() {
            return void 0 === this._geometry && (this._geometry = this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x, this._vectorTileFeature._y, this._vectorTileFeature._z).geometry), this._geometry;
          }
          set geometry(t2) {
            this._geometry = t2;
          }
          toJSON() {
            const t2 = { geometry: this.geometry };
            for (const e2 in this)
              "_geometry" !== e2 && "_vectorTileFeature" !== e2 && (t2[e2] = this[e2]);
            return t2;
          }
        }
        class pc {
          constructor(t2, e2) {
            this.tileID = t2, this.x = t2.canonical.x, this.y = t2.canonical.y, this.z = t2.canonical.z, this.grid = new Sn(qa, 16, 0), this.grid3D = new Sn(qa, 16, 0), this.featureIndexArray = new Wi(), this.promoteId = e2;
          }
          insert(t2, e2, r2, n2, i2, a2) {
            const s2 = this.featureIndexArray.length;
            this.featureIndexArray.emplaceBack(r2, n2, i2);
            const o2 = a2 ? this.grid3D : this.grid;
            for (let t3 = 0; t3 < e2.length; t3++) {
              const r3 = e2[t3], n3 = [1 / 0, 1 / 0, -1 / 0, -1 / 0];
              for (let t4 = 0; t4 < r3.length; t4++) {
                const e3 = r3[t4];
                n3[0] = Math.min(n3[0], e3.x), n3[1] = Math.min(n3[1], e3.y), n3[2] = Math.max(n3[2], e3.x), n3[3] = Math.max(n3[3], e3.y);
              }
              n3[0] < qa && n3[1] < qa && n3[2] >= 0 && n3[3] >= 0 && o2.insert(s2, n3[0], n3[1], n3[2], n3[3]);
            }
          }
          loadVTLayers() {
            return this.vtLayers || (this.vtLayers = new _o.VectorTile(new ul(this.rawTileData)).layers, this.sourceLayerCoder = new cc(this.vtLayers ? Object.keys(this.vtLayers).sort() : ["_geojsonTileLayer"])), this.vtLayers;
          }
          query(t2, e2, r2, n2) {
            this.loadVTLayers();
            const i2 = t2.params || {}, a2 = qa / t2.tileSize / t2.scale, s2 = Jr(i2.filter), o2 = t2.queryGeometry, l2 = t2.queryPadding * a2, u2 = dc(o2), c3 = this.grid.query(u2.minX - l2, u2.minY - l2, u2.maxX + l2, u2.maxY + l2), h2 = dc(t2.cameraQueryGeometry), p3 = this.grid3D.query(h2.minX - l2, h2.minY - l2, h2.maxX + l2, h2.maxY + l2, (e3, r3, n3, i3) => function(t3, e4, r4, n4, i4) {
              for (const a4 of t3)
                if (e4 <= a4.x && r4 <= a4.y && n4 >= a4.x && i4 >= a4.y)
                  return true;
              const a3 = [new S(e4, r4), new S(e4, i4), new S(n4, i4), new S(n4, r4)];
              if (t3.length > 2) {
                for (const e5 of a3)
                  if (is(t3, e5))
                    return true;
              }
              for (let e5 = 0; e5 < t3.length - 1; e5++)
                if (as(t3[e5], t3[e5 + 1], a3))
                  return true;
              return false;
            }(t2.cameraQueryGeometry, e3 - l2, r3 - l2, n3 + l2, i3 + l2));
            for (const t3 of p3)
              c3.push(t3);
            c3.sort(yc);
            const f2 = {};
            let d2;
            for (let l3 = 0; l3 < c3.length; l3++) {
              const u3 = c3[l3];
              if (u3 === d2)
                continue;
              d2 = u3;
              const h3 = this.featureIndexArray.get(u3);
              let p4 = null;
              this.loadMatchingFeature(f2, h3.bucketIndex, h3.sourceLayerIndex, h3.featureIndex, s2, i2.layers, i2.availableImages, e2, r2, n2, (e3, r3, n3) => (p4 || (p4 = Za(e3)), r3.queryIntersectsFeature(o2, e3, n3, p4, this.z, t2.transform, a2, t2.pixelPosMatrix)));
            }
            return f2;
          }
          loadMatchingFeature(t2, e2, r2, n2, i2, a2, s2, l2, u2, c3, h2) {
            const p3 = this.bucketLayerIDs[e2];
            if (a2 && !function(t3, e3) {
              for (let r3 = 0; r3 < t3.length; r3++)
                if (e3.indexOf(t3[r3]) >= 0)
                  return true;
              return false;
            }(a2, p3))
              return;
            const f2 = this.sourceLayerCoder.decode(r2), d2 = this.vtLayers[f2].feature(n2);
            if (i2.needGeometry) {
              const t3 = Ka(d2, true);
              if (!i2.filter(new Qn(this.tileID.overscaledZ), t3, this.tileID.canonical))
                return;
            } else if (!i2.filter(new Qn(this.tileID.overscaledZ), d2))
              return;
            const y3 = this.getId(d2, f2);
            for (let e3 = 0; e3 < p3.length; e3++) {
              const r3 = p3[e3];
              if (a2 && a2.indexOf(r3) < 0)
                continue;
              const i3 = l2[r3];
              if (!i3)
                continue;
              let f3 = {};
              y3 && c3 && (f3 = c3.getState(i3.sourceLayer || "_geojsonTileLayer", y3));
              const m2 = o({}, u2[r3]);
              m2.paint = fc(m2.paint, i3.paint, d2, f3, s2), m2.layout = fc(m2.layout, i3.layout, d2, f3, s2);
              const g2 = !h2 || h2(d2, i3, f3);
              if (!g2)
                continue;
              const x2 = new hc(d2, this.z, this.x, this.y, y3);
              x2.layer = m2;
              let v3 = t2[r3];
              void 0 === v3 && (v3 = t2[r3] = []), v3.push({ featureIndex: n2, feature: x2, intersectionZ: g2 });
            }
          }
          lookupSymbolFeatures(t2, e2, r2, n2, i2, a2, s2, o2) {
            const l2 = {};
            this.loadVTLayers();
            const u2 = Jr(i2);
            for (const i3 of t2)
              this.loadMatchingFeature(l2, r2, n2, i3, u2, a2, s2, o2, e2);
            return l2;
          }
          hasLayer(t2) {
            for (const e2 of this.bucketLayerIDs)
              for (const r2 of e2)
                if (t2 === r2)
                  return true;
            return false;
          }
          getId(t2, e2) {
            let r2 = t2.id;
            return this.promoteId && (r2 = t2.properties["string" == typeof this.promoteId ? this.promoteId : this.promoteId[e2]], "boolean" == typeof r2 && (r2 = Number(r2))), r2;
          }
        }
        function fc(t2, e2, r2, n2, i2) {
          return c2(t2, (t3, a2) => {
            const s2 = e2 instanceof oi ? e2.get(a2) : null;
            return s2 && s2.evaluate ? s2.evaluate(r2, n2, i2) : s2;
          });
        }
        function dc(t2) {
          let e2 = 1 / 0, r2 = 1 / 0, n2 = -1 / 0, i2 = -1 / 0;
          for (const a2 of t2)
            e2 = Math.min(e2, a2.x), r2 = Math.min(r2, a2.y), n2 = Math.max(n2, a2.x), i2 = Math.max(i2, a2.y);
          return { minX: e2, minY: r2, maxX: n2, maxY: i2 };
        }
        function yc(t2, e2) {
          return e2 - t2;
        }
        var mc;
        Mn("FeatureIndex", pc, { omit: ["rawTileData", "sourceLayerCoder"] }), t.PerformanceMarkers = void 0, (mc = t.PerformanceMarkers || (t.PerformanceMarkers = {})).create = "create", mc.load = "load", mc.fullLoad = "fullLoad";
        let gc = null, xc = [];
        const vc = 1e3 / 30, bc = { mark(t2) {
          performance.mark(t2);
        }, frame(t2) {
          const e2 = t2;
          null != gc && xc.push(e2 - gc), gc = e2;
        }, clearMetrics() {
          gc = null, xc = [], performance.clearMeasures("loadTime"), performance.clearMeasures("fullLoadTime");
          for (const e2 in t.PerformanceMarkers)
            performance.clearMarks(t.PerformanceMarkers[e2]);
        }, getPerformanceMetrics() {
          performance.measure("loadTime", t.PerformanceMarkers.create, t.PerformanceMarkers.load), performance.measure("fullLoadTime", t.PerformanceMarkers.create, t.PerformanceMarkers.fullLoad);
          const e2 = performance.getEntriesByName("loadTime")[0].duration, r2 = performance.getEntriesByName("fullLoadTime")[0].duration, n2 = xc.length, i2 = 1 / (xc.reduce((t2, e3) => t2 + e3, 0) / n2 / 1e3), a2 = xc.filter((t2) => t2 > vc).reduce((t2, e3) => t2 + (e3 - vc) / vc, 0);
          return { loadTime: e2, fullLoadTime: r2, fps: i2, percentDroppedFrames: a2 / (n2 + a2) * 100 };
        } };
        t.AJAXError = q, t.ARRAY_TYPE = ps, t.Actor = class {
          constructor(t2, e2, r2) {
            this.target = t2, this.parent = e2, this.mapId = r2, this.callbacks = {}, this.tasks = {}, this.taskQueue = [], this.cancelCallbacks = {}, u(["receive", "process"], this), this.invoker = new Gu(this.process), this.target.addEventListener("message", this.receive, false), this.globalScope = g() ? t2 : window;
          }
          send(t2, e2, r2, n2, i2 = false) {
            const a2 = Math.round(1e18 * Math.random()).toString(36).substring(0, 10);
            r2 && (this.callbacks[a2] = r2);
            const s2 = _(this.globalScope) ? void 0 : [];
            return this.target.postMessage({ id: a2, type: t2, hasCallback: !!r2, targetMapId: n2, mustQueue: i2, sourceMapId: this.mapId, data: Bn(e2, s2) }, s2), { cancel: () => {
              r2 && delete this.callbacks[a2], this.target.postMessage({ id: a2, type: "<cancel>", targetMapId: n2, sourceMapId: this.mapId });
            } };
          }
          receive(t2) {
            const e2 = t2.data, r2 = e2.id;
            if (r2 && (!e2.targetMapId || this.mapId === e2.targetMapId))
              if ("<cancel>" === e2.type) {
                delete this.tasks[r2];
                const t3 = this.cancelCallbacks[r2];
                delete this.cancelCallbacks[r2], t3 && t3();
              } else
                g() || e2.mustQueue ? (this.tasks[r2] = e2, this.taskQueue.push(r2), this.invoker.trigger()) : this.processTask(r2, e2);
          }
          process() {
            if (!this.taskQueue.length)
              return;
            const t2 = this.taskQueue.shift(), e2 = this.tasks[t2];
            delete this.tasks[t2], this.taskQueue.length && this.invoker.trigger(), e2 && this.processTask(t2, e2);
          }
          processTask(t2, e2) {
            if ("<response>" === e2.type) {
              const r2 = this.callbacks[t2];
              delete this.callbacks[t2], r2 && (e2.error ? r2(Cn(e2.error)) : r2(null, Cn(e2.data)));
            } else {
              let r2 = false;
              const n2 = _(this.globalScope) ? void 0 : [], i2 = e2.hasCallback ? (e3, i3) => {
                r2 = true, delete this.cancelCallbacks[t2], this.target.postMessage({ id: t2, type: "<response>", sourceMapId: this.mapId, error: e3 ? Bn(e3) : null, data: Bn(i3, n2) }, n2);
              } : (t3) => {
                r2 = true;
              };
              let a2 = null;
              const s2 = Cn(e2.data);
              if (this.parent[e2.type])
                a2 = this.parent[e2.type](e2.sourceMapId, s2, i2);
              else if (this.parent.getWorkerSource) {
                const t3 = e2.type.split(".");
                a2 = this.parent.getWorkerSource(e2.sourceMapId, t3[0], s2.source)[t3[1]](s2, i2);
              } else
                i2(new Error(`Could not find function ${e2.type}`));
              !r2 && a2 && a2.cancel && (this.cancelCallbacks[t2] = a2.cancel);
            }
          }
          remove() {
            this.invoker.remove(), this.target.removeEventListener("message", this.receive, false);
          }
        }, t.AlphaImage = zs, t.CanonicalTileID = ac, t.CollisionBoxArray = Ni, t.CollisionCircleLayoutArray = class extends Vi {
        }, t.Color = Ft, t.DEMData = uc, t.DataConstantProperty = li, t.DictionaryCoder = cc, t.EXTENT = qa, t.ErrorEvent = et, t.EvaluationParameters = Qn, t.Event = tt, t.Evented = rt, t.FeatureIndex = pc, t.FillBucket = mo, t.FillExtrusionBucket = Do, t.GeoJSONFeature = hc, t.ImageAtlas = Dl, t.ImagePosition = Ll, t.LineBucket = Yo, t.LineStripIndexArray = class extends Ui {
        }, t.LngLat = Xu, t.LngLatBounds = Yu, t.MercatorCoordinate = nc, t.ONE_EM = ll, t.OverscaledTileID = oc, t.PerformanceUtils = bc, t.PosArray = Qi, t.Properties = fi, t.QuadTriangleArray = class extends Fi {
        }, t.RGBAImage = Bs, t.RasterBoundsArray = class extends _i {
        }, t.RequestPerformance = class {
          constructor(t2) {
            this._marks = { start: [t2.url, "start"].join("#"), end: [t2.url, "end"].join("#"), measure: t2.url.toString() }, performance.mark(this._marks.start);
          }
          finish() {
            performance.mark(this._marks.end);
            let t2 = performance.getEntriesByName(this._marks.measure);
            return 0 === t2.length && (performance.measure(this._marks.measure, this._marks.start, this._marks.end), t2 = performance.getEntriesByName(this._marks.measure), performance.clearMarks(this._marks.start), performance.clearMarks(this._marks.end), performance.clearMeasures(this._marks.measure)), t2;
          }
        }, t.ResourceType = U, t.SegmentVector = ya, t.SymbolBucket = Du, t.Transitionable = ri, t.TriangleIndexArray = ha, t.Uniform1f = za, t.Uniform1i = class extends Ma {
          constructor(t2, e2) {
            super(t2, e2), this.current = 0;
          }
          set(t2) {
            this.current !== t2 && (this.current = t2, this.gl.uniform1i(this.location, t2));
          }
        }, t.Uniform2f = class extends Ma {
          constructor(t2, e2) {
            super(t2, e2), this.current = [0, 0];
          }
          set(t2) {
            t2[0] === this.current[0] && t2[1] === this.current[1] || (this.current = t2, this.gl.uniform2f(this.location, t2[0], t2[1]));
          }
        }, t.Uniform3f = class extends Ma {
          constructor(t2, e2) {
            super(t2, e2), this.current = [0, 0, 0];
          }
          set(t2) {
            t2[0] === this.current[0] && t2[1] === this.current[1] && t2[2] === this.current[2] || (this.current = t2, this.gl.uniform3f(this.location, t2[0], t2[1], t2[2]));
          }
        }, t.Uniform4f = Ba, t.UniformColor = Ca, t.UniformMatrix4f = class extends Ma {
          constructor(t2, e2) {
            super(t2, e2), this.current = Pa;
          }
          set(t2) {
            if (t2[12] !== this.current[12] || t2[0] !== this.current[0])
              return this.current = t2, void this.gl.uniformMatrix4fv(this.location, false, t2);
            for (let e2 = 1; e2 < 16; e2++)
              if (t2[e2] !== this.current[e2]) {
                this.current = t2, this.gl.uniformMatrix4fv(this.location, false, t2);
                break;
              }
          }
        }, t.UnwrappedTileID = sc, t.ValidationError = it, t.ZoomHistory = Pn, t.add = function(t2, e2, r2) {
          return t2[0] = e2[0] + r2[0], t2[1] = e2[1] + r2[1], t2[2] = e2[2] + r2[2], t2;
        }, t.addDynamicAttributes = Eu, t.asyncAll = function(t2, e2, r2) {
          if (!t2.length)
            return r2(null, []);
          let n2 = t2.length;
          const i2 = new Array(t2.length);
          let a2 = null;
          t2.forEach((t3, s2) => {
            e2(t3, (t4, e3) => {
              t4 && (a2 = t4), i2[s2] = e3, 0 == --n2 && r2(a2, i2);
            });
          });
        }, t.bezier = n, t.bindAll = u, t.cacheEntryPossiblyAdded = function(t2) {
          F++, F > V2 && (t2.getActor().send("enforceCacheSizeLimit", P), F = 0);
        }, t.clamp = a, t.clearTileCache = function(t2) {
          const e2 = caches.delete(z);
          t2 && e2.catch(t2).then(() => t2());
        }, t.clipLine = cu, t.clone = function(t2) {
          var e2 = new ps(16);
          return e2[0] = t2[0], e2[1] = t2[1], e2[2] = t2[2], e2[3] = t2[3], e2[4] = t2[4], e2[5] = t2[5], e2[6] = t2[6], e2[7] = t2[7], e2[8] = t2[8], e2[9] = t2[9], e2[10] = t2[10], e2[11] = t2[11], e2[12] = t2[12], e2[13] = t2[13], e2[14] = t2[14], e2[15] = t2[15], e2;
        }, t.clone$1 = p2, t.clone$2 = function(t2) {
          var e2 = new ps(3);
          return e2[0] = t2[0], e2[1] = t2[1], e2[2] = t2[2], e2;
        }, t.collisionCircleLayout = al, t.config = M, t.copy = function(t2, e2) {
          return t2[0] = e2[0], t2[1] = e2[1], t2[2] = e2[2], t2[3] = e2[3], t2[4] = e2[4], t2[5] = e2[5], t2[6] = e2[6], t2[7] = e2[7], t2[8] = e2[8], t2[9] = e2[9], t2[10] = e2[10], t2[11] = e2[11], t2[12] = e2[12], t2[13] = e2[13], t2[14] = e2[14], t2[15] = e2[15], t2;
        }, t.create = function() {
          var t2 = new ps(16);
          return ps != Float32Array && (t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[6] = 0, t2[7] = 0, t2[8] = 0, t2[9] = 0, t2[11] = 0, t2[12] = 0, t2[13] = 0, t2[14] = 0), t2[0] = 1, t2[5] = 1, t2[10] = 1, t2[15] = 1, t2;
        }, t.create$1 = fs, t.createExpression = Fr, t.createFilter = Jr, t.createLayout = vi, t.createStyleLayer = function(t2) {
          return "custom" === t2.type ? new Zu(t2) : new Ku[t2.type](t2);
        }, t.cross = function(t2, e2, r2) {
          var n2 = e2[0], i2 = e2[1], a2 = e2[2], s2 = r2[0], o2 = r2[1], l2 = r2[2];
          return t2[0] = i2 * l2 - a2 * o2, t2[1] = a2 * s2 - n2 * l2, t2[2] = n2 * o2 - i2 * s2, t2;
        }, t.dot = function(t2, e2) {
          return t2[0] * e2[0] + t2[1] * e2[1] + t2[2] * e2[2];
        }, t.dot$1 = function(t2, e2) {
          return t2[0] * e2[0] + t2[1] * e2[1] + t2[2] * e2[2] + t2[3] * e2[3];
        }, t.ease = i, t.emitValidationErrors = kn, t.enforceCacheSizeLimit = function(t2) {
          E(), B && B.then((e2) => {
            e2.keys().then((r2) => {
              for (let n2 = 0; n2 < r2.length - t2; n2++)
                e2.delete(r2[n2]);
            });
          });
        }, t.equals = function(t2, e2) {
          var r2 = t2[0], n2 = t2[1], i2 = t2[2], a2 = t2[3], s2 = t2[4], o2 = t2[5], l2 = t2[6], u2 = t2[7], c3 = t2[8], h2 = t2[9], p3 = t2[10], f2 = t2[11], d2 = t2[12], y3 = t2[13], m2 = t2[14], g2 = t2[15], x2 = e2[0], v3 = e2[1], b2 = e2[2], w2 = e2[3], _2 = e2[4], A3 = e2[5], k2 = e2[6], S2 = e2[7], I3 = e2[8], M2 = e2[9], z2 = e2[10], B2 = e2[11], C2 = e2[12], P2 = e2[13], V3 = e2[14], E2 = e2[15];
          return Math.abs(r2 - x2) <= hs * Math.max(1, Math.abs(r2), Math.abs(x2)) && Math.abs(n2 - v3) <= hs * Math.max(1, Math.abs(n2), Math.abs(v3)) && Math.abs(i2 - b2) <= hs * Math.max(1, Math.abs(i2), Math.abs(b2)) && Math.abs(a2 - w2) <= hs * Math.max(1, Math.abs(a2), Math.abs(w2)) && Math.abs(s2 - _2) <= hs * Math.max(1, Math.abs(s2), Math.abs(_2)) && Math.abs(o2 - A3) <= hs * Math.max(1, Math.abs(o2), Math.abs(A3)) && Math.abs(l2 - k2) <= hs * Math.max(1, Math.abs(l2), Math.abs(k2)) && Math.abs(u2 - S2) <= hs * Math.max(1, Math.abs(u2), Math.abs(S2)) && Math.abs(c3 - I3) <= hs * Math.max(1, Math.abs(c3), Math.abs(I3)) && Math.abs(h2 - M2) <= hs * Math.max(1, Math.abs(h2), Math.abs(M2)) && Math.abs(p3 - z2) <= hs * Math.max(1, Math.abs(p3), Math.abs(z2)) && Math.abs(f2 - B2) <= hs * Math.max(1, Math.abs(f2), Math.abs(B2)) && Math.abs(d2 - C2) <= hs * Math.max(1, Math.abs(d2), Math.abs(C2)) && Math.abs(y3 - P2) <= hs * Math.max(1, Math.abs(y3), Math.abs(P2)) && Math.abs(m2 - V3) <= hs * Math.max(1, Math.abs(m2), Math.abs(V3)) && Math.abs(g2 - E2) <= hs * Math.max(1, Math.abs(g2), Math.abs(E2));
        }, t.evaluateSizeForFeature = function(t2, { uSize: e2, uSizeT: r2 }, { lowerSize: n2, upperSize: i2 }) {
          return "source" === t2.kind ? n2 / tu : "composite" === t2.kind ? Se(n2 / tu, i2 / tu, r2) : e2;
        }, t.evaluateSizeForZoom = function(t2, e2) {
          let r2 = 0, n2 = 0;
          if ("constant" === t2.kind)
            n2 = t2.layoutSize;
          else if ("source" !== t2.kind) {
            const { interpolationType: i2, minZoom: s2, maxZoom: o2 } = t2, l2 = i2 ? a(Ne.interpolationFactor(i2, e2, s2, o2), 0, 1) : 0;
            "camera" === t2.kind ? n2 = Se(t2.minSize, t2.maxSize, l2) : r2 = l2;
          }
          return { uSizeT: r2, uSize: n2 };
        }, t.evaluateVariableOffset = Au, t.evented = Xn, t.exported = k, t.exported$1 = T, t.extend = o, t.filterObject = h, t.fromRotation = function(t2, e2) {
          var r2 = Math.sin(e2), n2 = Math.cos(e2);
          return t2[0] = n2, t2[1] = r2, t2[2] = 0, t2[3] = -r2, t2[4] = n2, t2[5] = 0, t2[6] = 0, t2[7] = 0, t2[8] = 1, t2;
        }, t.fromScaling = function(t2, e2) {
          return t2[0] = e2[0], t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[5] = e2[1], t2[6] = 0, t2[7] = 0, t2[8] = 0, t2[9] = 0, t2[10] = e2[2], t2[11] = 0, t2[12] = 0, t2[13] = 0, t2[14] = 0, t2[15] = 1, t2;
        }, t.getAnchorAlignment = Yl, t.getAnchorJustification = ku, t.getArrayBuffer = K, t.getImage = H, t.getJSON = function(t2, e2) {
          return Z2(o(t2, { type: "json" }), e2);
        }, t.getOverlapMode = qu, t.getRTLTextPluginStatus = Yn, t.getReferrer = j, t.getVideo = function(t2, e2) {
          const r2 = window.document.createElement("video");
          r2.muted = true, r2.onloadstart = function() {
            e2(null, r2);
          };
          for (let e3 = 0; e3 < t2.length; e3++) {
            const n2 = window.document.createElement("source");
            G(t2[e3]) || (r2.crossOrigin = "Anonymous"), n2.src = t2[e3], r2.appendChild(n2);
          }
          return { cancel: () => {
          } };
        }, t.identity = ds, t.invert = function(t2, e2) {
          var r2 = e2[0], n2 = e2[1], i2 = e2[2], a2 = e2[3], s2 = e2[4], o2 = e2[5], l2 = e2[6], u2 = e2[7], c3 = e2[8], h2 = e2[9], p3 = e2[10], f2 = e2[11], d2 = e2[12], y3 = e2[13], m2 = e2[14], g2 = e2[15], x2 = r2 * o2 - n2 * s2, v3 = r2 * l2 - i2 * s2, b2 = r2 * u2 - a2 * s2, w2 = n2 * l2 - i2 * o2, _2 = n2 * u2 - a2 * o2, A3 = i2 * u2 - a2 * l2, k2 = c3 * y3 - h2 * d2, S2 = c3 * m2 - p3 * d2, I3 = c3 * g2 - f2 * d2, M2 = h2 * m2 - p3 * y3, z2 = h2 * g2 - f2 * y3, B2 = p3 * g2 - f2 * m2, C2 = x2 * B2 - v3 * z2 + b2 * M2 + w2 * I3 - _2 * S2 + A3 * k2;
          return C2 ? (t2[0] = (o2 * B2 - l2 * z2 + u2 * M2) * (C2 = 1 / C2), t2[1] = (i2 * z2 - n2 * B2 - a2 * M2) * C2, t2[2] = (y3 * A3 - m2 * _2 + g2 * w2) * C2, t2[3] = (p3 * _2 - h2 * A3 - f2 * w2) * C2, t2[4] = (l2 * I3 - s2 * B2 - u2 * S2) * C2, t2[5] = (r2 * B2 - i2 * I3 + a2 * S2) * C2, t2[6] = (m2 * b2 - d2 * A3 - g2 * v3) * C2, t2[7] = (c3 * A3 - p3 * b2 + f2 * v3) * C2, t2[8] = (s2 * z2 - o2 * I3 + u2 * k2) * C2, t2[9] = (n2 * I3 - r2 * z2 - a2 * k2) * C2, t2[10] = (d2 * _2 - y3 * b2 + g2 * x2) * C2, t2[11] = (h2 * b2 - c3 * _2 - f2 * x2) * C2, t2[12] = (o2 * S2 - s2 * M2 - l2 * k2) * C2, t2[13] = (r2 * M2 - n2 * S2 + i2 * k2) * C2, t2[14] = (y3 * v3 - d2 * w2 - m2 * x2) * C2, t2[15] = (c3 * w2 - h2 * v3 + p3 * x2) * C2, t2) : null;
        }, t.isImageBitmap = A2, t.isSafari = _, t.isWorker = g, t.keysDifference = function(t2, e2) {
          const r2 = [];
          for (const n2 in t2)
            n2 in e2 || r2.push(n2);
          return r2;
        }, t.lazyLoadRTLTextPlugin = function() {
          Wn.isLoading() || Wn.isLoaded() || "deferred" !== Yn() || Hn();
        }, t.makeRequest = Z2, t.mapObject = c2, t.mercatorXfromLng = Qu, t.mercatorYfromLat = tc, t.mercatorZfromAltitude = ec, t.mul = gs, t.mul$1 = function(t2, e2, r2) {
          return t2[0] = e2[0] * r2[0], t2[1] = e2[1] * r2[1], t2[2] = e2[2] * r2[2], t2[3] = e2[3] * r2[3], t2;
        }, t.multiply = ys, t.nextPowerOfTwo = function(t2) {
          return t2 <= 1 ? 1 : Math.pow(2, Math.ceil(Math.log(t2) / Math.LN2));
        }, t.normalize = function(t2, e2) {
          var r2 = e2[0], n2 = e2[1], i2 = e2[2], a2 = r2 * r2 + n2 * n2 + i2 * i2;
          return a2 > 0 && (a2 = 1 / Math.sqrt(a2)), t2[0] = e2[0] * a2, t2[1] = e2[1] * a2, t2[2] = e2[2] * a2, t2;
        }, t.number = Se, t.ortho = function(t2, e2, r2, n2, i2, a2, s2) {
          var o2 = 1 / (e2 - r2), l2 = 1 / (n2 - i2), u2 = 1 / (a2 - s2);
          return t2[0] = -2 * o2, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[5] = -2 * l2, t2[6] = 0, t2[7] = 0, t2[8] = 0, t2[9] = 0, t2[10] = 2 * u2, t2[11] = 0, t2[12] = (e2 + r2) * o2, t2[13] = (i2 + n2) * l2, t2[14] = (s2 + a2) * u2, t2[15] = 1, t2;
        }, t.parseCacheControl = x, t.parseGlyphPbf = function(t2) {
          return new ul(t2).readFields(Vl, []);
        }, t.pbf = ul, t.performSymbolLayout = function(e2) {
          e2.bucket.createArrays(), e2.bucket.tilePixelRatio = qa / (512 * e2.bucket.overscaling), e2.bucket.compareText = {}, e2.bucket.iconsNeedLinear = false;
          const r2 = e2.bucket.layers[0].layout, n2 = e2.bucket.layers[0]._unevaluatedLayout._values, i2 = { layoutIconSize: n2["icon-size"].possiblyEvaluate(new Qn(e2.bucket.zoom + 1), e2.canonical), layoutTextSize: n2["text-size"].possiblyEvaluate(new Qn(e2.bucket.zoom + 1), e2.canonical), textMaxSize: n2["text-size"].possiblyEvaluate(new Qn(18)) };
          if ("composite" === e2.bucket.textSizeData.kind) {
            const { minZoom: t2, maxZoom: r3 } = e2.bucket.textSizeData;
            i2.compositeTextSizes = [n2["text-size"].possiblyEvaluate(new Qn(t2), e2.canonical), n2["text-size"].possiblyEvaluate(new Qn(r3), e2.canonical)];
          }
          if ("composite" === e2.bucket.iconSizeData.kind) {
            const { minZoom: t2, maxZoom: r3 } = e2.bucket.iconSizeData;
            i2.compositeIconSizes = [n2["icon-size"].possiblyEvaluate(new Qn(t2), e2.canonical), n2["icon-size"].possiblyEvaluate(new Qn(r3), e2.canonical)];
          }
          const a2 = r2.get("text-line-height") * ll, s2 = "viewport" !== r2.get("text-rotation-alignment") && "point" !== r2.get("symbol-placement"), o2 = r2.get("text-keep-upright"), l2 = r2.get("text-size");
          for (const n3 of e2.bucket.features) {
            const u2 = r2.get("text-font").evaluate(n3, {}, e2.canonical).join(","), c3 = l2.evaluate(n3, {}, e2.canonical), h2 = i2.layoutTextSize.evaluate(n3, {}, e2.canonical), p3 = i2.layoutIconSize.evaluate(n3, {}, e2.canonical), f2 = { horizontal: {}, vertical: void 0 }, y3 = n3.text;
            let m2, g2 = [0, 0];
            if (y3) {
              const i3 = y3.toString(), l3 = r2.get("text-letter-spacing").evaluate(n3, {}, e2.canonical) * ll, p4 = Fn(i3) ? l3 : 0, d2 = r2.get("text-anchor").evaluate(n3, {}, e2.canonical), m3 = r2.get("text-variable-anchor");
              if (!m3) {
                const t2 = r2.get("text-radial-offset").evaluate(n3, {}, e2.canonical);
                g2 = t2 ? Au(d2, [t2 * ll, _u]) : r2.get("text-offset").evaluate(n3, {}, e2.canonical).map((t3) => t3 * ll);
              }
              let x3 = s2 ? "center" : r2.get("text-justify").evaluate(n3, {}, e2.canonical);
              const v4 = r2.get("symbol-placement"), b2 = "point" === v4 ? r2.get("text-max-width").evaluate(n3, {}, e2.canonical) * ll : 0, w2 = () => {
                e2.bucket.allowVerticalPlacement && En(i3) && (f2.vertical = Ul(y3, e2.glyphMap, e2.glyphPositions, e2.imagePositions, u2, b2, a2, d2, "left", p4, g2, t.WritingMode.vertical, true, v4, h2, c3));
              };
              if (!s2 && m3) {
                const r3 = "auto" === x3 ? m3.map((t2) => ku(t2)) : [x3];
                let n4 = false;
                for (let i4 = 0; i4 < r3.length; i4++) {
                  const s3 = r3[i4];
                  if (!f2.horizontal[s3])
                    if (n4)
                      f2.horizontal[s3] = f2.horizontal[0];
                    else {
                      const r4 = Ul(y3, e2.glyphMap, e2.glyphPositions, e2.imagePositions, u2, b2, a2, "center", s3, p4, g2, t.WritingMode.horizontal, false, v4, h2, c3);
                      r4 && (f2.horizontal[s3] = r4, n4 = 1 === r4.positionedLines.length);
                    }
                }
                w2();
              } else {
                "auto" === x3 && (x3 = ku(d2));
                const r3 = Ul(y3, e2.glyphMap, e2.glyphPositions, e2.imagePositions, u2, b2, a2, d2, x3, p4, g2, t.WritingMode.horizontal, false, v4, h2, c3);
                r3 && (f2.horizontal[x3] = r3), w2(), En(i3) && s2 && o2 && (f2.vertical = Ul(y3, e2.glyphMap, e2.glyphPositions, e2.imagePositions, u2, b2, a2, d2, x3, p4, g2, t.WritingMode.vertical, false, v4, h2, c3));
              }
            }
            let x2 = false;
            if (n3.icon && n3.icon.name) {
              const t2 = e2.imageMap[n3.icon.name];
              t2 && (m2 = Wl(e2.imagePositions[n3.icon.name], r2.get("icon-offset").evaluate(n3, {}, e2.canonical), r2.get("icon-anchor").evaluate(n3, {}, e2.canonical)), x2 = !!t2.sdf, void 0 === e2.bucket.sdfIcons ? e2.bucket.sdfIcons = x2 : e2.bucket.sdfIcons !== x2 && d("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"), (t2.pixelRatio !== e2.bucket.pixelRatio || 0 !== r2.get("icon-rotate").constantOr(1)) && (e2.bucket.iconsNeedLinear = true));
            }
            const v3 = zu(f2.horizontal) || f2.vertical;
            e2.bucket.iconsInText = !!v3 && v3.iconsInText, (v3 || m2) && Su(e2.bucket, n3, f2, m2, e2.imageMap, i2, h2, p3, g2, x2, e2.canonical);
          }
          e2.showCollisionBoxes && e2.bucket.generateCollisionDebugBuffers();
        }, t.perspective = function(t2, e2, r2, n2, i2) {
          var a2, s2 = 1 / Math.tan(e2 / 2);
          return t2[0] = s2 / r2, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[5] = s2, t2[6] = 0, t2[7] = 0, t2[8] = 0, t2[9] = 0, t2[11] = -1, t2[12] = 0, t2[13] = 0, t2[15] = 0, null != i2 && i2 !== 1 / 0 ? (t2[10] = (i2 + n2) * (a2 = 1 / (n2 - i2)), t2[14] = 2 * i2 * n2 * a2) : (t2[10] = -1, t2[14] = -2 * n2), t2;
        }, t.pick = function(t2, e2) {
          const r2 = {};
          for (let n2 = 0; n2 < e2.length; n2++) {
            const i2 = e2[n2];
            i2 in t2 && (r2[i2] = t2[i2]);
          }
          return r2;
        }, t.plugin = Wn, t.pointGeometry = S, t.polygonIntersectsPolygon = Xa, t.potpack = Tl, t.refProperties = ["type", "source", "source-layer", "minzoom", "maxzoom", "filter", "layout"], t.register = Mn, t.registerForPluginStateChange = function(t2) {
          return t2({ pluginStatus: Zn, pluginURL: Kn }), Xn.on("pluginStateChange", t2), t2;
        }, t.renderColorRamp = Cs, t.rotateX = function(t2, e2, r2) {
          var n2 = Math.sin(r2), i2 = Math.cos(r2), a2 = e2[4], s2 = e2[5], o2 = e2[6], l2 = e2[7], u2 = e2[8], c3 = e2[9], h2 = e2[10], p3 = e2[11];
          return e2 !== t2 && (t2[0] = e2[0], t2[1] = e2[1], t2[2] = e2[2], t2[3] = e2[3], t2[12] = e2[12], t2[13] = e2[13], t2[14] = e2[14], t2[15] = e2[15]), t2[4] = a2 * i2 + u2 * n2, t2[5] = s2 * i2 + c3 * n2, t2[6] = o2 * i2 + h2 * n2, t2[7] = l2 * i2 + p3 * n2, t2[8] = u2 * i2 - a2 * n2, t2[9] = c3 * i2 - s2 * n2, t2[10] = h2 * i2 - o2 * n2, t2[11] = p3 * i2 - l2 * n2, t2;
        }, t.rotateZ = function(t2, e2, r2) {
          var n2 = Math.sin(r2), i2 = Math.cos(r2), a2 = e2[0], s2 = e2[1], o2 = e2[2], l2 = e2[3], u2 = e2[4], c3 = e2[5], h2 = e2[6], p3 = e2[7];
          return e2 !== t2 && (t2[8] = e2[8], t2[9] = e2[9], t2[10] = e2[10], t2[11] = e2[11], t2[12] = e2[12], t2[13] = e2[13], t2[14] = e2[14], t2[15] = e2[15]), t2[0] = a2 * i2 + u2 * n2, t2[1] = s2 * i2 + c3 * n2, t2[2] = o2 * i2 + h2 * n2, t2[3] = l2 * i2 + p3 * n2, t2[4] = u2 * i2 - a2 * n2, t2[5] = c3 * i2 - s2 * n2, t2[6] = h2 * i2 - o2 * n2, t2[7] = p3 * i2 - l2 * n2, t2;
        }, t.scale = function(t2, e2, r2) {
          var n2 = r2[0], i2 = r2[1], a2 = r2[2];
          return t2[0] = e2[0] * n2, t2[1] = e2[1] * n2, t2[2] = e2[2] * n2, t2[3] = e2[3] * n2, t2[4] = e2[4] * i2, t2[5] = e2[5] * i2, t2[6] = e2[6] * i2, t2[7] = e2[7] * i2, t2[8] = e2[8] * a2, t2[9] = e2[9] * a2, t2[10] = e2[10] * a2, t2[11] = e2[11] * a2, t2[12] = e2[12], t2[13] = e2[13], t2[14] = e2[14], t2[15] = e2[15], t2;
        }, t.scale$1 = function(t2, e2, r2) {
          return t2[0] = e2[0] * r2, t2[1] = e2[1] * r2, t2[2] = e2[2] * r2, t2;
        }, t.setCacheLimits = function(t2, e2) {
          P = t2, V2 = e2;
        }, t.setRTLTextPlugin = function(t2, e2, r2 = false) {
          if (Zn === Un || Zn === qn || Zn === jn)
            throw new Error("setRTLTextPlugin cannot be called multiple times.");
          Kn = k.resolveURL(t2), Zn = Un, Nn = e2, Jn(), r2 || Hn();
        }, t.spec = nt, t.sphericalToCartesian = function([t2, e2, r2]) {
          return e2 += 90, e2 *= Math.PI / 180, r2 *= Math.PI / 180, { x: t2 * Math.cos(e2) * Math.sin(r2), y: t2 * Math.sin(e2) * Math.sin(r2), z: t2 * Math.cos(r2) };
        }, t.sqrLen = function(t2) {
          var e2 = t2[0], r2 = t2[1];
          return e2 * e2 + r2 * r2;
        }, t.sub = function(t2, e2, r2) {
          return t2[0] = e2[0] - r2[0], t2[1] = e2[1] - r2[1], t2[2] = e2[2] - r2[2], t2;
        }, t.toEvaluationFeature = Ka, t.transformMat3 = function(t2, e2, r2) {
          var n2 = e2[0], i2 = e2[1], a2 = e2[2];
          return t2[0] = n2 * r2[0] + i2 * r2[3] + a2 * r2[6], t2[1] = n2 * r2[1] + i2 * r2[4] + a2 * r2[7], t2[2] = n2 * r2[2] + i2 * r2[5] + a2 * r2[8], t2;
        }, t.transformMat4 = bs, t.transformMat4$1 = function(t2, e2, r2) {
          var n2 = e2[0], i2 = e2[1];
          return t2[0] = r2[0] * n2 + r2[4] * i2 + r2[12], t2[1] = r2[1] * n2 + r2[5] * i2 + r2[13], t2;
        }, t.translate = function(t2, e2, r2) {
          var n2, i2, a2, s2, o2, l2, u2, c3, h2, p3, f2, d2, y3 = r2[0], m2 = r2[1], g2 = r2[2];
          return e2 === t2 ? (t2[12] = e2[0] * y3 + e2[4] * m2 + e2[8] * g2 + e2[12], t2[13] = e2[1] * y3 + e2[5] * m2 + e2[9] * g2 + e2[13], t2[14] = e2[2] * y3 + e2[6] * m2 + e2[10] * g2 + e2[14], t2[15] = e2[3] * y3 + e2[7] * m2 + e2[11] * g2 + e2[15]) : (i2 = e2[1], a2 = e2[2], s2 = e2[3], o2 = e2[4], l2 = e2[5], u2 = e2[6], c3 = e2[7], h2 = e2[8], p3 = e2[9], f2 = e2[10], d2 = e2[11], t2[0] = n2 = e2[0], t2[1] = i2, t2[2] = a2, t2[3] = s2, t2[4] = o2, t2[5] = l2, t2[6] = u2, t2[7] = c3, t2[8] = h2, t2[9] = p3, t2[10] = f2, t2[11] = d2, t2[12] = n2 * y3 + o2 * m2 + h2 * g2 + e2[12], t2[13] = i2 * y3 + l2 * m2 + p3 * g2 + e2[13], t2[14] = a2 * y3 + u2 * m2 + f2 * g2 + e2[14], t2[15] = s2 * y3 + c3 * m2 + d2 * g2 + e2[15]), t2;
        }, t.triggerPluginCompletionEvent = Gn, t.unicodeBlockLookup = Vn, t.uniqueId = function() {
          return l++;
        }, t.validateCustomStyleLayer = function(t2) {
          const e2 = [], r2 = t2.id;
          return void 0 === r2 && e2.push({ message: `layers.${r2}: missing required property "id"` }), void 0 === t2.render && e2.push({ message: `layers.${r2}: missing required method "render"` }), t2.renderingMode && "2d" !== t2.renderingMode && "3d" !== t2.renderingMode && e2.push({ message: `layers.${r2}: property "renderingMode" must be either "2d" or "3d"` }), e2;
        }, t.validateLight = wn, t.validateStyle = bn, t.vectorTile = _o, t.warnOnce = d, t.wrap = s;
      });
      define2(["./shared"], function(e) {
        function t(e2) {
          const o2 = typeof e2;
          if ("number" === o2 || "boolean" === o2 || "string" === o2 || null == e2)
            return JSON.stringify(e2);
          if (Array.isArray(e2)) {
            let o3 = "[";
            for (const i3 of e2)
              o3 += `${t(i3)},`;
            return `${o3}]`;
          }
          const i2 = Object.keys(e2).sort();
          let r2 = "{";
          for (let o3 = 0; o3 < i2.length; o3++)
            r2 += `${JSON.stringify(i2[o3])}:${t(e2[i2[o3]])},`;
          return `${r2}}`;
        }
        function o(o2) {
          let i2 = "";
          for (const r2 of e.refProperties)
            i2 += `/${t(o2[r2])}`;
          return i2;
        }
        class i {
          constructor(e2) {
            this.keyCache = {}, e2 && this.replace(e2);
          }
          replace(e2) {
            this._layerConfigs = {}, this._layers = {}, this.update(e2, []);
          }
          update(t2, i2) {
            for (const o2 of t2) {
              this._layerConfigs[o2.id] = o2;
              const t3 = this._layers[o2.id] = e.createStyleLayer(o2);
              t3._featureFilter = e.createFilter(t3.filter), this.keyCache[o2.id] && delete this.keyCache[o2.id];
            }
            for (const e2 of i2)
              delete this.keyCache[e2], delete this._layerConfigs[e2], delete this._layers[e2];
            this.familiesBySource = {};
            const r2 = function(e2, t3) {
              const i3 = {};
              for (let r4 = 0; r4 < e2.length; r4++) {
                const n2 = t3 && t3[e2[r4].id] || o(e2[r4]);
                t3 && (t3[e2[r4].id] = n2);
                let s2 = i3[n2];
                s2 || (s2 = i3[n2] = []), s2.push(e2[r4]);
              }
              const r3 = [];
              for (const e3 in i3)
                r3.push(i3[e3]);
              return r3;
            }(Object.values(this._layerConfigs), this.keyCache);
            for (const e2 of r2) {
              const t3 = e2.map((e3) => this._layers[e3.id]), o2 = t3[0];
              if ("none" === o2.visibility)
                continue;
              const i3 = o2.source || "";
              let r3 = this.familiesBySource[i3];
              r3 || (r3 = this.familiesBySource[i3] = {});
              const n2 = o2.sourceLayer || "_geojsonTileLayer";
              let s2 = r3[n2];
              s2 || (s2 = r3[n2] = []), s2.push(t3);
            }
          }
        }
        class r {
          constructor(t2) {
            const o2 = {}, i2 = [];
            for (const e2 in t2) {
              const r3 = t2[e2], n3 = o2[e2] = {};
              for (const e3 in r3) {
                const t3 = r3[+e3];
                if (!t3 || 0 === t3.bitmap.width || 0 === t3.bitmap.height)
                  continue;
                const o3 = { x: 0, y: 0, w: t3.bitmap.width + 2, h: t3.bitmap.height + 2 };
                i2.push(o3), n3[e3] = { rect: o3, metrics: t3.metrics };
              }
            }
            const { w: r2, h: n2 } = e.potpack(i2), s2 = new e.AlphaImage({ width: r2 || 1, height: n2 || 1 });
            for (const i3 in t2) {
              const r3 = t2[i3];
              for (const t3 in r3) {
                const n3 = r3[+t3];
                if (!n3 || 0 === n3.bitmap.width || 0 === n3.bitmap.height)
                  continue;
                const a2 = o2[i3][t3].rect;
                e.AlphaImage.copy(n3.bitmap, s2, { x: 0, y: 0 }, { x: a2.x + 1, y: a2.y + 1 }, n3.bitmap);
              }
            }
            this.image = s2, this.positions = o2;
          }
        }
        e.register("GlyphAtlas", r);
        class n {
          constructor(t2) {
            this.tileID = new e.OverscaledTileID(t2.tileID.overscaledZ, t2.tileID.wrap, t2.tileID.canonical.z, t2.tileID.canonical.x, t2.tileID.canonical.y), this.uid = t2.uid, this.zoom = t2.zoom, this.pixelRatio = t2.pixelRatio, this.tileSize = t2.tileSize, this.source = t2.source, this.overscaling = this.tileID.overscaleFactor(), this.showCollisionBoxes = t2.showCollisionBoxes, this.collectResourceTiming = !!t2.collectResourceTiming, this.returnDependencies = !!t2.returnDependencies, this.promoteId = t2.promoteId;
          }
          parse(t2, o2, i2, n2, a2) {
            this.status = "parsing", this.data = t2, this.collisionBoxArray = new e.CollisionBoxArray();
            const l2 = new e.DictionaryCoder(Object.keys(t2.layers).sort()), c3 = new e.FeatureIndex(this.tileID, this.promoteId);
            c3.bucketLayerIDs = [];
            const u2 = {}, h2 = { featureIndex: c3, iconDependencies: {}, patternDependencies: {}, glyphDependencies: {}, availableImages: i2 }, p3 = o2.familiesBySource[this.source];
            for (const o3 in p3) {
              const r2 = t2.layers[o3];
              if (!r2)
                continue;
              1 === r2.version && e.warnOnce(`Vector tile source "${this.source}" layer "${o3}" does not use vector tile spec v2 and therefore may have some rendering errors.`);
              const n3 = l2.encode(o3), a3 = [];
              for (let e2 = 0; e2 < r2.length; e2++) {
                const t3 = r2.feature(e2), i3 = c3.getId(t3, o3);
                a3.push({ feature: t3, id: i3, index: e2, sourceLayerIndex: n3 });
              }
              for (const t3 of p3[o3]) {
                const o4 = t3[0];
                o4.source !== this.source && e.warnOnce(`layer.source = ${o4.source} does not equal this.source = ${this.source}`), o4.minzoom && this.zoom < Math.floor(o4.minzoom) || o4.maxzoom && this.zoom >= o4.maxzoom || "none" !== o4.visibility && (s(t3, this.zoom, i2), (u2[o4.id] = o4.createBucket({ index: c3.bucketLayerIDs.length, layers: t3, zoom: this.zoom, pixelRatio: this.pixelRatio, overscaling: this.overscaling, collisionBoxArray: this.collisionBoxArray, sourceLayerIndex: n3, sourceID: this.source })).populate(a3, h2, this.tileID.canonical), c3.bucketLayerIDs.push(t3.map((e2) => e2.id)));
              }
            }
            let f2, d2, g2, m2;
            const y3 = e.mapObject(h2.glyphDependencies, (e2) => Object.keys(e2).map(Number));
            Object.keys(y3).length ? n2.send("getGlyphs", { uid: this.uid, stacks: y3 }, (e2, t3) => {
              f2 || (f2 = e2, d2 = t3, w2.call(this));
            }) : d2 = {};
            const v3 = Object.keys(h2.iconDependencies);
            v3.length ? n2.send("getImages", { icons: v3, source: this.source, tileID: this.tileID, type: "icons" }, (e2, t3) => {
              f2 || (f2 = e2, g2 = t3, w2.call(this));
            }) : g2 = {};
            const x2 = Object.keys(h2.patternDependencies);
            function w2() {
              if (f2)
                return a2(f2);
              if (d2 && g2 && m2) {
                const t3 = new r(d2), o3 = new e.ImageAtlas(g2, m2);
                for (const r2 in u2) {
                  const n3 = u2[r2];
                  n3 instanceof e.SymbolBucket ? (s(n3.layers, this.zoom, i2), e.performSymbolLayout({ bucket: n3, glyphMap: d2, glyphPositions: t3.positions, imageMap: g2, imagePositions: o3.iconPositions, showCollisionBoxes: this.showCollisionBoxes, canonical: this.tileID.canonical })) : n3.hasPattern && (n3 instanceof e.LineBucket || n3 instanceof e.FillBucket || n3 instanceof e.FillExtrusionBucket) && (s(n3.layers, this.zoom, i2), n3.addFeatures(h2, this.tileID.canonical, o3.patternPositions));
                }
                this.status = "done", a2(null, { buckets: Object.values(u2).filter((e2) => !e2.isEmpty()), featureIndex: c3, collisionBoxArray: this.collisionBoxArray, glyphAtlasImage: t3.image, imageAtlas: o3, glyphMap: this.returnDependencies ? d2 : null, iconMap: this.returnDependencies ? g2 : null, glyphPositions: this.returnDependencies ? t3.positions : null });
              }
            }
            x2.length ? n2.send("getImages", { icons: x2, source: this.source, tileID: this.tileID, type: "patterns" }, (e2, t3) => {
              f2 || (f2 = e2, m2 = t3, w2.call(this));
            }) : m2 = {}, w2.call(this);
          }
        }
        function s(t2, o2, i2) {
          const r2 = new e.EvaluationParameters(o2);
          for (const e2 of t2)
            e2.recalculate(r2, i2);
        }
        function a(t2, o2) {
          const i2 = e.getArrayBuffer(t2.request, (t3, i3, r2, n2) => {
            t3 ? o2(t3) : i3 && o2(null, { vectorTile: new e.vectorTile.VectorTile(new e.pbf(i3)), rawData: i3, cacheControl: r2, expires: n2 });
          });
          return () => {
            i2.cancel(), o2();
          };
        }
        class l {
          constructor(e2, t2, o2, i2) {
            this.actor = e2, this.layerIndex = t2, this.availableImages = o2, this.loadVectorData = i2 || a, this.loading = {}, this.loaded = {};
          }
          loadTile(t2, o2) {
            const i2 = t2.uid;
            this.loading || (this.loading = {});
            const r2 = !!(t2 && t2.request && t2.request.collectResourceTiming) && new e.RequestPerformance(t2.request), s2 = this.loading[i2] = new n(t2);
            s2.abort = this.loadVectorData(t2, (t3, n2) => {
              if (delete this.loading[i2], t3 || !n2)
                return s2.status = "done", this.loaded[i2] = s2, o2(t3);
              const a2 = n2.rawData, l2 = {};
              n2.expires && (l2.expires = n2.expires), n2.cacheControl && (l2.cacheControl = n2.cacheControl);
              const c3 = {};
              if (r2) {
                const e2 = r2.finish();
                e2 && (c3.resourceTiming = JSON.parse(JSON.stringify(e2)));
              }
              s2.vectorTile = n2.vectorTile, s2.parse(n2.vectorTile, this.layerIndex, this.availableImages, this.actor, (t4, i3) => {
                if (t4 || !i3)
                  return o2(t4);
                o2(null, e.extend({ rawTileData: a2.slice(0) }, i3, l2, c3));
              }), this.loaded = this.loaded || {}, this.loaded[i2] = s2;
            });
          }
          reloadTile(e2, t2) {
            const o2 = this.loaded, i2 = e2.uid, r2 = this;
            if (o2 && o2[i2]) {
              const n2 = o2[i2];
              n2.showCollisionBoxes = e2.showCollisionBoxes;
              const s2 = (e3, o3) => {
                const i3 = n2.reloadCallback;
                i3 && (delete n2.reloadCallback, n2.parse(n2.vectorTile, r2.layerIndex, this.availableImages, r2.actor, i3)), t2(e3, o3);
              };
              "parsing" === n2.status ? n2.reloadCallback = s2 : "done" === n2.status && (n2.vectorTile ? n2.parse(n2.vectorTile, this.layerIndex, this.availableImages, this.actor, s2) : s2());
            }
          }
          abortTile(e2, t2) {
            const o2 = this.loading, i2 = e2.uid;
            o2 && o2[i2] && o2[i2].abort && (o2[i2].abort(), delete o2[i2]), t2();
          }
          removeTile(e2, t2) {
            const o2 = this.loaded, i2 = e2.uid;
            o2 && o2[i2] && delete o2[i2], t2();
          }
        }
        class c2 {
          constructor() {
            this.loaded = {};
          }
          loadTile(t2, o2) {
            const { uid: i2, encoding: r2, rawImageData: n2 } = t2, s2 = e.isImageBitmap(n2) ? this.getImageData(n2) : n2, a2 = new e.DEMData(i2, s2, r2);
            this.loaded = this.loaded || {}, this.loaded[i2] = a2, o2(null, a2);
          }
          getImageData(t2) {
            this.offscreenCanvas && this.offscreenCanvasContext || (this.offscreenCanvas = new OffscreenCanvas(t2.width, t2.height), this.offscreenCanvasContext = this.offscreenCanvas.getContext("2d")), this.offscreenCanvas.width = t2.width, this.offscreenCanvas.height = t2.height, this.offscreenCanvasContext.drawImage(t2, 0, 0, t2.width, t2.height);
            const o2 = this.offscreenCanvasContext.getImageData(-1, -1, t2.width + 2, t2.height + 2);
            return this.offscreenCanvasContext.clearRect(0, 0, this.offscreenCanvas.width, this.offscreenCanvas.height), new e.RGBAImage({ width: o2.width, height: o2.height }, o2.data);
          }
          removeTile(e2) {
            const t2 = this.loaded, o2 = e2.uid;
            t2 && t2[o2] && delete t2[o2];
          }
        }
        var u = function e2(t2, o2) {
          var i2, r2 = t2 && t2.type;
          if ("FeatureCollection" === r2)
            for (i2 = 0; i2 < t2.features.length; i2++)
              e2(t2.features[i2], o2);
          else if ("GeometryCollection" === r2)
            for (i2 = 0; i2 < t2.geometries.length; i2++)
              e2(t2.geometries[i2], o2);
          else if ("Feature" === r2)
            e2(t2.geometry, o2);
          else if ("Polygon" === r2)
            h(t2.coordinates, o2);
          else if ("MultiPolygon" === r2)
            for (i2 = 0; i2 < t2.coordinates.length; i2++)
              h(t2.coordinates[i2], o2);
          return t2;
        };
        function h(e2, t2) {
          if (0 !== e2.length) {
            p2(e2[0], t2);
            for (var o2 = 1; o2 < e2.length; o2++)
              p2(e2[o2], !t2);
          }
        }
        function p2(e2, t2) {
          for (var o2 = 0, i2 = 0, r2 = 0, n2 = e2.length, s2 = n2 - 1; r2 < n2; s2 = r2++) {
            var a2 = (e2[r2][0] - e2[s2][0]) * (e2[s2][1] + e2[r2][1]), l2 = o2 + a2;
            i2 += Math.abs(o2) >= Math.abs(a2) ? o2 - l2 + a2 : a2 - l2 + o2, o2 = l2;
          }
          o2 + i2 >= 0 != !!t2 && e2.reverse();
        }
        const f = e.vectorTile.VectorTileFeature.prototype.toGeoJSON;
        class d {
          constructor(t2) {
            this._feature = t2, this.extent = e.EXTENT, this.type = t2.type, this.properties = t2.tags, "id" in t2 && !isNaN(t2.id) && (this.id = parseInt(t2.id, 10));
          }
          loadGeometry() {
            if (1 === this._feature.type) {
              const t2 = [];
              for (const o2 of this._feature.geometry)
                t2.push([new e.pointGeometry(o2[0], o2[1])]);
              return t2;
            }
            {
              const t2 = [];
              for (const o2 of this._feature.geometry) {
                const i2 = [];
                for (const t3 of o2)
                  i2.push(new e.pointGeometry(t3[0], t3[1]));
                t2.push(i2);
              }
              return t2;
            }
          }
          toGeoJSON(e2, t2, o2) {
            return f.call(this, e2, t2, o2);
          }
        }
        class g {
          constructor(t2) {
            this.layers = { _geojsonTileLayer: this }, this.name = "_geojsonTileLayer", this.extent = e.EXTENT, this.length = t2.length, this._features = t2;
          }
          feature(e2) {
            return new d(this._features[e2]);
          }
        }
        var m = { exports: {} }, y2 = e.pointGeometry, v2 = e.vectorTile.VectorTileFeature, x = w;
        function w(e2, t2) {
          this.options = t2 || {}, this.features = e2, this.length = e2.length;
        }
        function S(e2, t2) {
          this.id = "number" == typeof e2.id ? e2.id : void 0, this.type = e2.type, this.rawGeometry = 1 === e2.type ? [e2.geometry] : e2.geometry, this.properties = e2.tags, this.extent = t2 || 4096;
        }
        w.prototype.feature = function(e2) {
          return new S(this.features[e2], this.options.extent);
        }, S.prototype.loadGeometry = function() {
          var e2 = this.rawGeometry;
          this.geometry = [];
          for (var t2 = 0; t2 < e2.length; t2++) {
            for (var o2 = e2[t2], i2 = [], r2 = 0; r2 < o2.length; r2++)
              i2.push(new y2(o2[r2][0], o2[r2][1]));
            this.geometry.push(i2);
          }
          return this.geometry;
        }, S.prototype.bbox = function() {
          this.geometry || this.loadGeometry();
          for (var e2 = this.geometry, t2 = 1 / 0, o2 = -1 / 0, i2 = 1 / 0, r2 = -1 / 0, n2 = 0; n2 < e2.length; n2++)
            for (var s2 = e2[n2], a2 = 0; a2 < s2.length; a2++) {
              var l2 = s2[a2];
              t2 = Math.min(t2, l2.x), o2 = Math.max(o2, l2.x), i2 = Math.min(i2, l2.y), r2 = Math.max(r2, l2.y);
            }
          return [t2, i2, o2, r2];
        }, S.prototype.toGeoJSON = v2.prototype.toGeoJSON;
        var M = e.pbf, I2 = x;
        function b(e2) {
          var t2 = new M();
          return function(e3, t3) {
            for (var o2 in e3.layers)
              t3.writeMessage(3, k, e3.layers[o2]);
          }(e2, t2), t2.finish();
        }
        function k(e2, t2) {
          var o2;
          t2.writeVarintField(15, e2.version || 1), t2.writeStringField(1, e2.name || ""), t2.writeVarintField(5, e2.extent || 4096);
          var i2 = { keys: [], values: [], keycache: {}, valuecache: {} };
          for (o2 = 0; o2 < e2.length; o2++)
            i2.feature = e2.feature(o2), t2.writeMessage(2, P, i2);
          var r2 = i2.keys;
          for (o2 = 0; o2 < r2.length; o2++)
            t2.writeStringField(3, r2[o2]);
          var n2 = i2.values;
          for (o2 = 0; o2 < n2.length; o2++)
            t2.writeMessage(4, L, n2[o2]);
        }
        function P(e2, t2) {
          var o2 = e2.feature;
          void 0 !== o2.id && t2.writeVarintField(1, o2.id), t2.writeMessage(2, T, e2), t2.writeVarintField(3, o2.type), t2.writeMessage(4, D, o2);
        }
        function T(e2, t2) {
          var o2 = e2.feature, i2 = e2.keys, r2 = e2.values, n2 = e2.keycache, s2 = e2.valuecache;
          for (var a2 in o2.properties) {
            var l2 = o2.properties[a2], c3 = n2[a2];
            if (null !== l2) {
              void 0 === c3 && (i2.push(a2), n2[a2] = c3 = i2.length - 1), t2.writeVarint(c3);
              var u2 = typeof l2;
              "string" !== u2 && "boolean" !== u2 && "number" !== u2 && (l2 = JSON.stringify(l2));
              var h2 = u2 + ":" + l2, p3 = s2[h2];
              void 0 === p3 && (r2.push(l2), s2[h2] = p3 = r2.length - 1), t2.writeVarint(p3);
            }
          }
        }
        function C(e2, t2) {
          return (t2 << 3) + (7 & e2);
        }
        function _(e2) {
          return e2 << 1 ^ e2 >> 31;
        }
        function D(e2, t2) {
          for (var o2 = e2.loadGeometry(), i2 = e2.type, r2 = 0, n2 = 0, s2 = o2.length, a2 = 0; a2 < s2; a2++) {
            var l2 = o2[a2], c3 = 1;
            1 === i2 && (c3 = l2.length), t2.writeVarint(C(1, c3));
            for (var u2 = 3 === i2 ? l2.length - 1 : l2.length, h2 = 0; h2 < u2; h2++) {
              1 === h2 && 1 !== i2 && t2.writeVarint(C(2, u2 - 1));
              var p3 = l2[h2].x - r2, f2 = l2[h2].y - n2;
              t2.writeVarint(_(p3)), t2.writeVarint(_(f2)), r2 += p3, n2 += f2;
            }
            3 === i2 && t2.writeVarint(C(7, 1));
          }
        }
        function L(e2, t2) {
          var o2 = typeof e2;
          "string" === o2 ? t2.writeStringField(1, e2) : "boolean" === o2 ? t2.writeBooleanField(7, e2) : "number" === o2 && (e2 % 1 != 0 ? t2.writeDoubleField(3, e2) : e2 < 0 ? t2.writeSVarintField(6, e2) : t2.writeVarintField(5, e2));
        }
        function z(e2, t2, o2, i2, r2, n2) {
          if (r2 - i2 <= o2)
            return;
          const s2 = i2 + r2 >> 1;
          O2(e2, t2, s2, i2, r2, n2 % 2), z(e2, t2, o2, i2, s2 - 1, n2 + 1), z(e2, t2, o2, s2 + 1, r2, n2 + 1);
        }
        function O2(e2, t2, o2, i2, r2, n2) {
          for (; r2 > i2; ) {
            if (r2 - i2 > 600) {
              const s3 = r2 - i2 + 1, a3 = o2 - i2 + 1, l3 = Math.log(s3), c3 = 0.5 * Math.exp(2 * l3 / 3), u2 = 0.5 * Math.sqrt(l3 * c3 * (s3 - c3) / s3) * (a3 - s3 / 2 < 0 ? -1 : 1);
              O2(e2, t2, o2, Math.max(i2, Math.floor(o2 - a3 * c3 / s3 + u2)), Math.min(r2, Math.floor(o2 + (s3 - a3) * c3 / s3 + u2)), n2);
            }
            const s2 = t2[2 * o2 + n2];
            let a2 = i2, l2 = r2;
            for (E(e2, t2, i2, o2), t2[2 * r2 + n2] > s2 && E(e2, t2, i2, r2); a2 < l2; ) {
              for (E(e2, t2, a2, l2), a2++, l2--; t2[2 * a2 + n2] < s2; )
                a2++;
              for (; t2[2 * l2 + n2] > s2; )
                l2--;
            }
            t2[2 * i2 + n2] === s2 ? E(e2, t2, i2, l2) : (l2++, E(e2, t2, l2, r2)), l2 <= o2 && (i2 = l2 + 1), o2 <= l2 && (r2 = l2 - 1);
          }
        }
        function E(e2, t2, o2, i2) {
          F(e2, o2, i2), F(t2, 2 * o2, 2 * i2), F(t2, 2 * o2 + 1, 2 * i2 + 1);
        }
        function F(e2, t2, o2) {
          const i2 = e2[t2];
          e2[t2] = e2[o2], e2[o2] = i2;
        }
        function N(e2, t2, o2, i2) {
          const r2 = e2 - o2, n2 = t2 - i2;
          return r2 * r2 + n2 * n2;
        }
        m.exports = b, m.exports.fromVectorTileJs = b, m.exports.fromGeojsonVt = function(e2, t2) {
          t2 = t2 || {};
          var o2 = {};
          for (var i2 in e2)
            o2[i2] = new I2(e2[i2].features, t2), o2[i2].name = i2, o2[i2].version = t2.version, o2[i2].extent = t2.extent;
          return b({ layers: o2 });
        }, m.exports.GeoJSONWrapper = I2;
        const A2 = (e2) => e2[0], B = (e2) => e2[1];
        class J {
          constructor(e2, t2 = A2, o2 = B, i2 = 64, r2 = Float64Array) {
            this.nodeSize = i2, this.points = e2;
            const n2 = e2.length < 65536 ? Uint16Array : Uint32Array, s2 = this.ids = new n2(e2.length), a2 = this.coords = new r2(2 * e2.length);
            for (let i3 = 0; i3 < e2.length; i3++)
              s2[i3] = i3, a2[2 * i3] = t2(e2[i3]), a2[2 * i3 + 1] = o2(e2[i3]);
            z(s2, a2, i2, 0, s2.length - 1, 0);
          }
          range(e2, t2, o2, i2) {
            return function(e3, t3, o3, i3, r2, n2, s2) {
              const a2 = [0, e3.length - 1, 0], l2 = [];
              let c3, u2;
              for (; a2.length; ) {
                const h2 = a2.pop(), p3 = a2.pop(), f2 = a2.pop();
                if (p3 - f2 <= s2) {
                  for (let s3 = f2; s3 <= p3; s3++)
                    c3 = t3[2 * s3], u2 = t3[2 * s3 + 1], c3 >= o3 && c3 <= r2 && u2 >= i3 && u2 <= n2 && l2.push(e3[s3]);
                  continue;
                }
                const d2 = Math.floor((f2 + p3) / 2);
                c3 = t3[2 * d2], u2 = t3[2 * d2 + 1], c3 >= o3 && c3 <= r2 && u2 >= i3 && u2 <= n2 && l2.push(e3[d2]);
                const g2 = (h2 + 1) % 2;
                (0 === h2 ? o3 <= c3 : i3 <= u2) && (a2.push(f2), a2.push(d2 - 1), a2.push(g2)), (0 === h2 ? r2 >= c3 : n2 >= u2) && (a2.push(d2 + 1), a2.push(p3), a2.push(g2));
              }
              return l2;
            }(this.ids, this.coords, e2, t2, o2, i2, this.nodeSize);
          }
          within(e2, t2, o2) {
            return function(e3, t3, o3, i2, r2, n2) {
              const s2 = [0, e3.length - 1, 0], a2 = [], l2 = r2 * r2;
              for (; s2.length; ) {
                const c3 = s2.pop(), u2 = s2.pop(), h2 = s2.pop();
                if (u2 - h2 <= n2) {
                  for (let r3 = h2; r3 <= u2; r3++)
                    N(t3[2 * r3], t3[2 * r3 + 1], o3, i2) <= l2 && a2.push(e3[r3]);
                  continue;
                }
                const p3 = Math.floor((h2 + u2) / 2), f2 = t3[2 * p3], d2 = t3[2 * p3 + 1];
                N(f2, d2, o3, i2) <= l2 && a2.push(e3[p3]);
                const g2 = (c3 + 1) % 2;
                (0 === c3 ? o3 - r2 <= f2 : i2 - r2 <= d2) && (s2.push(h2), s2.push(p3 - 1), s2.push(g2)), (0 === c3 ? o3 + r2 >= f2 : i2 + r2 >= d2) && (s2.push(p3 + 1), s2.push(u2), s2.push(g2));
              }
              return a2;
            }(this.ids, this.coords, e2, t2, o2, this.nodeSize);
          }
        }
        const Z2 = { minZoom: 0, maxZoom: 16, minPoints: 2, radius: 40, extent: 512, nodeSize: 64, log: false, generateId: false, reduce: null, map: (e2) => e2 }, G = Math.fround || (j = new Float32Array(1), (e2) => (j[0] = +e2, j[0]));
        var j;
        class Y {
          constructor(e2) {
            this.options = H(Object.create(Z2), e2), this.trees = new Array(this.options.maxZoom + 1);
          }
          load(e2) {
            const { log: t2, minZoom: o2, maxZoom: i2, nodeSize: r2 } = this.options;
            t2 && console.time("total time");
            const n2 = `prepare ${e2.length} points`;
            t2 && console.time(n2), this.points = e2;
            let s2 = [];
            for (let t3 = 0; t3 < e2.length; t3++)
              e2[t3].geometry && s2.push(X(e2[t3], t3));
            this.trees[i2 + 1] = new J(s2, K, Q, r2, Float32Array), t2 && console.timeEnd(n2);
            for (let e3 = i2; e3 >= o2; e3--) {
              const o3 = +Date.now();
              s2 = this._cluster(s2, e3), this.trees[e3] = new J(s2, K, Q, r2, Float32Array), t2 && console.log("z%d: %d clusters in %dms", e3, s2.length, +Date.now() - o3);
            }
            return t2 && console.timeEnd("total time"), this;
          }
          getClusters(e2, t2) {
            let o2 = ((e2[0] + 180) % 360 + 360) % 360 - 180;
            const i2 = Math.max(-90, Math.min(90, e2[1]));
            let r2 = 180 === e2[2] ? 180 : ((e2[2] + 180) % 360 + 360) % 360 - 180;
            const n2 = Math.max(-90, Math.min(90, e2[3]));
            if (e2[2] - e2[0] >= 360)
              o2 = -180, r2 = 180;
            else if (o2 > r2) {
              const e3 = this.getClusters([o2, i2, 180, n2], t2), s3 = this.getClusters([-180, i2, r2, n2], t2);
              return e3.concat(s3);
            }
            const s2 = this.trees[this._limitZoom(t2)], a2 = s2.range($(o2), q(n2), $(r2), q(i2)), l2 = [];
            for (const e3 of a2) {
              const t3 = s2.points[e3];
              l2.push(t3.numPoints ? R(t3) : this.points[t3.index]);
            }
            return l2;
          }
          getChildren(e2) {
            const t2 = this._getOriginId(e2), o2 = this._getOriginZoom(e2), i2 = "No cluster with the specified id.", r2 = this.trees[o2];
            if (!r2)
              throw new Error(i2);
            const n2 = r2.points[t2];
            if (!n2)
              throw new Error(i2);
            const s2 = this.options.radius / (this.options.extent * Math.pow(2, o2 - 1)), a2 = r2.within(n2.x, n2.y, s2), l2 = [];
            for (const t3 of a2) {
              const o3 = r2.points[t3];
              o3.parentId === e2 && l2.push(o3.numPoints ? R(o3) : this.points[o3.index]);
            }
            if (0 === l2.length)
              throw new Error(i2);
            return l2;
          }
          getLeaves(e2, t2, o2) {
            const i2 = [];
            return this._appendLeaves(i2, e2, t2 = t2 || 10, o2 = o2 || 0, 0), i2;
          }
          getTile(e2, t2, o2) {
            const i2 = this.trees[this._limitZoom(e2)], r2 = Math.pow(2, e2), { extent: n2, radius: s2 } = this.options, a2 = s2 / n2, l2 = (o2 - a2) / r2, c3 = (o2 + 1 + a2) / r2, u2 = { features: [] };
            return this._addTileFeatures(i2.range((t2 - a2) / r2, l2, (t2 + 1 + a2) / r2, c3), i2.points, t2, o2, r2, u2), 0 === t2 && this._addTileFeatures(i2.range(1 - a2 / r2, l2, 1, c3), i2.points, r2, o2, r2, u2), t2 === r2 - 1 && this._addTileFeatures(i2.range(0, l2, a2 / r2, c3), i2.points, -1, o2, r2, u2), u2.features.length ? u2 : null;
          }
          getClusterExpansionZoom(e2) {
            let t2 = this._getOriginZoom(e2) - 1;
            for (; t2 <= this.options.maxZoom; ) {
              const o2 = this.getChildren(e2);
              if (t2++, 1 !== o2.length)
                break;
              e2 = o2[0].properties.cluster_id;
            }
            return t2;
          }
          _appendLeaves(e2, t2, o2, i2, r2) {
            const n2 = this.getChildren(t2);
            for (const t3 of n2) {
              const n3 = t3.properties;
              if (n3 && n3.cluster ? r2 + n3.point_count <= i2 ? r2 += n3.point_count : r2 = this._appendLeaves(e2, n3.cluster_id, o2, i2, r2) : r2 < i2 ? r2++ : e2.push(t3), e2.length === o2)
                break;
            }
            return r2;
          }
          _addTileFeatures(e2, t2, o2, i2, r2, n2) {
            for (const s2 of e2) {
              const e3 = t2[s2], a2 = e3.numPoints;
              let l2, c3, u2;
              if (a2)
                l2 = W(e3), c3 = e3.x, u2 = e3.y;
              else {
                const t3 = this.points[e3.index];
                l2 = t3.properties, c3 = $(t3.geometry.coordinates[0]), u2 = q(t3.geometry.coordinates[1]);
              }
              const h2 = { type: 1, geometry: [[Math.round(this.options.extent * (c3 * r2 - o2)), Math.round(this.options.extent * (u2 * r2 - i2))]], tags: l2 };
              let p3;
              a2 ? p3 = e3.id : this.options.generateId ? p3 = e3.index : this.points[e3.index].id && (p3 = this.points[e3.index].id), void 0 !== p3 && (h2.id = p3), n2.features.push(h2);
            }
          }
          _limitZoom(e2) {
            return Math.max(this.options.minZoom, Math.min(Math.floor(+e2), this.options.maxZoom + 1));
          }
          _cluster(e2, t2) {
            const o2 = [], { radius: i2, extent: r2, reduce: n2, minPoints: s2 } = this.options, a2 = i2 / (r2 * Math.pow(2, t2));
            for (let i3 = 0; i3 < e2.length; i3++) {
              const r3 = e2[i3];
              if (r3.zoom <= t2)
                continue;
              r3.zoom = t2;
              const l2 = this.trees[t2 + 1], c3 = l2.within(r3.x, r3.y, a2), u2 = r3.numPoints || 1;
              let h2 = u2;
              for (const e3 of c3) {
                const o3 = l2.points[e3];
                o3.zoom > t2 && (h2 += o3.numPoints || 1);
              }
              if (h2 > u2 && h2 >= s2) {
                let e3 = r3.x * u2, s3 = r3.y * u2, a3 = n2 && u2 > 1 ? this._map(r3, true) : null;
                const p3 = (i3 << 5) + (t2 + 1) + this.points.length;
                for (const o3 of c3) {
                  const i4 = l2.points[o3];
                  if (i4.zoom <= t2)
                    continue;
                  i4.zoom = t2;
                  const c4 = i4.numPoints || 1;
                  e3 += i4.x * c4, s3 += i4.y * c4, i4.parentId = p3, n2 && (a3 || (a3 = this._map(r3, true)), n2(a3, this._map(i4)));
                }
                r3.parentId = p3, o2.push(V2(e3 / h2, s3 / h2, p3, h2, a3));
              } else if (o2.push(r3), h2 > 1)
                for (const e3 of c3) {
                  const i4 = l2.points[e3];
                  i4.zoom <= t2 || (i4.zoom = t2, o2.push(i4));
                }
            }
            return o2;
          }
          _getOriginId(e2) {
            return e2 - this.points.length >> 5;
          }
          _getOriginZoom(e2) {
            return (e2 - this.points.length) % 32;
          }
          _map(e2, t2) {
            if (e2.numPoints)
              return t2 ? H({}, e2.properties) : e2.properties;
            const o2 = this.points[e2.index].properties, i2 = this.options.map(o2);
            return t2 && i2 === o2 ? H({}, i2) : i2;
          }
        }
        function V2(e2, t2, o2, i2, r2) {
          return { x: G(e2), y: G(t2), zoom: 1 / 0, id: o2, parentId: -1, numPoints: i2, properties: r2 };
        }
        function X(e2, t2) {
          const [o2, i2] = e2.geometry.coordinates;
          return { x: G($(o2)), y: G(q(i2)), zoom: 1 / 0, index: t2, parentId: -1 };
        }
        function R(e2) {
          return { type: "Feature", id: e2.id, properties: W(e2), geometry: { type: "Point", coordinates: [(t2 = e2.x, 360 * (t2 - 0.5)), U(e2.y)] } };
          var t2;
        }
        function W(e2) {
          const t2 = e2.numPoints, o2 = t2 >= 1e4 ? `${Math.round(t2 / 1e3)}k` : t2 >= 1e3 ? Math.round(t2 / 100) / 10 + "k" : t2;
          return H(H({}, e2.properties), { cluster: true, cluster_id: e2.id, point_count: t2, point_count_abbreviated: o2 });
        }
        function $(e2) {
          return e2 / 360 + 0.5;
        }
        function q(e2) {
          const t2 = Math.sin(e2 * Math.PI / 180), o2 = 0.5 - 0.25 * Math.log((1 + t2) / (1 - t2)) / Math.PI;
          return o2 < 0 ? 0 : o2 > 1 ? 1 : o2;
        }
        function U(e2) {
          const t2 = (180 - 360 * e2) * Math.PI / 180;
          return 360 * Math.atan(Math.exp(t2)) / Math.PI - 90;
        }
        function H(e2, t2) {
          for (const o2 in t2)
            e2[o2] = t2[o2];
          return e2;
        }
        function K(e2) {
          return e2.x;
        }
        function Q(e2) {
          return e2.y;
        }
        function ee(e2, t2, o2, i2) {
          for (var r2, n2 = i2, s2 = o2 - t2 >> 1, a2 = o2 - t2, l2 = e2[t2], c3 = e2[t2 + 1], u2 = e2[o2], h2 = e2[o2 + 1], p3 = t2 + 3; p3 < o2; p3 += 3) {
            var f2 = te(e2[p3], e2[p3 + 1], l2, c3, u2, h2);
            if (f2 > n2)
              r2 = p3, n2 = f2;
            else if (f2 === n2) {
              var d2 = Math.abs(p3 - s2);
              d2 < a2 && (r2 = p3, a2 = d2);
            }
          }
          n2 > i2 && (r2 - t2 > 3 && ee(e2, t2, r2, i2), e2[r2 + 2] = n2, o2 - r2 > 3 && ee(e2, r2, o2, i2));
        }
        function te(e2, t2, o2, i2, r2, n2) {
          var s2 = r2 - o2, a2 = n2 - i2;
          if (0 !== s2 || 0 !== a2) {
            var l2 = ((e2 - o2) * s2 + (t2 - i2) * a2) / (s2 * s2 + a2 * a2);
            l2 > 1 ? (o2 = r2, i2 = n2) : l2 > 0 && (o2 += s2 * l2, i2 += a2 * l2);
          }
          return (s2 = e2 - o2) * s2 + (a2 = t2 - i2) * a2;
        }
        function oe(e2, t2, o2, i2) {
          var r2 = { id: void 0 === e2 ? null : e2, type: t2, geometry: o2, tags: i2, minX: 1 / 0, minY: 1 / 0, maxX: -1 / 0, maxY: -1 / 0 };
          return function(e3) {
            var t3 = e3.geometry, o3 = e3.type;
            if ("Point" === o3 || "MultiPoint" === o3 || "LineString" === o3)
              ie(e3, t3);
            else if ("Polygon" === o3 || "MultiLineString" === o3)
              for (var i3 = 0; i3 < t3.length; i3++)
                ie(e3, t3[i3]);
            else if ("MultiPolygon" === o3)
              for (i3 = 0; i3 < t3.length; i3++)
                for (var r3 = 0; r3 < t3[i3].length; r3++)
                  ie(e3, t3[i3][r3]);
          }(r2), r2;
        }
        function ie(e2, t2) {
          for (var o2 = 0; o2 < t2.length; o2 += 3)
            e2.minX = Math.min(e2.minX, t2[o2]), e2.minY = Math.min(e2.minY, t2[o2 + 1]), e2.maxX = Math.max(e2.maxX, t2[o2]), e2.maxY = Math.max(e2.maxY, t2[o2 + 1]);
        }
        function re(e2, t2, o2, i2) {
          if (t2.geometry) {
            var r2 = t2.geometry.coordinates, n2 = t2.geometry.type, s2 = Math.pow(o2.tolerance / ((1 << o2.maxZoom) * o2.extent), 2), a2 = [], l2 = t2.id;
            if (o2.promoteId ? l2 = t2.properties[o2.promoteId] : o2.generateId && (l2 = i2 || 0), "Point" === n2)
              ne(r2, a2);
            else if ("MultiPoint" === n2)
              for (var c3 = 0; c3 < r2.length; c3++)
                ne(r2[c3], a2);
            else if ("LineString" === n2)
              se(r2, a2, s2, false);
            else if ("MultiLineString" === n2) {
              if (o2.lineMetrics) {
                for (c3 = 0; c3 < r2.length; c3++)
                  se(r2[c3], a2 = [], s2, false), e2.push(oe(l2, "LineString", a2, t2.properties));
                return;
              }
              ae(r2, a2, s2, false);
            } else if ("Polygon" === n2)
              ae(r2, a2, s2, true);
            else {
              if ("MultiPolygon" !== n2) {
                if ("GeometryCollection" === n2) {
                  for (c3 = 0; c3 < t2.geometry.geometries.length; c3++)
                    re(e2, { id: l2, geometry: t2.geometry.geometries[c3], properties: t2.properties }, o2, i2);
                  return;
                }
                throw new Error("Input data is not a valid GeoJSON object.");
              }
              for (c3 = 0; c3 < r2.length; c3++) {
                var u2 = [];
                ae(r2[c3], u2, s2, true), a2.push(u2);
              }
            }
            e2.push(oe(l2, n2, a2, t2.properties));
          }
        }
        function ne(e2, t2) {
          t2.push(le(e2[0])), t2.push(ce(e2[1])), t2.push(0);
        }
        function se(e2, t2, o2, i2) {
          for (var r2, n2, s2 = 0, a2 = 0; a2 < e2.length; a2++) {
            var l2 = le(e2[a2][0]), c3 = ce(e2[a2][1]);
            t2.push(l2), t2.push(c3), t2.push(0), a2 > 0 && (s2 += i2 ? (r2 * c3 - l2 * n2) / 2 : Math.sqrt(Math.pow(l2 - r2, 2) + Math.pow(c3 - n2, 2))), r2 = l2, n2 = c3;
          }
          var u2 = t2.length - 3;
          t2[2] = 1, ee(t2, 0, u2, o2), t2[u2 + 2] = 1, t2.size = Math.abs(s2), t2.start = 0, t2.end = t2.size;
        }
        function ae(e2, t2, o2, i2) {
          for (var r2 = 0; r2 < e2.length; r2++) {
            var n2 = [];
            se(e2[r2], n2, o2, i2), t2.push(n2);
          }
        }
        function le(e2) {
          return e2 / 360 + 0.5;
        }
        function ce(e2) {
          var t2 = Math.sin(e2 * Math.PI / 180), o2 = 0.5 - 0.25 * Math.log((1 + t2) / (1 - t2)) / Math.PI;
          return o2 < 0 ? 0 : o2 > 1 ? 1 : o2;
        }
        function ue(e2, t2, o2, i2, r2, n2, s2, a2) {
          if (i2 /= t2, n2 >= (o2 /= t2) && s2 < i2)
            return e2;
          if (s2 < o2 || n2 >= i2)
            return null;
          for (var l2 = [], c3 = 0; c3 < e2.length; c3++) {
            var u2 = e2[c3], h2 = u2.geometry, p3 = u2.type, f2 = 0 === r2 ? u2.minX : u2.minY, d2 = 0 === r2 ? u2.maxX : u2.maxY;
            if (f2 >= o2 && d2 < i2)
              l2.push(u2);
            else if (!(d2 < o2 || f2 >= i2)) {
              var g2 = [];
              if ("Point" === p3 || "MultiPoint" === p3)
                he(h2, g2, o2, i2, r2);
              else if ("LineString" === p3)
                pe(h2, g2, o2, i2, r2, false, a2.lineMetrics);
              else if ("MultiLineString" === p3)
                de(h2, g2, o2, i2, r2, false);
              else if ("Polygon" === p3)
                de(h2, g2, o2, i2, r2, true);
              else if ("MultiPolygon" === p3)
                for (var m2 = 0; m2 < h2.length; m2++) {
                  var y3 = [];
                  de(h2[m2], y3, o2, i2, r2, true), y3.length && g2.push(y3);
                }
              if (g2.length) {
                if (a2.lineMetrics && "LineString" === p3) {
                  for (m2 = 0; m2 < g2.length; m2++)
                    l2.push(oe(u2.id, p3, g2[m2], u2.tags));
                  continue;
                }
                "LineString" !== p3 && "MultiLineString" !== p3 || (1 === g2.length ? (p3 = "LineString", g2 = g2[0]) : p3 = "MultiLineString"), "Point" !== p3 && "MultiPoint" !== p3 || (p3 = 3 === g2.length ? "Point" : "MultiPoint"), l2.push(oe(u2.id, p3, g2, u2.tags));
              }
            }
          }
          return l2.length ? l2 : null;
        }
        function he(e2, t2, o2, i2, r2) {
          for (var n2 = 0; n2 < e2.length; n2 += 3) {
            var s2 = e2[n2 + r2];
            s2 >= o2 && s2 <= i2 && (t2.push(e2[n2]), t2.push(e2[n2 + 1]), t2.push(e2[n2 + 2]));
          }
        }
        function pe(e2, t2, o2, i2, r2, n2, s2) {
          for (var a2, l2, c3 = fe(e2), u2 = 0 === r2 ? me : ye, h2 = e2.start, p3 = 0; p3 < e2.length - 3; p3 += 3) {
            var f2 = e2[p3], d2 = e2[p3 + 1], g2 = e2[p3 + 2], m2 = e2[p3 + 3], y3 = e2[p3 + 4], v3 = 0 === r2 ? f2 : d2, x2 = 0 === r2 ? m2 : y3, w2 = false;
            s2 && (a2 = Math.sqrt(Math.pow(f2 - m2, 2) + Math.pow(d2 - y3, 2))), v3 < o2 ? x2 > o2 && (l2 = u2(c3, f2, d2, m2, y3, o2), s2 && (c3.start = h2 + a2 * l2)) : v3 > i2 ? x2 < i2 && (l2 = u2(c3, f2, d2, m2, y3, i2), s2 && (c3.start = h2 + a2 * l2)) : ge(c3, f2, d2, g2), x2 < o2 && v3 >= o2 && (l2 = u2(c3, f2, d2, m2, y3, o2), w2 = true), x2 > i2 && v3 <= i2 && (l2 = u2(c3, f2, d2, m2, y3, i2), w2 = true), !n2 && w2 && (s2 && (c3.end = h2 + a2 * l2), t2.push(c3), c3 = fe(e2)), s2 && (h2 += a2);
          }
          var S2 = e2.length - 3;
          f2 = e2[S2], d2 = e2[S2 + 1], g2 = e2[S2 + 2], (v3 = 0 === r2 ? f2 : d2) >= o2 && v3 <= i2 && ge(c3, f2, d2, g2), S2 = c3.length - 3, n2 && S2 >= 3 && (c3[S2] !== c3[0] || c3[S2 + 1] !== c3[1]) && ge(c3, c3[0], c3[1], c3[2]), c3.length && t2.push(c3);
        }
        function fe(e2) {
          var t2 = [];
          return t2.size = e2.size, t2.start = e2.start, t2.end = e2.end, t2;
        }
        function de(e2, t2, o2, i2, r2, n2) {
          for (var s2 = 0; s2 < e2.length; s2++)
            pe(e2[s2], t2, o2, i2, r2, n2, false);
        }
        function ge(e2, t2, o2, i2) {
          e2.push(t2), e2.push(o2), e2.push(i2);
        }
        function me(e2, t2, o2, i2, r2, n2) {
          var s2 = (n2 - t2) / (i2 - t2);
          return e2.push(n2), e2.push(o2 + (r2 - o2) * s2), e2.push(1), s2;
        }
        function ye(e2, t2, o2, i2, r2, n2) {
          var s2 = (n2 - o2) / (r2 - o2);
          return e2.push(t2 + (i2 - t2) * s2), e2.push(n2), e2.push(1), s2;
        }
        function ve(e2, t2) {
          for (var o2 = [], i2 = 0; i2 < e2.length; i2++) {
            var r2, n2 = e2[i2], s2 = n2.type;
            if ("Point" === s2 || "MultiPoint" === s2 || "LineString" === s2)
              r2 = xe(n2.geometry, t2);
            else if ("MultiLineString" === s2 || "Polygon" === s2) {
              r2 = [];
              for (var a2 = 0; a2 < n2.geometry.length; a2++)
                r2.push(xe(n2.geometry[a2], t2));
            } else if ("MultiPolygon" === s2)
              for (r2 = [], a2 = 0; a2 < n2.geometry.length; a2++) {
                for (var l2 = [], c3 = 0; c3 < n2.geometry[a2].length; c3++)
                  l2.push(xe(n2.geometry[a2][c3], t2));
                r2.push(l2);
              }
            o2.push(oe(n2.id, s2, r2, n2.tags));
          }
          return o2;
        }
        function xe(e2, t2) {
          var o2 = [];
          o2.size = e2.size, void 0 !== e2.start && (o2.start = e2.start, o2.end = e2.end);
          for (var i2 = 0; i2 < e2.length; i2 += 3)
            o2.push(e2[i2] + t2, e2[i2 + 1], e2[i2 + 2]);
          return o2;
        }
        function we(e2, t2) {
          if (e2.transformed)
            return e2;
          var o2, i2, r2, n2 = 1 << e2.z, s2 = e2.x, a2 = e2.y;
          for (o2 = 0; o2 < e2.features.length; o2++) {
            var l2 = e2.features[o2], c3 = l2.geometry, u2 = l2.type;
            if (l2.geometry = [], 1 === u2)
              for (i2 = 0; i2 < c3.length; i2 += 2)
                l2.geometry.push(Se(c3[i2], c3[i2 + 1], t2, n2, s2, a2));
            else
              for (i2 = 0; i2 < c3.length; i2++) {
                var h2 = [];
                for (r2 = 0; r2 < c3[i2].length; r2 += 2)
                  h2.push(Se(c3[i2][r2], c3[i2][r2 + 1], t2, n2, s2, a2));
                l2.geometry.push(h2);
              }
          }
          return e2.transformed = true, e2;
        }
        function Se(e2, t2, o2, i2, r2, n2) {
          return [Math.round(o2 * (e2 * i2 - r2)), Math.round(o2 * (t2 * i2 - n2))];
        }
        function Me(e2, t2, o2, i2, r2) {
          for (var n2 = t2 === r2.maxZoom ? 0 : r2.tolerance / ((1 << t2) * r2.extent), s2 = { features: [], numPoints: 0, numSimplified: 0, numFeatures: 0, source: null, x: o2, y: i2, z: t2, transformed: false, minX: 2, minY: 1, maxX: -1, maxY: 0 }, a2 = 0; a2 < e2.length; a2++) {
            s2.numFeatures++, Ie(s2, e2[a2], n2, r2);
            var l2 = e2[a2].minX, c3 = e2[a2].minY, u2 = e2[a2].maxX, h2 = e2[a2].maxY;
            l2 < s2.minX && (s2.minX = l2), c3 < s2.minY && (s2.minY = c3), u2 > s2.maxX && (s2.maxX = u2), h2 > s2.maxY && (s2.maxY = h2);
          }
          return s2;
        }
        function Ie(e2, t2, o2, i2) {
          var r2 = t2.geometry, n2 = t2.type, s2 = [];
          if ("Point" === n2 || "MultiPoint" === n2)
            for (var a2 = 0; a2 < r2.length; a2 += 3)
              s2.push(r2[a2]), s2.push(r2[a2 + 1]), e2.numPoints++, e2.numSimplified++;
          else if ("LineString" === n2)
            be(s2, r2, e2, o2, false, false);
          else if ("MultiLineString" === n2 || "Polygon" === n2)
            for (a2 = 0; a2 < r2.length; a2++)
              be(s2, r2[a2], e2, o2, "Polygon" === n2, 0 === a2);
          else if ("MultiPolygon" === n2)
            for (var l2 = 0; l2 < r2.length; l2++) {
              var c3 = r2[l2];
              for (a2 = 0; a2 < c3.length; a2++)
                be(s2, c3[a2], e2, o2, true, 0 === a2);
            }
          if (s2.length) {
            var u2 = t2.tags || null;
            if ("LineString" === n2 && i2.lineMetrics) {
              for (var h2 in u2 = {}, t2.tags)
                u2[h2] = t2.tags[h2];
              u2.mapbox_clip_start = r2.start / r2.size, u2.mapbox_clip_end = r2.end / r2.size;
            }
            var p3 = { geometry: s2, type: "Polygon" === n2 || "MultiPolygon" === n2 ? 3 : "LineString" === n2 || "MultiLineString" === n2 ? 2 : 1, tags: u2 };
            null !== t2.id && (p3.id = t2.id), e2.features.push(p3);
          }
        }
        function be(e2, t2, o2, i2, r2, n2) {
          var s2 = i2 * i2;
          if (i2 > 0 && t2.size < (r2 ? s2 : i2))
            o2.numPoints += t2.length / 3;
          else {
            for (var a2 = [], l2 = 0; l2 < t2.length; l2 += 3)
              (0 === i2 || t2[l2 + 2] > s2) && (o2.numSimplified++, a2.push(t2[l2]), a2.push(t2[l2 + 1])), o2.numPoints++;
            r2 && function(e3, t3) {
              for (var o3 = 0, i3 = 0, r3 = e3.length, n3 = r3 - 2; i3 < r3; n3 = i3, i3 += 2)
                o3 += (e3[i3] - e3[n3]) * (e3[i3 + 1] + e3[n3 + 1]);
              if (o3 > 0 === t3)
                for (i3 = 0, r3 = e3.length; i3 < r3 / 2; i3 += 2) {
                  var s3 = e3[i3], a3 = e3[i3 + 1];
                  e3[i3] = e3[r3 - 2 - i3], e3[i3 + 1] = e3[r3 - 1 - i3], e3[r3 - 2 - i3] = s3, e3[r3 - 1 - i3] = a3;
                }
            }(a2, n2), e2.push(a2);
          }
        }
        function ke(e2, t2) {
          var o2 = (t2 = this.options = function(e3, t3) {
            for (var o3 in t3)
              e3[o3] = t3[o3];
            return e3;
          }(Object.create(this.options), t2)).debug;
          if (o2 && console.time("preprocess data"), t2.maxZoom < 0 || t2.maxZoom > 24)
            throw new Error("maxZoom should be in the 0-24 range");
          if (t2.promoteId && t2.generateId)
            throw new Error("promoteId and generateId cannot be used together.");
          var i2 = function(e3, t3) {
            var o3 = [];
            if ("FeatureCollection" === e3.type)
              for (var i3 = 0; i3 < e3.features.length; i3++)
                re(o3, e3.features[i3], t3, i3);
            else
              re(o3, "Feature" === e3.type ? e3 : { geometry: e3 }, t3);
            return o3;
          }(e2, t2);
          this.tiles = {}, this.tileCoords = [], o2 && (console.timeEnd("preprocess data"), console.log("index: maxZoom: %d, maxPoints: %d", t2.indexMaxZoom, t2.indexMaxPoints), console.time("generate tiles"), this.stats = {}, this.total = 0), i2 = function(e3, t3) {
            var o3 = t3.buffer / t3.extent, i3 = e3, r2 = ue(e3, 1, -1 - o3, o3, 0, -1, 2, t3), n2 = ue(e3, 1, 1 - o3, 2 + o3, 0, -1, 2, t3);
            return (r2 || n2) && (i3 = ue(e3, 1, -o3, 1 + o3, 0, -1, 2, t3) || [], r2 && (i3 = ve(r2, 1).concat(i3)), n2 && (i3 = i3.concat(ve(n2, -1)))), i3;
          }(i2, t2), i2.length && this.splitTile(i2, 0, 0, 0), o2 && (i2.length && console.log("features: %d, points: %d", this.tiles[0].numFeatures, this.tiles[0].numPoints), console.timeEnd("generate tiles"), console.log("tiles generated:", this.total, JSON.stringify(this.stats)));
        }
        function Pe(e2, t2, o2) {
          return 32 * ((1 << e2) * o2 + t2) + e2;
        }
        function Te(e2, t2) {
          const o2 = e2.tileID.canonical;
          if (!this._geoJSONIndex)
            return t2(null, null);
          const i2 = this._geoJSONIndex.getTile(o2.z, o2.x, o2.y);
          if (!i2)
            return t2(null, null);
          const r2 = new g(i2.features);
          let n2 = m.exports(r2);
          0 === n2.byteOffset && n2.byteLength === n2.buffer.byteLength || (n2 = new Uint8Array(n2)), t2(null, { vectorTile: r2, rawData: n2.buffer });
        }
        ke.prototype.options = { maxZoom: 14, indexMaxZoom: 5, indexMaxPoints: 1e5, tolerance: 3, extent: 4096, buffer: 64, lineMetrics: false, promoteId: null, generateId: false, debug: 0 }, ke.prototype.splitTile = function(e2, t2, o2, i2, r2, n2, s2) {
          for (var a2 = [e2, t2, o2, i2], l2 = this.options, c3 = l2.debug; a2.length; ) {
            i2 = a2.pop(), o2 = a2.pop(), t2 = a2.pop(), e2 = a2.pop();
            var u2 = 1 << t2, h2 = Pe(t2, o2, i2), p3 = this.tiles[h2];
            if (!p3 && (c3 > 1 && console.time("creation"), p3 = this.tiles[h2] = Me(e2, t2, o2, i2, l2), this.tileCoords.push({ z: t2, x: o2, y: i2 }), c3)) {
              c3 > 1 && (console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)", t2, o2, i2, p3.numFeatures, p3.numPoints, p3.numSimplified), console.timeEnd("creation"));
              var f2 = "z" + t2;
              this.stats[f2] = (this.stats[f2] || 0) + 1, this.total++;
            }
            if (p3.source = e2, r2) {
              if (t2 === l2.maxZoom || t2 === r2)
                continue;
              var d2 = 1 << r2 - t2;
              if (o2 !== Math.floor(n2 / d2) || i2 !== Math.floor(s2 / d2))
                continue;
            } else if (t2 === l2.indexMaxZoom || p3.numPoints <= l2.indexMaxPoints)
              continue;
            if (p3.source = null, 0 !== e2.length) {
              c3 > 1 && console.time("clipping");
              var g2, m2, y3, v3, x2, w2, S2 = 0.5 * l2.buffer / l2.extent, M2 = 0.5 - S2, I3 = 0.5 + S2, b2 = 1 + S2;
              g2 = m2 = y3 = v3 = null, x2 = ue(e2, u2, o2 - S2, o2 + I3, 0, p3.minX, p3.maxX, l2), w2 = ue(e2, u2, o2 + M2, o2 + b2, 0, p3.minX, p3.maxX, l2), e2 = null, x2 && (g2 = ue(x2, u2, i2 - S2, i2 + I3, 1, p3.minY, p3.maxY, l2), m2 = ue(x2, u2, i2 + M2, i2 + b2, 1, p3.minY, p3.maxY, l2), x2 = null), w2 && (y3 = ue(w2, u2, i2 - S2, i2 + I3, 1, p3.minY, p3.maxY, l2), v3 = ue(w2, u2, i2 + M2, i2 + b2, 1, p3.minY, p3.maxY, l2), w2 = null), c3 > 1 && console.timeEnd("clipping"), a2.push(g2 || [], t2 + 1, 2 * o2, 2 * i2), a2.push(m2 || [], t2 + 1, 2 * o2, 2 * i2 + 1), a2.push(y3 || [], t2 + 1, 2 * o2 + 1, 2 * i2), a2.push(v3 || [], t2 + 1, 2 * o2 + 1, 2 * i2 + 1);
            }
          }
        }, ke.prototype.getTile = function(e2, t2, o2) {
          var i2 = this.options, r2 = i2.extent, n2 = i2.debug;
          if (e2 < 0 || e2 > 24)
            return null;
          var s2 = 1 << e2, a2 = Pe(e2, t2 = (t2 % s2 + s2) % s2, o2);
          if (this.tiles[a2])
            return we(this.tiles[a2], r2);
          n2 > 1 && console.log("drilling down to z%d-%d-%d", e2, t2, o2);
          for (var l2, c3 = e2, u2 = t2, h2 = o2; !l2 && c3 > 0; )
            c3--, u2 = Math.floor(u2 / 2), h2 = Math.floor(h2 / 2), l2 = this.tiles[Pe(c3, u2, h2)];
          return l2 && l2.source ? (n2 > 1 && console.log("found parent tile z%d-%d-%d", c3, u2, h2), n2 > 1 && console.time("drilling down"), this.splitTile(l2.source, c3, u2, h2, e2, t2, o2), n2 > 1 && console.timeEnd("drilling down"), this.tiles[a2] ? we(this.tiles[a2], r2) : null) : null;
        };
        class Ce extends l {
          constructor(e2, t2, o2, i2) {
            super(e2, t2, o2, Te), i2 && (this.loadGeoJSON = i2);
          }
          loadData(t2, o2) {
            var i2;
            null === (i2 = this._pendingRequest) || void 0 === i2 || i2.cancel(), this._pendingCallback && this._pendingCallback(null, { abandoned: true });
            const r2 = !!(t2 && t2.request && t2.request.collectResourceTiming) && new e.RequestPerformance(t2.request);
            this._pendingCallback = o2, this._pendingRequest = this.loadGeoJSON(t2, (i3, n2) => {
              if (delete this._pendingCallback, delete this._pendingRequest, i3 || !n2)
                return o2(i3);
              if ("object" != typeof n2)
                return o2(new Error(`Input data given to '${t2.source}' is not a valid GeoJSON object.`));
              {
                u(n2, true);
                try {
                  if (t2.filter) {
                    const o3 = e.createExpression(t2.filter, { type: "boolean", "property-type": "data-driven", overridable: false, transition: false });
                    if ("error" === o3.result)
                      throw new Error(o3.value.map((e2) => `${e2.key}: ${e2.message}`).join(", "));
                    const i4 = n2.features.filter((e2) => o3.value.evaluate({ zoom: 0 }, e2));
                    n2 = { type: "FeatureCollection", features: i4 };
                  }
                  this._geoJSONIndex = t2.cluster ? new Y(function({ superclusterOptions: t3, clusterProperties: o3 }) {
                    if (!o3 || !t3)
                      return t3;
                    const i4 = {}, r3 = {}, n3 = { accumulated: null, zoom: 0 }, s3 = { properties: null }, a2 = Object.keys(o3);
                    for (const t4 of a2) {
                      const [n4, s4] = o3[t4], a3 = e.createExpression(s4), l2 = e.createExpression("string" == typeof n4 ? [n4, ["accumulated"], ["get", t4]] : n4);
                      i4[t4] = a3.value, r3[t4] = l2.value;
                    }
                    return t3.map = (e2) => {
                      s3.properties = e2;
                      const t4 = {};
                      for (const e3 of a2)
                        t4[e3] = i4[e3].evaluate(n3, s3);
                      return t4;
                    }, t3.reduce = (e2, t4) => {
                      s3.properties = t4;
                      for (const t5 of a2)
                        n3.accumulated = e2[t5], e2[t5] = r3[t5].evaluate(n3, s3);
                    }, t3;
                  }(t2)).load(n2.features) : function(e2, t3) {
                    return new ke(e2, t3);
                  }(n2, t2.geojsonVtOptions);
                } catch (i4) {
                  return o2(i4);
                }
                this.loaded = {};
                const s2 = {};
                if (r2) {
                  const e2 = r2.finish();
                  e2 && (s2.resourceTiming = {}, s2.resourceTiming[t2.source] = JSON.parse(JSON.stringify(e2)));
                }
                o2(null, s2);
              }
            });
          }
          reloadTile(e2, t2) {
            const o2 = this.loaded;
            return o2 && o2[e2.uid] ? super.reloadTile(e2, t2) : this.loadTile(e2, t2);
          }
          loadGeoJSON(t2, o2) {
            if (t2.request)
              return e.getJSON(t2.request, o2);
            if ("string" == typeof t2.data)
              try {
                o2(null, JSON.parse(t2.data));
              } catch (e2) {
                o2(new Error(`Input data given to '${t2.source}' is not a valid GeoJSON object.`));
              }
            else
              o2(new Error(`Input data given to '${t2.source}' is not a valid GeoJSON object.`));
            return { cancel: () => {
            } };
          }
          removeSource(e2, t2) {
            this._pendingCallback && this._pendingCallback(null, { abandoned: true }), t2();
          }
          getClusterExpansionZoom(e2, t2) {
            try {
              t2(null, this._geoJSONIndex.getClusterExpansionZoom(e2.clusterId));
            } catch (e3) {
              t2(e3);
            }
          }
          getClusterChildren(e2, t2) {
            try {
              t2(null, this._geoJSONIndex.getChildren(e2.clusterId));
            } catch (e3) {
              t2(e3);
            }
          }
          getClusterLeaves(e2, t2) {
            try {
              t2(null, this._geoJSONIndex.getLeaves(e2.clusterId, e2.limit, e2.offset));
            } catch (e3) {
              t2(e3);
            }
          }
        }
        class _e {
          constructor(t2) {
            this.self = t2, this.actor = new e.Actor(t2, this), this.layerIndexes = {}, this.availableImages = {}, this.workerSourceTypes = { vector: l, geojson: Ce }, this.workerSources = {}, this.demWorkerSources = {}, this.self.registerWorkerSource = (e2, t3) => {
              if (this.workerSourceTypes[e2])
                throw new Error(`Worker source with name "${e2}" already registered.`);
              this.workerSourceTypes[e2] = t3;
            }, this.self.registerRTLTextPlugin = (t3) => {
              if (e.plugin.isParsed())
                throw new Error("RTL text plugin already registered.");
              e.plugin.applyArabicShaping = t3.applyArabicShaping, e.plugin.processBidirectionalText = t3.processBidirectionalText, e.plugin.processStyledBidirectionalText = t3.processStyledBidirectionalText;
            };
          }
          setReferrer(e2, t2) {
            this.referrer = t2;
          }
          setImages(e2, t2, o2) {
            this.availableImages[e2] = t2;
            for (const o3 in this.workerSources[e2]) {
              const i2 = this.workerSources[e2][o3];
              for (const e3 in i2)
                i2[e3].availableImages = t2;
            }
            o2();
          }
          setLayers(e2, t2, o2) {
            this.getLayerIndex(e2).replace(t2), o2();
          }
          updateLayers(e2, t2, o2) {
            this.getLayerIndex(e2).update(t2.layers, t2.removedIds), o2();
          }
          loadTile(e2, t2, o2) {
            this.getWorkerSource(e2, t2.type, t2.source).loadTile(t2, o2);
          }
          loadDEMTile(e2, t2, o2) {
            this.getDEMWorkerSource(e2, t2.source).loadTile(t2, o2);
          }
          reloadTile(e2, t2, o2) {
            this.getWorkerSource(e2, t2.type, t2.source).reloadTile(t2, o2);
          }
          abortTile(e2, t2, o2) {
            this.getWorkerSource(e2, t2.type, t2.source).abortTile(t2, o2);
          }
          removeTile(e2, t2, o2) {
            this.getWorkerSource(e2, t2.type, t2.source).removeTile(t2, o2);
          }
          removeDEMTile(e2, t2) {
            this.getDEMWorkerSource(e2, t2.source).removeTile(t2);
          }
          removeSource(e2, t2, o2) {
            if (!this.workerSources[e2] || !this.workerSources[e2][t2.type] || !this.workerSources[e2][t2.type][t2.source])
              return;
            const i2 = this.workerSources[e2][t2.type][t2.source];
            delete this.workerSources[e2][t2.type][t2.source], void 0 !== i2.removeSource ? i2.removeSource(t2, o2) : o2();
          }
          loadWorkerSource(e2, t2, o2) {
            try {
              this.self.importScripts(t2.url), o2();
            } catch (e3) {
              o2(e3.toString());
            }
          }
          syncRTLPluginState(t2, o2, i2) {
            try {
              e.plugin.setState(o2);
              const t3 = e.plugin.getPluginURL();
              if (e.plugin.isLoaded() && !e.plugin.isParsed() && null != t3) {
                this.self.importScripts(t3);
                const o3 = e.plugin.isParsed();
                i2(o3 ? void 0 : new Error(`RTL Text Plugin failed to import scripts from ${t3}`), o3);
              }
            } catch (e2) {
              i2(e2.toString());
            }
          }
          getAvailableImages(e2) {
            let t2 = this.availableImages[e2];
            return t2 || (t2 = []), t2;
          }
          getLayerIndex(e2) {
            let t2 = this.layerIndexes[e2];
            return t2 || (t2 = this.layerIndexes[e2] = new i()), t2;
          }
          getWorkerSource(e2, t2, o2) {
            if (this.workerSources[e2] || (this.workerSources[e2] = {}), this.workerSources[e2][t2] || (this.workerSources[e2][t2] = {}), !this.workerSources[e2][t2][o2]) {
              const i2 = { send: (t3, o3, i3) => {
                this.actor.send(t3, o3, i3, e2);
              } };
              this.workerSources[e2][t2][o2] = new this.workerSourceTypes[t2](i2, this.getLayerIndex(e2), this.getAvailableImages(e2));
            }
            return this.workerSources[e2][t2][o2];
          }
          getDEMWorkerSource(e2, t2) {
            return this.demWorkerSources[e2] || (this.demWorkerSources[e2] = {}), this.demWorkerSources[e2][t2] || (this.demWorkerSources[e2][t2] = new c2()), this.demWorkerSources[e2][t2];
          }
          enforceCacheSizeLimit(t2, o2) {
            e.enforceCacheSizeLimit(o2);
          }
        }
        return e.isWorker() && (self.worker = new _e(self)), _e;
      });
      define2(["./shared"], function(t) {
        var e = i;
        function i(t2) {
          return !function(t3) {
            return "undefined" == typeof window || "undefined" == typeof document ? "not a browser" : Array.prototype && Array.prototype.every && Array.prototype.filter && Array.prototype.forEach && Array.prototype.indexOf && Array.prototype.lastIndexOf && Array.prototype.map && Array.prototype.some && Array.prototype.reduce && Array.prototype.reduceRight && Array.isArray ? Function.prototype && Function.prototype.bind ? Object.keys && Object.create && Object.getPrototypeOf && Object.getOwnPropertyNames && Object.isSealed && Object.isFrozen && Object.isExtensible && Object.getOwnPropertyDescriptor && Object.defineProperty && Object.defineProperties && Object.seal && Object.freeze && Object.preventExtensions ? "JSON" in window && "parse" in JSON && "stringify" in JSON ? function() {
              if (!("Worker" in window && "Blob" in window && "URL" in window))
                return false;
              var t4, e3, i2 = new Blob([""], { type: "text/javascript" }), o2 = URL.createObjectURL(i2);
              try {
                e3 = new Worker(o2), t4 = true;
              } catch (e4) {
                t4 = false;
              }
              return e3 && e3.terminate(), URL.revokeObjectURL(o2), t4;
            }() ? "Uint8ClampedArray" in window ? ArrayBuffer.isView ? function() {
              var t4 = document.createElement("canvas");
              t4.width = t4.height = 1;
              var e3 = t4.getContext("2d");
              if (!e3)
                return false;
              var i2 = e3.getImageData(0, 0, 1, 1);
              return i2 && i2.width === t4.width;
            }() ? (void 0 === o[e2 = t3 && t3.failIfMajorPerformanceCaveat] && (o[e2] = function(t4) {
              var e3, o2 = function(t5) {
                var e4 = document.createElement("canvas"), o3 = Object.create(i.webGLContextAttributes);
                return o3.failIfMajorPerformanceCaveat = t5, e4.getContext("webgl", o3) || e4.getContext("experimental-webgl", o3);
              }(t4);
              if (!o2)
                return false;
              try {
                e3 = o2.createShader(o2.VERTEX_SHADER);
              } catch (t5) {
                return false;
              }
              return !(!e3 || o2.isContextLost()) && (o2.shaderSource(e3, "void main() {}"), o2.compileShader(e3), true === o2.getShaderParameter(e3, o2.COMPILE_STATUS));
            }(e2)), o[e2] ? document.documentMode ? "insufficient ECMAScript 6 support" : void 0 : "insufficient WebGL support") : "insufficient Canvas/getImageData support" : "insufficient ArrayBuffer support" : "insufficient Uint8ClampedArray support" : "insufficient worker support" : "insufficient JSON support" : "insufficient Object support" : "insufficient Function support" : "insufficent Array support";
            var e2;
          }(t2);
        }
        var o = {};
        function a(t2, e2) {
          if (Array.isArray(t2)) {
            if (!Array.isArray(e2) || t2.length !== e2.length)
              return false;
            for (let i2 = 0; i2 < t2.length; i2++)
              if (!a(t2[i2], e2[i2]))
                return false;
            return true;
          }
          if ("object" == typeof t2 && null !== t2 && null !== e2) {
            if ("object" != typeof e2)
              return false;
            if (Object.keys(t2).length !== Object.keys(e2).length)
              return false;
            for (const i2 in t2)
              if (!a(t2[i2], e2[i2]))
                return false;
            return true;
          }
          return t2 === e2;
        }
        i.webGLContextAttributes = { antialias: false, alpha: true, stencil: true, depth: true };
        class r {
          static testProp(t2) {
            if (!r.docStyle)
              return t2[0];
            for (let e2 = 0; e2 < t2.length; e2++)
              if (t2[e2] in r.docStyle)
                return t2[e2];
            return t2[0];
          }
          static create(t2, e2, i2) {
            const o2 = window.document.createElement(t2);
            return void 0 !== e2 && (o2.className = e2), i2 && i2.appendChild(o2), o2;
          }
          static createNS(t2, e2) {
            return window.document.createElementNS(t2, e2);
          }
          static disableDrag() {
            r.docStyle && r.selectProp && (r.userSelect = r.docStyle[r.selectProp], r.docStyle[r.selectProp] = "none");
          }
          static enableDrag() {
            r.docStyle && r.selectProp && (r.docStyle[r.selectProp] = r.userSelect);
          }
          static setTransform(t2, e2) {
            t2.style[r.transformProp] = e2;
          }
          static addEventListener(t2, e2, i2, o2 = {}) {
            t2.addEventListener(e2, i2, "passive" in o2 ? o2 : o2.capture);
          }
          static removeEventListener(t2, e2, i2, o2 = {}) {
            t2.removeEventListener(e2, i2, "passive" in o2 ? o2 : o2.capture);
          }
          static suppressClickInternal(t2) {
            t2.preventDefault(), t2.stopPropagation(), window.removeEventListener("click", r.suppressClickInternal, true);
          }
          static suppressClick() {
            window.addEventListener("click", r.suppressClickInternal, true), window.setTimeout(() => {
              window.removeEventListener("click", r.suppressClickInternal, true);
            }, 0);
          }
          static mousePos(e2, i2) {
            const o2 = e2.getBoundingClientRect();
            return new t.pointGeometry(i2.clientX - o2.left - e2.clientLeft, i2.clientY - o2.top - e2.clientTop);
          }
          static touchPos(e2, i2) {
            const o2 = e2.getBoundingClientRect(), a2 = [];
            for (let r2 = 0; r2 < i2.length; r2++)
              a2.push(new t.pointGeometry(i2[r2].clientX - o2.left - e2.clientLeft, i2[r2].clientY - o2.top - e2.clientTop));
            return a2;
          }
          static mouseButton(t2) {
            return t2.button;
          }
          static remove(t2) {
            t2.parentNode && t2.parentNode.removeChild(t2);
          }
        }
        r.docStyle = "undefined" != typeof window && window.document && window.document.documentElement.style, r.selectProp = r.testProp(["userSelect", "MozUserSelect", "WebkitUserSelect", "msUserSelect"]), r.transformProp = r.testProp(["transform", "WebkitTransform"]);
        class s {
          constructor(t2) {
            this._transformRequestFn = t2;
          }
          transformRequest(t2, e2) {
            return this._transformRequestFn && this._transformRequestFn(t2, e2) || { url: t2 };
          }
          normalizeSpriteURL(t2, e2, i2) {
            const o2 = function(t3) {
              const e3 = t3.match(n);
              if (!e3)
                throw new Error(`Unable to parse URL "${t3}"`);
              return { protocol: e3[1], authority: e3[2], path: e3[3] || "/", params: e3[4] ? e3[4].split("&") : [] };
            }(t2);
            return o2.path += `${e2}${i2}`, function(t3) {
              const e3 = t3.params.length ? `?${t3.params.join("&")}` : "";
              return `${t3.protocol}://${t3.authority}${t3.path}${e3}`;
            }(o2);
          }
          setTransformRequest(t2) {
            this._transformRequestFn = t2;
          }
        }
        const n = /^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;
        class l {
          constructor(t2, e2, i2, o2) {
            this.context = t2, this.format = i2, this.texture = t2.gl.createTexture(), this.update(e2, o2);
          }
          update(e2, i2, o2) {
            const { width: a2, height: r2 } = e2, s2 = !(this.size && this.size[0] === a2 && this.size[1] === r2 || o2), { context: n2 } = this, { gl: l2 } = n2;
            if (this.useMipmap = Boolean(i2 && i2.useMipmap), l2.bindTexture(l2.TEXTURE_2D, this.texture), n2.pixelStoreUnpackFlipY.set(false), n2.pixelStoreUnpack.set(1), n2.pixelStoreUnpackPremultiplyAlpha.set(this.format === l2.RGBA && (!i2 || false !== i2.premultiply)), s2)
              this.size = [a2, r2], e2 instanceof HTMLImageElement || e2 instanceof HTMLCanvasElement || e2 instanceof HTMLVideoElement || e2 instanceof ImageData || t.isImageBitmap(e2) ? l2.texImage2D(l2.TEXTURE_2D, 0, this.format, this.format, l2.UNSIGNED_BYTE, e2) : l2.texImage2D(l2.TEXTURE_2D, 0, this.format, a2, r2, 0, this.format, l2.UNSIGNED_BYTE, e2.data);
            else {
              const { x: i3, y: s3 } = o2 || { x: 0, y: 0 };
              e2 instanceof HTMLImageElement || e2 instanceof HTMLCanvasElement || e2 instanceof HTMLVideoElement || e2 instanceof ImageData || t.isImageBitmap(e2) ? l2.texSubImage2D(l2.TEXTURE_2D, 0, i3, s3, l2.RGBA, l2.UNSIGNED_BYTE, e2) : l2.texSubImage2D(l2.TEXTURE_2D, 0, i3, s3, a2, r2, l2.RGBA, l2.UNSIGNED_BYTE, e2.data);
            }
            this.useMipmap && this.isSizePowerOfTwo() && l2.generateMipmap(l2.TEXTURE_2D);
          }
          bind(t2, e2, i2) {
            const { context: o2 } = this, { gl: a2 } = o2;
            a2.bindTexture(a2.TEXTURE_2D, this.texture), i2 !== a2.LINEAR_MIPMAP_NEAREST || this.isSizePowerOfTwo() || (i2 = a2.LINEAR), t2 !== this.filter && (a2.texParameteri(a2.TEXTURE_2D, a2.TEXTURE_MAG_FILTER, t2), a2.texParameteri(a2.TEXTURE_2D, a2.TEXTURE_MIN_FILTER, i2 || t2), this.filter = t2), e2 !== this.wrap && (a2.texParameteri(a2.TEXTURE_2D, a2.TEXTURE_WRAP_S, e2), a2.texParameteri(a2.TEXTURE_2D, a2.TEXTURE_WRAP_T, e2), this.wrap = e2);
          }
          isSizePowerOfTwo() {
            return this.size[0] === this.size[1] && Math.log(this.size[0]) / Math.LN2 % 1 == 0;
          }
          destroy() {
            const { gl: t2 } = this.context;
            t2.deleteTexture(this.texture), this.texture = null;
          }
        }
        function c2(t2) {
          const { userImage: e2 } = t2;
          return !!(e2 && e2.render && e2.render()) && (t2.data.replace(new Uint8Array(e2.data.buffer)), true);
        }
        class h extends t.Evented {
          constructor() {
            super(), this.images = {}, this.updatedImages = {}, this.callbackDispatchedThisFrame = {}, this.loaded = false, this.requestors = [], this.patterns = {}, this.atlasImage = new t.RGBAImage({ width: 1, height: 1 }), this.dirty = true;
          }
          isLoaded() {
            return this.loaded;
          }
          setLoaded(t2) {
            if (this.loaded !== t2 && (this.loaded = t2, t2)) {
              for (const { ids: t3, callback: e2 } of this.requestors)
                this._notify(t3, e2);
              this.requestors = [];
            }
          }
          getImage(t2) {
            return this.images[t2];
          }
          addImage(t2, e2) {
            if (this.images[t2])
              throw new Error(`Image id ${t2} already exist, use updateImage instead`);
            this._validate(t2, e2) && (this.images[t2] = e2);
          }
          _validate(e2, i2) {
            let o2 = true;
            return this._validateStretch(i2.stretchX, i2.data && i2.data.width) || (this.fire(new t.ErrorEvent(new Error(`Image "${e2}" has invalid "stretchX" value`))), o2 = false), this._validateStretch(i2.stretchY, i2.data && i2.data.height) || (this.fire(new t.ErrorEvent(new Error(`Image "${e2}" has invalid "stretchY" value`))), o2 = false), this._validateContent(i2.content, i2) || (this.fire(new t.ErrorEvent(new Error(`Image "${e2}" has invalid "content" value`))), o2 = false), o2;
          }
          _validateStretch(t2, e2) {
            if (!t2)
              return true;
            let i2 = 0;
            for (const o2 of t2) {
              if (o2[0] < i2 || o2[1] < o2[0] || e2 < o2[1])
                return false;
              i2 = o2[1];
            }
            return true;
          }
          _validateContent(t2, e2) {
            return !(t2 && (4 !== t2.length || t2[0] < 0 || e2.data.width < t2[0] || t2[1] < 0 || e2.data.height < t2[1] || t2[2] < 0 || e2.data.width < t2[2] || t2[3] < 0 || e2.data.height < t2[3] || t2[2] < t2[0] || t2[3] < t2[1]));
          }
          updateImage(t2, e2) {
            const i2 = this.images[t2];
            if (i2.data.width !== e2.data.width || i2.data.height !== e2.data.height)
              throw new Error(`size mismatch between old image (${i2.data.width}x${i2.data.height}) and new image (${e2.data.width}x${e2.data.height}).`);
            e2.version = i2.version + 1, this.images[t2] = e2, this.updatedImages[t2] = true;
          }
          removeImage(t2) {
            const e2 = this.images[t2];
            delete this.images[t2], delete this.patterns[t2], e2.userImage && e2.userImage.onRemove && e2.userImage.onRemove();
          }
          listImages() {
            return Object.keys(this.images);
          }
          getImages(t2, e2) {
            let i2 = true;
            if (!this.isLoaded())
              for (const e3 of t2)
                this.images[e3] || (i2 = false);
            this.isLoaded() || i2 ? this._notify(t2, e2) : this.requestors.push({ ids: t2, callback: e2 });
          }
          _notify(e2, i2) {
            const o2 = {};
            for (const i3 of e2) {
              this.images[i3] || this.fire(new t.Event("styleimagemissing", { id: i3 }));
              const e3 = this.images[i3];
              e3 ? o2[i3] = { data: e3.data.clone(), pixelRatio: e3.pixelRatio, sdf: e3.sdf, version: e3.version, stretchX: e3.stretchX, stretchY: e3.stretchY, content: e3.content, hasRenderCallback: Boolean(e3.userImage && e3.userImage.render) } : t.warnOnce(`Image "${i3}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);
            }
            i2(null, o2);
          }
          getPixelSize() {
            const { width: t2, height: e2 } = this.atlasImage;
            return { width: t2, height: e2 };
          }
          getPattern(e2) {
            const i2 = this.patterns[e2], o2 = this.getImage(e2);
            if (!o2)
              return null;
            if (i2 && i2.position.version === o2.version)
              return i2.position;
            if (i2)
              i2.position.version = o2.version;
            else {
              const i3 = { w: o2.data.width + 2, h: o2.data.height + 2, x: 0, y: 0 }, a2 = new t.ImagePosition(i3, o2);
              this.patterns[e2] = { bin: i3, position: a2 };
            }
            return this._updatePatternAtlas(), this.patterns[e2].position;
          }
          bind(t2) {
            const e2 = t2.gl;
            this.atlasTexture ? this.dirty && (this.atlasTexture.update(this.atlasImage), this.dirty = false) : this.atlasTexture = new l(t2, this.atlasImage, e2.RGBA), this.atlasTexture.bind(e2.LINEAR, e2.CLAMP_TO_EDGE);
          }
          _updatePatternAtlas() {
            const e2 = [];
            for (const t2 in this.patterns)
              e2.push(this.patterns[t2].bin);
            const { w: i2, h: o2 } = t.potpack(e2), a2 = this.atlasImage;
            a2.resize({ width: i2 || 1, height: o2 || 1 });
            for (const e3 in this.patterns) {
              const { bin: i3 } = this.patterns[e3], o3 = i3.x + 1, r2 = i3.y + 1, s2 = this.images[e3].data, n2 = s2.width, l2 = s2.height;
              t.RGBAImage.copy(s2, a2, { x: 0, y: 0 }, { x: o3, y: r2 }, { width: n2, height: l2 }), t.RGBAImage.copy(s2, a2, { x: 0, y: l2 - 1 }, { x: o3, y: r2 - 1 }, { width: n2, height: 1 }), t.RGBAImage.copy(s2, a2, { x: 0, y: 0 }, { x: o3, y: r2 + l2 }, { width: n2, height: 1 }), t.RGBAImage.copy(s2, a2, { x: n2 - 1, y: 0 }, { x: o3 - 1, y: r2 }, { width: 1, height: l2 }), t.RGBAImage.copy(s2, a2, { x: 0, y: 0 }, { x: o3 + n2, y: r2 }, { width: 1, height: l2 });
            }
            this.dirty = true;
          }
          beginFrame() {
            this.callbackDispatchedThisFrame = {};
          }
          dispatchRenderCallbacks(e2) {
            for (const i2 of e2) {
              if (this.callbackDispatchedThisFrame[i2])
                continue;
              this.callbackDispatchedThisFrame[i2] = true;
              const e3 = this.images[i2];
              e3 || t.warnOnce(`Image with ID: "${i2}" was not found`), c2(e3) && this.updateImage(i2, e3);
            }
          }
        }
        const u = 1e20;
        function d(t2, e2, i2, o2, a2, r2, s2, n2, l2) {
          for (let c3 = e2; c3 < e2 + o2; c3++)
            m(t2, i2 * r2 + c3, r2, a2, s2, n2, l2);
          for (let c3 = i2; c3 < i2 + a2; c3++)
            m(t2, c3 * r2 + e2, 1, o2, s2, n2, l2);
        }
        function m(t2, e2, i2, o2, a2, r2, s2) {
          r2[0] = 0, s2[0] = -u, s2[1] = u, a2[0] = t2[e2];
          for (let n2 = 1, l2 = 0, c3 = 0; n2 < o2; n2++) {
            a2[n2] = t2[e2 + n2 * i2];
            const o3 = n2 * n2;
            do {
              const t3 = r2[l2];
              c3 = (a2[n2] - a2[t3] + o3 - t3 * t3) / (n2 - t3) / 2;
            } while (c3 <= s2[l2] && --l2 > -1);
            l2++, r2[l2] = n2, s2[l2] = c3, s2[l2 + 1] = u;
          }
          for (let n2 = 0, l2 = 0; n2 < o2; n2++) {
            for (; s2[l2 + 1] < n2; )
              l2++;
            const o3 = r2[l2], c3 = n2 - o3;
            t2[e2 + n2 * i2] = a2[o3] + c3 * c3;
          }
        }
        class _ {
          constructor(t2, e2) {
            this.requestManager = t2, this.localIdeographFontFamily = e2, this.entries = {};
          }
          setURL(t2) {
            this.url = t2;
          }
          getGlyphs(e2, i2) {
            const o2 = [];
            for (const t2 in e2)
              for (const i3 of e2[t2])
                o2.push({ stack: t2, id: i3 });
            t.asyncAll(o2, ({ stack: t2, id: e3 }, i3) => {
              let o3 = this.entries[t2];
              o3 || (o3 = this.entries[t2] = { glyphs: {}, requests: {}, ranges: {} });
              let a2 = o3.glyphs[e3];
              if (void 0 !== a2)
                return void i3(null, { stack: t2, id: e3, glyph: a2 });
              if (a2 = this._tinySDF(o3, t2, e3), a2)
                return o3.glyphs[e3] = a2, void i3(null, { stack: t2, id: e3, glyph: a2 });
              const r2 = Math.floor(e3 / 256);
              if (256 * r2 > 65535)
                return void i3(new Error("glyphs > 65535 not supported"));
              if (o3.ranges[r2])
                return void i3(null, { stack: t2, id: e3, glyph: a2 });
              let s2 = o3.requests[r2];
              s2 || (s2 = o3.requests[r2] = [], _.loadGlyphRange(t2, r2, this.url, this.requestManager, (t3, e4) => {
                if (e4) {
                  for (const t4 in e4)
                    this._doesCharSupportLocalGlyph(+t4) || (o3.glyphs[+t4] = e4[+t4]);
                  o3.ranges[r2] = true;
                }
                for (const i4 of s2)
                  i4(t3, e4);
                delete o3.requests[r2];
              })), s2.push((o4, a3) => {
                o4 ? i3(o4) : a3 && i3(null, { stack: t2, id: e3, glyph: a3[e3] || null });
              });
            }, (t2, e3) => {
              if (t2)
                i2(t2);
              else if (e3) {
                const t3 = {};
                for (const { stack: i3, id: o3, glyph: a2 } of e3)
                  (t3[i3] || (t3[i3] = {}))[o3] = a2 && { id: a2.id, bitmap: a2.bitmap.clone(), metrics: a2.metrics };
                i2(null, t3);
              }
            });
          }
          _doesCharSupportLocalGlyph(e2) {
            return !!this.localIdeographFontFamily && (t.unicodeBlockLookup["CJK Unified Ideographs"](e2) || t.unicodeBlockLookup["Hangul Syllables"](e2) || t.unicodeBlockLookup.Hiragana(e2) || t.unicodeBlockLookup.Katakana(e2));
          }
          _tinySDF(e2, i2, o2) {
            const a2 = this.localIdeographFontFamily;
            if (!a2)
              return;
            if (!this._doesCharSupportLocalGlyph(o2))
              return;
            let r2 = e2.tinySDF;
            if (!r2) {
              let t2 = "400";
              /bold/i.test(i2) ? t2 = "900" : /medium/i.test(i2) ? t2 = "500" : /light/i.test(i2) && (t2 = "200"), r2 = e2.tinySDF = new _.TinySDF({ fontSize: 24, buffer: 3, radius: 8, cutoff: 0.25, fontFamily: a2, fontWeight: t2 });
            }
            const s2 = r2.draw(String.fromCharCode(o2));
            return { id: o2, bitmap: new t.AlphaImage({ width: s2.width || 30, height: s2.height || 30 }, s2.data), metrics: { width: s2.glyphWidth || 24, height: s2.glyphHeight || 24, left: s2.glyphLeft || 0, top: s2.glyphTop - 27 || -8, advance: s2.glyphAdvance || 24 } };
          }
        }
        _.loadGlyphRange = function(e2, i2, o2, a2, r2) {
          const s2 = 256 * i2, n2 = s2 + 255, l2 = a2.transformRequest(o2.replace("{fontstack}", e2).replace("{range}", `${s2}-${n2}`), t.ResourceType.Glyphs);
          t.getArrayBuffer(l2, (e3, i3) => {
            if (e3)
              r2(e3);
            else if (i3) {
              const e4 = {};
              for (const o3 of t.parseGlyphPbf(i3))
                e4[o3.id] = o3;
              r2(null, e4);
            }
          });
        }, _.TinySDF = class {
          constructor({ fontSize: t2 = 24, buffer: e2 = 3, radius: i2 = 8, cutoff: o2 = 0.25, fontFamily: a2 = "sans-serif", fontWeight: r2 = "normal", fontStyle: s2 = "normal" } = {}) {
            this.buffer = e2, this.cutoff = o2, this.radius = i2;
            const n2 = this.size = t2 + 4 * e2, l2 = this._createCanvas(n2), c3 = this.ctx = l2.getContext("2d", { willReadFrequently: true });
            c3.font = `${s2} ${r2} ${t2}px ${a2}`, c3.textBaseline = "alphabetic", c3.textAlign = "left", c3.fillStyle = "black", this.gridOuter = new Float64Array(n2 * n2), this.gridInner = new Float64Array(n2 * n2), this.f = new Float64Array(n2), this.z = new Float64Array(n2 + 1), this.v = new Uint16Array(n2);
          }
          _createCanvas(t2) {
            const e2 = document.createElement("canvas");
            return e2.width = e2.height = t2, e2;
          }
          draw(t2) {
            const { width: e2, actualBoundingBoxAscent: i2, actualBoundingBoxDescent: o2, actualBoundingBoxLeft: a2, actualBoundingBoxRight: r2 } = this.ctx.measureText(t2), s2 = Math.ceil(i2), n2 = Math.min(this.size - this.buffer, Math.ceil(r2 - a2)), l2 = Math.min(this.size - this.buffer, s2 + Math.ceil(o2)), c3 = n2 + 2 * this.buffer, h2 = l2 + 2 * this.buffer, m2 = Math.max(c3 * h2, 0), _2 = new Uint8ClampedArray(m2), p3 = { data: _2, width: c3, height: h2, glyphWidth: n2, glyphHeight: l2, glyphTop: s2, glyphLeft: 0, glyphAdvance: e2 };
            if (0 === n2 || 0 === l2)
              return p3;
            const { ctx: f2, buffer: g2, gridInner: x2, gridOuter: v3 } = this;
            f2.clearRect(g2, g2, n2, l2), f2.fillText(t2, g2, g2 + s2);
            const y3 = f2.getImageData(g2, g2, n2, l2);
            v3.fill(u, 0, m2), x2.fill(0, 0, m2);
            for (let t3 = 0; t3 < l2; t3++)
              for (let e3 = 0; e3 < n2; e3++) {
                const i3 = y3.data[4 * (t3 * n2 + e3) + 3] / 255;
                if (0 === i3)
                  continue;
                const o3 = (t3 + g2) * c3 + e3 + g2;
                if (1 === i3)
                  v3[o3] = 0, x2[o3] = u;
                else {
                  const t4 = 0.5 - i3;
                  v3[o3] = t4 > 0 ? t4 * t4 : 0, x2[o3] = t4 < 0 ? t4 * t4 : 0;
                }
              }
            d(v3, 0, 0, c3, h2, c3, this.f, this.v, this.z), d(x2, g2, g2, n2, l2, c3, this.f, this.v, this.z);
            for (let t3 = 0; t3 < m2; t3++) {
              const e3 = Math.sqrt(v3[t3]) - Math.sqrt(x2[t3]);
              _2[t3] = Math.round(255 - 255 * (e3 / this.radius + this.cutoff));
            }
            return p3;
          }
        };
        const p2 = new t.Properties({ anchor: new t.DataConstantProperty(t.spec.light.anchor), position: new class {
          constructor() {
            this.specification = t.spec.light.position;
          }
          possiblyEvaluate(e2, i2) {
            return t.sphericalToCartesian(e2.expression.evaluate(i2));
          }
          interpolate(e2, i2, o2) {
            return { x: t.number(e2.x, i2.x, o2), y: t.number(e2.y, i2.y, o2), z: t.number(e2.z, i2.z, o2) };
          }
        }(), color: new t.DataConstantProperty(t.spec.light.color), intensity: new t.DataConstantProperty(t.spec.light.intensity) }), f = "-transition";
        class g extends t.Evented {
          constructor(e2) {
            super(), this._transitionable = new t.Transitionable(p2), this.setLight(e2), this._transitioning = this._transitionable.untransitioned();
          }
          getLight() {
            return this._transitionable.serialize();
          }
          setLight(e2, i2 = {}) {
            if (!this._validate(t.validateLight, e2, i2))
              for (const t2 in e2) {
                const i3 = e2[t2];
                t2.endsWith(f) ? this._transitionable.setTransition(t2.slice(0, -f.length), i3) : this._transitionable.setValue(t2, i3);
              }
          }
          updateTransitions(t2) {
            this._transitioning = this._transitionable.transitioned(t2, this._transitioning);
          }
          hasTransition() {
            return this._transitioning.hasTransition();
          }
          recalculate(t2) {
            this.properties = this._transitioning.possiblyEvaluate(t2);
          }
          _validate(e2, i2, o2) {
            return (!o2 || false !== o2.validate) && t.emitValidationErrors(this, e2.call(t.validateStyle, t.extend({ value: i2, style: { glyphs: true, sprite: true }, styleSpec: t.spec })));
          }
        }
        class x {
          constructor(t2, e2) {
            this.width = t2, this.height = e2, this.nextRow = 0, this.data = new Uint8Array(this.width * this.height), this.dashEntry = {};
          }
          getDash(t2, e2) {
            const i2 = t2.join(",") + String(e2);
            return this.dashEntry[i2] || (this.dashEntry[i2] = this.addDash(t2, e2)), this.dashEntry[i2];
          }
          getDashRanges(t2, e2, i2) {
            const o2 = [];
            let a2 = t2.length % 2 == 1 ? -t2[t2.length - 1] * i2 : 0, r2 = t2[0] * i2, s2 = true;
            o2.push({ left: a2, right: r2, isDash: s2, zeroLength: 0 === t2[0] });
            let n2 = t2[0];
            for (let e3 = 1; e3 < t2.length; e3++) {
              s2 = !s2;
              const l2 = t2[e3];
              a2 = n2 * i2, n2 += l2, r2 = n2 * i2, o2.push({ left: a2, right: r2, isDash: s2, zeroLength: 0 === l2 });
            }
            return o2;
          }
          addRoundDash(t2, e2, i2) {
            const o2 = e2 / 2;
            for (let e3 = -i2; e3 <= i2; e3++) {
              const a2 = this.width * (this.nextRow + i2 + e3);
              let r2 = 0, s2 = t2[r2];
              for (let n2 = 0; n2 < this.width; n2++) {
                n2 / s2.right > 1 && (s2 = t2[++r2]);
                const l2 = Math.abs(n2 - s2.left), c3 = Math.abs(n2 - s2.right), h2 = Math.min(l2, c3);
                let u2;
                const d2 = e3 / i2 * (o2 + 1);
                if (s2.isDash) {
                  const t3 = o2 - Math.abs(d2);
                  u2 = Math.sqrt(h2 * h2 + t3 * t3);
                } else
                  u2 = o2 - Math.sqrt(h2 * h2 + d2 * d2);
                this.data[a2 + n2] = Math.max(0, Math.min(255, u2 + 128));
              }
            }
          }
          addRegularDash(t2) {
            for (let e3 = t2.length - 1; e3 >= 0; --e3) {
              const i3 = t2[e3], o3 = t2[e3 + 1];
              i3.zeroLength ? t2.splice(e3, 1) : o3 && o3.isDash === i3.isDash && (o3.left = i3.left, t2.splice(e3, 1));
            }
            const e2 = t2[0], i2 = t2[t2.length - 1];
            e2.isDash === i2.isDash && (e2.left = i2.left - this.width, i2.right = e2.right + this.width);
            const o2 = this.width * this.nextRow;
            let a2 = 0, r2 = t2[a2];
            for (let e3 = 0; e3 < this.width; e3++) {
              e3 / r2.right > 1 && (r2 = t2[++a2]);
              const i3 = Math.abs(e3 - r2.left), s2 = Math.abs(e3 - r2.right), n2 = Math.min(i3, s2);
              this.data[o2 + e3] = Math.max(0, Math.min(255, (r2.isDash ? n2 : -n2) + 128));
            }
          }
          addDash(e2, i2) {
            const o2 = i2 ? 7 : 0, a2 = 2 * o2 + 1;
            if (this.nextRow + a2 > this.height)
              return t.warnOnce("LineAtlas out of space"), null;
            let r2 = 0;
            for (let t2 = 0; t2 < e2.length; t2++)
              r2 += e2[t2];
            if (0 !== r2) {
              const t2 = this.width / r2, a3 = this.getDashRanges(e2, this.width, t2);
              i2 ? this.addRoundDash(a3, t2, o2) : this.addRegularDash(a3);
            }
            const s2 = { y: (this.nextRow + o2 + 0.5) / this.height, height: 2 * o2 / this.height, width: r2 };
            return this.nextRow += a2, this.dirty = true, s2;
          }
          bind(t2) {
            const e2 = t2.gl;
            this.texture ? (e2.bindTexture(e2.TEXTURE_2D, this.texture), this.dirty && (this.dirty = false, e2.texSubImage2D(e2.TEXTURE_2D, 0, 0, 0, this.width, this.height, e2.ALPHA, e2.UNSIGNED_BYTE, this.data))) : (this.texture = e2.createTexture(), e2.bindTexture(e2.TEXTURE_2D, this.texture), e2.texParameteri(e2.TEXTURE_2D, e2.TEXTURE_WRAP_S, e2.REPEAT), e2.texParameteri(e2.TEXTURE_2D, e2.TEXTURE_WRAP_T, e2.REPEAT), e2.texParameteri(e2.TEXTURE_2D, e2.TEXTURE_MIN_FILTER, e2.LINEAR), e2.texParameteri(e2.TEXTURE_2D, e2.TEXTURE_MAG_FILTER, e2.LINEAR), e2.texImage2D(e2.TEXTURE_2D, 0, e2.ALPHA, this.width, this.height, 0, e2.ALPHA, e2.UNSIGNED_BYTE, this.data));
          }
        }
        class v2 {
          constructor(e2, i2) {
            this.workerPool = e2, this.actors = [], this.currentActor = 0, this.id = t.uniqueId();
            const o2 = this.workerPool.acquire(this.id);
            for (let t2 = 0; t2 < o2.length; t2++) {
              const e3 = new v2.Actor(o2[t2], i2, this.id);
              e3.name = `Worker ${t2}`, this.actors.push(e3);
            }
            if (!this.actors.length)
              throw new Error("No actors found");
          }
          broadcast(e2, i2, o2) {
            t.asyncAll(this.actors, (t2, o3) => {
              t2.send(e2, i2, o3);
            }, o2 = o2 || function() {
            });
          }
          getActor() {
            return this.currentActor = (this.currentActor + 1) % this.actors.length, this.actors[this.currentActor];
          }
          remove() {
            this.actors.forEach((t2) => {
              t2.remove();
            }), this.actors = [], this.workerPool.release(this.id);
          }
        }
        function y2(e2, i2, o2) {
          const a2 = function(i3, a3) {
            if (i3)
              return o2(i3);
            if (a3) {
              const i4 = t.pick(t.extend(a3, e2), ["tiles", "minzoom", "maxzoom", "attribution", "bounds", "scheme", "tileSize", "encoding"]);
              a3.vector_layers && (i4.vectorLayers = a3.vector_layers, i4.vectorLayerIds = i4.vectorLayers.map((t2) => t2.id)), o2(null, i4);
            }
          };
          return e2.url ? t.getJSON(i2.transformRequest(e2.url, t.ResourceType.Source), a2) : t.exported.frame(() => a2(null, e2));
        }
        v2.Actor = t.Actor;
        class b {
          constructor(e2, i2, o2) {
            this.bounds = t.LngLatBounds.convert(this.validateBounds(e2)), this.minzoom = i2 || 0, this.maxzoom = o2 || 24;
          }
          validateBounds(t2) {
            return Array.isArray(t2) && 4 === t2.length ? [Math.max(-180, t2[0]), Math.max(-90, t2[1]), Math.min(180, t2[2]), Math.min(90, t2[3])] : [-180, -90, 180, 90];
          }
          contains(e2) {
            const i2 = Math.pow(2, e2.z), o2 = Math.floor(t.mercatorXfromLng(this.bounds.getWest()) * i2), a2 = Math.floor(t.mercatorYfromLat(this.bounds.getNorth()) * i2), r2 = Math.ceil(t.mercatorXfromLng(this.bounds.getEast()) * i2), s2 = Math.ceil(t.mercatorYfromLat(this.bounds.getSouth()) * i2);
            return e2.x >= o2 && e2.x < r2 && e2.y >= a2 && e2.y < s2;
          }
        }
        class w extends t.Evented {
          constructor(e2, i2, o2, a2) {
            if (super(), this.id = e2, this.dispatcher = o2, this.type = "vector", this.minzoom = 0, this.maxzoom = 22, this.scheme = "xyz", this.tileSize = 512, this.reparseOverscaled = true, this.isTileClipped = true, this._loaded = false, t.extend(this, t.pick(i2, ["url", "scheme", "tileSize", "promoteId"])), this._options = t.extend({ type: "vector" }, i2), this._collectResourceTiming = i2.collectResourceTiming, 512 !== this.tileSize)
              throw new Error("vector tile sources must have a tileSize of 512");
            this.setEventedParent(a2);
          }
          load() {
            this._loaded = false, this.fire(new t.Event("dataloading", { dataType: "source" })), this._tileJSONRequest = y2(this._options, this.map._requestManager, (e2, i2) => {
              this._tileJSONRequest = null, this._loaded = true, this.map.style.sourceCaches[this.id].clearTiles(), e2 ? this.fire(new t.ErrorEvent(e2)) : i2 && (t.extend(this, i2), i2.bounds && (this.tileBounds = new b(i2.bounds, this.minzoom, this.maxzoom)), this.fire(new t.Event("data", { dataType: "source", sourceDataType: "metadata" })), this.fire(new t.Event("data", { dataType: "source", sourceDataType: "content" })));
            });
          }
          loaded() {
            return this._loaded;
          }
          hasTile(t2) {
            return !this.tileBounds || this.tileBounds.contains(t2.canonical);
          }
          onAdd(t2) {
            this.map = t2, this.load();
          }
          setSourceProperty(t2) {
            this._tileJSONRequest && this._tileJSONRequest.cancel(), t2(), this.load();
          }
          setTiles(t2) {
            return this.setSourceProperty(() => {
              this._options.tiles = t2;
            }), this;
          }
          setUrl(t2) {
            return this.setSourceProperty(() => {
              this.url = t2, this._options.url = t2;
            }), this;
          }
          onRemove() {
            this._tileJSONRequest && (this._tileJSONRequest.cancel(), this._tileJSONRequest = null);
          }
          serialize() {
            return t.extend({}, this._options);
          }
          loadTile(e2, i2) {
            const o2 = e2.tileID.canonical.url(this.tiles, this.map.getPixelRatio(), this.scheme), a2 = { request: this.map._requestManager.transformRequest(o2, t.ResourceType.Tile), uid: e2.uid, tileID: e2.tileID, zoom: e2.tileID.overscaledZ, tileSize: this.tileSize * e2.tileID.overscaleFactor(), type: this.type, source: this.id, pixelRatio: this.map.getPixelRatio(), showCollisionBoxes: this.map.showCollisionBoxes, promoteId: this.promoteId };
            function r2(o3, a3) {
              return delete e2.request, e2.aborted ? i2(null) : o3 && 404 !== o3.status ? i2(o3) : (a3 && a3.resourceTiming && (e2.resourceTiming = a3.resourceTiming), this.map._refreshExpiredTiles && a3 && e2.setExpiryData(a3), e2.loadVectorData(a3, this.map.painter), t.cacheEntryPossiblyAdded(this.dispatcher), i2(null), void (e2.reloadCallback && (this.loadTile(e2, e2.reloadCallback), e2.reloadCallback = null)));
            }
            a2.request.collectResourceTiming = this._collectResourceTiming, e2.actor && "expired" !== e2.state ? "loading" === e2.state ? e2.reloadCallback = i2 : e2.request = e2.actor.send("reloadTile", a2, r2.bind(this)) : (e2.actor = this.dispatcher.getActor(), e2.request = e2.actor.send("loadTile", a2, r2.bind(this)));
          }
          abortTile(t2) {
            t2.request && (t2.request.cancel(), delete t2.request), t2.actor && t2.actor.send("abortTile", { uid: t2.uid, type: this.type, source: this.id }, void 0);
          }
          unloadTile(t2) {
            t2.unloadVectorData(), t2.actor && t2.actor.send("removeTile", { uid: t2.uid, type: this.type, source: this.id }, void 0);
          }
          hasTransition() {
            return false;
          }
        }
        class T extends t.Evented {
          constructor(e2, i2, o2, a2) {
            super(), this.id = e2, this.dispatcher = o2, this.setEventedParent(a2), this.type = "raster", this.minzoom = 0, this.maxzoom = 22, this.roundZoom = true, this.scheme = "xyz", this.tileSize = 512, this._loaded = false, this._options = t.extend({ type: "raster" }, i2), t.extend(this, t.pick(i2, ["url", "scheme", "tileSize"]));
          }
          load() {
            this._loaded = false, this.fire(new t.Event("dataloading", { dataType: "source" })), this._tileJSONRequest = y2(this._options, this.map._requestManager, (e2, i2) => {
              this._tileJSONRequest = null, this._loaded = true, e2 ? this.fire(new t.ErrorEvent(e2)) : i2 && (t.extend(this, i2), i2.bounds && (this.tileBounds = new b(i2.bounds, this.minzoom, this.maxzoom)), this.fire(new t.Event("data", { dataType: "source", sourceDataType: "metadata" })), this.fire(new t.Event("data", { dataType: "source", sourceDataType: "content" })));
            });
          }
          loaded() {
            return this._loaded;
          }
          onAdd(t2) {
            this.map = t2, this.load();
          }
          onRemove() {
            this._tileJSONRequest && (this._tileJSONRequest.cancel(), this._tileJSONRequest = null);
          }
          serialize() {
            return t.extend({}, this._options);
          }
          hasTile(t2) {
            return !this.tileBounds || this.tileBounds.contains(t2.canonical);
          }
          loadTile(e2, i2) {
            const o2 = e2.tileID.canonical.url(this.tiles, this.map.getPixelRatio(), this.scheme);
            e2.request = t.getImage(this.map._requestManager.transformRequest(o2, t.ResourceType.Tile), (o3, a2, r2) => {
              if (delete e2.request, e2.aborted)
                e2.state = "unloaded", i2(null);
              else if (o3)
                e2.state = "errored", i2(o3);
              else if (a2) {
                this.map._refreshExpiredTiles && e2.setExpiryData(r2);
                const o4 = this.map.painter.context, s2 = o4.gl;
                e2.texture = this.map.painter.getTileTexture(a2.width), e2.texture ? e2.texture.update(a2, { useMipmap: true }) : (e2.texture = new l(o4, a2, s2.RGBA, { useMipmap: true }), e2.texture.bind(s2.LINEAR, s2.CLAMP_TO_EDGE, s2.LINEAR_MIPMAP_NEAREST), o4.extTextureFilterAnisotropic && s2.texParameterf(s2.TEXTURE_2D, o4.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT, o4.extTextureFilterAnisotropicMax)), e2.state = "loaded", t.cacheEntryPossiblyAdded(this.dispatcher), i2(null);
              }
            });
          }
          abortTile(t2, e2) {
            t2.request && (t2.request.cancel(), delete t2.request), e2();
          }
          unloadTile(t2, e2) {
            t2.texture && this.map.painter.saveTileTexture(t2.texture), e2();
          }
          hasTransition() {
            return false;
          }
        }
        let E;
        class I2 extends T {
          constructor(e2, i2, o2, a2) {
            super(e2, i2, o2, a2), this.type = "raster-dem", this.maxzoom = 22, this._options = t.extend({ type: "raster-dem" }, i2), this.encoding = i2.encoding || "mapbox";
          }
          serialize() {
            return { type: "raster-dem", url: this.url, tileSize: this.tileSize, tiles: this.tiles, bounds: this.bounds, encoding: this.encoding };
          }
          loadTile(e2, i2) {
            const o2 = e2.tileID.canonical.url(this.tiles, this.map.getPixelRatio(), this.scheme);
            function a2(t2, o3) {
              t2 && (e2.state = "errored", i2(t2)), o3 && (e2.dem = o3, e2.needsHillshadePrepare = true, e2.needsTerrainPrepare = true, e2.state = "loaded", i2(null));
            }
            e2.request = t.getImage(this.map._requestManager.transformRequest(o2, t.ResourceType.Tile), function(o3, r2) {
              if (delete e2.request, e2.aborted)
                e2.state = "unloaded", i2(null);
              else if (o3)
                e2.state = "errored", i2(o3);
              else if (r2) {
                this.map._refreshExpiredTiles && e2.setExpiryData(r2), delete r2.cacheControl, delete r2.expires;
                const i3 = t.isImageBitmap(r2) && (null == E && (E = "undefined" != typeof OffscreenCanvas && new OffscreenCanvas(1, 1).getContext("2d") && "function" == typeof createImageBitmap), E) ? r2 : t.exported.getImageData(r2, 1), o4 = { uid: e2.uid, coord: e2.tileID, source: this.id, rawImageData: i3, encoding: this.encoding };
                e2.actor && "expired" !== e2.state || (e2.actor = this.dispatcher.getActor(), e2.actor.send("loadDEMTile", o4, a2.bind(this)));
              }
            }.bind(this)), e2.neighboringTiles = this._getNeighboringTiles(e2.tileID);
          }
          _getNeighboringTiles(e2) {
            const i2 = e2.canonical, o2 = Math.pow(2, i2.z), a2 = (i2.x - 1 + o2) % o2, r2 = 0 === i2.x ? e2.wrap - 1 : e2.wrap, s2 = (i2.x + 1 + o2) % o2, n2 = i2.x + 1 === o2 ? e2.wrap + 1 : e2.wrap, l2 = {};
            return l2[new t.OverscaledTileID(e2.overscaledZ, r2, i2.z, a2, i2.y).key] = { backfilled: false }, l2[new t.OverscaledTileID(e2.overscaledZ, n2, i2.z, s2, i2.y).key] = { backfilled: false }, i2.y > 0 && (l2[new t.OverscaledTileID(e2.overscaledZ, r2, i2.z, a2, i2.y - 1).key] = { backfilled: false }, l2[new t.OverscaledTileID(e2.overscaledZ, e2.wrap, i2.z, i2.x, i2.y - 1).key] = { backfilled: false }, l2[new t.OverscaledTileID(e2.overscaledZ, n2, i2.z, s2, i2.y - 1).key] = { backfilled: false }), i2.y + 1 < o2 && (l2[new t.OverscaledTileID(e2.overscaledZ, r2, i2.z, a2, i2.y + 1).key] = { backfilled: false }, l2[new t.OverscaledTileID(e2.overscaledZ, e2.wrap, i2.z, i2.x, i2.y + 1).key] = { backfilled: false }, l2[new t.OverscaledTileID(e2.overscaledZ, n2, i2.z, s2, i2.y + 1).key] = { backfilled: false }), l2;
          }
          unloadTile(t2) {
            t2.demTexture && this.map.painter.saveTileTexture(t2.demTexture), t2.fbo && (t2.fbo.destroy(), delete t2.fbo), t2.dem && delete t2.dem, delete t2.neighboringTiles, t2.state = "unloaded", t2.actor && t2.actor.send("removeDEMTile", { uid: t2.uid, source: this.id });
          }
        }
        class C extends t.Evented {
          constructor(e2, i2, o2, a2) {
            super(), this.id = e2, this.type = "geojson", this.minzoom = 0, this.maxzoom = 18, this.tileSize = 512, this.isTileClipped = true, this.reparseOverscaled = true, this._removed = false, this._pendingLoads = 0, this.actor = o2.getActor(), this.setEventedParent(a2), this._data = i2.data, this._options = t.extend({}, i2), this._collectResourceTiming = i2.collectResourceTiming, void 0 !== i2.maxzoom && (this.maxzoom = i2.maxzoom), i2.type && (this.type = i2.type), i2.attribution && (this.attribution = i2.attribution), this.promoteId = i2.promoteId;
            const r2 = t.EXTENT / this.tileSize;
            this.workerOptions = t.extend({ source: this.id, cluster: i2.cluster || false, geojsonVtOptions: { buffer: (void 0 !== i2.buffer ? i2.buffer : 128) * r2, tolerance: (void 0 !== i2.tolerance ? i2.tolerance : 0.375) * r2, extent: t.EXTENT, maxZoom: this.maxzoom, lineMetrics: i2.lineMetrics || false, generateId: i2.generateId || false }, superclusterOptions: { maxZoom: void 0 !== i2.clusterMaxZoom ? i2.clusterMaxZoom : this.maxzoom - 1, minPoints: Math.max(2, i2.clusterMinPoints || 2), extent: t.EXTENT, radius: (i2.clusterRadius || 50) * r2, log: false, generateId: i2.generateId || false }, clusterProperties: i2.clusterProperties, filter: i2.filter }, i2.workerOptions);
          }
          load() {
            this._updateWorkerData("metadata");
          }
          onAdd(t2) {
            this.map = t2, this.load();
          }
          setData(t2) {
            return this._data = t2, this._updateWorkerData("content"), this;
          }
          getClusterExpansionZoom(t2, e2) {
            return this.actor.send("geojson.getClusterExpansionZoom", { clusterId: t2, source: this.id }, e2), this;
          }
          getClusterChildren(t2, e2) {
            return this.actor.send("geojson.getClusterChildren", { clusterId: t2, source: this.id }, e2), this;
          }
          getClusterLeaves(t2, e2, i2, o2) {
            return this.actor.send("geojson.getClusterLeaves", { source: this.id, clusterId: t2, limit: e2, offset: i2 }, o2), this;
          }
          _updateWorkerData(e2) {
            const i2 = t.extend({}, this.workerOptions), o2 = this._data;
            "string" == typeof o2 ? (i2.request = this.map._requestManager.transformRequest(t.exported.resolveURL(o2), t.ResourceType.Source), i2.request.collectResourceTiming = this._collectResourceTiming) : i2.data = JSON.stringify(o2), this._pendingLoads++, this.fire(new t.Event("dataloading", { dataType: "source" })), this.actor.send(`${this.type}.loadData`, i2, (i3, o3) => {
              if (this._pendingLoads--, this._removed || o3 && o3.abandoned)
                return void this.fire(new t.Event("dataabort", { dataType: "source", sourceDataType: e2 }));
              let a2 = null;
              if (o3 && o3.resourceTiming && o3.resourceTiming[this.id] && (a2 = o3.resourceTiming[this.id].slice(0)), i3)
                return void this.fire(new t.ErrorEvent(i3));
              const r2 = { dataType: "source", sourceDataType: e2 };
              this._collectResourceTiming && a2 && a2.length > 0 && t.extend(r2, { resourceTiming: a2 }), this.fire(new t.Event("data", r2));
            });
          }
          loaded() {
            return 0 === this._pendingLoads;
          }
          loadTile(t2, e2) {
            const i2 = t2.actor ? "reloadTile" : "loadTile";
            t2.actor = this.actor;
            const o2 = { type: this.type, uid: t2.uid, tileID: t2.tileID, zoom: t2.tileID.overscaledZ, maxZoom: this.maxzoom, tileSize: this.tileSize, source: this.id, pixelRatio: this.map.getPixelRatio(), showCollisionBoxes: this.map.showCollisionBoxes, promoteId: this.promoteId };
            t2.request = this.actor.send(i2, o2, (o3, a2) => (delete t2.request, t2.unloadVectorData(), t2.aborted ? e2(null) : o3 ? e2(o3) : (t2.loadVectorData(a2, this.map.painter, "reloadTile" === i2), e2(null))));
          }
          abortTile(t2) {
            t2.request && (t2.request.cancel(), delete t2.request), t2.aborted = true;
          }
          unloadTile(t2) {
            t2.unloadVectorData(), this.actor.send("removeTile", { uid: t2.uid, type: this.type, source: this.id });
          }
          onRemove() {
            this._removed = true, this.actor.send("removeSource", { type: this.type, source: this.id });
          }
          serialize() {
            return t.extend({}, this._options, { type: this.type, data: this._data });
          }
          hasTransition() {
            return false;
          }
        }
        var S = t.createLayout([{ name: "a_pos", type: "Int16", components: 2 }, { name: "a_texture_pos", type: "Int16", components: 2 }]);
        class D extends t.Evented {
          constructor(t2, e2, i2, o2) {
            super(), this.id = t2, this.dispatcher = i2, this.coordinates = e2.coordinates, this.type = "image", this.minzoom = 0, this.maxzoom = 22, this.tileSize = 512, this.tiles = {}, this._loaded = false, this.setEventedParent(o2), this.options = e2;
          }
          load(e2, i2) {
            this._loaded = false, this.fire(new t.Event("dataloading", { dataType: "source" })), this.url = this.options.url, t.getImage(this.map._requestManager.transformRequest(this.url, t.ResourceType.Image), (o2, a2) => {
              this._loaded = true, o2 ? this.fire(new t.ErrorEvent(o2)) : a2 && (this.image = a2, e2 && (this.coordinates = e2), i2 && i2(), this._finishLoading());
            });
          }
          loaded() {
            return this._loaded;
          }
          updateImage(t2) {
            return this.image && t2.url ? (this.options.url = t2.url, this.load(t2.coordinates, () => {
              this.texture = null;
            }), this) : this;
          }
          _finishLoading() {
            this.map && (this.setCoordinates(this.coordinates), this.fire(new t.Event("data", { dataType: "source", sourceDataType: "metadata" })));
          }
          onAdd(t2) {
            this.map = t2, this.load();
          }
          setCoordinates(e2) {
            this.coordinates = e2;
            const i2 = e2.map(t.MercatorCoordinate.fromLngLat);
            this.tileID = function(e3) {
              let i3 = 1 / 0, o3 = 1 / 0, a2 = -1 / 0, r2 = -1 / 0;
              for (const t2 of e3)
                i3 = Math.min(i3, t2.x), o3 = Math.min(o3, t2.y), a2 = Math.max(a2, t2.x), r2 = Math.max(r2, t2.y);
              const s2 = Math.max(a2 - i3, r2 - o3), n2 = Math.max(0, Math.floor(-Math.log(s2) / Math.LN2)), l2 = Math.pow(2, n2);
              return new t.CanonicalTileID(n2, Math.floor((i3 + a2) / 2 * l2), Math.floor((o3 + r2) / 2 * l2));
            }(i2), this.minzoom = this.maxzoom = this.tileID.z;
            const o2 = i2.map((t2) => this.tileID.getTilePoint(t2)._round());
            return this._boundsArray = new t.RasterBoundsArray(), this._boundsArray.emplaceBack(o2[0].x, o2[0].y, 0, 0), this._boundsArray.emplaceBack(o2[1].x, o2[1].y, t.EXTENT, 0), this._boundsArray.emplaceBack(o2[3].x, o2[3].y, 0, t.EXTENT), this._boundsArray.emplaceBack(o2[2].x, o2[2].y, t.EXTENT, t.EXTENT), this.boundsBuffer && (this.boundsBuffer.destroy(), delete this.boundsBuffer), this.fire(new t.Event("data", { dataType: "source", sourceDataType: "content" })), this;
          }
          prepare() {
            if (0 === Object.keys(this.tiles).length || !this.image)
              return;
            const e2 = this.map.painter.context, i2 = e2.gl;
            this.boundsBuffer || (this.boundsBuffer = e2.createVertexBuffer(this._boundsArray, S.members)), this.boundsSegments || (this.boundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture || (this.texture = new l(e2, this.image, i2.RGBA), this.texture.bind(i2.LINEAR, i2.CLAMP_TO_EDGE));
            for (const t2 in this.tiles) {
              const e3 = this.tiles[t2];
              "loaded" !== e3.state && (e3.state = "loaded", e3.texture = this.texture);
            }
          }
          loadTile(t2, e2) {
            this.tileID && this.tileID.equals(t2.tileID.canonical) ? (this.tiles[String(t2.tileID.wrap)] = t2, t2.buckets = {}, e2(null)) : (t2.state = "errored", e2(null));
          }
          serialize() {
            return { type: "image", url: this.options.url, coordinates: this.coordinates };
          }
          hasTransition() {
            return false;
          }
        }
        class z extends D {
          constructor(t2, e2, i2, o2) {
            super(t2, e2, i2, o2), this.roundZoom = true, this.type = "video", this.options = e2;
          }
          load() {
            this._loaded = false;
            const e2 = this.options;
            this.urls = [];
            for (const i2 of e2.urls)
              this.urls.push(this.map._requestManager.transformRequest(i2, t.ResourceType.Source).url);
            t.getVideo(this.urls, (e3, i2) => {
              this._loaded = true, e3 ? this.fire(new t.ErrorEvent(e3)) : i2 && (this.video = i2, this.video.loop = true, this.video.addEventListener("playing", () => {
                this.map.triggerRepaint();
              }), this.map && this.video.play(), this._finishLoading());
            });
          }
          pause() {
            this.video && this.video.pause();
          }
          play() {
            this.video && this.video.play();
          }
          seek(e2) {
            if (this.video) {
              const i2 = this.video.seekable;
              e2 < i2.start(0) || e2 > i2.end(0) ? this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${this.id}`, null, `Playback for this video can be set only between the ${i2.start(0)} and ${i2.end(0)}-second mark.`))) : this.video.currentTime = e2;
            }
          }
          getVideo() {
            return this.video;
          }
          onAdd(t2) {
            this.map || (this.map = t2, this.load(), this.video && (this.video.play(), this.setCoordinates(this.coordinates)));
          }
          prepare() {
            if (0 === Object.keys(this.tiles).length || this.video.readyState < 2)
              return;
            const e2 = this.map.painter.context, i2 = e2.gl;
            this.boundsBuffer || (this.boundsBuffer = e2.createVertexBuffer(this._boundsArray, S.members)), this.boundsSegments || (this.boundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture ? this.video.paused || (this.texture.bind(i2.LINEAR, i2.CLAMP_TO_EDGE), i2.texSubImage2D(i2.TEXTURE_2D, 0, 0, 0, i2.RGBA, i2.UNSIGNED_BYTE, this.video)) : (this.texture = new l(e2, this.video, i2.RGBA), this.texture.bind(i2.LINEAR, i2.CLAMP_TO_EDGE));
            for (const t2 in this.tiles) {
              const e3 = this.tiles[t2];
              "loaded" !== e3.state && (e3.state = "loaded", e3.texture = this.texture);
            }
          }
          serialize() {
            return { type: "video", urls: this.urls, coordinates: this.coordinates };
          }
          hasTransition() {
            return this.video && !this.video.paused;
          }
        }
        class P extends D {
          constructor(e2, i2, o2, a2) {
            super(e2, i2, o2, a2), i2.coordinates ? Array.isArray(i2.coordinates) && 4 === i2.coordinates.length && !i2.coordinates.some((t2) => !Array.isArray(t2) || 2 !== t2.length || t2.some((t3) => "number" != typeof t3)) || this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e2}`, null, '"coordinates" property must be an array of 4 longitude/latitude array pairs'))) : this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e2}`, null, 'missing required property "coordinates"'))), i2.animate && "boolean" != typeof i2.animate && this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e2}`, null, 'optional "animate" property must be a boolean value'))), i2.canvas ? "string" == typeof i2.canvas || i2.canvas instanceof HTMLCanvasElement || this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e2}`, null, '"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))) : this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e2}`, null, 'missing required property "canvas"'))), this.options = i2, this.animate = void 0 === i2.animate || i2.animate;
          }
          load() {
            this._loaded = true, this.canvas || (this.canvas = this.options.canvas instanceof HTMLCanvasElement ? this.options.canvas : document.getElementById(this.options.canvas)), this.width = this.canvas.width, this.height = this.canvas.height, this._hasInvalidDimensions() ? this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))) : (this.play = function() {
              this._playing = true, this.map.triggerRepaint();
            }, this.pause = function() {
              this._playing && (this.prepare(), this._playing = false);
            }, this._finishLoading());
          }
          getCanvas() {
            return this.canvas;
          }
          onAdd(t2) {
            this.map = t2, this.load(), this.canvas && this.animate && this.play();
          }
          onRemove() {
            this.pause();
          }
          prepare() {
            let e2 = false;
            if (this.canvas.width !== this.width && (this.width = this.canvas.width, e2 = true), this.canvas.height !== this.height && (this.height = this.canvas.height, e2 = true), this._hasInvalidDimensions())
              return;
            if (0 === Object.keys(this.tiles).length)
              return;
            const i2 = this.map.painter.context, o2 = i2.gl;
            this.boundsBuffer || (this.boundsBuffer = i2.createVertexBuffer(this._boundsArray, S.members)), this.boundsSegments || (this.boundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture ? (e2 || this._playing) && this.texture.update(this.canvas, { premultiply: true }) : this.texture = new l(i2, this.canvas, o2.RGBA, { premultiply: true });
            for (const t2 in this.tiles) {
              const e3 = this.tiles[t2];
              "loaded" !== e3.state && (e3.state = "loaded", e3.texture = this.texture);
            }
          }
          serialize() {
            return { type: "canvas", coordinates: this.coordinates };
          }
          hasTransition() {
            return this._playing;
          }
          _hasInvalidDimensions() {
            for (const t2 of [this.canvas.width, this.canvas.height])
              if (isNaN(t2) || t2 <= 0)
                return true;
            return false;
          }
        }
        const M = { vector: w, raster: T, "raster-dem": I2, geojson: C, video: z, image: D, canvas: P };
        function A2(e2, i2) {
          const o2 = t.create();
          return t.translate(o2, o2, [1, 1, 0]), t.scale(o2, o2, [0.5 * e2.width, 0.5 * e2.height, 1]), t.multiply(o2, o2, e2.calculatePosMatrix(i2.toUnwrapped()));
        }
        function L(t2, e2, i2, o2, a2, r2) {
          const s2 = function(t3, e3, i3) {
            if (t3)
              for (const o3 of t3) {
                const t4 = e3[o3];
                if (t4 && t4.source === i3 && "fill-extrusion" === t4.type)
                  return true;
              }
            else
              for (const t4 in e3) {
                const o3 = e3[t4];
                if (o3.source === i3 && "fill-extrusion" === o3.type)
                  return true;
              }
            return false;
          }(a2 && a2.layers, e2, t2.id), n2 = r2.maxPitchScaleFactor(), l2 = t2.tilesIn(o2, n2, s2);
          l2.sort(R);
          const c3 = [];
          for (const o3 of l2)
            c3.push({ wrappedTileID: o3.tileID.wrapped().key, queryResults: o3.tile.queryRenderedFeatures(e2, i2, t2._state, o3.queryGeometry, o3.cameraQueryGeometry, o3.scale, a2, r2, n2, A2(t2.transform, o3.tileID)) });
          const h2 = function(t3) {
            const e3 = {}, i3 = {};
            for (const o3 of t3) {
              const t4 = o3.queryResults, a3 = o3.wrappedTileID, r3 = i3[a3] = i3[a3] || {};
              for (const i4 in t4) {
                const o4 = t4[i4], a4 = r3[i4] = r3[i4] || {}, s3 = e3[i4] = e3[i4] || [];
                for (const t5 of o4)
                  a4[t5.featureIndex] || (a4[t5.featureIndex] = true, s3.push(t5));
              }
            }
            return e3;
          }(c3);
          for (const e3 in h2)
            h2[e3].forEach((e4) => {
              const i3 = e4.feature, o3 = t2.getFeatureState(i3.layer["source-layer"], i3.id);
              i3.source = i3.layer.source, i3.layer["source-layer"] && (i3.sourceLayer = i3.layer["source-layer"]), i3.state = o3;
            });
          return h2;
        }
        function R(t2, e2) {
          const i2 = t2.tileID, o2 = e2.tileID;
          return i2.overscaledZ - o2.overscaledZ || i2.canonical.y - o2.canonical.y || i2.wrap - o2.wrap || i2.canonical.x - o2.canonical.x;
        }
        class k {
          constructor(e2, i2) {
            this.tileID = e2, this.uid = t.uniqueId(), this.uses = 0, this.tileSize = i2, this.buckets = {}, this.expirationTime = null, this.queryPadding = 0, this.hasSymbolBuckets = false, this.hasRTLText = false, this.dependencies = {}, this.textures = [], this.textureCoords = {}, this.expiredRequestCount = 0, this.state = "loading";
          }
          registerFadeDuration(e2) {
            const i2 = e2 + this.timeAdded;
            i2 < t.exported.now() || this.fadeEndTime && i2 < this.fadeEndTime || (this.fadeEndTime = i2);
          }
          wasRequested() {
            return "errored" === this.state || "loaded" === this.state || "reloading" === this.state;
          }
          clearTextures(t2) {
            this.demTexture && t2.saveTileTexture(this.demTexture), this.textures.forEach((e2) => t2.saveTileTexture(e2)), this.demTexture = null, this.textures = [], this.textureCoords = {};
          }
          loadVectorData(e2, i2, o2) {
            if (this.hasData() && this.unloadVectorData(), this.state = "loaded", e2) {
              e2.featureIndex && (this.latestFeatureIndex = e2.featureIndex, e2.rawTileData ? (this.latestRawTileData = e2.rawTileData, this.latestFeatureIndex.rawTileData = e2.rawTileData) : this.latestRawTileData && (this.latestFeatureIndex.rawTileData = this.latestRawTileData)), this.collisionBoxArray = e2.collisionBoxArray, this.buckets = function(t2, e3) {
                const i3 = {};
                if (!e3)
                  return i3;
                for (const o3 of t2) {
                  const t3 = o3.layerIds.map((t4) => e3.getLayer(t4)).filter(Boolean);
                  if (0 !== t3.length) {
                    o3.layers = t3, o3.stateDependentLayerIds && (o3.stateDependentLayers = o3.stateDependentLayerIds.map((e4) => t3.filter((t4) => t4.id === e4)[0]));
                    for (const e4 of t3)
                      i3[e4.id] = o3;
                  }
                }
                return i3;
              }(e2.buckets, i2.style), this.hasSymbolBuckets = false;
              for (const e3 in this.buckets) {
                const i3 = this.buckets[e3];
                if (i3 instanceof t.SymbolBucket) {
                  if (this.hasSymbolBuckets = true, !o2)
                    break;
                  i3.justReloaded = true;
                }
              }
              if (this.hasRTLText = false, this.hasSymbolBuckets)
                for (const e3 in this.buckets) {
                  const i3 = this.buckets[e3];
                  if (i3 instanceof t.SymbolBucket && i3.hasRTLText) {
                    this.hasRTLText = true, t.lazyLoadRTLTextPlugin();
                    break;
                  }
                }
              this.queryPadding = 0;
              for (const t2 in this.buckets) {
                const e3 = this.buckets[t2];
                this.queryPadding = Math.max(this.queryPadding, i2.style.getLayer(t2).queryRadius(e3));
              }
              e2.imageAtlas && (this.imageAtlas = e2.imageAtlas), e2.glyphAtlasImage && (this.glyphAtlasImage = e2.glyphAtlasImage);
            } else
              this.collisionBoxArray = new t.CollisionBoxArray();
          }
          unloadVectorData() {
            for (const t2 in this.buckets)
              this.buckets[t2].destroy();
            this.buckets = {}, this.imageAtlasTexture && this.imageAtlasTexture.destroy(), this.imageAtlas && (this.imageAtlas = null), this.glyphAtlasTexture && this.glyphAtlasTexture.destroy(), this.latestFeatureIndex = null, this.state = "unloaded";
          }
          getBucket(t2) {
            return this.buckets[t2.id];
          }
          upload(t2) {
            for (const e3 in this.buckets) {
              const i2 = this.buckets[e3];
              i2.uploadPending() && i2.upload(t2);
            }
            const e2 = t2.gl;
            this.imageAtlas && !this.imageAtlas.uploaded && (this.imageAtlasTexture = new l(t2, this.imageAtlas.image, e2.RGBA), this.imageAtlas.uploaded = true), this.glyphAtlasImage && (this.glyphAtlasTexture = new l(t2, this.glyphAtlasImage, e2.ALPHA), this.glyphAtlasImage = null);
          }
          prepare(t2) {
            this.imageAtlas && this.imageAtlas.patchUpdatedImages(t2, this.imageAtlasTexture);
          }
          queryRenderedFeatures(t2, e2, i2, o2, a2, r2, s2, n2, l2, c3) {
            return this.latestFeatureIndex && this.latestFeatureIndex.rawTileData ? this.latestFeatureIndex.query({ queryGeometry: o2, cameraQueryGeometry: a2, scale: r2, tileSize: this.tileSize, pixelPosMatrix: c3, transform: n2, params: s2, queryPadding: this.queryPadding * l2 }, t2, e2, i2) : {};
          }
          querySourceFeatures(e2, i2) {
            const o2 = this.latestFeatureIndex;
            if (!o2 || !o2.rawTileData)
              return;
            const a2 = o2.loadVTLayers(), r2 = i2 ? i2.sourceLayer : "", s2 = a2._geojsonTileLayer || a2[r2];
            if (!s2)
              return;
            const n2 = t.createFilter(i2 && i2.filter), { z: l2, x: c3, y: h2 } = this.tileID.canonical, u2 = { z: l2, x: c3, y: h2 };
            for (let i3 = 0; i3 < s2.length; i3++) {
              const a3 = s2.feature(i3);
              if (n2.needGeometry) {
                const e3 = t.toEvaluationFeature(a3, true);
                if (!n2.filter(new t.EvaluationParameters(this.tileID.overscaledZ), e3, this.tileID.canonical))
                  continue;
              } else if (!n2.filter(new t.EvaluationParameters(this.tileID.overscaledZ), a3))
                continue;
              const d2 = o2.getId(a3, r2), m2 = new t.GeoJSONFeature(a3, l2, c3, h2, d2);
              m2.tile = u2, e2.push(m2);
            }
          }
          hasData() {
            return "loaded" === this.state || "reloading" === this.state || "expired" === this.state;
          }
          patternsLoaded() {
            return this.imageAtlas && !!Object.keys(this.imageAtlas.patternPositions).length;
          }
          setExpiryData(e2) {
            const i2 = this.expirationTime;
            if (e2.cacheControl) {
              const i3 = t.parseCacheControl(e2.cacheControl);
              i3["max-age"] && (this.expirationTime = Date.now() + 1e3 * i3["max-age"]);
            } else
              e2.expires && (this.expirationTime = new Date(e2.expires).getTime());
            if (this.expirationTime) {
              const t2 = Date.now();
              let e3 = false;
              if (this.expirationTime > t2)
                e3 = false;
              else if (i2)
                if (this.expirationTime < i2)
                  e3 = true;
                else {
                  const o2 = this.expirationTime - i2;
                  o2 ? this.expirationTime = t2 + Math.max(o2, 3e4) : e3 = true;
                }
              else
                e3 = true;
              e3 ? (this.expiredRequestCount++, this.state = "expired") : this.expiredRequestCount = 0;
            }
          }
          getExpiryTimeout() {
            if (this.expirationTime)
              return this.expiredRequestCount ? 1e3 * (1 << Math.min(this.expiredRequestCount - 1, 31)) : Math.min(this.expirationTime - new Date().getTime(), Math.pow(2, 31) - 1);
          }
          setFeatureState(t2, e2) {
            if (!this.latestFeatureIndex || !this.latestFeatureIndex.rawTileData || 0 === Object.keys(t2).length)
              return;
            const i2 = this.latestFeatureIndex.loadVTLayers();
            for (const o2 in this.buckets) {
              if (!e2.style.hasLayer(o2))
                continue;
              const a2 = this.buckets[o2], r2 = a2.layers[0].sourceLayer || "_geojsonTileLayer", s2 = i2[r2], n2 = t2[r2];
              if (!s2 || !n2 || 0 === Object.keys(n2).length)
                continue;
              a2.update(n2, s2, this.imageAtlas && this.imageAtlas.patternPositions || {});
              const l2 = e2 && e2.style && e2.style.getLayer(o2);
              l2 && (this.queryPadding = Math.max(this.queryPadding, l2.queryRadius(a2)));
            }
          }
          holdingForFade() {
            return void 0 !== this.symbolFadeHoldUntil;
          }
          symbolFadeFinished() {
            return !this.symbolFadeHoldUntil || this.symbolFadeHoldUntil < t.exported.now();
          }
          clearFadeHold() {
            this.symbolFadeHoldUntil = void 0;
          }
          setHoldDuration(e2) {
            this.symbolFadeHoldUntil = t.exported.now() + e2;
          }
          setDependencies(t2, e2) {
            const i2 = {};
            for (const t3 of e2)
              i2[t3] = true;
            this.dependencies[t2] = i2;
          }
          hasDependency(t2, e2) {
            for (const i2 of t2) {
              const t3 = this.dependencies[i2];
              if (t3) {
                for (const i3 of e2)
                  if (t3[i3])
                    return true;
              }
            }
            return false;
          }
        }
        class B {
          constructor(t2, e2) {
            this.max = t2, this.onRemove = e2, this.reset();
          }
          reset() {
            for (const t2 in this.data)
              for (const e2 of this.data[t2])
                e2.timeout && clearTimeout(e2.timeout), this.onRemove(e2.value);
            return this.data = {}, this.order = [], this;
          }
          add(t2, e2, i2) {
            const o2 = t2.wrapped().key;
            void 0 === this.data[o2] && (this.data[o2] = []);
            const a2 = { value: e2, timeout: void 0 };
            if (void 0 !== i2 && (a2.timeout = setTimeout(() => {
              this.remove(t2, a2);
            }, i2)), this.data[o2].push(a2), this.order.push(o2), this.order.length > this.max) {
              const t3 = this._getAndRemoveByKey(this.order[0]);
              t3 && this.onRemove(t3);
            }
            return this;
          }
          has(t2) {
            return t2.wrapped().key in this.data;
          }
          getAndRemove(t2) {
            return this.has(t2) ? this._getAndRemoveByKey(t2.wrapped().key) : null;
          }
          _getAndRemoveByKey(t2) {
            const e2 = this.data[t2].shift();
            return e2.timeout && clearTimeout(e2.timeout), 0 === this.data[t2].length && delete this.data[t2], this.order.splice(this.order.indexOf(t2), 1), e2.value;
          }
          getByKey(t2) {
            const e2 = this.data[t2];
            return e2 ? e2[0].value : null;
          }
          get(t2) {
            return this.has(t2) ? this.data[t2.wrapped().key][0].value : null;
          }
          remove(t2, e2) {
            if (!this.has(t2))
              return this;
            const i2 = t2.wrapped().key, o2 = void 0 === e2 ? 0 : this.data[i2].indexOf(e2), a2 = this.data[i2][o2];
            return this.data[i2].splice(o2, 1), a2.timeout && clearTimeout(a2.timeout), 0 === this.data[i2].length && delete this.data[i2], this.onRemove(a2.value), this.order.splice(this.order.indexOf(i2), 1), this;
          }
          setMaxSize(t2) {
            for (this.max = t2; this.order.length > this.max; ) {
              const t3 = this._getAndRemoveByKey(this.order[0]);
              t3 && this.onRemove(t3);
            }
            return this;
          }
          filter(t2) {
            const e2 = [];
            for (const i2 in this.data)
              for (const o2 of this.data[i2])
                t2(o2.value) || e2.push(o2);
            for (const t3 of e2)
              this.remove(t3.value.tileID, t3);
          }
        }
        class F {
          constructor() {
            this.state = {}, this.stateChanges = {}, this.deletedStates = {};
          }
          updateState(e2, i2, o2) {
            const a2 = String(i2);
            if (this.stateChanges[e2] = this.stateChanges[e2] || {}, this.stateChanges[e2][a2] = this.stateChanges[e2][a2] || {}, t.extend(this.stateChanges[e2][a2], o2), null === this.deletedStates[e2]) {
              this.deletedStates[e2] = {};
              for (const t2 in this.state[e2])
                t2 !== a2 && (this.deletedStates[e2][t2] = null);
            } else if (this.deletedStates[e2] && null === this.deletedStates[e2][a2]) {
              this.deletedStates[e2][a2] = {};
              for (const t2 in this.state[e2][a2])
                o2[t2] || (this.deletedStates[e2][a2][t2] = null);
            } else
              for (const t2 in o2)
                this.deletedStates[e2] && this.deletedStates[e2][a2] && null === this.deletedStates[e2][a2][t2] && delete this.deletedStates[e2][a2][t2];
          }
          removeFeatureState(t2, e2, i2) {
            if (null === this.deletedStates[t2])
              return;
            const o2 = String(e2);
            if (this.deletedStates[t2] = this.deletedStates[t2] || {}, i2 && void 0 !== e2)
              null !== this.deletedStates[t2][o2] && (this.deletedStates[t2][o2] = this.deletedStates[t2][o2] || {}, this.deletedStates[t2][o2][i2] = null);
            else if (void 0 !== e2)
              if (this.stateChanges[t2] && this.stateChanges[t2][o2])
                for (i2 in this.deletedStates[t2][o2] = {}, this.stateChanges[t2][o2])
                  this.deletedStates[t2][o2][i2] = null;
              else
                this.deletedStates[t2][o2] = null;
            else
              this.deletedStates[t2] = null;
          }
          getState(e2, i2) {
            const o2 = String(i2), a2 = t.extend({}, (this.state[e2] || {})[o2], (this.stateChanges[e2] || {})[o2]);
            if (null === this.deletedStates[e2])
              return {};
            if (this.deletedStates[e2]) {
              const t2 = this.deletedStates[e2][i2];
              if (null === t2)
                return {};
              for (const e3 in t2)
                delete a2[e3];
            }
            return a2;
          }
          initializeTileState(t2, e2) {
            t2.setFeatureState(this.state, e2);
          }
          coalesceChanges(e2, i2) {
            const o2 = {};
            for (const e3 in this.stateChanges) {
              this.state[e3] = this.state[e3] || {};
              const i3 = {};
              for (const o3 in this.stateChanges[e3])
                this.state[e3][o3] || (this.state[e3][o3] = {}), t.extend(this.state[e3][o3], this.stateChanges[e3][o3]), i3[o3] = this.state[e3][o3];
              o2[e3] = i3;
            }
            for (const e3 in this.deletedStates) {
              this.state[e3] = this.state[e3] || {};
              const i3 = {};
              if (null === this.deletedStates[e3])
                for (const t2 in this.state[e3])
                  i3[t2] = {}, this.state[e3][t2] = {};
              else
                for (const t2 in this.deletedStates[e3]) {
                  if (null === this.deletedStates[e3][t2])
                    this.state[e3][t2] = {};
                  else
                    for (const i4 of Object.keys(this.deletedStates[e3][t2]))
                      delete this.state[e3][t2][i4];
                  i3[t2] = this.state[e3][t2];
                }
              o2[e3] = o2[e3] || {}, t.extend(o2[e3], i3);
            }
            if (this.stateChanges = {}, this.deletedStates = {}, 0 !== Object.keys(o2).length)
              for (const t2 in e2)
                e2[t2].setFeatureState(o2, i2);
          }
        }
        class O2 extends t.Evented {
          constructor(e2, i2, o2) {
            super(), this.id = e2, this.dispatcher = o2, this.on("data", (t2) => {
              "source" === t2.dataType && "metadata" === t2.sourceDataType && (this._sourceLoaded = true), this._sourceLoaded && !this._paused && "source" === t2.dataType && "content" === t2.sourceDataType && (this.reload(), this.transform && this.update(this.transform, this.terrain));
            }), this.on("dataloading", () => {
              this._sourceErrored = false;
            }), this.on("error", () => {
              this._sourceErrored = this._source.loaded();
            }), this._source = function(e3, i3, o3, a2) {
              const r2 = new M[i3.type](e3, i3, o3, a2);
              if (r2.id !== e3)
                throw new Error(`Expected Source id to be ${e3} instead of ${r2.id}`);
              return t.bindAll(["load", "abort", "unload", "serialize", "prepare"], r2), r2;
            }(e2, i2, o2, this), this._tiles = {}, this._cache = new B(0, this._unloadTile.bind(this)), this._timers = {}, this._cacheTimers = {}, this._maxTileCacheSize = null, this._loadedParentTiles = {}, this._coveredTiles = {}, this._state = new F();
          }
          onAdd(t2) {
            this.map = t2, this._maxTileCacheSize = t2 ? t2._maxTileCacheSize : null, this._source && this._source.onAdd && this._source.onAdd(t2);
          }
          onRemove(t2) {
            this.clearTiles(), this._source && this._source.onRemove && this._source.onRemove(t2);
          }
          loaded() {
            if (this._sourceErrored)
              return true;
            if (!this._sourceLoaded)
              return false;
            if (!this._source.loaded())
              return false;
            for (const t2 in this._tiles) {
              const e2 = this._tiles[t2];
              if ("loaded" !== e2.state && "errored" !== e2.state)
                return false;
            }
            return true;
          }
          getSource() {
            return this._source;
          }
          pause() {
            this._paused = true;
          }
          resume() {
            if (!this._paused)
              return;
            const t2 = this._shouldReloadOnResume;
            this._paused = false, this._shouldReloadOnResume = false, t2 && this.reload(), this.transform && this.update(this.transform, this.terrain);
          }
          _loadTile(t2, e2) {
            return this._source.loadTile(t2, e2);
          }
          _unloadTile(t2) {
            if (this._source.unloadTile)
              return this._source.unloadTile(t2, () => {
              });
          }
          _abortTile(e2) {
            this._source.abortTile && this._source.abortTile(e2, () => {
            }), this._source.fire(new t.Event("dataabort", { tile: e2, coord: e2.tileID, dataType: "source" }));
          }
          serialize() {
            return this._source.serialize();
          }
          prepare(t2) {
            this._source.prepare && this._source.prepare(), this._state.coalesceChanges(this._tiles, this.map ? this.map.painter : null);
            for (const e2 in this._tiles) {
              const i2 = this._tiles[e2];
              i2.upload(t2), i2.prepare(this.map.style.imageManager);
            }
          }
          getIds() {
            return Object.values(this._tiles).map((t2) => t2.tileID).sort(U).map((t2) => t2.key);
          }
          getRenderableIds(e2) {
            const i2 = [];
            for (const t2 in this._tiles)
              this._isIdRenderable(t2, e2) && i2.push(this._tiles[t2]);
            return e2 ? i2.sort((e3, i3) => {
              const o2 = e3.tileID, a2 = i3.tileID, r2 = new t.pointGeometry(o2.canonical.x, o2.canonical.y)._rotate(this.transform.angle), s2 = new t.pointGeometry(a2.canonical.x, a2.canonical.y)._rotate(this.transform.angle);
              return o2.overscaledZ - a2.overscaledZ || s2.y - r2.y || s2.x - r2.x;
            }).map((t2) => t2.tileID.key) : i2.map((t2) => t2.tileID).sort(U).map((t2) => t2.key);
          }
          hasRenderableParent(t2) {
            const e2 = this.findLoadedParent(t2, 0);
            return !!e2 && this._isIdRenderable(e2.tileID.key);
          }
          _isIdRenderable(t2, e2) {
            return this._tiles[t2] && this._tiles[t2].hasData() && !this._coveredTiles[t2] && (e2 || !this._tiles[t2].holdingForFade());
          }
          reload() {
            if (this._paused)
              this._shouldReloadOnResume = true;
            else {
              this._cache.reset();
              for (const t2 in this._tiles)
                "errored" !== this._tiles[t2].state && this._reloadTile(t2, "reloading");
            }
          }
          _reloadTile(t2, e2) {
            const i2 = this._tiles[t2];
            i2 && ("loading" !== i2.state && (i2.state = e2), this._loadTile(i2, this._tileLoaded.bind(this, i2, t2, e2)));
          }
          _tileLoaded(e2, i2, o2, a2) {
            if (a2)
              return e2.state = "errored", void (404 !== a2.status ? this._source.fire(new t.ErrorEvent(a2, { tile: e2 })) : this.update(this.transform, this.terrain));
            e2.timeAdded = t.exported.now(), "expired" === o2 && (e2.refreshedUponExpiration = true), this._setTileReloadTimer(i2, e2), "raster-dem" === this.getSource().type && e2.dem && this._backfillDEM(e2), this._state.initializeTileState(e2, this.map ? this.map.painter : null), e2.aborted || this._source.fire(new t.Event("data", { dataType: "source", tile: e2, coord: e2.tileID }));
          }
          _backfillDEM(t2) {
            const e2 = this.getRenderableIds();
            for (let o2 = 0; o2 < e2.length; o2++) {
              const a2 = e2[o2];
              if (t2.neighboringTiles && t2.neighboringTiles[a2]) {
                const e3 = this.getTileByID(a2);
                i2(t2, e3), i2(e3, t2);
              }
            }
            function i2(t3, e3) {
              t3.needsHillshadePrepare = true, t3.needsTerrainPrepare = true;
              let i3 = e3.tileID.canonical.x - t3.tileID.canonical.x;
              const o2 = e3.tileID.canonical.y - t3.tileID.canonical.y, a2 = Math.pow(2, t3.tileID.canonical.z), r2 = e3.tileID.key;
              0 === i3 && 0 === o2 || Math.abs(o2) > 1 || (Math.abs(i3) > 1 && (1 === Math.abs(i3 + a2) ? i3 += a2 : 1 === Math.abs(i3 - a2) && (i3 -= a2)), e3.dem && t3.dem && (t3.dem.backfillBorder(e3.dem, i3, o2), t3.neighboringTiles && t3.neighboringTiles[r2] && (t3.neighboringTiles[r2].backfilled = true)));
            }
          }
          getTile(t2) {
            return this.getTileByID(t2.key);
          }
          getTileByID(t2) {
            return this._tiles[t2];
          }
          _retainLoadedChildren(t2, e2, i2, o2) {
            for (const a2 in this._tiles) {
              let r2 = this._tiles[a2];
              if (o2[a2] || !r2.hasData() || r2.tileID.overscaledZ <= e2 || r2.tileID.overscaledZ > i2)
                continue;
              let s2 = r2.tileID;
              for (; r2 && r2.tileID.overscaledZ > e2 + 1; ) {
                const t3 = r2.tileID.scaledTo(r2.tileID.overscaledZ - 1);
                r2 = this._tiles[t3.key], r2 && r2.hasData() && (s2 = t3);
              }
              let n2 = s2;
              for (; n2.overscaledZ > e2; )
                if (n2 = n2.scaledTo(n2.overscaledZ - 1), t2[n2.key]) {
                  o2[s2.key] = s2;
                  break;
                }
            }
          }
          findLoadedParent(t2, e2) {
            if (t2.key in this._loadedParentTiles) {
              const i2 = this._loadedParentTiles[t2.key];
              return i2 && i2.tileID.overscaledZ >= e2 ? i2 : null;
            }
            for (let i2 = t2.overscaledZ - 1; i2 >= e2; i2--) {
              const e3 = t2.scaledTo(i2), o2 = this._getLoadedTile(e3);
              if (o2)
                return o2;
            }
          }
          _getLoadedTile(t2) {
            const e2 = this._tiles[t2.key];
            return e2 && e2.hasData() ? e2 : this._cache.getByKey(t2.wrapped().key);
          }
          updateCacheSize(t2) {
            const e2 = Math.ceil(t2.width / this._source.tileSize) + 1, i2 = Math.ceil(t2.height / this._source.tileSize) + 1, o2 = Math.floor(e2 * i2 * 5), a2 = "number" == typeof this._maxTileCacheSize ? Math.min(this._maxTileCacheSize, o2) : o2;
            this._cache.setMaxSize(a2);
          }
          handleWrapJump(t2) {
            const e2 = Math.round((t2 - (void 0 === this._prevLng ? t2 : this._prevLng)) / 360);
            if (this._prevLng = t2, e2) {
              const t3 = {};
              for (const i2 in this._tiles) {
                const o2 = this._tiles[i2];
                o2.tileID = o2.tileID.unwrapTo(o2.tileID.wrap + e2), t3[o2.tileID.key] = o2;
              }
              this._tiles = t3;
              for (const t4 in this._timers)
                clearTimeout(this._timers[t4]), delete this._timers[t4];
              for (const t4 in this._tiles)
                this._setTileReloadTimer(t4, this._tiles[t4]);
            }
          }
          update(e2, i2) {
            if (this.transform = e2, this.terrain = i2, !this._sourceLoaded || this._paused)
              return;
            let o2;
            this.updateCacheSize(e2), this.handleWrapJump(this.transform.center.lng), this._coveredTiles = {}, this.used || this.usedForTerrain ? this._source.tileID ? o2 = e2.getVisibleUnwrappedCoordinates(this._source.tileID).map((e3) => new t.OverscaledTileID(e3.canonical.z, e3.wrap, e3.canonical.z, e3.canonical.x, e3.canonical.y)) : (o2 = e2.coveringTiles({ tileSize: this.usedForTerrain ? this.tileSize : this._source.tileSize, minzoom: this._source.minzoom, maxzoom: this._source.maxzoom, roundZoom: !this.usedForTerrain && this._source.roundZoom, reparseOverscaled: this._source.reparseOverscaled, terrain: i2 }), this._source.hasTile && (o2 = o2.filter((t2) => this._source.hasTile(t2)))) : o2 = [];
            const a2 = e2.coveringZoomLevel(this._source), r2 = Math.max(a2 - O2.maxOverzooming, this._source.minzoom), s2 = Math.max(a2 + O2.maxUnderzooming, this._source.minzoom);
            if (this.usedForTerrain) {
              const t2 = {};
              for (const e3 of o2)
                if (e3.canonical.z > this._source.minzoom) {
                  const i3 = e3.scaledTo(e3.canonical.z - 1);
                  t2[i3.key] = i3;
                  const o3 = e3.scaledTo(Math.max(this._source.minzoom, Math.min(e3.canonical.z, 5)));
                  t2[o3.key] = o3;
                }
              o2 = o2.concat(Object.values(t2));
            }
            const n2 = this._updateRetainedTiles(o2, a2);
            if (N(this._source.type)) {
              const e3 = {}, l3 = {}, c3 = Object.keys(n2);
              for (const i3 of c3) {
                const o3 = n2[i3], a3 = this._tiles[i3];
                if (!a3 || a3.fadeEndTime && a3.fadeEndTime <= t.exported.now())
                  continue;
                const s3 = this.findLoadedParent(o3, r2);
                s3 && (this._addTile(s3.tileID), e3[s3.tileID.key] = s3.tileID), l3[i3] = o3;
              }
              this._retainLoadedChildren(l3, a2, s2, n2);
              for (const t2 in e3)
                n2[t2] || (this._coveredTiles[t2] = true, n2[t2] = e3[t2]);
              if (i2) {
                const t2 = {}, e4 = {};
                for (const i3 of o2)
                  this._tiles[i3.key].hasData() ? t2[i3.key] = i3 : e4[i3.key] = i3;
                for (const i3 in e4) {
                  const o3 = e4[i3].children(this._source.maxzoom);
                  this._tiles[o3[0].key] && this._tiles[o3[1].key] && this._tiles[o3[2].key] && this._tiles[o3[3].key] && (t2[o3[0].key] = n2[o3[0].key] = o3[0], t2[o3[1].key] = n2[o3[1].key] = o3[1], t2[o3[2].key] = n2[o3[2].key] = o3[2], t2[o3[3].key] = n2[o3[3].key] = o3[3], delete e4[i3]);
                }
                for (const i3 in e4) {
                  const o3 = this.findLoadedParent(e4[i3], this._source.minzoom);
                  if (o3) {
                    t2[o3.tileID.key] = n2[o3.tileID.key] = o3.tileID;
                    for (const e5 in t2)
                      t2[e5].isChildOf(o3.tileID) && delete t2[e5];
                  }
                }
                for (const e5 in this._tiles)
                  t2[e5] || (this._coveredTiles[e5] = true);
              }
            }
            for (const t2 in n2)
              this._tiles[t2].clearFadeHold();
            const l2 = t.keysDifference(this._tiles, n2);
            for (const t2 of l2) {
              const e3 = this._tiles[t2];
              e3.hasSymbolBuckets && !e3.holdingForFade() ? e3.setHoldDuration(this.map._fadeDuration) : e3.hasSymbolBuckets && !e3.symbolFadeFinished() || this._removeTile(t2);
            }
            this._updateLoadedParentTileCache();
          }
          releaseSymbolFadeTiles() {
            for (const t2 in this._tiles)
              this._tiles[t2].holdingForFade() && this._removeTile(t2);
          }
          _updateRetainedTiles(t2, e2) {
            const i2 = {}, o2 = {}, a2 = Math.max(e2 - O2.maxOverzooming, this._source.minzoom), r2 = Math.max(e2 + O2.maxUnderzooming, this._source.minzoom), s2 = {};
            for (const o3 of t2) {
              const t3 = this._addTile(o3);
              i2[o3.key] = o3, t3.hasData() || e2 < this._source.maxzoom && (s2[o3.key] = o3);
            }
            this._retainLoadedChildren(s2, e2, r2, i2);
            for (const r3 of t2) {
              let t3 = this._tiles[r3.key];
              if (t3.hasData())
                continue;
              if (e2 + 1 > this._source.maxzoom) {
                const t4 = r3.children(this._source.maxzoom)[0], e3 = this.getTile(t4);
                if (e3 && e3.hasData()) {
                  i2[t4.key] = t4;
                  continue;
                }
              } else {
                const t4 = r3.children(this._source.maxzoom);
                if (i2[t4[0].key] && i2[t4[1].key] && i2[t4[2].key] && i2[t4[3].key])
                  continue;
              }
              let s3 = t3.wasRequested();
              for (let e3 = r3.overscaledZ - 1; e3 >= a2; --e3) {
                const a3 = r3.scaledTo(e3);
                if (o2[a3.key])
                  break;
                if (o2[a3.key] = true, t3 = this.getTile(a3), !t3 && s3 && (t3 = this._addTile(a3)), t3 && (i2[a3.key] = a3, s3 = t3.wasRequested(), t3.hasData()))
                  break;
              }
            }
            return i2;
          }
          _updateLoadedParentTileCache() {
            this._loadedParentTiles = {};
            for (const t2 in this._tiles) {
              const e2 = [];
              let i2, o2 = this._tiles[t2].tileID;
              for (; o2.overscaledZ > 0; ) {
                if (o2.key in this._loadedParentTiles) {
                  i2 = this._loadedParentTiles[o2.key];
                  break;
                }
                e2.push(o2.key);
                const t3 = o2.scaledTo(o2.overscaledZ - 1);
                if (i2 = this._getLoadedTile(t3), i2)
                  break;
                o2 = t3;
              }
              for (const t3 of e2)
                this._loadedParentTiles[t3] = i2;
            }
          }
          _addTile(e2) {
            let i2 = this._tiles[e2.key];
            if (i2)
              return i2;
            i2 = this._cache.getAndRemove(e2), i2 && (this._setTileReloadTimer(e2.key, i2), i2.tileID = e2, this._state.initializeTileState(i2, this.map ? this.map.painter : null), this._cacheTimers[e2.key] && (clearTimeout(this._cacheTimers[e2.key]), delete this._cacheTimers[e2.key], this._setTileReloadTimer(e2.key, i2)));
            const o2 = i2;
            return i2 || (i2 = new k(e2, this._source.tileSize * e2.overscaleFactor()), this._loadTile(i2, this._tileLoaded.bind(this, i2, e2.key, i2.state))), i2.uses++, this._tiles[e2.key] = i2, o2 || this._source.fire(new t.Event("dataloading", { tile: i2, coord: i2.tileID, dataType: "source" })), i2;
          }
          _setTileReloadTimer(t2, e2) {
            t2 in this._timers && (clearTimeout(this._timers[t2]), delete this._timers[t2]);
            const i2 = e2.getExpiryTimeout();
            i2 && (this._timers[t2] = setTimeout(() => {
              this._reloadTile(t2, "expired"), delete this._timers[t2];
            }, i2));
          }
          _removeTile(t2) {
            const e2 = this._tiles[t2];
            e2 && (e2.uses--, delete this._tiles[t2], this._timers[t2] && (clearTimeout(this._timers[t2]), delete this._timers[t2]), e2.uses > 0 || (e2.hasData() && "reloading" !== e2.state ? this._cache.add(e2.tileID, e2, e2.getExpiryTimeout()) : (e2.aborted = true, this._abortTile(e2), this._unloadTile(e2))));
          }
          clearTiles() {
            this._shouldReloadOnResume = false, this._paused = false;
            for (const t2 in this._tiles)
              this._removeTile(t2);
            this._cache.reset();
          }
          tilesIn(e2, i2, o2) {
            const a2 = [], r2 = this.transform;
            if (!r2)
              return a2;
            const s2 = o2 ? r2.getCameraQueryGeometry(e2) : e2, n2 = e2.map((t2) => r2.pointCoordinate(t2, this.terrain)), l2 = s2.map((t2) => r2.pointCoordinate(t2, this.terrain)), c3 = this.getIds();
            let h2 = 1 / 0, u2 = 1 / 0, d2 = -1 / 0, m2 = -1 / 0;
            for (const t2 of l2)
              h2 = Math.min(h2, t2.x), u2 = Math.min(u2, t2.y), d2 = Math.max(d2, t2.x), m2 = Math.max(m2, t2.y);
            for (let e3 = 0; e3 < c3.length; e3++) {
              const o3 = this._tiles[c3[e3]];
              if (o3.holdingForFade())
                continue;
              const s3 = o3.tileID, _2 = Math.pow(2, r2.zoom - o3.tileID.overscaledZ), p3 = i2 * o3.queryPadding * t.EXTENT / o3.tileSize / _2, f2 = [s3.getTilePoint(new t.MercatorCoordinate(h2, u2)), s3.getTilePoint(new t.MercatorCoordinate(d2, m2))];
              if (f2[0].x - p3 < t.EXTENT && f2[0].y - p3 < t.EXTENT && f2[1].x + p3 >= 0 && f2[1].y + p3 >= 0) {
                const t2 = n2.map((t3) => s3.getTilePoint(t3)), e4 = l2.map((t3) => s3.getTilePoint(t3));
                a2.push({ tile: o3, tileID: s3, queryGeometry: t2, cameraQueryGeometry: e4, scale: _2 });
              }
            }
            return a2;
          }
          getVisibleCoordinates(t2) {
            const e2 = this.getRenderableIds(t2).map((t3) => this._tiles[t3].tileID);
            for (const t3 of e2)
              t3.posMatrix = this.transform.calculatePosMatrix(t3.toUnwrapped());
            return e2;
          }
          hasTransition() {
            if (this._source.hasTransition())
              return true;
            if (N(this._source.type))
              for (const e2 in this._tiles) {
                const i2 = this._tiles[e2];
                if (void 0 !== i2.fadeEndTime && i2.fadeEndTime >= t.exported.now())
                  return true;
              }
            return false;
          }
          setFeatureState(t2, e2, i2) {
            this._state.updateState(t2 = t2 || "_geojsonTileLayer", e2, i2);
          }
          removeFeatureState(t2, e2, i2) {
            this._state.removeFeatureState(t2 = t2 || "_geojsonTileLayer", e2, i2);
          }
          getFeatureState(t2, e2) {
            return this._state.getState(t2 = t2 || "_geojsonTileLayer", e2);
          }
          setDependencies(t2, e2, i2) {
            const o2 = this._tiles[t2];
            o2 && o2.setDependencies(e2, i2);
          }
          reloadTilesForDependencies(t2, e2) {
            for (const i2 in this._tiles)
              this._tiles[i2].hasDependency(t2, e2) && this._reloadTile(i2, "reloading");
            this._cache.filter((i2) => !i2.hasDependency(t2, e2));
          }
        }
        function U(t2, e2) {
          const i2 = Math.abs(2 * t2.wrap) - +(t2.wrap < 0), o2 = Math.abs(2 * e2.wrap) - +(e2.wrap < 0);
          return t2.overscaledZ - e2.overscaledZ || o2 - i2 || e2.canonical.y - t2.canonical.y || e2.canonical.x - t2.canonical.x;
        }
        function N(t2) {
          return "raster" === t2 || "image" === t2 || "video" === t2;
        }
        O2.maxOverzooming = 10, O2.maxUnderzooming = 3;
        const G = "mapboxgl_preloaded_worker_pool";
        class Z2 {
          constructor() {
            this.active = {};
          }
          acquire(t2) {
            if (!this.workers)
              for (this.workers = []; this.workers.length < Z2.workerCount; )
                this.workers.push(new Worker(ba.workerUrl));
            return this.active[t2] = true, this.workers.slice();
          }
          release(t2) {
            delete this.active[t2], 0 === this.numActive() && (this.workers.forEach((t3) => {
              t3.terminate();
            }), this.workers = null);
          }
          isPreloaded() {
            return !!this.active[G];
          }
          numActive() {
            return Object.keys(this.active).length;
          }
        }
        const V2 = Math.floor(t.exported.hardwareConcurrency / 2);
        let q;
        function j() {
          return q || (q = new Z2()), q;
        }
        function $(e2, i2) {
          const o2 = {};
          for (const t2 in e2)
            "ref" !== t2 && (o2[t2] = e2[t2]);
          return t.refProperties.forEach((t2) => {
            t2 in i2 && (o2[t2] = i2[t2]);
          }), o2;
        }
        function X(t2) {
          t2 = t2.slice();
          const e2 = /* @__PURE__ */ Object.create(null);
          for (let i2 = 0; i2 < t2.length; i2++)
            e2[t2[i2].id] = t2[i2];
          for (let i2 = 0; i2 < t2.length; i2++)
            "ref" in t2[i2] && (t2[i2] = $(t2[i2], e2[t2[i2].ref]));
          return t2;
        }
        Z2.workerCount = Math.max(Math.min(V2, 6), 1);
        const W = { setStyle: "setStyle", addLayer: "addLayer", removeLayer: "removeLayer", setPaintProperty: "setPaintProperty", setLayoutProperty: "setLayoutProperty", setFilter: "setFilter", addSource: "addSource", removeSource: "removeSource", setGeoJSONSourceData: "setGeoJSONSourceData", setLayerZoomRange: "setLayerZoomRange", setLayerProperty: "setLayerProperty", setCenter: "setCenter", setZoom: "setZoom", setBearing: "setBearing", setPitch: "setPitch", setSprite: "setSprite", setGlyphs: "setGlyphs", setTransition: "setTransition", setLight: "setLight" };
        function H(t2, e2, i2) {
          i2.push({ command: W.addSource, args: [t2, e2[t2]] });
        }
        function K(t2, e2, i2) {
          e2.push({ command: W.removeSource, args: [t2] }), i2[t2] = true;
        }
        function Y(t2, e2, i2, o2) {
          K(t2, i2, o2), H(t2, e2, i2);
        }
        function J(t2, e2, i2) {
          let o2;
          for (o2 in t2[i2])
            if (Object.prototype.hasOwnProperty.call(t2[i2], o2) && "data" !== o2 && !a(t2[i2][o2], e2[i2][o2]))
              return false;
          for (o2 in e2[i2])
            if (Object.prototype.hasOwnProperty.call(e2[i2], o2) && "data" !== o2 && !a(t2[i2][o2], e2[i2][o2]))
              return false;
          return true;
        }
        function Q(t2, e2, i2, o2, r2, s2) {
          let n2;
          for (n2 in e2 = e2 || {}, t2 = t2 || {})
            Object.prototype.hasOwnProperty.call(t2, n2) && (a(t2[n2], e2[n2]) || i2.push({ command: s2, args: [o2, n2, e2[n2], r2] }));
          for (n2 in e2)
            Object.prototype.hasOwnProperty.call(e2, n2) && !Object.prototype.hasOwnProperty.call(t2, n2) && (a(t2[n2], e2[n2]) || i2.push({ command: s2, args: [o2, n2, e2[n2], r2] }));
        }
        function tt(t2) {
          return t2.id;
        }
        function et(t2, e2) {
          return t2[e2.id] = e2, t2;
        }
        class it {
          constructor(t2, e2) {
            this.reset(t2, e2);
          }
          reset(t2, e2) {
            this.points = t2 || [], this._distances = [0];
            for (let t3 = 1; t3 < this.points.length; t3++)
              this._distances[t3] = this._distances[t3 - 1] + this.points[t3].dist(this.points[t3 - 1]);
            this.length = this._distances[this._distances.length - 1], this.padding = Math.min(e2 || 0, 0.5 * this.length), this.paddedLength = this.length - 2 * this.padding;
          }
          lerp(e2) {
            if (1 === this.points.length)
              return this.points[0];
            e2 = t.clamp(e2, 0, 1);
            let i2 = 1, o2 = this._distances[i2];
            const a2 = e2 * this.paddedLength + this.padding;
            for (; o2 < a2 && i2 < this._distances.length; )
              o2 = this._distances[++i2];
            const r2 = i2 - 1, s2 = this._distances[r2], n2 = o2 - s2, l2 = n2 > 0 ? (a2 - s2) / n2 : 0;
            return this.points[r2].mult(1 - l2).add(this.points[i2].mult(l2));
          }
        }
        function ot(t2, e2) {
          let i2 = true;
          return "always" === t2 || "never" !== t2 && "never" !== e2 || (i2 = false), i2;
        }
        class at {
          constructor(t2, e2, i2) {
            const o2 = this.boxCells = [], a2 = this.circleCells = [];
            this.xCellCount = Math.ceil(t2 / i2), this.yCellCount = Math.ceil(e2 / i2);
            for (let t3 = 0; t3 < this.xCellCount * this.yCellCount; t3++)
              o2.push([]), a2.push([]);
            this.circleKeys = [], this.boxKeys = [], this.bboxes = [], this.circles = [], this.width = t2, this.height = e2, this.xScale = this.xCellCount / t2, this.yScale = this.yCellCount / e2, this.boxUid = 0, this.circleUid = 0;
          }
          keysLength() {
            return this.boxKeys.length + this.circleKeys.length;
          }
          insert(t2, e2, i2, o2, a2) {
            this._forEachCell(e2, i2, o2, a2, this._insertBoxCell, this.boxUid++), this.boxKeys.push(t2), this.bboxes.push(e2), this.bboxes.push(i2), this.bboxes.push(o2), this.bboxes.push(a2);
          }
          insertCircle(t2, e2, i2, o2) {
            this._forEachCell(e2 - o2, i2 - o2, e2 + o2, i2 + o2, this._insertCircleCell, this.circleUid++), this.circleKeys.push(t2), this.circles.push(e2), this.circles.push(i2), this.circles.push(o2);
          }
          _insertBoxCell(t2, e2, i2, o2, a2, r2) {
            this.boxCells[a2].push(r2);
          }
          _insertCircleCell(t2, e2, i2, o2, a2, r2) {
            this.circleCells[a2].push(r2);
          }
          _query(t2, e2, i2, o2, a2, r2, s2) {
            if (i2 < 0 || t2 > this.width || o2 < 0 || e2 > this.height)
              return [];
            const n2 = [];
            if (t2 <= 0 && e2 <= 0 && this.width <= i2 && this.height <= o2) {
              if (a2)
                return [{ key: null, x1: t2, y1: e2, x2: i2, y2: o2 }];
              for (let t3 = 0; t3 < this.boxKeys.length; t3++)
                n2.push({ key: this.boxKeys[t3], x1: this.bboxes[4 * t3], y1: this.bboxes[4 * t3 + 1], x2: this.bboxes[4 * t3 + 2], y2: this.bboxes[4 * t3 + 3] });
              for (let t3 = 0; t3 < this.circleKeys.length; t3++) {
                const e3 = this.circles[3 * t3], i3 = this.circles[3 * t3 + 1], o3 = this.circles[3 * t3 + 2];
                n2.push({ key: this.circleKeys[t3], x1: e3 - o3, y1: i3 - o3, x2: e3 + o3, y2: i3 + o3 });
              }
            } else
              this._forEachCell(t2, e2, i2, o2, this._queryCell, n2, { hitTest: a2, overlapMode: r2, seenUids: { box: {}, circle: {} } }, s2);
            return n2;
          }
          query(t2, e2, i2, o2) {
            return this._query(t2, e2, i2, o2, false, null);
          }
          hitTest(t2, e2, i2, o2, a2, r2) {
            return this._query(t2, e2, i2, o2, true, a2, r2).length > 0;
          }
          hitTestCircle(t2, e2, i2, o2, a2) {
            const r2 = t2 - i2, s2 = t2 + i2, n2 = e2 - i2, l2 = e2 + i2;
            if (s2 < 0 || r2 > this.width || l2 < 0 || n2 > this.height)
              return false;
            const c3 = [];
            return this._forEachCell(r2, n2, s2, l2, this._queryCellCircle, c3, { hitTest: true, overlapMode: o2, circle: { x: t2, y: e2, radius: i2 }, seenUids: { box: {}, circle: {} } }, a2), c3.length > 0;
          }
          _queryCell(t2, e2, i2, o2, a2, r2, s2, n2) {
            const { seenUids: l2, hitTest: c3, overlapMode: h2 } = s2, u2 = this.boxCells[a2];
            if (null !== u2) {
              const a3 = this.bboxes;
              for (const s3 of u2)
                if (!l2.box[s3]) {
                  l2.box[s3] = true;
                  const u3 = 4 * s3, d3 = this.boxKeys[s3];
                  if (t2 <= a3[u3 + 2] && e2 <= a3[u3 + 3] && i2 >= a3[u3 + 0] && o2 >= a3[u3 + 1] && (!n2 || n2(d3)) && (!c3 || !ot(h2, d3.overlapMode)) && (r2.push({ key: d3, x1: a3[u3], y1: a3[u3 + 1], x2: a3[u3 + 2], y2: a3[u3 + 3] }), c3))
                    return true;
                }
            }
            const d2 = this.circleCells[a2];
            if (null !== d2) {
              const a3 = this.circles;
              for (const s3 of d2)
                if (!l2.circle[s3]) {
                  l2.circle[s3] = true;
                  const u3 = 3 * s3, d3 = this.circleKeys[s3];
                  if (this._circleAndRectCollide(a3[u3], a3[u3 + 1], a3[u3 + 2], t2, e2, i2, o2) && (!n2 || n2(d3)) && (!c3 || !ot(h2, d3.overlapMode))) {
                    const t3 = a3[u3], e3 = a3[u3 + 1], i3 = a3[u3 + 2];
                    if (r2.push({ key: d3, x1: t3 - i3, y1: e3 - i3, x2: t3 + i3, y2: e3 + i3 }), c3)
                      return true;
                  }
                }
            }
            return false;
          }
          _queryCellCircle(t2, e2, i2, o2, a2, r2, s2, n2) {
            const { circle: l2, seenUids: c3, overlapMode: h2 } = s2, u2 = this.boxCells[a2];
            if (null !== u2) {
              const t3 = this.bboxes;
              for (const e3 of u2)
                if (!c3.box[e3]) {
                  c3.box[e3] = true;
                  const i3 = 4 * e3, o3 = this.boxKeys[e3];
                  if (this._circleAndRectCollide(l2.x, l2.y, l2.radius, t3[i3 + 0], t3[i3 + 1], t3[i3 + 2], t3[i3 + 3]) && (!n2 || n2(o3)) && !ot(h2, o3.overlapMode))
                    return r2.push(true), true;
                }
            }
            const d2 = this.circleCells[a2];
            if (null !== d2) {
              const t3 = this.circles;
              for (const e3 of d2)
                if (!c3.circle[e3]) {
                  c3.circle[e3] = true;
                  const i3 = 3 * e3, o3 = this.circleKeys[e3];
                  if (this._circlesCollide(t3[i3], t3[i3 + 1], t3[i3 + 2], l2.x, l2.y, l2.radius) && (!n2 || n2(o3)) && !ot(h2, o3.overlapMode))
                    return r2.push(true), true;
                }
            }
          }
          _forEachCell(t2, e2, i2, o2, a2, r2, s2, n2) {
            const l2 = this._convertToXCellCoord(t2), c3 = this._convertToYCellCoord(e2), h2 = this._convertToXCellCoord(i2), u2 = this._convertToYCellCoord(o2);
            for (let d2 = l2; d2 <= h2; d2++)
              for (let l3 = c3; l3 <= u2; l3++)
                if (a2.call(this, t2, e2, i2, o2, this.xCellCount * l3 + d2, r2, s2, n2))
                  return;
          }
          _convertToXCellCoord(t2) {
            return Math.max(0, Math.min(this.xCellCount - 1, Math.floor(t2 * this.xScale)));
          }
          _convertToYCellCoord(t2) {
            return Math.max(0, Math.min(this.yCellCount - 1, Math.floor(t2 * this.yScale)));
          }
          _circlesCollide(t2, e2, i2, o2, a2, r2) {
            const s2 = o2 - t2, n2 = a2 - e2, l2 = i2 + r2;
            return l2 * l2 > s2 * s2 + n2 * n2;
          }
          _circleAndRectCollide(t2, e2, i2, o2, a2, r2, s2) {
            const n2 = (r2 - o2) / 2, l2 = Math.abs(t2 - (o2 + n2));
            if (l2 > n2 + i2)
              return false;
            const c3 = (s2 - a2) / 2, h2 = Math.abs(e2 - (a2 + c3));
            if (h2 > c3 + i2)
              return false;
            if (l2 <= n2 || h2 <= c3)
              return true;
            const u2 = l2 - n2, d2 = h2 - c3;
            return u2 * u2 + d2 * d2 <= i2 * i2;
          }
        }
        function rt(e2, i2, o2, a2, r2) {
          const s2 = t.create();
          return i2 ? (t.scale(s2, s2, [1 / r2, 1 / r2, 1]), o2 || t.rotateZ(s2, s2, a2.angle)) : t.multiply(s2, a2.labelPlaneMatrix, e2), s2;
        }
        function st(e2, i2, o2, a2, r2) {
          if (i2) {
            const i3 = t.clone(e2);
            return t.scale(i3, i3, [r2, r2, 1]), o2 || t.rotateZ(i3, i3, -a2.angle), i3;
          }
          return a2.glCoordMatrix;
        }
        function nt(e2, i2, o2) {
          let a2;
          o2 ? (a2 = [e2.x, e2.y, o2(e2.x, e2.y), 1], t.transformMat4(a2, a2, i2)) : (a2 = [e2.x, e2.y, 0, 1], xt(a2, a2, i2));
          const r2 = a2[3];
          return { point: new t.pointGeometry(a2[0] / r2, a2[1] / r2), signedDistanceFromCamera: r2 };
        }
        function lt(t2, e2) {
          return 0.5 + t2 / e2 * 0.5;
        }
        function ct(t2, e2) {
          const i2 = t2[0] / t2[3], o2 = t2[1] / t2[3];
          return i2 >= -e2[0] && i2 <= e2[0] && o2 >= -e2[1] && o2 <= e2[1];
        }
        function ht(e2, i2, o2, a2, r2, s2, n2, l2, c3, h2) {
          const u2 = a2 ? e2.textSizeData : e2.iconSizeData, d2 = t.evaluateSizeForZoom(u2, o2.transform.zoom), m2 = [256 / o2.width * 2 + 1, 256 / o2.height * 2 + 1], _2 = a2 ? e2.text.dynamicLayoutVertexArray : e2.icon.dynamicLayoutVertexArray;
          _2.clear();
          const p3 = e2.lineVertexArray, f2 = a2 ? e2.text.placedSymbolArray : e2.icon.placedSymbolArray, g2 = o2.transform.width / o2.transform.height;
          let x2 = false;
          for (let a3 = 0; a3 < f2.length; a3++) {
            const v3 = f2.get(a3);
            if (v3.hidden || v3.writingMode === t.WritingMode.vertical && !x2) {
              gt(v3.numGlyphs, _2);
              continue;
            }
            let y3;
            if (x2 = false, h2 ? (y3 = [v3.anchorX, v3.anchorY, h2(v3.anchorX, v3.anchorY), 1], t.transformMat4(y3, y3, i2)) : (y3 = [v3.anchorX, v3.anchorY, 0, 1], xt(y3, y3, i2)), !ct(y3, m2)) {
              gt(v3.numGlyphs, _2);
              continue;
            }
            const b2 = lt(o2.transform.cameraToCenterDistance, y3[3]), w2 = t.evaluateSizeForFeature(u2, d2, v3), T2 = n2 ? w2 / b2 : w2 * b2, E2 = new t.pointGeometry(v3.anchorX, v3.anchorY), I3 = nt(E2, r2, h2).point, C2 = {}, S2 = mt(v3, T2, false, l2, i2, r2, s2, e2.glyphOffsetArray, p3, _2, I3, E2, C2, g2, c3, h2);
            x2 = S2.useVertical, (S2.notEnoughRoom || x2 || S2.needsFlipping && mt(v3, T2, true, l2, i2, r2, s2, e2.glyphOffsetArray, p3, _2, I3, E2, C2, g2, c3, h2).notEnoughRoom) && gt(v3.numGlyphs, _2);
          }
          a2 ? e2.text.dynamicLayoutVertexBuffer.updateData(_2) : e2.icon.dynamicLayoutVertexBuffer.updateData(_2);
        }
        function ut(t2, e2, i2, o2, a2, r2, s2, n2, l2, c3, h2, u2, d2) {
          const m2 = n2.glyphStartIndex + n2.numGlyphs, _2 = n2.lineStartIndex, p3 = n2.lineStartIndex + n2.lineLength, f2 = e2.getoffsetX(n2.glyphStartIndex), g2 = e2.getoffsetX(m2 - 1), x2 = pt(t2 * f2, i2, o2, a2, r2, s2, n2.segment, _2, p3, l2, c3, h2, u2, d2);
          if (!x2)
            return null;
          const v3 = pt(t2 * g2, i2, o2, a2, r2, s2, n2.segment, _2, p3, l2, c3, h2, u2, d2);
          return v3 ? { first: x2, last: v3 } : null;
        }
        function dt(e2, i2, o2, a2) {
          return e2 === t.WritingMode.horizontal && Math.abs(o2.y - i2.y) > Math.abs(o2.x - i2.x) * a2 ? { useVertical: true } : (e2 === t.WritingMode.vertical ? i2.y < o2.y : i2.x > o2.x) ? { needsFlipping: true } : null;
        }
        function mt(e2, i2, o2, a2, r2, s2, n2, l2, c3, h2, u2, d2, m2, _2, p3, f2) {
          const g2 = i2 / 24, x2 = e2.lineOffsetX * g2, v3 = e2.lineOffsetY * g2;
          let y3;
          if (e2.numGlyphs > 1) {
            const t2 = e2.glyphStartIndex + e2.numGlyphs, i3 = e2.lineStartIndex, r3 = e2.lineStartIndex + e2.lineLength, h3 = ut(g2, l2, x2, v3, o2, u2, d2, e2, c3, s2, m2, p3, f2);
            if (!h3)
              return { notEnoughRoom: true };
            const b2 = nt(h3.first.point, n2, f2).point, w2 = nt(h3.last.point, n2, f2).point;
            if (a2 && !o2) {
              const t3 = dt(e2.writingMode, b2, w2, _2);
              if (t3)
                return t3;
            }
            y3 = [h3.first];
            for (let a3 = e2.glyphStartIndex + 1; a3 < t2 - 1; a3++)
              y3.push(pt(g2 * l2.getoffsetX(a3), x2, v3, o2, u2, d2, e2.segment, i3, r3, c3, s2, m2, p3, f2));
            y3.push(h3.last);
          } else {
            if (a2 && !o2) {
              const i4 = nt(d2, r2, f2).point, o3 = e2.lineStartIndex + e2.segment + 1, a3 = new t.pointGeometry(c3.getx(o3), c3.gety(o3)), s3 = nt(a3, r2, f2), n3 = s3.signedDistanceFromCamera > 0 ? s3.point : _t(d2, a3, i4, 1, r2, f2), l3 = dt(e2.writingMode, i4, n3, _2);
              if (l3)
                return l3;
            }
            const i3 = pt(g2 * l2.getoffsetX(e2.glyphStartIndex), x2, v3, o2, u2, d2, e2.segment, e2.lineStartIndex, e2.lineStartIndex + e2.lineLength, c3, s2, m2, p3, f2);
            if (!i3)
              return { notEnoughRoom: true };
            y3 = [i3];
          }
          for (const e3 of y3)
            t.addDynamicAttributes(h2, e3.point, e3.angle);
          return {};
        }
        function _t(t2, e2, i2, o2, a2, r2) {
          const s2 = nt(t2.add(t2.sub(e2)._unit()), a2, r2).point, n2 = i2.sub(s2);
          return i2.add(n2._mult(o2 / n2.mag()));
        }
        function pt(e2, i2, o2, a2, r2, s2, n2, l2, c3, h2, u2, d2, m2, _2) {
          const p3 = a2 ? e2 - i2 : e2 + i2;
          let f2 = p3 > 0 ? 1 : -1, g2 = 0;
          a2 && (f2 *= -1, g2 = Math.PI), f2 < 0 && (g2 += Math.PI);
          let x2 = f2 > 0 ? l2 + n2 : l2 + n2 + 1, v3 = r2, y3 = r2, b2 = 0, w2 = 0;
          const T2 = Math.abs(p3), E2 = [];
          for (; b2 + w2 <= T2; ) {
            if (x2 += f2, x2 < l2 || x2 >= c3)
              return null;
            if (y3 = v3, E2.push(v3), v3 = d2[x2], void 0 === v3) {
              const e3 = new t.pointGeometry(h2.getx(x2), h2.gety(x2)), i3 = nt(e3, u2, _2);
              if (i3.signedDistanceFromCamera > 0)
                v3 = d2[x2] = i3.point;
              else {
                const i4 = x2 - f2;
                v3 = _t(0 === b2 ? s2 : new t.pointGeometry(h2.getx(i4), h2.gety(i4)), e3, y3, T2 - b2 + 1, u2, _2);
              }
            }
            b2 += w2, w2 = y3.dist(v3);
          }
          const I3 = (T2 - b2) / w2, C2 = v3.sub(y3), S2 = C2.mult(I3)._add(y3);
          S2._add(C2._unit()._perp()._mult(o2 * f2));
          const D2 = g2 + Math.atan2(v3.y - y3.y, v3.x - y3.x);
          return E2.push(S2), { point: S2, angle: m2 ? D2 : 0, path: E2 };
        }
        const ft = new Float32Array([-1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0]);
        function gt(t2, e2) {
          for (let i2 = 0; i2 < t2; i2++) {
            const t3 = e2.length;
            e2.resize(t3 + 4), e2.float32.set(ft, 3 * t3);
          }
        }
        function xt(t2, e2, i2) {
          const o2 = e2[0], a2 = e2[1];
          return t2[0] = i2[0] * o2 + i2[4] * a2 + i2[12], t2[1] = i2[1] * o2 + i2[5] * a2 + i2[13], t2[3] = i2[3] * o2 + i2[7] * a2 + i2[15], t2;
        }
        const vt = 100;
        class yt {
          constructor(t2, e2 = new at(t2.width + 200, t2.height + 200, 25), i2 = new at(t2.width + 200, t2.height + 200, 25)) {
            this.transform = t2, this.grid = e2, this.ignoredGrid = i2, this.pitchfactor = Math.cos(t2._pitch) * t2.cameraToCenterDistance, this.screenRightBoundary = t2.width + vt, this.screenBottomBoundary = t2.height + vt, this.gridRightBoundary = t2.width + 200, this.gridBottomBoundary = t2.height + 200, this.perspectiveRatioCutoff = 0.6;
          }
          placeCollisionBox(t2, e2, i2, o2, a2, r2) {
            const s2 = this.projectAndGetPerspectiveRatio(o2, t2.anchorPointX, t2.anchorPointY, r2), n2 = i2 * s2.perspectiveRatio, l2 = t2.x1 * n2 + s2.point.x, c3 = t2.y1 * n2 + s2.point.y, h2 = t2.x2 * n2 + s2.point.x, u2 = t2.y2 * n2 + s2.point.y;
            return !this.isInsideGrid(l2, c3, h2, u2) || "always" !== e2 && this.grid.hitTest(l2, c3, h2, u2, e2, a2) || s2.perspectiveRatio < this.perspectiveRatioCutoff ? { box: [], offscreen: false } : { box: [l2, c3, h2, u2], offscreen: this.isOffscreen(l2, c3, h2, u2) };
          }
          placeCollisionCircles(e2, i2, o2, a2, r2, s2, n2, l2, c3, h2, u2, d2, m2, _2) {
            const p3 = [], f2 = new t.pointGeometry(i2.anchorX, i2.anchorY), g2 = nt(f2, s2, _2), x2 = lt(this.transform.cameraToCenterDistance, g2.signedDistanceFromCamera), v3 = (h2 ? r2 / x2 : r2 * x2) / t.ONE_EM, y3 = nt(f2, n2, _2).point, b2 = ut(v3, a2, i2.lineOffsetX * v3, i2.lineOffsetY * v3, false, y3, f2, i2, o2, n2, {}, false, _2);
            let w2 = false, T2 = false, E2 = true;
            if (b2) {
              const i3 = 0.5 * d2 * x2 + m2, o3 = new t.pointGeometry(-100, -100), a3 = new t.pointGeometry(this.screenRightBoundary, this.screenBottomBoundary), r3 = new it(), s3 = b2.first, n3 = b2.last;
              let h3 = [];
              for (let t2 = s3.path.length - 1; t2 >= 1; t2--)
                h3.push(s3.path[t2]);
              for (let t2 = 1; t2 < n3.path.length; t2++)
                h3.push(n3.path[t2]);
              const f3 = 2.5 * i3;
              if (l2) {
                const t2 = h3.map((t3) => nt(t3, l2, _2));
                h3 = t2.some((t3) => t3.signedDistanceFromCamera <= 0) ? [] : t2.map((t3) => t3.point);
              }
              let g3 = [];
              if (h3.length > 0) {
                const e3 = h3[0].clone(), i4 = h3[0].clone();
                for (let t2 = 1; t2 < h3.length; t2++)
                  e3.x = Math.min(e3.x, h3[t2].x), e3.y = Math.min(e3.y, h3[t2].y), i4.x = Math.max(i4.x, h3[t2].x), i4.y = Math.max(i4.y, h3[t2].y);
                g3 = e3.x >= o3.x && i4.x <= a3.x && e3.y >= o3.y && i4.y <= a3.y ? [h3] : i4.x < o3.x || e3.x > a3.x || i4.y < o3.y || e3.y > a3.y ? [] : t.clipLine([h3], o3.x, o3.y, a3.x, a3.y);
              }
              for (const t2 of g3) {
                r3.reset(t2, 0.25 * i3);
                let o4 = 0;
                o4 = r3.length <= 0.5 * i3 ? 1 : Math.ceil(r3.paddedLength / f3) + 1;
                for (let t3 = 0; t3 < o4; t3++) {
                  const a4 = t3 / Math.max(o4 - 1, 1), s4 = r3.lerp(a4), n4 = s4.x + vt, l3 = s4.y + vt;
                  p3.push(n4, l3, i3, 0);
                  const h4 = n4 - i3, d3 = l3 - i3, m3 = n4 + i3, _3 = l3 + i3;
                  if (E2 = E2 && this.isOffscreen(h4, d3, m3, _3), T2 = T2 || this.isInsideGrid(h4, d3, m3, _3), "always" !== e2 && this.grid.hitTestCircle(n4, l3, i3, e2, u2) && (w2 = true, !c3))
                    return { circles: [], offscreen: false, collisionDetected: w2 };
                }
              }
            }
            return { circles: !c3 && w2 || !T2 || x2 < this.perspectiveRatioCutoff ? [] : p3, offscreen: E2, collisionDetected: w2 };
          }
          queryRenderedSymbols(e2) {
            if (0 === e2.length || 0 === this.grid.keysLength() && 0 === this.ignoredGrid.keysLength())
              return {};
            const i2 = [];
            let o2 = 1 / 0, a2 = 1 / 0, r2 = -1 / 0, s2 = -1 / 0;
            for (const n3 of e2) {
              const e3 = new t.pointGeometry(n3.x + vt, n3.y + vt);
              o2 = Math.min(o2, e3.x), a2 = Math.min(a2, e3.y), r2 = Math.max(r2, e3.x), s2 = Math.max(s2, e3.y), i2.push(e3);
            }
            const n2 = this.grid.query(o2, a2, r2, s2).concat(this.ignoredGrid.query(o2, a2, r2, s2)), l2 = {}, c3 = {};
            for (const e3 of n2) {
              const o3 = e3.key;
              if (void 0 === l2[o3.bucketInstanceId] && (l2[o3.bucketInstanceId] = {}), l2[o3.bucketInstanceId][o3.featureIndex])
                continue;
              const a3 = [new t.pointGeometry(e3.x1, e3.y1), new t.pointGeometry(e3.x2, e3.y1), new t.pointGeometry(e3.x2, e3.y2), new t.pointGeometry(e3.x1, e3.y2)];
              t.polygonIntersectsPolygon(i2, a3) && (l2[o3.bucketInstanceId][o3.featureIndex] = true, void 0 === c3[o3.bucketInstanceId] && (c3[o3.bucketInstanceId] = []), c3[o3.bucketInstanceId].push(o3.featureIndex));
            }
            return c3;
          }
          insertCollisionBox(t2, e2, i2, o2, a2, r2) {
            (i2 ? this.ignoredGrid : this.grid).insert({ bucketInstanceId: o2, featureIndex: a2, collisionGroupID: r2, overlapMode: e2 }, t2[0], t2[1], t2[2], t2[3]);
          }
          insertCollisionCircles(t2, e2, i2, o2, a2, r2) {
            const s2 = i2 ? this.ignoredGrid : this.grid, n2 = { bucketInstanceId: o2, featureIndex: a2, collisionGroupID: r2, overlapMode: e2 };
            for (let e3 = 0; e3 < t2.length; e3 += 4)
              s2.insertCircle(n2, t2[e3], t2[e3 + 1], t2[e3 + 2]);
          }
          projectAndGetPerspectiveRatio(e2, i2, o2, a2) {
            let r2;
            return a2 ? (r2 = [i2, o2, a2(i2, o2), 1], t.transformMat4(r2, r2, e2)) : (r2 = [i2, o2, 0, 1], xt(r2, r2, e2)), { point: new t.pointGeometry((r2[0] / r2[3] + 1) / 2 * this.transform.width + vt, (-r2[1] / r2[3] + 1) / 2 * this.transform.height + vt), perspectiveRatio: 0.5 + this.transform.cameraToCenterDistance / r2[3] * 0.5 };
          }
          isOffscreen(t2, e2, i2, o2) {
            return i2 < vt || t2 >= this.screenRightBoundary || o2 < vt || e2 > this.screenBottomBoundary;
          }
          isInsideGrid(t2, e2, i2, o2) {
            return i2 >= 0 && t2 < this.gridRightBoundary && o2 >= 0 && e2 < this.gridBottomBoundary;
          }
          getViewportMatrix() {
            const e2 = t.identity([]);
            return t.translate(e2, e2, [-100, -100, 0]), e2;
          }
        }
        function bt(e2, i2, o2) {
          return i2 * (t.EXTENT / (e2.tileSize * Math.pow(2, o2 - e2.tileID.overscaledZ)));
        }
        class wt {
          constructor(t2, e2, i2, o2) {
            this.opacity = t2 ? Math.max(0, Math.min(1, t2.opacity + (t2.placed ? e2 : -e2))) : o2 && i2 ? 1 : 0, this.placed = i2;
          }
          isHidden() {
            return 0 === this.opacity && !this.placed;
          }
        }
        class Tt {
          constructor(t2, e2, i2, o2, a2) {
            this.text = new wt(t2 ? t2.text : null, e2, i2, a2), this.icon = new wt(t2 ? t2.icon : null, e2, o2, a2);
          }
          isHidden() {
            return this.text.isHidden() && this.icon.isHidden();
          }
        }
        class Et {
          constructor(t2, e2, i2) {
            this.text = t2, this.icon = e2, this.skipFade = i2;
          }
        }
        class It {
          constructor() {
            this.invProjMatrix = t.create(), this.viewportMatrix = t.create(), this.circles = [];
          }
        }
        class Ct {
          constructor(t2, e2, i2, o2, a2) {
            this.bucketInstanceId = t2, this.featureIndex = e2, this.sourceLayerIndex = i2, this.bucketIndex = o2, this.tileID = a2;
          }
        }
        class St {
          constructor(t2) {
            this.crossSourceCollisions = t2, this.maxGroupID = 0, this.collisionGroups = {};
          }
          get(t2) {
            if (this.crossSourceCollisions)
              return { ID: 0, predicate: null };
            if (!this.collisionGroups[t2]) {
              const e2 = ++this.maxGroupID;
              this.collisionGroups[t2] = { ID: e2, predicate: (t3) => t3.collisionGroupID === e2 };
            }
            return this.collisionGroups[t2];
          }
        }
        function Dt(e2, i2, o2, a2, r2) {
          const { horizontalAlign: s2, verticalAlign: n2 } = t.getAnchorAlignment(e2), l2 = -(s2 - 0.5) * i2, c3 = -(n2 - 0.5) * o2, h2 = t.evaluateVariableOffset(e2, a2);
          return new t.pointGeometry(l2 + h2[0] * r2, c3 + h2[1] * r2);
        }
        function zt(e2, i2, o2, a2, r2, s2) {
          const { x1: n2, x2: l2, y1: c3, y2: h2, anchorPointX: u2, anchorPointY: d2 } = e2, m2 = new t.pointGeometry(i2, o2);
          return a2 && m2._rotate(r2 ? s2 : -s2), { x1: n2 + m2.x, y1: c3 + m2.y, x2: l2 + m2.x, y2: h2 + m2.y, anchorPointX: u2, anchorPointY: d2 };
        }
        class Pt {
          constructor(t2, e2, i2, o2, a2) {
            this.transform = t2.clone(), this.terrain = e2, this.collisionIndex = new yt(this.transform), this.placements = {}, this.opacities = {}, this.variableOffsets = {}, this.stale = false, this.commitTime = 0, this.fadeDuration = i2, this.retainedQueryData = {}, this.collisionGroups = new St(o2), this.collisionCircleArrays = {}, this.prevPlacement = a2, a2 && (a2.prevPlacement = void 0), this.placedOrientations = {};
          }
          getBucketParts(e2, i2, o2, a2) {
            const r2 = o2.getBucket(i2), s2 = o2.latestFeatureIndex;
            if (!r2 || !s2 || i2.id !== r2.layerIds[0])
              return;
            const n2 = o2.collisionBoxArray, l2 = r2.layers[0].layout, c3 = Math.pow(2, this.transform.zoom - o2.tileID.overscaledZ), h2 = o2.tileSize / t.EXTENT, u2 = this.transform.calculatePosMatrix(o2.tileID.toUnwrapped()), d2 = "map" === l2.get("text-pitch-alignment"), m2 = "map" === l2.get("text-rotation-alignment"), _2 = bt(o2, 1, this.transform.zoom), p3 = rt(u2, d2, m2, this.transform, _2);
            let f2 = null;
            if (d2) {
              const e3 = st(u2, d2, m2, this.transform, _2);
              f2 = t.multiply([], this.transform.labelPlaneMatrix, e3);
            }
            this.retainedQueryData[r2.bucketInstanceId] = new Ct(r2.bucketInstanceId, s2, r2.sourceLayerIndex, r2.index, o2.tileID);
            const g2 = { bucket: r2, layout: l2, posMatrix: u2, textLabelPlaneMatrix: p3, labelToScreenMatrix: f2, scale: c3, textPixelRatio: h2, holdingForFade: o2.holdingForFade(), collisionBoxArray: n2, partiallyEvaluatedTextSize: t.evaluateSizeForZoom(r2.textSizeData, this.transform.zoom), collisionGroup: this.collisionGroups.get(r2.sourceID) };
            if (a2)
              for (const t2 of r2.sortKeyRanges) {
                const { sortKey: i3, symbolInstanceStart: o3, symbolInstanceEnd: a3 } = t2;
                e2.push({ sortKey: i3, symbolInstanceStart: o3, symbolInstanceEnd: a3, parameters: g2 });
              }
            else
              e2.push({ symbolInstanceStart: 0, symbolInstanceEnd: r2.symbolInstances.length, parameters: g2 });
          }
          attemptAnchorPlacement(t2, e2, i2, o2, a2, r2, s2, n2, l2, c3, h2, u2, d2, m2, _2, p3) {
            const f2 = [u2.textOffset0, u2.textOffset1], g2 = Dt(t2, i2, o2, f2, a2), x2 = this.collisionIndex.placeCollisionBox(zt(e2, g2.x, g2.y, r2, s2, this.transform.angle), h2, n2, l2, c3.predicate, p3);
            if ((!_2 || 0 !== this.collisionIndex.placeCollisionBox(zt(_2, g2.x, g2.y, r2, s2, this.transform.angle), h2, n2, l2, c3.predicate, p3).box.length) && x2.box.length > 0) {
              let e3;
              if (this.prevPlacement && this.prevPlacement.variableOffsets[u2.crossTileID] && this.prevPlacement.placements[u2.crossTileID] && this.prevPlacement.placements[u2.crossTileID].text && (e3 = this.prevPlacement.variableOffsets[u2.crossTileID].anchor), 0 === u2.crossTileID)
                throw new Error("symbolInstance.crossTileID can't be 0");
              return this.variableOffsets[u2.crossTileID] = { textOffset: f2, width: i2, height: o2, anchor: t2, textBoxScale: a2, prevAnchor: e3 }, this.markUsedJustification(d2, t2, u2, m2), d2.allowVerticalPlacement && (this.markUsedOrientation(d2, m2, u2), this.placedOrientations[u2.crossTileID] = m2), { shift: g2, placedGlyphBoxes: x2 };
            }
          }
          placeLayerBucketPart(e2, i2, o2) {
            const { bucket: a2, layout: r2, posMatrix: s2, textLabelPlaneMatrix: n2, labelToScreenMatrix: l2, textPixelRatio: c3, holdingForFade: h2, collisionBoxArray: u2, partiallyEvaluatedTextSize: d2, collisionGroup: m2 } = e2.parameters, _2 = r2.get("text-optional"), p3 = r2.get("icon-optional"), f2 = t.getOverlapMode(r2, "text-overlap", "text-allow-overlap"), g2 = "always" === f2, x2 = t.getOverlapMode(r2, "icon-overlap", "icon-allow-overlap"), v3 = "always" === x2, y3 = "map" === r2.get("text-rotation-alignment"), b2 = "map" === r2.get("text-pitch-alignment"), w2 = "none" !== r2.get("icon-text-fit"), T2 = "viewport-y" === r2.get("symbol-z-order"), E2 = g2 && (v3 || !a2.hasIconData() || p3), I3 = v3 && (g2 || !a2.hasTextData() || _2);
            !a2.collisionArrays && u2 && a2.deserializeCollisionBoxes(u2);
            const C2 = (e3, u3) => {
              if (i2[e3.crossTileID])
                return;
              if (h2)
                return void (this.placements[e3.crossTileID] = new Et(false, false, false));
              let v4 = false, T3 = false, C3 = true, S2 = null, D2 = { box: null, offscreen: null }, z2 = { box: null, offscreen: null }, P2 = null, M2 = null, A3 = null, L2 = 0, R2 = 0, k2 = 0;
              u3.textFeatureIndex ? L2 = u3.textFeatureIndex : e3.useRuntimeCollisionCircles && (L2 = e3.featureIndex), u3.verticalTextFeatureIndex && (R2 = u3.verticalTextFeatureIndex);
              const B2 = this.retainedQueryData[a2.bucketInstanceId].tileID, F2 = this.terrain ? (t2, e4) => this.terrain.getElevation(B2, t2, e4) : null;
              for (const t2 of ["textBox", "verticalTextBox", "iconBox", "verticalIconBox"]) {
                const e4 = u3[t2];
                e4 && (e4.elevation = F2 ? F2(e4.anchorPointX, e4.anchorPointY) : 0);
              }
              const O3 = u3.textBox;
              if (O3) {
                const i3 = (i4) => {
                  let o4 = t.WritingMode.horizontal;
                  if (a2.allowVerticalPlacement && !i4 && this.prevPlacement) {
                    const t2 = this.prevPlacement.placedOrientations[e3.crossTileID];
                    t2 && (this.placedOrientations[e3.crossTileID] = t2, o4 = t2, this.markUsedOrientation(a2, o4, e3));
                  }
                  return o4;
                }, o3 = (i4, o4) => {
                  if (a2.allowVerticalPlacement && e3.numVerticalGlyphVertices > 0 && u3.verticalTextBox) {
                    for (const e4 of a2.writingModes)
                      if (e4 === t.WritingMode.vertical ? (D2 = o4(), z2 = D2) : D2 = i4(), D2 && D2.box && D2.box.length)
                        break;
                  } else
                    D2 = i4();
                };
                if (r2.get("text-variable-anchor")) {
                  let n3 = r2.get("text-variable-anchor");
                  if (this.prevPlacement && this.prevPlacement.variableOffsets[e3.crossTileID]) {
                    const t2 = this.prevPlacement.variableOffsets[e3.crossTileID];
                    n3.indexOf(t2.anchor) > 0 && (n3 = n3.filter((e4) => e4 !== t2.anchor), n3.unshift(t2.anchor));
                  }
                  const l3 = (t2, i4, o4) => {
                    const r3 = t2.x2 - t2.x1, l4 = t2.y2 - t2.y1, h4 = e3.textBoxScale, u4 = w2 && "never" === x2 ? i4 : null;
                    let d3 = { box: [], offscreen: false };
                    const _3 = "never" !== f2 ? 2 * n3.length : n3.length;
                    for (let i5 = 0; i5 < _3; ++i5) {
                      const _4 = this.attemptAnchorPlacement(n3[i5 % n3.length], t2, r3, l4, h4, y3, b2, c3, s2, m2, i5 >= n3.length ? f2 : "never", e3, a2, o4, u4, F2);
                      if (_4 && (d3 = _4.placedGlyphBoxes, d3 && d3.box && d3.box.length)) {
                        v4 = true, S2 = _4.shift;
                        break;
                      }
                    }
                    return d3;
                  };
                  o3(() => l3(O3, u3.iconBox, t.WritingMode.horizontal), () => {
                    const i4 = u3.verticalTextBox;
                    return a2.allowVerticalPlacement && !(D2 && D2.box && D2.box.length) && e3.numVerticalGlyphVertices > 0 && i4 ? l3(i4, u3.verticalIconBox, t.WritingMode.vertical) : { box: null, offscreen: null };
                  }), D2 && (v4 = D2.box, C3 = D2.offscreen);
                  const h3 = i3(D2 && D2.box);
                  if (!v4 && this.prevPlacement) {
                    const t2 = this.prevPlacement.variableOffsets[e3.crossTileID];
                    t2 && (this.variableOffsets[e3.crossTileID] = t2, this.markUsedJustification(a2, t2.anchor, e3, h3));
                  }
                } else {
                  const r3 = (t2, i4) => {
                    const o4 = this.collisionIndex.placeCollisionBox(t2, f2, c3, s2, m2.predicate, F2);
                    return o4 && o4.box && o4.box.length && (this.markUsedOrientation(a2, i4, e3), this.placedOrientations[e3.crossTileID] = i4), o4;
                  };
                  o3(() => r3(O3, t.WritingMode.horizontal), () => {
                    const i4 = u3.verticalTextBox;
                    return a2.allowVerticalPlacement && e3.numVerticalGlyphVertices > 0 && i4 ? r3(i4, t.WritingMode.vertical) : { box: null, offscreen: null };
                  }), i3(D2 && D2.box && D2.box.length);
                }
              }
              if (P2 = D2, v4 = P2 && P2.box && P2.box.length > 0, C3 = P2 && P2.offscreen, e3.useRuntimeCollisionCircles) {
                const i3 = a2.text.placedSymbolArray.get(e3.centerJustifiedTextSymbolIndex), c4 = t.evaluateSizeForFeature(a2.textSizeData, d2, i3), h3 = r2.get("text-padding");
                M2 = this.collisionIndex.placeCollisionCircles(f2, i3, a2.lineVertexArray, a2.glyphOffsetArray, c4, s2, n2, l2, o2, b2, m2.predicate, e3.collisionCircleDiameter, h3, F2), M2.circles.length && M2.collisionDetected && !o2 && t.warnOnce("Collisions detected, but collision boxes are not shown"), v4 = g2 || M2.circles.length > 0 && !M2.collisionDetected, C3 = C3 && M2.offscreen;
              }
              if (u3.iconFeatureIndex && (k2 = u3.iconFeatureIndex), u3.iconBox) {
                const t2 = (t3) => {
                  const e4 = w2 && S2 ? zt(t3, S2.x, S2.y, y3, b2, this.transform.angle) : t3;
                  return this.collisionIndex.placeCollisionBox(e4, x2, c3, s2, m2.predicate, F2);
                };
                z2 && z2.box && z2.box.length && u3.verticalIconBox ? (A3 = t2(u3.verticalIconBox), T3 = A3.box.length > 0) : (A3 = t2(u3.iconBox), T3 = A3.box.length > 0), C3 = C3 && A3.offscreen;
              }
              const U2 = _2 || 0 === e3.numHorizontalGlyphVertices && 0 === e3.numVerticalGlyphVertices, N2 = p3 || 0 === e3.numIconVertices;
              if (U2 || N2 ? N2 ? U2 || (T3 = T3 && v4) : v4 = T3 && v4 : T3 = v4 = T3 && v4, v4 && P2 && P2.box && this.collisionIndex.insertCollisionBox(P2.box, f2, r2.get("text-ignore-placement"), a2.bucketInstanceId, z2 && z2.box && R2 ? R2 : L2, m2.ID), T3 && A3 && this.collisionIndex.insertCollisionBox(A3.box, x2, r2.get("icon-ignore-placement"), a2.bucketInstanceId, k2, m2.ID), M2 && (v4 && this.collisionIndex.insertCollisionCircles(M2.circles, f2, r2.get("text-ignore-placement"), a2.bucketInstanceId, L2, m2.ID), o2)) {
                const t2 = a2.bucketInstanceId;
                let e4 = this.collisionCircleArrays[t2];
                void 0 === e4 && (e4 = this.collisionCircleArrays[t2] = new It());
                for (let t3 = 0; t3 < M2.circles.length; t3 += 4)
                  e4.circles.push(M2.circles[t3 + 0]), e4.circles.push(M2.circles[t3 + 1]), e4.circles.push(M2.circles[t3 + 2]), e4.circles.push(M2.collisionDetected ? 1 : 0);
              }
              if (0 === e3.crossTileID)
                throw new Error("symbolInstance.crossTileID can't be 0");
              if (0 === a2.bucketInstanceId)
                throw new Error("bucket.bucketInstanceId can't be 0");
              this.placements[e3.crossTileID] = new Et(v4 || E2, T3 || I3, C3 || a2.justReloaded), i2[e3.crossTileID] = true;
            };
            if (T2) {
              if (0 !== e2.symbolInstanceStart)
                throw new Error("bucket.bucketInstanceId should be 0");
              const t2 = a2.getSortedSymbolIndexes(this.transform.angle);
              for (let e3 = t2.length - 1; e3 >= 0; --e3) {
                const i3 = t2[e3];
                C2(a2.symbolInstances.get(i3), a2.collisionArrays[i3]);
              }
            } else
              for (let t2 = e2.symbolInstanceStart; t2 < e2.symbolInstanceEnd; t2++)
                C2(a2.symbolInstances.get(t2), a2.collisionArrays[t2]);
            if (o2 && a2.bucketInstanceId in this.collisionCircleArrays) {
              const e3 = this.collisionCircleArrays[a2.bucketInstanceId];
              t.invert(e3.invProjMatrix, s2), e3.viewportMatrix = this.collisionIndex.getViewportMatrix();
            }
            a2.justReloaded = false;
          }
          markUsedJustification(e2, i2, o2, a2) {
            let r2;
            r2 = a2 === t.WritingMode.vertical ? o2.verticalPlacedTextSymbolIndex : { left: o2.leftJustifiedTextSymbolIndex, center: o2.centerJustifiedTextSymbolIndex, right: o2.rightJustifiedTextSymbolIndex }[t.getAnchorJustification(i2)];
            const s2 = [o2.leftJustifiedTextSymbolIndex, o2.centerJustifiedTextSymbolIndex, o2.rightJustifiedTextSymbolIndex, o2.verticalPlacedTextSymbolIndex];
            for (const t2 of s2)
              t2 >= 0 && (e2.text.placedSymbolArray.get(t2).crossTileID = r2 >= 0 && t2 !== r2 ? 0 : o2.crossTileID);
          }
          markUsedOrientation(e2, i2, o2) {
            const a2 = i2 === t.WritingMode.horizontal || i2 === t.WritingMode.horizontalOnly ? i2 : 0, r2 = i2 === t.WritingMode.vertical ? i2 : 0, s2 = [o2.leftJustifiedTextSymbolIndex, o2.centerJustifiedTextSymbolIndex, o2.rightJustifiedTextSymbolIndex];
            for (const t2 of s2)
              e2.text.placedSymbolArray.get(t2).placedOrientation = a2;
            o2.verticalPlacedTextSymbolIndex && (e2.text.placedSymbolArray.get(o2.verticalPlacedTextSymbolIndex).placedOrientation = r2);
          }
          commit(t2) {
            this.commitTime = t2, this.zoomAtLastRecencyCheck = this.transform.zoom;
            const e2 = this.prevPlacement;
            let i2 = false;
            this.prevZoomAdjustment = e2 ? e2.zoomAdjustment(this.transform.zoom) : 0;
            const o2 = e2 ? e2.symbolFadeChange(t2) : 1, a2 = e2 ? e2.opacities : {}, r2 = e2 ? e2.variableOffsets : {}, s2 = e2 ? e2.placedOrientations : {};
            for (const t3 in this.placements) {
              const e3 = this.placements[t3], r3 = a2[t3];
              r3 ? (this.opacities[t3] = new Tt(r3, o2, e3.text, e3.icon), i2 = i2 || e3.text !== r3.text.placed || e3.icon !== r3.icon.placed) : (this.opacities[t3] = new Tt(null, o2, e3.text, e3.icon, e3.skipFade), i2 = i2 || e3.text || e3.icon);
            }
            for (const t3 in a2) {
              const e3 = a2[t3];
              if (!this.opacities[t3]) {
                const a3 = new Tt(e3, o2, false, false);
                a3.isHidden() || (this.opacities[t3] = a3, i2 = i2 || e3.text.placed || e3.icon.placed);
              }
            }
            for (const t3 in r2)
              this.variableOffsets[t3] || !this.opacities[t3] || this.opacities[t3].isHidden() || (this.variableOffsets[t3] = r2[t3]);
            for (const t3 in s2)
              this.placedOrientations[t3] || !this.opacities[t3] || this.opacities[t3].isHidden() || (this.placedOrientations[t3] = s2[t3]);
            if (e2 && void 0 === e2.lastPlacementChangeTime)
              throw new Error("Last placement time for previous placement is not defined");
            i2 ? this.lastPlacementChangeTime = t2 : "number" != typeof this.lastPlacementChangeTime && (this.lastPlacementChangeTime = e2 ? e2.lastPlacementChangeTime : t2);
          }
          updateLayerOpacities(t2, e2) {
            const i2 = {};
            for (const o2 of e2) {
              const e3 = o2.getBucket(t2);
              e3 && o2.latestFeatureIndex && t2.id === e3.layerIds[0] && this.updateBucketOpacities(e3, i2, o2.collisionBoxArray);
            }
          }
          updateBucketOpacities(e2, i2, o2) {
            e2.hasTextData() && e2.text.opacityVertexArray.clear(), e2.hasIconData() && e2.icon.opacityVertexArray.clear(), e2.hasIconCollisionBoxData() && e2.iconCollisionBox.collisionVertexArray.clear(), e2.hasTextCollisionBoxData() && e2.textCollisionBox.collisionVertexArray.clear();
            const a2 = e2.layers[0].layout, r2 = new Tt(null, 0, false, false, true), s2 = a2.get("text-allow-overlap"), n2 = a2.get("icon-allow-overlap"), l2 = a2.get("text-variable-anchor"), c3 = "map" === a2.get("text-rotation-alignment"), h2 = "map" === a2.get("text-pitch-alignment"), u2 = "none" !== a2.get("icon-text-fit"), d2 = new Tt(null, 0, s2 && (n2 || !e2.hasIconData() || a2.get("icon-optional")), n2 && (s2 || !e2.hasTextData() || a2.get("text-optional")), true);
            !e2.collisionArrays && o2 && (e2.hasIconCollisionBoxData() || e2.hasTextCollisionBoxData()) && e2.deserializeCollisionBoxes(o2);
            const m2 = (t2, e3, i3) => {
              for (let o3 = 0; o3 < e3 / 4; o3++)
                t2.opacityVertexArray.emplaceBack(i3);
            };
            for (let o3 = 0; o3 < e2.symbolInstances.length; o3++) {
              const a3 = e2.symbolInstances.get(o3), { numHorizontalGlyphVertices: s3, numVerticalGlyphVertices: n3, crossTileID: _2 } = a3;
              let p3 = this.opacities[_2];
              i2[_2] ? p3 = r2 : p3 || (p3 = d2, this.opacities[_2] = p3), i2[_2] = true;
              const f2 = a3.numIconVertices > 0, g2 = this.placedOrientations[a3.crossTileID], x2 = g2 === t.WritingMode.vertical, v3 = g2 === t.WritingMode.horizontal || g2 === t.WritingMode.horizontalOnly;
              if (s3 > 0 || n3 > 0) {
                const t2 = Ut(p3.text);
                m2(e2.text, s3, x2 ? Nt : t2), m2(e2.text, n3, v3 ? Nt : t2);
                const i3 = p3.text.isHidden();
                [a3.rightJustifiedTextSymbolIndex, a3.centerJustifiedTextSymbolIndex, a3.leftJustifiedTextSymbolIndex].forEach((t3) => {
                  t3 >= 0 && (e2.text.placedSymbolArray.get(t3).hidden = i3 || x2 ? 1 : 0);
                }), a3.verticalPlacedTextSymbolIndex >= 0 && (e2.text.placedSymbolArray.get(a3.verticalPlacedTextSymbolIndex).hidden = i3 || v3 ? 1 : 0);
                const o4 = this.variableOffsets[a3.crossTileID];
                o4 && this.markUsedJustification(e2, o4.anchor, a3, g2);
                const r3 = this.placedOrientations[a3.crossTileID];
                r3 && (this.markUsedJustification(e2, "left", a3, r3), this.markUsedOrientation(e2, r3, a3));
              }
              if (f2) {
                const t2 = Ut(p3.icon), i3 = !(u2 && a3.verticalPlacedIconSymbolIndex && x2);
                a3.placedIconSymbolIndex >= 0 && (m2(e2.icon, a3.numIconVertices, i3 ? t2 : Nt), e2.icon.placedSymbolArray.get(a3.placedIconSymbolIndex).hidden = p3.icon.isHidden()), a3.verticalPlacedIconSymbolIndex >= 0 && (m2(e2.icon, a3.numVerticalIconVertices, i3 ? Nt : t2), e2.icon.placedSymbolArray.get(a3.verticalPlacedIconSymbolIndex).hidden = p3.icon.isHidden());
              }
              if (e2.hasIconCollisionBoxData() || e2.hasTextCollisionBoxData()) {
                const i3 = e2.collisionArrays[o3];
                if (i3) {
                  let o4 = new t.pointGeometry(0, 0);
                  if (i3.textBox || i3.verticalTextBox) {
                    let t2 = true;
                    if (l2) {
                      const e3 = this.variableOffsets[_2];
                      e3 ? (o4 = Dt(e3.anchor, e3.width, e3.height, e3.textOffset, e3.textBoxScale), c3 && o4._rotate(h2 ? this.transform.angle : -this.transform.angle)) : t2 = false;
                    }
                    i3.textBox && Mt(e2.textCollisionBox.collisionVertexArray, p3.text.placed, !t2 || x2, o4.x, o4.y), i3.verticalTextBox && Mt(e2.textCollisionBox.collisionVertexArray, p3.text.placed, !t2 || v3, o4.x, o4.y);
                  }
                  const a4 = Boolean(!v3 && i3.verticalIconBox);
                  i3.iconBox && Mt(e2.iconCollisionBox.collisionVertexArray, p3.icon.placed, a4, u2 ? o4.x : 0, u2 ? o4.y : 0), i3.verticalIconBox && Mt(e2.iconCollisionBox.collisionVertexArray, p3.icon.placed, !a4, u2 ? o4.x : 0, u2 ? o4.y : 0);
                }
              }
            }
            if (e2.sortFeatures(this.transform.angle), this.retainedQueryData[e2.bucketInstanceId] && (this.retainedQueryData[e2.bucketInstanceId].featureSortOrder = e2.featureSortOrder), e2.hasTextData() && e2.text.opacityVertexBuffer && e2.text.opacityVertexBuffer.updateData(e2.text.opacityVertexArray), e2.hasIconData() && e2.icon.opacityVertexBuffer && e2.icon.opacityVertexBuffer.updateData(e2.icon.opacityVertexArray), e2.hasIconCollisionBoxData() && e2.iconCollisionBox.collisionVertexBuffer && e2.iconCollisionBox.collisionVertexBuffer.updateData(e2.iconCollisionBox.collisionVertexArray), e2.hasTextCollisionBoxData() && e2.textCollisionBox.collisionVertexBuffer && e2.textCollisionBox.collisionVertexBuffer.updateData(e2.textCollisionBox.collisionVertexArray), e2.text.opacityVertexArray.length !== e2.text.layoutVertexArray.length / 4)
              throw new Error(`bucket.text.opacityVertexArray.length (= ${e2.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e2.text.layoutVertexArray.length}) / 4`);
            if (e2.icon.opacityVertexArray.length !== e2.icon.layoutVertexArray.length / 4)
              throw new Error(`bucket.icon.opacityVertexArray.length (= ${e2.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e2.icon.layoutVertexArray.length}) / 4`);
            if (e2.bucketInstanceId in this.collisionCircleArrays) {
              const t2 = this.collisionCircleArrays[e2.bucketInstanceId];
              e2.placementInvProjMatrix = t2.invProjMatrix, e2.placementViewportMatrix = t2.viewportMatrix, e2.collisionCircleArray = t2.circles, delete this.collisionCircleArrays[e2.bucketInstanceId];
            }
          }
          symbolFadeChange(t2) {
            return 0 === this.fadeDuration ? 1 : (t2 - this.commitTime) / this.fadeDuration + this.prevZoomAdjustment;
          }
          zoomAdjustment(t2) {
            return Math.max(0, (this.transform.zoom - t2) / 1.5);
          }
          hasTransitions(t2) {
            return this.stale || t2 - this.lastPlacementChangeTime < this.fadeDuration;
          }
          stillRecent(t2, e2) {
            const i2 = this.zoomAtLastRecencyCheck === e2 ? 1 - this.zoomAdjustment(e2) : 1;
            return this.zoomAtLastRecencyCheck = e2, this.commitTime + this.fadeDuration * i2 > t2;
          }
          setStale() {
            this.stale = true;
          }
        }
        function Mt(t2, e2, i2, o2, a2) {
          t2.emplaceBack(e2 ? 1 : 0, i2 ? 1 : 0, o2 || 0, a2 || 0), t2.emplaceBack(e2 ? 1 : 0, i2 ? 1 : 0, o2 || 0, a2 || 0), t2.emplaceBack(e2 ? 1 : 0, i2 ? 1 : 0, o2 || 0, a2 || 0), t2.emplaceBack(e2 ? 1 : 0, i2 ? 1 : 0, o2 || 0, a2 || 0);
        }
        const At = Math.pow(2, 25), Lt = Math.pow(2, 24), Rt = Math.pow(2, 17), kt = Math.pow(2, 16), Bt = Math.pow(2, 9), Ft = Math.pow(2, 8), Ot = Math.pow(2, 1);
        function Ut(t2) {
          if (0 === t2.opacity && !t2.placed)
            return 0;
          if (1 === t2.opacity && t2.placed)
            return 4294967295;
          const e2 = t2.placed ? 1 : 0, i2 = Math.floor(127 * t2.opacity);
          return i2 * At + e2 * Lt + i2 * Rt + e2 * kt + i2 * Bt + e2 * Ft + i2 * Ot + e2;
        }
        const Nt = 0;
        class Gt {
          constructor(t2) {
            this._sortAcrossTiles = "viewport-y" !== t2.layout.get("symbol-z-order") && !t2.layout.get("symbol-sort-key").isConstant(), this._currentTileIndex = 0, this._currentPartIndex = 0, this._seenCrossTileIDs = {}, this._bucketParts = [];
          }
          continuePlacement(t2, e2, i2, o2, a2) {
            const r2 = this._bucketParts;
            for (; this._currentTileIndex < t2.length; )
              if (e2.getBucketParts(r2, o2, t2[this._currentTileIndex], this._sortAcrossTiles), this._currentTileIndex++, a2())
                return true;
            for (this._sortAcrossTiles && (this._sortAcrossTiles = false, r2.sort((t3, e3) => t3.sortKey - e3.sortKey)); this._currentPartIndex < r2.length; )
              if (e2.placeLayerBucketPart(r2[this._currentPartIndex], this._seenCrossTileIDs, i2), this._currentPartIndex++, a2())
                return true;
            return false;
          }
        }
        class Zt {
          constructor(t2, e2, i2, o2, a2, r2, s2, n2) {
            this.placement = new Pt(t2, e2, r2, s2, n2), this._currentPlacementIndex = i2.length - 1, this._forceFullPlacement = o2, this._showCollisionBoxes = a2, this._done = false;
          }
          isDone() {
            return this._done;
          }
          continuePlacement(e2, i2, o2) {
            const a2 = t.exported.now(), r2 = () => {
              const e3 = t.exported.now() - a2;
              return !this._forceFullPlacement && e3 > 2;
            };
            for (; this._currentPlacementIndex >= 0; ) {
              const t2 = i2[e2[this._currentPlacementIndex]], a3 = this.placement.collisionIndex.transform.zoom;
              if ("symbol" === t2.type && (!t2.minzoom || t2.minzoom <= a3) && (!t2.maxzoom || t2.maxzoom > a3)) {
                if (this._inProgressLayer || (this._inProgressLayer = new Gt(t2)), this._inProgressLayer.continuePlacement(o2[t2.source], this.placement, this._showCollisionBoxes, t2, r2))
                  return;
                delete this._inProgressLayer;
              }
              this._currentPlacementIndex--;
            }
            this._done = true;
          }
          commit(t2) {
            return this.placement.commit(t2), this.placement;
          }
        }
        const Vt = 512 / t.EXTENT / 2;
        class qt {
          constructor(t2, e2, i2) {
            this.tileID = t2, this.indexedSymbolInstances = {}, this.bucketInstanceId = i2;
            for (let i3 = 0; i3 < e2.length; i3++) {
              const o2 = e2.get(i3), a2 = o2.key;
              this.indexedSymbolInstances[a2] || (this.indexedSymbolInstances[a2] = []), this.indexedSymbolInstances[a2].push({ crossTileID: o2.crossTileID, coord: this.getScaledCoordinates(o2, t2) });
            }
          }
          getScaledCoordinates(e2, i2) {
            const o2 = Vt / Math.pow(2, i2.canonical.z - this.tileID.canonical.z);
            return { x: Math.floor((i2.canonical.x * t.EXTENT + e2.anchorX) * o2), y: Math.floor((i2.canonical.y * t.EXTENT + e2.anchorY) * o2) };
          }
          findMatches(t2, e2, i2) {
            const o2 = this.tileID.canonical.z < e2.canonical.z ? 1 : Math.pow(2, this.tileID.canonical.z - e2.canonical.z);
            for (let a2 = 0; a2 < t2.length; a2++) {
              const r2 = t2.get(a2);
              if (r2.crossTileID)
                continue;
              const s2 = this.indexedSymbolInstances[r2.key];
              if (!s2)
                continue;
              const n2 = this.getScaledCoordinates(r2, e2);
              for (const t3 of s2)
                if (Math.abs(t3.coord.x - n2.x) <= o2 && Math.abs(t3.coord.y - n2.y) <= o2 && !i2[t3.crossTileID]) {
                  i2[t3.crossTileID] = true, r2.crossTileID = t3.crossTileID;
                  break;
                }
            }
          }
        }
        class jt {
          constructor() {
            this.maxCrossTileID = 0;
          }
          generate() {
            return ++this.maxCrossTileID;
          }
        }
        class $t {
          constructor() {
            this.indexes = {}, this.usedCrossTileIDs = {}, this.lng = 0;
          }
          handleWrapJump(t2) {
            const e2 = Math.round((t2 - this.lng) / 360);
            if (0 !== e2)
              for (const t3 in this.indexes) {
                const i2 = this.indexes[t3], o2 = {};
                for (const t4 in i2) {
                  const a2 = i2[t4];
                  a2.tileID = a2.tileID.unwrapTo(a2.tileID.wrap + e2), o2[a2.tileID.key] = a2;
                }
                this.indexes[t3] = o2;
              }
            this.lng = t2;
          }
          addBucket(t2, e2, i2) {
            if (this.indexes[t2.overscaledZ] && this.indexes[t2.overscaledZ][t2.key]) {
              if (this.indexes[t2.overscaledZ][t2.key].bucketInstanceId === e2.bucketInstanceId)
                return false;
              this.removeBucketCrossTileIDs(t2.overscaledZ, this.indexes[t2.overscaledZ][t2.key]);
            }
            for (let t3 = 0; t3 < e2.symbolInstances.length; t3++)
              e2.symbolInstances.get(t3).crossTileID = 0;
            this.usedCrossTileIDs[t2.overscaledZ] || (this.usedCrossTileIDs[t2.overscaledZ] = {});
            const o2 = this.usedCrossTileIDs[t2.overscaledZ];
            for (const i3 in this.indexes) {
              const a2 = this.indexes[i3];
              if (Number(i3) > t2.overscaledZ)
                for (const i4 in a2) {
                  const r2 = a2[i4];
                  r2.tileID.isChildOf(t2) && r2.findMatches(e2.symbolInstances, t2, o2);
                }
              else {
                const r2 = a2[t2.scaledTo(Number(i3)).key];
                r2 && r2.findMatches(e2.symbolInstances, t2, o2);
              }
            }
            for (let t3 = 0; t3 < e2.symbolInstances.length; t3++) {
              const a2 = e2.symbolInstances.get(t3);
              a2.crossTileID || (a2.crossTileID = i2.generate(), o2[a2.crossTileID] = true);
            }
            return void 0 === this.indexes[t2.overscaledZ] && (this.indexes[t2.overscaledZ] = {}), this.indexes[t2.overscaledZ][t2.key] = new qt(t2, e2.symbolInstances, e2.bucketInstanceId), true;
          }
          removeBucketCrossTileIDs(t2, e2) {
            for (const i2 in e2.indexedSymbolInstances)
              for (const o2 of e2.indexedSymbolInstances[i2])
                delete this.usedCrossTileIDs[t2][o2.crossTileID];
          }
          removeStaleBuckets(t2) {
            let e2 = false;
            for (const i2 in this.indexes) {
              const o2 = this.indexes[i2];
              for (const a2 in o2)
                t2[o2[a2].bucketInstanceId] || (this.removeBucketCrossTileIDs(i2, o2[a2]), delete o2[a2], e2 = true);
            }
            return e2;
          }
        }
        class Xt {
          constructor() {
            this.layerIndexes = {}, this.crossTileIDs = new jt(), this.maxBucketInstanceId = 0, this.bucketsInCurrentPlacement = {};
          }
          addLayer(t2, e2, i2) {
            let o2 = this.layerIndexes[t2.id];
            void 0 === o2 && (o2 = this.layerIndexes[t2.id] = new $t());
            let a2 = false;
            const r2 = {};
            o2.handleWrapJump(i2);
            for (const i3 of e2) {
              const e3 = i3.getBucket(t2);
              e3 && t2.id === e3.layerIds[0] && (e3.bucketInstanceId || (e3.bucketInstanceId = ++this.maxBucketInstanceId), o2.addBucket(i3.tileID, e3, this.crossTileIDs) && (a2 = true), r2[e3.bucketInstanceId] = true);
            }
            return o2.removeStaleBuckets(r2) && (a2 = true), a2;
          }
          pruneUnusedLayers(t2) {
            const e2 = {};
            t2.forEach((t3) => {
              e2[t3] = true;
            });
            for (const t3 in this.layerIndexes)
              e2[t3] || delete this.layerIndexes[t3];
          }
        }
        var Wt = t.createLayout([{ name: "a_pos", type: "Int16", components: 2 }]);
        class Ht extends t.Evented {
          constructor(t2) {
            super(), this.sourceCache = t2, this._tiles = {}, this._renderableTilesKeys = [], this._sourceTileCache = {}, this.renderHistory = [], this.minzoom = 0, this.maxzoom = 22, this.tileSize = 512, this.deltaZoom = 1, this.renderHistorySize = t2._cache.max, t2.usedForTerrain = true, t2.tileSize = this.tileSize * 2 ** this.deltaZoom;
          }
          destruct() {
            this.sourceCache.usedForTerrain = false, this.sourceCache.tileSize = null;
            for (const t2 in this._tiles) {
              const e2 = this._tiles[t2];
              e2.textures.forEach((t3) => t3.destroy()), e2.textures = [];
            }
          }
          update(e2, i2) {
            this.sourceCache.update(e2, i2), this._renderableTilesKeys = [];
            for (const o2 of e2.coveringTiles({ tileSize: this.tileSize, minzoom: this.minzoom, maxzoom: this.maxzoom, reparseOverscaled: false, terrain: i2 }))
              this._renderableTilesKeys.push(o2.key), this._tiles[o2.key] || (o2.posMatrix = new Float64Array(16), t.ortho(o2.posMatrix, 0, t.EXTENT, 0, t.EXTENT, 0, 1), this._tiles[o2.key] = new k(o2, this.tileSize));
          }
          removeOutdated(t2) {
            const e2 = {};
            this.renderHistory = this.renderHistory.filter((t3, e3) => this.renderHistory.indexOf(t3) === e3).slice(0, this.renderHistorySize);
            for (const t3 of this._renderableTilesKeys)
              e2[t3] = true;
            for (const t3 of this.renderHistory)
              e2[t3] = true;
            for (const i2 in this._tiles)
              e2[i2] || (this._tiles[i2].clearTextures(t2), delete this._tiles[i2]);
          }
          getRenderableTiles() {
            return this._renderableTilesKeys.map((t2) => this.getTileByID(t2));
          }
          getTileByID(t2) {
            return this._tiles[t2];
          }
          getTerrainCoords(e2) {
            const i2 = {};
            for (const o2 of this._renderableTilesKeys) {
              const a2 = this._tiles[o2].tileID;
              if (a2.canonical.equals(e2.canonical)) {
                const a3 = e2.clone();
                a3.posMatrix = new Float64Array(16), t.ortho(a3.posMatrix, 0, t.EXTENT, 0, t.EXTENT, 0, 1), i2[o2] = a3;
              } else if (a2.canonical.isChildOf(e2.canonical)) {
                const r2 = e2.clone();
                r2.posMatrix = new Float64Array(16);
                const s2 = a2.canonical.z - e2.canonical.z, n2 = a2.canonical.x - (a2.canonical.x >> s2 << s2), l2 = a2.canonical.y - (a2.canonical.y >> s2 << s2), c3 = t.EXTENT >> s2;
                t.ortho(r2.posMatrix, 0, c3, 0, c3, 0, 1), t.translate(r2.posMatrix, r2.posMatrix, [-n2 * c3, -l2 * c3, 0]), i2[o2] = r2;
              } else if (e2.canonical.isChildOf(a2.canonical)) {
                const r2 = e2.clone();
                r2.posMatrix = new Float64Array(16);
                const s2 = e2.canonical.z - a2.canonical.z, n2 = e2.canonical.x - (e2.canonical.x >> s2 << s2), l2 = e2.canonical.y - (e2.canonical.y >> s2 << s2), c3 = t.EXTENT >> s2;
                t.ortho(r2.posMatrix, 0, t.EXTENT, 0, t.EXTENT, 0, 1), t.translate(r2.posMatrix, r2.posMatrix, [n2 * c3, l2 * c3, 0]), t.scale(r2.posMatrix, r2.posMatrix, [1 / 2 ** s2, 1 / 2 ** s2, 0]), i2[o2] = r2;
              }
            }
            return i2;
          }
          getSourceTile(t2, e2) {
            const i2 = this.sourceCache._source;
            let o2 = t2.overscaledZ - this.deltaZoom;
            if (o2 > i2.maxzoom && (o2 = i2.maxzoom), o2 < i2.minzoom)
              return null;
            this._sourceTileCache[t2.key] || (this._sourceTileCache[t2.key] = t2.scaledTo(o2).key);
            let a2 = this.sourceCache.getTileByID(this._sourceTileCache[t2.key]);
            if ((!a2 || !a2.dem) && e2)
              for (; o2 >= i2.minzoom && (!a2 || !a2.dem); )
                a2 = this.sourceCache.getTileByID(t2.scaledTo(o2--).key);
            return a2;
          }
          tilesAfterTime(t2 = Date.now()) {
            return Object.values(this._tiles).filter((e2) => e2.timeLoaded >= t2);
          }
        }
        class Kt {
          constructor(t2, e2, i2) {
            this.style = t2, this.sourceCache = new Ht(e2), this.options = i2, this.exaggeration = "number" == typeof i2.exaggeration ? i2.exaggeration : 1, this.elevationOffset = "number" == typeof i2.elevationOffset ? i2.elevationOffset : 450, this.qualityFactor = 2, this.meshSize = 128, this._demMatrixCache = {}, this.coordsIndex = [], this._coordsTextureSize = 1024, this.clearRerenderCache();
          }
          getDEMElevation(e2, i2, o2, a2 = t.EXTENT) {
            if (!(i2 >= 0 && i2 < a2 && o2 >= 0 && o2 < a2))
              return this.elevationOffset;
            let r2 = 0;
            const s2 = this.getTerrainData(e2);
            if (s2.tile && s2.tile.dem) {
              const e3 = t.transformMat4$1([], [i2 / a2 * t.EXTENT, o2 / a2 * t.EXTENT], s2.u_terrain_matrix), n2 = [e3[0] * s2.tile.dem.dim, e3[1] * s2.tile.dem.dim], l2 = [Math.floor(n2[0]), Math.floor(n2[1])], c3 = s2.tile.dem.get(l2[0], l2[1]), h2 = s2.tile.dem.get(l2[0], l2[1] + 1), u2 = s2.tile.dem.get(l2[0] + 1, l2[1]), d2 = s2.tile.dem.get(l2[0] + 1, l2[1] + 1);
              r2 = t.number(t.number(c3, h2, n2[0] - l2[0]), t.number(u2, d2, n2[0] - l2[0]), n2[1] - l2[1]);
            }
            return r2;
          }
          rememberForRerender(t2, e2) {
            for (const i2 in this.sourceCache._tiles) {
              const o2 = this.sourceCache._tiles[i2];
              (o2.tileID.equals(e2) || o2.tileID.isChildOf(e2)) && (t2 === this.sourceCache.sourceCache.id && (o2.timeLoaded = Date.now()), this._rerender[t2] = this._rerender[t2] || {}, this._rerender[t2][o2.tileID.key] = true);
            }
          }
          needsRerender(t2, e2) {
            return this._rerender[t2] && this._rerender[t2][e2.key];
          }
          clearRerenderCache() {
            this._rerender = {};
          }
          getElevation(e2, i2, o2, a2 = t.EXTENT) {
            return (this.getDEMElevation(e2, i2, o2, a2) + this.elevationOffset) * this.exaggeration;
          }
          getTerrainData(e2) {
            if (!this._emptyDemTexture) {
              const e3 = this.style.map.painter.context, i3 = new t.RGBAImage({ width: 1, height: 1 }, new Uint8Array(4));
              this._emptyDepthTexture = new l(e3, i3, e3.gl.RGBA, { premultiply: false }), this._emptyDemUnpack = [0, 0, 0, 0], this._emptyDemTexture = new l(e3, new t.RGBAImage({ width: 1, height: 1 }), e3.gl.RGBA, { premultiply: false }), this._emptyDemTexture.bind(e3.gl.NEAREST, e3.gl.CLAMP_TO_EDGE), this._emptyDemMatrix = t.identity([]);
            }
            const i2 = this.sourceCache.getSourceTile(e2, true);
            if (i2 && i2.dem && (!i2.demTexture || i2.needsTerrainPrepare)) {
              const t2 = this.style.map.painter.context;
              i2.demTexture = this.style.map.painter.getTileTexture(i2.dem.stride), i2.demTexture ? i2.demTexture.update(i2.dem.getPixels(), { premultiply: false }) : i2.demTexture = new l(t2, i2.dem.getPixels(), t2.gl.RGBA, { premultiply: false }), i2.demTexture.bind(t2.gl.NEAREST, t2.gl.CLAMP_TO_EDGE), i2.needsTerrainPrepare = false;
            }
            const o2 = i2 && i2 + i2.tileID.key + e2.key;
            if (o2 && !this._demMatrixCache[o2]) {
              const o3 = this.sourceCache.sourceCache._source.maxzoom;
              let a2 = e2.canonical.z - i2.tileID.canonical.z;
              e2.overscaledZ > e2.canonical.z && (e2.canonical.z >= o3 ? a2 = e2.canonical.z - o3 : t.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));
              const r2 = e2.canonical.x - (e2.canonical.x >> a2 << a2), s2 = e2.canonical.y - (e2.canonical.y >> a2 << a2), n2 = t.fromScaling(new Float64Array(16), [1 / (t.EXTENT << a2), 1 / (t.EXTENT << a2), 0]);
              t.translate(n2, n2, [r2 * t.EXTENT, s2 * t.EXTENT, 0]), this._demMatrixCache[e2.key] = { matrix: n2, coord: e2 };
            }
            return { u_depth: 2, u_terrain: 3, u_terrain_dim: i2 && i2.dem && i2.dem.dim || 1, u_terrain_matrix: o2 ? this._demMatrixCache[e2.key].matrix : this._emptyDemMatrix, u_terrain_unpack: i2 && i2.dem && i2.dem.getUnpackVector() || this._emptyDemUnpack, u_terrain_offset: this.elevationOffset, u_terrain_exaggeration: this.exaggeration, texture: (i2 && i2.demTexture || this._emptyDemTexture).texture, depthTexture: (this._fboDepthTexture || this._emptyDepthTexture).texture, tile: i2 };
          }
          getRTTFramebuffer() {
            const t2 = this.style.map.painter;
            if (!this._rttFramebuffer) {
              const e2 = this.sourceCache.tileSize * this.qualityFactor;
              this._rttFramebuffer = t2.context.createFramebuffer(e2, e2, true), this._rttFramebuffer.depthAttachment.set(t2.context.createRenderbuffer(t2.context.gl.DEPTH_COMPONENT16, e2, e2));
            }
            return this._rttFramebuffer;
          }
          getFramebuffer(t2) {
            const e2 = this.style.map.painter, i2 = e2.width / devicePixelRatio, o2 = e2.height / devicePixelRatio;
            return !this._fbo || this._fbo.width === i2 && this._fbo.height === o2 || (this._fbo.destroy(), this._fboCoordsTexture.destroy(), this._fboDepthTexture.destroy(), delete this._fbo, delete this._fboDepthTexture, delete this._fboCoordsTexture), this._fboCoordsTexture || (this._fboCoordsTexture = new l(e2.context, { width: i2, height: o2, data: null }, e2.context.gl.RGBA, { premultiply: false }), this._fboCoordsTexture.bind(e2.context.gl.NEAREST, e2.context.gl.CLAMP_TO_EDGE)), this._fboDepthTexture || (this._fboDepthTexture = new l(e2.context, { width: i2, height: o2, data: null }, e2.context.gl.RGBA, { premultiply: false }), this._fboDepthTexture.bind(e2.context.gl.NEAREST, e2.context.gl.CLAMP_TO_EDGE)), this._fbo || (this._fbo = e2.context.createFramebuffer(i2, o2, true), this._fbo.depthAttachment.set(e2.context.createRenderbuffer(e2.context.gl.DEPTH_COMPONENT16, i2, o2))), this._fbo.colorAttachment.set("coords" === t2 ? this._fboCoordsTexture.texture : this._fboDepthTexture.texture), this._fbo;
          }
          getCoordsTexture() {
            const e2 = this.style.map.painter.context;
            if (this._coordsTexture)
              return this._coordsTexture;
            const i2 = new Uint8Array(this._coordsTextureSize * this._coordsTextureSize * 4);
            for (let t2 = 0, e3 = 0; t2 < this._coordsTextureSize; t2++)
              for (let o3 = 0; o3 < this._coordsTextureSize; o3++, e3 += 4)
                i2[e3 + 0] = 255 & o3, i2[e3 + 1] = 255 & t2, i2[e3 + 2] = o3 >> 8 << 4 | t2 >> 8, i2[e3 + 3] = 0;
            const o2 = new t.RGBAImage({ width: this._coordsTextureSize, height: this._coordsTextureSize }, new Uint8Array(i2.buffer)), a2 = new l(e2, o2, e2.gl.RGBA, { premultiply: false });
            return a2.bind(e2.gl.NEAREST, e2.gl.CLAMP_TO_EDGE), this._coordsTexture = a2, a2;
          }
          pointCoordinate(e2) {
            const i2 = new Uint8Array(4), o2 = this.style.map.painter, a2 = o2.context, r2 = a2.gl;
            a2.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer), r2.readPixels(e2.x, o2.height / devicePixelRatio - e2.y - 1, 1, 1, r2.RGBA, r2.UNSIGNED_BYTE, i2), a2.bindFramebuffer.set(null);
            const s2 = i2[0] + (i2[2] >> 4 << 8), n2 = i2[1] + ((15 & i2[2]) << 8), l2 = this.coordsIndex[255 - i2[3]], c3 = l2 && this.sourceCache.getTileByID(l2);
            if (!c3)
              return null;
            const h2 = this._coordsTextureSize, u2 = (1 << c3.tileID.canonical.z) * h2;
            return new t.MercatorCoordinate((c3.tileID.canonical.x * h2 + s2) / u2, (c3.tileID.canonical.y * h2 + n2) / u2, this.getElevation(c3.tileID, s2, n2, h2));
          }
          getTerrainMesh() {
            if (this._mesh)
              return this._mesh;
            const e2 = this.style.map.painter.context, i2 = new t.PosArray(), o2 = new t.TriangleIndexArray(), a2 = this.meshSize, r2 = t.EXTENT / a2, s2 = a2 * a2;
            for (let t2 = 0; t2 <= a2; t2++)
              for (let e3 = 0; e3 <= a2; e3++)
                i2.emplaceBack(e3 * r2, t2 * r2);
            for (let t2 = 0; t2 < s2; t2 += a2 + 1)
              for (let e3 = 0; e3 < a2; e3++)
                o2.emplaceBack(e3 + t2, a2 + e3 + t2 + 1, a2 + e3 + t2 + 2), o2.emplaceBack(e3 + t2, a2 + e3 + t2 + 2, e3 + t2 + 1);
            return this._mesh = { indexBuffer: e2.createIndexBuffer(o2), vertexBuffer: e2.createVertexBuffer(i2, Wt.members), segments: t.SegmentVector.simpleSegment(0, 0, i2.length, o2.length) }, this._mesh;
          }
          getMinMaxElevation(t2) {
            const e2 = this.getTerrainData(t2).tile, i2 = { minElevation: null, maxElevation: null };
            return e2 && e2.dem && (i2.minElevation = (e2.dem.min + this.elevationOffset) * this.exaggeration, i2.maxElevation = (e2.dem.max + this.elevationOffset) * this.exaggeration), i2;
          }
        }
        const Yt = (e2, i2) => t.emitValidationErrors(e2, i2 && i2.filter((t2) => "source.canvas" !== t2.identifier)), Jt = t.pick(W, ["addLayer", "removeLayer", "setPaintProperty", "setLayoutProperty", "setFilter", "addSource", "removeSource", "setLayerZoomRange", "setLight", "setTransition", "setGeoJSONSourceData"]), Qt = t.pick(W, ["setCenter", "setZoom", "setBearing", "setPitch"]), te = function() {
          const e2 = {}, i2 = t.spec.$version;
          for (const o2 in t.spec.$root) {
            const a2 = t.spec.$root[o2];
            if (a2.required) {
              let t2 = null;
              t2 = "version" === o2 ? i2 : "array" === a2.type ? [] : {}, null != t2 && (e2[o2] = t2);
            }
          }
          return e2;
        }();
        class ee extends t.Evented {
          constructor(e2, i2 = {}) {
            super(), this.map = e2, this.dispatcher = new v2(j(), this), this.imageManager = new h(), this.imageManager.setEventedParent(this), this.glyphManager = new _(e2._requestManager, i2.localIdeographFontFamily), this.lineAtlas = new x(256, 512), this.crossTileSymbolIndex = new Xt(), this._layers = {}, this._serializedLayers = {}, this._order = [], this.sourceCaches = {}, this.zoomHistory = new t.ZoomHistory(), this._loaded = false, this._availableImages = [], this._resetUpdates(), this.dispatcher.broadcast("setReferrer", t.getReferrer());
            const o2 = this;
            this._rtlTextPluginCallback = ee.registerForPluginStateChange((e3) => {
              o2.dispatcher.broadcast("syncRTLPluginState", { pluginStatus: e3.pluginStatus, pluginURL: e3.pluginURL }, (e4, i3) => {
                if (t.triggerPluginCompletionEvent(e4), i3 && i3.every((t2) => t2))
                  for (const t2 in o2.sourceCaches)
                    o2.sourceCaches[t2].reload();
              });
            }), this.on("data", (t2) => {
              if ("source" !== t2.dataType || "metadata" !== t2.sourceDataType)
                return;
              const e3 = this.sourceCaches[t2.sourceId];
              if (!e3)
                return;
              const i3 = e3.getSource();
              if (i3 && i3.vectorLayerIds)
                for (const t3 in this._layers) {
                  const e4 = this._layers[t3];
                  e4.source === i3.id && this._validateLayer(e4);
                }
            });
          }
          loadURL(e2, i2 = {}) {
            this.fire(new t.Event("dataloading", { dataType: "style" }));
            const o2 = "boolean" != typeof i2.validate || i2.validate, a2 = this.map._requestManager.transformRequest(e2, t.ResourceType.Style);
            this._request = t.getJSON(a2, (e3, i3) => {
              this._request = null, e3 ? this.fire(new t.ErrorEvent(e3)) : i3 && this._load(i3, o2);
            });
          }
          loadJSON(e2, i2 = {}) {
            this.fire(new t.Event("dataloading", { dataType: "style" })), this._request = t.exported.frame(() => {
              this._request = null, this._load(e2, false !== i2.validate);
            });
          }
          loadEmpty() {
            this.fire(new t.Event("dataloading", { dataType: "style" })), this._load(te, false);
          }
          _load(e2, i2) {
            if (i2 && Yt(this, t.validateStyle(e2)))
              return;
            this._loaded = true, this.stylesheet = e2;
            for (const t2 in e2.sources)
              this.addSource(t2, e2.sources[t2], { validate: false });
            e2.sprite ? this._loadSprite(e2.sprite) : this.imageManager.setLoaded(true), this.glyphManager.setURL(e2.glyphs);
            const o2 = X(this.stylesheet.layers);
            this._order = o2.map((t2) => t2.id), this._layers = {}, this._serializedLayers = {};
            for (let e3 of o2)
              e3 = t.createStyleLayer(e3), e3.setEventedParent(this, { layer: { id: e3.id } }), this._layers[e3.id] = e3, this._serializedLayers[e3.id] = e3.serialize();
            this.dispatcher.broadcast("setLayers", this._serializeLayers(this._order)), this.light = new g(this.stylesheet.light), this.setTerrain(this.stylesheet.terrain), this.fire(new t.Event("data", { dataType: "style" })), this.fire(new t.Event("style.load"));
          }
          _loadSprite(e2) {
            this._spriteRequest = function(e3, i2, o2, a2) {
              let r2, s2, n2;
              const l2 = o2 > 1 ? "@2x" : "";
              let c3 = t.getJSON(i2.transformRequest(i2.normalizeSpriteURL(e3, l2, ".json"), t.ResourceType.SpriteJSON), (t2, e4) => {
                c3 = null, n2 || (n2 = t2, r2 = e4, u2());
              }), h2 = t.getImage(i2.transformRequest(i2.normalizeSpriteURL(e3, l2, ".png"), t.ResourceType.SpriteImage), (t2, e4) => {
                h2 = null, n2 || (n2 = t2, s2 = e4, u2());
              });
              function u2() {
                if (n2)
                  a2(n2);
                else if (r2 && s2) {
                  const e4 = t.exported.getImageData(s2), i3 = {};
                  for (const o3 in r2) {
                    const { width: a3, height: s3, x: n3, y: l3, sdf: c4, pixelRatio: h3, stretchX: u3, stretchY: d2, content: m2 } = r2[o3], _2 = new t.RGBAImage({ width: a3, height: s3 });
                    t.RGBAImage.copy(e4, _2, { x: n3, y: l3 }, { x: 0, y: 0 }, { width: a3, height: s3 }), i3[o3] = { data: _2, pixelRatio: h3, sdf: c4, stretchX: u3, stretchY: d2, content: m2 };
                  }
                  a2(null, i3);
                }
              }
              return { cancel() {
                c3 && (c3.cancel(), c3 = null), h2 && (h2.cancel(), h2 = null);
              } };
            }(e2, this.map._requestManager, this.map.getPixelRatio(), (e3, i2) => {
              if (this._spriteRequest = null, e3)
                this.fire(new t.ErrorEvent(e3));
              else if (i2)
                for (const t2 in i2)
                  this.imageManager.addImage(t2, i2[t2]);
              this.imageManager.setLoaded(true), this._availableImages = this.imageManager.listImages(), this.dispatcher.broadcast("setImages", this._availableImages), this.fire(new t.Event("data", { dataType: "style" }));
            });
          }
          _validateLayer(e2) {
            const i2 = this.sourceCaches[e2.source];
            if (!i2)
              return;
            const o2 = e2.sourceLayer;
            if (!o2)
              return;
            const a2 = i2.getSource();
            ("geojson" === a2.type || a2.vectorLayerIds && -1 === a2.vectorLayerIds.indexOf(o2)) && this.fire(new t.ErrorEvent(new Error(`Source layer "${o2}" does not exist on source "${a2.id}" as specified by style layer "${e2.id}".`)));
          }
          loaded() {
            if (!this._loaded)
              return false;
            if (Object.keys(this._updatedSources).length)
              return false;
            for (const t2 in this.sourceCaches)
              if (!this.sourceCaches[t2].loaded())
                return false;
            return !!this.imageManager.isLoaded();
          }
          _serializeLayers(t2) {
            const e2 = [];
            for (const i2 of t2) {
              const t3 = this._layers[i2];
              "custom" !== t3.type && e2.push(t3.serialize());
            }
            return e2;
          }
          hasTransitions() {
            if (this.light && this.light.hasTransition())
              return true;
            for (const t2 in this.sourceCaches)
              if (this.sourceCaches[t2].hasTransition())
                return true;
            for (const t2 in this._layers)
              if (this._layers[t2].hasTransition())
                return true;
            return false;
          }
          _checkLoaded() {
            if (!this._loaded)
              throw new Error("Style is not done loading.");
          }
          update(e2) {
            if (!this._loaded)
              return;
            const i2 = this._changed;
            if (this._changed) {
              const t2 = Object.keys(this._updatedLayers), i3 = Object.keys(this._removedLayers);
              (t2.length || i3.length) && this._updateWorkerLayers(t2, i3);
              for (const t3 in this._updatedSources) {
                const e3 = this._updatedSources[t3];
                if ("reload" === e3)
                  this._reloadSource(t3);
                else {
                  if ("clear" !== e3)
                    throw new Error(`Invalid action ${e3}`);
                  this._clearSource(t3);
                }
              }
              this._updateTilesForChangedImages();
              for (const t3 in this._updatedPaintProps)
                this._layers[t3].updateTransitions(e2);
              this.light.updateTransitions(e2), this._resetUpdates();
            }
            const o2 = {};
            for (const t2 in this.sourceCaches) {
              const e3 = this.sourceCaches[t2];
              o2[t2] = e3.used, e3.used = false;
            }
            for (const t2 of this._order) {
              const i3 = this._layers[t2];
              i3.recalculate(e2, this._availableImages), !i3.isHidden(e2.zoom) && i3.source && (this.sourceCaches[i3.source].used = true);
            }
            for (const e3 in o2) {
              const i3 = this.sourceCaches[e3];
              o2[e3] !== i3.used && i3.fire(new t.Event("data", { sourceDataType: "visibility", dataType: "source", sourceId: e3 }));
            }
            this.light.recalculate(e2), this.z = e2.zoom, i2 && this.fire(new t.Event("data", { dataType: "style" }));
          }
          _updateTilesForChangedImages() {
            const t2 = Object.keys(this._changedImages);
            if (t2.length) {
              for (const e2 in this.sourceCaches)
                this.sourceCaches[e2].reloadTilesForDependencies(["icons", "patterns"], t2);
              this._changedImages = {};
            }
          }
          _updateWorkerLayers(t2, e2) {
            this.dispatcher.broadcast("updateLayers", { layers: this._serializeLayers(t2), removedIds: e2 });
          }
          _resetUpdates() {
            this._changed = false, this._updatedLayers = {}, this._removedLayers = {}, this._updatedSources = {}, this._updatedPaintProps = {}, this._changedImages = {};
          }
          setTerrain(e2) {
            if (this._checkLoaded(), this._terrainDataCallback && this.off("data", this._terrainDataCallback), this._terrainfreezeElevationCallback && this.map.off("freezeElevation", this._terrainfreezeElevationCallback), e2) {
              const t2 = this.sourceCaches[e2.source];
              if (!t2)
                throw new Error(`cannot load terrain, because there exists no source with ID: ${e2.source}`);
              this.terrain = new Kt(this, t2, e2), this.map.transform.updateElevation(this.terrain), this._terrainfreezeElevationCallback = (t3) => {
                t3.freeze ? this.map.transform.freezeElevation = true : (this.map.transform.freezeElevation = false, this.map.transform.recalculateZoom(this.terrain));
              }, this._terrainDataCallback = (t3) => {
                t3.tile && (t3.sourceId === e2.source ? (this.map.transform.updateElevation(this.terrain), this.terrain.rememberForRerender(t3.sourceId, t3.tile.tileID)) : "geojson" === t3.source.type && this.terrain.rememberForRerender(t3.sourceId, t3.tile.tileID));
              }, this.on("data", this._terrainDataCallback), this.map.on("freezeElevation", this._terrainfreezeElevationCallback);
            } else
              this.terrain && this.terrain.sourceCache.destruct(), this.terrain = null, this.map.transform.updateElevation(this.terrain);
            this.map.fire(new t.Event("terrain", { terrain: e2 }));
          }
          setState(e2) {
            if (this._checkLoaded(), Yt(this, t.validateStyle(e2)))
              return false;
            (e2 = t.clone$1(e2)).layers = X(e2.layers);
            const i2 = function(t2, e3) {
              if (!t2)
                return [{ command: W.setStyle, args: [e3] }];
              let i3 = [];
              try {
                if (!a(t2.version, e3.version))
                  return [{ command: W.setStyle, args: [e3] }];
                a(t2.center, e3.center) || i3.push({ command: W.setCenter, args: [e3.center] }), a(t2.zoom, e3.zoom) || i3.push({ command: W.setZoom, args: [e3.zoom] }), a(t2.bearing, e3.bearing) || i3.push({ command: W.setBearing, args: [e3.bearing] }), a(t2.pitch, e3.pitch) || i3.push({ command: W.setPitch, args: [e3.pitch] }), a(t2.sprite, e3.sprite) || i3.push({ command: W.setSprite, args: [e3.sprite] }), a(t2.glyphs, e3.glyphs) || i3.push({ command: W.setGlyphs, args: [e3.glyphs] }), a(t2.transition, e3.transition) || i3.push({ command: W.setTransition, args: [e3.transition] }), a(t2.light, e3.light) || i3.push({ command: W.setLight, args: [e3.light] });
                const o3 = {}, r2 = [];
                !function(t3, e4, i4, o4) {
                  let r3;
                  for (r3 in e4 = e4 || {}, t3 = t3 || {})
                    Object.prototype.hasOwnProperty.call(t3, r3) && (Object.prototype.hasOwnProperty.call(e4, r3) || K(r3, i4, o4));
                  for (r3 in e4)
                    Object.prototype.hasOwnProperty.call(e4, r3) && (Object.prototype.hasOwnProperty.call(t3, r3) ? a(t3[r3], e4[r3]) || ("geojson" === t3[r3].type && "geojson" === e4[r3].type && J(t3, e4, r3) ? i4.push({ command: W.setGeoJSONSourceData, args: [r3, e4[r3].data] }) : Y(r3, e4, i4, o4)) : H(r3, e4, i4));
                }(t2.sources, e3.sources, r2, o3);
                const s2 = [];
                t2.layers && t2.layers.forEach((t3) => {
                  o3[t3.source] ? i3.push({ command: W.removeLayer, args: [t3.id] }) : s2.push(t3);
                }), i3 = i3.concat(r2), function(t3, e4, i4) {
                  e4 = e4 || [];
                  const o4 = (t3 = t3 || []).map(tt), r3 = e4.map(tt), s3 = t3.reduce(et, {}), n2 = e4.reduce(et, {}), l2 = o4.slice(), c3 = /* @__PURE__ */ Object.create(null);
                  let h2, u2, d2, m2, _2, p3, f2;
                  for (h2 = 0, u2 = 0; h2 < o4.length; h2++)
                    d2 = o4[h2], Object.prototype.hasOwnProperty.call(n2, d2) ? u2++ : (i4.push({ command: W.removeLayer, args: [d2] }), l2.splice(l2.indexOf(d2, u2), 1));
                  for (h2 = 0, u2 = 0; h2 < r3.length; h2++)
                    d2 = r3[r3.length - 1 - h2], l2[l2.length - 1 - h2] !== d2 && (Object.prototype.hasOwnProperty.call(s3, d2) ? (i4.push({ command: W.removeLayer, args: [d2] }), l2.splice(l2.lastIndexOf(d2, l2.length - u2), 1)) : u2++, p3 = l2[l2.length - h2], i4.push({ command: W.addLayer, args: [n2[d2], p3] }), l2.splice(l2.length - h2, 0, d2), c3[d2] = true);
                  for (h2 = 0; h2 < r3.length; h2++)
                    if (d2 = r3[h2], m2 = s3[d2], _2 = n2[d2], !c3[d2] && !a(m2, _2))
                      if (a(m2.source, _2.source) && a(m2["source-layer"], _2["source-layer"]) && a(m2.type, _2.type)) {
                        for (f2 in Q(m2.layout, _2.layout, i4, d2, null, W.setLayoutProperty), Q(m2.paint, _2.paint, i4, d2, null, W.setPaintProperty), a(m2.filter, _2.filter) || i4.push({ command: W.setFilter, args: [d2, _2.filter] }), a(m2.minzoom, _2.minzoom) && a(m2.maxzoom, _2.maxzoom) || i4.push({ command: W.setLayerZoomRange, args: [d2, _2.minzoom, _2.maxzoom] }), m2)
                          Object.prototype.hasOwnProperty.call(m2, f2) && "layout" !== f2 && "paint" !== f2 && "filter" !== f2 && "metadata" !== f2 && "minzoom" !== f2 && "maxzoom" !== f2 && (0 === f2.indexOf("paint.") ? Q(m2[f2], _2[f2], i4, d2, f2.slice(6), W.setPaintProperty) : a(m2[f2], _2[f2]) || i4.push({ command: W.setLayerProperty, args: [d2, f2, _2[f2]] }));
                        for (f2 in _2)
                          Object.prototype.hasOwnProperty.call(_2, f2) && !Object.prototype.hasOwnProperty.call(m2, f2) && "layout" !== f2 && "paint" !== f2 && "filter" !== f2 && "metadata" !== f2 && "minzoom" !== f2 && "maxzoom" !== f2 && (0 === f2.indexOf("paint.") ? Q(m2[f2], _2[f2], i4, d2, f2.slice(6), W.setPaintProperty) : a(m2[f2], _2[f2]) || i4.push({ command: W.setLayerProperty, args: [d2, f2, _2[f2]] }));
                      } else
                        i4.push({ command: W.removeLayer, args: [d2] }), p3 = l2[l2.lastIndexOf(d2) + 1], i4.push({ command: W.addLayer, args: [_2, p3] });
                }(s2, e3.layers, i3);
              } catch (t3) {
                console.warn("Unable to compute style diff:", t3), i3 = [{ command: W.setStyle, args: [e3] }];
              }
              return i3;
            }(this.serialize(), e2).filter((t2) => !(t2.command in Qt));
            if (0 === i2.length)
              return false;
            const o2 = i2.filter((t2) => !(t2.command in Jt));
            if (o2.length > 0)
              throw new Error(`Unimplemented: ${o2.map((t2) => t2.command).join(", ")}.`);
            return i2.forEach((t2) => {
              "setTransition" !== t2.command && this[t2.command].apply(this, t2.args);
            }), this.stylesheet = e2, true;
          }
          addImage(e2, i2) {
            if (this.getImage(e2))
              return this.fire(new t.ErrorEvent(new Error(`An image named "${e2}" already exists.`)));
            this.imageManager.addImage(e2, i2), this._afterImageUpdated(e2);
          }
          updateImage(t2, e2) {
            this.imageManager.updateImage(t2, e2);
          }
          getImage(t2) {
            return this.imageManager.getImage(t2);
          }
          removeImage(e2) {
            if (!this.getImage(e2))
              return this.fire(new t.ErrorEvent(new Error(`An image named "${e2}" does not exist.`)));
            this.imageManager.removeImage(e2), this._afterImageUpdated(e2);
          }
          _afterImageUpdated(e2) {
            this._availableImages = this.imageManager.listImages(), this._changedImages[e2] = true, this._changed = true, this.dispatcher.broadcast("setImages", this._availableImages), this.fire(new t.Event("data", { dataType: "style" }));
          }
          listImages() {
            return this._checkLoaded(), this.imageManager.listImages();
          }
          addSource(e2, i2, o2 = {}) {
            if (this._checkLoaded(), void 0 !== this.sourceCaches[e2])
              throw new Error(`Source "${e2}" already exists.`);
            if (!i2.type)
              throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i2).join(", ")}.`);
            if (["vector", "raster", "geojson", "video", "image"].indexOf(i2.type) >= 0 && this._validate(t.validateStyle.source, `sources.${e2}`, i2, null, o2))
              return;
            this.map && this.map._collectResourceTiming && (i2.collectResourceTiming = true);
            const a2 = this.sourceCaches[e2] = new O2(e2, i2, this.dispatcher);
            a2.style = this, a2.setEventedParent(this, () => ({ isSourceLoaded: this.loaded(), source: a2.serialize(), sourceId: e2 })), a2.onAdd(this.map), this._changed = true;
          }
          removeSource(e2) {
            if (this._checkLoaded(), void 0 === this.sourceCaches[e2])
              throw new Error("There is no source with this ID");
            for (const i3 in this._layers)
              if (this._layers[i3].source === e2)
                return this.fire(new t.ErrorEvent(new Error(`Source "${e2}" cannot be removed while layer "${i3}" is using it.`)));
            const i2 = this.sourceCaches[e2];
            delete this.sourceCaches[e2], delete this._updatedSources[e2], i2.fire(new t.Event("data", { sourceDataType: "metadata", dataType: "source", sourceId: e2 })), i2.setEventedParent(null), i2.onRemove(this.map), this._changed = true;
          }
          setGeoJSONSourceData(t2, e2) {
            if (this._checkLoaded(), void 0 === this.sourceCaches[t2])
              throw new Error(`There is no source with this ID=${t2}`);
            const i2 = this.sourceCaches[t2].getSource();
            if ("geojson" !== i2.type)
              throw new Error(`geojsonSource.type is ${i2.type}, which is !== 'geojson`);
            i2.setData(e2), this._changed = true;
          }
          getSource(t2) {
            return this.sourceCaches[t2] && this.sourceCaches[t2].getSource();
          }
          addLayer(e2, i2, o2 = {}) {
            this._checkLoaded();
            const a2 = e2.id;
            if (this.getLayer(a2))
              return void this.fire(new t.ErrorEvent(new Error(`Layer "${a2}" already exists on this map.`)));
            let r2;
            if ("custom" === e2.type) {
              if (Yt(this, t.validateCustomStyleLayer(e2)))
                return;
              r2 = t.createStyleLayer(e2);
            } else {
              if ("object" == typeof e2.source && (this.addSource(a2, e2.source), e2 = t.clone$1(e2), e2 = t.extend(e2, { source: a2 })), this._validate(t.validateStyle.layer, `layers.${a2}`, e2, { arrayIndex: -1 }, o2))
                return;
              r2 = t.createStyleLayer(e2), this._validateLayer(r2), r2.setEventedParent(this, { layer: { id: a2 } }), this._serializedLayers[r2.id] = r2.serialize();
            }
            const s2 = i2 ? this._order.indexOf(i2) : this._order.length;
            if (i2 && -1 === s2)
              this.fire(new t.ErrorEvent(new Error(`Cannot add layer "${a2}" before non-existing layer "${i2}".`)));
            else {
              if (this._order.splice(s2, 0, a2), this._layerOrderChanged = true, this._layers[a2] = r2, this._removedLayers[a2] && r2.source && "custom" !== r2.type) {
                const t2 = this._removedLayers[a2];
                delete this._removedLayers[a2], t2.type !== r2.type ? this._updatedSources[r2.source] = "clear" : (this._updatedSources[r2.source] = "reload", this.sourceCaches[r2.source].pause());
              }
              this._updateLayer(r2), r2.onAdd && r2.onAdd(this.map);
            }
          }
          moveLayer(e2, i2) {
            if (this._checkLoaded(), this._changed = true, !this._layers[e2])
              return void this.fire(new t.ErrorEvent(new Error(`The layer '${e2}' does not exist in the map's style and cannot be moved.`)));
            if (e2 === i2)
              return;
            const o2 = this._order.indexOf(e2);
            this._order.splice(o2, 1);
            const a2 = i2 ? this._order.indexOf(i2) : this._order.length;
            i2 && -1 === a2 ? this.fire(new t.ErrorEvent(new Error(`Cannot move layer "${e2}" before non-existing layer "${i2}".`))) : (this._order.splice(a2, 0, e2), this._layerOrderChanged = true);
          }
          removeLayer(e2) {
            this._checkLoaded();
            const i2 = this._layers[e2];
            if (!i2)
              return void this.fire(new t.ErrorEvent(new Error(`Cannot remove non-existing layer "${e2}".`)));
            i2.setEventedParent(null);
            const o2 = this._order.indexOf(e2);
            this._order.splice(o2, 1), this._layerOrderChanged = true, this._changed = true, this._removedLayers[e2] = i2, delete this._layers[e2], delete this._serializedLayers[e2], delete this._updatedLayers[e2], delete this._updatedPaintProps[e2], i2.onRemove && i2.onRemove(this.map);
          }
          getLayer(t2) {
            return this._layers[t2];
          }
          hasLayer(t2) {
            return t2 in this._layers;
          }
          setLayerZoomRange(e2, i2, o2) {
            this._checkLoaded();
            const a2 = this.getLayer(e2);
            a2 ? a2.minzoom === i2 && a2.maxzoom === o2 || (null != i2 && (a2.minzoom = i2), null != o2 && (a2.maxzoom = o2), this._updateLayer(a2)) : this.fire(new t.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${e2}".`)));
          }
          setFilter(e2, i2, o2 = {}) {
            this._checkLoaded();
            const r2 = this.getLayer(e2);
            if (r2) {
              if (!a(r2.filter, i2))
                return null == i2 ? (r2.filter = void 0, void this._updateLayer(r2)) : void (this._validate(t.validateStyle.filter, `layers.${r2.id}.filter`, i2, null, o2) || (r2.filter = t.clone$1(i2), this._updateLayer(r2)));
            } else
              this.fire(new t.ErrorEvent(new Error(`Cannot filter non-existing layer "${e2}".`)));
          }
          getFilter(e2) {
            return t.clone$1(this.getLayer(e2).filter);
          }
          setLayoutProperty(e2, i2, o2, r2 = {}) {
            this._checkLoaded();
            const s2 = this.getLayer(e2);
            s2 ? a(s2.getLayoutProperty(i2), o2) || (s2.setLayoutProperty(i2, o2, r2), this._updateLayer(s2)) : this.fire(new t.ErrorEvent(new Error(`Cannot style non-existing layer "${e2}".`)));
          }
          getLayoutProperty(e2, i2) {
            const o2 = this.getLayer(e2);
            if (o2)
              return o2.getLayoutProperty(i2);
            this.fire(new t.ErrorEvent(new Error(`Cannot get style of non-existing layer "${e2}".`)));
          }
          setPaintProperty(e2, i2, o2, r2 = {}) {
            this._checkLoaded();
            const s2 = this.getLayer(e2);
            s2 ? a(s2.getPaintProperty(i2), o2) || (s2.setPaintProperty(i2, o2, r2) && this._updateLayer(s2), this._changed = true, this._updatedPaintProps[e2] = true) : this.fire(new t.ErrorEvent(new Error(`Cannot style non-existing layer "${e2}".`)));
          }
          getPaintProperty(t2, e2) {
            return this.getLayer(t2).getPaintProperty(e2);
          }
          setFeatureState(e2, i2) {
            this._checkLoaded();
            const o2 = e2.source, a2 = e2.sourceLayer, r2 = this.sourceCaches[o2];
            if (void 0 === r2)
              return void this.fire(new t.ErrorEvent(new Error(`The source '${o2}' does not exist in the map's style.`)));
            const s2 = r2.getSource().type;
            "geojson" === s2 && a2 ? this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))) : "vector" !== s2 || a2 ? (void 0 === e2.id && this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))), r2.setFeatureState(a2, e2.id, i2)) : this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));
          }
          removeFeatureState(e2, i2) {
            this._checkLoaded();
            const o2 = e2.source, a2 = this.sourceCaches[o2];
            if (void 0 === a2)
              return void this.fire(new t.ErrorEvent(new Error(`The source '${o2}' does not exist in the map's style.`)));
            const r2 = a2.getSource().type, s2 = "vector" === r2 ? e2.sourceLayer : void 0;
            "vector" !== r2 || s2 ? i2 && "string" != typeof e2.id && "number" != typeof e2.id ? this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property."))) : a2.removeFeatureState(s2, e2.id, i2) : this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));
          }
          getFeatureState(e2) {
            this._checkLoaded();
            const i2 = e2.source, o2 = e2.sourceLayer, a2 = this.sourceCaches[i2];
            if (void 0 !== a2)
              return "vector" !== a2.getSource().type || o2 ? (void 0 === e2.id && this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))), a2.getFeatureState(o2, e2.id)) : void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));
            this.fire(new t.ErrorEvent(new Error(`The source '${i2}' does not exist in the map's style.`)));
          }
          getTransition() {
            return t.extend({ duration: 300, delay: 0 }, this.stylesheet && this.stylesheet.transition);
          }
          serialize() {
            return t.filterObject({ version: this.stylesheet.version, name: this.stylesheet.name, metadata: this.stylesheet.metadata, light: this.stylesheet.light, center: this.stylesheet.center, zoom: this.stylesheet.zoom, bearing: this.stylesheet.bearing, pitch: this.stylesheet.pitch, sprite: this.stylesheet.sprite, glyphs: this.stylesheet.glyphs, transition: this.stylesheet.transition, sources: t.mapObject(this.sourceCaches, (t2) => t2.serialize()), layers: this._serializeLayers(this._order) }, (t2) => void 0 !== t2);
          }
          _updateLayer(t2) {
            this._updatedLayers[t2.id] = true, t2.source && !this._updatedSources[t2.source] && "raster" !== this.sourceCaches[t2.source].getSource().type && (this._updatedSources[t2.source] = "reload", this.sourceCaches[t2.source].pause()), this._changed = true;
          }
          _flattenAndSortRenderedFeatures(t2) {
            const e2 = (t3) => "fill-extrusion" === this._layers[t3].type, i2 = {}, o2 = [];
            for (let a3 = this._order.length - 1; a3 >= 0; a3--) {
              const r2 = this._order[a3];
              if (e2(r2)) {
                i2[r2] = a3;
                for (const e3 of t2) {
                  const t3 = e3[r2];
                  if (t3)
                    for (const e4 of t3)
                      o2.push(e4);
                }
              }
            }
            o2.sort((t3, e3) => e3.intersectionZ - t3.intersectionZ);
            const a2 = [];
            for (let r2 = this._order.length - 1; r2 >= 0; r2--) {
              const s2 = this._order[r2];
              if (e2(s2))
                for (let t3 = o2.length - 1; t3 >= 0; t3--) {
                  const e3 = o2[t3].feature;
                  if (i2[e3.layer.id] < r2)
                    break;
                  a2.push(e3), o2.pop();
                }
              else
                for (const e3 of t2) {
                  const t3 = e3[s2];
                  if (t3)
                    for (const e4 of t3)
                      a2.push(e4.feature);
                }
            }
            return a2;
          }
          queryRenderedFeatures(e2, i2, o2) {
            i2 && i2.filter && this._validate(t.validateStyle.filter, "queryRenderedFeatures.filter", i2.filter, null, i2);
            const a2 = {};
            if (i2 && i2.layers) {
              if (!Array.isArray(i2.layers))
                return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))), [];
              for (const e3 of i2.layers) {
                const i3 = this._layers[e3];
                if (!i3)
                  return this.fire(new t.ErrorEvent(new Error(`The layer '${e3}' does not exist in the map's style and cannot be queried for features.`))), [];
                a2[i3.source] = true;
              }
            }
            const r2 = [];
            i2.availableImages = this._availableImages;
            for (const t2 in this.sourceCaches)
              i2.layers && !a2[t2] || r2.push(L(this.sourceCaches[t2], this._layers, this._serializedLayers, e2, i2, o2));
            return this.placement && r2.push(function(t2, e3, i3, o3, a3, r3, s2) {
              const n2 = {}, l2 = r3.queryRenderedSymbols(o3), c3 = [];
              for (const t3 of Object.keys(l2).map(Number))
                c3.push(s2[t3]);
              c3.sort(R);
              for (const i4 of c3) {
                const o4 = i4.featureIndex.lookupSymbolFeatures(l2[i4.bucketInstanceId], e3, i4.bucketIndex, i4.sourceLayerIndex, a3.filter, a3.layers, a3.availableImages, t2);
                for (const t3 in o4) {
                  const e4 = n2[t3] = n2[t3] || [], a4 = o4[t3];
                  a4.sort((t4, e5) => {
                    const o5 = i4.featureSortOrder;
                    if (o5) {
                      const i5 = o5.indexOf(t4.featureIndex);
                      return o5.indexOf(e5.featureIndex) - i5;
                    }
                    return e5.featureIndex - t4.featureIndex;
                  });
                  for (const t4 of a4)
                    e4.push(t4);
                }
              }
              for (const e4 in n2)
                n2[e4].forEach((o4) => {
                  const a4 = o4.feature, r4 = i3[t2[e4].source].getFeatureState(a4.layer["source-layer"], a4.id);
                  a4.source = a4.layer.source, a4.layer["source-layer"] && (a4.sourceLayer = a4.layer["source-layer"]), a4.state = r4;
                });
              return n2;
            }(this._layers, this._serializedLayers, this.sourceCaches, e2, i2, this.placement.collisionIndex, this.placement.retainedQueryData)), this._flattenAndSortRenderedFeatures(r2);
          }
          querySourceFeatures(e2, i2) {
            i2 && i2.filter && this._validate(t.validateStyle.filter, "querySourceFeatures.filter", i2.filter, null, i2);
            const o2 = this.sourceCaches[e2];
            return o2 ? function(t2, e3) {
              const i3 = t2.getRenderableIds().map((e4) => t2.getTileByID(e4)), o3 = [], a2 = {};
              for (let t3 = 0; t3 < i3.length; t3++) {
                const r2 = i3[t3], s2 = r2.tileID.canonical.key;
                a2[s2] || (a2[s2] = true, r2.querySourceFeatures(o3, e3));
              }
              return o3;
            }(o2, i2) : [];
          }
          addSourceType(t2, e2, i2) {
            return ee.getSourceType(t2) ? i2(new Error(`A source type called "${t2}" already exists.`)) : (ee.setSourceType(t2, e2), e2.workerSourceURL ? void this.dispatcher.broadcast("loadWorkerSource", { name: t2, url: e2.workerSourceURL }, i2) : i2(null, null));
          }
          getLight() {
            return this.light.getLight();
          }
          setLight(e2, i2 = {}) {
            this._checkLoaded();
            const o2 = this.light.getLight();
            let r2 = false;
            for (const t2 in e2)
              if (!a(e2[t2], o2[t2])) {
                r2 = true;
                break;
              }
            if (!r2)
              return;
            const s2 = { now: t.exported.now(), transition: t.extend({ duration: 300, delay: 0 }, this.stylesheet.transition) };
            this.light.setLight(e2, i2), this.light.updateTransitions(s2);
          }
          _validate(e2, i2, o2, a2, r2 = {}) {
            return (!r2 || false !== r2.validate) && Yt(this, e2.call(t.validateStyle, t.extend({ key: i2, style: this.serialize(), value: o2, styleSpec: t.spec }, a2)));
          }
          _remove() {
            this._request && (this._request.cancel(), this._request = null), this._spriteRequest && (this._spriteRequest.cancel(), this._spriteRequest = null), t.evented.off("pluginStateChange", this._rtlTextPluginCallback);
            for (const t2 in this._layers)
              this._layers[t2].setEventedParent(null);
            for (const t2 in this.sourceCaches) {
              const e2 = this.sourceCaches[t2];
              e2.setEventedParent(null), e2.onRemove(this.map);
            }
            this.imageManager.setEventedParent(null), this.setEventedParent(null), this.dispatcher.remove();
          }
          _clearSource(t2) {
            this.sourceCaches[t2].clearTiles();
          }
          _reloadSource(t2) {
            this.sourceCaches[t2].resume(), this.sourceCaches[t2].reload();
          }
          _updateSources(t2) {
            for (const e2 in this.sourceCaches)
              this.sourceCaches[e2].update(t2, this.terrain);
          }
          _generateCollisionBoxes() {
            for (const t2 in this.sourceCaches)
              this._reloadSource(t2);
          }
          _updatePlacement(e2, i2, o2, a2, r2 = false) {
            let s2 = false, n2 = false;
            const l2 = {};
            for (const t2 of this._order) {
              const i3 = this._layers[t2];
              if ("symbol" !== i3.type)
                continue;
              if (!l2[i3.source]) {
                const t3 = this.sourceCaches[i3.source];
                l2[i3.source] = t3.getRenderableIds(true).map((e3) => t3.getTileByID(e3)).sort((t4, e3) => e3.tileID.overscaledZ - t4.tileID.overscaledZ || (t4.tileID.isLessThan(e3.tileID) ? -1 : 1));
              }
              const o3 = this.crossTileSymbolIndex.addLayer(i3, l2[i3.source], e2.center.lng);
              s2 = s2 || o3;
            }
            if (this.crossTileSymbolIndex.pruneUnusedLayers(this._order), ((r2 = r2 || this._layerOrderChanged || 0 === o2) || !this.pauseablePlacement || this.pauseablePlacement.isDone() && !this.placement.stillRecent(t.exported.now(), e2.zoom)) && (this.pauseablePlacement = new Zt(e2, this.terrain, this._order, r2, i2, o2, a2, this.placement), this._layerOrderChanged = false), this.pauseablePlacement.isDone() ? this.placement.setStale() : (this.pauseablePlacement.continuePlacement(this._order, this._layers, l2), this.pauseablePlacement.isDone() && (this.placement = this.pauseablePlacement.commit(t.exported.now()), n2 = true), s2 && this.pauseablePlacement.placement.setStale()), n2 || s2)
              for (const t2 of this._order) {
                const e3 = this._layers[t2];
                "symbol" === e3.type && this.placement.updateLayerOpacities(e3, l2[e3.source]);
              }
            return !this.pauseablePlacement.isDone() || this.placement.hasTransitions(t.exported.now());
          }
          _releaseSymbolFadeTiles() {
            for (const t2 in this.sourceCaches)
              this.sourceCaches[t2].releaseSymbolFadeTiles();
          }
          getImages(t2, e2, i2) {
            this.imageManager.getImages(e2.icons, i2), this._updateTilesForChangedImages();
            const o2 = this.sourceCaches[e2.source];
            o2 && o2.setDependencies(e2.tileID.key, e2.type, e2.icons);
          }
          getGlyphs(t2, e2, i2) {
            this.glyphManager.getGlyphs(e2.stacks, i2);
          }
          getResource(e2, i2, o2) {
            return t.makeRequest(i2, o2);
          }
        }
        ee.getSourceType = function(t2) {
          return M[t2];
        }, ee.setSourceType = function(t2, e2) {
          M[t2] = e2;
        }, ee.registerForPluginStateChange = t.registerForPluginStateChange;
        var ie = "attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";
        const oe = { prelude: ae("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif", "#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"), background: ae("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"), backgroundPattern: ae("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"), circle: ae("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"), clippingMask: ae("void main() {gl_FragColor=vec4(1.0);}", "attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"), heatmap: ae("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"), heatmapTexture: ae("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"), collisionBox: ae("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}", "attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"), collisionCircle: ae("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}", "attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"), debug: ae("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}", "attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"), fill: ae("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"), fillOutline: ae("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"), fillOutlinePattern: ae("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"), fillPattern: ae("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"), fillExtrusion: ae("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat baseDelta=10.0;float ele=get_elevation(a_centroid);\n#else\nfloat baseDelta=0.0;float ele=0.0;\n#endif\nbase=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"), fillExtrusionPattern: ae("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat baseDelta=10.0;float ele=get_elevation(a_centroid);\n#else\nfloat baseDelta=0.0;float ele=0.0;\n#endif\nbase=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"), hillshadePrepare: ae("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"), hillshade: ae("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"), line: ae("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"), lineGradient: ae("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"), linePattern: ae("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"), lineSDF: ae("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"), raster: ae("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"), symbolIcon: ae("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"), symbolSDF: ae("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"), symbolTextAndIcon: ae("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"), terrain: ae("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}", ie), terrainDepth: ae("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}", ie), terrainCoords: ae("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}", ie) };
        function ae(t2, e2) {
          const i2 = /#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g, o2 = e2.match(/attribute ([\w]+) ([\w]+)/g), a2 = t2.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g), r2 = e2.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g), s2 = r2 ? r2.concat(a2) : a2, n2 = {};
          return { fragmentSource: t2 = t2.replace(i2, (t3, e3, i3, o3, a3) => (n2[a3] = true, "define" === e3 ? `
#ifndef HAS_UNIFORM_u_${a3}
varying ${i3} ${o3} ${a3};
#else
uniform ${i3} ${o3} u_${a3};
#endif
` : `
#ifdef HAS_UNIFORM_u_${a3}
    ${i3} ${o3} ${a3} = u_${a3};
#endif
`)), vertexSource: e2 = e2.replace(i2, (t3, e3, i3, o3, a3) => {
            const r3 = "float" === o3 ? "vec2" : "vec4", s3 = a3.match(/color/) ? "color" : r3;
            return n2[a3] ? "define" === e3 ? `
#ifndef HAS_UNIFORM_u_${a3}
uniform lowp float u_${a3}_t;
attribute ${i3} ${r3} a_${a3};
varying ${i3} ${o3} ${a3};
#else
uniform ${i3} ${o3} u_${a3};
#endif
` : "vec4" === s3 ? `
#ifndef HAS_UNIFORM_u_${a3}
    ${a3} = a_${a3};
#else
    ${i3} ${o3} ${a3} = u_${a3};
#endif
` : `
#ifndef HAS_UNIFORM_u_${a3}
    ${a3} = unpack_mix_${s3}(a_${a3}, u_${a3}_t);
#else
    ${i3} ${o3} ${a3} = u_${a3};
#endif
` : "define" === e3 ? `
#ifndef HAS_UNIFORM_u_${a3}
uniform lowp float u_${a3}_t;
attribute ${i3} ${r3} a_${a3};
#else
uniform ${i3} ${o3} u_${a3};
#endif
` : "vec4" === s3 ? `
#ifndef HAS_UNIFORM_u_${a3}
    ${i3} ${o3} ${a3} = a_${a3};
#else
    ${i3} ${o3} ${a3} = u_${a3};
#endif
` : `
#ifndef HAS_UNIFORM_u_${a3}
    ${i3} ${o3} ${a3} = unpack_mix_${s3}(a_${a3}, u_${a3}_t);
#else
    ${i3} ${o3} ${a3} = u_${a3};
#endif
`;
          }), staticAttributes: o2, staticUniforms: s2 };
        }
        class re {
          constructor() {
            this.boundProgram = null, this.boundLayoutVertexBuffer = null, this.boundPaintVertexBuffers = [], this.boundIndexBuffer = null, this.boundVertexOffset = null, this.boundDynamicVertexBuffer = null, this.vao = null;
          }
          bind(t2, e2, i2, o2, a2, r2, s2, n2, l2) {
            this.context = t2;
            let c3 = this.boundPaintVertexBuffers.length !== o2.length;
            for (let t3 = 0; !c3 && t3 < o2.length; t3++)
              this.boundPaintVertexBuffers[t3] !== o2[t3] && (c3 = true);
            t2.extVertexArrayObject && this.vao && this.boundProgram === e2 && this.boundLayoutVertexBuffer === i2 && !c3 && this.boundIndexBuffer === a2 && this.boundVertexOffset === r2 && this.boundDynamicVertexBuffer === s2 && this.boundDynamicVertexBuffer2 === n2 && this.boundDynamicVertexBuffer3 === l2 ? (t2.bindVertexArrayOES.set(this.vao), s2 && s2.bind(), a2 && a2.dynamicDraw && a2.bind(), n2 && n2.bind(), l2 && l2.bind()) : this.freshBind(e2, i2, o2, a2, r2, s2, n2, l2);
          }
          freshBind(t2, e2, i2, o2, a2, r2, s2, n2) {
            let l2;
            const c3 = t2.numAttributes, h2 = this.context, u2 = h2.gl;
            if (h2.extVertexArrayObject)
              this.vao && this.destroy(), this.vao = h2.extVertexArrayObject.createVertexArrayOES(), h2.bindVertexArrayOES.set(this.vao), l2 = 0, this.boundProgram = t2, this.boundLayoutVertexBuffer = e2, this.boundPaintVertexBuffers = i2, this.boundIndexBuffer = o2, this.boundVertexOffset = a2, this.boundDynamicVertexBuffer = r2, this.boundDynamicVertexBuffer2 = s2, this.boundDynamicVertexBuffer3 = n2;
            else {
              l2 = h2.currentNumAttributes || 0;
              for (let t3 = c3; t3 < l2; t3++)
                u2.disableVertexAttribArray(t3);
            }
            e2.enableAttributes(u2, t2);
            for (const e3 of i2)
              e3.enableAttributes(u2, t2);
            r2 && r2.enableAttributes(u2, t2), s2 && s2.enableAttributes(u2, t2), n2 && n2.enableAttributes(u2, t2), e2.bind(), e2.setVertexAttribPointers(u2, t2, a2);
            for (const e3 of i2)
              e3.bind(), e3.setVertexAttribPointers(u2, t2, a2);
            r2 && (r2.bind(), r2.setVertexAttribPointers(u2, t2, a2)), o2 && o2.bind(), s2 && (s2.bind(), s2.setVertexAttribPointers(u2, t2, a2)), n2 && (n2.bind(), n2.setVertexAttribPointers(u2, t2, a2)), h2.currentNumAttributes = c3;
          }
          destroy() {
            this.vao && (this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao), this.vao = null);
          }
        }
        function se(t2) {
          const e2 = [];
          for (let i2 = 0; i2 < t2.length; i2++) {
            if (null === t2[i2])
              continue;
            const o2 = t2[i2].split(" ");
            e2.push(o2.pop());
          }
          return e2;
        }
        class ne {
          constructor(e2, i2, o2, a2, r2, s2, n2) {
            const l2 = e2.gl;
            this.program = l2.createProgram();
            const c3 = se(o2.staticAttributes), h2 = a2 ? a2.getBinderAttributes() : [], u2 = c3.concat(h2), d2 = oe.prelude.staticUniforms ? se(oe.prelude.staticUniforms) : [], m2 = o2.staticUniforms ? se(o2.staticUniforms) : [], _2 = a2 ? a2.getBinderUniforms() : [], p3 = d2.concat(m2).concat(_2), f2 = [];
            for (const t2 of p3)
              f2.indexOf(t2) < 0 && f2.push(t2);
            const g2 = a2 ? a2.defines() : [];
            s2 && g2.push("#define OVERDRAW_INSPECTOR;"), n2 && g2.push("#define TERRAIN3D;");
            const x2 = g2.concat(oe.prelude.fragmentSource, o2.fragmentSource).join("\n"), v3 = g2.concat(oe.prelude.vertexSource, o2.vertexSource).join("\n"), y3 = l2.createShader(l2.FRAGMENT_SHADER);
            if (l2.isContextLost())
              return void (this.failedToCreate = true);
            l2.shaderSource(y3, x2), l2.compileShader(y3), l2.attachShader(this.program, y3);
            const b2 = l2.createShader(l2.VERTEX_SHADER);
            if (l2.isContextLost())
              return void (this.failedToCreate = true);
            l2.shaderSource(b2, v3), l2.compileShader(b2), l2.attachShader(this.program, b2), this.attributes = {};
            const w2 = {};
            this.numAttributes = u2.length;
            for (let t2 = 0; t2 < this.numAttributes; t2++)
              u2[t2] && (l2.bindAttribLocation(this.program, t2, u2[t2]), this.attributes[u2[t2]] = t2);
            l2.linkProgram(this.program), l2.deleteShader(b2), l2.deleteShader(y3);
            for (let t2 = 0; t2 < f2.length; t2++) {
              const e3 = f2[t2];
              if (e3 && !w2[e3]) {
                const t3 = l2.getUniformLocation(this.program, e3);
                t3 && (w2[e3] = t3);
              }
            }
            this.fixedUniforms = r2(e2, w2), this.terrainUniforms = ((e3, i3) => ({ u_depth: new t.Uniform1i(e3, i3.u_depth), u_terrain: new t.Uniform1i(e3, i3.u_terrain), u_terrain_dim: new t.Uniform1f(e3, i3.u_terrain_dim), u_terrain_matrix: new t.UniformMatrix4f(e3, i3.u_terrain_matrix), u_terrain_unpack: new t.Uniform4f(e3, i3.u_terrain_unpack), u_terrain_offset: new t.Uniform1f(e3, i3.u_terrain_offset), u_terrain_exaggeration: new t.Uniform1f(e3, i3.u_terrain_exaggeration) }))(e2, w2), this.binderUniforms = a2 ? a2.getUniforms(e2, w2) : [];
          }
          draw(t2, e2, i2, o2, a2, r2, s2, n2, l2, c3, h2, u2, d2, m2, _2, p3, f2, g2) {
            const x2 = t2.gl;
            if (this.failedToCreate)
              return;
            if (t2.program.set(this.program), t2.setDepthMode(i2), t2.setStencilMode(o2), t2.setColorMode(a2), t2.setCullFace(r2), n2) {
              t2.activeTexture.set(x2.TEXTURE2), x2.bindTexture(x2.TEXTURE_2D, n2.depthTexture), t2.activeTexture.set(x2.TEXTURE3), x2.bindTexture(x2.TEXTURE_2D, n2.texture);
              for (const t3 in this.terrainUniforms)
                this.terrainUniforms[t3].set(n2[t3]);
            }
            for (const t3 in this.fixedUniforms)
              this.fixedUniforms[t3].set(s2[t3]);
            _2 && _2.setUniforms(t2, this.binderUniforms, d2, { zoom: m2 });
            let v3 = 0;
            switch (e2) {
              case x2.LINES:
                v3 = 2;
                break;
              case x2.TRIANGLES:
                v3 = 3;
                break;
              case x2.LINE_STRIP:
                v3 = 1;
            }
            for (const i3 of u2.get()) {
              const o3 = i3.vaos || (i3.vaos = {});
              (o3[l2] || (o3[l2] = new re())).bind(t2, this, c3, _2 ? _2.getPaintVertexBuffers() : [], h2, i3.vertexOffset, p3, f2, g2), x2.drawElements(e2, i3.primitiveLength * v3, x2.UNSIGNED_SHORT, i3.primitiveOffset * v3 * 2);
            }
          }
        }
        function le(t2, e2, i2) {
          const o2 = 1 / bt(i2, 1, e2.transform.tileZoom), a2 = Math.pow(2, i2.tileID.overscaledZ), r2 = i2.tileSize * Math.pow(2, e2.transform.tileZoom) / a2, s2 = r2 * (i2.tileID.canonical.x + i2.tileID.wrap * a2), n2 = r2 * i2.tileID.canonical.y;
          return { u_image: 0, u_texsize: i2.imageAtlasTexture.size, u_scale: [o2, t2.fromScale, t2.toScale], u_fade: t2.t, u_pixel_coord_upper: [s2 >> 16, n2 >> 16], u_pixel_coord_lower: [65535 & s2, 65535 & n2] };
        }
        const ce = (e2, i2, o2, a2) => {
          const r2 = i2.style.light, s2 = r2.properties.get("position"), n2 = [s2.x, s2.y, s2.z], l2 = t.create$1();
          "viewport" === r2.properties.get("anchor") && t.fromRotation(l2, -i2.transform.angle), t.transformMat3(n2, n2, l2);
          const c3 = r2.properties.get("color");
          return { u_matrix: e2, u_lightpos: n2, u_lightintensity: r2.properties.get("intensity"), u_lightcolor: [c3.r, c3.g, c3.b], u_vertical_gradient: +o2, u_opacity: a2 };
        }, he = (e2, i2, o2, a2, r2, s2, n2) => t.extend(ce(e2, i2, o2, a2), le(s2, i2, n2), { u_height_factor: -Math.pow(2, r2.overscaledZ) / n2.tileSize / 8 }), ue = (t2) => ({ u_matrix: t2 }), de = (e2, i2, o2, a2) => t.extend(ue(e2), le(o2, i2, a2)), me = (t2, e2) => ({ u_matrix: t2, u_world: e2 }), _e = (e2, i2, o2, a2, r2) => t.extend(de(e2, i2, o2, a2), { u_world: r2 }), pe = (t2, e2, i2, o2) => {
          const a2 = t2.transform;
          let r2, s2;
          if ("map" === o2.paint.get("circle-pitch-alignment")) {
            const t3 = bt(i2, 1, a2.zoom);
            r2 = true, s2 = [t3, t3];
          } else
            r2 = false, s2 = a2.pixelsToGLUnits;
          return { u_camera_to_center_distance: a2.cameraToCenterDistance, u_scale_with_map: +("map" === o2.paint.get("circle-pitch-scale")), u_matrix: t2.translatePosMatrix(e2.posMatrix, i2, o2.paint.get("circle-translate"), o2.paint.get("circle-translate-anchor")), u_pitch_with_map: +r2, u_device_pixel_ratio: t2.pixelRatio, u_extrude_scale: s2 };
        }, fe = (t2, e2, i2) => {
          const o2 = bt(i2, 1, e2.zoom), a2 = Math.pow(2, e2.zoom - i2.tileID.overscaledZ), r2 = i2.tileID.overscaleFactor();
          return { u_matrix: t2, u_camera_to_center_distance: e2.cameraToCenterDistance, u_pixels_to_tile_units: o2, u_extrude_scale: [e2.pixelsToGLUnits[0] / (o2 * a2), e2.pixelsToGLUnits[1] / (o2 * a2)], u_overscale_factor: r2 };
        }, ge = (t2, e2, i2 = 1) => ({ u_matrix: t2, u_color: e2, u_overlay: 0, u_overlay_scale: i2 }), xe = (t2) => ({ u_matrix: t2 }), ve = (t2, e2, i2, o2) => ({ u_matrix: t2, u_extrude_scale: bt(e2, 1, i2), u_intensity: o2 });
        function ye(e2, i2) {
          const o2 = Math.pow(2, i2.canonical.z), a2 = i2.canonical.y;
          return [new t.MercatorCoordinate(0, a2 / o2).toLngLat().lat, new t.MercatorCoordinate(0, (a2 + 1) / o2).toLngLat().lat];
        }
        const be = (t2, e2, i2, o2) => {
          const a2 = t2.transform;
          return { u_matrix: Ce(t2, e2, i2, o2), u_ratio: 1 / bt(e2, 1, a2.zoom), u_device_pixel_ratio: t2.pixelRatio, u_units_to_pixels: [1 / a2.pixelsToGLUnits[0], 1 / a2.pixelsToGLUnits[1]] };
        }, we = (e2, i2, o2, a2, r2) => t.extend(be(e2, i2, o2, r2), { u_image: 0, u_image_height: a2 }), Te = (t2, e2, i2, o2, a2) => {
          const r2 = t2.transform, s2 = Ie(e2, r2);
          return { u_matrix: Ce(t2, e2, i2, a2), u_texsize: e2.imageAtlasTexture.size, u_ratio: 1 / bt(e2, 1, r2.zoom), u_device_pixel_ratio: t2.pixelRatio, u_image: 0, u_scale: [s2, o2.fromScale, o2.toScale], u_fade: o2.t, u_units_to_pixels: [1 / r2.pixelsToGLUnits[0], 1 / r2.pixelsToGLUnits[1]] };
        }, Ee = (e2, i2, o2, a2, r2, s2) => {
          const n2 = e2.lineAtlas, l2 = Ie(i2, e2.transform), c3 = "round" === o2.layout.get("line-cap"), h2 = n2.getDash(a2.from, c3), u2 = n2.getDash(a2.to, c3), d2 = h2.width * r2.fromScale, m2 = u2.width * r2.toScale;
          return t.extend(be(e2, i2, o2, s2), { u_patternscale_a: [l2 / d2, -h2.height / 2], u_patternscale_b: [l2 / m2, -u2.height / 2], u_sdfgamma: n2.width / (256 * Math.min(d2, m2) * e2.pixelRatio) / 2, u_image: 0, u_tex_y_a: h2.y, u_tex_y_b: u2.y, u_mix: r2.t });
        };
        function Ie(t2, e2) {
          return 1 / bt(t2, 1, e2.tileZoom);
        }
        function Ce(t2, e2, i2, o2) {
          return t2.translatePosMatrix(o2 ? o2.posMatrix : e2.tileID.posMatrix, e2, i2.paint.get("line-translate"), i2.paint.get("line-translate-anchor"));
        }
        const Se = (t2, e2, i2, o2, a2) => {
          return { u_matrix: t2, u_tl_parent: e2, u_scale_parent: i2, u_buffer_scale: 1, u_fade_t: o2.mix, u_opacity: o2.opacity * a2.paint.get("raster-opacity"), u_image0: 0, u_image1: 1, u_brightness_low: a2.paint.get("raster-brightness-min"), u_brightness_high: a2.paint.get("raster-brightness-max"), u_saturation_factor: (s2 = a2.paint.get("raster-saturation"), s2 > 0 ? 1 - 1 / (1.001 - s2) : -s2), u_contrast_factor: (r2 = a2.paint.get("raster-contrast"), r2 > 0 ? 1 / (1 - r2) : 1 + r2), u_spin_weights: De(a2.paint.get("raster-hue-rotate")) };
          var r2, s2;
        };
        function De(t2) {
          t2 *= Math.PI / 180;
          const e2 = Math.sin(t2), i2 = Math.cos(t2);
          return [(2 * i2 + 1) / 3, (-Math.sqrt(3) * e2 - i2 + 1) / 3, (Math.sqrt(3) * e2 - i2 + 1) / 3];
        }
        const ze = (t2, e2, i2, o2, a2, r2, s2, n2, l2, c3) => {
          const h2 = a2.transform;
          return { u_is_size_zoom_constant: +("constant" === t2 || "source" === t2), u_is_size_feature_constant: +("constant" === t2 || "camera" === t2), u_size_t: e2 ? e2.uSizeT : 0, u_size: e2 ? e2.uSize : 0, u_camera_to_center_distance: h2.cameraToCenterDistance, u_pitch: h2.pitch / 360 * 2 * Math.PI, u_rotate_symbol: +i2, u_aspect_ratio: h2.width / h2.height, u_fade_change: a2.options.fadeDuration ? a2.symbolFadeChange : 1, u_matrix: r2, u_label_plane_matrix: s2, u_coord_matrix: n2, u_is_text: +l2, u_pitch_with_map: +o2, u_texsize: c3, u_texture: 0 };
        }, Pe = (e2, i2, o2, a2, r2, s2, n2, l2, c3, h2, u2) => {
          const d2 = r2.transform;
          return t.extend(ze(e2, i2, o2, a2, r2, s2, n2, l2, c3, h2), { u_gamma_scale: a2 ? Math.cos(d2._pitch) * d2.cameraToCenterDistance : 1, u_device_pixel_ratio: r2.pixelRatio, u_is_halo: +u2 });
        }, Me = (e2, i2, o2, a2, r2, s2, n2, l2, c3, h2) => t.extend(Pe(e2, i2, o2, a2, r2, s2, n2, l2, true, c3, true), { u_texsize_icon: h2, u_texture_icon: 1 }), Ae = (t2, e2, i2) => ({ u_matrix: t2, u_opacity: e2, u_color: i2 }), Le = (e2, i2, o2, a2, r2, s2) => t.extend(function(t2, e3, i3, o3) {
          const a3 = i3.imageManager.getPattern(t2.from.toString()), r3 = i3.imageManager.getPattern(t2.to.toString()), { width: s3, height: n2 } = i3.imageManager.getPixelSize(), l2 = Math.pow(2, o3.tileID.overscaledZ), c3 = o3.tileSize * Math.pow(2, i3.transform.tileZoom) / l2, h2 = c3 * (o3.tileID.canonical.x + o3.tileID.wrap * l2), u2 = c3 * o3.tileID.canonical.y;
          return { u_image: 0, u_pattern_tl_a: a3.tl, u_pattern_br_a: a3.br, u_pattern_tl_b: r3.tl, u_pattern_br_b: r3.br, u_texsize: [s3, n2], u_mix: e3.t, u_pattern_size_a: a3.displaySize, u_pattern_size_b: r3.displaySize, u_scale_a: e3.fromScale, u_scale_b: e3.toScale, u_tile_units_to_pixels: 1 / bt(o3, 1, i3.transform.tileZoom), u_pixel_coord_upper: [h2 >> 16, u2 >> 16], u_pixel_coord_lower: [65535 & h2, 65535 & u2] };
        }(a2, s2, o2, r2), { u_matrix: e2, u_opacity: i2 }), Re = { fillExtrusion: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_lightpos: new t.Uniform3f(e2, i2.u_lightpos), u_lightintensity: new t.Uniform1f(e2, i2.u_lightintensity), u_lightcolor: new t.Uniform3f(e2, i2.u_lightcolor), u_vertical_gradient: new t.Uniform1f(e2, i2.u_vertical_gradient), u_opacity: new t.Uniform1f(e2, i2.u_opacity) }), fillExtrusionPattern: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_lightpos: new t.Uniform3f(e2, i2.u_lightpos), u_lightintensity: new t.Uniform1f(e2, i2.u_lightintensity), u_lightcolor: new t.Uniform3f(e2, i2.u_lightcolor), u_vertical_gradient: new t.Uniform1f(e2, i2.u_vertical_gradient), u_height_factor: new t.Uniform1f(e2, i2.u_height_factor), u_image: new t.Uniform1i(e2, i2.u_image), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_pixel_coord_upper: new t.Uniform2f(e2, i2.u_pixel_coord_upper), u_pixel_coord_lower: new t.Uniform2f(e2, i2.u_pixel_coord_lower), u_scale: new t.Uniform3f(e2, i2.u_scale), u_fade: new t.Uniform1f(e2, i2.u_fade), u_opacity: new t.Uniform1f(e2, i2.u_opacity) }), fill: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix) }), fillPattern: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_image: new t.Uniform1i(e2, i2.u_image), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_pixel_coord_upper: new t.Uniform2f(e2, i2.u_pixel_coord_upper), u_pixel_coord_lower: new t.Uniform2f(e2, i2.u_pixel_coord_lower), u_scale: new t.Uniform3f(e2, i2.u_scale), u_fade: new t.Uniform1f(e2, i2.u_fade) }), fillOutline: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_world: new t.Uniform2f(e2, i2.u_world) }), fillOutlinePattern: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_world: new t.Uniform2f(e2, i2.u_world), u_image: new t.Uniform1i(e2, i2.u_image), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_pixel_coord_upper: new t.Uniform2f(e2, i2.u_pixel_coord_upper), u_pixel_coord_lower: new t.Uniform2f(e2, i2.u_pixel_coord_lower), u_scale: new t.Uniform3f(e2, i2.u_scale), u_fade: new t.Uniform1f(e2, i2.u_fade) }), circle: (e2, i2) => ({ u_camera_to_center_distance: new t.Uniform1f(e2, i2.u_camera_to_center_distance), u_scale_with_map: new t.Uniform1i(e2, i2.u_scale_with_map), u_pitch_with_map: new t.Uniform1i(e2, i2.u_pitch_with_map), u_extrude_scale: new t.Uniform2f(e2, i2.u_extrude_scale), u_device_pixel_ratio: new t.Uniform1f(e2, i2.u_device_pixel_ratio), u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix) }), collisionBox: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_camera_to_center_distance: new t.Uniform1f(e2, i2.u_camera_to_center_distance), u_pixels_to_tile_units: new t.Uniform1f(e2, i2.u_pixels_to_tile_units), u_extrude_scale: new t.Uniform2f(e2, i2.u_extrude_scale), u_overscale_factor: new t.Uniform1f(e2, i2.u_overscale_factor) }), collisionCircle: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_inv_matrix: new t.UniformMatrix4f(e2, i2.u_inv_matrix), u_camera_to_center_distance: new t.Uniform1f(e2, i2.u_camera_to_center_distance), u_viewport_size: new t.Uniform2f(e2, i2.u_viewport_size) }), debug: (e2, i2) => ({ u_color: new t.UniformColor(e2, i2.u_color), u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_overlay: new t.Uniform1i(e2, i2.u_overlay), u_overlay_scale: new t.Uniform1f(e2, i2.u_overlay_scale) }), clippingMask: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix) }), heatmap: (e2, i2) => ({ u_extrude_scale: new t.Uniform1f(e2, i2.u_extrude_scale), u_intensity: new t.Uniform1f(e2, i2.u_intensity), u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix) }), heatmapTexture: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_world: new t.Uniform2f(e2, i2.u_world), u_image: new t.Uniform1i(e2, i2.u_image), u_color_ramp: new t.Uniform1i(e2, i2.u_color_ramp), u_opacity: new t.Uniform1f(e2, i2.u_opacity) }), hillshade: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_image: new t.Uniform1i(e2, i2.u_image), u_latrange: new t.Uniform2f(e2, i2.u_latrange), u_light: new t.Uniform2f(e2, i2.u_light), u_shadow: new t.UniformColor(e2, i2.u_shadow), u_highlight: new t.UniformColor(e2, i2.u_highlight), u_accent: new t.UniformColor(e2, i2.u_accent) }), hillshadePrepare: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_image: new t.Uniform1i(e2, i2.u_image), u_dimension: new t.Uniform2f(e2, i2.u_dimension), u_zoom: new t.Uniform1f(e2, i2.u_zoom), u_unpack: new t.Uniform4f(e2, i2.u_unpack) }), line: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_ratio: new t.Uniform1f(e2, i2.u_ratio), u_device_pixel_ratio: new t.Uniform1f(e2, i2.u_device_pixel_ratio), u_units_to_pixels: new t.Uniform2f(e2, i2.u_units_to_pixels) }), lineGradient: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_ratio: new t.Uniform1f(e2, i2.u_ratio), u_device_pixel_ratio: new t.Uniform1f(e2, i2.u_device_pixel_ratio), u_units_to_pixels: new t.Uniform2f(e2, i2.u_units_to_pixels), u_image: new t.Uniform1i(e2, i2.u_image), u_image_height: new t.Uniform1f(e2, i2.u_image_height) }), linePattern: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_ratio: new t.Uniform1f(e2, i2.u_ratio), u_device_pixel_ratio: new t.Uniform1f(e2, i2.u_device_pixel_ratio), u_image: new t.Uniform1i(e2, i2.u_image), u_units_to_pixels: new t.Uniform2f(e2, i2.u_units_to_pixels), u_scale: new t.Uniform3f(e2, i2.u_scale), u_fade: new t.Uniform1f(e2, i2.u_fade) }), lineSDF: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_ratio: new t.Uniform1f(e2, i2.u_ratio), u_device_pixel_ratio: new t.Uniform1f(e2, i2.u_device_pixel_ratio), u_units_to_pixels: new t.Uniform2f(e2, i2.u_units_to_pixels), u_patternscale_a: new t.Uniform2f(e2, i2.u_patternscale_a), u_patternscale_b: new t.Uniform2f(e2, i2.u_patternscale_b), u_sdfgamma: new t.Uniform1f(e2, i2.u_sdfgamma), u_image: new t.Uniform1i(e2, i2.u_image), u_tex_y_a: new t.Uniform1f(e2, i2.u_tex_y_a), u_tex_y_b: new t.Uniform1f(e2, i2.u_tex_y_b), u_mix: new t.Uniform1f(e2, i2.u_mix) }), raster: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_tl_parent: new t.Uniform2f(e2, i2.u_tl_parent), u_scale_parent: new t.Uniform1f(e2, i2.u_scale_parent), u_buffer_scale: new t.Uniform1f(e2, i2.u_buffer_scale), u_fade_t: new t.Uniform1f(e2, i2.u_fade_t), u_opacity: new t.Uniform1f(e2, i2.u_opacity), u_image0: new t.Uniform1i(e2, i2.u_image0), u_image1: new t.Uniform1i(e2, i2.u_image1), u_brightness_low: new t.Uniform1f(e2, i2.u_brightness_low), u_brightness_high: new t.Uniform1f(e2, i2.u_brightness_high), u_saturation_factor: new t.Uniform1f(e2, i2.u_saturation_factor), u_contrast_factor: new t.Uniform1f(e2, i2.u_contrast_factor), u_spin_weights: new t.Uniform3f(e2, i2.u_spin_weights) }), symbolIcon: (e2, i2) => ({ u_is_size_zoom_constant: new t.Uniform1i(e2, i2.u_is_size_zoom_constant), u_is_size_feature_constant: new t.Uniform1i(e2, i2.u_is_size_feature_constant), u_size_t: new t.Uniform1f(e2, i2.u_size_t), u_size: new t.Uniform1f(e2, i2.u_size), u_camera_to_center_distance: new t.Uniform1f(e2, i2.u_camera_to_center_distance), u_pitch: new t.Uniform1f(e2, i2.u_pitch), u_rotate_symbol: new t.Uniform1i(e2, i2.u_rotate_symbol), u_aspect_ratio: new t.Uniform1f(e2, i2.u_aspect_ratio), u_fade_change: new t.Uniform1f(e2, i2.u_fade_change), u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_label_plane_matrix: new t.UniformMatrix4f(e2, i2.u_label_plane_matrix), u_coord_matrix: new t.UniformMatrix4f(e2, i2.u_coord_matrix), u_is_text: new t.Uniform1i(e2, i2.u_is_text), u_pitch_with_map: new t.Uniform1i(e2, i2.u_pitch_with_map), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_texture: new t.Uniform1i(e2, i2.u_texture) }), symbolSDF: (e2, i2) => ({ u_is_size_zoom_constant: new t.Uniform1i(e2, i2.u_is_size_zoom_constant), u_is_size_feature_constant: new t.Uniform1i(e2, i2.u_is_size_feature_constant), u_size_t: new t.Uniform1f(e2, i2.u_size_t), u_size: new t.Uniform1f(e2, i2.u_size), u_camera_to_center_distance: new t.Uniform1f(e2, i2.u_camera_to_center_distance), u_pitch: new t.Uniform1f(e2, i2.u_pitch), u_rotate_symbol: new t.Uniform1i(e2, i2.u_rotate_symbol), u_aspect_ratio: new t.Uniform1f(e2, i2.u_aspect_ratio), u_fade_change: new t.Uniform1f(e2, i2.u_fade_change), u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_label_plane_matrix: new t.UniformMatrix4f(e2, i2.u_label_plane_matrix), u_coord_matrix: new t.UniformMatrix4f(e2, i2.u_coord_matrix), u_is_text: new t.Uniform1i(e2, i2.u_is_text), u_pitch_with_map: new t.Uniform1i(e2, i2.u_pitch_with_map), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_texture: new t.Uniform1i(e2, i2.u_texture), u_gamma_scale: new t.Uniform1f(e2, i2.u_gamma_scale), u_device_pixel_ratio: new t.Uniform1f(e2, i2.u_device_pixel_ratio), u_is_halo: new t.Uniform1i(e2, i2.u_is_halo) }), symbolTextAndIcon: (e2, i2) => ({ u_is_size_zoom_constant: new t.Uniform1i(e2, i2.u_is_size_zoom_constant), u_is_size_feature_constant: new t.Uniform1i(e2, i2.u_is_size_feature_constant), u_size_t: new t.Uniform1f(e2, i2.u_size_t), u_size: new t.Uniform1f(e2, i2.u_size), u_camera_to_center_distance: new t.Uniform1f(e2, i2.u_camera_to_center_distance), u_pitch: new t.Uniform1f(e2, i2.u_pitch), u_rotate_symbol: new t.Uniform1i(e2, i2.u_rotate_symbol), u_aspect_ratio: new t.Uniform1f(e2, i2.u_aspect_ratio), u_fade_change: new t.Uniform1f(e2, i2.u_fade_change), u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_label_plane_matrix: new t.UniformMatrix4f(e2, i2.u_label_plane_matrix), u_coord_matrix: new t.UniformMatrix4f(e2, i2.u_coord_matrix), u_is_text: new t.Uniform1i(e2, i2.u_is_text), u_pitch_with_map: new t.Uniform1i(e2, i2.u_pitch_with_map), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_texsize_icon: new t.Uniform2f(e2, i2.u_texsize_icon), u_texture: new t.Uniform1i(e2, i2.u_texture), u_texture_icon: new t.Uniform1i(e2, i2.u_texture_icon), u_gamma_scale: new t.Uniform1f(e2, i2.u_gamma_scale), u_device_pixel_ratio: new t.Uniform1f(e2, i2.u_device_pixel_ratio), u_is_halo: new t.Uniform1i(e2, i2.u_is_halo) }), background: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_opacity: new t.Uniform1f(e2, i2.u_opacity), u_color: new t.UniformColor(e2, i2.u_color) }), backgroundPattern: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_opacity: new t.Uniform1f(e2, i2.u_opacity), u_image: new t.Uniform1i(e2, i2.u_image), u_pattern_tl_a: new t.Uniform2f(e2, i2.u_pattern_tl_a), u_pattern_br_a: new t.Uniform2f(e2, i2.u_pattern_br_a), u_pattern_tl_b: new t.Uniform2f(e2, i2.u_pattern_tl_b), u_pattern_br_b: new t.Uniform2f(e2, i2.u_pattern_br_b), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_mix: new t.Uniform1f(e2, i2.u_mix), u_pattern_size_a: new t.Uniform2f(e2, i2.u_pattern_size_a), u_pattern_size_b: new t.Uniform2f(e2, i2.u_pattern_size_b), u_scale_a: new t.Uniform1f(e2, i2.u_scale_a), u_scale_b: new t.Uniform1f(e2, i2.u_scale_b), u_pixel_coord_upper: new t.Uniform2f(e2, i2.u_pixel_coord_upper), u_pixel_coord_lower: new t.Uniform2f(e2, i2.u_pixel_coord_lower), u_tile_units_to_pixels: new t.Uniform1f(e2, i2.u_tile_units_to_pixels) }), terrain: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_texture: new t.Uniform1i(e2, i2.u_texture) }), terrainDepth: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix) }), terrainCoords: (e2, i2) => ({ u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_texture: new t.Uniform1i(e2, i2.u_texture), u_terrain_coords_id: new t.Uniform1f(e2, i2.u_terrain_coords_id) }) };
        class ke {
          constructor(t2, e2, i2) {
            this.context = t2;
            const o2 = t2.gl;
            this.buffer = o2.createBuffer(), this.dynamicDraw = Boolean(i2), this.context.unbindVAO(), t2.bindElementBuffer.set(this.buffer), o2.bufferData(o2.ELEMENT_ARRAY_BUFFER, e2.arrayBuffer, this.dynamicDraw ? o2.DYNAMIC_DRAW : o2.STATIC_DRAW), this.dynamicDraw || delete e2.arrayBuffer;
          }
          bind() {
            this.context.bindElementBuffer.set(this.buffer);
          }
          updateData(t2) {
            const e2 = this.context.gl;
            if (!this.dynamicDraw)
              throw new Error("Attempted to update data while not in dynamic mode.");
            this.context.unbindVAO(), this.bind(), e2.bufferSubData(e2.ELEMENT_ARRAY_BUFFER, 0, t2.arrayBuffer);
          }
          destroy() {
            this.buffer && (this.context.gl.deleteBuffer(this.buffer), delete this.buffer);
          }
        }
        const Be = { Int8: "BYTE", Uint8: "UNSIGNED_BYTE", Int16: "SHORT", Uint16: "UNSIGNED_SHORT", Int32: "INT", Uint32: "UNSIGNED_INT", Float32: "FLOAT" };
        class Fe {
          constructor(t2, e2, i2, o2) {
            this.length = e2.length, this.attributes = i2, this.itemSize = e2.bytesPerElement, this.dynamicDraw = o2, this.context = t2;
            const a2 = t2.gl;
            this.buffer = a2.createBuffer(), t2.bindVertexBuffer.set(this.buffer), a2.bufferData(a2.ARRAY_BUFFER, e2.arrayBuffer, this.dynamicDraw ? a2.DYNAMIC_DRAW : a2.STATIC_DRAW), this.dynamicDraw || delete e2.arrayBuffer;
          }
          bind() {
            this.context.bindVertexBuffer.set(this.buffer);
          }
          updateData(t2) {
            if (t2.length !== this.length)
              throw new Error(`Length of new data is ${t2.length}, which doesn't match current length of ${this.length}`);
            const e2 = this.context.gl;
            this.bind(), e2.bufferSubData(e2.ARRAY_BUFFER, 0, t2.arrayBuffer);
          }
          enableAttributes(t2, e2) {
            for (let i2 = 0; i2 < this.attributes.length; i2++) {
              const o2 = e2.attributes[this.attributes[i2].name];
              void 0 !== o2 && t2.enableVertexAttribArray(o2);
            }
          }
          setVertexAttribPointers(t2, e2, i2) {
            for (let o2 = 0; o2 < this.attributes.length; o2++) {
              const a2 = this.attributes[o2], r2 = e2.attributes[a2.name];
              void 0 !== r2 && t2.vertexAttribPointer(r2, a2.components, t2[Be[a2.type]], false, this.itemSize, a2.offset + this.itemSize * (i2 || 0));
            }
          }
          destroy() {
            this.buffer && (this.context.gl.deleteBuffer(this.buffer), delete this.buffer);
          }
        }
        class Oe {
          constructor(t2) {
            this.gl = t2.gl, this.default = this.getDefault(), this.current = this.default, this.dirty = false;
          }
          get() {
            return this.current;
          }
          set(t2) {
          }
          getDefault() {
            return this.default;
          }
          setDefault() {
            this.set(this.default);
          }
        }
        class Ue extends Oe {
          getDefault() {
            return t.Color.transparent;
          }
          set(t2) {
            const e2 = this.current;
            (t2.r !== e2.r || t2.g !== e2.g || t2.b !== e2.b || t2.a !== e2.a || this.dirty) && (this.gl.clearColor(t2.r, t2.g, t2.b, t2.a), this.current = t2, this.dirty = false);
          }
        }
        class Ne extends Oe {
          getDefault() {
            return 1;
          }
          set(t2) {
            (t2 !== this.current || this.dirty) && (this.gl.clearDepth(t2), this.current = t2, this.dirty = false);
          }
        }
        class Ge extends Oe {
          getDefault() {
            return 0;
          }
          set(t2) {
            (t2 !== this.current || this.dirty) && (this.gl.clearStencil(t2), this.current = t2, this.dirty = false);
          }
        }
        class Ze extends Oe {
          getDefault() {
            return [true, true, true, true];
          }
          set(t2) {
            const e2 = this.current;
            (t2[0] !== e2[0] || t2[1] !== e2[1] || t2[2] !== e2[2] || t2[3] !== e2[3] || this.dirty) && (this.gl.colorMask(t2[0], t2[1], t2[2], t2[3]), this.current = t2, this.dirty = false);
          }
        }
        class Ve extends Oe {
          getDefault() {
            return true;
          }
          set(t2) {
            (t2 !== this.current || this.dirty) && (this.gl.depthMask(t2), this.current = t2, this.dirty = false);
          }
        }
        class qe extends Oe {
          getDefault() {
            return 255;
          }
          set(t2) {
            (t2 !== this.current || this.dirty) && (this.gl.stencilMask(t2), this.current = t2, this.dirty = false);
          }
        }
        class je extends Oe {
          getDefault() {
            return { func: this.gl.ALWAYS, ref: 0, mask: 255 };
          }
          set(t2) {
            const e2 = this.current;
            (t2.func !== e2.func || t2.ref !== e2.ref || t2.mask !== e2.mask || this.dirty) && (this.gl.stencilFunc(t2.func, t2.ref, t2.mask), this.current = t2, this.dirty = false);
          }
        }
        class $e extends Oe {
          getDefault() {
            const t2 = this.gl;
            return [t2.KEEP, t2.KEEP, t2.KEEP];
          }
          set(t2) {
            const e2 = this.current;
            (t2[0] !== e2[0] || t2[1] !== e2[1] || t2[2] !== e2[2] || this.dirty) && (this.gl.stencilOp(t2[0], t2[1], t2[2]), this.current = t2, this.dirty = false);
          }
        }
        class Xe extends Oe {
          getDefault() {
            return false;
          }
          set(t2) {
            if (t2 === this.current && !this.dirty)
              return;
            const e2 = this.gl;
            t2 ? e2.enable(e2.STENCIL_TEST) : e2.disable(e2.STENCIL_TEST), this.current = t2, this.dirty = false;
          }
        }
        class We extends Oe {
          getDefault() {
            return [0, 1];
          }
          set(t2) {
            const e2 = this.current;
            (t2[0] !== e2[0] || t2[1] !== e2[1] || this.dirty) && (this.gl.depthRange(t2[0], t2[1]), this.current = t2, this.dirty = false);
          }
        }
        class He extends Oe {
          getDefault() {
            return false;
          }
          set(t2) {
            if (t2 === this.current && !this.dirty)
              return;
            const e2 = this.gl;
            t2 ? e2.enable(e2.DEPTH_TEST) : e2.disable(e2.DEPTH_TEST), this.current = t2, this.dirty = false;
          }
        }
        class Ke extends Oe {
          getDefault() {
            return this.gl.LESS;
          }
          set(t2) {
            (t2 !== this.current || this.dirty) && (this.gl.depthFunc(t2), this.current = t2, this.dirty = false);
          }
        }
        class Ye extends Oe {
          getDefault() {
            return false;
          }
          set(t2) {
            if (t2 === this.current && !this.dirty)
              return;
            const e2 = this.gl;
            t2 ? e2.enable(e2.BLEND) : e2.disable(e2.BLEND), this.current = t2, this.dirty = false;
          }
        }
        class Je extends Oe {
          getDefault() {
            const t2 = this.gl;
            return [t2.ONE, t2.ZERO];
          }
          set(t2) {
            const e2 = this.current;
            (t2[0] !== e2[0] || t2[1] !== e2[1] || this.dirty) && (this.gl.blendFunc(t2[0], t2[1]), this.current = t2, this.dirty = false);
          }
        }
        class Qe extends Oe {
          getDefault() {
            return t.Color.transparent;
          }
          set(t2) {
            const e2 = this.current;
            (t2.r !== e2.r || t2.g !== e2.g || t2.b !== e2.b || t2.a !== e2.a || this.dirty) && (this.gl.blendColor(t2.r, t2.g, t2.b, t2.a), this.current = t2, this.dirty = false);
          }
        }
        class ti extends Oe {
          getDefault() {
            return this.gl.FUNC_ADD;
          }
          set(t2) {
            (t2 !== this.current || this.dirty) && (this.gl.blendEquation(t2), this.current = t2, this.dirty = false);
          }
        }
        class ei extends Oe {
          getDefault() {
            return false;
          }
          set(t2) {
            if (t2 === this.current && !this.dirty)
              return;
            const e2 = this.gl;
            t2 ? e2.enable(e2.CULL_FACE) : e2.disable(e2.CULL_FACE), this.current = t2, this.dirty = false;
          }
        }
        class ii extends Oe {
          getDefault() {
            return this.gl.BACK;
          }
          set(t2) {
            (t2 !== this.current || this.dirty) && (this.gl.cullFace(t2), this.current = t2, this.dirty = false);
          }
        }
        class oi extends Oe {
          getDefault() {
            return this.gl.CCW;
          }
          set(t2) {
            (t2 !== this.current || this.dirty) && (this.gl.frontFace(t2), this.current = t2, this.dirty = false);
          }
        }
        class ai extends Oe {
          getDefault() {
            return null;
          }
          set(t2) {
            (t2 !== this.current || this.dirty) && (this.gl.useProgram(t2), this.current = t2, this.dirty = false);
          }
        }
        class ri extends Oe {
          getDefault() {
            return this.gl.TEXTURE0;
          }
          set(t2) {
            (t2 !== this.current || this.dirty) && (this.gl.activeTexture(t2), this.current = t2, this.dirty = false);
          }
        }
        class si extends Oe {
          getDefault() {
            const t2 = this.gl;
            return [0, 0, t2.drawingBufferWidth, t2.drawingBufferHeight];
          }
          set(t2) {
            const e2 = this.current;
            (t2[0] !== e2[0] || t2[1] !== e2[1] || t2[2] !== e2[2] || t2[3] !== e2[3] || this.dirty) && (this.gl.viewport(t2[0], t2[1], t2[2], t2[3]), this.current = t2, this.dirty = false);
          }
        }
        class ni extends Oe {
          getDefault() {
            return null;
          }
          set(t2) {
            if (t2 === this.current && !this.dirty)
              return;
            const e2 = this.gl;
            e2.bindFramebuffer(e2.FRAMEBUFFER, t2), this.current = t2, this.dirty = false;
          }
        }
        class li extends Oe {
          getDefault() {
            return null;
          }
          set(t2) {
            if (t2 === this.current && !this.dirty)
              return;
            const e2 = this.gl;
            e2.bindRenderbuffer(e2.RENDERBUFFER, t2), this.current = t2, this.dirty = false;
          }
        }
        class ci extends Oe {
          getDefault() {
            return null;
          }
          set(t2) {
            if (t2 === this.current && !this.dirty)
              return;
            const e2 = this.gl;
            e2.bindTexture(e2.TEXTURE_2D, t2), this.current = t2, this.dirty = false;
          }
        }
        class hi extends Oe {
          getDefault() {
            return null;
          }
          set(t2) {
            if (t2 === this.current && !this.dirty)
              return;
            const e2 = this.gl;
            e2.bindBuffer(e2.ARRAY_BUFFER, t2), this.current = t2, this.dirty = false;
          }
        }
        class ui extends Oe {
          getDefault() {
            return null;
          }
          set(t2) {
            const e2 = this.gl;
            e2.bindBuffer(e2.ELEMENT_ARRAY_BUFFER, t2), this.current = t2, this.dirty = false;
          }
        }
        class di extends Oe {
          constructor(t2) {
            super(t2), this.vao = t2.extVertexArrayObject;
          }
          getDefault() {
            return null;
          }
          set(t2) {
            this.vao && (t2 !== this.current || this.dirty) && (this.vao.bindVertexArrayOES(t2), this.current = t2, this.dirty = false);
          }
        }
        class mi extends Oe {
          getDefault() {
            return 4;
          }
          set(t2) {
            if (t2 === this.current && !this.dirty)
              return;
            const e2 = this.gl;
            e2.pixelStorei(e2.UNPACK_ALIGNMENT, t2), this.current = t2, this.dirty = false;
          }
        }
        class _i extends Oe {
          getDefault() {
            return false;
          }
          set(t2) {
            if (t2 === this.current && !this.dirty)
              return;
            const e2 = this.gl;
            e2.pixelStorei(e2.UNPACK_PREMULTIPLY_ALPHA_WEBGL, t2), this.current = t2, this.dirty = false;
          }
        }
        class pi extends Oe {
          getDefault() {
            return false;
          }
          set(t2) {
            if (t2 === this.current && !this.dirty)
              return;
            const e2 = this.gl;
            e2.pixelStorei(e2.UNPACK_FLIP_Y_WEBGL, t2), this.current = t2, this.dirty = false;
          }
        }
        class fi extends Oe {
          constructor(t2, e2) {
            super(t2), this.context = t2, this.parent = e2;
          }
          getDefault() {
            return null;
          }
        }
        class gi extends fi {
          setDirty() {
            this.dirty = true;
          }
          set(t2) {
            if (t2 === this.current && !this.dirty)
              return;
            this.context.bindFramebuffer.set(this.parent);
            const e2 = this.gl;
            e2.framebufferTexture2D(e2.FRAMEBUFFER, e2.COLOR_ATTACHMENT0, e2.TEXTURE_2D, t2, 0), this.current = t2, this.dirty = false;
          }
        }
        class xi extends fi {
          set(t2) {
            if (t2 === this.current && !this.dirty)
              return;
            this.context.bindFramebuffer.set(this.parent);
            const e2 = this.gl;
            e2.framebufferRenderbuffer(e2.FRAMEBUFFER, e2.DEPTH_ATTACHMENT, e2.RENDERBUFFER, t2), this.current = t2, this.dirty = false;
          }
        }
        class vi {
          constructor(t2, e2, i2, o2) {
            this.context = t2, this.width = e2, this.height = i2;
            const a2 = t2.gl, r2 = this.framebuffer = a2.createFramebuffer();
            if (this.colorAttachment = new gi(t2, r2), o2 && (this.depthAttachment = new xi(t2, r2)), a2.checkFramebufferStatus(a2.FRAMEBUFFER) !== a2.FRAMEBUFFER_COMPLETE)
              throw new Error("Framebuffer is not complete");
          }
          destroy() {
            const t2 = this.context.gl, e2 = this.colorAttachment.get();
            if (e2 && t2.deleteTexture(e2), this.depthAttachment) {
              const e3 = this.depthAttachment.get();
              e3 && t2.deleteRenderbuffer(e3);
            }
            t2.deleteFramebuffer(this.framebuffer);
          }
        }
        class yi {
          constructor(t2, e2, i2) {
            this.blendFunction = t2, this.blendColor = e2, this.mask = i2;
          }
        }
        yi.Replace = [1, 0], yi.disabled = new yi(yi.Replace, t.Color.transparent, [false, false, false, false]), yi.unblended = new yi(yi.Replace, t.Color.transparent, [true, true, true, true]), yi.alphaBlended = new yi([1, 771], t.Color.transparent, [true, true, true, true]);
        class bi {
          constructor(t2) {
            this.gl = t2, this.extVertexArrayObject = this.gl.getExtension("OES_vertex_array_object"), this.clearColor = new Ue(this), this.clearDepth = new Ne(this), this.clearStencil = new Ge(this), this.colorMask = new Ze(this), this.depthMask = new Ve(this), this.stencilMask = new qe(this), this.stencilFunc = new je(this), this.stencilOp = new $e(this), this.stencilTest = new Xe(this), this.depthRange = new We(this), this.depthTest = new He(this), this.depthFunc = new Ke(this), this.blend = new Ye(this), this.blendFunc = new Je(this), this.blendColor = new Qe(this), this.blendEquation = new ti(this), this.cullFace = new ei(this), this.cullFaceSide = new ii(this), this.frontFace = new oi(this), this.program = new ai(this), this.activeTexture = new ri(this), this.viewport = new si(this), this.bindFramebuffer = new ni(this), this.bindRenderbuffer = new li(this), this.bindTexture = new ci(this), this.bindVertexBuffer = new hi(this), this.bindElementBuffer = new ui(this), this.bindVertexArrayOES = this.extVertexArrayObject && new di(this), this.pixelStoreUnpack = new mi(this), this.pixelStoreUnpackPremultiplyAlpha = new _i(this), this.pixelStoreUnpackFlipY = new pi(this), this.extTextureFilterAnisotropic = t2.getExtension("EXT_texture_filter_anisotropic") || t2.getExtension("MOZ_EXT_texture_filter_anisotropic") || t2.getExtension("WEBKIT_EXT_texture_filter_anisotropic"), this.extTextureFilterAnisotropic && (this.extTextureFilterAnisotropicMax = t2.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)), this.extTextureHalfFloat = t2.getExtension("OES_texture_half_float"), this.extTextureHalfFloat && (t2.getExtension("OES_texture_half_float_linear"), this.extRenderToTextureHalfFloat = t2.getExtension("EXT_color_buffer_half_float")), this.extTimerQuery = t2.getExtension("EXT_disjoint_timer_query"), this.maxTextureSize = t2.getParameter(t2.MAX_TEXTURE_SIZE);
          }
          setDefault() {
            this.unbindVAO(), this.clearColor.setDefault(), this.clearDepth.setDefault(), this.clearStencil.setDefault(), this.colorMask.setDefault(), this.depthMask.setDefault(), this.stencilMask.setDefault(), this.stencilFunc.setDefault(), this.stencilOp.setDefault(), this.stencilTest.setDefault(), this.depthRange.setDefault(), this.depthTest.setDefault(), this.depthFunc.setDefault(), this.blend.setDefault(), this.blendFunc.setDefault(), this.blendColor.setDefault(), this.blendEquation.setDefault(), this.cullFace.setDefault(), this.cullFaceSide.setDefault(), this.frontFace.setDefault(), this.program.setDefault(), this.activeTexture.setDefault(), this.bindFramebuffer.setDefault(), this.pixelStoreUnpack.setDefault(), this.pixelStoreUnpackPremultiplyAlpha.setDefault(), this.pixelStoreUnpackFlipY.setDefault();
          }
          setDirty() {
            this.clearColor.dirty = true, this.clearDepth.dirty = true, this.clearStencil.dirty = true, this.colorMask.dirty = true, this.depthMask.dirty = true, this.stencilMask.dirty = true, this.stencilFunc.dirty = true, this.stencilOp.dirty = true, this.stencilTest.dirty = true, this.depthRange.dirty = true, this.depthTest.dirty = true, this.depthFunc.dirty = true, this.blend.dirty = true, this.blendFunc.dirty = true, this.blendColor.dirty = true, this.blendEquation.dirty = true, this.cullFace.dirty = true, this.cullFaceSide.dirty = true, this.frontFace.dirty = true, this.program.dirty = true, this.activeTexture.dirty = true, this.viewport.dirty = true, this.bindFramebuffer.dirty = true, this.bindRenderbuffer.dirty = true, this.bindTexture.dirty = true, this.bindVertexBuffer.dirty = true, this.bindElementBuffer.dirty = true, this.extVertexArrayObject && (this.bindVertexArrayOES.dirty = true), this.pixelStoreUnpack.dirty = true, this.pixelStoreUnpackPremultiplyAlpha.dirty = true, this.pixelStoreUnpackFlipY.dirty = true;
          }
          createIndexBuffer(t2, e2) {
            return new ke(this, t2, e2);
          }
          createVertexBuffer(t2, e2, i2) {
            return new Fe(this, t2, e2, i2);
          }
          createRenderbuffer(t2, e2, i2) {
            const o2 = this.gl, a2 = o2.createRenderbuffer();
            return this.bindRenderbuffer.set(a2), o2.renderbufferStorage(o2.RENDERBUFFER, t2, e2, i2), this.bindRenderbuffer.set(null), a2;
          }
          createFramebuffer(t2, e2, i2) {
            return new vi(this, t2, e2, i2);
          }
          clear({ color: t2, depth: e2 }) {
            const i2 = this.gl;
            let o2 = 0;
            t2 && (o2 |= i2.COLOR_BUFFER_BIT, this.clearColor.set(t2), this.colorMask.set([true, true, true, true])), void 0 !== e2 && (o2 |= i2.DEPTH_BUFFER_BIT, this.depthRange.set([0, 1]), this.clearDepth.set(e2), this.depthMask.set(true)), i2.clear(o2);
          }
          setCullFace(t2) {
            false === t2.enable ? this.cullFace.set(false) : (this.cullFace.set(true), this.cullFaceSide.set(t2.mode), this.frontFace.set(t2.frontFace));
          }
          setDepthMode(t2) {
            t2.func !== this.gl.ALWAYS || t2.mask ? (this.depthTest.set(true), this.depthFunc.set(t2.func), this.depthMask.set(t2.mask), this.depthRange.set(t2.range)) : this.depthTest.set(false);
          }
          setStencilMode(t2) {
            t2.test.func !== this.gl.ALWAYS || t2.mask ? (this.stencilTest.set(true), this.stencilMask.set(t2.mask), this.stencilOp.set([t2.fail, t2.depthFail, t2.pass]), this.stencilFunc.set({ func: t2.test.func, ref: t2.ref, mask: t2.test.mask })) : this.stencilTest.set(false);
          }
          setColorMode(t2) {
            a(t2.blendFunction, yi.Replace) ? this.blend.set(false) : (this.blend.set(true), this.blendFunc.set(t2.blendFunction), this.blendColor.set(t2.blendColor)), this.colorMask.set(t2.mask);
          }
          unbindVAO() {
            this.extVertexArrayObject && this.bindVertexArrayOES.set(null);
          }
        }
        class wi {
          constructor(t2, e2, i2) {
            this.func = t2, this.mask = e2, this.range = i2;
          }
        }
        wi.ReadOnly = false, wi.ReadWrite = true, wi.disabled = new wi(519, wi.ReadOnly, [0, 1]);
        const Ti = 7680;
        class Ei {
          constructor(t2, e2, i2, o2, a2, r2) {
            this.test = t2, this.ref = e2, this.mask = i2, this.fail = o2, this.depthFail = a2, this.pass = r2;
          }
        }
        Ei.disabled = new Ei({ func: 519, mask: 0 }, 0, 0, Ti, Ti, Ti);
        class Ii {
          constructor(t2, e2, i2) {
            this.enable = t2, this.mode = e2, this.frontFace = i2;
          }
        }
        let Ci;
        function Si(e2, i2, o2, a2, r2, s2, n2) {
          const l2 = e2.context, c3 = l2.gl, h2 = e2.useProgram("collisionBox"), u2 = [];
          let d2 = 0, m2 = 0;
          for (let _3 = 0; _3 < a2.length; _3++) {
            const p4 = a2[_3], f3 = i2.getTile(p4), g3 = f3.getBucket(o2);
            if (!g3)
              continue;
            let x3 = p4.posMatrix;
            0 === r2[0] && 0 === r2[1] || (x3 = e2.translatePosMatrix(p4.posMatrix, f3, r2, s2));
            const v4 = n2 ? g3.textCollisionBox : g3.iconCollisionBox, y3 = g3.collisionCircleArray;
            if (y3.length > 0) {
              const i3 = t.create(), o3 = x3;
              t.mul(i3, g3.placementInvProjMatrix, e2.transform.glCoordMatrix), t.mul(i3, i3, g3.placementViewportMatrix), u2.push({ circleArray: y3, circleOffset: m2, transform: o3, invTransform: i3, coord: p4 }), d2 += y3.length / 4, m2 = d2;
            }
            v4 && h2.draw(l2, c3.LINES, wi.disabled, Ei.disabled, e2.colorModeForRenderPass(), Ii.disabled, fe(x3, e2.transform, f3), e2.style.terrain && e2.style.terrain.getTerrainData(p4), o2.id, v4.layoutVertexBuffer, v4.indexBuffer, v4.segments, null, e2.transform.zoom, null, null, v4.collisionVertexBuffer);
          }
          if (!n2 || !u2.length)
            return;
          const _2 = e2.useProgram("collisionCircle"), p3 = new t.CollisionCircleLayoutArray();
          p3.resize(4 * d2), p3._trim();
          let f2 = 0;
          for (const t2 of u2)
            for (let e3 = 0; e3 < t2.circleArray.length / 4; e3++) {
              const i3 = 4 * e3, o3 = t2.circleArray[i3 + 0], a3 = t2.circleArray[i3 + 1], r3 = t2.circleArray[i3 + 2], s3 = t2.circleArray[i3 + 3];
              p3.emplace(f2++, o3, a3, r3, s3, 0), p3.emplace(f2++, o3, a3, r3, s3, 1), p3.emplace(f2++, o3, a3, r3, s3, 2), p3.emplace(f2++, o3, a3, r3, s3, 3);
            }
          (!Ci || Ci.length < 2 * d2) && (Ci = function(e3) {
            const i3 = 2 * e3, o3 = new t.QuadTriangleArray();
            o3.resize(i3), o3._trim();
            for (let t2 = 0; t2 < i3; t2++) {
              const e4 = 6 * t2;
              o3.uint16[e4 + 0] = 4 * t2 + 0, o3.uint16[e4 + 1] = 4 * t2 + 1, o3.uint16[e4 + 2] = 4 * t2 + 2, o3.uint16[e4 + 3] = 4 * t2 + 2, o3.uint16[e4 + 4] = 4 * t2 + 3, o3.uint16[e4 + 5] = 4 * t2 + 0;
            }
            return o3;
          }(d2));
          const g2 = l2.createIndexBuffer(Ci, true), x2 = l2.createVertexBuffer(p3, t.collisionCircleLayout.members, true);
          for (const i3 of u2) {
            const a3 = { u_matrix: i3.transform, u_inv_matrix: i3.invTransform, u_camera_to_center_distance: (v3 = e2.transform).cameraToCenterDistance, u_viewport_size: [v3.width, v3.height] };
            _2.draw(l2, c3.TRIANGLES, wi.disabled, Ei.disabled, e2.colorModeForRenderPass(), Ii.disabled, a3, e2.style.terrain && e2.style.terrain.getTerrainData(i3.coord), o2.id, x2, g2, t.SegmentVector.simpleSegment(0, 2 * i3.circleOffset, i3.circleArray.length, i3.circleArray.length / 2), null, e2.transform.zoom, null, null, null);
          }
          var v3;
          x2.destroy(), g2.destroy();
        }
        Ii.disabled = new Ii(false, 1029, 2305), Ii.backCCW = new Ii(true, 1029, 2305);
        const Di = t.identity(new Float32Array(16));
        function zi(e2, i2, o2, a2, r2, s2) {
          const { horizontalAlign: n2, verticalAlign: l2 } = t.getAnchorAlignment(e2), c3 = -(n2 - 0.5) * i2, h2 = -(l2 - 0.5) * o2, u2 = t.evaluateVariableOffset(e2, a2);
          return new t.pointGeometry((c3 / r2 + u2[0]) * s2, (h2 / r2 + u2[1]) * s2);
        }
        function Pi(e2, i2, o2, a2, r2, s2, n2, l2, c3, h2, u2) {
          const d2 = e2.text.placedSymbolArray, m2 = e2.text.dynamicLayoutVertexArray, _2 = e2.icon.dynamicLayoutVertexArray, p3 = {};
          m2.clear();
          for (let _3 = 0; _3 < d2.length; _3++) {
            const f2 = d2.get(_3), g2 = e2.allowVerticalPlacement && !f2.placedOrientation, x2 = f2.hidden || !f2.crossTileID || g2 ? null : a2[f2.crossTileID];
            if (x2) {
              const a3 = new t.pointGeometry(f2.anchorX, f2.anchorY), d3 = nt(a3, o2 ? n2 : s2, u2), _4 = lt(r2.cameraToCenterDistance, d3.signedDistanceFromCamera);
              let g3 = t.evaluateSizeForFeature(e2.textSizeData, c3, f2) * _4 / t.ONE_EM;
              o2 && (g3 *= e2.tilePixelRatio / l2);
              const { width: v3, height: y3, anchor: b2, textOffset: w2, textBoxScale: T2 } = x2, E2 = zi(b2, v3, y3, w2, T2, g3), I3 = o2 ? nt(a3.add(E2), s2, u2).point : d3.point.add(i2 ? E2.rotate(-r2.angle) : E2), C2 = e2.allowVerticalPlacement && f2.placedOrientation === t.WritingMode.vertical ? Math.PI / 2 : 0;
              for (let e3 = 0; e3 < f2.numGlyphs; e3++)
                t.addDynamicAttributes(m2, I3, C2);
              h2 && f2.associatedIconIndex >= 0 && (p3[f2.associatedIconIndex] = { shiftedAnchor: I3, angle: C2 });
            } else
              gt(f2.numGlyphs, m2);
          }
          if (h2) {
            _2.clear();
            const i3 = e2.icon.placedSymbolArray;
            for (let e3 = 0; e3 < i3.length; e3++) {
              const o3 = i3.get(e3);
              if (o3.hidden)
                gt(o3.numGlyphs, _2);
              else {
                const i4 = p3[e3];
                if (i4)
                  for (let e4 = 0; e4 < o3.numGlyphs; e4++)
                    t.addDynamicAttributes(_2, i4.shiftedAnchor, i4.angle);
                else
                  gt(o3.numGlyphs, _2);
              }
            }
            e2.icon.dynamicLayoutVertexBuffer.updateData(_2);
          }
          e2.text.dynamicLayoutVertexBuffer.updateData(m2);
        }
        function Mi(t2, e2, i2) {
          return i2.iconsInText && e2 ? "symbolTextAndIcon" : t2 ? "symbolSDF" : "symbolIcon";
        }
        function Ai(e2, i2, o2, a2, r2, s2, n2, l2, c3, h2, u2, d2) {
          const m2 = e2.context, _2 = m2.gl, p3 = e2.transform, f2 = "map" === l2, g2 = "map" === c3, x2 = "viewport" !== l2 && "point" !== o2.layout.get("symbol-placement"), v3 = f2 && !g2 && !x2, y3 = !o2.layout.get("symbol-sort-key").isConstant();
          let b2 = false;
          const w2 = e2.depthModeForSublayer(0, wi.ReadOnly), T2 = o2.layout.get("text-variable-anchor"), E2 = [];
          for (const l3 of a2) {
            const a3 = i2.getTile(l3), c4 = a3.getBucket(o2);
            if (!c4)
              continue;
            const u3 = r2 ? c4.text : c4.icon;
            if (!u3 || !u3.segments.get().length)
              continue;
            const d3 = u3.programConfigurations.get(o2.id), m3 = r2 || c4.sdfIcons, w3 = r2 ? c4.textSizeData : c4.iconSizeData, I3 = g2 || 0 !== p3.pitch, C2 = e2.useProgram(Mi(m3, r2, c4), d3), S2 = t.evaluateSizeForZoom(w3, p3.zoom), D2 = e2.style.terrain && e2.style.terrain.getTerrainData(l3);
            let z2, P2, M2, A3, L2 = [0, 0], R2 = null;
            if (r2) {
              if (P2 = a3.glyphAtlasTexture, M2 = _2.LINEAR, z2 = a3.glyphAtlasTexture.size, c4.iconsInText) {
                L2 = a3.imageAtlasTexture.size, R2 = a3.imageAtlasTexture;
                const t2 = "composite" === w3.kind || "camera" === w3.kind;
                A3 = I3 || e2.options.rotating || e2.options.zooming || t2 ? _2.LINEAR : _2.NEAREST;
              }
            } else {
              const t2 = 1 !== o2.layout.get("icon-size").constantOr(0) || c4.iconsNeedLinear;
              P2 = a3.imageAtlasTexture, M2 = m3 || e2.options.rotating || e2.options.zooming || t2 || I3 ? _2.LINEAR : _2.NEAREST, z2 = a3.imageAtlasTexture.size;
            }
            const k2 = bt(a3, 1, e2.transform.zoom), B2 = rt(l3.posMatrix, g2, f2, e2.transform, k2), F2 = st(l3.posMatrix, g2, f2, e2.transform, k2), O3 = T2 && c4.hasTextData(), U2 = "none" !== o2.layout.get("icon-text-fit") && O3 && c4.hasIconData();
            if (x2) {
              const t2 = e2.style.terrain ? (t3, i4) => e2.style.terrain.getElevation(l3, t3, i4) : null, i3 = "map" === o2.layout.get("text-rotation-alignment");
              ht(c4, l3.posMatrix, e2, r2, B2, F2, g2, h2, i3, t2);
            }
            const N2 = e2.translatePosMatrix(l3.posMatrix, a3, s2, n2), G2 = x2 || r2 && T2 || U2 ? Di : B2, Z3 = e2.translatePosMatrix(F2, a3, s2, n2, true), V3 = m3 && 0 !== o2.paint.get(r2 ? "text-halo-width" : "icon-halo-width").constantOr(1);
            let q2;
            q2 = m3 ? c4.iconsInText ? Me(w3.kind, S2, v3, g2, e2, N2, G2, Z3, z2, L2) : Pe(w3.kind, S2, v3, g2, e2, N2, G2, Z3, r2, z2, true) : ze(w3.kind, S2, v3, g2, e2, N2, G2, Z3, r2, z2);
            const j2 = { program: C2, buffers: u3, uniformValues: q2, atlasTexture: P2, atlasTextureIcon: R2, atlasInterpolation: M2, atlasInterpolationIcon: A3, isSDF: m3, hasHalo: V3 };
            if (y3 && c4.canOverlap) {
              b2 = true;
              const e3 = u3.segments.get();
              for (const i3 of e3)
                E2.push({ segments: new t.SegmentVector([i3]), sortKey: i3.sortKey, state: j2, terrainData: D2 });
            } else
              E2.push({ segments: u3.segments, sortKey: 0, state: j2, terrainData: D2 });
          }
          b2 && E2.sort((t2, e3) => t2.sortKey - e3.sortKey);
          for (const t2 of E2) {
            const i3 = t2.state;
            if (m2.activeTexture.set(_2.TEXTURE0), i3.atlasTexture.bind(i3.atlasInterpolation, _2.CLAMP_TO_EDGE), i3.atlasTextureIcon && (m2.activeTexture.set(_2.TEXTURE1), i3.atlasTextureIcon && i3.atlasTextureIcon.bind(i3.atlasInterpolationIcon, _2.CLAMP_TO_EDGE)), i3.isSDF) {
              const a3 = i3.uniformValues;
              i3.hasHalo && (a3.u_is_halo = 1, Li(i3.buffers, t2.segments, o2, e2, i3.program, w2, u2, d2, a3, t2.terrainData)), a3.u_is_halo = 0;
            }
            Li(i3.buffers, t2.segments, o2, e2, i3.program, w2, u2, d2, i3.uniformValues, t2.terrainData);
          }
        }
        function Li(t2, e2, i2, o2, a2, r2, s2, n2, l2, c3) {
          const h2 = o2.context;
          a2.draw(h2, h2.gl.TRIANGLES, r2, s2, n2, Ii.disabled, l2, c3, i2.id, t2.layoutVertexBuffer, t2.indexBuffer, e2, i2.paint, o2.transform.zoom, t2.programConfigurations.get(i2.id), t2.dynamicLayoutVertexBuffer, t2.opacityVertexBuffer);
        }
        function Ri(t2, e2, i2, o2, a2, r2, s2) {
          const n2 = t2.context.gl, l2 = i2.paint.get("fill-pattern"), c3 = l2 && l2.constantOr(1), h2 = i2.getCrossfadeParameters();
          let u2, d2, m2, _2, p3;
          s2 ? (d2 = c3 && !i2.getPaintProperty("fill-outline-color") ? "fillOutlinePattern" : "fillOutline", u2 = n2.LINES) : (d2 = c3 ? "fillPattern" : "fill", u2 = n2.TRIANGLES);
          for (const f2 of o2) {
            const o3 = e2.getTile(f2);
            if (c3 && !o3.patternsLoaded())
              continue;
            const g2 = o3.getBucket(i2);
            if (!g2)
              continue;
            const x2 = g2.programConfigurations.get(i2.id), v3 = t2.useProgram(d2, x2), y3 = t2.style.terrain && t2.style.terrain.getTerrainData(f2);
            c3 && (t2.context.activeTexture.set(n2.TEXTURE0), o3.imageAtlasTexture.bind(n2.LINEAR, n2.CLAMP_TO_EDGE), x2.updatePaintBuffers(h2));
            const b2 = l2.constantOr(null);
            if (b2 && o3.imageAtlas) {
              const t3 = o3.imageAtlas, e3 = t3.patternPositions[b2.to.toString()], i3 = t3.patternPositions[b2.from.toString()];
              e3 && i3 && x2.setConstantPatternPositions(e3, i3);
            }
            const w2 = y3 ? f2 : null, T2 = t2.translatePosMatrix(w2 ? w2.posMatrix : f2.posMatrix, o3, i2.paint.get("fill-translate"), i2.paint.get("fill-translate-anchor"));
            if (s2) {
              _2 = g2.indexBuffer2, p3 = g2.segments2;
              const e3 = [n2.drawingBufferWidth, n2.drawingBufferHeight];
              m2 = "fillOutlinePattern" === d2 && c3 ? _e(T2, t2, h2, o3, e3) : me(T2, e3);
            } else
              _2 = g2.indexBuffer, p3 = g2.segments, m2 = c3 ? de(T2, t2, h2, o3) : ue(T2);
            v3.draw(t2.context, u2, a2, t2.stencilModeForClipping(f2), r2, Ii.disabled, m2, y3, i2.id, g2.layoutVertexBuffer, _2, p3, i2.paint, t2.transform.zoom, x2);
          }
        }
        function ki(t2, e2, i2, o2, a2, r2, s2) {
          const n2 = t2.context, l2 = n2.gl, c3 = i2.paint.get("fill-extrusion-pattern"), h2 = c3.constantOr(1), u2 = i2.getCrossfadeParameters(), d2 = i2.paint.get("fill-extrusion-opacity");
          for (const m2 of o2) {
            const o3 = e2.getTile(m2), _2 = o3.getBucket(i2);
            if (!_2)
              continue;
            const p3 = t2.style.terrain && t2.style.terrain.getTerrainData(m2), f2 = _2.programConfigurations.get(i2.id), g2 = t2.useProgram(h2 ? "fillExtrusionPattern" : "fillExtrusion", f2);
            h2 && (t2.context.activeTexture.set(l2.TEXTURE0), o3.imageAtlasTexture.bind(l2.LINEAR, l2.CLAMP_TO_EDGE), f2.updatePaintBuffers(u2));
            const x2 = c3.constantOr(null);
            if (x2 && o3.imageAtlas) {
              const t3 = o3.imageAtlas, e3 = t3.patternPositions[x2.to.toString()], i3 = t3.patternPositions[x2.from.toString()];
              e3 && i3 && f2.setConstantPatternPositions(e3, i3);
            }
            const v3 = t2.translatePosMatrix(m2.posMatrix, o3, i2.paint.get("fill-extrusion-translate"), i2.paint.get("fill-extrusion-translate-anchor")), y3 = i2.paint.get("fill-extrusion-vertical-gradient"), b2 = h2 ? he(v3, t2, y3, d2, m2, u2, o3) : ce(v3, t2, y3, d2);
            g2.draw(n2, n2.gl.TRIANGLES, a2, r2, s2, Ii.backCCW, b2, p3, i2.id, _2.layoutVertexBuffer, _2.indexBuffer, _2.segments, i2.paint, t2.transform.zoom, f2, t2.style.terrain && _2.centroidVertexBuffer);
          }
        }
        function Bi(t2, e2, i2, o2, a2, r2, s2) {
          const n2 = t2.context, l2 = n2.gl, c3 = i2.fbo;
          if (!c3)
            return;
          const h2 = t2.useProgram("hillshade"), u2 = t2.style.terrain && t2.style.terrain.getTerrainData(e2);
          n2.activeTexture.set(l2.TEXTURE0), l2.bindTexture(l2.TEXTURE_2D, c3.colorAttachment.get()), h2.draw(n2, l2.TRIANGLES, a2, r2, s2, Ii.disabled, ((t3, e3, i3, o3) => {
            const a3 = i3.paint.get("hillshade-shadow-color"), r3 = i3.paint.get("hillshade-highlight-color"), s3 = i3.paint.get("hillshade-accent-color");
            let n3 = i3.paint.get("hillshade-illumination-direction") * (Math.PI / 180);
            "viewport" === i3.paint.get("hillshade-illumination-anchor") && (n3 -= t3.transform.angle);
            const l3 = !t3.options.moving;
            return { u_matrix: o3 ? o3.posMatrix : t3.transform.calculatePosMatrix(e3.tileID.toUnwrapped(), l3), u_image: 0, u_latrange: ye(0, e3.tileID), u_light: [i3.paint.get("hillshade-exaggeration"), n3], u_shadow: a3, u_highlight: r3, u_accent: s3 };
          })(t2, i2, o2, u2 ? e2 : null), u2, o2.id, t2.rasterBoundsBuffer, t2.quadTriangleIndexBuffer, t2.rasterBoundsSegments);
        }
        function Fi(e2, i2, o2, a2, r2, s2) {
          const n2 = e2.context, c3 = n2.gl, h2 = i2.dem;
          if (h2 && h2.data) {
            const u2 = h2.dim, d2 = h2.stride, m2 = h2.getPixels();
            if (n2.activeTexture.set(c3.TEXTURE1), n2.pixelStoreUnpackPremultiplyAlpha.set(false), i2.demTexture = i2.demTexture || e2.getTileTexture(d2), i2.demTexture) {
              const t2 = i2.demTexture;
              t2.update(m2, { premultiply: false }), t2.bind(c3.NEAREST, c3.CLAMP_TO_EDGE);
            } else
              i2.demTexture = new l(n2, m2, c3.RGBA, { premultiply: false }), i2.demTexture.bind(c3.NEAREST, c3.CLAMP_TO_EDGE);
            n2.activeTexture.set(c3.TEXTURE0);
            let _2 = i2.fbo;
            if (!_2) {
              const t2 = new l(n2, { width: u2, height: u2, data: null }, c3.RGBA);
              t2.bind(c3.LINEAR, c3.CLAMP_TO_EDGE), _2 = i2.fbo = n2.createFramebuffer(u2, u2, true), _2.colorAttachment.set(t2.texture);
            }
            n2.bindFramebuffer.set(_2.framebuffer), n2.viewport.set([0, 0, u2, u2]), e2.useProgram("hillshadePrepare").draw(n2, c3.TRIANGLES, a2, r2, s2, Ii.disabled, ((e3, i3) => {
              const o3 = i3.stride, a3 = t.create();
              return t.ortho(a3, 0, t.EXTENT, -t.EXTENT, 0, 0, 1), t.translate(a3, a3, [0, -t.EXTENT, 0]), { u_matrix: a3, u_image: 1, u_dimension: [o3, o3], u_zoom: e3.overscaledZ, u_unpack: i3.getUnpackVector() };
            })(i2.tileID, h2), null, o2.id, e2.rasterBoundsBuffer, e2.quadTriangleIndexBuffer, e2.rasterBoundsSegments), i2.needsHillshadePrepare = false;
          }
        }
        function Oi(e2, i2, o2, a2, r2, s2) {
          const n2 = a2.paint.get("raster-fade-duration");
          if (!s2 && n2 > 0) {
            const a3 = t.exported.now(), s3 = (a3 - e2.timeAdded) / n2, l2 = i2 ? (a3 - i2.timeAdded) / n2 : -1, c3 = o2.getSource(), h2 = r2.coveringZoomLevel({ tileSize: c3.tileSize, roundZoom: c3.roundZoom }), u2 = !i2 || Math.abs(i2.tileID.overscaledZ - h2) > Math.abs(e2.tileID.overscaledZ - h2), d2 = u2 && e2.refreshedUponExpiration ? 1 : t.clamp(u2 ? s3 : 1 - l2, 0, 1);
            return e2.refreshedUponExpiration && s3 >= 1 && (e2.refreshedUponExpiration = false), i2 ? { opacity: 1, mix: 1 - d2 } : { opacity: d2, mix: 0 };
          }
          return { opacity: 1, mix: 0 };
        }
        const Ui = new t.Color(1, 0, 0, 1), Ni = new t.Color(0, 1, 0, 1), Gi = new t.Color(0, 0, 1, 1), Zi = new t.Color(1, 0, 1, 1), Vi = new t.Color(0, 1, 1, 1);
        function qi(t2, e2, i2, o2) {
          $i(t2, 0, e2 + i2 / 2, t2.transform.width, i2, o2);
        }
        function ji(t2, e2, i2, o2) {
          $i(t2, e2 - i2 / 2, 0, i2, t2.transform.height, o2);
        }
        function $i(t2, e2, i2, o2, a2, r2) {
          const s2 = t2.context, n2 = s2.gl;
          n2.enable(n2.SCISSOR_TEST), n2.scissor(e2 * t2.pixelRatio, i2 * t2.pixelRatio, o2 * t2.pixelRatio, a2 * t2.pixelRatio), s2.clear({ color: r2 }), n2.disable(n2.SCISSOR_TEST);
        }
        function Xi(e2, i2, o2) {
          const a2 = e2.context, r2 = a2.gl, s2 = o2.posMatrix, n2 = e2.useProgram("debug"), l2 = wi.disabled, c3 = Ei.disabled, h2 = e2.colorModeForRenderPass(), u2 = "$debug", d2 = e2.style.terrain && e2.style.terrain.getTerrainData(o2);
          a2.activeTexture.set(r2.TEXTURE0), e2.emptyTexture.bind(r2.LINEAR, r2.CLAMP_TO_EDGE);
          const m2 = i2.getTileByID(o2.key).latestRawTileData, _2 = Math.floor((m2 && m2.byteLength || 0) / 1024), p3 = i2.getTile(o2).tileSize, f2 = 512 / Math.min(p3, 512) * (o2.overscaledZ / e2.transform.zoom) * 0.5;
          let g2 = o2.canonical.toString();
          o2.overscaledZ !== o2.canonical.z && (g2 += ` => ${o2.overscaledZ}`), function(t2, e3) {
            t2.initDebugOverlayCanvas();
            const i3 = t2.debugOverlayCanvas, o3 = t2.context.gl, a3 = t2.debugOverlayCanvas.getContext("2d");
            a3.clearRect(0, 0, i3.width, i3.height), a3.shadowColor = "white", a3.shadowBlur = 2, a3.lineWidth = 1.5, a3.strokeStyle = "white", a3.textBaseline = "top", a3.font = "bold 36px Open Sans, sans-serif", a3.fillText(e3, 5, 5), a3.strokeText(e3, 5, 5), t2.debugOverlayTexture.update(i3), t2.debugOverlayTexture.bind(o3.LINEAR, o3.CLAMP_TO_EDGE);
          }(e2, `${g2} ${_2}kB`), n2.draw(a2, r2.TRIANGLES, l2, c3, yi.alphaBlended, Ii.disabled, ge(s2, t.Color.transparent, f2), null, u2, e2.debugBuffer, e2.quadTriangleIndexBuffer, e2.debugSegments), n2.draw(a2, r2.LINE_STRIP, l2, c3, h2, Ii.disabled, ge(s2, t.Color.red), d2, u2, e2.debugBuffer, e2.tileBorderIndexBuffer, e2.debugSegments);
        }
        function Wi(t2, e2, i2) {
          const o2 = t2.context, a2 = o2.gl, r2 = t2.colorModeForRenderPass(), s2 = new wi(a2.LEQUAL, wi.ReadWrite, t2.depthRangeFor3D), n2 = t2.useProgram("terrain"), l2 = e2.getTerrainMesh(), c3 = e2.getTerrainData(i2.tileID);
          o2.bindFramebuffer.set(null), o2.viewport.set([0, 0, t2.width, t2.height]), o2.activeTexture.set(a2.TEXTURE0), a2.bindTexture(a2.TEXTURE_2D, e2.getRTTFramebuffer().colorAttachment.get());
          const h2 = t2.transform.calculatePosMatrix(i2.tileID.toUnwrapped());
          n2.draw(o2, a2.TRIANGLES, s2, Ei.disabled, r2, Ii.backCCW, { u_matrix: h2, u_texture: 0 }, c3, "terrain", l2.vertexBuffer, l2.indexBuffer, l2.segments);
        }
        function Hi(t2, e2, i2, o2) {
          const a2 = t2.context, r2 = i2.tileSize * e2.qualityFactor;
          i2.textures[o2] || (i2.textures[o2] = t2.getTileTexture(r2) || new l(a2, { width: r2, height: r2, data: null }, a2.gl.RGBA), i2.textures[o2].bind(a2.gl.LINEAR, a2.gl.CLAMP_TO_EDGE), 0 === o2 && e2.sourceCache.renderHistory.unshift(i2.tileID.key));
          const s2 = e2.getRTTFramebuffer();
          s2.colorAttachment.set(i2.textures[o2].texture), a2.bindFramebuffer.set(s2.framebuffer), a2.viewport.set([0, 0, r2, r2]);
        }
        class Ki {
          constructor(t2) {
            this._coordsDescendingInv = {}, this._coordsDescendingInvStr = {}, this.painter = t2, this._renderToTexture = { background: true, fill: true, line: true, raster: true }, this._coordsDescendingInv = {}, this._coordsDescendingInvStr = {}, this._stacks = [], this._prevType = null, this._rerender = {}, this._renderableTiles = t2.style.terrain.sourceCache.getRenderableTiles(), this._init();
          }
          _init() {
            const t2 = this.painter.style, e2 = t2.terrain;
            for (const i2 in t2.sourceCaches) {
              this._coordsDescendingInv[i2] = {};
              const o2 = t2.sourceCaches[i2].getVisibleCoordinates();
              for (const t3 of o2) {
                const o3 = e2.sourceCache.getTerrainCoords(t3);
                for (const t4 in o3)
                  this._coordsDescendingInv[i2][t4] || (this._coordsDescendingInv[i2][t4] = []), this._coordsDescendingInv[i2][t4].push(o3[t4]);
              }
            }
            for (const e3 of t2._order) {
              const i2 = t2._layers[e3], o2 = i2.source;
              if (this._renderToTexture[i2.type] && !this._coordsDescendingInvStr[o2]) {
                this._coordsDescendingInvStr[o2] = {};
                for (const t3 in this._coordsDescendingInv[o2])
                  this._coordsDescendingInvStr[o2][t3] = this._coordsDescendingInv[o2][t3].map((t4) => t4.key).sort().join();
              }
            }
            return this._renderableTiles.forEach((t3) => {
              for (const i2 in this._coordsDescendingInvStr) {
                const o2 = this._coordsDescendingInvStr[i2][t3.tileID.key];
                o2 && o2 !== t3.textureCoords[i2] && t3.clearTextures(this.painter), e2.needsRerender(i2, t3.tileID) && t3.clearTextures(this.painter);
              }
              this._rerender[t3.tileID.key] = !t3.textures.length;
            }), e2.clearRerenderCache(), e2.sourceCache.removeOutdated(this.painter), this;
          }
          renderLayer(e2) {
            const i2 = e2.type, o2 = this.painter, a2 = o2.style._order, r2 = o2.currentLayer, s2 = r2 + 1 === a2.length;
            if (this._renderToTexture[i2] && (this._prevType && this._renderToTexture[this._prevType] || this._stacks.push([]), this._prevType = i2, this._stacks[this._stacks.length - 1].push(a2[r2]), !s2))
              return true;
            if (this._renderToTexture[this._prevType] || "hillshade" === i2 || this._renderToTexture[i2] && s2) {
              this._prevType = i2;
              const s3 = this._stacks.length - 1, n2 = this._stacks[s3] || [];
              for (const e3 of this._renderableTiles) {
                if (Hi(o2, o2.style.terrain, e3, s3), this._rerender[e3.tileID.key]) {
                  o2.context.clear({ color: t.Color.transparent });
                  for (let t2 = 0; t2 < n2.length; t2++) {
                    const i3 = o2.style._layers[n2[t2]], a3 = i3.source ? this._coordsDescendingInv[i3.source][e3.tileID.key] : [e3.tileID];
                    o2._renderTileClippingMasks(i3, a3), o2.renderLayer(o2, o2.style.sourceCaches[i3.source], i3, a3), i3.source && (e3.textureCoords[i3.source] = this._coordsDescendingInvStr[i3.source][e3.tileID.key]);
                  }
                }
                Wi(o2, o2.style.terrain, e3);
              }
              if ("hillshade" === i2) {
                this._stacks.push([a2[r2]]);
                for (const i3 of this._renderableTiles) {
                  const a3 = this._coordsDescendingInv[e2.source][i3.tileID.key];
                  Hi(o2, o2.style.terrain, i3, this._stacks.length - 1), o2.context.clear({ color: t.Color.transparent }), o2._renderTileClippingMasks(e2, a3), o2.renderLayer(o2, o2.style.sourceCaches[e2.source], e2, a3), Wi(o2, o2.style.terrain, i3);
                }
                return true;
              }
              return this._renderToTexture[i2];
            }
            return false;
          }
        }
        const Yi = { symbol: function(e2, i2, o2, a2, r2) {
          if ("translucent" !== e2.renderPass)
            return;
          const s2 = Ei.disabled, n2 = e2.colorModeForRenderPass();
          o2.layout.get("text-variable-anchor") && function(e3, i3, o3, a3, r3, s3, n3) {
            const l2 = i3.transform, c3 = "map" === r3, h2 = "map" === s3;
            for (const r4 of e3) {
              const e4 = a3.getTile(r4), s4 = e4.getBucket(o3);
              if (!s4 || !s4.text || !s4.text.segments.get().length)
                continue;
              const u2 = t.evaluateSizeForZoom(s4.textSizeData, l2.zoom), d2 = bt(e4, 1, i3.transform.zoom), m2 = rt(r4.posMatrix, h2, c3, i3.transform, d2), _2 = "none" !== o3.layout.get("icon-text-fit") && s4.hasIconData();
              if (u2) {
                const t2 = Math.pow(2, l2.zoom - e4.tileID.overscaledZ);
                Pi(s4, c3, h2, n3, l2, m2, r4.posMatrix, t2, u2, _2, i3.style.terrain ? (t3, e5) => i3.style.terrain.getElevation(r4, t3, e5) : null);
              }
            }
          }(a2, e2, o2, i2, o2.layout.get("text-rotation-alignment"), o2.layout.get("text-pitch-alignment"), r2), 0 !== o2.paint.get("icon-opacity").constantOr(1) && Ai(e2, i2, o2, a2, false, o2.paint.get("icon-translate"), o2.paint.get("icon-translate-anchor"), o2.layout.get("icon-rotation-alignment"), o2.layout.get("icon-pitch-alignment"), o2.layout.get("icon-keep-upright"), s2, n2), 0 !== o2.paint.get("text-opacity").constantOr(1) && Ai(e2, i2, o2, a2, true, o2.paint.get("text-translate"), o2.paint.get("text-translate-anchor"), o2.layout.get("text-rotation-alignment"), o2.layout.get("text-pitch-alignment"), o2.layout.get("text-keep-upright"), s2, n2), i2.map.showCollisionBoxes && (Si(e2, i2, o2, a2, o2.paint.get("text-translate"), o2.paint.get("text-translate-anchor"), true), Si(e2, i2, o2, a2, o2.paint.get("icon-translate"), o2.paint.get("icon-translate-anchor"), false));
        }, circle: function(e2, i2, o2, a2) {
          if ("translucent" !== e2.renderPass)
            return;
          const r2 = o2.paint.get("circle-opacity"), s2 = o2.paint.get("circle-stroke-width"), n2 = o2.paint.get("circle-stroke-opacity"), l2 = !o2.layout.get("circle-sort-key").isConstant();
          if (0 === r2.constantOr(1) && (0 === s2.constantOr(1) || 0 === n2.constantOr(1)))
            return;
          const c3 = e2.context, h2 = c3.gl, u2 = e2.depthModeForSublayer(0, wi.ReadOnly), d2 = Ei.disabled, m2 = e2.colorModeForRenderPass(), _2 = [];
          for (let r3 = 0; r3 < a2.length; r3++) {
            const s3 = a2[r3], n3 = i2.getTile(s3), c4 = n3.getBucket(o2);
            if (!c4)
              continue;
            const h3 = c4.programConfigurations.get(o2.id), u3 = e2.useProgram("circle", h3), d3 = c4.layoutVertexBuffer, m3 = c4.indexBuffer, p3 = e2.style.terrain && e2.style.terrain.getTerrainData(s3), f2 = { programConfiguration: h3, program: u3, layoutVertexBuffer: d3, indexBuffer: m3, uniformValues: pe(e2, s3, n3, o2), terrainData: p3 };
            if (l2) {
              const e3 = c4.segments.get();
              for (const i3 of e3)
                _2.push({ segments: new t.SegmentVector([i3]), sortKey: i3.sortKey, state: f2 });
            } else
              _2.push({ segments: c4.segments, sortKey: 0, state: f2 });
          }
          l2 && _2.sort((t2, e3) => t2.sortKey - e3.sortKey);
          for (const t2 of _2) {
            const { programConfiguration: i3, program: a3, layoutVertexBuffer: r3, indexBuffer: s3, uniformValues: n3, terrainData: l3 } = t2.state;
            a3.draw(c3, h2.TRIANGLES, u2, d2, m2, Ii.disabled, n3, l3, o2.id, r3, s3, t2.segments, o2.paint, e2.transform.zoom, i3);
          }
        }, heatmap: function(e2, i2, o2, a2) {
          if (0 !== o2.paint.get("heatmap-opacity"))
            if ("offscreen" === e2.renderPass) {
              const r2 = e2.context, s2 = r2.gl, n2 = Ei.disabled, l2 = new yi([s2.ONE, s2.ONE], t.Color.transparent, [true, true, true, true]);
              !function(t2, e3, i3) {
                const o3 = t2.gl;
                t2.activeTexture.set(o3.TEXTURE1), t2.viewport.set([0, 0, e3.width / 4, e3.height / 4]);
                let a3 = i3.heatmapFbo;
                if (a3)
                  o3.bindTexture(o3.TEXTURE_2D, a3.colorAttachment.get()), t2.bindFramebuffer.set(a3.framebuffer);
                else {
                  const r3 = o3.createTexture();
                  o3.bindTexture(o3.TEXTURE_2D, r3), o3.texParameteri(o3.TEXTURE_2D, o3.TEXTURE_WRAP_S, o3.CLAMP_TO_EDGE), o3.texParameteri(o3.TEXTURE_2D, o3.TEXTURE_WRAP_T, o3.CLAMP_TO_EDGE), o3.texParameteri(o3.TEXTURE_2D, o3.TEXTURE_MIN_FILTER, o3.LINEAR), o3.texParameteri(o3.TEXTURE_2D, o3.TEXTURE_MAG_FILTER, o3.LINEAR), a3 = i3.heatmapFbo = t2.createFramebuffer(e3.width / 4, e3.height / 4, false), function(t3, e4, i4, o4) {
                    const a4 = t3.gl;
                    a4.texImage2D(a4.TEXTURE_2D, 0, a4.RGBA, e4.width / 4, e4.height / 4, 0, a4.RGBA, t3.extRenderToTextureHalfFloat ? t3.extTextureHalfFloat.HALF_FLOAT_OES : a4.UNSIGNED_BYTE, null), o4.colorAttachment.set(i4);
                  }(t2, e3, r3, a3);
                }
              }(r2, e2, o2), r2.clear({ color: t.Color.transparent });
              for (let t2 = 0; t2 < a2.length; t2++) {
                const c3 = a2[t2];
                if (i2.hasRenderableParent(c3))
                  continue;
                const h2 = i2.getTile(c3), u2 = h2.getBucket(o2);
                if (!u2)
                  continue;
                const d2 = u2.programConfigurations.get(o2.id), m2 = e2.useProgram("heatmap", d2), { zoom: _2 } = e2.transform;
                m2.draw(r2, s2.TRIANGLES, wi.disabled, n2, l2, Ii.disabled, ve(c3.posMatrix, h2, _2, o2.paint.get("heatmap-intensity")), null, o2.id, u2.layoutVertexBuffer, u2.indexBuffer, u2.segments, o2.paint, e2.transform.zoom, d2);
              }
              r2.viewport.set([0, 0, e2.width, e2.height]);
            } else
              "translucent" === e2.renderPass && (e2.context.setColorMode(e2.colorModeForRenderPass()), function(e3, i3) {
                const o3 = e3.context, a3 = o3.gl, r2 = i3.heatmapFbo;
                if (!r2)
                  return;
                o3.activeTexture.set(a3.TEXTURE0), a3.bindTexture(a3.TEXTURE_2D, r2.colorAttachment.get()), o3.activeTexture.set(a3.TEXTURE1);
                let s2 = i3.colorRampTexture;
                s2 || (s2 = i3.colorRampTexture = new l(o3, i3.colorRamp, a3.RGBA)), s2.bind(a3.LINEAR, a3.CLAMP_TO_EDGE), e3.useProgram("heatmapTexture").draw(o3, a3.TRIANGLES, wi.disabled, Ei.disabled, e3.colorModeForRenderPass(), Ii.disabled, ((e4, i4, o4, a4) => {
                  const r3 = t.create();
                  t.ortho(r3, 0, e4.width, e4.height, 0, 0, 1);
                  const s3 = e4.context.gl;
                  return { u_matrix: r3, u_world: [s3.drawingBufferWidth, s3.drawingBufferHeight], u_image: 0, u_color_ramp: 1, u_opacity: i4.paint.get("heatmap-opacity") };
                })(e3, i3), null, i3.id, e3.viewportBuffer, e3.quadTriangleIndexBuffer, e3.viewportSegments, i3.paint, e3.transform.zoom);
              }(e2, o2));
        }, line: function(e2, i2, o2, a2) {
          if ("translucent" !== e2.renderPass)
            return;
          const r2 = o2.paint.get("line-opacity"), s2 = o2.paint.get("line-width");
          if (0 === r2.constantOr(1) || 0 === s2.constantOr(1))
            return;
          const n2 = e2.depthModeForSublayer(0, wi.ReadOnly), c3 = e2.colorModeForRenderPass(), h2 = o2.paint.get("line-dasharray"), u2 = o2.paint.get("line-pattern"), d2 = u2.constantOr(1), m2 = o2.paint.get("line-gradient"), _2 = o2.getCrossfadeParameters(), p3 = d2 ? "linePattern" : h2 ? "lineSDF" : m2 ? "lineGradient" : "line", f2 = e2.context, g2 = f2.gl;
          let x2 = true;
          for (const r3 of a2) {
            const a3 = i2.getTile(r3);
            if (d2 && !a3.patternsLoaded())
              continue;
            const s3 = a3.getBucket(o2);
            if (!s3)
              continue;
            const v3 = s3.programConfigurations.get(o2.id), y3 = e2.context.program.get(), b2 = e2.useProgram(p3, v3), w2 = x2 || b2.program !== y3, T2 = e2.style.terrain && e2.style.terrain.getTerrainData(r3), E2 = u2.constantOr(null);
            if (E2 && a3.imageAtlas) {
              const t2 = a3.imageAtlas, e3 = t2.patternPositions[E2.to.toString()], i3 = t2.patternPositions[E2.from.toString()];
              e3 && i3 && v3.setConstantPatternPositions(e3, i3);
            }
            const I3 = T2 ? r3 : null, C2 = d2 ? Te(e2, a3, o2, _2, I3) : h2 ? Ee(e2, a3, o2, h2, _2, I3) : m2 ? we(e2, a3, o2, s3.lineClipsArray.length, I3) : be(e2, a3, o2, I3);
            if (d2)
              f2.activeTexture.set(g2.TEXTURE0), a3.imageAtlasTexture.bind(g2.LINEAR, g2.CLAMP_TO_EDGE), v3.updatePaintBuffers(_2);
            else if (h2 && (w2 || e2.lineAtlas.dirty))
              f2.activeTexture.set(g2.TEXTURE0), e2.lineAtlas.bind(f2);
            else if (m2) {
              const a4 = s3.gradients[o2.id];
              let n3 = a4.texture;
              if (o2.gradientVersion !== a4.version) {
                let c4 = 256;
                if (o2.stepInterpolant) {
                  const o3 = i2.getSource().maxzoom, a5 = r3.canonical.z === o3 ? Math.ceil(1 << e2.transform.maxZoom - r3.canonical.z) : 1;
                  c4 = t.clamp(t.nextPowerOfTwo(s3.maxLineLength / t.EXTENT * 1024 * a5), 256, f2.maxTextureSize);
                }
                a4.gradient = t.renderColorRamp({ expression: o2.gradientExpression(), evaluationKey: "lineProgress", resolution: c4, image: a4.gradient || void 0, clips: s3.lineClipsArray }), a4.texture ? a4.texture.update(a4.gradient) : a4.texture = new l(f2, a4.gradient, g2.RGBA), a4.version = o2.gradientVersion, n3 = a4.texture;
              }
              f2.activeTexture.set(g2.TEXTURE0), n3.bind(o2.stepInterpolant ? g2.NEAREST : g2.LINEAR, g2.CLAMP_TO_EDGE);
            }
            b2.draw(f2, g2.TRIANGLES, n2, e2.stencilModeForClipping(r3), c3, Ii.disabled, C2, T2, o2.id, s3.layoutVertexBuffer, s3.indexBuffer, s3.segments, o2.paint, e2.transform.zoom, v3, s3.layoutVertexBuffer2), x2 = false;
          }
        }, fill: function(e2, i2, o2, a2) {
          const r2 = o2.paint.get("fill-color"), s2 = o2.paint.get("fill-opacity");
          if (0 === s2.constantOr(1))
            return;
          const n2 = e2.colorModeForRenderPass(), l2 = o2.paint.get("fill-pattern"), c3 = e2.opaquePassEnabledForLayer() && !l2.constantOr(1) && 1 === r2.constantOr(t.Color.transparent).a && 1 === s2.constantOr(0) ? "opaque" : "translucent";
          if (e2.renderPass === c3) {
            const t2 = e2.depthModeForSublayer(1, "opaque" === e2.renderPass ? wi.ReadWrite : wi.ReadOnly);
            Ri(e2, i2, o2, a2, t2, n2, false);
          }
          if ("translucent" === e2.renderPass && o2.paint.get("fill-antialias")) {
            const t2 = e2.depthModeForSublayer(o2.getPaintProperty("fill-outline-color") ? 2 : 0, wi.ReadOnly);
            Ri(e2, i2, o2, a2, t2, n2, true);
          }
        }, "fill-extrusion": function(t2, e2, i2, o2) {
          const a2 = i2.paint.get("fill-extrusion-opacity");
          if (0 !== a2 && "translucent" === t2.renderPass) {
            const r2 = new wi(t2.context.gl.LEQUAL, wi.ReadWrite, t2.depthRangeFor3D);
            if (1 !== a2 || i2.paint.get("fill-extrusion-pattern").constantOr(1))
              ki(t2, e2, i2, o2, r2, Ei.disabled, yi.disabled), ki(t2, e2, i2, o2, r2, t2.stencilModeFor3D(), t2.colorModeForRenderPass());
            else {
              const a3 = t2.colorModeForRenderPass();
              ki(t2, e2, i2, o2, r2, Ei.disabled, a3);
            }
          }
        }, hillshade: function(t2, e2, i2, o2) {
          if ("offscreen" !== t2.renderPass && "translucent" !== t2.renderPass)
            return;
          const a2 = t2.context, r2 = t2.depthModeForSublayer(0, wi.ReadOnly), s2 = t2.colorModeForRenderPass(), [n2, l2] = "translucent" === t2.renderPass ? t2.stencilConfigForOverlap(o2) : [{}, o2];
          for (const o3 of l2) {
            const a3 = e2.getTile(o3);
            void 0 !== a3.needsHillshadePrepare && a3.needsHillshadePrepare && "offscreen" === t2.renderPass ? Fi(t2, a3, i2, r2, Ei.disabled, s2) : "translucent" === t2.renderPass && Bi(t2, o3, a3, i2, r2, n2[o3.overscaledZ], s2);
          }
          a2.viewport.set([0, 0, t2.width, t2.height]);
        }, raster: function(t2, e2, i2, o2) {
          if ("translucent" !== t2.renderPass)
            return;
          if (0 === i2.paint.get("raster-opacity"))
            return;
          if (!o2.length)
            return;
          const a2 = t2.context, r2 = a2.gl, s2 = e2.getSource(), n2 = t2.useProgram("raster"), l2 = t2.colorModeForRenderPass(), [c3, h2] = s2 instanceof D ? [{}, o2] : t2.stencilConfigForOverlap(o2), u2 = h2[h2.length - 1].overscaledZ, d2 = !t2.options.moving;
          for (const o3 of h2) {
            const h3 = t2.depthModeForSublayer(o3.overscaledZ - u2, 1 === i2.paint.get("raster-opacity") ? wi.ReadWrite : wi.ReadOnly, r2.LESS), m2 = e2.getTile(o3);
            m2.registerFadeDuration(i2.paint.get("raster-fade-duration"));
            const _2 = e2.findLoadedParent(o3, 0), p3 = Oi(m2, _2, e2, i2, t2.transform, t2.style.terrain);
            let f2, g2;
            const x2 = "nearest" === i2.paint.get("raster-resampling") ? r2.NEAREST : r2.LINEAR;
            a2.activeTexture.set(r2.TEXTURE0), m2.texture.bind(x2, r2.CLAMP_TO_EDGE, r2.LINEAR_MIPMAP_NEAREST), a2.activeTexture.set(r2.TEXTURE1), _2 ? (_2.texture.bind(x2, r2.CLAMP_TO_EDGE, r2.LINEAR_MIPMAP_NEAREST), f2 = Math.pow(2, _2.tileID.overscaledZ - m2.tileID.overscaledZ), g2 = [m2.tileID.canonical.x * f2 % 1, m2.tileID.canonical.y * f2 % 1]) : m2.texture.bind(x2, r2.CLAMP_TO_EDGE, r2.LINEAR_MIPMAP_NEAREST);
            const v3 = t2.style.terrain && t2.style.terrain.getTerrainData(o3), y3 = v3 ? o3 : null, b2 = y3 ? y3.posMatrix : t2.transform.calculatePosMatrix(o3.toUnwrapped(), d2), w2 = Se(b2, g2 || [0, 0], f2 || 1, p3, i2);
            s2 instanceof D ? n2.draw(a2, r2.TRIANGLES, h3, Ei.disabled, l2, Ii.disabled, w2, v3, i2.id, s2.boundsBuffer, t2.quadTriangleIndexBuffer, s2.boundsSegments) : n2.draw(a2, r2.TRIANGLES, h3, c3[o3.overscaledZ], l2, Ii.disabled, w2, v3, i2.id, t2.rasterBoundsBuffer, t2.quadTriangleIndexBuffer, t2.rasterBoundsSegments);
          }
        }, background: function(t2, e2, i2, o2) {
          const a2 = i2.paint.get("background-color"), r2 = i2.paint.get("background-opacity");
          if (0 === r2)
            return;
          const s2 = t2.context, n2 = s2.gl, l2 = t2.transform, c3 = l2.tileSize, h2 = i2.paint.get("background-pattern");
          if (t2.isPatternMissing(h2))
            return;
          const u2 = !h2 && 1 === a2.a && 1 === r2 && t2.opaquePassEnabledForLayer() ? "opaque" : "translucent";
          if (t2.renderPass !== u2)
            return;
          const d2 = Ei.disabled, m2 = t2.depthModeForSublayer(0, "opaque" === u2 ? wi.ReadWrite : wi.ReadOnly), _2 = t2.colorModeForRenderPass(), p3 = t2.useProgram(h2 ? "backgroundPattern" : "background"), f2 = o2 || l2.coveringTiles({ tileSize: c3, terrain: t2.style.terrain });
          h2 && (s2.activeTexture.set(n2.TEXTURE0), t2.imageManager.bind(t2.context));
          const g2 = i2.getCrossfadeParameters();
          for (const e3 of f2) {
            const l3 = o2 ? e3.posMatrix : t2.transform.calculatePosMatrix(e3.toUnwrapped()), u3 = h2 ? Le(l3, r2, t2, h2, { tileID: e3, tileSize: c3 }, g2) : Ae(l3, r2, a2), f3 = t2.style.terrain && t2.style.terrain.getTerrainData(e3);
            p3.draw(s2, n2.TRIANGLES, m2, d2, _2, Ii.disabled, u3, f3, i2.id, t2.tileExtentBuffer, t2.quadTriangleIndexBuffer, t2.tileExtentSegments);
          }
        }, debug: function(t2, e2, i2) {
          for (let o2 = 0; o2 < i2.length; o2++)
            Xi(t2, e2, i2[o2]);
        }, custom: function(t2, e2, i2) {
          const o2 = t2.context, a2 = i2.implementation;
          if ("offscreen" === t2.renderPass) {
            const e3 = a2.prerender;
            e3 && (t2.setCustomLayerDefaults(), o2.setColorMode(t2.colorModeForRenderPass()), e3.call(a2, o2.gl, t2.transform.customLayerMatrix()), o2.setDirty(), t2.setBaseState());
          } else if ("translucent" === t2.renderPass) {
            t2.setCustomLayerDefaults(), o2.setColorMode(t2.colorModeForRenderPass()), o2.setStencilMode(Ei.disabled);
            const e3 = "3d" === a2.renderingMode ? new wi(t2.context.gl.LEQUAL, wi.ReadWrite, t2.depthRangeFor3D) : t2.depthModeForSublayer(0, wi.ReadOnly);
            o2.setDepthMode(e3), a2.render(o2.gl, t2.transform.customLayerMatrix()), o2.setDirty(), t2.setBaseState(), o2.bindFramebuffer.set(null);
          }
        } };
        class Ji {
          constructor(e2, i2) {
            this.context = new bi(e2), this.transform = i2, this._tileTextures = {}, this.terrainFacilitator = { dirty: true, matrix: t.create(), renderTime: 0 }, this.setup(), this.numSublayers = O2.maxUnderzooming + O2.maxOverzooming + 1, this.depthEpsilon = 1 / Math.pow(2, 16), this.crossTileSymbolIndex = new Xt(), this.gpuTimers = {};
          }
          resize(t2, e2, i2) {
            if (this.width = t2 * i2, this.height = e2 * i2, this.pixelRatio = i2, this.context.viewport.set([0, 0, this.width, this.height]), this.style)
              for (const t3 of this.style._order)
                this.style._layers[t3].resize();
          }
          setup() {
            const e2 = this.context, i2 = new t.PosArray();
            i2.emplaceBack(0, 0), i2.emplaceBack(t.EXTENT, 0), i2.emplaceBack(0, t.EXTENT), i2.emplaceBack(t.EXTENT, t.EXTENT), this.tileExtentBuffer = e2.createVertexBuffer(i2, Wt.members), this.tileExtentSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2);
            const o2 = new t.PosArray();
            o2.emplaceBack(0, 0), o2.emplaceBack(t.EXTENT, 0), o2.emplaceBack(0, t.EXTENT), o2.emplaceBack(t.EXTENT, t.EXTENT), this.debugBuffer = e2.createVertexBuffer(o2, Wt.members), this.debugSegments = t.SegmentVector.simpleSegment(0, 0, 4, 5);
            const a2 = new t.RasterBoundsArray();
            a2.emplaceBack(0, 0, 0, 0), a2.emplaceBack(t.EXTENT, 0, t.EXTENT, 0), a2.emplaceBack(0, t.EXTENT, 0, t.EXTENT), a2.emplaceBack(t.EXTENT, t.EXTENT, t.EXTENT, t.EXTENT), this.rasterBoundsBuffer = e2.createVertexBuffer(a2, S.members), this.rasterBoundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2);
            const r2 = new t.PosArray();
            r2.emplaceBack(0, 0), r2.emplaceBack(1, 0), r2.emplaceBack(0, 1), r2.emplaceBack(1, 1), this.viewportBuffer = e2.createVertexBuffer(r2, Wt.members), this.viewportSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2);
            const s2 = new t.LineStripIndexArray();
            s2.emplaceBack(0), s2.emplaceBack(1), s2.emplaceBack(3), s2.emplaceBack(2), s2.emplaceBack(0), this.tileBorderIndexBuffer = e2.createIndexBuffer(s2);
            const n2 = new t.TriangleIndexArray();
            n2.emplaceBack(0, 1, 2), n2.emplaceBack(2, 1, 3), this.quadTriangleIndexBuffer = e2.createIndexBuffer(n2), this.emptyTexture = new l(e2, { width: 1, height: 1, data: new Uint8Array([0, 0, 0, 0]) }, e2.gl.RGBA);
            const c3 = this.context.gl;
            this.stencilClearMode = new Ei({ func: c3.ALWAYS, mask: 0 }, 0, 255, c3.ZERO, c3.ZERO, c3.ZERO);
          }
          clearStencil() {
            const e2 = this.context, i2 = e2.gl;
            this.nextStencilID = 1, this.currentStencilSource = void 0;
            const o2 = t.create();
            t.ortho(o2, 0, this.width, this.height, 0, 0, 1), t.scale(o2, o2, [i2.drawingBufferWidth, i2.drawingBufferHeight, 0]), this.useProgram("clippingMask").draw(e2, i2.TRIANGLES, wi.disabled, this.stencilClearMode, yi.disabled, Ii.disabled, xe(o2), null, "$clipping", this.viewportBuffer, this.quadTriangleIndexBuffer, this.viewportSegments);
          }
          _renderTileClippingMasks(t2, e2) {
            if (this.currentStencilSource === t2.source || !t2.isTileClipped() || !e2 || !e2.length)
              return;
            this.currentStencilSource = t2.source;
            const i2 = this.context, o2 = i2.gl;
            this.nextStencilID + e2.length > 256 && this.clearStencil(), i2.setColorMode(yi.disabled), i2.setDepthMode(wi.disabled);
            const a2 = this.useProgram("clippingMask");
            this._tileClippingMaskIDs = {};
            for (const t3 of e2) {
              const e3 = this._tileClippingMaskIDs[t3.key] = this.nextStencilID++, r2 = this.style.terrain && this.style.terrain.getTerrainData(t3);
              a2.draw(i2, o2.TRIANGLES, wi.disabled, new Ei({ func: o2.ALWAYS, mask: 0 }, e3, 255, o2.KEEP, o2.KEEP, o2.REPLACE), yi.disabled, Ii.disabled, xe(t3.posMatrix), r2, "$clipping", this.tileExtentBuffer, this.quadTriangleIndexBuffer, this.tileExtentSegments);
            }
          }
          stencilModeFor3D() {
            this.currentStencilSource = void 0, this.nextStencilID + 1 > 256 && this.clearStencil();
            const t2 = this.nextStencilID++, e2 = this.context.gl;
            return new Ei({ func: e2.NOTEQUAL, mask: 255 }, t2, 255, e2.KEEP, e2.KEEP, e2.REPLACE);
          }
          stencilModeForClipping(t2) {
            const e2 = this.context.gl;
            return new Ei({ func: e2.EQUAL, mask: 255 }, this._tileClippingMaskIDs[t2.key], 0, e2.KEEP, e2.KEEP, e2.REPLACE);
          }
          stencilConfigForOverlap(t2) {
            const e2 = this.context.gl, i2 = t2.sort((t3, e3) => e3.overscaledZ - t3.overscaledZ), o2 = i2[i2.length - 1].overscaledZ, a2 = i2[0].overscaledZ - o2 + 1;
            if (a2 > 1) {
              this.currentStencilSource = void 0, this.nextStencilID + a2 > 256 && this.clearStencil();
              const t3 = {};
              for (let i3 = 0; i3 < a2; i3++)
                t3[i3 + o2] = new Ei({ func: e2.GEQUAL, mask: 255 }, i3 + this.nextStencilID, 255, e2.KEEP, e2.KEEP, e2.REPLACE);
              return this.nextStencilID += a2, [t3, i2];
            }
            return [{ [o2]: Ei.disabled }, i2];
          }
          colorModeForRenderPass() {
            const e2 = this.context.gl;
            if (this._showOverdrawInspector) {
              const i2 = 1 / 8;
              return new yi([e2.CONSTANT_COLOR, e2.ONE], new t.Color(i2, i2, i2, 0), [true, true, true, true]);
            }
            return "opaque" === this.renderPass ? yi.unblended : yi.alphaBlended;
          }
          depthModeForSublayer(t2, e2, i2) {
            if (!this.opaquePassEnabledForLayer())
              return wi.disabled;
            const o2 = 1 - ((1 + this.currentLayer) * this.numSublayers + t2) * this.depthEpsilon;
            return new wi(i2 || this.context.gl.LEQUAL, e2, [o2, o2]);
          }
          opaquePassEnabledForLayer() {
            return this.currentLayer < this.opaquePassCutoff;
          }
          render(e2, i2) {
            this.style = e2, this.options = i2, this.lineAtlas = e2.lineAtlas, this.imageManager = e2.imageManager, this.glyphManager = e2.glyphManager, this.symbolFadeChange = e2.placement.symbolFadeChange(t.exported.now()), this.imageManager.beginFrame();
            const o2 = this.style._order, a2 = this.style.sourceCaches, r2 = this.style.terrain && new Ki(this);
            for (const t2 in a2) {
              const e3 = a2[t2];
              e3.used && e3.prepare(this.context);
            }
            const s2 = {}, n2 = {}, l2 = {};
            for (const t2 in a2) {
              const e3 = a2[t2];
              s2[t2] = e3.getVisibleCoordinates(), n2[t2] = s2[t2].slice().reverse(), l2[t2] = e3.getVisibleCoordinates(true).reverse();
            }
            this.opaquePassCutoff = 1 / 0;
            for (let t2 = 0; t2 < o2.length; t2++)
              if (this.style._layers[o2[t2]].is3D()) {
                this.opaquePassCutoff = t2;
                break;
              }
            if (r2) {
              this.opaquePassCutoff = 0;
              const e3 = this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);
              (this.terrainFacilitator.dirty || !t.equals(this.terrainFacilitator.matrix, this.transform.projMatrix) || e3.length) && (t.copy(this.terrainFacilitator.matrix, this.transform.projMatrix), this.terrainFacilitator.renderTime = Date.now(), this.terrainFacilitator.dirty = false, function(e4, i3) {
                const o3 = e4.context, a3 = o3.gl, r3 = yi.unblended, s3 = new wi(a3.LEQUAL, wi.ReadWrite, [0, 1]), n3 = i3.getTerrainMesh(), l3 = i3.sourceCache.getRenderableTiles(), c3 = e4.useProgram("terrainDepth");
                o3.bindFramebuffer.set(i3.getFramebuffer("depth").framebuffer), o3.viewport.set([0, 0, e4.width / devicePixelRatio, e4.height / devicePixelRatio]), o3.clear({ color: t.Color.transparent, depth: 1 });
                for (const t2 of l3) {
                  const l4 = i3.getTerrainData(t2.tileID), h2 = e4.transform.calculatePosMatrix(t2.tileID.toUnwrapped());
                  c3.draw(o3, a3.TRIANGLES, s3, Ei.disabled, r3, Ii.backCCW, { u_matrix: h2 }, l4, "terrain", n3.vertexBuffer, n3.indexBuffer, n3.segments);
                }
                o3.bindFramebuffer.set(null), o3.viewport.set([0, 0, e4.width, e4.height]);
              }(this, this.style.terrain), function(e4, i3) {
                const o3 = e4.context, a3 = o3.gl, r3 = yi.unblended, s3 = new wi(a3.LEQUAL, wi.ReadWrite, [0, 1]), n3 = i3.getTerrainMesh(), l3 = i3.getCoordsTexture(), c3 = i3.sourceCache.getRenderableTiles(), h2 = e4.useProgram("terrainCoords");
                o3.bindFramebuffer.set(i3.getFramebuffer("coords").framebuffer), o3.viewport.set([0, 0, e4.width / devicePixelRatio, e4.height / devicePixelRatio]), o3.clear({ color: t.Color.transparent, depth: 1 }), i3.coordsIndex = [];
                for (const t2 of c3) {
                  const c4 = i3.getTerrainData(t2.tileID);
                  o3.activeTexture.set(a3.TEXTURE0), a3.bindTexture(a3.TEXTURE_2D, l3.texture);
                  const u2 = e4.transform.calculatePosMatrix(t2.tileID.toUnwrapped());
                  h2.draw(o3, a3.TRIANGLES, s3, Ei.disabled, r3, Ii.backCCW, { u_matrix: u2, u_terrain_coords_id: (255 - i3.coordsIndex.length) / 255, u_texture: 0 }, c4, "terrain", n3.vertexBuffer, n3.indexBuffer, n3.segments), i3.coordsIndex.push(t2.tileID.key);
                }
                o3.bindFramebuffer.set(null), o3.viewport.set([0, 0, e4.width, e4.height]);
              }(this, this.style.terrain));
            }
            this.renderPass = "offscreen";
            for (const t2 of o2) {
              const e3 = this.style._layers[t2];
              if (!e3.hasOffscreenPass() || e3.isHidden(this.transform.zoom))
                continue;
              const i3 = n2[e3.source];
              ("custom" === e3.type || i3.length) && this.renderLayer(this, a2[e3.source], e3, i3);
            }
            if (this.context.bindFramebuffer.set(null), this.context.clear({ color: i2.showOverdrawInspector ? t.Color.black : t.Color.transparent, depth: 1 }), this.clearStencil(), this._showOverdrawInspector = i2.showOverdrawInspector, this.depthRangeFor3D = [0, 1 - (e2._order.length + 2) * this.numSublayers * this.depthEpsilon], !r2)
              for (this.renderPass = "opaque", this.currentLayer = o2.length - 1; this.currentLayer >= 0; this.currentLayer--) {
                const t2 = this.style._layers[o2[this.currentLayer]], e3 = a2[t2.source], i3 = s2[t2.source];
                this._renderTileClippingMasks(t2, i3), this.renderLayer(this, e3, t2, i3);
              }
            for (this.renderPass = "translucent", this.currentLayer = 0; this.currentLayer < o2.length; this.currentLayer++) {
              const t2 = this.style._layers[o2[this.currentLayer]], e3 = a2[t2.source];
              if (r2 && r2.renderLayer(t2))
                continue;
              const i3 = ("symbol" === t2.type ? l2 : n2)[t2.source];
              this._renderTileClippingMasks(t2, s2[t2.source]), this.renderLayer(this, e3, t2, i3);
            }
            if (this.options.showTileBoundaries) {
              let t2, e3;
              Object.values(this.style._layers).forEach((i3) => {
                i3.source && !i3.isHidden(this.transform.zoom) && (i3.source !== (e3 && e3.id) && (e3 = this.style.sourceCaches[i3.source]), (!t2 || t2.getSource().maxzoom < e3.getSource().maxzoom) && (t2 = e3));
              }), t2 && Yi.debug(this, t2, t2.getVisibleCoordinates());
            }
            this.options.showPadding && function(t2) {
              const e3 = t2.transform.padding;
              qi(t2, t2.transform.height - (e3.top || 0), 3, Ui), qi(t2, e3.bottom || 0, 3, Ni), ji(t2, e3.left || 0, 3, Gi), ji(t2, t2.transform.width - (e3.right || 0), 3, Zi);
              const i3 = t2.transform.centerPoint;
              !function(t3, e4, i4, o3) {
                $i(t3, e4 - 1, i4 - 10, 2, 20, o3), $i(t3, e4 - 10, i4 - 1, 20, 2, o3);
              }(t2, i3.x, t2.transform.height - i3.y, Vi);
            }(this), this.context.setDefault();
          }
          renderLayer(t2, e2, i2, o2) {
            i2.isHidden(this.transform.zoom) || ("background" === i2.type || "custom" === i2.type || (o2 || []).length) && (this.id = i2.id, this.gpuTimingStart(i2), Yi[i2.type](t2, e2, i2, o2, this.style.placement.variableOffsets), this.gpuTimingEnd());
          }
          gpuTimingStart(t2) {
            if (!this.options.gpuTiming)
              return;
            const e2 = this.context.extTimerQuery;
            let i2 = this.gpuTimers[t2.id];
            i2 || (i2 = this.gpuTimers[t2.id] = { calls: 0, cpuTime: 0, query: e2.createQueryEXT() }), i2.calls++, e2.beginQueryEXT(e2.TIME_ELAPSED_EXT, i2.query);
          }
          gpuTimingEnd() {
            if (!this.options.gpuTiming)
              return;
            const t2 = this.context.extTimerQuery;
            t2.endQueryEXT(t2.TIME_ELAPSED_EXT);
          }
          collectGpuTimers() {
            const t2 = this.gpuTimers;
            return this.gpuTimers = {}, t2;
          }
          queryGpuTimers(t2) {
            const e2 = {};
            for (const i2 in t2) {
              const o2 = t2[i2], a2 = this.context.extTimerQuery, r2 = a2.getQueryObjectEXT(o2.query, a2.QUERY_RESULT_EXT) / 1e6;
              a2.deleteQueryEXT(o2.query), e2[i2] = r2;
            }
            return e2;
          }
          translatePosMatrix(e2, i2, o2, a2, r2) {
            if (!o2[0] && !o2[1])
              return e2;
            const s2 = r2 ? "map" === a2 ? this.transform.angle : 0 : "viewport" === a2 ? -this.transform.angle : 0;
            if (s2) {
              const t2 = Math.sin(s2), e3 = Math.cos(s2);
              o2 = [o2[0] * e3 - o2[1] * t2, o2[0] * t2 + o2[1] * e3];
            }
            const n2 = [r2 ? o2[0] : bt(i2, o2[0], this.transform.zoom), r2 ? o2[1] : bt(i2, o2[1], this.transform.zoom), 0], l2 = new Float32Array(16);
            return t.translate(l2, e2, n2), l2;
          }
          saveTileTexture(t2) {
            const e2 = this._tileTextures[t2.size[0]];
            e2 ? e2.push(t2) : this._tileTextures[t2.size[0]] = [t2];
          }
          getTileTexture(t2) {
            const e2 = this._tileTextures[t2];
            return e2 && e2.length > 0 ? e2.pop() : null;
          }
          isPatternMissing(t2) {
            if (!t2)
              return false;
            if (!t2.from || !t2.to)
              return true;
            const e2 = this.imageManager.getPattern(t2.from.toString()), i2 = this.imageManager.getPattern(t2.to.toString());
            return !e2 || !i2;
          }
          useProgram(t2, e2) {
            this.cache = this.cache || {};
            const i2 = t2 + (e2 ? e2.cacheKey : "") + (this._showOverdrawInspector ? "/overdraw" : "") + (this.style.terrain ? "/terrain" : "");
            return this.cache[i2] || (this.cache[i2] = new ne(this.context, t2, oe[t2], e2, Re[t2], this._showOverdrawInspector, this.style.terrain)), this.cache[i2];
          }
          setCustomLayerDefaults() {
            this.context.unbindVAO(), this.context.cullFace.setDefault(), this.context.activeTexture.setDefault(), this.context.pixelStoreUnpack.setDefault(), this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(), this.context.pixelStoreUnpackFlipY.setDefault();
          }
          setBaseState() {
            const t2 = this.context.gl;
            this.context.cullFace.set(false), this.context.viewport.set([0, 0, this.width, this.height]), this.context.blendEquation.set(t2.FUNC_ADD);
          }
          initDebugOverlayCanvas() {
            null == this.debugOverlayCanvas && (this.debugOverlayCanvas = document.createElement("canvas"), this.debugOverlayCanvas.width = 512, this.debugOverlayCanvas.height = 512, this.debugOverlayTexture = new l(this.context, this.debugOverlayCanvas, this.context.gl.RGBA));
          }
          destroy() {
            this.emptyTexture.destroy(), this.debugOverlayTexture && this.debugOverlayTexture.destroy();
          }
        }
        class Qi {
          constructor(t2, e2) {
            this.points = t2, this.planes = e2;
          }
          static fromInvProjectionMatrix(e2, i2, o2) {
            const a2 = Math.pow(2, o2), r2 = [[-1, 1, -1, 1], [1, 1, -1, 1], [1, -1, -1, 1], [-1, -1, -1, 1], [-1, 1, 1, 1], [1, 1, 1, 1], [1, -1, 1, 1], [-1, -1, 1, 1]].map((o3) => {
              const r3 = 1 / (o3 = t.transformMat4([], o3, e2))[3] / i2 * a2;
              return t.mul$1(o3, o3, [r3, r3, 1 / o3[3], r3]);
            }), s2 = [[0, 1, 2], [6, 5, 4], [0, 3, 7], [2, 1, 5], [3, 2, 6], [0, 4, 5]].map((e3) => {
              const i3 = t.sub([], r2[e3[0]], r2[e3[1]]), o3 = t.sub([], r2[e3[2]], r2[e3[1]]), a3 = t.normalize([], t.cross([], i3, o3)), s3 = -t.dot(a3, r2[e3[1]]);
              return a3.concat(s3);
            });
            return new Qi(r2, s2);
          }
        }
        class to {
          constructor(e2, i2) {
            this.min = e2, this.max = i2, this.center = t.scale$1([], t.add([], this.min, this.max), 0.5);
          }
          quadrant(e2) {
            const i2 = [e2 % 2 == 0, e2 < 2], o2 = t.clone$2(this.min), a2 = t.clone$2(this.max);
            for (let t2 = 0; t2 < i2.length; t2++)
              o2[t2] = i2[t2] ? this.min[t2] : this.center[t2], a2[t2] = i2[t2] ? this.center[t2] : this.max[t2];
            return a2[2] = this.max[2], new to(o2, a2);
          }
          distanceX(t2) {
            return Math.max(Math.min(this.max[0], t2[0]), this.min[0]) - t2[0];
          }
          distanceY(t2) {
            return Math.max(Math.min(this.max[1], t2[1]), this.min[1]) - t2[1];
          }
          intersects(e2) {
            const i2 = [[this.min[0], this.min[1], this.min[2], 1], [this.max[0], this.min[1], this.min[2], 1], [this.max[0], this.max[1], this.min[2], 1], [this.min[0], this.max[1], this.min[2], 1], [this.min[0], this.min[1], this.max[2], 1], [this.max[0], this.min[1], this.max[2], 1], [this.max[0], this.max[1], this.max[2], 1], [this.min[0], this.max[1], this.max[2], 1]];
            let o2 = true;
            for (let a2 = 0; a2 < e2.planes.length; a2++) {
              const r2 = e2.planes[a2];
              let s2 = 0;
              for (let e3 = 0; e3 < i2.length; e3++)
                t.dot$1(r2, i2[e3]) >= 0 && s2++;
              if (0 === s2)
                return 0;
              s2 !== i2.length && (o2 = false);
            }
            if (o2)
              return 2;
            for (let t2 = 0; t2 < 3; t2++) {
              let i3 = Number.MAX_VALUE, o3 = -Number.MAX_VALUE;
              for (let a2 = 0; a2 < e2.points.length; a2++) {
                const r2 = e2.points[a2][t2] - this.min[t2];
                i3 = Math.min(i3, r2), o3 = Math.max(o3, r2);
              }
              if (o3 < 0 || i3 > this.max[t2] - this.min[t2])
                return 0;
            }
            return 1;
          }
        }
        class eo {
          constructor(t2 = 0, e2 = 0, i2 = 0, o2 = 0) {
            if (isNaN(t2) || t2 < 0 || isNaN(e2) || e2 < 0 || isNaN(i2) || i2 < 0 || isNaN(o2) || o2 < 0)
              throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");
            this.top = t2, this.bottom = e2, this.left = i2, this.right = o2;
          }
          interpolate(e2, i2, o2) {
            return null != i2.top && null != e2.top && (this.top = t.number(e2.top, i2.top, o2)), null != i2.bottom && null != e2.bottom && (this.bottom = t.number(e2.bottom, i2.bottom, o2)), null != i2.left && null != e2.left && (this.left = t.number(e2.left, i2.left, o2)), null != i2.right && null != e2.right && (this.right = t.number(e2.right, i2.right, o2)), this;
          }
          getCenter(e2, i2) {
            const o2 = t.clamp((this.left + e2 - this.right) / 2, 0, e2), a2 = t.clamp((this.top + i2 - this.bottom) / 2, 0, i2);
            return new t.pointGeometry(o2, a2);
          }
          equals(t2) {
            return this.top === t2.top && this.bottom === t2.bottom && this.left === t2.left && this.right === t2.right;
          }
          clone() {
            return new eo(this.top, this.bottom, this.left, this.right);
          }
          toJSON() {
            return { top: this.top, bottom: this.bottom, left: this.left, right: this.right };
          }
        }
        class io {
          constructor(e2, i2, o2, a2, r2) {
            this.tileSize = 512, this.maxValidLatitude = 85.051129, this.freezeElevation = false, this._renderWorldCopies = void 0 === r2 || !!r2, this._minZoom = e2 || 0, this._maxZoom = i2 || 22, this._minPitch = null == o2 ? 0 : o2, this._maxPitch = null == a2 ? 60 : a2, this.setMaxBounds(), this.width = 0, this.height = 0, this._center = new t.LngLat(0, 0), this._elevation = 0, this.zoom = 0, this.angle = 0, this._fov = 0.6435011087932844, this._pitch = 0, this._unmodified = true, this._edgeInsets = new eo(), this._posMatrixCache = {}, this._alignedPosMatrixCache = {};
          }
          clone() {
            const t2 = new io(this._minZoom, this._maxZoom, this._minPitch, this.maxPitch, this._renderWorldCopies);
            return t2.tileSize = this.tileSize, t2.latRange = this.latRange, t2.width = this.width, t2.height = this.height, t2._center = this._center, t2._elevation = this._elevation, t2.zoom = this.zoom, t2.angle = this.angle, t2._fov = this._fov, t2._pitch = this._pitch, t2._unmodified = this._unmodified, t2._edgeInsets = this._edgeInsets.clone(), t2._calcMatrices(), t2;
          }
          get minZoom() {
            return this._minZoom;
          }
          set minZoom(t2) {
            this._minZoom !== t2 && (this._minZoom = t2, this.zoom = Math.max(this.zoom, t2));
          }
          get maxZoom() {
            return this._maxZoom;
          }
          set maxZoom(t2) {
            this._maxZoom !== t2 && (this._maxZoom = t2, this.zoom = Math.min(this.zoom, t2));
          }
          get minPitch() {
            return this._minPitch;
          }
          set minPitch(t2) {
            this._minPitch !== t2 && (this._minPitch = t2, this.pitch = Math.max(this.pitch, t2));
          }
          get maxPitch() {
            return this._maxPitch;
          }
          set maxPitch(t2) {
            this._maxPitch !== t2 && (this._maxPitch = t2, this.pitch = Math.min(this.pitch, t2));
          }
          get renderWorldCopies() {
            return this._renderWorldCopies;
          }
          set renderWorldCopies(t2) {
            void 0 === t2 ? t2 = true : null === t2 && (t2 = false), this._renderWorldCopies = t2;
          }
          get worldSize() {
            return this.tileSize * this.scale;
          }
          get centerOffset() {
            return this.centerPoint._sub(this.size._div(2));
          }
          get size() {
            return new t.pointGeometry(this.width, this.height);
          }
          get bearing() {
            return -this.angle / Math.PI * 180;
          }
          set bearing(e2) {
            const i2 = -t.wrap(e2, -180, 180) * Math.PI / 180;
            var o2;
            this.angle !== i2 && (this._unmodified = false, this.angle = i2, this._calcMatrices(), this.rotationMatrix = (o2 = new t.ARRAY_TYPE(4), t.ARRAY_TYPE != Float32Array && (o2[1] = 0, o2[2] = 0), o2[0] = 1, o2[3] = 1, o2), function(t2, e3, i3) {
              var o3 = e3[0], a2 = e3[1], r2 = e3[2], s2 = e3[3], n2 = Math.sin(i3), l2 = Math.cos(i3);
              t2[0] = o3 * l2 + r2 * n2, t2[1] = a2 * l2 + s2 * n2, t2[2] = o3 * -n2 + r2 * l2, t2[3] = a2 * -n2 + s2 * l2;
            }(this.rotationMatrix, this.rotationMatrix, this.angle));
          }
          get pitch() {
            return this._pitch / Math.PI * 180;
          }
          set pitch(e2) {
            const i2 = t.clamp(e2, this.minPitch, this.maxPitch) / 180 * Math.PI;
            this._pitch !== i2 && (this._unmodified = false, this._pitch = i2, this._calcMatrices());
          }
          get fov() {
            return this._fov / Math.PI * 180;
          }
          set fov(t2) {
            t2 = Math.max(0.01, Math.min(60, t2)), this._fov !== t2 && (this._unmodified = false, this._fov = t2 / 180 * Math.PI, this._calcMatrices());
          }
          get zoom() {
            return this._zoom;
          }
          set zoom(t2) {
            const e2 = Math.min(Math.max(t2, this.minZoom), this.maxZoom);
            this._zoom !== e2 && (this._unmodified = false, this._zoom = e2, this.scale = this.zoomScale(e2), this.tileZoom = Math.floor(e2), this.zoomFraction = e2 - this.tileZoom, this._constrain(), this._calcMatrices());
          }
          get center() {
            return this._center;
          }
          set center(t2) {
            t2.lat === this._center.lat && t2.lng === this._center.lng || (this._unmodified = false, this._center = t2, this._constrain(), this._calcMatrices());
          }
          get elevation() {
            return this._elevation;
          }
          set elevation(t2) {
            t2 !== this._elevation && (this._elevation = t2, this._constrain(), this._calcMatrices());
          }
          get padding() {
            return this._edgeInsets.toJSON();
          }
          set padding(t2) {
            this._edgeInsets.equals(t2) || (this._unmodified = false, this._edgeInsets.interpolate(this._edgeInsets, t2, 1), this._calcMatrices());
          }
          get centerPoint() {
            return this._edgeInsets.getCenter(this.width, this.height);
          }
          isPaddingEqual(t2) {
            return this._edgeInsets.equals(t2);
          }
          interpolatePadding(t2, e2, i2) {
            this._unmodified = false, this._edgeInsets.interpolate(t2, e2, i2), this._constrain(), this._calcMatrices();
          }
          coveringZoomLevel(t2) {
            const e2 = (t2.roundZoom ? Math.round : Math.floor)(this.zoom + this.scaleZoom(this.tileSize / t2.tileSize));
            return Math.max(0, e2);
          }
          getVisibleUnwrappedCoordinates(e2) {
            const i2 = [new t.UnwrappedTileID(0, e2)];
            if (this._renderWorldCopies) {
              const o2 = this.pointCoordinate(new t.pointGeometry(0, 0)), a2 = this.pointCoordinate(new t.pointGeometry(this.width, 0)), r2 = this.pointCoordinate(new t.pointGeometry(this.width, this.height)), s2 = this.pointCoordinate(new t.pointGeometry(0, this.height)), n2 = Math.floor(Math.min(o2.x, a2.x, r2.x, s2.x)), l2 = Math.floor(Math.max(o2.x, a2.x, r2.x, s2.x)), c3 = 1;
              for (let o3 = n2 - c3; o3 <= l2 + c3; o3++)
                0 !== o3 && i2.push(new t.UnwrappedTileID(o3, e2));
            }
            return i2;
          }
          coveringTiles(e2) {
            var i2, o2;
            let a2 = this.coveringZoomLevel(e2);
            const r2 = a2;
            if (void 0 !== e2.minzoom && a2 < e2.minzoom)
              return [];
            void 0 !== e2.maxzoom && a2 > e2.maxzoom && (a2 = e2.maxzoom);
            const s2 = this.pointCoordinate(this.getCameraPoint()), n2 = t.MercatorCoordinate.fromLngLat(this.center), l2 = Math.pow(2, a2), c3 = [l2 * s2.x, l2 * s2.y, 0], h2 = [l2 * n2.x, l2 * n2.y, 0], u2 = Qi.fromInvProjectionMatrix(this.invProjMatrix, this.worldSize, a2);
            let d2 = e2.minzoom || 0;
            !e2.terrain && this.pitch <= 60 && this._edgeInsets.top < 0.1 && (d2 = a2);
            const m2 = e2.terrain ? 2 / Math.min(this.tileSize, e2.tileSize) * this.tileSize : 3, _2 = (t2) => ({ aabb: new to([t2 * l2, 0, 0], [(t2 + 1) * l2, l2, 0]), zoom: 0, x: 0, y: 0, wrap: t2, fullyVisible: false }), p3 = [], f2 = [], g2 = a2, x2 = e2.reparseOverscaled ? r2 : a2;
            if (this._renderWorldCopies)
              for (let t2 = 1; t2 <= 3; t2++)
                p3.push(_2(-t2)), p3.push(_2(t2));
            for (p3.push(_2(0)); p3.length > 0; ) {
              const a3 = p3.pop(), r3 = a3.x, s3 = a3.y;
              let n3 = a3.fullyVisible;
              if (!n3) {
                const t2 = a3.aabb.intersects(u2);
                if (0 === t2)
                  continue;
                n3 = 2 === t2;
              }
              const l3 = e2.terrain ? c3 : h2, _3 = a3.aabb.distanceX(l3), v3 = a3.aabb.distanceY(l3), y3 = Math.max(Math.abs(_3), Math.abs(v3)), b2 = m2 + (1 << g2 - a3.zoom) - 2;
              if (a3.zoom === g2 || y3 > b2 && a3.zoom >= d2) {
                const e3 = g2 - a3.zoom, i3 = c3[0] - 0.5 - (r3 << e3), o3 = c3[1] - 0.5 - (s3 << e3);
                f2.push({ tileID: new t.OverscaledTileID(a3.zoom === g2 ? x2 : a3.zoom, a3.wrap, a3.zoom, r3, s3), distanceSq: t.sqrLen([h2[0] - 0.5 - r3, h2[1] - 0.5 - s3]), tileDistanceToCamera: Math.sqrt(i3 * i3 + o3 * o3) });
              } else
                for (let l4 = 0; l4 < 4; l4++) {
                  const c4 = (r3 << 1) + l4 % 2, h3 = (s3 << 1) + (l4 >> 1), u3 = a3.zoom + 1;
                  let d3 = a3.aabb.quadrant(l4);
                  if (e2.terrain) {
                    const r4 = new t.OverscaledTileID(u3, a3.wrap, u3, c4, h3), s4 = e2.terrain.getMinMaxElevation(r4), n4 = null !== (i2 = s4.minElevation) && void 0 !== i2 ? i2 : this.elevation, l5 = null !== (o2 = s4.maxElevation) && void 0 !== o2 ? o2 : this.elevation;
                    d3 = new to([d3.min[0], d3.min[1], n4], [d3.max[0], d3.max[1], l5]);
                  }
                  p3.push({ aabb: d3, zoom: u3, x: c4, y: h3, wrap: a3.wrap, fullyVisible: n3 });
                }
            }
            return f2.sort((t2, e3) => t2.distanceSq - e3.distanceSq).map((t2) => t2.tileID);
          }
          resize(t2, e2) {
            this.width = t2, this.height = e2, this.pixelsToGLUnits = [2 / t2, -2 / e2], this._constrain(), this._calcMatrices();
          }
          get unmodified() {
            return this._unmodified;
          }
          zoomScale(t2) {
            return Math.pow(2, t2);
          }
          scaleZoom(t2) {
            return Math.log(t2) / Math.LN2;
          }
          project(e2) {
            const i2 = t.clamp(e2.lat, -this.maxValidLatitude, this.maxValidLatitude);
            return new t.pointGeometry(t.mercatorXfromLng(e2.lng) * this.worldSize, t.mercatorYfromLat(i2) * this.worldSize);
          }
          unproject(e2) {
            return new t.MercatorCoordinate(e2.x / this.worldSize, e2.y / this.worldSize).toLngLat();
          }
          get point() {
            return this.project(this.center);
          }
          updateElevation(t2) {
            this.freezeElevation || (this.elevation = t2 ? this.getElevation(this._center, t2) : 0);
          }
          getElevation(e2, i2) {
            const o2 = t.MercatorCoordinate.fromLngLat(e2), a2 = (1 << this.tileZoom) * t.EXTENT, r2 = o2.x * a2, s2 = o2.y * a2, n2 = Math.floor(r2 / t.EXTENT), l2 = Math.floor(s2 / t.EXTENT), c3 = new t.OverscaledTileID(this.tileZoom, 0, this.tileZoom, n2, l2);
            return i2.getElevation(c3, r2 % t.EXTENT, s2 % t.EXTENT, t.EXTENT);
          }
          getCameraPosition() {
            return { lngLat: this.pointLocation(this.getCameraPoint()), altitude: Math.cos(this._pitch) * this.cameraToCenterDistance / this._pixelPerMeter + this.elevation };
          }
          recalculateZoom(e2) {
            const i2 = this.pointLocation(this.centerPoint, e2), o2 = this.getElevation(i2, e2);
            if (!(this.elevation - o2))
              return;
            const a2 = this.getCameraPosition(), r2 = t.MercatorCoordinate.fromLngLat(a2.lngLat, a2.altitude), s2 = t.MercatorCoordinate.fromLngLat(i2, o2), n2 = r2.x - s2.x, l2 = r2.y - s2.y, c3 = r2.z - s2.z, h2 = Math.sqrt(n2 * n2 + l2 * l2 + c3 * c3), u2 = this.scaleZoom(this.cameraToCenterDistance / h2 / this.tileSize);
            this._elevation = o2, this._center = i2, this.zoom = u2;
          }
          setLocationAtPoint(e2, i2) {
            const o2 = this.pointCoordinate(i2), a2 = this.pointCoordinate(this.centerPoint), r2 = this.locationCoordinate(e2), s2 = new t.MercatorCoordinate(r2.x - (o2.x - a2.x), r2.y - (o2.y - a2.y));
            this.center = this.coordinateLocation(s2), this._renderWorldCopies && (this.center = this.center.wrap());
          }
          locationPoint(t2, e2) {
            return e2 ? this.coordinatePoint(this.locationCoordinate(t2), this.getElevation(t2, e2), this.pixelMatrix3D) : this.coordinatePoint(this.locationCoordinate(t2));
          }
          pointLocation(t2, e2) {
            return this.coordinateLocation(this.pointCoordinate(t2, e2));
          }
          locationCoordinate(e2) {
            return t.MercatorCoordinate.fromLngLat(e2);
          }
          coordinateLocation(t2) {
            return t2 && t2.toLngLat();
          }
          pointCoordinate(e2, i2) {
            if (i2) {
              const t2 = i2.pointCoordinate(e2);
              if (null != t2)
                return t2;
            }
            const o2 = [e2.x, e2.y, 0, 1], a2 = [e2.x, e2.y, 1, 1];
            t.transformMat4(o2, o2, this.pixelMatrixInverse), t.transformMat4(a2, a2, this.pixelMatrixInverse);
            const r2 = o2[3], s2 = a2[3], n2 = o2[1] / r2, l2 = a2[1] / s2, c3 = o2[2] / r2, h2 = a2[2] / s2, u2 = c3 === h2 ? 0 : (0 - c3) / (h2 - c3);
            return new t.MercatorCoordinate(t.number(o2[0] / r2, a2[0] / s2, u2) / this.worldSize, t.number(n2, l2, u2) / this.worldSize);
          }
          coordinatePoint(e2, i2 = 0, o2 = this.pixelMatrix) {
            const a2 = [e2.x * this.worldSize, e2.y * this.worldSize, i2, 1];
            return t.transformMat4(a2, a2, o2), new t.pointGeometry(a2[0] / a2[3], a2[1] / a2[3]);
          }
          getBounds() {
            const e2 = Math.max(0, this.height / 2 - this.getHorizon());
            return new t.LngLatBounds().extend(this.pointLocation(new t.pointGeometry(0, e2))).extend(this.pointLocation(new t.pointGeometry(this.width, e2))).extend(this.pointLocation(new t.pointGeometry(this.width, this.height))).extend(this.pointLocation(new t.pointGeometry(0, this.height)));
          }
          getMaxBounds() {
            return this.latRange && 2 === this.latRange.length && this.lngRange && 2 === this.lngRange.length ? new t.LngLatBounds([this.lngRange[0], this.latRange[0]], [this.lngRange[1], this.latRange[1]]) : null;
          }
          getHorizon() {
            return Math.tan(Math.PI / 2 - this._pitch) * this.cameraToCenterDistance * 0.85;
          }
          setMaxBounds(t2) {
            t2 ? (this.lngRange = [t2.getWest(), t2.getEast()], this.latRange = [t2.getSouth(), t2.getNorth()], this._constrain()) : (this.lngRange = null, this.latRange = [-this.maxValidLatitude, this.maxValidLatitude]);
          }
          calculatePosMatrix(e2, i2 = false) {
            const o2 = e2.key, a2 = i2 ? this._alignedPosMatrixCache : this._posMatrixCache;
            if (a2[o2])
              return a2[o2];
            const r2 = e2.canonical, s2 = this.worldSize / this.zoomScale(r2.z), n2 = r2.x + Math.pow(2, r2.z) * e2.wrap, l2 = t.identity(new Float64Array(16));
            return t.translate(l2, l2, [n2 * s2, r2.y * s2, 0]), t.scale(l2, l2, [s2 / t.EXTENT, s2 / t.EXTENT, 1]), t.multiply(l2, i2 ? this.alignedProjMatrix : this.projMatrix, l2), a2[o2] = new Float32Array(l2), a2[o2];
          }
          customLayerMatrix() {
            return this.mercatorMatrix.slice();
          }
          _constrain() {
            if (!this.center || !this.width || !this.height || this._constraining)
              return;
            this._constraining = true;
            let e2, i2, o2, a2, r2 = -90, s2 = 90, n2 = -180, l2 = 180;
            const c3 = this.size, h2 = this._unmodified;
            if (this.latRange) {
              const i3 = this.latRange;
              r2 = t.mercatorYfromLat(i3[1]) * this.worldSize, s2 = t.mercatorYfromLat(i3[0]) * this.worldSize, e2 = s2 - r2 < c3.y ? c3.y / (s2 - r2) : 0;
            }
            if (this.lngRange) {
              const e3 = this.lngRange;
              n2 = t.wrap(t.mercatorXfromLng(e3[0]) * this.worldSize, 0, this.worldSize), l2 = t.wrap(t.mercatorXfromLng(e3[1]) * this.worldSize, 0, this.worldSize), l2 < n2 && (l2 += this.worldSize), i2 = l2 - n2 < c3.x ? c3.x / (l2 - n2) : 0;
            }
            const u2 = this.point, d2 = Math.max(i2 || 0, e2 || 0);
            if (d2)
              return this.center = this.unproject(new t.pointGeometry(i2 ? (l2 + n2) / 2 : u2.x, e2 ? (s2 + r2) / 2 : u2.y)), this.zoom += this.scaleZoom(d2), this._unmodified = h2, void (this._constraining = false);
            if (this.latRange) {
              const t2 = u2.y, e3 = c3.y / 2;
              t2 - e3 < r2 && (a2 = r2 + e3), t2 + e3 > s2 && (a2 = s2 - e3);
            }
            if (this.lngRange) {
              const e3 = (n2 + l2) / 2, i3 = t.wrap(u2.x, e3 - this.worldSize / 2, e3 + this.worldSize / 2), a3 = c3.x / 2;
              i3 - a3 < n2 && (o2 = n2 + a3), i3 + a3 > l2 && (o2 = l2 - a3);
            }
            void 0 === o2 && void 0 === a2 || (this.center = this.unproject(new t.pointGeometry(void 0 !== o2 ? o2 : u2.x, void 0 !== a2 ? a2 : u2.y)).wrap()), this._unmodified = h2, this._constraining = false;
          }
          _calcMatrices() {
            if (!this.height)
              return;
            const e2 = this.centerOffset, i2 = this.point.x, o2 = this.point.y;
            this.cameraToCenterDistance = 0.5 / Math.tan(this._fov / 2) * this.height, this._pixelPerMeter = t.mercatorZfromAltitude(1, this.center.lat) * this.worldSize;
            let a2 = t.identity(new Float64Array(16));
            t.scale(a2, a2, [this.width / 2, -this.height / 2, 1]), t.translate(a2, a2, [1, -1, 0]), this.labelPlaneMatrix = a2, a2 = t.identity(new Float64Array(16)), t.scale(a2, a2, [1, -1, 1]), t.translate(a2, a2, [-1, -1, 0]), t.scale(a2, a2, [2 / this.width, 2 / this.height, 1]), this.glCoordMatrix = a2, this.cameraToSeaLevelDistance = this.cameraToCenterDistance + this._elevation * this._pixelPerMeter / Math.cos(this._pitch);
            const r2 = Math.PI / 2 + this._pitch, s2 = this._fov * (0.5 + e2.y / this.height), n2 = Math.sin(s2) * this.cameraToSeaLevelDistance / Math.sin(t.clamp(Math.PI - r2 - s2, 0.01, Math.PI - 0.01)), l2 = this.getHorizon(), c3 = 2 * Math.atan(l2 / this.cameraToCenterDistance) * (0.5 + e2.y / (2 * l2)), h2 = Math.sin(c3) * this.cameraToSeaLevelDistance / Math.sin(t.clamp(Math.PI - r2 - c3, 0.01, Math.PI - 0.01)), u2 = Math.cos(Math.PI / 2 - this._pitch) * n2 + this.cameraToSeaLevelDistance, d2 = Math.cos(Math.PI / 2 - this._pitch) * h2 + this.cameraToSeaLevelDistance, m2 = 1.01 * Math.min(u2, d2), _2 = this.height / 50;
            a2 = new Float64Array(16), t.perspective(a2, this._fov, this.width / this.height, _2, m2), a2[8] = 2 * -e2.x / this.width, a2[9] = 2 * e2.y / this.height, t.scale(a2, a2, [1, -1, 1]), t.translate(a2, a2, [0, 0, -this.cameraToCenterDistance]), t.rotateX(a2, a2, this._pitch), t.rotateZ(a2, a2, this.angle), t.translate(a2, a2, [-i2, -o2, 0]), this.mercatorMatrix = t.scale([], a2, [this.worldSize, this.worldSize, this.worldSize]), t.scale(a2, a2, [1, 1, this._pixelPerMeter]), this.pixelMatrix = t.multiply(new Float64Array(16), this.labelPlaneMatrix, a2), t.translate(a2, a2, [0, 0, -this.elevation]), this.projMatrix = a2, this.invProjMatrix = t.invert([], a2), this.pixelMatrix3D = t.multiply(new Float64Array(16), this.labelPlaneMatrix, a2);
            const p3 = this.width % 2 / 2, f2 = this.height % 2 / 2, g2 = Math.cos(this.angle), x2 = Math.sin(this.angle), v3 = i2 - Math.round(i2) + g2 * p3 + x2 * f2, y3 = o2 - Math.round(o2) + g2 * f2 + x2 * p3, b2 = new Float64Array(a2);
            if (t.translate(b2, b2, [v3 > 0.5 ? v3 - 1 : v3, y3 > 0.5 ? y3 - 1 : y3, 0]), this.alignedProjMatrix = b2, a2 = t.invert(new Float64Array(16), this.pixelMatrix), !a2)
              throw new Error("failed to invert matrix");
            this.pixelMatrixInverse = a2, this._posMatrixCache = {}, this._alignedPosMatrixCache = {};
          }
          maxPitchScaleFactor() {
            if (!this.pixelMatrixInverse)
              return 1;
            const e2 = this.pointCoordinate(new t.pointGeometry(0, 0)), i2 = [e2.x * this.worldSize, e2.y * this.worldSize, 0, 1];
            return t.transformMat4(i2, i2, this.pixelMatrix)[3] / this.cameraToCenterDistance;
          }
          getCameraPoint() {
            const e2 = Math.tan(this._pitch) * (this.cameraToCenterDistance || 1);
            return this.centerPoint.add(new t.pointGeometry(0, e2));
          }
          getCameraQueryGeometry(e2) {
            const i2 = this.getCameraPoint();
            if (1 === e2.length)
              return [e2[0], i2];
            {
              let o2 = i2.x, a2 = i2.y, r2 = i2.x, s2 = i2.y;
              for (const t2 of e2)
                o2 = Math.min(o2, t2.x), a2 = Math.min(a2, t2.y), r2 = Math.max(r2, t2.x), s2 = Math.max(s2, t2.y);
              return [new t.pointGeometry(o2, a2), new t.pointGeometry(r2, a2), new t.pointGeometry(r2, s2), new t.pointGeometry(o2, s2), new t.pointGeometry(o2, a2)];
            }
          }
        }
        class oo {
          constructor(e2) {
            this._hashName = e2 && encodeURIComponent(e2), t.bindAll(["_getCurrentHash", "_onHashChange", "_updateHash"], this), this._updateHash = function(t2, e3) {
              let i2 = false, o2 = null;
              const a2 = () => {
                o2 = null, i2 && (t2(), o2 = setTimeout(a2, 300), i2 = false);
              };
              return () => (i2 = true, o2 || a2(), o2);
            }(this._updateHashUnthrottled.bind(this));
          }
          addTo(t2) {
            return this._map = t2, addEventListener("hashchange", this._onHashChange, false), this._map.on("moveend", this._updateHash), this;
          }
          remove() {
            return removeEventListener("hashchange", this._onHashChange, false), this._map.off("moveend", this._updateHash), clearTimeout(this._updateHash()), delete this._map, this;
          }
          getHashString(t2) {
            const e2 = this._map.getCenter(), i2 = Math.round(100 * this._map.getZoom()) / 100, o2 = Math.ceil((i2 * Math.LN2 + Math.log(512 / 360 / 0.5)) / Math.LN10), a2 = Math.pow(10, o2), r2 = Math.round(e2.lng * a2) / a2, s2 = Math.round(e2.lat * a2) / a2, n2 = this._map.getBearing(), l2 = this._map.getPitch();
            let c3 = "";
            if (c3 += t2 ? `/${r2}/${s2}/${i2}` : `${i2}/${s2}/${r2}`, (n2 || l2) && (c3 += "/" + Math.round(10 * n2) / 10), l2 && (c3 += `/${Math.round(l2)}`), this._hashName) {
              const t3 = this._hashName;
              let e3 = false;
              const i3 = window.location.hash.slice(1).split("&").map((i4) => {
                const o3 = i4.split("=")[0];
                return o3 === t3 ? (e3 = true, `${o3}=${c3}`) : i4;
              }).filter((t4) => t4);
              return e3 || i3.push(`${t3}=${c3}`), `#${i3.join("&")}`;
            }
            return `#${c3}`;
          }
          _getCurrentHash() {
            const t2 = window.location.hash.replace("#", "");
            if (this._hashName) {
              let e2;
              return t2.split("&").map((t3) => t3.split("=")).forEach((t3) => {
                t3[0] === this._hashName && (e2 = t3);
              }), (e2 && e2[1] || "").split("/");
            }
            return t2.split("/");
          }
          _onHashChange() {
            const t2 = this._getCurrentHash();
            if (t2.length >= 3 && !t2.some((t3) => isNaN(t3))) {
              const e2 = this._map.dragRotate.isEnabled() && this._map.touchZoomRotate.isEnabled() ? +(t2[3] || 0) : this._map.getBearing();
              return this._map.jumpTo({ center: [+t2[2], +t2[1]], zoom: +t2[0], bearing: e2, pitch: +(t2[4] || 0) }), true;
            }
            return false;
          }
          _updateHashUnthrottled() {
            const t2 = window.location.href.replace(/(#.+)?$/, this.getHashString());
            try {
              window.history.replaceState(window.history.state, null, t2);
            } catch (t3) {
            }
          }
        }
        const ao = { linearity: 0.3, easing: t.bezier(0, 0, 0.3, 1) }, ro = t.extend({ deceleration: 2500, maxSpeed: 1400 }, ao), so = t.extend({ deceleration: 20, maxSpeed: 1400 }, ao), no = t.extend({ deceleration: 1e3, maxSpeed: 360 }, ao), lo = t.extend({ deceleration: 1e3, maxSpeed: 90 }, ao);
        class co {
          constructor(t2) {
            this._map = t2, this.clear();
          }
          clear() {
            this._inertiaBuffer = [];
          }
          record(e2) {
            this._drainInertiaBuffer(), this._inertiaBuffer.push({ time: t.exported.now(), settings: e2 });
          }
          _drainInertiaBuffer() {
            const e2 = this._inertiaBuffer, i2 = t.exported.now();
            for (; e2.length > 0 && i2 - e2[0].time > 160; )
              e2.shift();
          }
          _onMoveEnd(e2) {
            if (this._drainInertiaBuffer(), this._inertiaBuffer.length < 2)
              return;
            const i2 = { zoom: 0, bearing: 0, pitch: 0, pan: new t.pointGeometry(0, 0), pinchAround: void 0, around: void 0 };
            for (const { settings: t2 } of this._inertiaBuffer)
              i2.zoom += t2.zoomDelta || 0, i2.bearing += t2.bearingDelta || 0, i2.pitch += t2.pitchDelta || 0, t2.panDelta && i2.pan._add(t2.panDelta), t2.around && (i2.around = t2.around), t2.pinchAround && (i2.pinchAround = t2.pinchAround);
            const o2 = this._inertiaBuffer[this._inertiaBuffer.length - 1].time - this._inertiaBuffer[0].time, a2 = {};
            if (i2.pan.mag()) {
              const r2 = uo(i2.pan.mag(), o2, t.extend({}, ro, e2 || {}));
              a2.offset = i2.pan.mult(r2.amount / i2.pan.mag()), a2.center = this._map.transform.center, ho(a2, r2);
            }
            if (i2.zoom) {
              const t2 = uo(i2.zoom, o2, so);
              a2.zoom = this._map.transform.zoom + t2.amount, ho(a2, t2);
            }
            if (i2.bearing) {
              const e3 = uo(i2.bearing, o2, no);
              a2.bearing = this._map.transform.bearing + t.clamp(e3.amount, -179, 179), ho(a2, e3);
            }
            if (i2.pitch) {
              const t2 = uo(i2.pitch, o2, lo);
              a2.pitch = this._map.transform.pitch + t2.amount, ho(a2, t2);
            }
            if (a2.zoom || a2.bearing) {
              const t2 = void 0 === i2.pinchAround ? i2.around : i2.pinchAround;
              a2.around = t2 ? this._map.unproject(t2) : this._map.getCenter();
            }
            return this.clear(), t.extend(a2, { noMoveStart: true });
          }
        }
        function ho(t2, e2) {
          (!t2.duration || t2.duration < e2.duration) && (t2.duration = e2.duration, t2.easing = e2.easing);
        }
        function uo(e2, i2, o2) {
          const { maxSpeed: a2, linearity: r2, deceleration: s2 } = o2, n2 = t.clamp(e2 * r2 / (i2 / 1e3), -a2, a2), l2 = Math.abs(n2) / (s2 * r2);
          return { easing: o2.easing, duration: 1e3 * l2, amount: n2 * (l2 / 2) };
        }
        class mo extends t.Event {
          constructor(e2, i2, o2, a2 = {}) {
            const s2 = r.mousePos(i2.getCanvasContainer(), o2), n2 = i2.unproject(s2);
            super(e2, t.extend({ point: s2, lngLat: n2, originalEvent: o2 }, a2)), this._defaultPrevented = false, this.target = i2;
          }
          preventDefault() {
            this._defaultPrevented = true;
          }
          get defaultPrevented() {
            return this._defaultPrevented;
          }
        }
        class _o extends t.Event {
          constructor(e2, i2, o2) {
            const a2 = "touchend" === e2 ? o2.changedTouches : o2.touches, s2 = r.touchPos(i2.getCanvasContainer(), a2), n2 = s2.map((t2) => i2.unproject(t2)), l2 = s2.reduce((t2, e3, i3, o3) => t2.add(e3.div(o3.length)), new t.pointGeometry(0, 0));
            super(e2, { points: s2, point: l2, lngLats: n2, lngLat: i2.unproject(l2), originalEvent: o2 }), this._defaultPrevented = false;
          }
          preventDefault() {
            this._defaultPrevented = true;
          }
          get defaultPrevented() {
            return this._defaultPrevented;
          }
        }
        class po extends t.Event {
          constructor(t2, e2, i2) {
            super(t2, { originalEvent: i2 }), this._defaultPrevented = false;
          }
          preventDefault() {
            this._defaultPrevented = true;
          }
          get defaultPrevented() {
            return this._defaultPrevented;
          }
        }
        class fo {
          constructor(t2, e2) {
            this._map = t2, this._clickTolerance = e2.clickTolerance;
          }
          reset() {
            delete this._mousedownPos;
          }
          wheel(t2) {
            return this._firePreventable(new po(t2.type, this._map, t2));
          }
          mousedown(t2, e2) {
            return this._mousedownPos = e2, this._firePreventable(new mo(t2.type, this._map, t2));
          }
          mouseup(t2) {
            this._map.fire(new mo(t2.type, this._map, t2));
          }
          click(t2, e2) {
            this._mousedownPos && this._mousedownPos.dist(e2) >= this._clickTolerance || this._map.fire(new mo(t2.type, this._map, t2));
          }
          dblclick(t2) {
            return this._firePreventable(new mo(t2.type, this._map, t2));
          }
          mouseover(t2) {
            this._map.fire(new mo(t2.type, this._map, t2));
          }
          mouseout(t2) {
            this._map.fire(new mo(t2.type, this._map, t2));
          }
          touchstart(t2) {
            return this._firePreventable(new _o(t2.type, this._map, t2));
          }
          touchmove(t2) {
            this._map.fire(new _o(t2.type, this._map, t2));
          }
          touchend(t2) {
            this._map.fire(new _o(t2.type, this._map, t2));
          }
          touchcancel(t2) {
            this._map.fire(new _o(t2.type, this._map, t2));
          }
          _firePreventable(t2) {
            if (this._map.fire(t2), t2.defaultPrevented)
              return {};
          }
          isEnabled() {
            return true;
          }
          isActive() {
            return false;
          }
          enable() {
          }
          disable() {
          }
        }
        class go {
          constructor(t2) {
            this._map = t2;
          }
          reset() {
            this._delayContextMenu = false, this._ignoreContextMenu = true, delete this._contextMenuEvent;
          }
          mousemove(t2) {
            this._map.fire(new mo(t2.type, this._map, t2));
          }
          mousedown() {
            this._delayContextMenu = true, this._ignoreContextMenu = false;
          }
          mouseup() {
            this._delayContextMenu = false, this._contextMenuEvent && (this._map.fire(new mo("contextmenu", this._map, this._contextMenuEvent)), delete this._contextMenuEvent);
          }
          contextmenu(t2) {
            this._delayContextMenu ? this._contextMenuEvent = t2 : this._ignoreContextMenu || this._map.fire(new mo(t2.type, this._map, t2)), this._map.listens("contextmenu") && t2.preventDefault();
          }
          isEnabled() {
            return true;
          }
          isActive() {
            return false;
          }
          enable() {
          }
          disable() {
          }
        }
        class xo {
          constructor(t2, e2) {
            this._map = t2, this._el = t2.getCanvasContainer(), this._container = t2.getContainer(), this._clickTolerance = e2.clickTolerance || 1;
          }
          isEnabled() {
            return !!this._enabled;
          }
          isActive() {
            return !!this._active;
          }
          enable() {
            this.isEnabled() || (this._enabled = true);
          }
          disable() {
            this.isEnabled() && (this._enabled = false);
          }
          mousedown(t2, e2) {
            this.isEnabled() && t2.shiftKey && 0 === t2.button && (r.disableDrag(), this._startPos = this._lastPos = e2, this._active = true);
          }
          mousemoveWindow(t2, e2) {
            if (!this._active)
              return;
            const i2 = e2;
            if (this._lastPos.equals(i2) || !this._box && i2.dist(this._startPos) < this._clickTolerance)
              return;
            const o2 = this._startPos;
            this._lastPos = i2, this._box || (this._box = r.create("div", "maplibregl-boxzoom mapboxgl-boxzoom", this._container), this._container.classList.add("maplibregl-crosshair", "mapboxgl-crosshair"), this._fireEvent("boxzoomstart", t2));
            const a2 = Math.min(o2.x, i2.x), s2 = Math.max(o2.x, i2.x), n2 = Math.min(o2.y, i2.y), l2 = Math.max(o2.y, i2.y);
            r.setTransform(this._box, `translate(${a2}px,${n2}px)`), this._box.style.width = s2 - a2 + "px", this._box.style.height = l2 - n2 + "px";
          }
          mouseupWindow(e2, i2) {
            if (!this._active)
              return;
            if (0 !== e2.button)
              return;
            const o2 = this._startPos, a2 = i2;
            if (this.reset(), r.suppressClick(), o2.x !== a2.x || o2.y !== a2.y)
              return this._map.fire(new t.Event("boxzoomend", { originalEvent: e2 })), { cameraAnimation: (t2) => t2.fitScreenCoordinates(o2, a2, this._map.getBearing(), { linear: true }) };
            this._fireEvent("boxzoomcancel", e2);
          }
          keydown(t2) {
            this._active && 27 === t2.keyCode && (this.reset(), this._fireEvent("boxzoomcancel", t2));
          }
          reset() {
            this._active = false, this._container.classList.remove("maplibregl-crosshair", "mapboxgl-crosshair"), this._box && (r.remove(this._box), this._box = null), r.enableDrag(), delete this._startPos, delete this._lastPos;
          }
          _fireEvent(e2, i2) {
            return this._map.fire(new t.Event(e2, { originalEvent: i2 }));
          }
        }
        function vo(t2, e2) {
          if (t2.length !== e2.length)
            throw new Error(`The number of touches and points are not equal - touches ${t2.length}, points ${e2.length}`);
          const i2 = {};
          for (let o2 = 0; o2 < t2.length; o2++)
            i2[t2[o2].identifier] = e2[o2];
          return i2;
        }
        class yo {
          constructor(t2) {
            this.reset(), this.numTouches = t2.numTouches;
          }
          reset() {
            delete this.centroid, delete this.startTime, delete this.touches, this.aborted = false;
          }
          touchstart(e2, i2, o2) {
            (this.centroid || o2.length > this.numTouches) && (this.aborted = true), this.aborted || (void 0 === this.startTime && (this.startTime = e2.timeStamp), o2.length === this.numTouches && (this.centroid = function(e3) {
              const i3 = new t.pointGeometry(0, 0);
              for (const t2 of e3)
                i3._add(t2);
              return i3.div(e3.length);
            }(i2), this.touches = vo(o2, i2)));
          }
          touchmove(t2, e2, i2) {
            if (this.aborted || !this.centroid)
              return;
            const o2 = vo(i2, e2);
            for (const t3 in this.touches) {
              const e3 = this.touches[t3], i3 = o2[t3];
              (!i3 || i3.dist(e3) > 30) && (this.aborted = true);
            }
          }
          touchend(t2, e2, i2) {
            if ((!this.centroid || t2.timeStamp - this.startTime > 500) && (this.aborted = true), 0 === i2.length) {
              const t3 = !this.aborted && this.centroid;
              if (this.reset(), t3)
                return t3;
            }
          }
        }
        class bo {
          constructor(t2) {
            this.singleTap = new yo(t2), this.numTaps = t2.numTaps, this.reset();
          }
          reset() {
            this.lastTime = 1 / 0, delete this.lastTap, this.count = 0, this.singleTap.reset();
          }
          touchstart(t2, e2, i2) {
            this.singleTap.touchstart(t2, e2, i2);
          }
          touchmove(t2, e2, i2) {
            this.singleTap.touchmove(t2, e2, i2);
          }
          touchend(t2, e2, i2) {
            const o2 = this.singleTap.touchend(t2, e2, i2);
            if (o2) {
              const e3 = t2.timeStamp - this.lastTime < 500, i3 = !this.lastTap || this.lastTap.dist(o2) < 30;
              if (e3 && i3 || this.reset(), this.count++, this.lastTime = t2.timeStamp, this.lastTap = o2, this.count === this.numTaps)
                return this.reset(), o2;
            }
          }
        }
        class wo {
          constructor() {
            this._zoomIn = new bo({ numTouches: 1, numTaps: 2 }), this._zoomOut = new bo({ numTouches: 2, numTaps: 1 }), this.reset();
          }
          reset() {
            this._active = false, this._zoomIn.reset(), this._zoomOut.reset();
          }
          touchstart(t2, e2, i2) {
            this._zoomIn.touchstart(t2, e2, i2), this._zoomOut.touchstart(t2, e2, i2);
          }
          touchmove(t2, e2, i2) {
            this._zoomIn.touchmove(t2, e2, i2), this._zoomOut.touchmove(t2, e2, i2);
          }
          touchend(t2, e2, i2) {
            const o2 = this._zoomIn.touchend(t2, e2, i2), a2 = this._zoomOut.touchend(t2, e2, i2);
            return o2 ? (this._active = true, t2.preventDefault(), setTimeout(() => this.reset(), 0), { cameraAnimation: (e3) => e3.easeTo({ duration: 300, zoom: e3.getZoom() + 1, around: e3.unproject(o2) }, { originalEvent: t2 }) }) : a2 ? (this._active = true, t2.preventDefault(), setTimeout(() => this.reset(), 0), { cameraAnimation: (e3) => e3.easeTo({ duration: 300, zoom: e3.getZoom() - 1, around: e3.unproject(a2) }, { originalEvent: t2 }) }) : void 0;
          }
          touchcancel() {
            this.reset();
          }
          enable() {
            this._enabled = true;
          }
          disable() {
            this._enabled = false, this.reset();
          }
          isEnabled() {
            return this._enabled;
          }
          isActive() {
            return this._active;
          }
        }
        const To = { 0: 1, 2: 2 };
        class Eo {
          constructor(t2) {
            this.reset(), this._clickTolerance = t2.clickTolerance || 1;
          }
          reset() {
            this._active = false, this._moved = false, delete this._lastPoint, delete this._eventButton;
          }
          _correctButton(t2, e2) {
            return false;
          }
          _move(t2, e2) {
            return {};
          }
          mousedown(t2, e2) {
            if (this._lastPoint)
              return;
            const i2 = r.mouseButton(t2);
            this._correctButton(t2, i2) && (this._lastPoint = e2, this._eventButton = i2);
          }
          mousemoveWindow(t2, e2) {
            const i2 = this._lastPoint;
            if (i2) {
              if (t2.preventDefault(), function(t3, e3) {
                const i3 = To[e3];
                return void 0 === t3.buttons || (t3.buttons & i3) !== i3;
              }(t2, this._eventButton))
                this.reset();
              else if (this._moved || !(e2.dist(i2) < this._clickTolerance))
                return this._moved = true, this._lastPoint = e2, this._move(i2, e2);
            }
          }
          mouseupWindow(t2) {
            this._lastPoint && r.mouseButton(t2) === this._eventButton && (this._moved && r.suppressClick(), this.reset());
          }
          enable() {
            this._enabled = true;
          }
          disable() {
            this._enabled = false, this.reset();
          }
          isEnabled() {
            return this._enabled;
          }
          isActive() {
            return this._active;
          }
        }
        class Io extends Eo {
          mousedown(t2, e2) {
            super.mousedown(t2, e2), this._lastPoint && (this._active = true);
          }
          _correctButton(t2, e2) {
            return 0 === e2 && !t2.ctrlKey;
          }
          _move(t2, e2) {
            return { around: e2, panDelta: e2.sub(t2) };
          }
        }
        class Co extends Eo {
          _correctButton(t2, e2) {
            return 0 === e2 && t2.ctrlKey || 2 === e2;
          }
          _move(t2, e2) {
            const i2 = 0.8 * (e2.x - t2.x);
            if (i2)
              return this._active = true, { bearingDelta: i2 };
          }
          contextmenu(t2) {
            t2.preventDefault();
          }
        }
        class So extends Eo {
          _correctButton(t2, e2) {
            return 0 === e2 && t2.ctrlKey || 2 === e2;
          }
          _move(t2, e2) {
            const i2 = -0.5 * (e2.y - t2.y);
            if (i2)
              return this._active = true, { pitchDelta: i2 };
          }
          contextmenu(t2) {
            t2.preventDefault();
          }
        }
        class Do {
          constructor(t2, e2) {
            this._minTouches = t2.cooperativeGestures ? 2 : 1, this._clickTolerance = t2.clickTolerance || 1, this._map = e2, this.reset();
          }
          reset() {
            this._active = false, this._touches = {}, this._sum = new t.pointGeometry(0, 0), setTimeout(() => {
              this._cancelCooperativeMessage = false;
            }, 200);
          }
          touchstart(t2, e2, i2) {
            return this._calculateTransform(t2, e2, i2);
          }
          touchmove(t2, e2, i2) {
            if (this._map._cooperativeGestures && (2 === this._minTouches && i2.length < 2 && !this._cancelCooperativeMessage ? this._map._onCooperativeGesture(t2, false, i2.length) : this._cancelCooperativeMessage || (this._cancelCooperativeMessage = true)), this._active && !(i2.length < this._minTouches))
              return t2.preventDefault(), this._calculateTransform(t2, e2, i2);
          }
          touchend(t2, e2, i2) {
            this._calculateTransform(t2, e2, i2), this._active && i2.length < this._minTouches && this.reset();
          }
          touchcancel() {
            this.reset();
          }
          _calculateTransform(e2, i2, o2) {
            o2.length > 0 && (this._active = true);
            const a2 = vo(o2, i2), r2 = new t.pointGeometry(0, 0), s2 = new t.pointGeometry(0, 0);
            let n2 = 0;
            for (const t2 in a2) {
              const e3 = a2[t2], i3 = this._touches[t2];
              i3 && (r2._add(e3), s2._add(e3.sub(i3)), n2++, a2[t2] = e3);
            }
            if (this._touches = a2, n2 < this._minTouches || !s2.mag())
              return;
            const l2 = s2.div(n2);
            return this._sum._add(l2), this._sum.mag() < this._clickTolerance ? void 0 : { around: r2.div(n2), panDelta: l2 };
          }
          enable() {
            this._enabled = true;
          }
          disable() {
            this._enabled = false, this.reset();
          }
          isEnabled() {
            return this._enabled;
          }
          isActive() {
            return this._active;
          }
        }
        class zo {
          constructor() {
            this.reset();
          }
          reset() {
            this._active = false, delete this._firstTwoTouches;
          }
          _start(t2) {
          }
          _move(t2, e2, i2) {
            return {};
          }
          touchstart(t2, e2, i2) {
            this._firstTwoTouches || i2.length < 2 || (this._firstTwoTouches = [i2[0].identifier, i2[1].identifier], this._start([e2[0], e2[1]]));
          }
          touchmove(t2, e2, i2) {
            if (!this._firstTwoTouches)
              return;
            t2.preventDefault();
            const [o2, a2] = this._firstTwoTouches, r2 = Po(i2, e2, o2), s2 = Po(i2, e2, a2);
            if (!r2 || !s2)
              return;
            const n2 = this._aroundCenter ? null : r2.add(s2).div(2);
            return this._move([r2, s2], n2, t2);
          }
          touchend(t2, e2, i2) {
            if (!this._firstTwoTouches)
              return;
            const [o2, a2] = this._firstTwoTouches, s2 = Po(i2, e2, o2), n2 = Po(i2, e2, a2);
            s2 && n2 || (this._active && r.suppressClick(), this.reset());
          }
          touchcancel() {
            this.reset();
          }
          enable(t2) {
            this._enabled = true, this._aroundCenter = !!t2 && "center" === t2.around;
          }
          disable() {
            this._enabled = false, this.reset();
          }
          isEnabled() {
            return this._enabled;
          }
          isActive() {
            return this._active;
          }
        }
        function Po(t2, e2, i2) {
          for (let o2 = 0; o2 < t2.length; o2++)
            if (t2[o2].identifier === i2)
              return e2[o2];
        }
        function Mo(t2, e2) {
          return Math.log(t2 / e2) / Math.LN2;
        }
        class Ao extends zo {
          reset() {
            super.reset(), delete this._distance, delete this._startDistance;
          }
          _start(t2) {
            this._startDistance = this._distance = t2[0].dist(t2[1]);
          }
          _move(t2, e2) {
            const i2 = this._distance;
            if (this._distance = t2[0].dist(t2[1]), this._active || !(Math.abs(Mo(this._distance, this._startDistance)) < 0.1))
              return this._active = true, { zoomDelta: Mo(this._distance, i2), pinchAround: e2 };
          }
        }
        function Lo(t2, e2) {
          return 180 * t2.angleWith(e2) / Math.PI;
        }
        class Ro extends zo {
          reset() {
            super.reset(), delete this._minDiameter, delete this._startVector, delete this._vector;
          }
          _start(t2) {
            this._startVector = this._vector = t2[0].sub(t2[1]), this._minDiameter = t2[0].dist(t2[1]);
          }
          _move(t2, e2) {
            const i2 = this._vector;
            if (this._vector = t2[0].sub(t2[1]), this._active || !this._isBelowThreshold(this._vector))
              return this._active = true, { bearingDelta: Lo(this._vector, i2), pinchAround: e2 };
          }
          _isBelowThreshold(t2) {
            this._minDiameter = Math.min(this._minDiameter, t2.mag());
            const e2 = 25 / (Math.PI * this._minDiameter) * 360, i2 = Lo(t2, this._startVector);
            return Math.abs(i2) < e2;
          }
        }
        function ko(t2) {
          return Math.abs(t2.y) > Math.abs(t2.x);
        }
        class Bo extends zo {
          constructor(t2) {
            super(), this._map = t2;
          }
          reset() {
            super.reset(), this._valid = void 0, delete this._firstMove, delete this._lastPoints;
          }
          touchstart(t2, e2, i2) {
            super.touchstart(t2, e2, i2), this._currentTouchCount = i2.length;
          }
          _start(t2) {
            this._lastPoints = t2, ko(t2[0].sub(t2[1])) && (this._valid = false);
          }
          _move(t2, e2, i2) {
            if (this._map._cooperativeGestures && this._currentTouchCount < 3)
              return;
            const o2 = t2[0].sub(this._lastPoints[0]), a2 = t2[1].sub(this._lastPoints[1]);
            return this._valid = this.gestureBeginsVertically(o2, a2, i2.timeStamp), this._valid ? (this._lastPoints = t2, this._active = true, { pitchDelta: (o2.y + a2.y) / 2 * -0.5 }) : void 0;
          }
          gestureBeginsVertically(t2, e2, i2) {
            if (void 0 !== this._valid)
              return this._valid;
            const o2 = t2.mag() >= 2, a2 = e2.mag() >= 2;
            if (!o2 && !a2)
              return;
            if (!o2 || !a2)
              return void 0 === this._firstMove && (this._firstMove = i2), i2 - this._firstMove < 100 && void 0;
            const r2 = t2.y > 0 == e2.y > 0;
            return ko(t2) && ko(e2) && r2;
          }
        }
        const Fo = { panStep: 100, bearingStep: 15, pitchStep: 10 };
        class Oo {
          constructor() {
            const t2 = Fo;
            this._panStep = t2.panStep, this._bearingStep = t2.bearingStep, this._pitchStep = t2.pitchStep, this._rotationDisabled = false;
          }
          reset() {
            this._active = false;
          }
          keydown(t2) {
            if (t2.altKey || t2.ctrlKey || t2.metaKey)
              return;
            let e2 = 0, i2 = 0, o2 = 0, a2 = 0, r2 = 0;
            switch (t2.keyCode) {
              case 61:
              case 107:
              case 171:
              case 187:
                e2 = 1;
                break;
              case 189:
              case 109:
              case 173:
                e2 = -1;
                break;
              case 37:
                t2.shiftKey ? i2 = -1 : (t2.preventDefault(), a2 = -1);
                break;
              case 39:
                t2.shiftKey ? i2 = 1 : (t2.preventDefault(), a2 = 1);
                break;
              case 38:
                t2.shiftKey ? o2 = 1 : (t2.preventDefault(), r2 = -1);
                break;
              case 40:
                t2.shiftKey ? o2 = -1 : (t2.preventDefault(), r2 = 1);
                break;
              default:
                return;
            }
            return this._rotationDisabled && (i2 = 0, o2 = 0), { cameraAnimation: (s2) => {
              const n2 = s2.getZoom();
              s2.easeTo({ duration: 300, easeId: "keyboardHandler", easing: Uo, zoom: e2 ? Math.round(n2) + e2 * (t2.shiftKey ? 2 : 1) : n2, bearing: s2.getBearing() + i2 * this._bearingStep, pitch: s2.getPitch() + o2 * this._pitchStep, offset: [-a2 * this._panStep, -r2 * this._panStep], center: s2.getCenter() }, { originalEvent: t2 });
            } };
          }
          enable() {
            this._enabled = true;
          }
          disable() {
            this._enabled = false, this.reset();
          }
          isEnabled() {
            return this._enabled;
          }
          isActive() {
            return this._active;
          }
          disableRotation() {
            this._rotationDisabled = true;
          }
          enableRotation() {
            this._rotationDisabled = false;
          }
        }
        function Uo(t2) {
          return t2 * (2 - t2);
        }
        const No = 4.000244140625;
        class Go {
          constructor(e2, i2) {
            this._map = e2, this._el = e2.getCanvasContainer(), this._handler = i2, this._delta = 0, this._defaultZoomRate = 0.01, this._wheelZoomRate = 0.0022222222222222222, t.bindAll(["_onTimeout"], this);
          }
          setZoomRate(t2) {
            this._defaultZoomRate = t2;
          }
          setWheelZoomRate(t2) {
            this._wheelZoomRate = t2;
          }
          isEnabled() {
            return !!this._enabled;
          }
          isActive() {
            return !!this._active || void 0 !== this._finishTimeout;
          }
          isZooming() {
            return !!this._zooming;
          }
          enable(t2) {
            this.isEnabled() || (this._enabled = true, this._aroundCenter = t2 && "center" === t2.around);
          }
          disable() {
            this.isEnabled() && (this._enabled = false);
          }
          wheel(e2) {
            if (!this.isEnabled())
              return;
            if (this._map._cooperativeGestures) {
              if (!this._map._metaPress)
                return;
              e2.preventDefault();
            }
            let i2 = e2.deltaMode === WheelEvent.DOM_DELTA_LINE ? 40 * e2.deltaY : e2.deltaY;
            const o2 = t.exported.now(), a2 = o2 - (this._lastWheelEventTime || 0);
            this._lastWheelEventTime = o2, 0 !== i2 && i2 % No == 0 ? this._type = "wheel" : 0 !== i2 && Math.abs(i2) < 4 ? this._type = "trackpad" : a2 > 400 ? (this._type = null, this._lastValue = i2, this._timeout = setTimeout(this._onTimeout, 40, e2)) : this._type || (this._type = Math.abs(a2 * i2) < 200 ? "trackpad" : "wheel", this._timeout && (clearTimeout(this._timeout), this._timeout = null, i2 += this._lastValue)), e2.shiftKey && i2 && (i2 /= 4), this._type && (this._lastWheelEvent = e2, this._delta -= i2, this._active || this._start(e2)), e2.preventDefault();
          }
          _onTimeout(t2) {
            this._type = "wheel", this._delta -= this._lastValue, this._active || this._start(t2);
          }
          _start(e2) {
            if (!this._delta)
              return;
            this._frameId && (this._frameId = null), this._active = true, this.isZooming() || (this._zooming = true), this._finishTimeout && (clearTimeout(this._finishTimeout), delete this._finishTimeout);
            const i2 = r.mousePos(this._el, e2);
            this._around = t.LngLat.convert(this._aroundCenter ? this._map.getCenter() : this._map.unproject(i2)), this._aroundPoint = this._map.transform.locationPoint(this._around), this._frameId || (this._frameId = true, this._handler._triggerRenderFrame());
          }
          renderFrame() {
            if (!this._frameId)
              return;
            if (this._frameId = null, !this.isActive())
              return;
            const e2 = this._map.transform;
            if (0 !== this._delta) {
              const t2 = "wheel" === this._type && Math.abs(this._delta) > No ? this._wheelZoomRate : this._defaultZoomRate;
              let i3 = 2 / (1 + Math.exp(-Math.abs(this._delta * t2)));
              this._delta < 0 && 0 !== i3 && (i3 = 1 / i3);
              const o3 = "number" == typeof this._targetZoom ? e2.zoomScale(this._targetZoom) : e2.scale;
              this._targetZoom = Math.min(e2.maxZoom, Math.max(e2.minZoom, e2.scaleZoom(o3 * i3))), "wheel" === this._type && (this._startZoom = e2.zoom, this._easing = this._smoothOutEasing(200)), this._delta = 0;
            }
            const i2 = "number" == typeof this._targetZoom ? this._targetZoom : e2.zoom, o2 = this._startZoom, a2 = this._easing;
            let r2, s2 = false;
            if ("wheel" === this._type && o2 && a2) {
              const e3 = Math.min((t.exported.now() - this._lastWheelEventTime) / 200, 1), n2 = a2(e3);
              r2 = t.number(o2, i2, n2), e3 < 1 ? this._frameId || (this._frameId = true) : s2 = true;
            } else
              r2 = i2, s2 = true;
            return this._active = true, s2 && (this._active = false, this._finishTimeout = setTimeout(() => {
              this._zooming = false, this._handler._triggerRenderFrame(), delete this._targetZoom, delete this._finishTimeout;
            }, 200)), { noInertia: true, needsRenderFrame: !s2, zoomDelta: r2 - e2.zoom, around: this._aroundPoint, originalEvent: this._lastWheelEvent };
          }
          _smoothOutEasing(e2) {
            let i2 = t.ease;
            if (this._prevEase) {
              const e3 = this._prevEase, o2 = (t.exported.now() - e3.start) / e3.duration, a2 = e3.easing(o2 + 0.01) - e3.easing(o2), r2 = 0.27 / Math.sqrt(a2 * a2 + 1e-4) * 0.01, s2 = Math.sqrt(0.0729 - r2 * r2);
              i2 = t.bezier(r2, s2, 0.25, 1);
            }
            return this._prevEase = { start: t.exported.now(), duration: e2, easing: i2 }, i2;
          }
          reset() {
            this._active = false;
          }
        }
        class Zo {
          constructor(t2, e2) {
            this._clickZoom = t2, this._tapZoom = e2;
          }
          enable() {
            this._clickZoom.enable(), this._tapZoom.enable();
          }
          disable() {
            this._clickZoom.disable(), this._tapZoom.disable();
          }
          isEnabled() {
            return this._clickZoom.isEnabled() && this._tapZoom.isEnabled();
          }
          isActive() {
            return this._clickZoom.isActive() || this._tapZoom.isActive();
          }
        }
        class Vo {
          constructor() {
            this.reset();
          }
          reset() {
            this._active = false;
          }
          dblclick(t2, e2) {
            return t2.preventDefault(), { cameraAnimation: (i2) => {
              i2.easeTo({ duration: 300, zoom: i2.getZoom() + (t2.shiftKey ? -1 : 1), around: i2.unproject(e2) }, { originalEvent: t2 });
            } };
          }
          enable() {
            this._enabled = true;
          }
          disable() {
            this._enabled = false, this.reset();
          }
          isEnabled() {
            return this._enabled;
          }
          isActive() {
            return this._active;
          }
        }
        class qo {
          constructor() {
            this._tap = new bo({ numTouches: 1, numTaps: 1 }), this.reset();
          }
          reset() {
            this._active = false, delete this._swipePoint, delete this._swipeTouch, delete this._tapTime, this._tap.reset();
          }
          touchstart(t2, e2, i2) {
            this._swipePoint || (this._tapTime && t2.timeStamp - this._tapTime > 500 && this.reset(), this._tapTime ? i2.length > 0 && (this._swipePoint = e2[0], this._swipeTouch = i2[0].identifier) : this._tap.touchstart(t2, e2, i2));
          }
          touchmove(t2, e2, i2) {
            if (this._tapTime) {
              if (this._swipePoint) {
                if (i2[0].identifier !== this._swipeTouch)
                  return;
                const o2 = e2[0], a2 = o2.y - this._swipePoint.y;
                return this._swipePoint = o2, t2.preventDefault(), this._active = true, { zoomDelta: a2 / 128 };
              }
            } else
              this._tap.touchmove(t2, e2, i2);
          }
          touchend(t2, e2, i2) {
            this._tapTime ? this._swipePoint && 0 === i2.length && this.reset() : this._tap.touchend(t2, e2, i2) && (this._tapTime = t2.timeStamp);
          }
          touchcancel() {
            this.reset();
          }
          enable() {
            this._enabled = true;
          }
          disable() {
            this._enabled = false, this.reset();
          }
          isEnabled() {
            return this._enabled;
          }
          isActive() {
            return this._active;
          }
        }
        class jo {
          constructor(t2, e2, i2) {
            this._el = t2, this._mousePan = e2, this._touchPan = i2;
          }
          enable(t2) {
            this._inertiaOptions = t2 || {}, this._mousePan.enable(), this._touchPan.enable(), this._el.classList.add("maplibregl-touch-drag-pan", "mapboxgl-touch-drag-pan");
          }
          disable() {
            this._mousePan.disable(), this._touchPan.disable(), this._el.classList.remove("maplibregl-touch-drag-pan", "mapboxgl-touch-drag-pan");
          }
          isEnabled() {
            return this._mousePan.isEnabled() && this._touchPan.isEnabled();
          }
          isActive() {
            return this._mousePan.isActive() || this._touchPan.isActive();
          }
        }
        class $o {
          constructor(t2, e2, i2) {
            this._pitchWithRotate = t2.pitchWithRotate, this._mouseRotate = e2, this._mousePitch = i2;
          }
          enable() {
            this._mouseRotate.enable(), this._pitchWithRotate && this._mousePitch.enable();
          }
          disable() {
            this._mouseRotate.disable(), this._mousePitch.disable();
          }
          isEnabled() {
            return this._mouseRotate.isEnabled() && (!this._pitchWithRotate || this._mousePitch.isEnabled());
          }
          isActive() {
            return this._mouseRotate.isActive() || this._mousePitch.isActive();
          }
        }
        class Xo {
          constructor(t2, e2, i2, o2) {
            this._el = t2, this._touchZoom = e2, this._touchRotate = i2, this._tapDragZoom = o2, this._rotationDisabled = false, this._enabled = true;
          }
          enable(t2) {
            this._touchZoom.enable(t2), this._rotationDisabled || this._touchRotate.enable(t2), this._tapDragZoom.enable(), this._el.classList.add("maplibregl-touch-zoom-rotate", "mapboxgl-touch-zoom-rotate");
          }
          disable() {
            this._touchZoom.disable(), this._touchRotate.disable(), this._tapDragZoom.disable(), this._el.classList.remove("maplibregl-touch-zoom-rotate", "mapboxgl-touch-zoom-rotate");
          }
          isEnabled() {
            return this._touchZoom.isEnabled() && (this._rotationDisabled || this._touchRotate.isEnabled()) && this._tapDragZoom.isEnabled();
          }
          isActive() {
            return this._touchZoom.isActive() || this._touchRotate.isActive() || this._tapDragZoom.isActive();
          }
          disableRotation() {
            this._rotationDisabled = true, this._touchRotate.disable();
          }
          enableRotation() {
            this._rotationDisabled = false, this._touchZoom.isEnabled() && this._touchRotate.enable();
          }
        }
        const Wo = (t2) => t2.zoom || t2.drag || t2.pitch || t2.rotate;
        class Ho extends t.Event {
        }
        function Ko(t2) {
          return t2.panDelta && t2.panDelta.mag() || t2.zoomDelta || t2.bearingDelta || t2.pitchDelta;
        }
        class Yo {
          constructor(e2, i2) {
            this._map = e2, this._el = this._map.getCanvasContainer(), this._handlers = [], this._handlersById = {}, this._changes = [], this._inertia = new co(e2), this._bearingSnap = i2.bearingSnap, this._previousActiveHandlers = {}, this._eventsInProgress = {}, this._addDefaultHandlers(i2), t.bindAll(["handleEvent", "handleWindowEvent"], this);
            const o2 = this._el;
            this._listeners = [[o2, "touchstart", { passive: true }], [o2, "touchmove", { passive: false }], [o2, "touchend", void 0], [o2, "touchcancel", void 0], [o2, "mousedown", void 0], [o2, "mousemove", void 0], [o2, "mouseup", void 0], [document, "mousemove", { capture: true }], [document, "mouseup", void 0], [o2, "mouseover", void 0], [o2, "mouseout", void 0], [o2, "dblclick", void 0], [o2, "click", void 0], [o2, "keydown", { capture: false }], [o2, "keyup", void 0], [o2, "wheel", { passive: false }], [o2, "contextmenu", void 0], [window, "blur", void 0]];
            for (const [t2, e3, i3] of this._listeners)
              r.addEventListener(t2, e3, t2 === document ? this.handleWindowEvent : this.handleEvent, i3);
          }
          destroy() {
            for (const [t2, e2, i2] of this._listeners)
              r.removeEventListener(t2, e2, t2 === document ? this.handleWindowEvent : this.handleEvent, i2);
          }
          _addDefaultHandlers(t2) {
            const e2 = this._map, i2 = e2.getCanvasContainer();
            this._add("mapEvent", new fo(e2, t2));
            const o2 = e2.boxZoom = new xo(e2, t2);
            this._add("boxZoom", o2);
            const a2 = new wo(), r2 = new Vo();
            e2.doubleClickZoom = new Zo(r2, a2), this._add("tapZoom", a2), this._add("clickZoom", r2);
            const s2 = new qo();
            this._add("tapDragZoom", s2);
            const n2 = e2.touchPitch = new Bo(e2);
            this._add("touchPitch", n2);
            const l2 = new Co(t2), c3 = new So(t2);
            e2.dragRotate = new $o(t2, l2, c3), this._add("mouseRotate", l2, ["mousePitch"]), this._add("mousePitch", c3, ["mouseRotate"]);
            const h2 = new Io(t2), u2 = new Do(t2, e2);
            e2.dragPan = new jo(i2, h2, u2), this._add("mousePan", h2), this._add("touchPan", u2, ["touchZoom", "touchRotate"]);
            const d2 = new Ro(), m2 = new Ao();
            e2.touchZoomRotate = new Xo(i2, m2, d2, s2), this._add("touchRotate", d2, ["touchPan", "touchZoom"]), this._add("touchZoom", m2, ["touchPan", "touchRotate"]);
            const _2 = e2.scrollZoom = new Go(e2, this);
            this._add("scrollZoom", _2, ["mousePan"]);
            const p3 = e2.keyboard = new Oo();
            this._add("keyboard", p3), this._add("blockableMapEvent", new go(e2));
            for (const i3 of ["boxZoom", "doubleClickZoom", "tapDragZoom", "touchPitch", "dragRotate", "dragPan", "touchZoomRotate", "scrollZoom", "keyboard"])
              t2.interactive && t2[i3] && e2[i3].enable(t2[i3]);
          }
          _add(t2, e2, i2) {
            this._handlers.push({ handlerName: t2, handler: e2, allowed: i2 }), this._handlersById[t2] = e2;
          }
          stop(t2) {
            if (!this._updatingCamera) {
              for (const { handler: t3 } of this._handlers)
                t3.reset();
              this._inertia.clear(), this._fireEvents({}, {}, t2), this._changes = [];
            }
          }
          isActive() {
            for (const { handler: t2 } of this._handlers)
              if (t2.isActive())
                return true;
            return false;
          }
          isZooming() {
            return !!this._eventsInProgress.zoom || this._map.scrollZoom.isZooming();
          }
          isRotating() {
            return !!this._eventsInProgress.rotate;
          }
          isMoving() {
            return Boolean(Wo(this._eventsInProgress)) || this.isZooming();
          }
          _blockedByActive(t2, e2, i2) {
            for (const o2 in t2)
              if (o2 !== i2 && (!e2 || e2.indexOf(o2) < 0))
                return true;
            return false;
          }
          handleWindowEvent(t2) {
            this.handleEvent(t2, `${t2.type}Window`);
          }
          _getMapTouches(t2) {
            const e2 = [];
            for (const i2 of t2)
              this._el.contains(i2.target) && e2.push(i2);
            return e2;
          }
          handleEvent(t2, e2) {
            if ("blur" === t2.type)
              return void this.stop(true);
            this._updatingCamera = true;
            const i2 = "renderFrame" === t2.type ? void 0 : t2, o2 = { needsRenderFrame: false }, a2 = {}, s2 = {}, n2 = t2.touches, l2 = n2 ? this._getMapTouches(n2) : void 0, c3 = l2 ? r.touchPos(this._el, l2) : r.mousePos(this._el, t2);
            for (const { handlerName: r2, handler: n3, allowed: h3 } of this._handlers) {
              if (!n3.isEnabled())
                continue;
              let u3;
              this._blockedByActive(s2, h3, r2) ? n3.reset() : n3[e2 || t2.type] && (u3 = n3[e2 || t2.type](t2, c3, l2), this.mergeHandlerResult(o2, a2, u3, r2, i2), u3 && u3.needsRenderFrame && this._triggerRenderFrame()), (u3 || n3.isActive()) && (s2[r2] = n3);
            }
            const h2 = {};
            for (const t3 in this._previousActiveHandlers)
              s2[t3] || (h2[t3] = i2);
            this._previousActiveHandlers = s2, (Object.keys(h2).length || Ko(o2)) && (this._changes.push([o2, a2, h2]), this._triggerRenderFrame()), (Object.keys(s2).length || Ko(o2)) && this._map._stop(true), this._updatingCamera = false;
            const { cameraAnimation: u2 } = o2;
            u2 && (this._inertia.clear(), this._fireEvents({}, {}, true), this._changes = [], u2(this._map));
          }
          mergeHandlerResult(e2, i2, o2, a2, r2) {
            if (!o2)
              return;
            t.extend(e2, o2);
            const s2 = { handlerName: a2, originalEvent: o2.originalEvent || r2 };
            void 0 !== o2.zoomDelta && (i2.zoom = s2), void 0 !== o2.panDelta && (i2.drag = s2), void 0 !== o2.pitchDelta && (i2.pitch = s2), void 0 !== o2.bearingDelta && (i2.rotate = s2);
          }
          _applyChanges() {
            const e2 = {}, i2 = {}, o2 = {};
            for (const [a2, r2, s2] of this._changes)
              a2.panDelta && (e2.panDelta = (e2.panDelta || new t.pointGeometry(0, 0))._add(a2.panDelta)), a2.zoomDelta && (e2.zoomDelta = (e2.zoomDelta || 0) + a2.zoomDelta), a2.bearingDelta && (e2.bearingDelta = (e2.bearingDelta || 0) + a2.bearingDelta), a2.pitchDelta && (e2.pitchDelta = (e2.pitchDelta || 0) + a2.pitchDelta), void 0 !== a2.around && (e2.around = a2.around), void 0 !== a2.pinchAround && (e2.pinchAround = a2.pinchAround), a2.noInertia && (e2.noInertia = a2.noInertia), t.extend(i2, r2), t.extend(o2, s2);
            this._updateMapTransform(e2, i2, o2), this._changes = [];
          }
          _updateMapTransform(e2, i2, o2) {
            const a2 = this._map, r2 = a2.transform, s2 = a2.style && a2.style.terrain;
            if (!(Ko(e2) || s2 && this._drag))
              return this._fireEvents(i2, o2, true);
            let { panDelta: n2, zoomDelta: l2, bearingDelta: c3, pitchDelta: h2, around: u2, pinchAround: d2 } = e2;
            void 0 !== d2 && (u2 = d2), a2._stop(true), u2 = u2 || a2.transform.centerPoint;
            const m2 = r2.pointLocation(n2 ? u2.sub(n2) : u2);
            c3 && (r2.bearing += c3), h2 && (r2.pitch += h2), l2 && (r2.zoom += l2), s2 ? i2.drag && !this._drag ? (this._drag = { center: r2.centerPoint, lngLat: r2.pointLocation(u2), point: u2, handlerName: i2.drag.handlerName }, a2.fire(new t.Event("freezeElevation", { freeze: true }))) : this._drag && o2[this._drag.handlerName] ? (a2.fire(new t.Event("freezeElevation", { freeze: false })), this._drag = null) : i2.drag && this._drag && (r2.center = r2.pointLocation(r2.centerPoint.sub(n2))) : r2.setLocationAtPoint(m2, u2), this._map._update(), e2.noInertia || this._inertia.record(e2), this._fireEvents(i2, o2, true);
          }
          _fireEvents(e2, i2, o2) {
            const a2 = Wo(this._eventsInProgress), r2 = Wo(e2), s2 = {};
            for (const t2 in e2) {
              const { originalEvent: i3 } = e2[t2];
              this._eventsInProgress[t2] || (s2[`${t2}start`] = i3), this._eventsInProgress[t2] = e2[t2];
            }
            !a2 && r2 && this._fireEvent("movestart", r2.originalEvent);
            for (const t2 in s2)
              this._fireEvent(t2, s2[t2]);
            r2 && this._fireEvent("move", r2.originalEvent);
            for (const t2 in e2) {
              const { originalEvent: i3 } = e2[t2];
              this._fireEvent(t2, i3);
            }
            const n2 = {};
            let l2;
            for (const t2 in this._eventsInProgress) {
              const { handlerName: e3, originalEvent: o3 } = this._eventsInProgress[t2];
              this._handlersById[e3].isActive() || (delete this._eventsInProgress[t2], l2 = i2[e3] || o3, n2[`${t2}end`] = l2);
            }
            for (const t2 in n2)
              this._fireEvent(t2, n2[t2]);
            const c3 = Wo(this._eventsInProgress);
            if (o2 && (a2 || r2) && !c3) {
              this._updatingCamera = true;
              const e3 = this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions), i3 = (t2) => 0 !== t2 && -this._bearingSnap < t2 && t2 < this._bearingSnap;
              e3 ? (i3(e3.bearing || this._map.getBearing()) && (e3.bearing = 0), this._map.easeTo(e3, { originalEvent: l2 })) : (this._map.fire(new t.Event("moveend", { originalEvent: l2 })), i3(this._map.getBearing()) && this._map.resetNorth()), this._updatingCamera = false;
            }
          }
          _fireEvent(e2, i2) {
            this._map.fire(new t.Event(e2, i2 ? { originalEvent: i2 } : {}));
          }
          _requestFrame() {
            return this._map.triggerRepaint(), this._map._renderTaskQueue.add((t2) => {
              delete this._frameId, this.handleEvent(new Ho("renderFrame", { timeStamp: t2 })), this._applyChanges();
            });
          }
          _triggerRenderFrame() {
            void 0 === this._frameId && (this._frameId = this._requestFrame());
          }
        }
        const Jo = { extend: (e2, ...i2) => t.extend(e2, ...i2), run(t2) {
          t2();
        }, logToElement(t2, e2 = false, i2 = "log") {
          const o2 = window.document.getElementById(i2);
          o2 && (e2 && (o2.innerHTML = ""), o2.innerHTML += `<br>${t2}`);
        } };
        class Qo extends t.Evented {
          constructor(e2, i2) {
            super(), this._moving = false, this._zooming = false, this.transform = e2, this._bearingSnap = i2.bearingSnap, t.bindAll(["_renderFrameCallback"], this);
          }
          getCenter() {
            return new t.LngLat(this.transform.center.lng, this.transform.center.lat);
          }
          setCenter(t2, e2) {
            return this.jumpTo({ center: t2 }, e2);
          }
          panBy(e2, i2, o2) {
            return e2 = t.pointGeometry.convert(e2).mult(-1), this.panTo(this.transform.center, t.extend({ offset: e2 }, i2), o2);
          }
          panTo(e2, i2, o2) {
            return this.easeTo(t.extend({ center: e2 }, i2), o2);
          }
          getZoom() {
            return this.transform.zoom;
          }
          setZoom(t2, e2) {
            return this.jumpTo({ zoom: t2 }, e2), this;
          }
          zoomTo(e2, i2, o2) {
            return this.easeTo(t.extend({ zoom: e2 }, i2), o2);
          }
          zoomIn(t2, e2) {
            return this.zoomTo(this.getZoom() + 1, t2, e2), this;
          }
          zoomOut(t2, e2) {
            return this.zoomTo(this.getZoom() - 1, t2, e2), this;
          }
          getBearing() {
            return this.transform.bearing;
          }
          setBearing(t2, e2) {
            return this.jumpTo({ bearing: t2 }, e2), this;
          }
          getPadding() {
            return this.transform.padding;
          }
          setPadding(t2, e2) {
            return this.jumpTo({ padding: t2 }, e2), this;
          }
          rotateTo(e2, i2, o2) {
            return this.easeTo(t.extend({ bearing: e2 }, i2), o2);
          }
          resetNorth(e2, i2) {
            return this.rotateTo(0, t.extend({ duration: 1e3 }, e2), i2), this;
          }
          resetNorthPitch(e2, i2) {
            return this.easeTo(t.extend({ bearing: 0, pitch: 0, duration: 1e3 }, e2), i2), this;
          }
          snapToNorth(t2, e2) {
            return Math.abs(this.getBearing()) < this._bearingSnap ? this.resetNorth(t2, e2) : this;
          }
          getPitch() {
            return this.transform.pitch;
          }
          setPitch(t2, e2) {
            return this.jumpTo({ pitch: t2 }, e2), this;
          }
          cameraForBounds(e2, i2) {
            e2 = t.LngLatBounds.convert(e2);
            const o2 = i2 && i2.bearing || 0;
            return this._cameraForBoxAndBearing(e2.getNorthWest(), e2.getSouthEast(), o2, i2);
          }
          _cameraForBoxAndBearing(e2, i2, o2, a2) {
            const r2 = { top: 0, bottom: 0, right: 0, left: 0 };
            if ("number" == typeof (a2 = t.extend({ padding: r2, offset: [0, 0], maxZoom: this.transform.maxZoom }, a2)).padding) {
              const t2 = a2.padding;
              a2.padding = { top: t2, bottom: t2, right: t2, left: t2 };
            }
            a2.padding = t.extend(r2, a2.padding);
            const s2 = this.transform, n2 = s2.padding, l2 = s2.project(t.LngLat.convert(e2)), c3 = s2.project(t.LngLat.convert(i2)), h2 = l2.rotate(-o2 * Math.PI / 180), u2 = c3.rotate(-o2 * Math.PI / 180), d2 = new t.pointGeometry(Math.max(h2.x, u2.x), Math.max(h2.y, u2.y)), m2 = new t.pointGeometry(Math.min(h2.x, u2.x), Math.min(h2.y, u2.y)), _2 = d2.sub(m2), p3 = (s2.width - (n2.left + n2.right + a2.padding.left + a2.padding.right)) / _2.x, f2 = (s2.height - (n2.top + n2.bottom + a2.padding.top + a2.padding.bottom)) / _2.y;
            if (f2 < 0 || p3 < 0)
              return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");
            const g2 = Math.min(s2.scaleZoom(s2.scale * Math.min(p3, f2)), a2.maxZoom), x2 = t.pointGeometry.convert(a2.offset), v3 = new t.pointGeometry((a2.padding.left - a2.padding.right) / 2, (a2.padding.top - a2.padding.bottom) / 2).rotate(o2 * Math.PI / 180), y3 = x2.add(v3).mult(s2.scale / s2.zoomScale(g2));
            return { center: s2.unproject(l2.add(c3).div(2).sub(y3)), zoom: g2, bearing: o2 };
          }
          fitBounds(t2, e2, i2) {
            return this._fitInternal(this.cameraForBounds(t2, e2), e2, i2);
          }
          fitScreenCoordinates(e2, i2, o2, a2, r2) {
            return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.pointGeometry.convert(e2)), this.transform.pointLocation(t.pointGeometry.convert(i2)), o2, a2), a2, r2);
          }
          _fitInternal(e2, i2, o2) {
            return e2 ? (delete (i2 = t.extend(e2, i2)).padding, i2.linear ? this.easeTo(i2, o2) : this.flyTo(i2, o2)) : this;
          }
          jumpTo(e2, i2) {
            this.stop();
            const o2 = this.transform;
            let a2 = false, r2 = false, s2 = false;
            return "zoom" in e2 && o2.zoom !== +e2.zoom && (a2 = true, o2.zoom = +e2.zoom), void 0 !== e2.center && (o2.center = t.LngLat.convert(e2.center)), "bearing" in e2 && o2.bearing !== +e2.bearing && (r2 = true, o2.bearing = +e2.bearing), "pitch" in e2 && o2.pitch !== +e2.pitch && (s2 = true, o2.pitch = +e2.pitch), null == e2.padding || o2.isPaddingEqual(e2.padding) || (o2.padding = e2.padding), this.fire(new t.Event("movestart", i2)).fire(new t.Event("move", i2)), a2 && this.fire(new t.Event("zoomstart", i2)).fire(new t.Event("zoom", i2)).fire(new t.Event("zoomend", i2)), r2 && this.fire(new t.Event("rotatestart", i2)).fire(new t.Event("rotate", i2)).fire(new t.Event("rotateend", i2)), s2 && this.fire(new t.Event("pitchstart", i2)).fire(new t.Event("pitch", i2)).fire(new t.Event("pitchend", i2)), this.fire(new t.Event("moveend", i2));
          }
          calculateCameraOptionsFromTo(e2, i2, o2, a2 = 0) {
            const r2 = t.MercatorCoordinate.fromLngLat(e2, i2), s2 = t.MercatorCoordinate.fromLngLat(o2, a2), n2 = s2.x - r2.x, l2 = s2.y - r2.y, c3 = s2.z - r2.z, h2 = Math.hypot(n2, l2, c3);
            if (0 === h2)
              throw new Error("Can't calculate camera options with same From and To");
            const u2 = Math.hypot(n2, l2), d2 = this.transform.scaleZoom(this.transform.cameraToCenterDistance / h2 / this.transform.tileSize), m2 = 180 * Math.atan2(n2, -l2) / Math.PI;
            let _2 = 180 * Math.acos(u2 / h2) / Math.PI;
            return _2 = c3 < 0 ? 90 - _2 : 90 + _2, { center: s2.toLngLat(), zoom: d2, pitch: _2, bearing: m2 };
          }
          easeTo(e2, i2) {
            this._stop(false, e2.easeId), (false === (e2 = t.extend({ offset: [0, 0], duration: 500, easing: t.ease }, e2)).animate || !e2.essential && t.exported.prefersReducedMotion) && (e2.duration = 0);
            const o2 = this.transform, a2 = this.getZoom(), r2 = this.getBearing(), s2 = this.getPitch(), n2 = this.getPadding(), l2 = "zoom" in e2 ? +e2.zoom : a2, c3 = "bearing" in e2 ? this._normalizeBearing(e2.bearing, r2) : r2, h2 = "pitch" in e2 ? +e2.pitch : s2, u2 = "padding" in e2 ? e2.padding : o2.padding, d2 = t.pointGeometry.convert(e2.offset);
            let m2 = o2.centerPoint.add(d2);
            const _2 = o2.pointLocation(m2), p3 = t.LngLat.convert(e2.center || _2);
            this._normalizeCenter(p3);
            const f2 = o2.project(_2), g2 = o2.project(p3).sub(f2), x2 = o2.zoomScale(l2 - a2);
            let v3, y3;
            e2.around && (v3 = t.LngLat.convert(e2.around), y3 = o2.locationPoint(v3));
            const b2 = { moving: this._moving, zooming: this._zooming, rotating: this._rotating, pitching: this._pitching };
            return this._zooming = this._zooming || l2 !== a2, this._rotating = this._rotating || r2 !== c3, this._pitching = this._pitching || h2 !== s2, this._padding = !o2.isPaddingEqual(u2), this._easeId = e2.easeId, this._prepareEase(i2, e2.noMoveStart, b2), this._ease((e3) => {
              if (this._zooming && (o2.zoom = t.number(a2, l2, e3)), this._rotating && (o2.bearing = t.number(r2, c3, e3)), this._pitching && (o2.pitch = t.number(s2, h2, e3)), this._padding && (o2.interpolatePadding(n2, u2, e3), m2 = o2.centerPoint.add(d2)), v3)
                o2.setLocationAtPoint(v3, y3);
              else {
                const t2 = o2.zoomScale(o2.zoom - a2), i3 = l2 > a2 ? Math.min(2, x2) : Math.max(0.5, x2), r3 = Math.pow(i3, 1 - e3), s3 = o2.unproject(f2.add(g2.mult(e3 * r3)).mult(t2));
                o2.setLocationAtPoint(o2.renderWorldCopies ? s3.wrap() : s3, m2);
              }
              this._fireMoveEvents(i2);
            }, (t2) => {
              this._afterEase(i2, t2);
            }, e2), this;
          }
          _prepareEase(e2, i2, o2 = {}) {
            this._moving = true, this.fire(new t.Event("freezeElevation", { freeze: true })), i2 || o2.moving || this.fire(new t.Event("movestart", e2)), this._zooming && !o2.zooming && this.fire(new t.Event("zoomstart", e2)), this._rotating && !o2.rotating && this.fire(new t.Event("rotatestart", e2)), this._pitching && !o2.pitching && this.fire(new t.Event("pitchstart", e2));
          }
          _fireMoveEvents(e2) {
            this.fire(new t.Event("move", e2)), this._zooming && this.fire(new t.Event("zoom", e2)), this._rotating && this.fire(new t.Event("rotate", e2)), this._pitching && this.fire(new t.Event("pitch", e2));
          }
          _afterEase(e2, i2) {
            if (this._easeId && i2 && this._easeId === i2)
              return;
            delete this._easeId, this.fire(new t.Event("freezeElevation", { freeze: false }));
            const o2 = this._zooming, a2 = this._rotating, r2 = this._pitching;
            this._moving = false, this._zooming = false, this._rotating = false, this._pitching = false, this._padding = false, o2 && this.fire(new t.Event("zoomend", e2)), a2 && this.fire(new t.Event("rotateend", e2)), r2 && this.fire(new t.Event("pitchend", e2)), this.fire(new t.Event("moveend", e2));
          }
          flyTo(e2, i2) {
            if (!e2.essential && t.exported.prefersReducedMotion) {
              const o3 = t.pick(e2, ["center", "zoom", "bearing", "pitch", "around"]);
              return this.jumpTo(o3, i2);
            }
            this.stop(), e2 = t.extend({ offset: [0, 0], speed: 1.2, curve: 1.42, easing: t.ease }, e2);
            const o2 = this.transform, a2 = this.getZoom(), r2 = this.getBearing(), s2 = this.getPitch(), n2 = this.getPadding(), l2 = "zoom" in e2 ? t.clamp(+e2.zoom, o2.minZoom, o2.maxZoom) : a2, c3 = "bearing" in e2 ? this._normalizeBearing(e2.bearing, r2) : r2, h2 = "pitch" in e2 ? +e2.pitch : s2, u2 = "padding" in e2 ? e2.padding : o2.padding, d2 = o2.zoomScale(l2 - a2), m2 = t.pointGeometry.convert(e2.offset);
            let _2 = o2.centerPoint.add(m2);
            const p3 = o2.pointLocation(_2), f2 = t.LngLat.convert(e2.center || p3);
            this._normalizeCenter(f2);
            const g2 = o2.project(p3), x2 = o2.project(f2).sub(g2);
            let v3 = e2.curve;
            const y3 = Math.max(o2.width, o2.height), b2 = y3 / d2, w2 = x2.mag();
            if ("minZoom" in e2) {
              const i3 = t.clamp(Math.min(e2.minZoom, a2, l2), o2.minZoom, o2.maxZoom), r3 = y3 / o2.zoomScale(i3 - a2);
              v3 = Math.sqrt(r3 / w2 * 2);
            }
            const T2 = v3 * v3;
            function E2(t2) {
              const e3 = (b2 * b2 - y3 * y3 + (t2 ? -1 : 1) * T2 * T2 * w2 * w2) / (2 * (t2 ? b2 : y3) * T2 * w2);
              return Math.log(Math.sqrt(e3 * e3 + 1) - e3);
            }
            function I3(t2) {
              return (Math.exp(t2) - Math.exp(-t2)) / 2;
            }
            function C2(t2) {
              return (Math.exp(t2) + Math.exp(-t2)) / 2;
            }
            const S2 = E2(0);
            let D2 = function(t2) {
              return C2(S2) / C2(S2 + v3 * t2);
            }, z2 = function(t2) {
              return y3 * ((C2(S2) * (I3(e3 = S2 + v3 * t2) / C2(e3)) - I3(S2)) / T2) / w2;
              var e3;
            }, P2 = (E2(1) - S2) / v3;
            if (Math.abs(w2) < 1e-6 || !isFinite(P2)) {
              if (Math.abs(y3 - b2) < 1e-6)
                return this.easeTo(e2, i2);
              const t2 = b2 < y3 ? -1 : 1;
              P2 = Math.abs(Math.log(b2 / y3)) / v3, z2 = function() {
                return 0;
              }, D2 = function(e3) {
                return Math.exp(t2 * v3 * e3);
              };
            }
            return e2.duration = "duration" in e2 ? +e2.duration : 1e3 * P2 / ("screenSpeed" in e2 ? +e2.screenSpeed / v3 : +e2.speed), e2.maxDuration && e2.duration > e2.maxDuration && (e2.duration = 0), this._zooming = true, this._rotating = r2 !== c3, this._pitching = h2 !== s2, this._padding = !o2.isPaddingEqual(u2), this._prepareEase(i2, false), this._ease((e3) => {
              const d3 = e3 * P2, p4 = 1 / D2(d3);
              o2.zoom = 1 === e3 ? l2 : a2 + o2.scaleZoom(p4), this._rotating && (o2.bearing = t.number(r2, c3, e3)), this._pitching && (o2.pitch = t.number(s2, h2, e3)), this._padding && (o2.interpolatePadding(n2, u2, e3), _2 = o2.centerPoint.add(m2));
              const v4 = 1 === e3 ? f2 : o2.unproject(g2.add(x2.mult(z2(d3))).mult(p4));
              o2.setLocationAtPoint(o2.renderWorldCopies ? v4.wrap() : v4, _2), this._fireMoveEvents(i2);
            }, () => this._afterEase(i2), e2), this;
          }
          isEasing() {
            return !!this._easeFrameId;
          }
          stop() {
            return this._stop();
          }
          _stop(t2, e2) {
            if (this._easeFrameId && (this._cancelRenderFrame(this._easeFrameId), delete this._easeFrameId, delete this._onEaseFrame), this._onEaseEnd) {
              const t3 = this._onEaseEnd;
              delete this._onEaseEnd, t3.call(this, e2);
            }
            if (!t2) {
              const t3 = this.handlers;
              t3 && t3.stop(false);
            }
            return this;
          }
          _ease(e2, i2, o2) {
            false === o2.animate || 0 === o2.duration ? (e2(1), i2()) : (this._easeStart = t.exported.now(), this._easeOptions = o2, this._onEaseFrame = e2, this._onEaseEnd = i2, this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback));
          }
          _renderFrameCallback() {
            const e2 = Math.min((t.exported.now() - this._easeStart) / this._easeOptions.duration, 1);
            this._onEaseFrame(this._easeOptions.easing(e2)), e2 < 1 ? this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback) : this.stop();
          }
          _normalizeBearing(e2, i2) {
            e2 = t.wrap(e2, -180, 180);
            const o2 = Math.abs(e2 - i2);
            return Math.abs(e2 - 360 - i2) < o2 && (e2 -= 360), Math.abs(e2 + 360 - i2) < o2 && (e2 += 360), e2;
          }
          _normalizeCenter(t2) {
            const e2 = this.transform;
            if (!e2.renderWorldCopies || e2.lngRange)
              return;
            const i2 = t2.lng - e2.center.lng;
            t2.lng += i2 > 180 ? -360 : i2 < -180 ? 360 : 0;
          }
        }
        class ta {
          constructor(e2 = {}) {
            this.options = e2, t.bindAll(["_toggleAttribution", "_updateData", "_updateCompact", "_updateCompactMinimize"], this);
          }
          getDefaultPosition() {
            return "bottom-right";
          }
          onAdd(t2) {
            return this._map = t2, this._compact = this.options && this.options.compact, this._container = r.create("details", "maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"), this._compactButton = r.create("summary", "maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button", this._container), this._compactButton.addEventListener("click", this._toggleAttribution), this._setElementTitle(this._compactButton, "ToggleAttribution"), this._innerContainer = r.create("div", "maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner", this._container), this._updateAttributions(), this._updateCompact(), this._map.on("styledata", this._updateData), this._map.on("sourcedata", this._updateData), this._map.on("terrain", this._updateData), this._map.on("resize", this._updateCompact), this._map.on("drag", this._updateCompactMinimize), this._container;
          }
          onRemove() {
            r.remove(this._container), this._map.off("styledata", this._updateData), this._map.off("sourcedata", this._updateData), this._map.off("terrain", this._updateData), this._map.off("resize", this._updateCompact), this._map.off("drag", this._updateCompactMinimize), this._map = void 0, this._compact = void 0, this._attribHTML = void 0;
          }
          _setElementTitle(t2, e2) {
            const i2 = this._map._getUIString(`AttributionControl.${e2}`);
            t2.title = i2, t2.setAttribute("aria-label", i2);
          }
          _toggleAttribution() {
            this._container.classList.contains("maplibregl-compact") && (this._container.classList.contains("maplibregl-compact-show") ? (this._container.setAttribute("open", ""), this._container.classList.remove("maplibregl-compact-show", "mapboxgl-compact-show")) : (this._container.classList.add("maplibregl-compact-show", "mapboxgl-compact-show"), this._container.removeAttribute("open")));
          }
          _updateData(t2) {
            !t2 || "metadata" !== t2.sourceDataType && "visibility" !== t2.sourceDataType && "style" !== t2.dataType && "terrain" !== t2.type || this._updateAttributions();
          }
          _updateAttributions() {
            if (!this._map.style)
              return;
            let t2 = [];
            if (this.options.customAttribution && (Array.isArray(this.options.customAttribution) ? t2 = t2.concat(this.options.customAttribution.map((t3) => "string" != typeof t3 ? "" : t3)) : "string" == typeof this.options.customAttribution && t2.push(this.options.customAttribution)), this._map.style.stylesheet) {
              const t3 = this._map.style.stylesheet;
              this.styleOwner = t3.owner, this.styleId = t3.id;
            }
            const e2 = this._map.style.sourceCaches;
            for (const i3 in e2) {
              const o2 = e2[i3];
              if (o2.used || o2.usedForTerrain) {
                const e3 = o2.getSource();
                e3.attribution && t2.indexOf(e3.attribution) < 0 && t2.push(e3.attribution);
              }
            }
            t2 = t2.filter((t3) => String(t3).trim()), t2.sort((t3, e3) => t3.length - e3.length), t2 = t2.filter((e3, i3) => {
              for (let o2 = i3 + 1; o2 < t2.length; o2++)
                if (t2[o2].indexOf(e3) >= 0)
                  return false;
              return true;
            });
            const i2 = t2.join(" | ");
            i2 !== this._attribHTML && (this._attribHTML = i2, t2.length ? (this._innerContainer.innerHTML = i2, this._container.classList.remove("maplibregl-attrib-empty", "mapboxgl-attrib-empty")) : this._container.classList.add("maplibregl-attrib-empty", "mapboxgl-attrib-empty"), this._updateCompact(), this._editLink = null);
          }
          _updateCompact() {
            this._map.getCanvasContainer().offsetWidth <= 640 || this._compact ? false === this._compact ? this._container.setAttribute("open", "") : this._container.classList.contains("maplibregl-compact") || this._container.classList.contains("maplibregl-attrib-empty") || (this._container.setAttribute("open", ""), this._container.classList.add("maplibregl-compact", "mapboxgl-compact", "maplibregl-compact-show", "mapboxgl-compact-show")) : (this._container.setAttribute("open", ""), this._container.classList.contains("maplibregl-compact") && this._container.classList.remove("maplibregl-compact", "maplibregl-compact-show", "mapboxgl-compact", "mapboxgl-compact-show"));
          }
          _updateCompactMinimize() {
            this._container.classList.contains("maplibregl-compact") && this._container.classList.contains("maplibregl-compact-show") && this._container.classList.remove("maplibregl-compact-show", "mapboxgl-compact-show");
          }
        }
        class ea {
          constructor(e2 = {}) {
            this.options = e2, t.bindAll(["_updateCompact"], this);
          }
          getDefaultPosition() {
            return "bottom-left";
          }
          onAdd(t2) {
            this._map = t2, this._compact = this.options && this.options.compact, this._container = r.create("div", "maplibregl-ctrl mapboxgl-ctrl");
            const e2 = r.create("a", "maplibregl-ctrl-logo mapboxgl-ctrl-logo");
            return e2.target = "_blank", e2.rel = "noopener nofollow", e2.href = "https://maplibre.org/", e2.setAttribute("aria-label", this._map._getUIString("LogoControl.Title")), e2.setAttribute("rel", "noopener nofollow"), this._container.appendChild(e2), this._container.style.display = "block", this._map.on("resize", this._updateCompact), this._updateCompact(), this._container;
          }
          onRemove() {
            r.remove(this._container), this._map.off("resize", this._updateCompact), this._map = void 0, this._compact = void 0;
          }
          _updateCompact() {
            const t2 = this._container.children;
            if (t2.length) {
              const e2 = t2[0];
              this._map.getCanvasContainer().offsetWidth <= 640 || this._compact ? false !== this._compact && e2.classList.add("maplibregl-compact", "mapboxgl-compact") : e2.classList.remove("maplibregl-compact", "mapboxgl-compact");
            }
          }
        }
        class ia {
          constructor() {
            this._queue = [], this._id = 0, this._cleared = false, this._currentlyRunning = false;
          }
          add(t2) {
            const e2 = ++this._id;
            return this._queue.push({ callback: t2, id: e2, cancelled: false }), e2;
          }
          remove(t2) {
            const e2 = this._currentlyRunning, i2 = e2 ? this._queue.concat(e2) : this._queue;
            for (const e3 of i2)
              if (e3.id === t2)
                return void (e3.cancelled = true);
          }
          run(t2 = 0) {
            if (this._currentlyRunning)
              throw new Error("Attempting to run(), but is already running.");
            const e2 = this._currentlyRunning = this._queue;
            this._queue = [];
            for (const i2 of e2)
              if (!i2.cancelled && (i2.callback(t2), this._cleared))
                break;
            this._cleared = false, this._currentlyRunning = false;
          }
          clear() {
            this._currentlyRunning && (this._cleared = true), this._queue = [];
          }
        }
        const oa = { "AttributionControl.ToggleAttribution": "Toggle attribution", "AttributionControl.MapFeedback": "Map feedback", "FullscreenControl.Enter": "Enter fullscreen", "FullscreenControl.Exit": "Exit fullscreen", "GeolocateControl.FindMyLocation": "Find my location", "GeolocateControl.LocationNotAvailable": "Location not available", "LogoControl.Title": "Mapbox logo", "NavigationControl.ResetBearing": "Reset bearing to north", "NavigationControl.ZoomIn": "Zoom in", "NavigationControl.ZoomOut": "Zoom out", "ScaleControl.Feet": "ft", "ScaleControl.Meters": "m", "ScaleControl.Kilometers": "km", "ScaleControl.Miles": "mi", "ScaleControl.NauticalMiles": "nm", "TerrainControl.enableTerrain": "Enable terrain", "TerrainControl.disableTerrain": "Disable terrain" }, aa = { center: [0, 0], zoom: 0, bearing: 0, pitch: 0, minZoom: -2, maxZoom: 22, minPitch: 0, maxPitch: 60, interactive: true, scrollZoom: true, boxZoom: true, dragRotate: true, dragPan: true, keyboard: true, doubleClickZoom: true, touchZoomRotate: true, touchPitch: true, cooperativeGestures: void 0, bearingSnap: 7, clickTolerance: 3, pitchWithRotate: true, hash: false, attributionControl: true, maplibreLogo: false, failIfMajorPerformanceCaveat: false, preserveDrawingBuffer: false, trackResize: true, renderWorldCopies: true, refreshExpiredTiles: true, maxTileCacheSize: null, localIdeographFontFamily: "sans-serif", transformRequest: null, fadeDuration: 300, crossSourceCollisions: true }, ra = { showCompass: true, showZoom: true, visualizePitch: false };
        class sa {
          constructor(e2, i2, o2 = false) {
            this._clickTolerance = 10, this.element = i2, this.mouseRotate = new Co({ clickTolerance: e2.dragRotate._mouseRotate._clickTolerance }), this.map = e2, o2 && (this.mousePitch = new So({ clickTolerance: e2.dragRotate._mousePitch._clickTolerance })), t.bindAll(["mousedown", "mousemove", "mouseup", "touchstart", "touchmove", "touchend", "reset"], this), r.addEventListener(i2, "mousedown", this.mousedown), r.addEventListener(i2, "touchstart", this.touchstart, { passive: false }), r.addEventListener(i2, "touchmove", this.touchmove), r.addEventListener(i2, "touchend", this.touchend), r.addEventListener(i2, "touchcancel", this.reset);
          }
          down(t2, e2) {
            this.mouseRotate.mousedown(t2, e2), this.mousePitch && this.mousePitch.mousedown(t2, e2), r.disableDrag();
          }
          move(t2, e2) {
            const i2 = this.map, o2 = this.mouseRotate.mousemoveWindow(t2, e2);
            if (o2 && o2.bearingDelta && i2.setBearing(i2.getBearing() + o2.bearingDelta), this.mousePitch) {
              const o3 = this.mousePitch.mousemoveWindow(t2, e2);
              o3 && o3.pitchDelta && i2.setPitch(i2.getPitch() + o3.pitchDelta);
            }
          }
          off() {
            const t2 = this.element;
            r.removeEventListener(t2, "mousedown", this.mousedown), r.removeEventListener(t2, "touchstart", this.touchstart, { passive: false }), r.removeEventListener(t2, "touchmove", this.touchmove), r.removeEventListener(t2, "touchend", this.touchend), r.removeEventListener(t2, "touchcancel", this.reset), this.offTemp();
          }
          offTemp() {
            r.enableDrag(), r.removeEventListener(window, "mousemove", this.mousemove), r.removeEventListener(window, "mouseup", this.mouseup);
          }
          mousedown(e2) {
            this.down(t.extend({}, e2, { ctrlKey: true, preventDefault: () => e2.preventDefault() }), r.mousePos(this.element, e2)), r.addEventListener(window, "mousemove", this.mousemove), r.addEventListener(window, "mouseup", this.mouseup);
          }
          mousemove(t2) {
            this.move(t2, r.mousePos(this.element, t2));
          }
          mouseup(t2) {
            this.mouseRotate.mouseupWindow(t2), this.mousePitch && this.mousePitch.mouseupWindow(t2), this.offTemp();
          }
          touchstart(t2) {
            1 !== t2.targetTouches.length ? this.reset() : (this._startPos = this._lastPos = r.touchPos(this.element, t2.targetTouches)[0], this.down({ type: "mousedown", button: 0, ctrlKey: true, preventDefault: () => t2.preventDefault() }, this._startPos));
          }
          touchmove(t2) {
            1 !== t2.targetTouches.length ? this.reset() : (this._lastPos = r.touchPos(this.element, t2.targetTouches)[0], this.move({ preventDefault: () => t2.preventDefault() }, this._lastPos));
          }
          touchend(t2) {
            0 === t2.targetTouches.length && this._startPos && this._lastPos && this._startPos.dist(this._lastPos) < this._clickTolerance && this.element.click(), this.reset();
          }
          reset() {
            this.mouseRotate.reset(), this.mousePitch && this.mousePitch.reset(), delete this._startPos, delete this._lastPos, this.offTemp();
          }
        }
        function na(e2, i2, o2) {
          if (e2 = new t.LngLat(e2.lng, e2.lat), i2) {
            const a2 = new t.LngLat(e2.lng - 360, e2.lat), r2 = new t.LngLat(e2.lng + 360, e2.lat), s2 = o2.locationPoint(e2).distSqr(i2);
            o2.locationPoint(a2).distSqr(i2) < s2 ? e2 = a2 : o2.locationPoint(r2).distSqr(i2) < s2 && (e2 = r2);
          }
          for (; Math.abs(e2.lng - o2.center.lng) > 180; ) {
            const t2 = o2.locationPoint(e2);
            if (t2.x >= 0 && t2.y >= 0 && t2.x <= o2.width && t2.y <= o2.height)
              break;
            e2.lng > o2.center.lng ? e2.lng -= 360 : e2.lng += 360;
          }
          return e2;
        }
        const la = { center: "translate(-50%,-50%)", top: "translate(-50%,0)", "top-left": "translate(0,0)", "top-right": "translate(-100%,0)", bottom: "translate(-50%,-100%)", "bottom-left": "translate(0,-100%)", "bottom-right": "translate(-100%,-100%)", left: "translate(0,-50%)", right: "translate(-100%,-50%)" };
        function ca(t2, e2, i2) {
          const o2 = t2.classList;
          for (const t3 in la)
            o2.remove(`maplibregl-${i2}-anchor-${t3}`, `mapboxgl-${i2}-anchor-${t3}`);
          o2.add(`maplibregl-${i2}-anchor-${e2}`, `mapboxgl-${i2}-anchor-${e2}`);
        }
        class ha extends t.Evented {
          constructor(e2, i2) {
            if (super(), (e2 instanceof HTMLElement || i2) && (e2 = t.extend({ element: e2 }, i2)), t.bindAll(["_update", "_onMove", "_onUp", "_addDragHandler", "_onMapClick", "_onKeyPress"], this), this._anchor = e2 && e2.anchor || "center", this._color = e2 && e2.color || "#3FB1CE", this._scale = e2 && e2.scale || 1, this._draggable = e2 && e2.draggable || false, this._clickTolerance = e2 && e2.clickTolerance || 0, this._isDragging = false, this._state = "inactive", this._rotation = e2 && e2.rotation || 0, this._rotationAlignment = e2 && e2.rotationAlignment || "auto", this._pitchAlignment = e2 && e2.pitchAlignment && "auto" !== e2.pitchAlignment ? e2.pitchAlignment : this._rotationAlignment, e2 && e2.element)
              this._element = e2.element, this._offset = t.pointGeometry.convert(e2 && e2.offset || [0, 0]);
            else {
              this._defaultMarker = true, this._element = r.create("div"), this._element.setAttribute("aria-label", "Map marker");
              const i3 = r.createNS("http://www.w3.org/2000/svg", "svg"), o2 = 41, a2 = 27;
              i3.setAttributeNS(null, "display", "block"), i3.setAttributeNS(null, "height", `${o2}px`), i3.setAttributeNS(null, "width", `${a2}px`), i3.setAttributeNS(null, "viewBox", `0 0 ${a2} ${o2}`);
              const s2 = r.createNS("http://www.w3.org/2000/svg", "g");
              s2.setAttributeNS(null, "stroke", "none"), s2.setAttributeNS(null, "stroke-width", "1"), s2.setAttributeNS(null, "fill", "none"), s2.setAttributeNS(null, "fill-rule", "evenodd");
              const n2 = r.createNS("http://www.w3.org/2000/svg", "g");
              n2.setAttributeNS(null, "fill-rule", "nonzero");
              const l2 = r.createNS("http://www.w3.org/2000/svg", "g");
              l2.setAttributeNS(null, "transform", "translate(3.0, 29.0)"), l2.setAttributeNS(null, "fill", "#000000");
              const c3 = [{ rx: "10.5", ry: "5.25002273" }, { rx: "10.5", ry: "5.25002273" }, { rx: "9.5", ry: "4.77275007" }, { rx: "8.5", ry: "4.29549936" }, { rx: "7.5", ry: "3.81822308" }, { rx: "6.5", ry: "3.34094679" }, { rx: "5.5", ry: "2.86367051" }, { rx: "4.5", ry: "2.38636864" }];
              for (const t2 of c3) {
                const e3 = r.createNS("http://www.w3.org/2000/svg", "ellipse");
                e3.setAttributeNS(null, "opacity", "0.04"), e3.setAttributeNS(null, "cx", "10.5"), e3.setAttributeNS(null, "cy", "5.80029008"), e3.setAttributeNS(null, "rx", t2.rx), e3.setAttributeNS(null, "ry", t2.ry), l2.appendChild(e3);
              }
              const h2 = r.createNS("http://www.w3.org/2000/svg", "g");
              h2.setAttributeNS(null, "fill", this._color);
              const u2 = r.createNS("http://www.w3.org/2000/svg", "path");
              u2.setAttributeNS(null, "d", "M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"), h2.appendChild(u2);
              const d2 = r.createNS("http://www.w3.org/2000/svg", "g");
              d2.setAttributeNS(null, "opacity", "0.25"), d2.setAttributeNS(null, "fill", "#000000");
              const m2 = r.createNS("http://www.w3.org/2000/svg", "path");
              m2.setAttributeNS(null, "d", "M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"), d2.appendChild(m2);
              const _2 = r.createNS("http://www.w3.org/2000/svg", "g");
              _2.setAttributeNS(null, "transform", "translate(6.0, 7.0)"), _2.setAttributeNS(null, "fill", "#FFFFFF");
              const p3 = r.createNS("http://www.w3.org/2000/svg", "g");
              p3.setAttributeNS(null, "transform", "translate(8.0, 8.0)");
              const f2 = r.createNS("http://www.w3.org/2000/svg", "circle");
              f2.setAttributeNS(null, "fill", "#000000"), f2.setAttributeNS(null, "opacity", "0.25"), f2.setAttributeNS(null, "cx", "5.5"), f2.setAttributeNS(null, "cy", "5.5"), f2.setAttributeNS(null, "r", "5.4999962");
              const g2 = r.createNS("http://www.w3.org/2000/svg", "circle");
              g2.setAttributeNS(null, "fill", "#FFFFFF"), g2.setAttributeNS(null, "cx", "5.5"), g2.setAttributeNS(null, "cy", "5.5"), g2.setAttributeNS(null, "r", "5.4999962"), p3.appendChild(f2), p3.appendChild(g2), n2.appendChild(l2), n2.appendChild(h2), n2.appendChild(d2), n2.appendChild(_2), n2.appendChild(p3), i3.appendChild(n2), i3.setAttributeNS(null, "height", o2 * this._scale + "px"), i3.setAttributeNS(null, "width", a2 * this._scale + "px"), this._element.appendChild(i3), this._offset = t.pointGeometry.convert(e2 && e2.offset || [0, -14]);
            }
            this._element.classList.add("maplibregl-marker", "mapboxgl-marker"), this._element.addEventListener("dragstart", (t2) => {
              t2.preventDefault();
            }), this._element.addEventListener("mousedown", (t2) => {
              t2.preventDefault();
            }), ca(this._element, this._anchor, "marker"), this._popup = null;
          }
          addTo(t2) {
            return this.remove(), this._map = t2, t2.getCanvasContainer().appendChild(this._element), t2.on("move", this._update), t2.on("moveend", this._update), this.setDraggable(this._draggable), this._update(), this._map.on("click", this._onMapClick), this;
          }
          remove() {
            return this._opacityTimeout && (clearTimeout(this._opacityTimeout), delete this._opacityTimeout), this._map && (this._map.off("click", this._onMapClick), this._map.off("move", this._update), this._map.off("moveend", this._update), this._map.off("mousedown", this._addDragHandler), this._map.off("touchstart", this._addDragHandler), this._map.off("mouseup", this._onUp), this._map.off("touchend", this._onUp), this._map.off("mousemove", this._onMove), this._map.off("touchmove", this._onMove), delete this._map), r.remove(this._element), this._popup && this._popup.remove(), this;
          }
          getLngLat() {
            return this._lngLat;
          }
          setLngLat(e2) {
            return this._lngLat = t.LngLat.convert(e2), this._pos = null, this._popup && this._popup.setLngLat(this._lngLat), this._update(), this;
          }
          getElement() {
            return this._element;
          }
          setPopup(t2) {
            if (this._popup && (this._popup.remove(), this._popup = null, this._element.removeEventListener("keypress", this._onKeyPress), this._originalTabIndex || this._element.removeAttribute("tabindex")), t2) {
              if (!("offset" in t2.options)) {
                const e2 = 38.1, i2 = 13.5, o2 = Math.sqrt(Math.pow(i2, 2) / 2);
                t2.options.offset = this._defaultMarker ? { top: [0, 0], "top-left": [0, 0], "top-right": [0, 0], bottom: [0, -e2], "bottom-left": [o2, -1 * (e2 - i2 + o2)], "bottom-right": [-o2, -1 * (e2 - i2 + o2)], left: [i2, -1 * (e2 - i2)], right: [-i2, -1 * (e2 - i2)] } : this._offset;
              }
              this._popup = t2, this._lngLat && this._popup.setLngLat(this._lngLat), this._originalTabIndex = this._element.getAttribute("tabindex"), this._originalTabIndex || this._element.setAttribute("tabindex", "0"), this._element.addEventListener("keypress", this._onKeyPress);
            }
            return this;
          }
          _onKeyPress(t2) {
            const e2 = t2.code, i2 = t2.charCode || t2.keyCode;
            "Space" !== e2 && "Enter" !== e2 && 32 !== i2 && 13 !== i2 || this.togglePopup();
          }
          _onMapClick(t2) {
            const e2 = t2.originalEvent.target, i2 = this._element;
            this._popup && (e2 === i2 || i2.contains(e2)) && this.togglePopup();
          }
          getPopup() {
            return this._popup;
          }
          togglePopup() {
            const t2 = this._popup;
            return t2 ? (t2.isOpen() ? t2.remove() : t2.addTo(this._map), this) : this;
          }
          _update(t2) {
            if (!this._map)
              return;
            this._map.transform.renderWorldCopies && (this._lngLat = na(this._lngLat, this._pos, this._map.transform)), this._pos = this._map.project(this._lngLat)._add(this._offset);
            let e2 = "";
            "viewport" === this._rotationAlignment || "auto" === this._rotationAlignment ? e2 = `rotateZ(${this._rotation}deg)` : "map" === this._rotationAlignment && (e2 = `rotateZ(${this._rotation - this._map.getBearing()}deg)`);
            let i2 = "";
            "viewport" === this._pitchAlignment || "auto" === this._pitchAlignment ? i2 = "rotateX(0deg)" : "map" === this._pitchAlignment && (i2 = `rotateX(${this._map.getPitch()}deg)`), t2 && "moveend" !== t2.type || (this._pos = this._pos.round()), r.setTransform(this._element, `${la[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${i2} ${e2}`), this._map.style && this._map.style.terrain && !this._opacityTimeout && (this._opacityTimeout = setTimeout(() => {
              const t3 = this._map.unproject(this._pos), e3 = 40075016686e-3 * Math.abs(Math.cos(this._lngLat.lat * Math.PI / 180)) / Math.pow(2, this._map.transform.tileZoom + 8);
              this._element.style.opacity = t3.distanceTo(this._lngLat) > 20 * e3 ? "0.2" : "1.0", this._opacityTimeout = null;
            }, 100));
          }
          getOffset() {
            return this._offset;
          }
          setOffset(e2) {
            return this._offset = t.pointGeometry.convert(e2), this._update(), this;
          }
          _onMove(e2) {
            if (!this._isDragging) {
              const t2 = this._clickTolerance || this._map._clickTolerance;
              this._isDragging = e2.point.dist(this._pointerdownPos) >= t2;
            }
            this._isDragging && (this._pos = e2.point.sub(this._positionDelta), this._lngLat = this._map.unproject(this._pos), this.setLngLat(this._lngLat), this._element.style.pointerEvents = "none", "pending" === this._state && (this._state = "active", this.fire(new t.Event("dragstart"))), this.fire(new t.Event("drag")));
          }
          _onUp() {
            this._element.style.pointerEvents = "auto", this._positionDelta = null, this._pointerdownPos = null, this._isDragging = false, this._map.off("mousemove", this._onMove), this._map.off("touchmove", this._onMove), "active" === this._state && this.fire(new t.Event("dragend")), this._state = "inactive";
          }
          _addDragHandler(t2) {
            this._element.contains(t2.originalEvent.target) && (t2.preventDefault(), this._positionDelta = t2.point.sub(this._pos).add(this._offset), this._pointerdownPos = t2.point, this._state = "pending", this._map.on("mousemove", this._onMove), this._map.on("touchmove", this._onMove), this._map.once("mouseup", this._onUp), this._map.once("touchend", this._onUp));
          }
          setDraggable(t2) {
            return this._draggable = !!t2, this._map && (t2 ? (this._map.on("mousedown", this._addDragHandler), this._map.on("touchstart", this._addDragHandler)) : (this._map.off("mousedown", this._addDragHandler), this._map.off("touchstart", this._addDragHandler))), this;
          }
          isDraggable() {
            return this._draggable;
          }
          setRotation(t2) {
            return this._rotation = t2 || 0, this._update(), this;
          }
          getRotation() {
            return this._rotation;
          }
          setRotationAlignment(t2) {
            return this._rotationAlignment = t2 || "auto", this._update(), this;
          }
          getRotationAlignment() {
            return this._rotationAlignment;
          }
          setPitchAlignment(t2) {
            return this._pitchAlignment = t2 && "auto" !== t2 ? t2 : this._rotationAlignment, this._update(), this;
          }
          getPitchAlignment() {
            return this._pitchAlignment;
          }
        }
        const ua2 = { positionOptions: { enableHighAccuracy: false, maximumAge: 0, timeout: 6e3 }, fitBoundsOptions: { maxZoom: 15 }, trackUserLocation: false, showAccuracyCircle: true, showUserLocation: true };
        let da, ma = 0, _a = false;
        const pa = { maxWidth: 100, unit: "metric" };
        function fa(t2, e2, i2) {
          const o2 = i2 && i2.maxWidth || 100, a2 = t2._container.clientHeight / 2, r2 = t2.unproject([0, a2]), s2 = t2.unproject([o2, a2]), n2 = r2.distanceTo(s2);
          if (i2 && "imperial" === i2.unit) {
            const i3 = 3.2808 * n2;
            i3 > 5280 ? ga(e2, o2, i3 / 5280, t2._getUIString("ScaleControl.Miles")) : ga(e2, o2, i3, t2._getUIString("ScaleControl.Feet"));
          } else
            i2 && "nautical" === i2.unit ? ga(e2, o2, n2 / 1852, t2._getUIString("ScaleControl.NauticalMiles")) : n2 >= 1e3 ? ga(e2, o2, n2 / 1e3, t2._getUIString("ScaleControl.Kilometers")) : ga(e2, o2, n2, t2._getUIString("ScaleControl.Meters"));
        }
        function ga(t2, e2, i2, o2) {
          const a2 = function(t3) {
            const e3 = Math.pow(10, `${Math.floor(t3)}`.length - 1);
            let i3 = t3 / e3;
            return i3 = i3 >= 10 ? 10 : i3 >= 5 ? 5 : i3 >= 3 ? 3 : i3 >= 2 ? 2 : i3 >= 1 ? 1 : function(t4) {
              const e4 = Math.pow(10, Math.ceil(-Math.log(t4) / Math.LN10));
              return Math.round(t4 * e4) / e4;
            }(i3), e3 * i3;
          }(i2);
          t2.style.width = e2 * (a2 / i2) + "px", t2.innerHTML = `${a2}&nbsp;${o2}`;
        }
        const xa = { closeButton: true, closeOnClick: true, focusAfterOpen: true, className: "", maxWidth: "240px" }, va = ["a[href]", "[tabindex]:not([tabindex='-1'])", "[contenteditable]:not([contenteditable='false'])", "button:not([disabled])", "input:not([disabled])", "select:not([disabled])", "textarea:not([disabled])"].join(", ");
        function ya(e2) {
          if (e2) {
            if ("number" == typeof e2) {
              const i2 = Math.round(Math.sqrt(0.5 * Math.pow(e2, 2)));
              return { center: new t.pointGeometry(0, 0), top: new t.pointGeometry(0, e2), "top-left": new t.pointGeometry(i2, i2), "top-right": new t.pointGeometry(-i2, i2), bottom: new t.pointGeometry(0, -e2), "bottom-left": new t.pointGeometry(i2, -i2), "bottom-right": new t.pointGeometry(-i2, -i2), left: new t.pointGeometry(e2, 0), right: new t.pointGeometry(-e2, 0) };
            }
            if (e2 instanceof t.pointGeometry || Array.isArray(e2)) {
              const i2 = t.pointGeometry.convert(e2);
              return { center: i2, top: i2, "top-left": i2, "top-right": i2, bottom: i2, "bottom-left": i2, "bottom-right": i2, left: i2, right: i2 };
            }
            return { center: t.pointGeometry.convert(e2.center || [0, 0]), top: t.pointGeometry.convert(e2.top || [0, 0]), "top-left": t.pointGeometry.convert(e2["top-left"] || [0, 0]), "top-right": t.pointGeometry.convert(e2["top-right"] || [0, 0]), bottom: t.pointGeometry.convert(e2.bottom || [0, 0]), "bottom-left": t.pointGeometry.convert(e2["bottom-left"] || [0, 0]), "bottom-right": t.pointGeometry.convert(e2["bottom-right"] || [0, 0]), left: t.pointGeometry.convert(e2.left || [0, 0]), right: t.pointGeometry.convert(e2.right || [0, 0]) };
          }
          return ya(new t.pointGeometry(0, 0));
        }
        const ba = { supported: e, setRTLTextPlugin: t.setRTLTextPlugin, getRTLTextPluginStatus: t.getRTLTextPluginStatus, Map: class extends Qo {
          constructor(e2) {
            var i2;
            if (t.PerformanceUtils.mark(t.PerformanceMarkers.create), null != (e2 = t.extend({}, aa, e2)).minZoom && null != e2.maxZoom && e2.minZoom > e2.maxZoom)
              throw new Error("maxZoom must be greater than or equal to minZoom");
            if (null != e2.minPitch && null != e2.maxPitch && e2.minPitch > e2.maxPitch)
              throw new Error("maxPitch must be greater than or equal to minPitch");
            if (null != e2.minPitch && e2.minPitch < 0)
              throw new Error("minPitch must be greater than or equal to 0");
            if (null != e2.maxPitch && e2.maxPitch > 85)
              throw new Error("maxPitch must be less than or equal to 85");
            if (super(new io(e2.minZoom, e2.maxZoom, e2.minPitch, e2.maxPitch, e2.renderWorldCopies), { bearingSnap: e2.bearingSnap }), this._interactive = e2.interactive, this._cooperativeGestures = e2.cooperativeGestures, this._maxTileCacheSize = e2.maxTileCacheSize, this._failIfMajorPerformanceCaveat = e2.failIfMajorPerformanceCaveat, this._preserveDrawingBuffer = e2.preserveDrawingBuffer, this._antialias = e2.antialias, this._trackResize = e2.trackResize, this._bearingSnap = e2.bearingSnap, this._refreshExpiredTiles = e2.refreshExpiredTiles, this._fadeDuration = e2.fadeDuration, this._crossSourceCollisions = e2.crossSourceCollisions, this._crossFadingFactor = 1, this._collectResourceTiming = e2.collectResourceTiming, this._renderTaskQueue = new ia(), this._controls = [], this._mapId = t.uniqueId(), this._locale = t.extend({}, oa, e2.locale), this._clickTolerance = e2.clickTolerance, this._pixelRatio = null !== (i2 = e2.pixelRatio) && void 0 !== i2 ? i2 : devicePixelRatio, this._requestManager = new s(e2.transformRequest), "string" == typeof e2.container) {
              if (this._container = document.getElementById(e2.container), !this._container)
                throw new Error(`Container '${e2.container}' not found.`);
            } else {
              if (!(e2.container instanceof HTMLElement))
                throw new Error("Invalid type: 'container' must be a String or HTMLElement.");
              this._container = e2.container;
            }
            if (e2.maxBounds && this.setMaxBounds(e2.maxBounds), t.bindAll(["_onWindowOnline", "_onWindowResize", "_onMapScroll", "_contextLost", "_contextRestored"], this), this._setupContainer(), this._setupPainter(), void 0 === this.painter)
              throw new Error("Failed to initialize WebGL.");
            this.on("move", () => this._update(false)), this.on("moveend", () => this._update(false)), this.on("zoom", () => this._update(true)), this.on("terrain", () => {
              this.painter.terrainFacilitator.dirty = true, this._update(true);
            }), "undefined" != typeof window && (addEventListener("online", this._onWindowOnline, false), addEventListener("resize", this._onWindowResize, false), addEventListener("orientationchange", this._onWindowResize, false)), this.handlers = new Yo(this, e2), this._cooperativeGestures && this._setupCooperativeGestures(), this._hash = e2.hash && new oo("string" == typeof e2.hash && e2.hash || void 0).addTo(this), this._hash && this._hash._onHashChange() || (this.jumpTo({ center: e2.center, zoom: e2.zoom, bearing: e2.bearing, pitch: e2.pitch }), e2.bounds && (this.resize(), this.fitBounds(e2.bounds, t.extend({}, e2.fitBoundsOptions, { duration: 0 })))), this.resize(), this._localIdeographFontFamily = e2.localIdeographFontFamily, e2.style && this.setStyle(e2.style, { localIdeographFontFamily: e2.localIdeographFontFamily }), e2.attributionControl && this.addControl(new ta({ customAttribution: e2.customAttribution })), e2.maplibreLogo && this.addControl(new ea(), e2.logoPosition), this.on("style.load", () => {
              this.transform.unmodified && this.jumpTo(this.style.stylesheet);
            }), this.on("data", (e3) => {
              this._update("style" === e3.dataType), this.fire(new t.Event(`${e3.dataType}data`, e3));
            }), this.on("dataloading", (e3) => {
              this.fire(new t.Event(`${e3.dataType}dataloading`, e3));
            }), this.on("dataabort", (e3) => {
              this.fire(new t.Event("sourcedataabort", e3));
            });
          }
          _getMapId() {
            return this._mapId;
          }
          addControl(e2, i2) {
            if (void 0 === i2 && (i2 = e2.getDefaultPosition ? e2.getDefaultPosition() : "top-right"), !e2 || !e2.onAdd)
              return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));
            const o2 = e2.onAdd(this);
            this._controls.push(e2);
            const a2 = this._controlPositions[i2];
            return -1 !== i2.indexOf("bottom") ? a2.insertBefore(o2, a2.firstChild) : a2.appendChild(o2), this;
          }
          removeControl(e2) {
            if (!e2 || !e2.onRemove)
              return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));
            const i2 = this._controls.indexOf(e2);
            return i2 > -1 && this._controls.splice(i2, 1), e2.onRemove(this), this;
          }
          hasControl(t2) {
            return this._controls.indexOf(t2) > -1;
          }
          calculateCameraOptionsFromTo(t2, e2, i2, o2) {
            return null == o2 && this.style.terrain && (o2 = this.transform.getElevation(i2, this.style.terrain)), super.calculateCameraOptionsFromTo(t2, e2, i2, o2);
          }
          resize(e2) {
            const i2 = this._containerDimensions(), o2 = i2[0], a2 = i2[1];
            this._resizeCanvas(o2, a2, this.getPixelRatio()), this.transform.resize(o2, a2), this.painter.resize(o2, a2, this.getPixelRatio());
            const r2 = !this._moving;
            return r2 && (this.stop(), this.fire(new t.Event("movestart", e2)).fire(new t.Event("move", e2))), this.fire(new t.Event("resize", e2)), r2 && this.fire(new t.Event("moveend", e2)), this;
          }
          getPixelRatio() {
            return this._pixelRatio;
          }
          setPixelRatio(t2) {
            const [e2, i2] = this._containerDimensions();
            this._pixelRatio = t2, this._resizeCanvas(e2, i2, t2), this.painter.resize(e2, i2, t2);
          }
          getBounds() {
            return this.transform.getBounds();
          }
          getMaxBounds() {
            return this.transform.getMaxBounds();
          }
          setMaxBounds(e2) {
            return this.transform.setMaxBounds(t.LngLatBounds.convert(e2)), this._update();
          }
          setMinZoom(t2) {
            if ((t2 = null == t2 ? -2 : t2) >= -2 && t2 <= this.transform.maxZoom)
              return this.transform.minZoom = t2, this._update(), this.getZoom() < t2 && this.setZoom(t2), this;
            throw new Error("minZoom must be between -2 and the current maxZoom, inclusive");
          }
          getMinZoom() {
            return this.transform.minZoom;
          }
          setMaxZoom(t2) {
            if ((t2 = null == t2 ? 22 : t2) >= this.transform.minZoom)
              return this.transform.maxZoom = t2, this._update(), this.getZoom() > t2 && this.setZoom(t2), this;
            throw new Error("maxZoom must be greater than the current minZoom");
          }
          getMaxZoom() {
            return this.transform.maxZoom;
          }
          setMinPitch(t2) {
            if ((t2 = null == t2 ? 0 : t2) < 0)
              throw new Error("minPitch must be greater than or equal to 0");
            if (t2 >= 0 && t2 <= this.transform.maxPitch)
              return this.transform.minPitch = t2, this._update(), this.getPitch() < t2 && this.setPitch(t2), this;
            throw new Error("minPitch must be between 0 and the current maxPitch, inclusive");
          }
          getMinPitch() {
            return this.transform.minPitch;
          }
          setMaxPitch(t2) {
            if ((t2 = null == t2 ? 60 : t2) > 85)
              throw new Error("maxPitch must be less than or equal to 85");
            if (t2 >= this.transform.minPitch)
              return this.transform.maxPitch = t2, this._update(), this.getPitch() > t2 && this.setPitch(t2), this;
            throw new Error("maxPitch must be greater than the current minPitch");
          }
          getMaxPitch() {
            return this.transform.maxPitch;
          }
          getRenderWorldCopies() {
            return this.transform.renderWorldCopies;
          }
          setRenderWorldCopies(t2) {
            return this.transform.renderWorldCopies = t2, this._update();
          }
          project(e2) {
            return this.transform.locationPoint(t.LngLat.convert(e2), this.style && this.style.terrain);
          }
          unproject(e2) {
            return this.transform.pointLocation(t.pointGeometry.convert(e2), this.style && this.style.terrain);
          }
          isMoving() {
            return this._moving || this.handlers.isMoving();
          }
          isZooming() {
            return this._zooming || this.handlers.isZooming();
          }
          isRotating() {
            return this._rotating || this.handlers.isRotating();
          }
          _createDelegatedListener(t2, e2, i2) {
            if ("mouseenter" === t2 || "mouseover" === t2) {
              let o2 = false;
              const a2 = (a3) => {
                const r2 = this.getLayer(e2) ? this.queryRenderedFeatures(a3.point, { layers: [e2] }) : [];
                r2.length ? o2 || (o2 = true, i2.call(this, new mo(t2, this, a3.originalEvent, { features: r2 }))) : o2 = false;
              };
              return { layer: e2, listener: i2, delegates: { mousemove: a2, mouseout: () => {
                o2 = false;
              } } };
            }
            if ("mouseleave" === t2 || "mouseout" === t2) {
              let o2 = false;
              const a2 = (a3) => {
                (this.getLayer(e2) ? this.queryRenderedFeatures(a3.point, { layers: [e2] }) : []).length ? o2 = true : o2 && (o2 = false, i2.call(this, new mo(t2, this, a3.originalEvent)));
              }, r2 = (e3) => {
                o2 && (o2 = false, i2.call(this, new mo(t2, this, e3.originalEvent)));
              };
              return { layer: e2, listener: i2, delegates: { mousemove: a2, mouseout: r2 } };
            }
            {
              const o2 = (t3) => {
                const o3 = this.getLayer(e2) ? this.queryRenderedFeatures(t3.point, { layers: [e2] }) : [];
                o3.length && (t3.features = o3, i2.call(this, t3), delete t3.features);
              };
              return { layer: e2, listener: i2, delegates: { [t2]: o2 } };
            }
          }
          on(t2, e2, i2) {
            if (void 0 === i2)
              return super.on(t2, e2);
            const o2 = this._createDelegatedListener(t2, e2, i2);
            this._delegatedListeners = this._delegatedListeners || {}, this._delegatedListeners[t2] = this._delegatedListeners[t2] || [], this._delegatedListeners[t2].push(o2);
            for (const t3 in o2.delegates)
              this.on(t3, o2.delegates[t3]);
            return this;
          }
          once(t2, e2, i2) {
            if (void 0 === i2)
              return super.once(t2, e2);
            const o2 = this._createDelegatedListener(t2, e2, i2);
            for (const t3 in o2.delegates)
              this.once(t3, o2.delegates[t3]);
            return this;
          }
          off(t2, e2, i2) {
            return void 0 === i2 ? super.off(t2, e2) : (this._delegatedListeners && this._delegatedListeners[t2] && ((o2) => {
              const a2 = this._delegatedListeners[t2];
              for (let t3 = 0; t3 < a2.length; t3++) {
                const o3 = a2[t3];
                if (o3.layer === e2 && o3.listener === i2) {
                  for (const t4 in o3.delegates)
                    this.off(t4, o3.delegates[t4]);
                  return a2.splice(t3, 1), this;
                }
              }
            })(), this);
          }
          queryRenderedFeatures(e2, i2) {
            if (!this.style)
              return [];
            let o2;
            if (void 0 !== i2 || void 0 === e2 || e2 instanceof t.pointGeometry || Array.isArray(e2) || (i2 = e2, e2 = void 0), i2 = i2 || {}, (e2 = e2 || [[0, 0], [this.transform.width, this.transform.height]]) instanceof t.pointGeometry || "number" == typeof e2[0])
              o2 = [t.pointGeometry.convert(e2)];
            else {
              const i3 = t.pointGeometry.convert(e2[0]), a2 = t.pointGeometry.convert(e2[1]);
              o2 = [i3, new t.pointGeometry(a2.x, i3.y), a2, new t.pointGeometry(i3.x, a2.y), i3];
            }
            return this.style.queryRenderedFeatures(o2, i2, this.transform);
          }
          querySourceFeatures(t2, e2) {
            return this.style.querySourceFeatures(t2, e2);
          }
          setStyle(e2, i2) {
            return false !== (i2 = t.extend({}, { localIdeographFontFamily: this._localIdeographFontFamily }, i2)).diff && i2.localIdeographFontFamily === this._localIdeographFontFamily && this.style && e2 ? (this._diffStyle(e2, i2), this) : (this._localIdeographFontFamily = i2.localIdeographFontFamily, this._updateStyle(e2, i2));
          }
          setTransformRequest(t2) {
            return this._requestManager.setTransformRequest(t2), this;
          }
          _getUIString(t2) {
            const e2 = this._locale[t2];
            if (null == e2)
              throw new Error(`Missing UI string '${t2}'`);
            return e2;
          }
          _updateStyle(t2, e2) {
            return this.style && (this.style.setEventedParent(null), this.style._remove()), t2 ? (this.style = new ee(this, e2 || {}), this.style.setEventedParent(this, { style: this.style }), "string" == typeof t2 ? this.style.loadURL(t2) : this.style.loadJSON(t2), this) : (delete this.style, this);
          }
          _lazyInitEmptyStyle() {
            this.style || (this.style = new ee(this, {}), this.style.setEventedParent(this, { style: this.style }), this.style.loadEmpty());
          }
          _diffStyle(e2, i2) {
            if ("string" == typeof e2) {
              const o2 = this._requestManager.transformRequest(e2, t.ResourceType.Style);
              t.getJSON(o2, (e3, o3) => {
                e3 ? this.fire(new t.ErrorEvent(e3)) : o3 && this._updateDiff(o3, i2);
              });
            } else
              "object" == typeof e2 && this._updateDiff(e2, i2);
          }
          _updateDiff(e2, i2) {
            try {
              this.style.setState(e2) && this._update(true);
            } catch (o2) {
              t.warnOnce(`Unable to perform style diff: ${o2.message || o2.error || o2}.  Rebuilding the style from scratch.`), this._updateStyle(e2, i2);
            }
          }
          getStyle() {
            if (this.style)
              return this.style.serialize();
          }
          isStyleLoaded() {
            return this.style ? this.style.loaded() : t.warnOnce("There is no style added to the map.");
          }
          addSource(t2, e2) {
            return this._lazyInitEmptyStyle(), this.style.addSource(t2, e2), this._update(true);
          }
          isSourceLoaded(e2) {
            const i2 = this.style && this.style.sourceCaches[e2];
            if (void 0 !== i2)
              return i2.loaded();
            this.fire(new t.ErrorEvent(new Error(`There is no source with ID '${e2}'`)));
          }
          setTerrain(t2) {
            return this.style.setTerrain(t2), this;
          }
          getTerrain() {
            return this.style.terrain && this.style.terrain.options;
          }
          areTilesLoaded() {
            const t2 = this.style && this.style.sourceCaches;
            for (const e2 in t2) {
              const i2 = t2[e2]._tiles;
              for (const t3 in i2) {
                const e3 = i2[t3];
                if ("loaded" !== e3.state && "errored" !== e3.state)
                  return false;
              }
            }
            return true;
          }
          addSourceType(t2, e2, i2) {
            return this._lazyInitEmptyStyle(), this.style.addSourceType(t2, e2, i2);
          }
          removeSource(t2) {
            return this.style.removeSource(t2), this._update(true);
          }
          getSource(t2) {
            return this.style.getSource(t2);
          }
          addImage(e2, i2, { pixelRatio: o2 = 1, sdf: a2 = false, stretchX: r2, stretchY: s2, content: n2 } = {}) {
            if (this._lazyInitEmptyStyle(), i2 instanceof HTMLImageElement || t.isImageBitmap(i2)) {
              const { width: l2, height: c3, data: h2 } = t.exported.getImageData(i2);
              this.style.addImage(e2, { data: new t.RGBAImage({ width: l2, height: c3 }, h2), pixelRatio: o2, stretchX: r2, stretchY: s2, content: n2, sdf: a2, version: 0 });
            } else {
              if (void 0 === i2.width || void 0 === i2.height)
                return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));
              {
                const { width: l2, height: c3, data: h2 } = i2, u2 = i2;
                this.style.addImage(e2, { data: new t.RGBAImage({ width: l2, height: c3 }, new Uint8Array(h2)), pixelRatio: o2, stretchX: r2, stretchY: s2, content: n2, sdf: a2, version: 0, userImage: u2 }), u2.onAdd && u2.onAdd(this, e2);
              }
            }
          }
          updateImage(e2, i2) {
            const o2 = this.style.getImage(e2);
            if (!o2)
              return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));
            const a2 = i2 instanceof HTMLImageElement || t.isImageBitmap(i2) ? t.exported.getImageData(i2) : i2, { width: r2, height: s2, data: n2 } = a2;
            if (void 0 === r2 || void 0 === s2)
              return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));
            if (r2 !== o2.data.width || s2 !== o2.data.height)
              return this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));
            const l2 = !(i2 instanceof HTMLImageElement || t.isImageBitmap(i2));
            o2.data.replace(n2, l2), this.style.updateImage(e2, o2);
          }
          hasImage(e2) {
            return e2 ? !!this.style.getImage(e2) : (this.fire(new t.ErrorEvent(new Error("Missing required image id"))), false);
          }
          removeImage(t2) {
            this.style.removeImage(t2);
          }
          loadImage(e2, i2) {
            t.getImage(this._requestManager.transformRequest(e2, t.ResourceType.Image), i2);
          }
          listImages() {
            return this.style.listImages();
          }
          addLayer(t2, e2) {
            return this._lazyInitEmptyStyle(), this.style.addLayer(t2, e2), this._update(true);
          }
          moveLayer(t2, e2) {
            return this.style.moveLayer(t2, e2), this._update(true);
          }
          removeLayer(t2) {
            return this.style.removeLayer(t2), this._update(true);
          }
          getLayer(t2) {
            return this.style.getLayer(t2);
          }
          setLayerZoomRange(t2, e2, i2) {
            return this.style.setLayerZoomRange(t2, e2, i2), this._update(true);
          }
          setFilter(t2, e2, i2 = {}) {
            return this.style.setFilter(t2, e2, i2), this._update(true);
          }
          getFilter(t2) {
            return this.style.getFilter(t2);
          }
          setPaintProperty(t2, e2, i2, o2 = {}) {
            return this.style.setPaintProperty(t2, e2, i2, o2), this._update(true);
          }
          getPaintProperty(t2, e2) {
            return this.style.getPaintProperty(t2, e2);
          }
          setLayoutProperty(t2, e2, i2, o2 = {}) {
            return this.style.setLayoutProperty(t2, e2, i2, o2), this._update(true);
          }
          getLayoutProperty(t2, e2) {
            return this.style.getLayoutProperty(t2, e2);
          }
          setLight(t2, e2 = {}) {
            return this._lazyInitEmptyStyle(), this.style.setLight(t2, e2), this._update(true);
          }
          getLight() {
            return this.style.getLight();
          }
          setFeatureState(t2, e2) {
            return this.style.setFeatureState(t2, e2), this._update();
          }
          removeFeatureState(t2, e2) {
            return this.style.removeFeatureState(t2, e2), this._update();
          }
          getFeatureState(t2) {
            return this.style.getFeatureState(t2);
          }
          getContainer() {
            return this._container;
          }
          getCanvasContainer() {
            return this._canvasContainer;
          }
          getCanvas() {
            return this._canvas;
          }
          _containerDimensions() {
            let t2 = 0, e2 = 0;
            return this._container && (t2 = this._container.clientWidth || 400, e2 = this._container.clientHeight || 300), [t2, e2];
          }
          _setupContainer() {
            const t2 = this._container;
            t2.classList.add("maplibregl-map", "mapboxgl-map");
            const e2 = this._canvasContainer = r.create("div", "maplibregl-canvas-container mapboxgl-canvas-container", t2);
            this._interactive && e2.classList.add("maplibregl-interactive", "mapboxgl-interactive"), this._canvas = r.create("canvas", "maplibregl-canvas mapboxgl-canvas", e2), this._canvas.addEventListener("webglcontextlost", this._contextLost, false), this._canvas.addEventListener("webglcontextrestored", this._contextRestored, false), this._canvas.setAttribute("tabindex", "0"), this._canvas.setAttribute("aria-label", "Map"), this._canvas.setAttribute("role", "region");
            const i2 = this._containerDimensions();
            this._resizeCanvas(i2[0], i2[1], this.getPixelRatio());
            const o2 = this._controlContainer = r.create("div", "maplibregl-control-container mapboxgl-control-container", t2), a2 = this._controlPositions = {};
            ["top-left", "top-right", "bottom-left", "bottom-right"].forEach((t3) => {
              a2[t3] = r.create("div", `maplibregl-ctrl-${t3} mapboxgl-ctrl-${t3}`, o2);
            }), this._container.addEventListener("scroll", this._onMapScroll, false);
          }
          _setupCooperativeGestures() {
            const t2 = this._container;
            this._metaPress = false, this._cooperativeGesturesScreen = r.create("div", "maplibregl-cooperative-gesture-screen", t2);
            let e2 = "Control", i2 = "boolean" != typeof this._cooperativeGestures && this._cooperativeGestures.windowsHelpText ? this._cooperativeGestures.windowsHelpText : "Use Ctrl + scroll to zoom the map";
            0 === navigator.platform.indexOf("Mac") && (i2 = "boolean" != typeof this._cooperativeGestures && this._cooperativeGestures.macHelpText ? this._cooperativeGestures.macHelpText : "Use \u2318 + scroll to zoom the map", e2 = "Meta"), this._cooperativeGesturesScreen.innerHTML = `
            <div class="maplibregl-desktop-message">${i2}</div>
            <div class="maplibregl-mobile-message">${"boolean" != typeof this._cooperativeGestures && this._cooperativeGestures.mobileHelpText ? this._cooperativeGestures.mobileHelpText : "Use two fingers to move the map"}</div>
        `, document.addEventListener("keydown", (t3) => {
              t3.key === e2 && (this._metaPress = true);
            }), document.addEventListener("keyup", (t3) => {
              t3.key === e2 && (this._metaPress = false);
            }), this._canvasContainer.addEventListener("wheel", (t3) => {
              this._onCooperativeGesture(t3, this._metaPress, 1);
            }, false), this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan", "maplibregl-touch-drag-pan");
          }
          _resizeCanvas(t2, e2, i2) {
            this._canvas.width = i2 * t2, this._canvas.height = i2 * e2, this._canvas.style.width = `${t2}px`, this._canvas.style.height = `${e2}px`;
          }
          _setupPainter() {
            const i2 = t.extend({}, e.webGLContextAttributes, { failIfMajorPerformanceCaveat: this._failIfMajorPerformanceCaveat, preserveDrawingBuffer: this._preserveDrawingBuffer, antialias: this._antialias || false }), o2 = this._canvas.getContext("webgl", i2) || this._canvas.getContext("experimental-webgl", i2);
            o2 ? (this.painter = new Ji(o2, this.transform), t.exported$1.testSupport(o2)) : this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")));
          }
          _contextLost(e2) {
            e2.preventDefault(), this._frame && (this._frame.cancel(), this._frame = null), this.fire(new t.Event("webglcontextlost", { originalEvent: e2 }));
          }
          _contextRestored(e2) {
            this._setupPainter(), this.resize(), this._update(), this.fire(new t.Event("webglcontextrestored", { originalEvent: e2 }));
          }
          _onMapScroll(t2) {
            if (t2.target === this._container)
              return this._container.scrollTop = 0, this._container.scrollLeft = 0, false;
          }
          _onCooperativeGesture(t2, e2, i2) {
            return !e2 && i2 < 2 && (this._cooperativeGesturesScreen.classList.add("maplibregl-show"), setTimeout(() => {
              this._cooperativeGesturesScreen.classList.remove("maplibregl-show");
            }, 100)), false;
          }
          loaded() {
            return !this._styleDirty && !this._sourcesDirty && !!this.style && this.style.loaded();
          }
          _update(t2) {
            return this.style ? (this._styleDirty = this._styleDirty || t2, this._sourcesDirty = true, this.triggerRepaint(), this) : this;
          }
          _requestRenderFrame(t2) {
            return this._update(), this._renderTaskQueue.add(t2);
          }
          _cancelRenderFrame(t2) {
            this._renderTaskQueue.remove(t2);
          }
          _render(e2) {
            let i2, o2 = 0;
            const a2 = this.painter.context.extTimerQuery;
            if (this.listens("gpu-timing-frame") && (i2 = a2.createQueryEXT(), a2.beginQueryEXT(a2.TIME_ELAPSED_EXT, i2), o2 = t.exported.now()), this.painter.context.setDirty(), this.painter.setBaseState(), this._renderTaskQueue.run(e2), this._removed)
              return;
            let r2 = false;
            if (this.style && this._styleDirty) {
              this._styleDirty = false;
              const e3 = this.transform.zoom, i3 = t.exported.now();
              this.style.zoomHistory.update(e3, i3);
              const o3 = new t.EvaluationParameters(e3, { now: i3, fadeDuration: this._fadeDuration, zoomHistory: this.style.zoomHistory, transition: this.style.getTransition() }), a3 = o3.crossFadingFactor();
              1 === a3 && a3 === this._crossFadingFactor || (r2 = true, this._crossFadingFactor = a3), this.style.update(o3);
            }
            if (this.style && this._sourcesDirty && (this._sourcesDirty = false, this.style._updateSources(this.transform)), this.style.terrain && this.style.terrain.sourceCache.update(this.transform, this.style.terrain), this.transform.updateElevation(this.style.terrain), this._placementDirty = this.style && this.style._updatePlacement(this.painter.transform, this.showCollisionBoxes, this._fadeDuration, this._crossSourceCollisions), this.painter.render(this.style, { showTileBoundaries: this.showTileBoundaries, showOverdrawInspector: this._showOverdrawInspector, rotating: this.isRotating(), zooming: this.isZooming(), moving: this.isMoving(), fadeDuration: this._fadeDuration, showPadding: this.showPadding, gpuTiming: !!this.listens("gpu-timing-layer") }), this.fire(new t.Event("render")), this.loaded() && !this._loaded && (this._loaded = true, t.PerformanceUtils.mark(t.PerformanceMarkers.load), this.fire(new t.Event("load"))), this.style && (this.style.hasTransitions() || r2) && (this._styleDirty = true), this.style && !this._placementDirty && this.style._releaseSymbolFadeTiles(), this.listens("gpu-timing-frame")) {
              const e3 = t.exported.now() - o2;
              a2.endQueryEXT(a2.TIME_ELAPSED_EXT, i2), setTimeout(() => {
                const o3 = a2.getQueryObjectEXT(i2, a2.QUERY_RESULT_EXT) / 1e6;
                a2.deleteQueryEXT(i2), this.fire(new t.Event("gpu-timing-frame", { cpuTime: e3, gpuTime: o3 }));
              }, 50);
            }
            if (this.listens("gpu-timing-layer")) {
              const e3 = this.painter.collectGpuTimers();
              setTimeout(() => {
                const i3 = this.painter.queryGpuTimers(e3);
                this.fire(new t.Event("gpu-timing-layer", { layerTimes: i3 }));
              }, 50);
            }
            const s2 = this._sourcesDirty || this._styleDirty || this._placementDirty;
            return s2 || this._repaint ? this.triggerRepaint() : !this.isMoving() && this.loaded() && this.fire(new t.Event("idle")), !this._loaded || this._fullyLoaded || s2 || (this._fullyLoaded = true, t.PerformanceUtils.mark(t.PerformanceMarkers.fullLoad)), this;
          }
          redraw() {
            return this.style && (this._frame && (this._frame.cancel(), this._frame = null), this._render(0)), this;
          }
          remove() {
            this._hash && this._hash.remove();
            for (const t2 of this._controls)
              t2.onRemove(this);
            this._controls = [], this._frame && (this._frame.cancel(), this._frame = null), this._renderTaskQueue.clear(), this.painter.destroy(), this.handlers.destroy(), delete this.handlers, this.setStyle(null), "undefined" != typeof window && (removeEventListener("resize", this._onWindowResize, false), removeEventListener("orientationchange", this._onWindowResize, false), removeEventListener("online", this._onWindowOnline, false));
            const e2 = this.painter.context.gl.getExtension("WEBGL_lose_context");
            e2 && e2.loseContext(), this._canvas.removeEventListener("webglcontextrestored", this._contextRestored, false), this._canvas.removeEventListener("webglcontextlost", this._contextLost, false), r.remove(this._canvasContainer), r.remove(this._controlContainer), this._cooperativeGestures && r.remove(this._cooperativeGesturesScreen), this._container.classList.remove("maplibregl-map", "mapboxgl-map"), t.PerformanceUtils.clearMetrics(), this._removed = true, this.fire(new t.Event("remove"));
          }
          triggerRepaint() {
            this.style && !this._frame && (this._frame = t.exported.frame((e2) => {
              t.PerformanceUtils.frame(e2), this._frame = null, this._render(e2);
            }));
          }
          _onWindowOnline() {
            this._update();
          }
          _onWindowResize(t2) {
            this._trackResize && this.resize({ originalEvent: t2 })._update();
          }
          get showTileBoundaries() {
            return !!this._showTileBoundaries;
          }
          set showTileBoundaries(t2) {
            this._showTileBoundaries !== t2 && (this._showTileBoundaries = t2, this._update());
          }
          get showPadding() {
            return !!this._showPadding;
          }
          set showPadding(t2) {
            this._showPadding !== t2 && (this._showPadding = t2, this._update());
          }
          get showCollisionBoxes() {
            return !!this._showCollisionBoxes;
          }
          set showCollisionBoxes(t2) {
            this._showCollisionBoxes !== t2 && (this._showCollisionBoxes = t2, t2 ? this.style._generateCollisionBoxes() : this._update());
          }
          get showOverdrawInspector() {
            return !!this._showOverdrawInspector;
          }
          set showOverdrawInspector(t2) {
            this._showOverdrawInspector !== t2 && (this._showOverdrawInspector = t2, this._update());
          }
          get repaint() {
            return !!this._repaint;
          }
          set repaint(t2) {
            this._repaint !== t2 && (this._repaint = t2, this.triggerRepaint());
          }
          get vertices() {
            return !!this._vertices;
          }
          set vertices(t2) {
            this._vertices = t2, this._update();
          }
          _setCacheLimits(e2, i2) {
            t.setCacheLimits(e2, i2);
          }
          get version() {
            return "2.4.0";
          }
        }, NavigationControl: class {
          constructor(e2) {
            this.options = t.extend({}, ra, e2), this._container = r.create("div", "maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"), this._container.addEventListener("contextmenu", (t2) => t2.preventDefault()), this.options.showZoom && (t.bindAll(["_setButtonTitle", "_updateZoomButtons"], this), this._zoomInButton = this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in", (t2) => this._map.zoomIn({}, { originalEvent: t2 })), r.create("span", "maplibregl-ctrl-icon mapboxgl-ctrl-icon", this._zoomInButton).setAttribute("aria-hidden", "true"), this._zoomOutButton = this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out", (t2) => this._map.zoomOut({}, { originalEvent: t2 })), r.create("span", "maplibregl-ctrl-icon mapboxgl-ctrl-icon", this._zoomOutButton).setAttribute("aria-hidden", "true")), this.options.showCompass && (t.bindAll(["_rotateCompassArrow"], this), this._compass = this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass", (t2) => {
              this.options.visualizePitch ? this._map.resetNorthPitch({}, { originalEvent: t2 }) : this._map.resetNorth({}, { originalEvent: t2 });
            }), this._compassIcon = r.create("span", "maplibregl-ctrl-icon mapboxgl-ctrl-icon", this._compass), this._compassIcon.setAttribute("aria-hidden", "true"));
          }
          _updateZoomButtons() {
            const t2 = this._map.getZoom(), e2 = t2 === this._map.getMaxZoom(), i2 = t2 === this._map.getMinZoom();
            this._zoomInButton.disabled = e2, this._zoomOutButton.disabled = i2, this._zoomInButton.setAttribute("aria-disabled", e2.toString()), this._zoomOutButton.setAttribute("aria-disabled", i2.toString());
          }
          _rotateCompassArrow() {
            const t2 = this.options.visualizePitch ? `scale(${1 / Math.pow(Math.cos(this._map.transform.pitch * (Math.PI / 180)), 0.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle * (180 / Math.PI)}deg)` : `rotate(${this._map.transform.angle * (180 / Math.PI)}deg)`;
            this._compassIcon.style.transform = t2;
          }
          onAdd(t2) {
            return this._map = t2, this.options.showZoom && (this._setButtonTitle(this._zoomInButton, "ZoomIn"), this._setButtonTitle(this._zoomOutButton, "ZoomOut"), this._map.on("zoom", this._updateZoomButtons), this._updateZoomButtons()), this.options.showCompass && (this._setButtonTitle(this._compass, "ResetBearing"), this.options.visualizePitch && this._map.on("pitch", this._rotateCompassArrow), this._map.on("rotate", this._rotateCompassArrow), this._rotateCompassArrow(), this._handler = new sa(this._map, this._compass, this.options.visualizePitch)), this._container;
          }
          onRemove() {
            r.remove(this._container), this.options.showZoom && this._map.off("zoom", this._updateZoomButtons), this.options.showCompass && (this.options.visualizePitch && this._map.off("pitch", this._rotateCompassArrow), this._map.off("rotate", this._rotateCompassArrow), this._handler.off(), delete this._handler), delete this._map;
          }
          _createButton(t2, e2) {
            const i2 = r.create("button", t2, this._container);
            return i2.type = "button", i2.addEventListener("click", e2), i2;
          }
          _setButtonTitle(t2, e2) {
            const i2 = this._map._getUIString(`NavigationControl.${e2}`);
            t2.title = i2, t2.setAttribute("aria-label", i2);
          }
        }, GeolocateControl: class extends t.Evented {
          constructor(e2) {
            super(), this.options = t.extend({}, ua2, e2), t.bindAll(["_onSuccess", "_onError", "_onZoom", "_finish", "_setupUI", "_updateCamera", "_updateMarker"], this);
          }
          onAdd(t2) {
            var e2;
            return this._map = t2, this._container = r.create("div", "maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"), e2 = this._setupUI, void 0 !== da ? e2(da) : void 0 !== window.navigator.permissions ? window.navigator.permissions.query({ name: "geolocation" }).then((t3) => {
              da = "denied" !== t3.state, e2(da);
            }) : (da = !!window.navigator.geolocation, e2(da)), this._container;
          }
          onRemove() {
            void 0 !== this._geolocationWatchID && (window.navigator.geolocation.clearWatch(this._geolocationWatchID), this._geolocationWatchID = void 0), this.options.showUserLocation && this._userLocationDotMarker && this._userLocationDotMarker.remove(), this.options.showAccuracyCircle && this._accuracyCircleMarker && this._accuracyCircleMarker.remove(), r.remove(this._container), this._map.off("zoom", this._onZoom), this._map = void 0, ma = 0, _a = false;
          }
          _isOutOfMapMaxBounds(t2) {
            const e2 = this._map.getMaxBounds(), i2 = t2.coords;
            return e2 && (i2.longitude < e2.getWest() || i2.longitude > e2.getEast() || i2.latitude < e2.getSouth() || i2.latitude > e2.getNorth());
          }
          _setErrorState() {
            switch (this._watchState) {
              case "WAITING_ACTIVE":
                this._watchState = "ACTIVE_ERROR", this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active", "mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error", "mapboxgl-ctrl-geolocate-active-error");
                break;
              case "ACTIVE_LOCK":
                this._watchState = "ACTIVE_ERROR", this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active", "mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error", "mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting", "mapboxgl-ctrl-geolocate-waiting");
                break;
              case "BACKGROUND":
                this._watchState = "BACKGROUND_ERROR", this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background", "mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error", "mapboxgl-ctrl-geolocate-background-error"), this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting", "mapboxgl-ctrl-geolocate-waiting");
                break;
              case "ACTIVE_ERROR":
                break;
              default:
                throw new Error(`Unexpected watchState ${this._watchState}`);
            }
          }
          _onSuccess(e2) {
            if (this._map) {
              if (this._isOutOfMapMaxBounds(e2))
                return this._setErrorState(), this.fire(new t.Event("outofmaxbounds", e2)), this._updateMarker(), void this._finish();
              if (this.options.trackUserLocation)
                switch (this._lastKnownPosition = e2, this._watchState) {
                  case "WAITING_ACTIVE":
                  case "ACTIVE_LOCK":
                  case "ACTIVE_ERROR":
                    this._watchState = "ACTIVE_LOCK", this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting", "mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error", "mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active", "mapboxgl-ctrl-geolocate-active");
                    break;
                  case "BACKGROUND":
                  case "BACKGROUND_ERROR":
                    this._watchState = "BACKGROUND", this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting", "mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error", "mapboxgl-ctrl-geolocate-background-error"), this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background", "mapboxgl-ctrl-geolocate-background");
                    break;
                  default:
                    throw new Error(`Unexpected watchState ${this._watchState}`);
                }
              this.options.showUserLocation && "OFF" !== this._watchState && this._updateMarker(e2), this.options.trackUserLocation && "ACTIVE_LOCK" !== this._watchState || this._updateCamera(e2), this.options.showUserLocation && this._dotElement.classList.remove("maplibregl-user-location-dot-stale", "mapboxgl-user-location-dot-stale"), this.fire(new t.Event("geolocate", e2)), this._finish();
            }
          }
          _updateCamera(e2) {
            const i2 = new t.LngLat(e2.coords.longitude, e2.coords.latitude), o2 = e2.coords.accuracy, a2 = this._map.getBearing(), r2 = t.extend({ bearing: a2 }, this.options.fitBoundsOptions);
            this._map.fitBounds(i2.toBounds(o2), r2, { geolocateSource: true });
          }
          _updateMarker(e2) {
            if (e2) {
              const i2 = new t.LngLat(e2.coords.longitude, e2.coords.latitude);
              this._accuracyCircleMarker.setLngLat(i2).addTo(this._map), this._userLocationDotMarker.setLngLat(i2).addTo(this._map), this._accuracy = e2.coords.accuracy, this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius();
            } else
              this._userLocationDotMarker.remove(), this._accuracyCircleMarker.remove();
          }
          _updateCircleRadius() {
            const t2 = this._map._container.clientHeight / 2, e2 = this._map.unproject([0, t2]), i2 = this._map.unproject([1, t2]), o2 = e2.distanceTo(i2), a2 = Math.ceil(2 * this._accuracy / o2);
            this._circleElement.style.width = `${a2}px`, this._circleElement.style.height = `${a2}px`;
          }
          _onZoom() {
            this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius();
          }
          _onError(e2) {
            if (this._map) {
              if (this.options.trackUserLocation)
                if (1 === e2.code) {
                  this._watchState = "OFF", this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting", "mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active", "mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error", "mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background", "mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error", "mapboxgl-ctrl-geolocate-background-error"), this._geolocateButton.disabled = true;
                  const t2 = this._map._getUIString("GeolocateControl.LocationNotAvailable");
                  this._geolocateButton.title = t2, this._geolocateButton.setAttribute("aria-label", t2), void 0 !== this._geolocationWatchID && this._clearWatch();
                } else {
                  if (3 === e2.code && _a)
                    return;
                  this._setErrorState();
                }
              "OFF" !== this._watchState && this.options.showUserLocation && this._dotElement.classList.add("maplibregl-user-location-dot-stale", "mapboxgl-user-location-dot-stale"), this.fire(new t.Event("error", e2)), this._finish();
            }
          }
          _finish() {
            this._timeoutId && clearTimeout(this._timeoutId), this._timeoutId = void 0;
          }
          _setupUI(e2) {
            if (this._container.addEventListener("contextmenu", (t2) => t2.preventDefault()), this._geolocateButton = r.create("button", "maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate", this._container), r.create("span", "maplibregl-ctrl-icon mapboxgl-ctrl-icon", this._geolocateButton).setAttribute("aria-hidden", "true"), this._geolocateButton.type = "button", false === e2) {
              t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");
              const e3 = this._map._getUIString("GeolocateControl.LocationNotAvailable");
              this._geolocateButton.disabled = true, this._geolocateButton.title = e3, this._geolocateButton.setAttribute("aria-label", e3);
            } else {
              const t2 = this._map._getUIString("GeolocateControl.FindMyLocation");
              this._geolocateButton.title = t2, this._geolocateButton.setAttribute("aria-label", t2);
            }
            this.options.trackUserLocation && (this._geolocateButton.setAttribute("aria-pressed", "false"), this._watchState = "OFF"), this.options.showUserLocation && (this._dotElement = r.create("div", "maplibregl-user-location-dot mapboxgl-user-location-dot"), this._userLocationDotMarker = new ha(this._dotElement), this._circleElement = r.create("div", "maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"), this._accuracyCircleMarker = new ha({ element: this._circleElement, pitchAlignment: "map" }), this.options.trackUserLocation && (this._watchState = "OFF"), this._map.on("zoom", this._onZoom)), this._geolocateButton.addEventListener("click", this.trigger.bind(this)), this._setup = true, this.options.trackUserLocation && this._map.on("movestart", (e3) => {
              e3.geolocateSource || "ACTIVE_LOCK" !== this._watchState || e3.originalEvent && "resize" === e3.originalEvent.type || (this._watchState = "BACKGROUND", this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background", "mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active", "mapboxgl-ctrl-geolocate-active"), this.fire(new t.Event("trackuserlocationend")));
            });
          }
          trigger() {
            if (!this._setup)
              return t.warnOnce("Geolocate control triggered before added to a map"), false;
            if (this.options.trackUserLocation) {
              switch (this._watchState) {
                case "OFF":
                  this._watchState = "WAITING_ACTIVE", this.fire(new t.Event("trackuserlocationstart"));
                  break;
                case "WAITING_ACTIVE":
                case "ACTIVE_LOCK":
                case "ACTIVE_ERROR":
                case "BACKGROUND_ERROR":
                  ma--, _a = false, this._watchState = "OFF", this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting", "mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active", "mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error", "mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background", "mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error", "mapboxgl-ctrl-geolocate-background-error"), this.fire(new t.Event("trackuserlocationend"));
                  break;
                case "BACKGROUND":
                  this._watchState = "ACTIVE_LOCK", this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background", "mapboxgl-ctrl-geolocate-background"), this._lastKnownPosition && this._updateCamera(this._lastKnownPosition), this.fire(new t.Event("trackuserlocationstart"));
                  break;
                default:
                  throw new Error(`Unexpected watchState ${this._watchState}`);
              }
              switch (this._watchState) {
                case "WAITING_ACTIVE":
                  this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting", "mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active", "mapboxgl-ctrl-geolocate-active");
                  break;
                case "ACTIVE_LOCK":
                  this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active", "mapboxgl-ctrl-geolocate-active");
                  break;
                case "OFF":
                  break;
                default:
                  throw new Error(`Unexpected watchState ${this._watchState}`);
              }
              if ("OFF" === this._watchState && void 0 !== this._geolocationWatchID)
                this._clearWatch();
              else if (void 0 === this._geolocationWatchID) {
                let t2;
                this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting", "mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.setAttribute("aria-pressed", "true"), ma++, ma > 1 ? (t2 = { maximumAge: 6e5, timeout: 0 }, _a = true) : (t2 = this.options.positionOptions, _a = false), this._geolocationWatchID = window.navigator.geolocation.watchPosition(this._onSuccess, this._onError, t2);
              }
            } else
              window.navigator.geolocation.getCurrentPosition(this._onSuccess, this._onError, this.options.positionOptions), this._timeoutId = setTimeout(this._finish, 1e4);
            return true;
          }
          _clearWatch() {
            window.navigator.geolocation.clearWatch(this._geolocationWatchID), this._geolocationWatchID = void 0, this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting", "mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.setAttribute("aria-pressed", "false"), this.options.showUserLocation && this._updateMarker(null);
          }
        }, AttributionControl: ta, LogoControl: ea, ScaleControl: class {
          constructor(e2) {
            this.options = t.extend({}, pa, e2), t.bindAll(["_onMove", "setUnit"], this);
          }
          getDefaultPosition() {
            return "bottom-left";
          }
          _onMove() {
            fa(this._map, this._container, this.options);
          }
          onAdd(t2) {
            return this._map = t2, this._container = r.create("div", "maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale", t2.getContainer()), this._map.on("move", this._onMove), this._onMove(), this._container;
          }
          onRemove() {
            r.remove(this._container), this._map.off("move", this._onMove), this._map = void 0;
          }
          setUnit(t2) {
            this.options.unit = t2, fa(this._map, this._container, this.options);
          }
        }, FullscreenControl: class {
          constructor(e2) {
            this._fullscreen = false, e2 && e2.container && (e2.container instanceof HTMLElement ? this._container = e2.container : t.warnOnce("Full screen control 'container' must be a DOM element.")), t.bindAll(["_onClickFullscreen", "_changeIcon"], this), "onfullscreenchange" in document ? this._fullscreenchange = "fullscreenchange" : "onmozfullscreenchange" in document ? this._fullscreenchange = "mozfullscreenchange" : "onwebkitfullscreenchange" in document ? this._fullscreenchange = "webkitfullscreenchange" : "onmsfullscreenchange" in document && (this._fullscreenchange = "MSFullscreenChange");
          }
          onAdd(e2) {
            return this._map = e2, this._container || (this._container = this._map.getContainer()), this._controlContainer = r.create("div", "maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"), this._checkFullscreenSupport() ? this._setupUI() : (this._controlContainer.style.display = "none", t.warnOnce("This device does not support fullscreen mode.")), this._controlContainer;
          }
          onRemove() {
            r.remove(this._controlContainer), this._map = null, window.document.removeEventListener(this._fullscreenchange, this._changeIcon);
          }
          _checkFullscreenSupport() {
            return !!(document.fullscreenEnabled || document.mozFullScreenEnabled || document.msFullscreenEnabled || document.webkitFullscreenEnabled);
          }
          _setupUI() {
            const t2 = this._fullscreenButton = r.create("button", "maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen", this._controlContainer);
            r.create("span", "maplibregl-ctrl-icon mapboxgl-ctrl-icon", t2).setAttribute("aria-hidden", "true"), t2.type = "button", this._updateTitle(), this._fullscreenButton.addEventListener("click", this._onClickFullscreen), window.document.addEventListener(this._fullscreenchange, this._changeIcon);
          }
          _updateTitle() {
            const t2 = this._getTitle();
            this._fullscreenButton.setAttribute("aria-label", t2), this._fullscreenButton.title = t2;
          }
          _getTitle() {
            return this._map._getUIString(this._isFullscreen() ? "FullscreenControl.Exit" : "FullscreenControl.Enter");
          }
          _isFullscreen() {
            return this._fullscreen;
          }
          _changeIcon() {
            (window.document.fullscreenElement || window.document.mozFullScreenElement || window.document.webkitFullscreenElement || window.document.msFullscreenElement) === this._container !== this._fullscreen && (this._fullscreen = !this._fullscreen, this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"), this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"), this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"), this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"), this._updateTitle());
          }
          _onClickFullscreen() {
            this._isFullscreen() ? window.document.exitFullscreen ? window.document.exitFullscreen() : window.document.mozCancelFullScreen ? window.document.mozCancelFullScreen() : window.document.msExitFullscreen ? window.document.msExitFullscreen() : window.document.webkitCancelFullScreen && window.document.webkitCancelFullScreen() : this._container.requestFullscreen ? this._container.requestFullscreen() : this._container.mozRequestFullScreen ? this._container.mozRequestFullScreen() : this._container.msRequestFullscreen ? this._container.msRequestFullscreen() : this._container.webkitRequestFullscreen && this._container.webkitRequestFullscreen();
          }
        }, TerrainControl: class {
          constructor(e2) {
            this.options = e2, t.bindAll(["_toggleTerrain", "_updateTerrainIcon"], this);
          }
          onAdd(t2) {
            return this._map = t2, this._container = r.create("div", "maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"), this._terrainButton = r.create("button", "maplibregl-ctrl-terrain mapboxgl-ctrl-terrain", this._container), r.create("span", "maplibregl-ctrl-icon mapboxgl-ctrl-icon", this._terrainButton).setAttribute("aria-hidden", "true"), this._terrainButton.type = "button", this._terrainButton.addEventListener("click", this._toggleTerrain), this._updateTerrainIcon(), this._map.on("terrain", this._updateTerrainIcon), this._container;
          }
          onRemove() {
            r.remove(this._container), this._map.off("terrain", this._updateTerrainIcon), this._map = void 0;
          }
          _toggleTerrain() {
            this._map.getTerrain() ? this._map.setTerrain(null) : this._map.setTerrain(this.options), this._updateTerrainIcon();
          }
          _updateTerrainIcon() {
            this._terrainButton.classList.remove("maplibregl-ctrl-terrain", "mapboxgl-ctrl-terrain"), this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled", "mapboxgl-ctrl-terrain-enabled"), this._map.style.terrain ? (this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled", "mapboxgl-ctrl-terrain-enabled"), this._terrainButton.title = this._map._getUIString("TerrainControl.disableTerrain")) : (this._terrainButton.classList.add("maplibregl-ctrl-terrain", "mapboxgl-ctrl-terrain"), this._terrainButton.title = this._map._getUIString("TerrainControl.enableTerrain"));
          }
        }, Popup: class extends t.Evented {
          constructor(e2) {
            super(), this.options = t.extend(Object.create(xa), e2), t.bindAll(["_update", "_onClose", "remove", "_onMouseMove", "_onMouseUp", "_onDrag"], this);
          }
          addTo(e2) {
            return this._map && this.remove(), this._map = e2, this.options.closeOnClick && this._map.on("click", this._onClose), this.options.closeOnMove && this._map.on("move", this._onClose), this._map.on("remove", this.remove), this._update(), this._focusFirstElement(), this._trackPointer ? (this._map.on("mousemove", this._onMouseMove), this._map.on("mouseup", this._onMouseUp), this._container && this._container.classList.add("maplibregl-popup-track-pointer", "mapboxgl-popup-track-pointer"), this._map._canvasContainer.classList.add("maplibregl-track-pointer", "mapboxgl-track-pointer")) : this._map.on("move", this._update), this.fire(new t.Event("open")), this;
          }
          isOpen() {
            return !!this._map;
          }
          remove() {
            return this._content && r.remove(this._content), this._container && (r.remove(this._container), delete this._container), this._map && (this._map.off("move", this._update), this._map.off("move", this._onClose), this._map.off("click", this._onClose), this._map.off("remove", this.remove), this._map.off("mousemove", this._onMouseMove), this._map.off("mouseup", this._onMouseUp), this._map.off("drag", this._onDrag), delete this._map), this.fire(new t.Event("close")), this;
          }
          getLngLat() {
            return this._lngLat;
          }
          setLngLat(e2) {
            return this._lngLat = t.LngLat.convert(e2), this._pos = null, this._trackPointer = false, this._update(), this._map && (this._map.on("move", this._update), this._map.off("mousemove", this._onMouseMove), this._container && this._container.classList.remove("maplibregl-popup-track-pointer", "mapboxgl-popup-track-pointer"), this._map._canvasContainer.classList.remove("maplibregl-track-pointer", "mapboxgl-track-pointer")), this;
          }
          trackPointer() {
            return this._trackPointer = true, this._pos = null, this._update(), this._map && (this._map.off("move", this._update), this._map.on("mousemove", this._onMouseMove), this._map.on("drag", this._onDrag), this._container && this._container.classList.add("maplibregl-popup-track-pointer", "mapboxgl-popup-track-pointer"), this._map._canvasContainer.classList.add("maplibregl-track-pointer", "mapboxgl-track-pointer")), this;
          }
          getElement() {
            return this._container;
          }
          setText(t2) {
            return this.setDOMContent(document.createTextNode(t2));
          }
          setHTML(t2) {
            const e2 = document.createDocumentFragment(), i2 = document.createElement("body");
            let o2;
            for (i2.innerHTML = t2; o2 = i2.firstChild, o2; )
              e2.appendChild(o2);
            return this.setDOMContent(e2);
          }
          getMaxWidth() {
            return this._container && this._container.style.maxWidth;
          }
          setMaxWidth(t2) {
            return this.options.maxWidth = t2, this._update(), this;
          }
          setDOMContent(t2) {
            if (this._content)
              for (; this._content.hasChildNodes(); )
                this._content.firstChild && this._content.removeChild(this._content.firstChild);
            else
              this._content = r.create("div", "maplibregl-popup-content mapboxgl-popup-content", this._container);
            return this._content.appendChild(t2), this._createCloseButton(), this._update(), this._focusFirstElement(), this;
          }
          addClassName(t2) {
            this._container && this._container.classList.add(t2);
          }
          removeClassName(t2) {
            this._container && this._container.classList.remove(t2);
          }
          setOffset(t2) {
            return this.options.offset = t2, this._update(), this;
          }
          toggleClassName(t2) {
            if (this._container)
              return this._container.classList.toggle(t2);
          }
          _createCloseButton() {
            this.options.closeButton && (this._closeButton = r.create("button", "maplibregl-popup-close-button mapboxgl-popup-close-button", this._content), this._closeButton.type = "button", this._closeButton.setAttribute("aria-label", "Close popup"), this._closeButton.innerHTML = "&#215;", this._closeButton.addEventListener("click", this._onClose));
          }
          _onMouseUp(t2) {
            this._update(t2.point);
          }
          _onMouseMove(t2) {
            this._update(t2.point);
          }
          _onDrag(t2) {
            this._update(t2.point);
          }
          _update(t2) {
            if (!this._map || !this._lngLat && !this._trackPointer || !this._content)
              return;
            if (this._container || (this._container = r.create("div", "maplibregl-popup mapboxgl-popup", this._map.getContainer()), this._tip = r.create("div", "maplibregl-popup-tip mapboxgl-popup-tip", this._container), this._container.appendChild(this._content), this.options.className && this.options.className.split(" ").forEach((t3) => this._container.classList.add(t3)), this._trackPointer && this._container.classList.add("maplibregl-popup-track-pointer", "mapboxgl-popup-track-pointer")), this.options.maxWidth && this._container.style.maxWidth !== this.options.maxWidth && (this._container.style.maxWidth = this.options.maxWidth), this._map.transform.renderWorldCopies && !this._trackPointer && (this._lngLat = na(this._lngLat, this._pos, this._map.transform)), this._trackPointer && !t2)
              return;
            const e2 = this._pos = this._trackPointer && t2 ? t2 : this._map.project(this._lngLat);
            let i2 = this.options.anchor;
            const o2 = ya(this.options.offset);
            if (!i2) {
              const t3 = this._container.offsetWidth, a3 = this._container.offsetHeight;
              let r2;
              r2 = e2.y + o2.bottom.y < a3 ? ["top"] : e2.y > this._map.transform.height - a3 ? ["bottom"] : [], e2.x < t3 / 2 ? r2.push("left") : e2.x > this._map.transform.width - t3 / 2 && r2.push("right"), i2 = 0 === r2.length ? "bottom" : r2.join("-");
            }
            const a2 = e2.add(o2[i2]).round();
            r.setTransform(this._container, `${la[i2]} translate(${a2.x}px,${a2.y}px)`), ca(this._container, i2, "popup");
          }
          _focusFirstElement() {
            if (!this.options.focusAfterOpen || !this._container)
              return;
            const t2 = this._container.querySelector(va);
            t2 && t2.focus();
          }
          _onClose() {
            this.remove();
          }
        }, Marker: ha, Style: ee, LngLat: t.LngLat, LngLatBounds: t.LngLatBounds, Point: t.pointGeometry, MercatorCoordinate: t.MercatorCoordinate, Evented: t.Evented, AJAXError: t.AJAXError, config: t.config, CanvasSource: P, GeoJSONSource: C, ImageSource: D, RasterDEMTileSource: I2, RasterTileSource: T, VectorTileSource: w, VideoSource: z, prewarm: function() {
          j().acquire(G);
        }, clearPrewarmedResources: function() {
          const t2 = q;
          t2 && (t2.isPreloaded() && 1 === t2.numActive() ? (t2.release(G), q = null) : console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"));
        }, get version() {
          return "2.4.0";
        }, get workerCount() {
          return Z2.workerCount;
        }, set workerCount(t2) {
          Z2.workerCount = t2;
        }, get maxParallelImageRequests() {
          return t.config.MAX_PARALLEL_IMAGE_REQUESTS;
        }, set maxParallelImageRequests(e2) {
          t.config.MAX_PARALLEL_IMAGE_REQUESTS = e2;
        }, clearStorage(e2) {
          t.clearTileCache(e2);
        }, workerUrl: "", addProtocol(e2, i2) {
          t.config.REGISTERED_PROTOCOLS[e2] = i2;
        }, removeProtocol(e2) {
          delete t.config.REGISTERED_PROTOCOLS[e2];
        } };
        return Jo.extend(ba, { isSafari: t.isSafari, getPerformanceMetrics: t.PerformanceUtils.getPerformanceMetrics }), ba;
      });
      var maplibregl$1 = maplibregl2;
      return maplibregl$1;
    });
  })(maplibreGl);
  const maplibregl = maplibreGl.exports;
  class MapLibreLayer extends Layer$1 {
    constructor(options) {
      const baseOptions = Object.assign({}, options);
      delete baseOptions.maplibreOptions;
      super(baseOptions);
      const container = document.createElement("div");
      container.style.position = "absolute";
      container.style.width = "100%";
      container.style.height = "100%";
      this.maplibreMap = new maplibregl.Map(
        Object.assign({}, options.maplibreOptions, {
          container,
          attributionControl: false,
          interactive: false,
          trackResize: false
        })
      );
      this.applyOpacity_();
    }
    setOpacity(opacity) {
      super.setOpacity(opacity);
      this.applyOpacity_();
    }
    applyOpacity_() {
      const canvas = this.maplibreMap.getCanvas();
      const opacity = this.getOpacity().toString();
      if (opacity !== canvas.style.opacity) {
        canvas.style.opacity = opacity;
      }
    }
    render(frameState) {
      const viewState = frameState.viewState;
      this.maplibreMap.jumpTo({
        center: toLonLat(viewState.center),
        zoom: viewState.zoom - 1,
        bearing: toDegrees(-viewState.rotation),
        animate: false
      });
      const maplibreCanvas = this.maplibreMap.getCanvas();
      if (!maplibreCanvas.isConnected) {
        this.getMapInternal().render();
      } else if (!sameSize(maplibreCanvas, frameState)) {
        this.maplibreMap.resize();
      }
      this.maplibreMap.redraw();
      return this.maplibreMap.getContainer();
    }
  }
  function sameSize(canvas, frameState) {
    return canvas.width === Math.floor(frameState.size[0] * frameState.pixelRatio) || canvas.height === Math.floor(frameState.size[1] * frameState.pixelRatio);
  }
  const layersCache = /* @__PURE__ */ new Map();
  const MapEventType = {
    POSTRENDER: "postrender",
    MOVESTART: "movestart",
    MOVEEND: "moveend",
    LOADSTART: "loadstart",
    LOADEND: "loadend"
  };
  class Control extends BaseObject$1 {
    constructor(options) {
      super();
      const element = options.element;
      if (element && !options.target && !element.style.pointerEvents) {
        element.style.pointerEvents = "auto";
      }
      this.element = element ? element : null;
      this.target_ = null;
      this.map_ = null;
      this.listenerKeys = [];
      if (options.render) {
        this.render = options.render;
      }
      if (options.target) {
        this.setTarget(options.target);
      }
    }
    disposeInternal() {
      removeNode(this.element);
      super.disposeInternal();
    }
    getMap() {
      return this.map_;
    }
    setMap(map2) {
      if (this.map_) {
        removeNode(this.element);
      }
      for (let i = 0, ii = this.listenerKeys.length; i < ii; ++i) {
        unlistenByKey(this.listenerKeys[i]);
      }
      this.listenerKeys.length = 0;
      this.map_ = map2;
      if (map2) {
        const target = this.target_ ? this.target_ : map2.getOverlayContainerStopEvent();
        target.appendChild(this.element);
        if (this.render !== VOID) {
          this.listenerKeys.push(
            listen(map2, MapEventType.POSTRENDER, this.render, this)
          );
        }
        map2.render();
      }
    }
    render(mapEvent) {
    }
    setTarget(target) {
      this.target_ = typeof target === "string" ? document.getElementById(target) : target;
    }
  }
  const Control$1 = Control;
  const CLASS_HIDDEN = "ol-hidden";
  const CLASS_UNSELECTABLE = "ol-unselectable";
  const CLASS_CONTROL = "ol-control";
  const CLASS_COLLAPSED = "ol-collapsed";
  class Attribution extends Control$1 {
    constructor(options) {
      options = options ? options : {};
      super({
        element: document.createElement("div"),
        render: options.render,
        target: options.target
      });
      this.ulElement_ = document.createElement("ul");
      this.collapsed_ = options.collapsed !== void 0 ? options.collapsed : true;
      this.userCollapsed_ = this.collapsed_;
      this.overrideCollapsible_ = options.collapsible !== void 0;
      this.collapsible_ = options.collapsible !== void 0 ? options.collapsible : true;
      if (!this.collapsible_) {
        this.collapsed_ = false;
      }
      const className = options.className !== void 0 ? options.className : "ol-attribution";
      const tipLabel = options.tipLabel !== void 0 ? options.tipLabel : "Attributions";
      const expandClassName = options.expandClassName !== void 0 ? options.expandClassName : className + "-expand";
      const collapseLabel = options.collapseLabel !== void 0 ? options.collapseLabel : "\u203A";
      const collapseClassName = options.collapseClassName !== void 0 ? options.collapseClassName : className + "-collapse";
      if (typeof collapseLabel === "string") {
        this.collapseLabel_ = document.createElement("span");
        this.collapseLabel_.textContent = collapseLabel;
        this.collapseLabel_.className = collapseClassName;
      } else {
        this.collapseLabel_ = collapseLabel;
      }
      const label = options.label !== void 0 ? options.label : "i";
      if (typeof label === "string") {
        this.label_ = document.createElement("span");
        this.label_.textContent = label;
        this.label_.className = expandClassName;
      } else {
        this.label_ = label;
      }
      const activeLabel = this.collapsible_ && !this.collapsed_ ? this.collapseLabel_ : this.label_;
      this.toggleButton_ = document.createElement("button");
      this.toggleButton_.setAttribute("type", "button");
      this.toggleButton_.setAttribute("aria-expanded", String(!this.collapsed_));
      this.toggleButton_.title = tipLabel;
      this.toggleButton_.appendChild(activeLabel);
      this.toggleButton_.addEventListener(
        EventType.CLICK,
        this.handleClick_.bind(this),
        false
      );
      const cssClasses = className + " " + CLASS_UNSELECTABLE + " " + CLASS_CONTROL + (this.collapsed_ && this.collapsible_ ? " " + CLASS_COLLAPSED : "") + (this.collapsible_ ? "" : " ol-uncollapsible");
      const element = this.element;
      element.className = cssClasses;
      element.appendChild(this.toggleButton_);
      element.appendChild(this.ulElement_);
      this.renderedAttributions_ = [];
      this.renderedVisible_ = true;
    }
    collectSourceAttributions_(frameState) {
      const visibleAttributions = Array.from(
        new Set(
          this.getMap().getAllLayers().flatMap((layer) => layer.getAttributions(frameState))
        )
      );
      const collapsible = !this.getMap().getAllLayers().some(
        (layer) => layer.getSource() && layer.getSource().getAttributionsCollapsible() === false
      );
      if (!this.overrideCollapsible_) {
        this.setCollapsible(collapsible);
      }
      return visibleAttributions;
    }
    updateElement_(frameState) {
      if (!frameState) {
        if (this.renderedVisible_) {
          this.element.style.display = "none";
          this.renderedVisible_ = false;
        }
        return;
      }
      const attributions = this.collectSourceAttributions_(frameState);
      const visible = attributions.length > 0;
      if (this.renderedVisible_ != visible) {
        this.element.style.display = visible ? "" : "none";
        this.renderedVisible_ = visible;
      }
      if (equals(attributions, this.renderedAttributions_)) {
        return;
      }
      removeChildren(this.ulElement_);
      for (let i = 0, ii = attributions.length; i < ii; ++i) {
        const element = document.createElement("li");
        element.innerHTML = attributions[i];
        this.ulElement_.appendChild(element);
      }
      this.renderedAttributions_ = attributions;
    }
    handleClick_(event) {
      event.preventDefault();
      this.handleToggle_();
      this.userCollapsed_ = this.collapsed_;
    }
    handleToggle_() {
      this.element.classList.toggle(CLASS_COLLAPSED);
      if (this.collapsed_) {
        replaceNode(this.collapseLabel_, this.label_);
      } else {
        replaceNode(this.label_, this.collapseLabel_);
      }
      this.collapsed_ = !this.collapsed_;
      this.toggleButton_.setAttribute("aria-expanded", String(!this.collapsed_));
    }
    getCollapsible() {
      return this.collapsible_;
    }
    setCollapsible(collapsible) {
      if (this.collapsible_ === collapsible) {
        return;
      }
      this.collapsible_ = collapsible;
      this.element.classList.toggle("ol-uncollapsible");
      if (this.userCollapsed_) {
        this.handleToggle_();
      }
    }
    setCollapsed(collapsed) {
      this.userCollapsed_ = collapsed;
      if (!this.collapsible_ || this.collapsed_ === collapsed) {
        return;
      }
      this.handleToggle_();
    }
    getCollapsed() {
      return this.collapsed_;
    }
    render(mapEvent) {
      this.updateElement_(mapEvent.frameState);
    }
  }
  const Attribution$1 = Attribution;
  const MapProperty = {
    LAYERGROUP: "layergroup",
    SIZE: "size",
    TARGET: "target",
    VIEW: "view"
  };
  const PointerEventType = {
    POINTERMOVE: "pointermove",
    POINTERDOWN: "pointerdown",
    POINTERUP: "pointerup",
    POINTEROVER: "pointerover",
    POINTEROUT: "pointerout",
    POINTERENTER: "pointerenter",
    POINTERLEAVE: "pointerleave",
    POINTERCANCEL: "pointercancel"
  };
  class IconImageCache {
    constructor() {
      this.cache_ = {};
      this.cacheSize_ = 0;
      this.maxCacheSize_ = 32;
    }
    clear() {
      this.cache_ = {};
      this.cacheSize_ = 0;
    }
    canExpireCache() {
      return this.cacheSize_ > this.maxCacheSize_;
    }
    expire() {
      if (this.canExpireCache()) {
        let i = 0;
        for (const key in this.cache_) {
          const iconImage = this.cache_[key];
          if ((i++ & 3) === 0 && !iconImage.hasListener()) {
            delete this.cache_[key];
            --this.cacheSize_;
          }
        }
      }
    }
    get(src2, crossOrigin, color) {
      const key = getKey(src2, crossOrigin, color);
      return key in this.cache_ ? this.cache_[key] : null;
    }
    set(src2, crossOrigin, color, iconImage) {
      const key = getKey(src2, crossOrigin, color);
      this.cache_[key] = iconImage;
      ++this.cacheSize_;
    }
    setSize(maxCacheSize) {
      this.maxCacheSize_ = maxCacheSize;
      this.expire();
    }
  }
  function getKey(src2, crossOrigin, color) {
    const colorString = color ? asString(color) : "null";
    return crossOrigin + ":" + src2 + ":" + colorString;
  }
  const shared = new IconImageCache();
  class MapRenderer extends Disposable$1 {
    constructor(map2) {
      super();
      this.map_ = map2;
    }
    dispatchRenderEvent(type, frameState) {
      abstract();
    }
    calculateMatrices2D(frameState) {
      const viewState = frameState.viewState;
      const coordinateToPixelTransform = frameState.coordinateToPixelTransform;
      const pixelToCoordinateTransform = frameState.pixelToCoordinateTransform;
      compose(
        coordinateToPixelTransform,
        frameState.size[0] / 2,
        frameState.size[1] / 2,
        1 / viewState.resolution,
        -1 / viewState.resolution,
        -viewState.rotation,
        -viewState.center[0],
        -viewState.center[1]
      );
      makeInverse(pixelToCoordinateTransform, coordinateToPixelTransform);
    }
    forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, checkWrapped, callback, thisArg, layerFilter, thisArg2) {
      let result;
      const viewState = frameState.viewState;
      function forEachFeatureAtCoordinate(managed, feature, layer, geometry) {
        return callback.call(thisArg, feature, managed ? layer : null, geometry);
      }
      const projection = viewState.projection;
      const translatedCoordinate = wrapX$1(coordinate.slice(), projection);
      const offsets = [[0, 0]];
      if (projection.canWrapX() && checkWrapped) {
        const projectionExtent = projection.getExtent();
        const worldWidth = getWidth(projectionExtent);
        offsets.push([-worldWidth, 0], [worldWidth, 0]);
      }
      const layerStates = frameState.layerStatesArray;
      const numLayers = layerStates.length;
      const matches2 = [];
      const tmpCoord = [];
      for (let i = 0; i < offsets.length; i++) {
        for (let j = numLayers - 1; j >= 0; --j) {
          const layerState = layerStates[j];
          const layer = layerState.layer;
          if (layer.hasRenderer() && inView(layerState, viewState) && layerFilter.call(thisArg2, layer)) {
            const layerRenderer = layer.getRenderer();
            const source = layer.getSource();
            if (layerRenderer && source) {
              const coordinates2 = source.getWrapX() ? translatedCoordinate : coordinate;
              const callback2 = forEachFeatureAtCoordinate.bind(
                null,
                layerState.managed
              );
              tmpCoord[0] = coordinates2[0] + offsets[i][0];
              tmpCoord[1] = coordinates2[1] + offsets[i][1];
              result = layerRenderer.forEachFeatureAtCoordinate(
                tmpCoord,
                frameState,
                hitTolerance,
                callback2,
                matches2
              );
            }
            if (result) {
              return result;
            }
          }
        }
      }
      if (matches2.length === 0) {
        return void 0;
      }
      const order = 1 / matches2.length;
      matches2.forEach((m, i) => m.distanceSq += i * order);
      matches2.sort((a, b) => a.distanceSq - b.distanceSq);
      matches2.some((m) => {
        return result = m.callback(m.feature, m.layer, m.geometry);
      });
      return result;
    }
    hasFeatureAtCoordinate(coordinate, frameState, hitTolerance, checkWrapped, layerFilter, thisArg) {
      const hasFeature = this.forEachFeatureAtCoordinate(
        coordinate,
        frameState,
        hitTolerance,
        checkWrapped,
        TRUE,
        this,
        layerFilter,
        thisArg
      );
      return hasFeature !== void 0;
    }
    getMap() {
      return this.map_;
    }
    renderFrame(frameState) {
      abstract();
    }
    scheduleExpireIconCache(frameState) {
      if (shared.canExpireCache()) {
        frameState.postRenderFunctions.push(expireIconCache);
      }
    }
  }
  function expireIconCache(map2, frameState) {
    shared.expire();
  }
  const MapRenderer$1 = MapRenderer;
  const checkedFonts = new BaseObject$1();
  class CompositeMapRenderer extends MapRenderer$1 {
    constructor(map2) {
      super(map2);
      this.fontChangeListenerKey_ = listen(
        checkedFonts,
        ObjectEventType.PROPERTYCHANGE,
        map2.redrawText.bind(map2)
      );
      this.element_ = document.createElement("div");
      const style = this.element_.style;
      style.position = "absolute";
      style.width = "100%";
      style.height = "100%";
      style.zIndex = "0";
      this.element_.className = CLASS_UNSELECTABLE + " ol-layers";
      const container = map2.getViewport();
      container.insertBefore(this.element_, container.firstChild || null);
      this.children_ = [];
      this.renderedVisible_ = true;
    }
    dispatchRenderEvent(type, frameState) {
      const map2 = this.getMap();
      if (map2.hasListener(type)) {
        const event = new RenderEvent$1(type, void 0, frameState);
        map2.dispatchEvent(event);
      }
    }
    disposeInternal() {
      unlistenByKey(this.fontChangeListenerKey_);
      this.element_.parentNode.removeChild(this.element_);
      super.disposeInternal();
    }
    renderFrame(frameState) {
      if (!frameState) {
        if (this.renderedVisible_) {
          this.element_.style.display = "none";
          this.renderedVisible_ = false;
        }
        return;
      }
      this.calculateMatrices2D(frameState);
      this.dispatchRenderEvent(RenderEventType.PRECOMPOSE, frameState);
      const layerStatesArray = frameState.layerStatesArray.sort(function(a, b) {
        return a.zIndex - b.zIndex;
      });
      const viewState = frameState.viewState;
      this.children_.length = 0;
      const declutterLayers = [];
      let previousElement = null;
      for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {
        const layerState = layerStatesArray[i];
        frameState.layerIndex = i;
        const layer = layerState.layer;
        const sourceState = layer.getSourceState();
        if (!inView(layerState, viewState) || sourceState != "ready" && sourceState != "undefined") {
          layer.unrender();
          continue;
        }
        const element = layer.render(frameState, previousElement);
        if (!element) {
          continue;
        }
        if (element !== previousElement) {
          this.children_.push(element);
          previousElement = element;
        }
        if ("getDeclutter" in layer) {
          declutterLayers.push(
            layer
          );
        }
      }
      for (let i = declutterLayers.length - 1; i >= 0; --i) {
        declutterLayers[i].renderDeclutter(frameState);
      }
      replaceChildren(this.element_, this.children_);
      this.dispatchRenderEvent(RenderEventType.POSTCOMPOSE, frameState);
      if (!this.renderedVisible_) {
        this.element_.style.display = "";
        this.renderedVisible_ = true;
      }
      this.scheduleExpireIconCache(frameState);
    }
  }
  const CompositeMapRenderer$1 = CompositeMapRenderer;
  class GroupEvent extends Event {
    constructor(type, layer) {
      super(type);
      this.layer = layer;
    }
  }
  const Property = {
    LAYERS: "layers"
  };
  class LayerGroup extends BaseLayer$1 {
    constructor(options) {
      options = options || {};
      const baseOptions = Object.assign({}, options);
      delete baseOptions.layers;
      let layers = options.layers;
      super(baseOptions);
      this.on;
      this.once;
      this.un;
      this.layersListenerKeys_ = [];
      this.listenerKeys_ = {};
      this.addChangeListener(Property.LAYERS, this.handleLayersChanged_);
      if (layers) {
        if (Array.isArray(layers)) {
          layers = new Collection$1(layers.slice(), { unique: true });
        } else {
          assert(typeof layers.getArray === "function", 43);
        }
      } else {
        layers = new Collection$1(void 0, { unique: true });
      }
      this.setLayers(layers);
    }
    handleLayerChange_() {
      this.changed();
    }
    handleLayersChanged_() {
      this.layersListenerKeys_.forEach(unlistenByKey);
      this.layersListenerKeys_.length = 0;
      const layers = this.getLayers();
      this.layersListenerKeys_.push(
        listen(layers, CollectionEventType.ADD, this.handleLayersAdd_, this),
        listen(layers, CollectionEventType.REMOVE, this.handleLayersRemove_, this)
      );
      for (const id in this.listenerKeys_) {
        this.listenerKeys_[id].forEach(unlistenByKey);
      }
      clear(this.listenerKeys_);
      const layersArray = layers.getArray();
      for (let i = 0, ii = layersArray.length; i < ii; i++) {
        const layer = layersArray[i];
        this.registerLayerListeners_(layer);
        this.dispatchEvent(new GroupEvent("addlayer", layer));
      }
      this.changed();
    }
    registerLayerListeners_(layer) {
      const listenerKeys = [
        listen(
          layer,
          ObjectEventType.PROPERTYCHANGE,
          this.handleLayerChange_,
          this
        ),
        listen(layer, EventType.CHANGE, this.handleLayerChange_, this)
      ];
      if (layer instanceof LayerGroup) {
        listenerKeys.push(
          listen(layer, "addlayer", this.handleLayerGroupAdd_, this),
          listen(layer, "removelayer", this.handleLayerGroupRemove_, this)
        );
      }
      this.listenerKeys_[getUid(layer)] = listenerKeys;
    }
    handleLayerGroupAdd_(event) {
      this.dispatchEvent(new GroupEvent("addlayer", event.layer));
    }
    handleLayerGroupRemove_(event) {
      this.dispatchEvent(new GroupEvent("removelayer", event.layer));
    }
    handleLayersAdd_(collectionEvent) {
      const layer = collectionEvent.element;
      this.registerLayerListeners_(layer);
      this.dispatchEvent(new GroupEvent("addlayer", layer));
      this.changed();
    }
    handleLayersRemove_(collectionEvent) {
      const layer = collectionEvent.element;
      const key = getUid(layer);
      this.listenerKeys_[key].forEach(unlistenByKey);
      delete this.listenerKeys_[key];
      this.dispatchEvent(new GroupEvent("removelayer", layer));
      this.changed();
    }
    getLayers() {
      return this.get(Property.LAYERS);
    }
    setLayers(layers) {
      const collection = this.getLayers();
      if (collection) {
        const currentLayers = collection.getArray();
        for (let i = 0, ii = currentLayers.length; i < ii; ++i) {
          this.dispatchEvent(new GroupEvent("removelayer", currentLayers[i]));
        }
      }
      this.set(Property.LAYERS, layers);
    }
    getLayersArray(array) {
      array = array !== void 0 ? array : [];
      this.getLayers().forEach(function(layer) {
        layer.getLayersArray(array);
      });
      return array;
    }
    getLayerStatesArray(dest) {
      const states = dest !== void 0 ? dest : [];
      const pos = states.length;
      this.getLayers().forEach(function(layer) {
        layer.getLayerStatesArray(states);
      });
      const ownLayerState = this.getLayerState();
      let defaultZIndex = ownLayerState.zIndex;
      if (!dest && ownLayerState.zIndex === void 0) {
        defaultZIndex = 0;
      }
      for (let i = pos, ii = states.length; i < ii; i++) {
        const layerState = states[i];
        layerState.opacity *= ownLayerState.opacity;
        layerState.visible = layerState.visible && ownLayerState.visible;
        layerState.maxResolution = Math.min(
          layerState.maxResolution,
          ownLayerState.maxResolution
        );
        layerState.minResolution = Math.max(
          layerState.minResolution,
          ownLayerState.minResolution
        );
        layerState.minZoom = Math.max(layerState.minZoom, ownLayerState.minZoom);
        layerState.maxZoom = Math.min(layerState.maxZoom, ownLayerState.maxZoom);
        if (ownLayerState.extent !== void 0) {
          if (layerState.extent !== void 0) {
            layerState.extent = getIntersection(
              layerState.extent,
              ownLayerState.extent
            );
          } else {
            layerState.extent = ownLayerState.extent;
          }
        }
        if (layerState.zIndex === void 0) {
          layerState.zIndex = defaultZIndex;
        }
      }
      return states;
    }
    getSourceState() {
      return "ready";
    }
  }
  const LayerGroup$1 = LayerGroup;
  class MapEvent extends Event {
    constructor(type, map2, frameState) {
      super(type);
      this.map = map2;
      this.frameState = frameState !== void 0 ? frameState : null;
    }
  }
  const MapEvent$1 = MapEvent;
  class MapBrowserEvent extends MapEvent$1 {
    constructor(type, map2, originalEvent, dragging, frameState, activePointers) {
      super(type, map2, frameState);
      this.originalEvent = originalEvent;
      this.pixel_ = null;
      this.coordinate_ = null;
      this.dragging = dragging !== void 0 ? dragging : false;
      this.activePointers = activePointers;
    }
    get pixel() {
      if (!this.pixel_) {
        this.pixel_ = this.map.getEventPixel(this.originalEvent);
      }
      return this.pixel_;
    }
    set pixel(pixel) {
      this.pixel_ = pixel;
    }
    get coordinate() {
      if (!this.coordinate_) {
        this.coordinate_ = this.map.getCoordinateFromPixel(this.pixel);
      }
      return this.coordinate_;
    }
    set coordinate(coordinate) {
      this.coordinate_ = coordinate;
    }
    preventDefault() {
      super.preventDefault();
      if ("preventDefault" in this.originalEvent) {
        this.originalEvent.preventDefault();
      }
    }
    stopPropagation() {
      super.stopPropagation();
      if ("stopPropagation" in this.originalEvent) {
        this.originalEvent.stopPropagation();
      }
    }
  }
  const MapBrowserEvent$1 = MapBrowserEvent;
  const MapBrowserEventType = {
    SINGLECLICK: "singleclick",
    CLICK: EventType.CLICK,
    DBLCLICK: EventType.DBLCLICK,
    POINTERDRAG: "pointerdrag",
    POINTERMOVE: "pointermove",
    POINTERDOWN: "pointerdown",
    POINTERUP: "pointerup",
    POINTEROVER: "pointerover",
    POINTEROUT: "pointerout",
    POINTERENTER: "pointerenter",
    POINTERLEAVE: "pointerleave",
    POINTERCANCEL: "pointercancel"
  };
  class MapBrowserEventHandler extends Target$1 {
    constructor(map2, moveTolerance) {
      super(map2);
      this.map_ = map2;
      this.clickTimeoutId_;
      this.emulateClicks_ = false;
      this.dragging_ = false;
      this.dragListenerKeys_ = [];
      this.moveTolerance_ = moveTolerance === void 0 ? 1 : moveTolerance;
      this.down_ = null;
      const element = this.map_.getViewport();
      this.activePointers_ = [];
      this.trackedTouches_ = {};
      this.element_ = element;
      this.pointerdownListenerKey_ = listen(
        element,
        PointerEventType.POINTERDOWN,
        this.handlePointerDown_,
        this
      );
      this.originalPointerMoveEvent_;
      this.relayedListenerKey_ = listen(
        element,
        PointerEventType.POINTERMOVE,
        this.relayMoveEvent_,
        this
      );
      this.boundHandleTouchMove_ = this.handleTouchMove_.bind(this);
      this.element_.addEventListener(
        EventType.TOUCHMOVE,
        this.boundHandleTouchMove_,
        PASSIVE_EVENT_LISTENERS ? { passive: false } : false
      );
    }
    emulateClick_(pointerEvent) {
      let newEvent = new MapBrowserEvent$1(
        MapBrowserEventType.CLICK,
        this.map_,
        pointerEvent
      );
      this.dispatchEvent(newEvent);
      if (this.clickTimeoutId_ !== void 0) {
        clearTimeout(this.clickTimeoutId_);
        this.clickTimeoutId_ = void 0;
        newEvent = new MapBrowserEvent$1(
          MapBrowserEventType.DBLCLICK,
          this.map_,
          pointerEvent
        );
        this.dispatchEvent(newEvent);
      } else {
        this.clickTimeoutId_ = setTimeout(() => {
          this.clickTimeoutId_ = void 0;
          const newEvent2 = new MapBrowserEvent$1(
            MapBrowserEventType.SINGLECLICK,
            this.map_,
            pointerEvent
          );
          this.dispatchEvent(newEvent2);
        }, 250);
      }
    }
    updateActivePointers_(pointerEvent) {
      const event = pointerEvent;
      const id = event.pointerId;
      if (event.type == MapBrowserEventType.POINTERUP || event.type == MapBrowserEventType.POINTERCANCEL) {
        delete this.trackedTouches_[id];
        for (const pointerId in this.trackedTouches_) {
          if (this.trackedTouches_[pointerId].target !== event.target) {
            delete this.trackedTouches_[pointerId];
            break;
          }
        }
      } else if (event.type == MapBrowserEventType.POINTERDOWN || event.type == MapBrowserEventType.POINTERMOVE) {
        this.trackedTouches_[id] = event;
      }
      this.activePointers_ = Object.values(this.trackedTouches_);
    }
    handlePointerUp_(pointerEvent) {
      this.updateActivePointers_(pointerEvent);
      const newEvent = new MapBrowserEvent$1(
        MapBrowserEventType.POINTERUP,
        this.map_,
        pointerEvent,
        void 0,
        void 0,
        this.activePointers_
      );
      this.dispatchEvent(newEvent);
      if (this.emulateClicks_ && !newEvent.defaultPrevented && !this.dragging_ && this.isMouseActionButton_(pointerEvent)) {
        this.emulateClick_(this.down_);
      }
      if (this.activePointers_.length === 0) {
        this.dragListenerKeys_.forEach(unlistenByKey);
        this.dragListenerKeys_.length = 0;
        this.dragging_ = false;
        this.down_ = null;
      }
    }
    isMouseActionButton_(pointerEvent) {
      return pointerEvent.button === 0;
    }
    handlePointerDown_(pointerEvent) {
      this.emulateClicks_ = this.activePointers_.length === 0;
      this.updateActivePointers_(pointerEvent);
      const newEvent = new MapBrowserEvent$1(
        MapBrowserEventType.POINTERDOWN,
        this.map_,
        pointerEvent,
        void 0,
        void 0,
        this.activePointers_
      );
      this.dispatchEvent(newEvent);
      this.down_ = new PointerEvent(pointerEvent.type, pointerEvent);
      Object.defineProperty(this.down_, "target", {
        writable: false,
        value: pointerEvent.target
      });
      if (this.dragListenerKeys_.length === 0) {
        const doc = this.map_.getOwnerDocument();
        this.dragListenerKeys_.push(
          listen(
            doc,
            MapBrowserEventType.POINTERMOVE,
            this.handlePointerMove_,
            this
          ),
          listen(doc, MapBrowserEventType.POINTERUP, this.handlePointerUp_, this),
          listen(
            this.element_,
            MapBrowserEventType.POINTERCANCEL,
            this.handlePointerUp_,
            this
          )
        );
        if (this.element_.getRootNode && this.element_.getRootNode() !== doc) {
          this.dragListenerKeys_.push(
            listen(
              this.element_.getRootNode(),
              MapBrowserEventType.POINTERUP,
              this.handlePointerUp_,
              this
            )
          );
        }
      }
    }
    handlePointerMove_(pointerEvent) {
      if (this.isMoving_(pointerEvent)) {
        this.updateActivePointers_(pointerEvent);
        this.dragging_ = true;
        const newEvent = new MapBrowserEvent$1(
          MapBrowserEventType.POINTERDRAG,
          this.map_,
          pointerEvent,
          this.dragging_,
          void 0,
          this.activePointers_
        );
        this.dispatchEvent(newEvent);
      }
    }
    relayMoveEvent_(pointerEvent) {
      this.originalPointerMoveEvent_ = pointerEvent;
      const dragging = !!(this.down_ && this.isMoving_(pointerEvent));
      this.dispatchEvent(
        new MapBrowserEvent$1(
          MapBrowserEventType.POINTERMOVE,
          this.map_,
          pointerEvent,
          dragging
        )
      );
    }
    handleTouchMove_(event) {
      const originalEvent = this.originalPointerMoveEvent_;
      if ((!originalEvent || originalEvent.defaultPrevented) && (typeof event.cancelable !== "boolean" || event.cancelable === true)) {
        event.preventDefault();
      }
    }
    isMoving_(pointerEvent) {
      return this.dragging_ || Math.abs(pointerEvent.clientX - this.down_.clientX) > this.moveTolerance_ || Math.abs(pointerEvent.clientY - this.down_.clientY) > this.moveTolerance_;
    }
    disposeInternal() {
      if (this.relayedListenerKey_) {
        unlistenByKey(this.relayedListenerKey_);
        this.relayedListenerKey_ = null;
      }
      this.element_.removeEventListener(
        EventType.TOUCHMOVE,
        this.boundHandleTouchMove_
      );
      if (this.pointerdownListenerKey_) {
        unlistenByKey(this.pointerdownListenerKey_);
        this.pointerdownListenerKey_ = null;
      }
      this.dragListenerKeys_.forEach(unlistenByKey);
      this.dragListenerKeys_.length = 0;
      this.element_ = null;
      super.disposeInternal();
    }
  }
  const MapBrowserEventHandler$1 = MapBrowserEventHandler;
  class Rotate extends Control$1 {
    constructor(options) {
      options = options ? options : {};
      super({
        element: document.createElement("div"),
        render: options.render,
        target: options.target
      });
      const className = options.className !== void 0 ? options.className : "ol-rotate";
      const label = options.label !== void 0 ? options.label : "\u21E7";
      const compassClassName = options.compassClassName !== void 0 ? options.compassClassName : "ol-compass";
      this.label_ = null;
      if (typeof label === "string") {
        this.label_ = document.createElement("span");
        this.label_.className = compassClassName;
        this.label_.textContent = label;
      } else {
        this.label_ = label;
        this.label_.classList.add(compassClassName);
      }
      const tipLabel = options.tipLabel ? options.tipLabel : "Reset rotation";
      const button = document.createElement("button");
      button.className = className + "-reset";
      button.setAttribute("type", "button");
      button.title = tipLabel;
      button.appendChild(this.label_);
      button.addEventListener(
        EventType.CLICK,
        this.handleClick_.bind(this),
        false
      );
      const cssClasses = className + " " + CLASS_UNSELECTABLE + " " + CLASS_CONTROL;
      const element = this.element;
      element.className = cssClasses;
      element.appendChild(button);
      this.callResetNorth_ = options.resetNorth ? options.resetNorth : void 0;
      this.duration_ = options.duration !== void 0 ? options.duration : 250;
      this.autoHide_ = options.autoHide !== void 0 ? options.autoHide : true;
      this.rotation_ = void 0;
      if (this.autoHide_) {
        this.element.classList.add(CLASS_HIDDEN);
      }
    }
    handleClick_(event) {
      event.preventDefault();
      if (this.callResetNorth_ !== void 0) {
        this.callResetNorth_();
      } else {
        this.resetNorth_();
      }
    }
    resetNorth_() {
      const map2 = this.getMap();
      const view = map2.getView();
      if (!view) {
        return;
      }
      const rotation = view.getRotation();
      if (rotation !== void 0) {
        if (this.duration_ > 0 && rotation % (2 * Math.PI) !== 0) {
          view.animate({
            rotation: 0,
            duration: this.duration_,
            easing: easeOut
          });
        } else {
          view.setRotation(0);
        }
      }
    }
    render(mapEvent) {
      const frameState = mapEvent.frameState;
      if (!frameState) {
        return;
      }
      const rotation = frameState.viewState.rotation;
      if (rotation != this.rotation_) {
        const transform2 = "rotate(" + rotation + "rad)";
        if (this.autoHide_) {
          const contains = this.element.classList.contains(CLASS_HIDDEN);
          if (!contains && rotation === 0) {
            this.element.classList.add(CLASS_HIDDEN);
          } else if (contains && rotation !== 0) {
            this.element.classList.remove(CLASS_HIDDEN);
          }
        }
        this.label_.style.transform = transform2;
      }
      this.rotation_ = rotation;
    }
  }
  const Rotate$1 = Rotate;
  class Zoom extends Control$1 {
    constructor(options) {
      options = options ? options : {};
      super({
        element: document.createElement("div"),
        target: options.target
      });
      const className = options.className !== void 0 ? options.className : "ol-zoom";
      const delta = options.delta !== void 0 ? options.delta : 1;
      const zoomInClassName = options.zoomInClassName !== void 0 ? options.zoomInClassName : className + "-in";
      const zoomOutClassName = options.zoomOutClassName !== void 0 ? options.zoomOutClassName : className + "-out";
      const zoomInLabel = options.zoomInLabel !== void 0 ? options.zoomInLabel : "+";
      const zoomOutLabel = options.zoomOutLabel !== void 0 ? options.zoomOutLabel : "\u2013";
      const zoomInTipLabel = options.zoomInTipLabel !== void 0 ? options.zoomInTipLabel : "Zoom in";
      const zoomOutTipLabel = options.zoomOutTipLabel !== void 0 ? options.zoomOutTipLabel : "Zoom out";
      const inElement = document.createElement("button");
      inElement.className = zoomInClassName;
      inElement.setAttribute("type", "button");
      inElement.title = zoomInTipLabel;
      inElement.appendChild(
        typeof zoomInLabel === "string" ? document.createTextNode(zoomInLabel) : zoomInLabel
      );
      inElement.addEventListener(
        EventType.CLICK,
        this.handleClick_.bind(this, delta),
        false
      );
      const outElement = document.createElement("button");
      outElement.className = zoomOutClassName;
      outElement.setAttribute("type", "button");
      outElement.title = zoomOutTipLabel;
      outElement.appendChild(
        typeof zoomOutLabel === "string" ? document.createTextNode(zoomOutLabel) : zoomOutLabel
      );
      outElement.addEventListener(
        EventType.CLICK,
        this.handleClick_.bind(this, -delta),
        false
      );
      const cssClasses = className + " " + CLASS_UNSELECTABLE + " " + CLASS_CONTROL;
      const element = this.element;
      element.className = cssClasses;
      element.appendChild(inElement);
      element.appendChild(outElement);
      this.duration_ = options.duration !== void 0 ? options.duration : 250;
    }
    handleClick_(delta, event) {
      event.preventDefault();
      this.zoomByDelta_(delta);
    }
    zoomByDelta_(delta) {
      const map2 = this.getMap();
      const view = map2.getView();
      if (!view) {
        return;
      }
      const currentZoom = view.getZoom();
      if (currentZoom !== void 0) {
        const newZoom = view.getConstrainedZoom(currentZoom + delta);
        if (this.duration_ > 0) {
          if (view.getAnimating()) {
            view.cancelAnimations();
          }
          view.animate({
            zoom: newZoom,
            duration: this.duration_,
            easing: easeOut
          });
        } else {
          view.setZoom(newZoom);
        }
      }
    }
  }
  const Zoom$1 = Zoom;
  function defaults$1(options) {
    options = options ? options : {};
    const controls = new Collection$1();
    const zoomControl = options.zoom !== void 0 ? options.zoom : true;
    if (zoomControl) {
      controls.push(new Zoom$1(options.zoomOptions));
    }
    const rotateControl = options.rotate !== void 0 ? options.rotate : true;
    if (rotateControl) {
      controls.push(new Rotate$1(options.rotateOptions));
    }
    const attributionControl = options.attribution !== void 0 ? options.attribution : true;
    if (attributionControl) {
      controls.push(new Attribution$1(options.attributionOptions));
    }
    return controls;
  }
  const InteractionProperty = {
    ACTIVE: "active"
  };
  class Interaction extends BaseObject$1 {
    constructor(options) {
      super();
      this.on;
      this.once;
      this.un;
      if (options && options.handleEvent) {
        this.handleEvent = options.handleEvent;
      }
      this.map_ = null;
      this.setActive(true);
    }
    getActive() {
      return this.get(InteractionProperty.ACTIVE);
    }
    getMap() {
      return this.map_;
    }
    handleEvent(mapBrowserEvent) {
      return true;
    }
    setActive(active) {
      this.set(InteractionProperty.ACTIVE, active);
    }
    setMap(map2) {
      this.map_ = map2;
    }
  }
  function pan(view, delta, duration) {
    const currentCenter = view.getCenterInternal();
    if (currentCenter) {
      const center = [currentCenter[0] + delta[0], currentCenter[1] + delta[1]];
      view.animateInternal({
        duration: duration !== void 0 ? duration : 250,
        easing: linear,
        center: view.getConstrainedCenter(center)
      });
    }
  }
  function zoomByDelta(view, delta, anchor, duration) {
    const currentZoom = view.getZoom();
    if (currentZoom === void 0) {
      return;
    }
    const newZoom = view.getConstrainedZoom(currentZoom + delta);
    const newResolution = view.getResolutionForZoom(newZoom);
    if (view.getAnimating()) {
      view.cancelAnimations();
    }
    view.animate({
      resolution: newResolution,
      anchor,
      duration: duration !== void 0 ? duration : 250,
      easing: easeOut
    });
  }
  const Interaction$1 = Interaction;
  class DoubleClickZoom extends Interaction$1 {
    constructor(options) {
      super();
      options = options ? options : {};
      this.delta_ = options.delta ? options.delta : 1;
      this.duration_ = options.duration !== void 0 ? options.duration : 250;
    }
    handleEvent(mapBrowserEvent) {
      let stopEvent = false;
      if (mapBrowserEvent.type == MapBrowserEventType.DBLCLICK) {
        const browserEvent = mapBrowserEvent.originalEvent;
        const map2 = mapBrowserEvent.map;
        const anchor = mapBrowserEvent.coordinate;
        const delta = browserEvent.shiftKey ? -this.delta_ : this.delta_;
        const view = map2.getView();
        zoomByDelta(view, delta, anchor, this.duration_);
        browserEvent.preventDefault();
        stopEvent = true;
      }
      return !stopEvent;
    }
  }
  const DoubleClickZoom$1 = DoubleClickZoom;
  class PointerInteraction extends Interaction$1 {
    constructor(options) {
      options = options ? options : {};
      super(
        options
      );
      if (options.handleDownEvent) {
        this.handleDownEvent = options.handleDownEvent;
      }
      if (options.handleDragEvent) {
        this.handleDragEvent = options.handleDragEvent;
      }
      if (options.handleMoveEvent) {
        this.handleMoveEvent = options.handleMoveEvent;
      }
      if (options.handleUpEvent) {
        this.handleUpEvent = options.handleUpEvent;
      }
      if (options.stopDown) {
        this.stopDown = options.stopDown;
      }
      this.handlingDownUpSequence = false;
      this.targetPointers = [];
    }
    getPointerCount() {
      return this.targetPointers.length;
    }
    handleDownEvent(mapBrowserEvent) {
      return false;
    }
    handleDragEvent(mapBrowserEvent) {
    }
    handleEvent(mapBrowserEvent) {
      if (!mapBrowserEvent.originalEvent) {
        return true;
      }
      let stopEvent = false;
      this.updateTrackedPointers_(mapBrowserEvent);
      if (this.handlingDownUpSequence) {
        if (mapBrowserEvent.type == MapBrowserEventType.POINTERDRAG) {
          this.handleDragEvent(mapBrowserEvent);
          mapBrowserEvent.originalEvent.preventDefault();
        } else if (mapBrowserEvent.type == MapBrowserEventType.POINTERUP) {
          const handledUp = this.handleUpEvent(mapBrowserEvent);
          this.handlingDownUpSequence = handledUp && this.targetPointers.length > 0;
        }
      } else {
        if (mapBrowserEvent.type == MapBrowserEventType.POINTERDOWN) {
          const handled = this.handleDownEvent(mapBrowserEvent);
          this.handlingDownUpSequence = handled;
          stopEvent = this.stopDown(handled);
        } else if (mapBrowserEvent.type == MapBrowserEventType.POINTERMOVE) {
          this.handleMoveEvent(mapBrowserEvent);
        }
      }
      return !stopEvent;
    }
    handleMoveEvent(mapBrowserEvent) {
    }
    handleUpEvent(mapBrowserEvent) {
      return false;
    }
    stopDown(handled) {
      return handled;
    }
    updateTrackedPointers_(mapBrowserEvent) {
      if (mapBrowserEvent.activePointers) {
        this.targetPointers = mapBrowserEvent.activePointers;
      }
    }
  }
  function centroid(pointerEvents) {
    const length = pointerEvents.length;
    let clientX = 0;
    let clientY = 0;
    for (let i = 0; i < length; i++) {
      clientX += pointerEvents[i].clientX;
      clientY += pointerEvents[i].clientY;
    }
    return { clientX: clientX / length, clientY: clientY / length };
  }
  const PointerInteraction$1 = PointerInteraction;
  function all(var_args) {
    const conditions = arguments;
    return function(event) {
      let pass = true;
      for (let i = 0, ii = conditions.length; i < ii; ++i) {
        pass = pass && conditions[i](event);
        if (!pass) {
          break;
        }
      }
      return pass;
    };
  }
  const altShiftKeysOnly = function(mapBrowserEvent) {
    const originalEvent = mapBrowserEvent.originalEvent;
    return originalEvent.altKey && !(originalEvent.metaKey || originalEvent.ctrlKey) && originalEvent.shiftKey;
  };
  const focus = function(event) {
    const targetElement = event.map.getTargetElement();
    const activeElement = event.map.getOwnerDocument().activeElement;
    return targetElement.contains(activeElement);
  };
  const focusWithTabindex = function(event) {
    return event.map.getTargetElement().hasAttribute("tabindex") ? focus(event) : true;
  };
  const always = TRUE;
  const mouseActionButton = function(mapBrowserEvent) {
    const originalEvent = mapBrowserEvent.originalEvent;
    return originalEvent.button == 0 && !(WEBKIT && MAC && originalEvent.ctrlKey);
  };
  const noModifierKeys = function(mapBrowserEvent) {
    const originalEvent = mapBrowserEvent.originalEvent;
    return !originalEvent.altKey && !(originalEvent.metaKey || originalEvent.ctrlKey) && !originalEvent.shiftKey;
  };
  const shiftKeyOnly = function(mapBrowserEvent) {
    const originalEvent = mapBrowserEvent.originalEvent;
    return !originalEvent.altKey && !(originalEvent.metaKey || originalEvent.ctrlKey) && originalEvent.shiftKey;
  };
  const targetNotEditable = function(mapBrowserEvent) {
    const originalEvent = mapBrowserEvent.originalEvent;
    const tagName = originalEvent.target.tagName;
    return tagName !== "INPUT" && tagName !== "SELECT" && tagName !== "TEXTAREA" && !originalEvent.target.isContentEditable;
  };
  const mouseOnly = function(mapBrowserEvent) {
    const pointerEvent = mapBrowserEvent.originalEvent;
    assert(pointerEvent !== void 0, 56);
    return pointerEvent.pointerType == "mouse";
  };
  const primaryAction = function(mapBrowserEvent) {
    const pointerEvent = mapBrowserEvent.originalEvent;
    assert(pointerEvent !== void 0, 56);
    return pointerEvent.isPrimary && pointerEvent.button === 0;
  };
  class DragPan extends PointerInteraction$1 {
    constructor(options) {
      super({
        stopDown: FALSE
      });
      options = options ? options : {};
      this.kinetic_ = options.kinetic;
      this.lastCentroid = null;
      this.lastPointersCount_;
      this.panning_ = false;
      const condition = options.condition ? options.condition : all(noModifierKeys, primaryAction);
      this.condition_ = options.onFocusOnly ? all(focusWithTabindex, condition) : condition;
      this.noKinetic_ = false;
    }
    handleDragEvent(mapBrowserEvent) {
      const map2 = mapBrowserEvent.map;
      if (!this.panning_) {
        this.panning_ = true;
        map2.getView().beginInteraction();
      }
      const targetPointers = this.targetPointers;
      const centroid$1 = map2.getEventPixel(centroid(targetPointers));
      if (targetPointers.length == this.lastPointersCount_) {
        if (this.kinetic_) {
          this.kinetic_.update(centroid$1[0], centroid$1[1]);
        }
        if (this.lastCentroid) {
          const delta = [
            this.lastCentroid[0] - centroid$1[0],
            centroid$1[1] - this.lastCentroid[1]
          ];
          const map3 = mapBrowserEvent.map;
          const view = map3.getView();
          scale$2(delta, view.getResolution());
          rotate$1(delta, view.getRotation());
          view.adjustCenterInternal(delta);
        }
      } else if (this.kinetic_) {
        this.kinetic_.begin();
      }
      this.lastCentroid = centroid$1;
      this.lastPointersCount_ = targetPointers.length;
      mapBrowserEvent.originalEvent.preventDefault();
    }
    handleUpEvent(mapBrowserEvent) {
      const map2 = mapBrowserEvent.map;
      const view = map2.getView();
      if (this.targetPointers.length === 0) {
        if (!this.noKinetic_ && this.kinetic_ && this.kinetic_.end()) {
          const distance = this.kinetic_.getDistance();
          const angle = this.kinetic_.getAngle();
          const center = view.getCenterInternal();
          const centerpx = map2.getPixelFromCoordinateInternal(center);
          const dest = map2.getCoordinateFromPixelInternal([
            centerpx[0] - distance * Math.cos(angle),
            centerpx[1] - distance * Math.sin(angle)
          ]);
          view.animateInternal({
            center: view.getConstrainedCenter(dest),
            duration: 500,
            easing: easeOut
          });
        }
        if (this.panning_) {
          this.panning_ = false;
          view.endInteraction();
        }
        return false;
      }
      if (this.kinetic_) {
        this.kinetic_.begin();
      }
      this.lastCentroid = null;
      return true;
    }
    handleDownEvent(mapBrowserEvent) {
      if (this.targetPointers.length > 0 && this.condition_(mapBrowserEvent)) {
        const map2 = mapBrowserEvent.map;
        const view = map2.getView();
        this.lastCentroid = null;
        if (view.getAnimating()) {
          view.cancelAnimations();
        }
        if (this.kinetic_) {
          this.kinetic_.begin();
        }
        this.noKinetic_ = this.targetPointers.length > 1;
        return true;
      }
      return false;
    }
  }
  const DragPan$1 = DragPan;
  class DragRotate extends PointerInteraction$1 {
    constructor(options) {
      options = options ? options : {};
      super({
        stopDown: FALSE
      });
      this.condition_ = options.condition ? options.condition : altShiftKeysOnly;
      this.lastAngle_ = void 0;
      this.duration_ = options.duration !== void 0 ? options.duration : 250;
    }
    handleDragEvent(mapBrowserEvent) {
      if (!mouseOnly(mapBrowserEvent)) {
        return;
      }
      const map2 = mapBrowserEvent.map;
      const view = map2.getView();
      if (view.getConstraints().rotation === disable) {
        return;
      }
      const size = map2.getSize();
      const offset = mapBrowserEvent.pixel;
      const theta = Math.atan2(size[1] / 2 - offset[1], offset[0] - size[0] / 2);
      if (this.lastAngle_ !== void 0) {
        const delta = theta - this.lastAngle_;
        view.adjustRotationInternal(-delta);
      }
      this.lastAngle_ = theta;
    }
    handleUpEvent(mapBrowserEvent) {
      if (!mouseOnly(mapBrowserEvent)) {
        return true;
      }
      const map2 = mapBrowserEvent.map;
      const view = map2.getView();
      view.endInteraction(this.duration_);
      return false;
    }
    handleDownEvent(mapBrowserEvent) {
      if (!mouseOnly(mapBrowserEvent)) {
        return false;
      }
      if (mouseActionButton(mapBrowserEvent) && this.condition_(mapBrowserEvent)) {
        const map2 = mapBrowserEvent.map;
        map2.getView().beginInteraction();
        this.lastAngle_ = void 0;
        return true;
      }
      return false;
    }
  }
  const DragRotate$1 = DragRotate;
  class RenderBox extends Disposable$1 {
    constructor(className) {
      super();
      this.geometry_ = null;
      this.element_ = document.createElement("div");
      this.element_.style.position = "absolute";
      this.element_.style.pointerEvents = "auto";
      this.element_.className = "ol-box " + className;
      this.map_ = null;
      this.startPixel_ = null;
      this.endPixel_ = null;
    }
    disposeInternal() {
      this.setMap(null);
    }
    render_() {
      const startPixel = this.startPixel_;
      const endPixel = this.endPixel_;
      const px = "px";
      const style = this.element_.style;
      style.left = Math.min(startPixel[0], endPixel[0]) + px;
      style.top = Math.min(startPixel[1], endPixel[1]) + px;
      style.width = Math.abs(endPixel[0] - startPixel[0]) + px;
      style.height = Math.abs(endPixel[1] - startPixel[1]) + px;
    }
    setMap(map2) {
      if (this.map_) {
        this.map_.getOverlayContainer().removeChild(this.element_);
        const style = this.element_.style;
        style.left = "inherit";
        style.top = "inherit";
        style.width = "inherit";
        style.height = "inherit";
      }
      this.map_ = map2;
      if (this.map_) {
        this.map_.getOverlayContainer().appendChild(this.element_);
      }
    }
    setPixels(startPixel, endPixel) {
      this.startPixel_ = startPixel;
      this.endPixel_ = endPixel;
      this.createOrUpdateGeometry();
      this.render_();
    }
    createOrUpdateGeometry() {
      const startPixel = this.startPixel_;
      const endPixel = this.endPixel_;
      const pixels = [
        startPixel,
        [startPixel[0], endPixel[1]],
        endPixel,
        [endPixel[0], startPixel[1]]
      ];
      const coordinates2 = pixels.map(
        this.map_.getCoordinateFromPixelInternal,
        this.map_
      );
      coordinates2[4] = coordinates2[0].slice();
      if (!this.geometry_) {
        this.geometry_ = new Polygon([coordinates2]);
      } else {
        this.geometry_.setCoordinates([coordinates2]);
      }
    }
    getGeometry() {
      return this.geometry_;
    }
  }
  const RenderBox$1 = RenderBox;
  const DragBoxEventType = {
    BOXSTART: "boxstart",
    BOXDRAG: "boxdrag",
    BOXEND: "boxend",
    BOXCANCEL: "boxcancel"
  };
  class DragBoxEvent extends Event {
    constructor(type, coordinate, mapBrowserEvent) {
      super(type);
      this.coordinate = coordinate;
      this.mapBrowserEvent = mapBrowserEvent;
    }
  }
  class DragBox extends PointerInteraction$1 {
    constructor(options) {
      super();
      this.on;
      this.once;
      this.un;
      options = options ? options : {};
      this.box_ = new RenderBox$1(options.className || "ol-dragbox");
      this.minArea_ = options.minArea !== void 0 ? options.minArea : 64;
      if (options.onBoxEnd) {
        this.onBoxEnd = options.onBoxEnd;
      }
      this.startPixel_ = null;
      this.condition_ = options.condition ? options.condition : mouseActionButton;
      this.boxEndCondition_ = options.boxEndCondition ? options.boxEndCondition : this.defaultBoxEndCondition;
    }
    defaultBoxEndCondition(mapBrowserEvent, startPixel, endPixel) {
      const width = endPixel[0] - startPixel[0];
      const height = endPixel[1] - startPixel[1];
      return width * width + height * height >= this.minArea_;
    }
    getGeometry() {
      return this.box_.getGeometry();
    }
    handleDragEvent(mapBrowserEvent) {
      this.box_.setPixels(this.startPixel_, mapBrowserEvent.pixel);
      this.dispatchEvent(
        new DragBoxEvent(
          DragBoxEventType.BOXDRAG,
          mapBrowserEvent.coordinate,
          mapBrowserEvent
        )
      );
    }
    handleUpEvent(mapBrowserEvent) {
      this.box_.setMap(null);
      const completeBox = this.boxEndCondition_(
        mapBrowserEvent,
        this.startPixel_,
        mapBrowserEvent.pixel
      );
      if (completeBox) {
        this.onBoxEnd(mapBrowserEvent);
      }
      this.dispatchEvent(
        new DragBoxEvent(
          completeBox ? DragBoxEventType.BOXEND : DragBoxEventType.BOXCANCEL,
          mapBrowserEvent.coordinate,
          mapBrowserEvent
        )
      );
      return false;
    }
    handleDownEvent(mapBrowserEvent) {
      if (this.condition_(mapBrowserEvent)) {
        this.startPixel_ = mapBrowserEvent.pixel;
        this.box_.setMap(mapBrowserEvent.map);
        this.box_.setPixels(this.startPixel_, this.startPixel_);
        this.dispatchEvent(
          new DragBoxEvent(
            DragBoxEventType.BOXSTART,
            mapBrowserEvent.coordinate,
            mapBrowserEvent
          )
        );
        return true;
      }
      return false;
    }
    onBoxEnd(event) {
    }
  }
  const DragBox$1 = DragBox;
  class DragZoom extends DragBox$1 {
    constructor(options) {
      options = options ? options : {};
      const condition = options.condition ? options.condition : shiftKeyOnly;
      super({
        condition,
        className: options.className || "ol-dragzoom",
        minArea: options.minArea
      });
      this.duration_ = options.duration !== void 0 ? options.duration : 200;
      this.out_ = options.out !== void 0 ? options.out : false;
    }
    onBoxEnd(event) {
      const map2 = this.getMap();
      const view = map2.getView();
      let geometry = this.getGeometry();
      if (this.out_) {
        const rotatedExtent = view.rotatedExtentForGeometry(geometry);
        const resolution = view.getResolutionForExtentInternal(rotatedExtent);
        const factor = view.getResolution() / resolution;
        geometry = geometry.clone();
        geometry.scale(factor * factor);
      }
      view.fitInternal(geometry, {
        duration: this.duration_,
        easing: easeOut
      });
    }
  }
  const DragZoom$1 = DragZoom;
  const KeyCode = {
    LEFT: 37,
    UP: 38,
    RIGHT: 39,
    DOWN: 40
  };
  class KeyboardPan extends Interaction$1 {
    constructor(options) {
      super();
      options = options || {};
      this.defaultCondition_ = function(mapBrowserEvent) {
        return noModifierKeys(mapBrowserEvent) && targetNotEditable(mapBrowserEvent);
      };
      this.condition_ = options.condition !== void 0 ? options.condition : this.defaultCondition_;
      this.duration_ = options.duration !== void 0 ? options.duration : 100;
      this.pixelDelta_ = options.pixelDelta !== void 0 ? options.pixelDelta : 128;
    }
    handleEvent(mapBrowserEvent) {
      let stopEvent = false;
      if (mapBrowserEvent.type == EventType.KEYDOWN) {
        const keyEvent = mapBrowserEvent.originalEvent;
        const keyCode = keyEvent.keyCode;
        if (this.condition_(mapBrowserEvent) && (keyCode == KeyCode.DOWN || keyCode == KeyCode.LEFT || keyCode == KeyCode.RIGHT || keyCode == KeyCode.UP)) {
          const map2 = mapBrowserEvent.map;
          const view = map2.getView();
          const mapUnitsDelta = view.getResolution() * this.pixelDelta_;
          let deltaX = 0, deltaY = 0;
          if (keyCode == KeyCode.DOWN) {
            deltaY = -mapUnitsDelta;
          } else if (keyCode == KeyCode.LEFT) {
            deltaX = -mapUnitsDelta;
          } else if (keyCode == KeyCode.RIGHT) {
            deltaX = mapUnitsDelta;
          } else {
            deltaY = mapUnitsDelta;
          }
          const delta = [deltaX, deltaY];
          rotate$1(delta, view.getRotation());
          pan(view, delta, this.duration_);
          keyEvent.preventDefault();
          stopEvent = true;
        }
      }
      return !stopEvent;
    }
  }
  const KeyboardPan$1 = KeyboardPan;
  class KeyboardZoom extends Interaction$1 {
    constructor(options) {
      super();
      options = options ? options : {};
      this.condition_ = options.condition ? options.condition : targetNotEditable;
      this.delta_ = options.delta ? options.delta : 1;
      this.duration_ = options.duration !== void 0 ? options.duration : 100;
    }
    handleEvent(mapBrowserEvent) {
      let stopEvent = false;
      if (mapBrowserEvent.type == EventType.KEYDOWN || mapBrowserEvent.type == EventType.KEYPRESS) {
        const keyEvent = mapBrowserEvent.originalEvent;
        const key = keyEvent.key;
        if (this.condition_(mapBrowserEvent) && (key === "+" || key === "-")) {
          const map2 = mapBrowserEvent.map;
          const delta = key === "+" ? this.delta_ : -this.delta_;
          const view = map2.getView();
          zoomByDelta(view, delta, void 0, this.duration_);
          keyEvent.preventDefault();
          stopEvent = true;
        }
      }
      return !stopEvent;
    }
  }
  const KeyboardZoom$1 = KeyboardZoom;
  class Kinetic {
    constructor(decay, minVelocity, delay) {
      this.decay_ = decay;
      this.minVelocity_ = minVelocity;
      this.delay_ = delay;
      this.points_ = [];
      this.angle_ = 0;
      this.initialVelocity_ = 0;
    }
    begin() {
      this.points_.length = 0;
      this.angle_ = 0;
      this.initialVelocity_ = 0;
    }
    update(x, y2) {
      this.points_.push(x, y2, Date.now());
    }
    end() {
      if (this.points_.length < 6) {
        return false;
      }
      const delay = Date.now() - this.delay_;
      const lastIndex = this.points_.length - 3;
      if (this.points_[lastIndex + 2] < delay) {
        return false;
      }
      let firstIndex = lastIndex - 3;
      while (firstIndex > 0 && this.points_[firstIndex + 2] > delay) {
        firstIndex -= 3;
      }
      const duration = this.points_[lastIndex + 2] - this.points_[firstIndex + 2];
      if (duration < 1e3 / 60) {
        return false;
      }
      const dx = this.points_[lastIndex] - this.points_[firstIndex];
      const dy = this.points_[lastIndex + 1] - this.points_[firstIndex + 1];
      this.angle_ = Math.atan2(dy, dx);
      this.initialVelocity_ = Math.sqrt(dx * dx + dy * dy) / duration;
      return this.initialVelocity_ > this.minVelocity_;
    }
    getDistance() {
      return (this.minVelocity_ - this.initialVelocity_) / this.decay_;
    }
    getAngle() {
      return this.angle_;
    }
  }
  const Kinetic$1 = Kinetic;
  class MouseWheelZoom extends Interaction$1 {
    constructor(options) {
      options = options ? options : {};
      super(
        options
      );
      this.totalDelta_ = 0;
      this.lastDelta_ = 0;
      this.maxDelta_ = options.maxDelta !== void 0 ? options.maxDelta : 1;
      this.duration_ = options.duration !== void 0 ? options.duration : 250;
      this.timeout_ = options.timeout !== void 0 ? options.timeout : 80;
      this.useAnchor_ = options.useAnchor !== void 0 ? options.useAnchor : true;
      this.constrainResolution_ = options.constrainResolution !== void 0 ? options.constrainResolution : false;
      const condition = options.condition ? options.condition : always;
      this.condition_ = options.onFocusOnly ? all(focusWithTabindex, condition) : condition;
      this.lastAnchor_ = null;
      this.startTime_ = void 0;
      this.timeoutId_;
      this.mode_ = void 0;
      this.trackpadEventGap_ = 400;
      this.trackpadTimeoutId_;
      this.deltaPerZoom_ = 300;
    }
    endInteraction_() {
      this.trackpadTimeoutId_ = void 0;
      const map2 = this.getMap();
      if (!map2) {
        return;
      }
      const view = map2.getView();
      view.endInteraction(
        void 0,
        this.lastDelta_ ? this.lastDelta_ > 0 ? 1 : -1 : 0,
        this.lastAnchor_
      );
    }
    handleEvent(mapBrowserEvent) {
      if (!this.condition_(mapBrowserEvent)) {
        return true;
      }
      const type = mapBrowserEvent.type;
      if (type !== EventType.WHEEL) {
        return true;
      }
      const map2 = mapBrowserEvent.map;
      const wheelEvent = mapBrowserEvent.originalEvent;
      wheelEvent.preventDefault();
      if (this.useAnchor_) {
        this.lastAnchor_ = mapBrowserEvent.coordinate;
      }
      let delta;
      if (mapBrowserEvent.type == EventType.WHEEL) {
        delta = wheelEvent.deltaY;
        if (FIREFOX && wheelEvent.deltaMode === WheelEvent.DOM_DELTA_PIXEL) {
          delta /= DEVICE_PIXEL_RATIO;
        }
        if (wheelEvent.deltaMode === WheelEvent.DOM_DELTA_LINE) {
          delta *= 40;
        }
      }
      if (delta === 0) {
        return false;
      }
      this.lastDelta_ = delta;
      const now2 = Date.now();
      if (this.startTime_ === void 0) {
        this.startTime_ = now2;
      }
      if (!this.mode_ || now2 - this.startTime_ > this.trackpadEventGap_) {
        this.mode_ = Math.abs(delta) < 4 ? "trackpad" : "wheel";
      }
      const view = map2.getView();
      if (this.mode_ === "trackpad" && !(view.getConstrainResolution() || this.constrainResolution_)) {
        if (this.trackpadTimeoutId_) {
          clearTimeout(this.trackpadTimeoutId_);
        } else {
          if (view.getAnimating()) {
            view.cancelAnimations();
          }
          view.beginInteraction();
        }
        this.trackpadTimeoutId_ = setTimeout(
          this.endInteraction_.bind(this),
          this.timeout_
        );
        view.adjustZoom(-delta / this.deltaPerZoom_, this.lastAnchor_);
        this.startTime_ = now2;
        return false;
      }
      this.totalDelta_ += delta;
      const timeLeft = Math.max(this.timeout_ - (now2 - this.startTime_), 0);
      clearTimeout(this.timeoutId_);
      this.timeoutId_ = setTimeout(
        this.handleWheelZoom_.bind(this, map2),
        timeLeft
      );
      return false;
    }
    handleWheelZoom_(map2) {
      const view = map2.getView();
      if (view.getAnimating()) {
        view.cancelAnimations();
      }
      let delta = -clamp(
        this.totalDelta_,
        -this.maxDelta_ * this.deltaPerZoom_,
        this.maxDelta_ * this.deltaPerZoom_
      ) / this.deltaPerZoom_;
      if (view.getConstrainResolution() || this.constrainResolution_) {
        delta = delta ? delta > 0 ? 1 : -1 : 0;
      }
      zoomByDelta(view, delta, this.lastAnchor_, this.duration_);
      this.mode_ = void 0;
      this.totalDelta_ = 0;
      this.lastAnchor_ = null;
      this.startTime_ = void 0;
      this.timeoutId_ = void 0;
    }
    setMouseAnchor(useAnchor) {
      this.useAnchor_ = useAnchor;
      if (!useAnchor) {
        this.lastAnchor_ = null;
      }
    }
  }
  const MouseWheelZoom$1 = MouseWheelZoom;
  class PinchRotate extends PointerInteraction$1 {
    constructor(options) {
      options = options ? options : {};
      const pointerOptions = options;
      if (!pointerOptions.stopDown) {
        pointerOptions.stopDown = FALSE;
      }
      super(pointerOptions);
      this.anchor_ = null;
      this.lastAngle_ = void 0;
      this.rotating_ = false;
      this.rotationDelta_ = 0;
      this.threshold_ = options.threshold !== void 0 ? options.threshold : 0.3;
      this.duration_ = options.duration !== void 0 ? options.duration : 250;
    }
    handleDragEvent(mapBrowserEvent) {
      let rotationDelta = 0;
      const touch0 = this.targetPointers[0];
      const touch1 = this.targetPointers[1];
      const angle = Math.atan2(
        touch1.clientY - touch0.clientY,
        touch1.clientX - touch0.clientX
      );
      if (this.lastAngle_ !== void 0) {
        const delta = angle - this.lastAngle_;
        this.rotationDelta_ += delta;
        if (!this.rotating_ && Math.abs(this.rotationDelta_) > this.threshold_) {
          this.rotating_ = true;
        }
        rotationDelta = delta;
      }
      this.lastAngle_ = angle;
      const map2 = mapBrowserEvent.map;
      const view = map2.getView();
      if (view.getConstraints().rotation === disable) {
        return;
      }
      this.anchor_ = map2.getCoordinateFromPixelInternal(
        map2.getEventPixel(centroid(this.targetPointers))
      );
      if (this.rotating_) {
        map2.render();
        view.adjustRotationInternal(rotationDelta, this.anchor_);
      }
    }
    handleUpEvent(mapBrowserEvent) {
      if (this.targetPointers.length < 2) {
        const map2 = mapBrowserEvent.map;
        const view = map2.getView();
        view.endInteraction(this.duration_);
        return false;
      }
      return true;
    }
    handleDownEvent(mapBrowserEvent) {
      if (this.targetPointers.length >= 2) {
        const map2 = mapBrowserEvent.map;
        this.anchor_ = null;
        this.lastAngle_ = void 0;
        this.rotating_ = false;
        this.rotationDelta_ = 0;
        if (!this.handlingDownUpSequence) {
          map2.getView().beginInteraction();
        }
        return true;
      }
      return false;
    }
  }
  const PinchRotate$1 = PinchRotate;
  class PinchZoom extends PointerInteraction$1 {
    constructor(options) {
      options = options ? options : {};
      const pointerOptions = options;
      if (!pointerOptions.stopDown) {
        pointerOptions.stopDown = FALSE;
      }
      super(pointerOptions);
      this.anchor_ = null;
      this.duration_ = options.duration !== void 0 ? options.duration : 400;
      this.lastDistance_ = void 0;
      this.lastScaleDelta_ = 1;
    }
    handleDragEvent(mapBrowserEvent) {
      let scaleDelta = 1;
      const touch0 = this.targetPointers[0];
      const touch1 = this.targetPointers[1];
      const dx = touch0.clientX - touch1.clientX;
      const dy = touch0.clientY - touch1.clientY;
      const distance = Math.sqrt(dx * dx + dy * dy);
      if (this.lastDistance_ !== void 0) {
        scaleDelta = this.lastDistance_ / distance;
      }
      this.lastDistance_ = distance;
      const map2 = mapBrowserEvent.map;
      const view = map2.getView();
      if (scaleDelta != 1) {
        this.lastScaleDelta_ = scaleDelta;
      }
      this.anchor_ = map2.getCoordinateFromPixelInternal(
        map2.getEventPixel(centroid(this.targetPointers))
      );
      map2.render();
      view.adjustResolutionInternal(scaleDelta, this.anchor_);
    }
    handleUpEvent(mapBrowserEvent) {
      if (this.targetPointers.length < 2) {
        const map2 = mapBrowserEvent.map;
        const view = map2.getView();
        const direction = this.lastScaleDelta_ > 1 ? 1 : -1;
        view.endInteraction(this.duration_, direction);
        return false;
      }
      return true;
    }
    handleDownEvent(mapBrowserEvent) {
      if (this.targetPointers.length >= 2) {
        const map2 = mapBrowserEvent.map;
        this.anchor_ = null;
        this.lastDistance_ = void 0;
        this.lastScaleDelta_ = 1;
        if (!this.handlingDownUpSequence) {
          map2.getView().beginInteraction();
        }
        return true;
      }
      return false;
    }
  }
  const PinchZoom$1 = PinchZoom;
  function defaults(options) {
    options = options ? options : {};
    const interactions = new Collection$1();
    const kinetic = new Kinetic$1(-5e-3, 0.05, 100);
    const altShiftDragRotate = options.altShiftDragRotate !== void 0 ? options.altShiftDragRotate : true;
    if (altShiftDragRotate) {
      interactions.push(new DragRotate$1());
    }
    const doubleClickZoom = options.doubleClickZoom !== void 0 ? options.doubleClickZoom : true;
    if (doubleClickZoom) {
      interactions.push(
        new DoubleClickZoom$1({
          delta: options.zoomDelta,
          duration: options.zoomDuration
        })
      );
    }
    const dragPan = options.dragPan !== void 0 ? options.dragPan : true;
    if (dragPan) {
      interactions.push(
        new DragPan$1({
          onFocusOnly: options.onFocusOnly,
          kinetic
        })
      );
    }
    const pinchRotate = options.pinchRotate !== void 0 ? options.pinchRotate : true;
    if (pinchRotate) {
      interactions.push(new PinchRotate$1());
    }
    const pinchZoom = options.pinchZoom !== void 0 ? options.pinchZoom : true;
    if (pinchZoom) {
      interactions.push(
        new PinchZoom$1({
          duration: options.zoomDuration
        })
      );
    }
    const keyboard = options.keyboard !== void 0 ? options.keyboard : true;
    if (keyboard) {
      interactions.push(new KeyboardPan$1());
      interactions.push(
        new KeyboardZoom$1({
          delta: options.zoomDelta,
          duration: options.zoomDuration
        })
      );
    }
    const mouseWheelZoom = options.mouseWheelZoom !== void 0 ? options.mouseWheelZoom : true;
    if (mouseWheelZoom) {
      interactions.push(
        new MouseWheelZoom$1({
          onFocusOnly: options.onFocusOnly,
          duration: options.zoomDuration
        })
      );
    }
    const shiftDragZoom = options.shiftDragZoom !== void 0 ? options.shiftDragZoom : true;
    if (shiftDragZoom) {
      interactions.push(
        new DragZoom$1({
          duration: options.zoomDuration
        })
      );
    }
    return interactions;
  }
  function removeLayerMapProperty(layer) {
    if (layer instanceof Layer$1) {
      layer.setMapInternal(null);
      return;
    }
    if (layer instanceof LayerGroup$1) {
      layer.getLayers().forEach(removeLayerMapProperty);
    }
  }
  function setLayerMapProperty(layer, map2) {
    if (layer instanceof Layer$1) {
      layer.setMapInternal(map2);
      return;
    }
    if (layer instanceof LayerGroup$1) {
      const layers = layer.getLayers().getArray();
      for (let i = 0, ii = layers.length; i < ii; ++i) {
        setLayerMapProperty(layers[i], map2);
      }
    }
  }
  class Map$1 extends BaseObject$1 {
    constructor(options) {
      super();
      options = options || {};
      this.on;
      this.once;
      this.un;
      const optionsInternal = createOptionsInternal(options);
      this.renderComplete_;
      this.loaded_ = true;
      this.boundHandleBrowserEvent_ = this.handleBrowserEvent.bind(this);
      this.maxTilesLoading_ = options.maxTilesLoading !== void 0 ? options.maxTilesLoading : 16;
      this.pixelRatio_ = options.pixelRatio !== void 0 ? options.pixelRatio : DEVICE_PIXEL_RATIO;
      this.postRenderTimeoutHandle_;
      this.animationDelayKey_;
      this.animationDelay_ = this.animationDelay_.bind(this);
      this.coordinateToPixelTransform_ = create();
      this.pixelToCoordinateTransform_ = create();
      this.frameIndex_ = 0;
      this.frameState_ = null;
      this.previousExtent_ = null;
      this.viewPropertyListenerKey_ = null;
      this.viewChangeListenerKey_ = null;
      this.layerGroupPropertyListenerKeys_ = null;
      this.viewport_ = document.createElement("div");
      this.viewport_.className = "ol-viewport" + ("ontouchstart" in window ? " ol-touch" : "");
      this.viewport_.style.position = "relative";
      this.viewport_.style.overflow = "hidden";
      this.viewport_.style.width = "100%";
      this.viewport_.style.height = "100%";
      this.overlayContainer_ = document.createElement("div");
      this.overlayContainer_.style.position = "absolute";
      this.overlayContainer_.style.zIndex = "0";
      this.overlayContainer_.style.width = "100%";
      this.overlayContainer_.style.height = "100%";
      this.overlayContainer_.style.pointerEvents = "none";
      this.overlayContainer_.className = "ol-overlaycontainer";
      this.viewport_.appendChild(this.overlayContainer_);
      this.overlayContainerStopEvent_ = document.createElement("div");
      this.overlayContainerStopEvent_.style.position = "absolute";
      this.overlayContainerStopEvent_.style.zIndex = "0";
      this.overlayContainerStopEvent_.style.width = "100%";
      this.overlayContainerStopEvent_.style.height = "100%";
      this.overlayContainerStopEvent_.style.pointerEvents = "none";
      this.overlayContainerStopEvent_.className = "ol-overlaycontainer-stopevent";
      this.viewport_.appendChild(this.overlayContainerStopEvent_);
      this.mapBrowserEventHandler_ = null;
      this.moveTolerance_ = options.moveTolerance;
      this.keyboardEventTarget_ = optionsInternal.keyboardEventTarget;
      this.targetChangeHandlerKeys_ = null;
      this.targetElement_ = null;
      this.resizeObserver_ = new ResizeObserver(() => this.updateSize());
      this.controls = optionsInternal.controls || defaults$1();
      this.interactions = optionsInternal.interactions || defaults({
        onFocusOnly: true
      });
      this.overlays_ = optionsInternal.overlays;
      this.overlayIdIndex_ = {};
      this.renderer_ = null;
      this.postRenderFunctions_ = [];
      this.tileQueue_ = new TileQueue$1(
        this.getTilePriority.bind(this),
        this.handleTileChange_.bind(this)
      );
      this.addChangeListener(
        MapProperty.LAYERGROUP,
        this.handleLayerGroupChanged_
      );
      this.addChangeListener(MapProperty.VIEW, this.handleViewChanged_);
      this.addChangeListener(MapProperty.SIZE, this.handleSizeChanged_);
      this.addChangeListener(MapProperty.TARGET, this.handleTargetChanged_);
      this.setProperties(optionsInternal.values);
      const map2 = this;
      if (options.view && !(options.view instanceof OlView)) {
        options.view.then(function(viewOptions) {
          map2.setView(new OlView(viewOptions));
        });
      }
      this.controls.addEventListener(
        CollectionEventType.ADD,
        (event) => {
          event.element.setMap(this);
        }
      );
      this.controls.addEventListener(
        CollectionEventType.REMOVE,
        (event) => {
          event.element.setMap(null);
        }
      );
      this.interactions.addEventListener(
        CollectionEventType.ADD,
        (event) => {
          event.element.setMap(this);
        }
      );
      this.interactions.addEventListener(
        CollectionEventType.REMOVE,
        (event) => {
          event.element.setMap(null);
        }
      );
      this.overlays_.addEventListener(
        CollectionEventType.ADD,
        (event) => {
          this.addOverlayInternal_(event.element);
        }
      );
      this.overlays_.addEventListener(
        CollectionEventType.REMOVE,
        (event) => {
          const id = event.element.getId();
          if (id !== void 0) {
            delete this.overlayIdIndex_[id.toString()];
          }
          event.element.setMap(null);
        }
      );
      this.controls.forEach(
        (control) => {
          control.setMap(this);
        }
      );
      this.interactions.forEach(
        (interaction) => {
          interaction.setMap(this);
        }
      );
      this.overlays_.forEach(this.addOverlayInternal_.bind(this));
    }
    addControl(control) {
      this.getControls().push(control);
    }
    addInteraction(interaction) {
      this.getInteractions().push(interaction);
    }
    addLayer(layer) {
      const layers = this.getLayerGroup().getLayers();
      layers.push(layer);
    }
    handleLayerAdd_(event) {
      setLayerMapProperty(event.layer, this);
    }
    addOverlay(overlay) {
      this.getOverlays().push(overlay);
    }
    addOverlayInternal_(overlay) {
      const id = overlay.getId();
      if (id !== void 0) {
        this.overlayIdIndex_[id.toString()] = overlay;
      }
      overlay.setMap(this);
    }
    disposeInternal() {
      this.controls.clear();
      this.interactions.clear();
      this.overlays_.clear();
      this.resizeObserver_.disconnect();
      this.setTarget(null);
      super.disposeInternal();
    }
    forEachFeatureAtPixel(pixel, callback, options) {
      if (!this.frameState_ || !this.renderer_) {
        return;
      }
      const coordinate = this.getCoordinateFromPixelInternal(pixel);
      options = options !== void 0 ? options : {};
      const hitTolerance = options.hitTolerance !== void 0 ? options.hitTolerance : 0;
      const layerFilter = options.layerFilter !== void 0 ? options.layerFilter : TRUE;
      const checkWrapped = options.checkWrapped !== false;
      return this.renderer_.forEachFeatureAtCoordinate(
        coordinate,
        this.frameState_,
        hitTolerance,
        checkWrapped,
        callback,
        null,
        layerFilter,
        null
      );
    }
    getFeaturesAtPixel(pixel, options) {
      const features = [];
      this.forEachFeatureAtPixel(
        pixel,
        function(feature) {
          features.push(feature);
        },
        options
      );
      return features;
    }
    getAllLayers() {
      const layers = [];
      function addLayersFrom(layerGroup) {
        layerGroup.forEach(function(layer) {
          if (layer instanceof LayerGroup$1) {
            addLayersFrom(layer.getLayers());
          } else {
            layers.push(layer);
          }
        });
      }
      addLayersFrom(this.getLayers());
      return layers;
    }
    hasFeatureAtPixel(pixel, options) {
      if (!this.frameState_ || !this.renderer_) {
        return false;
      }
      const coordinate = this.getCoordinateFromPixelInternal(pixel);
      options = options !== void 0 ? options : {};
      const layerFilter = options.layerFilter !== void 0 ? options.layerFilter : TRUE;
      const hitTolerance = options.hitTolerance !== void 0 ? options.hitTolerance : 0;
      const checkWrapped = options.checkWrapped !== false;
      return this.renderer_.hasFeatureAtCoordinate(
        coordinate,
        this.frameState_,
        hitTolerance,
        checkWrapped,
        layerFilter,
        null
      );
    }
    getEventCoordinate(event) {
      return this.getCoordinateFromPixel(this.getEventPixel(event));
    }
    getEventCoordinateInternal(event) {
      return this.getCoordinateFromPixelInternal(this.getEventPixel(event));
    }
    getEventPixel(event) {
      const viewport = this.viewport_;
      const viewportPosition = viewport.getBoundingClientRect();
      const viewportSize = this.getSize();
      const scaleX = viewportPosition.width / viewportSize[0];
      const scaleY = viewportPosition.height / viewportSize[1];
      const eventPosition = "changedTouches" in event ? event.changedTouches[0] : event;
      return [
        (eventPosition.clientX - viewportPosition.left) / scaleX,
        (eventPosition.clientY - viewportPosition.top) / scaleY
      ];
    }
    getTarget() {
      return this.get(MapProperty.TARGET);
    }
    getTargetElement() {
      return this.targetElement_;
    }
    getCoordinateFromPixel(pixel) {
      return toUserCoordinate(
        this.getCoordinateFromPixelInternal(pixel),
        this.getView().getProjection()
      );
    }
    getCoordinateFromPixelInternal(pixel) {
      const frameState = this.frameState_;
      if (!frameState) {
        return null;
      }
      return apply(frameState.pixelToCoordinateTransform, pixel.slice());
    }
    getControls() {
      return this.controls;
    }
    getOverlays() {
      return this.overlays_;
    }
    getOverlayById(id) {
      const overlay = this.overlayIdIndex_[id.toString()];
      return overlay !== void 0 ? overlay : null;
    }
    getInteractions() {
      return this.interactions;
    }
    getLayerGroup() {
      return this.get(MapProperty.LAYERGROUP);
    }
    setLayers(layers) {
      const group = this.getLayerGroup();
      if (layers instanceof Collection$1) {
        group.setLayers(layers);
        return;
      }
      const collection = group.getLayers();
      collection.clear();
      collection.extend(layers);
    }
    getLayers() {
      const layers = this.getLayerGroup().getLayers();
      return layers;
    }
    getLoadingOrNotReady() {
      const layerStatesArray = this.getLayerGroup().getLayerStatesArray();
      for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {
        const state = layerStatesArray[i];
        if (!state.visible) {
          continue;
        }
        const renderer = state.layer.getRenderer();
        if (renderer && !renderer.ready) {
          return true;
        }
        const source = state.layer.getSource();
        if (source && source.loading) {
          return true;
        }
      }
      return false;
    }
    getPixelFromCoordinate(coordinate) {
      const viewCoordinate = fromUserCoordinate(
        coordinate,
        this.getView().getProjection()
      );
      return this.getPixelFromCoordinateInternal(viewCoordinate);
    }
    getPixelFromCoordinateInternal(coordinate) {
      const frameState = this.frameState_;
      if (!frameState) {
        return null;
      }
      return apply(
        frameState.coordinateToPixelTransform,
        coordinate.slice(0, 2)
      );
    }
    getRenderer() {
      return this.renderer_;
    }
    getSize() {
      return this.get(MapProperty.SIZE);
    }
    getView() {
      return this.get(MapProperty.VIEW);
    }
    getViewport() {
      return this.viewport_;
    }
    getOverlayContainer() {
      return this.overlayContainer_;
    }
    getOverlayContainerStopEvent() {
      return this.overlayContainerStopEvent_;
    }
    getOwnerDocument() {
      const targetElement = this.getTargetElement();
      return targetElement ? targetElement.ownerDocument : document;
    }
    getTilePriority(tile, tileSourceKey, tileCenter, tileResolution) {
      return getTilePriority(
        this.frameState_,
        tile,
        tileSourceKey,
        tileCenter,
        tileResolution
      );
    }
    handleBrowserEvent(browserEvent, type) {
      type = type || browserEvent.type;
      const mapBrowserEvent = new MapBrowserEvent$1(type, this, browserEvent);
      this.handleMapBrowserEvent(mapBrowserEvent);
    }
    handleMapBrowserEvent(mapBrowserEvent) {
      if (!this.frameState_) {
        return;
      }
      const originalEvent = mapBrowserEvent.originalEvent;
      const eventType = originalEvent.type;
      if (eventType === PointerEventType.POINTERDOWN || eventType === EventType.WHEEL || eventType === EventType.KEYDOWN) {
        const doc = this.getOwnerDocument();
        const rootNode = this.viewport_.getRootNode ? this.viewport_.getRootNode() : doc;
        const target = originalEvent.target;
        if (this.overlayContainerStopEvent_.contains(target) || !(rootNode === doc ? doc.documentElement : rootNode).contains(target)) {
          return;
        }
      }
      mapBrowserEvent.frameState = this.frameState_;
      if (this.dispatchEvent(mapBrowserEvent) !== false) {
        const interactionsArray = this.getInteractions().getArray().slice();
        for (let i = interactionsArray.length - 1; i >= 0; i--) {
          const interaction = interactionsArray[i];
          if (interaction.getMap() !== this || !interaction.getActive() || !this.getTargetElement()) {
            continue;
          }
          const cont = interaction.handleEvent(mapBrowserEvent);
          if (!cont || mapBrowserEvent.propagationStopped) {
            break;
          }
        }
      }
    }
    handlePostRender() {
      const frameState = this.frameState_;
      const tileQueue = this.tileQueue_;
      if (!tileQueue.isEmpty()) {
        let maxTotalLoading = this.maxTilesLoading_;
        let maxNewLoads = maxTotalLoading;
        if (frameState) {
          const hints = frameState.viewHints;
          if (hints[ViewHint.ANIMATING] || hints[ViewHint.INTERACTING]) {
            const lowOnFrameBudget = Date.now() - frameState.time > 8;
            maxTotalLoading = lowOnFrameBudget ? 0 : 8;
            maxNewLoads = lowOnFrameBudget ? 0 : 2;
          }
        }
        if (tileQueue.getTilesLoading() < maxTotalLoading) {
          tileQueue.reprioritize();
          tileQueue.loadMoreTiles(maxTotalLoading, maxNewLoads);
        }
      }
      if (frameState && this.renderer_ && !frameState.animate) {
        if (this.renderComplete_ === true) {
          if (this.hasListener(RenderEventType.RENDERCOMPLETE)) {
            this.renderer_.dispatchRenderEvent(
              RenderEventType.RENDERCOMPLETE,
              frameState
            );
          }
          if (this.loaded_ === false) {
            this.loaded_ = true;
            this.dispatchEvent(
              new MapEvent$1(MapEventType.LOADEND, this, frameState)
            );
          }
        } else if (this.loaded_ === true) {
          this.loaded_ = false;
          this.dispatchEvent(
            new MapEvent$1(MapEventType.LOADSTART, this, frameState)
          );
        }
      }
      const postRenderFunctions = this.postRenderFunctions_;
      for (let i = 0, ii = postRenderFunctions.length; i < ii; ++i) {
        postRenderFunctions[i](this, frameState);
      }
      postRenderFunctions.length = 0;
    }
    handleSizeChanged_() {
      if (this.getView() && !this.getView().getAnimating()) {
        this.getView().resolveConstraints(0);
      }
      this.render();
    }
    handleTargetChanged_() {
      if (this.mapBrowserEventHandler_) {
        for (let i = 0, ii = this.targetChangeHandlerKeys_.length; i < ii; ++i) {
          unlistenByKey(this.targetChangeHandlerKeys_[i]);
        }
        this.targetChangeHandlerKeys_ = null;
        this.viewport_.removeEventListener(
          EventType.CONTEXTMENU,
          this.boundHandleBrowserEvent_
        );
        this.viewport_.removeEventListener(
          EventType.WHEEL,
          this.boundHandleBrowserEvent_
        );
        this.mapBrowserEventHandler_.dispose();
        this.mapBrowserEventHandler_ = null;
        removeNode(this.viewport_);
      }
      if (this.targetElement_) {
        this.resizeObserver_.unobserve(this.targetElement_);
        const rootNode = this.targetElement_.getRootNode();
        if (rootNode instanceof ShadowRoot) {
          this.resizeObserver_.unobserve(rootNode.host);
        }
      }
      const target = this.getTarget();
      const targetElement = typeof target === "string" ? document.getElementById(target) : target;
      this.targetElement_ = targetElement;
      if (!targetElement) {
        if (this.renderer_) {
          clearTimeout(this.postRenderTimeoutHandle_);
          this.postRenderTimeoutHandle_ = void 0;
          this.postRenderFunctions_.length = 0;
          this.renderer_.dispose();
          this.renderer_ = null;
        }
        if (this.animationDelayKey_) {
          cancelAnimationFrame(this.animationDelayKey_);
          this.animationDelayKey_ = void 0;
        }
      } else {
        targetElement.appendChild(this.viewport_);
        if (!this.renderer_) {
          this.renderer_ = new CompositeMapRenderer$1(this);
        }
        this.mapBrowserEventHandler_ = new MapBrowserEventHandler$1(
          this,
          this.moveTolerance_
        );
        for (const key in MapBrowserEventType) {
          this.mapBrowserEventHandler_.addEventListener(
            MapBrowserEventType[key],
            this.handleMapBrowserEvent.bind(this)
          );
        }
        this.viewport_.addEventListener(
          EventType.CONTEXTMENU,
          this.boundHandleBrowserEvent_,
          false
        );
        this.viewport_.addEventListener(
          EventType.WHEEL,
          this.boundHandleBrowserEvent_,
          PASSIVE_EVENT_LISTENERS ? { passive: false } : false
        );
        const keyboardEventTarget = !this.keyboardEventTarget_ ? targetElement : this.keyboardEventTarget_;
        this.targetChangeHandlerKeys_ = [
          listen(
            keyboardEventTarget,
            EventType.KEYDOWN,
            this.handleBrowserEvent,
            this
          ),
          listen(
            keyboardEventTarget,
            EventType.KEYPRESS,
            this.handleBrowserEvent,
            this
          )
        ];
        const rootNode = targetElement.getRootNode();
        if (rootNode instanceof ShadowRoot) {
          this.resizeObserver_.observe(rootNode.host);
        }
        this.resizeObserver_.observe(targetElement);
      }
      this.updateSize();
    }
    handleTileChange_() {
      this.render();
    }
    handleViewPropertyChanged_() {
      this.render();
    }
    handleViewChanged_() {
      if (this.viewPropertyListenerKey_) {
        unlistenByKey(this.viewPropertyListenerKey_);
        this.viewPropertyListenerKey_ = null;
      }
      if (this.viewChangeListenerKey_) {
        unlistenByKey(this.viewChangeListenerKey_);
        this.viewChangeListenerKey_ = null;
      }
      const view = this.getView();
      if (view) {
        this.updateViewportSize_();
        this.viewPropertyListenerKey_ = listen(
          view,
          ObjectEventType.PROPERTYCHANGE,
          this.handleViewPropertyChanged_,
          this
        );
        this.viewChangeListenerKey_ = listen(
          view,
          EventType.CHANGE,
          this.handleViewPropertyChanged_,
          this
        );
        view.resolveConstraints(0);
      }
      this.render();
    }
    handleLayerGroupChanged_() {
      if (this.layerGroupPropertyListenerKeys_) {
        this.layerGroupPropertyListenerKeys_.forEach(unlistenByKey);
        this.layerGroupPropertyListenerKeys_ = null;
      }
      const layerGroup = this.getLayerGroup();
      if (layerGroup) {
        this.handleLayerAdd_(new GroupEvent("addlayer", layerGroup));
        this.layerGroupPropertyListenerKeys_ = [
          listen(layerGroup, ObjectEventType.PROPERTYCHANGE, this.render, this),
          listen(layerGroup, EventType.CHANGE, this.render, this),
          listen(layerGroup, "addlayer", this.handleLayerAdd_, this),
          listen(layerGroup, "removelayer", this.handleLayerRemove_, this)
        ];
      }
      this.render();
    }
    isRendered() {
      return !!this.frameState_;
    }
    animationDelay_() {
      this.animationDelayKey_ = void 0;
      this.renderFrame_(Date.now());
    }
    renderSync() {
      if (this.animationDelayKey_) {
        cancelAnimationFrame(this.animationDelayKey_);
      }
      this.animationDelay_();
    }
    redrawText() {
      const layerStates = this.getLayerGroup().getLayerStatesArray();
      for (let i = 0, ii = layerStates.length; i < ii; ++i) {
        const layer = layerStates[i].layer;
        if (layer.hasRenderer()) {
          layer.getRenderer().handleFontsChanged();
        }
      }
    }
    render() {
      if (this.renderer_ && this.animationDelayKey_ === void 0) {
        this.animationDelayKey_ = requestAnimationFrame(this.animationDelay_);
      }
    }
    removeControl(control) {
      return this.getControls().remove(control);
    }
    removeInteraction(interaction) {
      return this.getInteractions().remove(interaction);
    }
    removeLayer(layer) {
      const layers = this.getLayerGroup().getLayers();
      return layers.remove(layer);
    }
    handleLayerRemove_(event) {
      removeLayerMapProperty(event.layer);
    }
    removeOverlay(overlay) {
      return this.getOverlays().remove(overlay);
    }
    renderFrame_(time) {
      const size = this.getSize();
      const view = this.getView();
      const previousFrameState = this.frameState_;
      let frameState = null;
      if (size !== void 0 && hasArea(size) && view && view.isDef()) {
        const viewHints = view.getHints(
          this.frameState_ ? this.frameState_.viewHints : void 0
        );
        const viewState = view.getState();
        frameState = {
          animate: false,
          coordinateToPixelTransform: this.coordinateToPixelTransform_,
          declutterTree: null,
          extent: getForViewAndSize(
            viewState.center,
            viewState.resolution,
            viewState.rotation,
            size
          ),
          index: this.frameIndex_++,
          layerIndex: 0,
          layerStatesArray: this.getLayerGroup().getLayerStatesArray(),
          pixelRatio: this.pixelRatio_,
          pixelToCoordinateTransform: this.pixelToCoordinateTransform_,
          postRenderFunctions: [],
          size,
          tileQueue: this.tileQueue_,
          time,
          usedTiles: {},
          viewState,
          viewHints,
          wantedTiles: {},
          mapId: getUid(this),
          renderTargets: {}
        };
        if (viewState.nextCenter && viewState.nextResolution) {
          const rotation = isNaN(viewState.nextRotation) ? viewState.rotation : viewState.nextRotation;
          frameState.nextExtent = getForViewAndSize(
            viewState.nextCenter,
            viewState.nextResolution,
            rotation,
            size
          );
        }
      }
      this.frameState_ = frameState;
      this.renderer_.renderFrame(frameState);
      if (frameState) {
        if (frameState.animate) {
          this.render();
        }
        Array.prototype.push.apply(
          this.postRenderFunctions_,
          frameState.postRenderFunctions
        );
        if (previousFrameState) {
          const moveStart = !this.previousExtent_ || !isEmpty(this.previousExtent_) && !equals$2(frameState.extent, this.previousExtent_);
          if (moveStart) {
            this.dispatchEvent(
              new MapEvent$1(MapEventType.MOVESTART, this, previousFrameState)
            );
            this.previousExtent_ = createOrUpdateEmpty(this.previousExtent_);
          }
        }
        const idle = this.previousExtent_ && !frameState.viewHints[ViewHint.ANIMATING] && !frameState.viewHints[ViewHint.INTERACTING] && !equals$2(frameState.extent, this.previousExtent_);
        if (idle) {
          this.dispatchEvent(
            new MapEvent$1(MapEventType.MOVEEND, this, frameState)
          );
          clone$1(frameState.extent, this.previousExtent_);
        }
      }
      this.dispatchEvent(new MapEvent$1(MapEventType.POSTRENDER, this, frameState));
      this.renderComplete_ = this.hasListener(MapEventType.LOADSTART) || this.hasListener(MapEventType.LOADEND) || this.hasListener(RenderEventType.RENDERCOMPLETE) ? !this.tileQueue_.getTilesLoading() && !this.tileQueue_.getCount() && !this.getLoadingOrNotReady() : void 0;
      if (!this.postRenderTimeoutHandle_) {
        this.postRenderTimeoutHandle_ = setTimeout(() => {
          this.postRenderTimeoutHandle_ = void 0;
          this.handlePostRender();
        }, 0);
      }
    }
    setLayerGroup(layerGroup) {
      const oldLayerGroup = this.getLayerGroup();
      if (oldLayerGroup) {
        this.handleLayerRemove_(new GroupEvent("removelayer", oldLayerGroup));
      }
      this.set(MapProperty.LAYERGROUP, layerGroup);
    }
    setSize(size) {
      this.set(MapProperty.SIZE, size);
    }
    setTarget(target) {
      this.set(MapProperty.TARGET, target);
    }
    setView(view) {
      if (!view || view instanceof OlView) {
        this.set(MapProperty.VIEW, view);
        return;
      }
      this.set(MapProperty.VIEW, new OlView());
      const map2 = this;
      view.then(function(viewOptions) {
        map2.setView(new OlView(viewOptions));
      });
    }
    updateSize() {
      const targetElement = this.getTargetElement();
      let size = void 0;
      if (targetElement) {
        const computedStyle = getComputedStyle(targetElement);
        const width = targetElement.offsetWidth - parseFloat(computedStyle["borderLeftWidth"]) - parseFloat(computedStyle["paddingLeft"]) - parseFloat(computedStyle["paddingRight"]) - parseFloat(computedStyle["borderRightWidth"]);
        const height = targetElement.offsetHeight - parseFloat(computedStyle["borderTopWidth"]) - parseFloat(computedStyle["paddingTop"]) - parseFloat(computedStyle["paddingBottom"]) - parseFloat(computedStyle["borderBottomWidth"]);
        if (!isNaN(width) && !isNaN(height)) {
          size = [width, height];
          if (!hasArea(size) && !!(targetElement.offsetWidth || targetElement.offsetHeight || targetElement.getClientRects().length)) {
            warn(
              "No map visible because the map container's width or height are 0."
            );
          }
        }
      }
      const oldSize = this.getSize();
      if (size && (!oldSize || !equals(size, oldSize))) {
        this.setSize(size);
        this.updateViewportSize_();
      }
    }
    updateViewportSize_() {
      const view = this.getView();
      if (view) {
        let size = void 0;
        const computedStyle = getComputedStyle(this.viewport_);
        if (computedStyle.width && computedStyle.height) {
          size = [
            parseInt(computedStyle.width, 10),
            parseInt(computedStyle.height, 10)
          ];
        }
        view.setViewportSize(size);
      }
    }
  }
  function createOptionsInternal(options) {
    let keyboardEventTarget = null;
    if (options.keyboardEventTarget !== void 0) {
      keyboardEventTarget = typeof options.keyboardEventTarget === "string" ? document.getElementById(options.keyboardEventTarget) : options.keyboardEventTarget;
    }
    const values = {};
    const layerGroup = options.layers && typeof options.layers.getLayers === "function" ? options.layers : new LayerGroup$1({
      layers: options.layers
    });
    values[MapProperty.LAYERGROUP] = layerGroup;
    values[MapProperty.TARGET] = options.target;
    values[MapProperty.VIEW] = options.view instanceof OlView ? options.view : new OlView();
    let controls;
    if (options.controls !== void 0) {
      if (Array.isArray(options.controls)) {
        controls = new Collection$1(options.controls.slice());
      } else {
        assert(
          typeof options.controls.getArray === "function",
          47
        );
        controls = options.controls;
      }
    }
    let interactions;
    if (options.interactions !== void 0) {
      if (Array.isArray(options.interactions)) {
        interactions = new Collection$1(options.interactions.slice());
      } else {
        assert(
          typeof options.interactions.getArray === "function",
          48
        );
        interactions = options.interactions;
      }
    }
    let overlays;
    if (options.overlays !== void 0) {
      if (Array.isArray(options.overlays)) {
        overlays = new Collection$1(options.overlays.slice());
      } else {
        assert(
          typeof options.overlays.getArray === "function",
          49
        );
        overlays = options.overlays;
      }
    } else {
      overlays = new Collection$1();
    }
    return {
      controls,
      interactions,
      keyboardEventTarget,
      overlays,
      values
    };
  }
  const OlMap = Map$1;
  const PROJECTION_WEBMERCATOR = "EPSG:3857";
  const PROJECTION_WGS84 = "EPSG:4326";
  const PROJECTION_LUX = "EPSG:2169";
  let map;
  function useMap() {
    function getOlMap() {
      return map;
    }
    function createMap(target) {
      map = new OlMap({
        view: new OlView({
          zoom: 10,
          center: [682439, 6379152],
          multiWorld: true
        }),
        target,
        controls: defaults$1({
          zoom: false,
          rotate: false
        })
      });
    }
    function equalsLayer(layerA, layerB) {
      return layerA === layerB;
    }
    function hasLayer(context, layer) {
      var _a;
      return (_a = context.layers) == null ? void 0 : _a.some((l) => equalsLayer(layer, l));
    }
    function layerHasChanged(oldContext, layer) {
      var _a;
      const oldLayer = (_a = oldContext == null ? void 0 : oldContext.layers) == null ? void 0 : _a.find((l) => l.id === layer.id);
      return oldLayer === layer;
    }
    function contextHasChanged(newContext, oldContext) {
      return !(oldContext === null || !("layers" in newContext) || !("layers" in oldContext) || typeof oldContext.layers === "undefined" || typeof newContext.layers === "undefined" || newContext.layers === oldContext.layers);
    }
    function getAddedLayers(newContext, oldContext) {
      if (!("layers" in newContext) || typeof newContext.layers === "undefined")
        return [];
      if (oldContext === null || !("layers" in oldContext)) {
        return newContext.layers.map((layer, position) => ({ layer, position }));
      }
      if (newContext.layers === oldContext.layers)
        return [];
      return newContext.layers.reduce(
        (addedLayers, layer, i) => hasLayer(oldContext, layer) ? addedLayers : [
          ...addedLayers,
          {
            layer,
            position: i
          }
        ],
        []
      );
    }
    function getRemovedLayers(newContext, oldContext) {
      if (contextHasChanged(newContext, oldContext)) {
        return oldContext.layers.reduce(
          (prev, layer) => hasLayer(newContext, layer) ? prev : [...prev, layer],
          []
        );
      }
      return [];
    }
    function getMutatedLayers(newContext, oldContext) {
      if (contextHasChanged(newContext, oldContext)) {
        return newContext.layers.reduce(
          (prev, layer) => !layerHasChanged(oldContext, layer) ? prev : [...prev, layer],
          []
        );
      }
      return [];
    }
    return {
      getOlMap,
      createMap,
      equalsLayer,
      hasLayer,
      layerHasChanged,
      contextHasChanged,
      getAddedLayers,
      getRemovedLayers,
      getMutatedLayers
    };
  }
  const TILE_GRID_RESOLUTION = [
    156543.033928,
    78271.516964,
    39135.758482,
    19567.879241,
    9783.9396205,
    4891.96981025,
    2445.98490513,
    1222.99245256,
    611.496226281,
    305.748113141,
    152.87405657,
    76.4370282852,
    38.2185141426,
    19.1092570713,
    9.55462853565,
    4.77731426782,
    2.38865713391,
    1.19432856696,
    0.597164283478,
    0.298582141739,
    0.1492910708695,
    0.07464553543475
  ];
  const TILE_MATRIX_IDS = [
    "00",
    "01",
    "02",
    "03",
    "04",
    "05",
    "06",
    "07",
    "08",
    "09",
    "10",
    "11",
    "12",
    "13",
    "14",
    "15",
    "16",
    "17",
    "18",
    "19",
    "20",
    "21"
  ];
  const proxyWmsUrl = "https://map.geoportail.lu/ogcproxywms";
  const remoteProxyWms = "https://map.geoportail.lu/httpsproxy";
  function getOlcsExtent() {
    return transformExtent(
      [5.31, 49.38, 6.64, 50.21],
      PROJECTION_WGS84,
      PROJECTION_WEBMERCATOR
    );
  }
  function createWmsLayer(layer) {
    const { name, layers, imageType, url, id } = layer;
    const olLayer = new ImageLayer$1({
      properties: {
        "olcs.extent": getOlcsExtent(),
        label: name,
        id
      },
      source: new ImageWMS$1({
        url: url || proxyWmsUrl,
        hidpi: isHiDpi(),
        serverType: "mapserver",
        params: {
          FORMAT: imageType,
          LAYERS: layers
        },
        ...url !== void 0 && url !== null || remoteProxyWms ? { crossOrigin: "anonymous" } : {}
      })
    });
    return olLayer;
  }
  function createWmtsLayer(layer) {
    const { name, imageType, id } = layer;
    const hasRetina = getLayerHasRetina(layer);
    const projection = get$2(PROJECTION_WEBMERCATOR);
    const extent = projection.getExtent();
    const olLayer = new TileLayer$1({
      source: new WMTS$1({
        url: getLayerWmtsUrl(layer),
        tilePixelRatio: hasRetina ? 2 : 1,
        layer: name,
        matrixSet: `GLOBAL_WEBMERCATOR_4_V3${hasRetina ? "_HD" : ""}`,
        format: imageType,
        requestEncoding: "REST",
        projection,
        tileGrid: new WmtsTileGrid({
          origin: getTopLeft(extent),
          extent,
          resolutions: TILE_GRID_RESOLUTION,
          matrixIds: TILE_MATRIX_IDS
        }),
        style: "default",
        crossOrigin: "anonymous"
      }),
      properties: {
        "olcs.extent": getOlcsExtent(),
        label: name,
        id
      }
    });
    return olLayer;
  }
  function getLayerWmtsUrl(layer, requestScheme = "https") {
    const imageExt = layer.imageType.split("/")[1];
    const domain = storageHelper.getValue(SP_KEY_IPV6, stringToBoolean) ? "app.geoportail.lu" : "geoportail.lu";
    return `${requestScheme === "https" ? "//wmts{3-4}." : "//wmts{1-2}."}${domain}/mapproxy_4_v3/wmts/{Layer}${getLayerHasRetina(layer) ? "_hd" : ""}/{TileMatrixSet}/{TileMatrix}/{TileCol}/{TileRow}.${imageExt}`;
  }
  function getLayerHasRetina(layer) {
    var _a;
    return !!((_a = layer == null ? void 0 : layer.metadata) == null ? void 0 : _a.hasRetina) && isHiDpi();
  }
  function useOpenLayers() {
    function createLayer(spec) {
      var _a;
      let layer;
      switch (spec.type) {
        case "WMS": {
          layer = createWmsLayer(spec);
          break;
        }
        case "WMTS":
        case "BG WMTS": {
          layer = createWmtsLayer(spec);
          break;
        }
        default:
          throw new Error(`Unrecognized layer type: ${spec.type}`);
      }
      layer.set("metadata", spec.metadata);
      layer.set("queryable_id", spec.id);
      layer.setOpacity(spec.opacity);
      if ((_a = spec.metadata) == null ? void 0 : _a.hasOwnProperty("attribution")) {
        const source = layer.getSource();
        source == null ? void 0 : source.setAttributions(spec.metadata.attribution);
      }
      return layer;
    }
    function addLayer(olMap, layer) {
      const baseLayer = getLayerFromCache(layer);
      olMap.addLayer(baseLayer);
    }
    function removeLayer(olMap, layerId) {
      const layerToRemove = olMap.getLayers().getArray().find((layer) => layer.get("id") === layerId);
      if (layerToRemove) {
        olMap.removeLayer(layerToRemove);
      }
    }
    function reorderLayers(olMap, layers) {
      const arrayLayers = olMap.getLayers().getArray();
      layers.forEach((layer, idx) => {
        const baseLayer = arrayLayers.find(
          (mapLayer) => mapLayer.get("id") === layer.id
        );
        baseLayer == null ? void 0 : baseLayer.setZIndex(idx + 1);
      });
    }
    function setLayerOpacity(olMap, layerId, opacity) {
      const layer = olMap.getLayers().getArray().find((layer2) => layer2.get("id") === layerId);
      if (layer)
        layer.setOpacity(opacity);
    }
    function removeFromCache(id) {
      layersCache.delete(id);
    }
    function isLayerCached(layer) {
      return layersCache.has(layer.id);
    }
    function addLayerToCache(id, layer) {
      layersCache.set(id, layer);
    }
    function getLayerFromCache(layer) {
      const id = layer.id;
      const cachedLayer = layersCache.get(id);
      if (cachedLayer) {
        return cachedLayer;
      } else {
        const newLayer = createLayer(layer);
        addLayerToCache(id, newLayer);
        return newLayer;
      }
    }
    function applyOnBgLayer(olMap, callbackFunction) {
      const mapLayers = olMap.getLayers();
      const bgLayer = mapLayers.getArray().find((layer) => layer.getZIndex() === -1);
      if (bgLayer)
        callbackFunction(bgLayer);
    }
    function setBgLayer(olMap, bgLayer, vectorSources) {
      const mapLayers = olMap.getLayers();
      const currentBgLayerPos = mapLayers.getArray().findIndex((layer) => layer.getZIndex() === -1);
      let bgBaseLayer = void 0;
      if (bgLayer) {
        if (isLayerCached(bgLayer)) {
          bgBaseLayer = getLayerFromCache(bgLayer);
        } else {
          const styleSource = vectorSources && vectorSources.get(bgLayer.id);
          const mapService = useMap();
          if (styleSource) {
            const options = Object.assign(
              {
                container: mapService.getOlMap().getTarget()
              },
              styleSource
            );
            addLayerToCache(
              bgLayer.id,
              bgBaseLayer = new MapLibreLayer({
                maplibreOptions: options,
                label: bgLayer.name,
                id: bgLayer.id,
                queryable_id: bgLayer.id,
                metadata: bgLayer.metadata
              })
            );
          } else {
            addLayerToCache(bgLayer.id, bgBaseLayer = createLayer(bgLayer));
          }
        }
      }
      if (currentBgLayerPos >= 0) {
        if (bgBaseLayer) {
          bgBaseLayer.setZIndex(-1);
          mapLayers.setAt(currentBgLayerPos, bgBaseLayer);
        } else {
          mapLayers.removeAt(currentBgLayerPos);
        }
      } else {
        if (bgBaseLayer) {
          bgBaseLayer.setZIndex(-1);
          olMap.addLayer(bgBaseLayer);
        }
      }
      statePersistorStyleService.restoreStyle();
    }
    return {
      createLayer,
      addLayer,
      removeLayer,
      removeFromCache,
      reorderLayers,
      setLayerOpacity,
      getLayerFromCache,
      setBgLayer,
      applyOnBgLayer
    };
  }
  function getAllTextContent(node, normalizeWhitespace) {
    return getAllTextContent_(node, normalizeWhitespace, []).join("");
  }
  function getAllTextContent_(node, normalizeWhitespace, accumulator) {
    if (node.nodeType == Node.CDATA_SECTION_NODE || node.nodeType == Node.TEXT_NODE) {
      if (normalizeWhitespace) {
        accumulator.push(String(node.nodeValue).replace(/(\r\n|\r|\n)/g, ""));
      } else {
        accumulator.push(node.nodeValue);
      }
    } else {
      let n;
      for (n = node.firstChild; n; n = n.nextSibling) {
        getAllTextContent_(n, normalizeWhitespace, accumulator);
      }
    }
    return accumulator;
  }
  function isDocument(object) {
    return "documentElement" in object;
  }
  function parse(xml2) {
    return new DOMParser().parseFromString(xml2, "application/xml");
  }
  function makeArrayPusher(valueReader, thisArg) {
    return function(node, objectStack) {
      const value = valueReader.call(
        thisArg !== void 0 ? thisArg : this,
        node,
        objectStack
      );
      if (value !== void 0) {
        const array = objectStack[objectStack.length - 1];
        array.push(value);
      }
    };
  }
  function makeObjectPropertyPusher(valueReader, property, thisArg) {
    return function(node, objectStack) {
      const value = valueReader.call(
        thisArg !== void 0 ? thisArg : this,
        node,
        objectStack
      );
      if (value !== void 0) {
        const object = objectStack[objectStack.length - 1];
        const name = property !== void 0 ? property : node.localName;
        let array;
        if (name in object) {
          array = object[name];
        } else {
          array = [];
          object[name] = array;
        }
        array.push(value);
      }
    };
  }
  function makeObjectPropertySetter(valueReader, property, thisArg) {
    return function(node, objectStack) {
      const value = valueReader.call(
        thisArg !== void 0 ? thisArg : this,
        node,
        objectStack
      );
      if (value !== void 0) {
        const object = objectStack[objectStack.length - 1];
        const name = property !== void 0 ? property : node.localName;
        object[name] = value;
      }
    };
  }
  function makeStructureNS(namespaceURIs, structure, structureNS) {
    structureNS = structureNS !== void 0 ? structureNS : {};
    let i, ii;
    for (i = 0, ii = namespaceURIs.length; i < ii; ++i) {
      structureNS[namespaceURIs[i]] = structure;
    }
    return structureNS;
  }
  function parseNode(parsersNS, node, objectStack, thisArg) {
    let n;
    for (n = node.firstElementChild; n; n = n.nextElementSibling) {
      const parsers = parsersNS[n.namespaceURI];
      if (parsers !== void 0) {
        const parser = parsers[n.localName];
        if (parser !== void 0) {
          parser.call(thisArg, n, objectStack);
        }
      }
    }
  }
  function pushParseAndPop(object, parsersNS, node, objectStack, thisArg) {
    objectStack.push(object);
    parseNode(parsersNS, node, objectStack, thisArg);
    return objectStack.pop();
  }
  class XML {
    read(source) {
      if (!source) {
        return null;
      } else if (typeof source === "string") {
        const doc = parse(source);
        return this.readFromDocument(doc);
      } else if (isDocument(source)) {
        return this.readFromDocument(source);
      }
      return this.readFromNode(source);
    }
    readFromDocument(doc) {
      for (let n = doc.firstChild; n; n = n.nextSibling) {
        if (n.nodeType == Node.ELEMENT_NODE) {
          return this.readFromNode(n);
        }
      }
      return null;
    }
    readFromNode(node) {
    }
  }
  const XML$1 = XML;
  const NAMESPACE_URI = "http://www.w3.org/1999/xlink";
  function readHref(node) {
    return node.getAttributeNS(NAMESPACE_URI, "href");
  }
  function readDecimal(node) {
    const s = getAllTextContent(node, false);
    return readDecimalString(s);
  }
  function readDecimalString(string) {
    const m = /^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(string);
    if (m) {
      return parseFloat(m[1]);
    }
    return void 0;
  }
  function readPositiveInteger(node) {
    const s = getAllTextContent(node, false);
    return readNonNegativeIntegerString(s);
  }
  function readNonNegativeIntegerString(string) {
    const m = /^\s*(\d+)\s*$/.exec(string);
    if (m) {
      return parseInt(m[1], 10);
    }
    return void 0;
  }
  function readString(node) {
    return getAllTextContent(node, false).trim();
  }
  const NAMESPACE_URIS$1 = [null, "http://www.opengis.net/ows/1.1"];
  const PARSERS$1 = makeStructureNS(NAMESPACE_URIS$1, {
    "ServiceIdentification": makeObjectPropertySetter(readServiceIdentification),
    "ServiceProvider": makeObjectPropertySetter(readServiceProvider),
    "OperationsMetadata": makeObjectPropertySetter(readOperationsMetadata)
  });
  class OWS extends XML$1 {
    constructor() {
      super();
    }
    readFromNode(node) {
      const owsObject = pushParseAndPop({}, PARSERS$1, node, []);
      return owsObject ? owsObject : null;
    }
  }
  const ADDRESS_PARSERS = makeStructureNS(NAMESPACE_URIS$1, {
    "DeliveryPoint": makeObjectPropertySetter(readString),
    "City": makeObjectPropertySetter(readString),
    "AdministrativeArea": makeObjectPropertySetter(readString),
    "PostalCode": makeObjectPropertySetter(readString),
    "Country": makeObjectPropertySetter(readString),
    "ElectronicMailAddress": makeObjectPropertySetter(readString)
  });
  const ALLOWED_VALUES_PARSERS = makeStructureNS(NAMESPACE_URIS$1, {
    "Value": makeObjectPropertyPusher(readValue)
  });
  const CONSTRAINT_PARSERS = makeStructureNS(NAMESPACE_URIS$1, {
    "AllowedValues": makeObjectPropertySetter(readAllowedValues)
  });
  const CONTACT_INFO_PARSERS = makeStructureNS(NAMESPACE_URIS$1, {
    "Phone": makeObjectPropertySetter(readPhone),
    "Address": makeObjectPropertySetter(readAddress)
  });
  const DCP_PARSERS = makeStructureNS(NAMESPACE_URIS$1, {
    "HTTP": makeObjectPropertySetter(readHttp)
  });
  const HTTP_PARSERS = makeStructureNS(NAMESPACE_URIS$1, {
    "Get": makeObjectPropertyPusher(readGet),
    "Post": void 0
  });
  const OPERATION_PARSERS = makeStructureNS(NAMESPACE_URIS$1, {
    "DCP": makeObjectPropertySetter(readDcp)
  });
  const OPERATIONS_METADATA_PARSERS = makeStructureNS(NAMESPACE_URIS$1, {
    "Operation": readOperation
  });
  const PHONE_PARSERS = makeStructureNS(NAMESPACE_URIS$1, {
    "Voice": makeObjectPropertySetter(readString),
    "Facsimile": makeObjectPropertySetter(readString)
  });
  const REQUEST_METHOD_PARSERS = makeStructureNS(NAMESPACE_URIS$1, {
    "Constraint": makeObjectPropertyPusher(readConstraint)
  });
  const SERVICE_CONTACT_PARSERS = makeStructureNS(NAMESPACE_URIS$1, {
    "IndividualName": makeObjectPropertySetter(readString),
    "PositionName": makeObjectPropertySetter(readString),
    "ContactInfo": makeObjectPropertySetter(readContactInfo)
  });
  const SERVICE_IDENTIFICATION_PARSERS = makeStructureNS(NAMESPACE_URIS$1, {
    "Abstract": makeObjectPropertySetter(readString),
    "AccessConstraints": makeObjectPropertySetter(readString),
    "Fees": makeObjectPropertySetter(readString),
    "Title": makeObjectPropertySetter(readString),
    "ServiceTypeVersion": makeObjectPropertySetter(readString),
    "ServiceType": makeObjectPropertySetter(readString)
  });
  const SERVICE_PROVIDER_PARSERS = makeStructureNS(NAMESPACE_URIS$1, {
    "ProviderName": makeObjectPropertySetter(readString),
    "ProviderSite": makeObjectPropertySetter(readHref),
    "ServiceContact": makeObjectPropertySetter(readServiceContact)
  });
  function readAddress(node, objectStack) {
    return pushParseAndPop({}, ADDRESS_PARSERS, node, objectStack);
  }
  function readAllowedValues(node, objectStack) {
    return pushParseAndPop({}, ALLOWED_VALUES_PARSERS, node, objectStack);
  }
  function readConstraint(node, objectStack) {
    const name = node.getAttribute("name");
    if (!name) {
      return void 0;
    }
    return pushParseAndPop({ "name": name }, CONSTRAINT_PARSERS, node, objectStack);
  }
  function readContactInfo(node, objectStack) {
    return pushParseAndPop({}, CONTACT_INFO_PARSERS, node, objectStack);
  }
  function readDcp(node, objectStack) {
    return pushParseAndPop({}, DCP_PARSERS, node, objectStack);
  }
  function readGet(node, objectStack) {
    const href = readHref(node);
    if (!href) {
      return void 0;
    }
    return pushParseAndPop(
      { "href": href },
      REQUEST_METHOD_PARSERS,
      node,
      objectStack
    );
  }
  function readHttp(node, objectStack) {
    return pushParseAndPop({}, HTTP_PARSERS, node, objectStack);
  }
  function readOperation(node, objectStack) {
    const name = node.getAttribute("name");
    const value = pushParseAndPop({}, OPERATION_PARSERS, node, objectStack);
    if (!value) {
      return void 0;
    }
    const object = objectStack[objectStack.length - 1];
    object[name] = value;
  }
  function readOperationsMetadata(node, objectStack) {
    return pushParseAndPop({}, OPERATIONS_METADATA_PARSERS, node, objectStack);
  }
  function readPhone(node, objectStack) {
    return pushParseAndPop({}, PHONE_PARSERS, node, objectStack);
  }
  function readServiceIdentification(node, objectStack) {
    return pushParseAndPop({}, SERVICE_IDENTIFICATION_PARSERS, node, objectStack);
  }
  function readServiceContact(node, objectStack) {
    return pushParseAndPop({}, SERVICE_CONTACT_PARSERS, node, objectStack);
  }
  function readServiceProvider(node, objectStack) {
    return pushParseAndPop({}, SERVICE_PROVIDER_PARSERS, node, objectStack);
  }
  function readValue(node, objectStack) {
    return readString(node);
  }
  const OWS$1 = OWS;
  const NAMESPACE_URIS = [null, "http://www.opengis.net/wmts/1.0"];
  const OWS_NAMESPACE_URIS = [null, "http://www.opengis.net/ows/1.1"];
  const PARSERS = makeStructureNS(NAMESPACE_URIS, {
    "Contents": makeObjectPropertySetter(readContents)
  });
  class WMTSCapabilities extends XML$1 {
    constructor() {
      super();
      this.owsParser_ = new OWS$1();
    }
    readFromNode(node) {
      let version2 = node.getAttribute("version");
      if (version2) {
        version2 = version2.trim();
      }
      let WMTSCapabilityObject = this.owsParser_.readFromNode(node);
      if (!WMTSCapabilityObject) {
        return null;
      }
      WMTSCapabilityObject["version"] = version2;
      WMTSCapabilityObject = pushParseAndPop(
        WMTSCapabilityObject,
        PARSERS,
        node,
        []
      );
      return WMTSCapabilityObject ? WMTSCapabilityObject : null;
    }
  }
  const CONTENTS_PARSERS = makeStructureNS(NAMESPACE_URIS, {
    "Layer": makeObjectPropertyPusher(readLayer),
    "TileMatrixSet": makeObjectPropertyPusher(readTileMatrixSet)
  });
  const LAYER_PARSERS = makeStructureNS(
    NAMESPACE_URIS,
    {
      "Style": makeObjectPropertyPusher(readStyle),
      "Format": makeObjectPropertyPusher(readString),
      "TileMatrixSetLink": makeObjectPropertyPusher(readTileMatrixSetLink),
      "Dimension": makeObjectPropertyPusher(readDimensions),
      "ResourceURL": makeObjectPropertyPusher(readResourceUrl)
    },
    makeStructureNS(OWS_NAMESPACE_URIS, {
      "Title": makeObjectPropertySetter(readString),
      "Abstract": makeObjectPropertySetter(readString),
      "WGS84BoundingBox": makeObjectPropertySetter(readBoundingBox),
      "Identifier": makeObjectPropertySetter(readString)
    })
  );
  const STYLE_PARSERS = makeStructureNS(
    NAMESPACE_URIS,
    {
      "LegendURL": makeObjectPropertyPusher(readLegendUrl)
    },
    makeStructureNS(OWS_NAMESPACE_URIS, {
      "Title": makeObjectPropertySetter(readString),
      "Identifier": makeObjectPropertySetter(readString)
    })
  );
  const TMS_LINKS_PARSERS = makeStructureNS(NAMESPACE_URIS, {
    "TileMatrixSet": makeObjectPropertySetter(readString),
    "TileMatrixSetLimits": makeObjectPropertySetter(readTileMatrixLimitsList)
  });
  const TMS_LIMITS_LIST_PARSERS = makeStructureNS(NAMESPACE_URIS, {
    "TileMatrixLimits": makeArrayPusher(readTileMatrixLimits)
  });
  const TMS_LIMITS_PARSERS = makeStructureNS(NAMESPACE_URIS, {
    "TileMatrix": makeObjectPropertySetter(readString),
    "MinTileRow": makeObjectPropertySetter(readPositiveInteger),
    "MaxTileRow": makeObjectPropertySetter(readPositiveInteger),
    "MinTileCol": makeObjectPropertySetter(readPositiveInteger),
    "MaxTileCol": makeObjectPropertySetter(readPositiveInteger)
  });
  const DIMENSION_PARSERS = makeStructureNS(
    NAMESPACE_URIS,
    {
      "Default": makeObjectPropertySetter(readString),
      "Value": makeObjectPropertyPusher(readString)
    },
    makeStructureNS(OWS_NAMESPACE_URIS, {
      "Identifier": makeObjectPropertySetter(readString)
    })
  );
  const WGS84_BBOX_READERS = makeStructureNS(OWS_NAMESPACE_URIS, {
    "LowerCorner": makeArrayPusher(readCoordinates),
    "UpperCorner": makeArrayPusher(readCoordinates)
  });
  const TMS_PARSERS = makeStructureNS(
    NAMESPACE_URIS,
    {
      "WellKnownScaleSet": makeObjectPropertySetter(readString),
      "TileMatrix": makeObjectPropertyPusher(readTileMatrix)
    },
    makeStructureNS(OWS_NAMESPACE_URIS, {
      "SupportedCRS": makeObjectPropertySetter(readString),
      "Identifier": makeObjectPropertySetter(readString),
      "BoundingBox": makeObjectPropertySetter(readBoundingBox)
    })
  );
  const TM_PARSERS = makeStructureNS(
    NAMESPACE_URIS,
    {
      "TopLeftCorner": makeObjectPropertySetter(readCoordinates),
      "ScaleDenominator": makeObjectPropertySetter(readDecimal),
      "TileWidth": makeObjectPropertySetter(readPositiveInteger),
      "TileHeight": makeObjectPropertySetter(readPositiveInteger),
      "MatrixWidth": makeObjectPropertySetter(readPositiveInteger),
      "MatrixHeight": makeObjectPropertySetter(readPositiveInteger)
    },
    makeStructureNS(OWS_NAMESPACE_URIS, {
      "Identifier": makeObjectPropertySetter(readString)
    })
  );
  function readContents(node, objectStack) {
    return pushParseAndPop({}, CONTENTS_PARSERS, node, objectStack);
  }
  function readLayer(node, objectStack) {
    return pushParseAndPop({}, LAYER_PARSERS, node, objectStack);
  }
  function readTileMatrixSet(node, objectStack) {
    return pushParseAndPop({}, TMS_PARSERS, node, objectStack);
  }
  function readStyle(node, objectStack) {
    const style = pushParseAndPop({}, STYLE_PARSERS, node, objectStack);
    if (!style) {
      return void 0;
    }
    const isDefault = node.getAttribute("isDefault") === "true";
    style["isDefault"] = isDefault;
    return style;
  }
  function readTileMatrixSetLink(node, objectStack) {
    return pushParseAndPop({}, TMS_LINKS_PARSERS, node, objectStack);
  }
  function readDimensions(node, objectStack) {
    return pushParseAndPop({}, DIMENSION_PARSERS, node, objectStack);
  }
  function readResourceUrl(node, objectStack) {
    const format = node.getAttribute("format");
    const template = node.getAttribute("template");
    const resourceType = node.getAttribute("resourceType");
    const resource = {};
    if (format) {
      resource["format"] = format;
    }
    if (template) {
      resource["template"] = template;
    }
    if (resourceType) {
      resource["resourceType"] = resourceType;
    }
    return resource;
  }
  function readBoundingBox(node, objectStack) {
    const coordinates2 = pushParseAndPop(
      [],
      WGS84_BBOX_READERS,
      node,
      objectStack
    );
    if (coordinates2.length != 2) {
      return void 0;
    }
    return boundingExtent(coordinates2);
  }
  function readLegendUrl(node, objectStack) {
    const legend = {};
    legend["format"] = node.getAttribute("format");
    legend["href"] = readHref(node);
    return legend;
  }
  function readCoordinates(node, objectStack) {
    const coordinates2 = readString(node).split(/\s+/);
    if (!coordinates2 || coordinates2.length != 2) {
      return void 0;
    }
    const x = +coordinates2[0];
    const y2 = +coordinates2[1];
    if (isNaN(x) || isNaN(y2)) {
      return void 0;
    }
    return [x, y2];
  }
  function readTileMatrix(node, objectStack) {
    return pushParseAndPop({}, TM_PARSERS, node, objectStack);
  }
  function readTileMatrixLimitsList(node, objectStack) {
    return pushParseAndPop([], TMS_LIMITS_LIST_PARSERS, node, objectStack);
  }
  function readTileMatrixLimits(node, objectStack) {
    return pushParseAndPop({}, TMS_LIMITS_PARSERS, node, objectStack);
  }
  const WMTSCapabilities$1 = WMTSCapabilities;
  class WmtsEndpoint {
    constructor(url) {
      __publicField(this, "capabilitiesPromise");
      __publicField(this, "serviceInfo");
      __publicField(this, "layers");
      const parser = new WMTSCapabilities$1();
      let separator = "&";
      if (url.indexOf("?") === -1) {
        separator = "?";
      }
      if (url.indexOf("Capabilities") === -1) {
        url = url + separator + "SERVICE=WMTS&REQUEST=GetCapabilities";
      }
      this.capabilitiesPromise = fetch(url).then((response) => {
        return response.text();
      }).then((text2) => {
        var _a;
        const result = parser.read(text2);
        this.serviceInfo = this.mapServiceInfo(result.ServiceIdentification);
        this.layers = this.mapToRemoteLayers((_a = result.Contents) == null ? void 0 : _a.Layer);
      });
    }
    mapToRemoteLayers(layers) {
      return [
        {
          type: REMOTE_SERVICE_TYPE.WMTS,
          children: layers.map(
            (layer) => ({
              type: REMOTE_SERVICE_TYPE.WMTS,
              abstract: layer.Abstract,
              format: layer.Format,
              name: layer.Identifier,
              title: layer.Title,
              tileMatrixSetLink: layer.TileMatrixSetLink,
              wgs84BoundingBox: layer.WGS84BoundingBox
            })
          )
        }
      ];
    }
    mapServiceInfo(serviceInfo) {
      return {
        type: REMOTE_SERVICE_TYPE.WMTS,
        title: serviceInfo.Title,
        abstract: serviceInfo.Abstract,
        fees: serviceInfo.Fees,
        constraints: serviceInfo.AccessConstraints,
        serviceTypeVersion: serviceInfo.ServiceTypeVersion
      };
    }
    isReady() {
      return this.capabilitiesPromise.then(() => this);
    }
    getLayerByName(name) {
      return this.layers[0].children.filter((layer) => layer.name === name)[0];
    }
    getLayers() {
      return this.layers;
    }
    getServiceInfo() {
      return this.serviceInfo;
    }
  }
  class RemoteLayersService {
    async getRemoteEndpoint(url) {
      let wmtsEndpoint;
      const wmsEndpoint = await this.getWmsEndpoint(url).isReady().catch(async () => {
        wmtsEndpoint = await this.getWmtsEndpoint(url).isReady();
      });
      return wmsEndpoint || wmtsEndpoint;
    }
    getWmsEndpoint(url) {
      return new WmsEndpoint(this.getProxyfiedUrl(url));
    }
    getWmtsEndpoint(url) {
      return new WmtsEndpoint(this.getProxyfiedUrl(url));
    }
    getProxyfiedUrl(url) {
      if (url.indexOf("httpsproxy") > 0) {
        return url;
      }
      {
        return remoteProxyWms + "?url=" + encodeURIComponent(url);
      }
    }
    async fetchRemoteWmsEndpoint() {
      return new Promise((resolve) => resolve(predefinedWmsFixture()));
    }
    isRemoteLayer(layerId) {
      return typeof layerId === "string" && (layerId.indexOf(REMOTE_SERVICE_TYPE.WMS) === 0 || layerId.indexOf(REMOTE_SERVICE_TYPE.WMTS) === 0);
    }
  }
  const remoteLayersService = new RemoteLayersService();
  function sortLayerTreeNoChildrenFirst(a, b) {
    var _a, _b;
    if (a.children && !b.children || ((_a = b.children) == null ? void 0 : _a.length) === 0) {
      return 1;
    }
    if (b.children && !a.children || ((_b = a.children) == null ? void 0 : _b.length) === 0) {
      return -1;
    }
    return 0;
  }
  function remoteLayersToLayerTreeMapper(node, urlWms, depth = 0) {
    const { name = "", type = REMOTE_SERVICE_TYPE.WMS, children } = node;
    const id = `${type}||${urlWms}||${name}`.split("-").join("%2D");
    const mapStore = useMapStore();
    return {
      id,
      name,
      depth,
      children: children == null ? void 0 : children.sort(sortLayerTreeNoChildrenFirst).map((child) => remoteLayersToLayerTreeMapper(child, urlWms, depth + 1)),
      checked: mapStore.hasLayer(id),
      expanded: false
    };
  }
  function remoteLayerIdtoLayer(layerId) {
    const id = decodeURIComponent(layerId);
    const [type, url, name] = id.split("||");
    return remoteLayerToLayer({
      id,
      url: remoteLayersService.getProxyfiedUrl(url),
      remoteLayer: { name, type }
    });
  }
  function remoteLayerToLayer({
    id,
    url,
    remoteLayer
  }) {
    const { name = "", type = REMOTE_SERVICE_TYPE.WMS } = remoteLayer;
    return {
      id,
      name,
      layers: name,
      url,
      type,
      imageType: LayerImageType.PNG
    };
  }
  const STORAGE_SEPARATOR = "-";
  const STORAGE_SEPARATOR_V2 = ",";
  class StorageLayerMapper {
    constructor() {
      __publicField(this, "layersOpacitiesToNumbersV2", (opacitiesText) => {
        return this.layersOpacitiesToNumbers(opacitiesText, STORAGE_SEPARATOR_V2);
      });
    }
    layerIdsToLayers(layerIdsText) {
      const themes2 = useThemes();
      const layers = useLayers();
      const layerIds = layerIdsText ? layerIdsText.split(STORAGE_SEPARATOR) : [];
      return layerIds.map((layerId) => {
        const layer = remoteLayersService.isRemoteLayer(layerId) ? remoteLayerIdtoLayer(layerId) : themes2.findById(parseInt(layerId, 10));
        return layer ? layers.initLayer(layer) : void 0;
      });
    }
    layerNamesToLayersV2(layersNamesText) {
      const themes2 = useThemes();
      const layers = useLayers();
      const layersNames = layersNamesText ? layersNamesText.split(STORAGE_SEPARATOR_V2) : [];
      return layersNames.map((layerName) => {
        const layer = themes2.findByName(layerName);
        return layer ? layers.initLayer(layer) : void 0;
      });
    }
    layersOpacitiesToNumbers(opacitiesText, separator = STORAGE_SEPARATOR) {
      return stringToNumbers(opacitiesText, separator);
    }
    layersVisibilitiesToBooleansV2(visibilitiesText) {
      return stringToBooleans(visibilitiesText, STORAGE_SEPARATOR_V2);
    }
    layersToLayerIds(layers) {
      return (layers == null ? void 0 : layers.map((layer) => layer.id).join(STORAGE_SEPARATOR)) || "";
    }
    layersToLayerOpacities(layers) {
      return (layers == null ? void 0 : layers.map((layer) => {
        var _a;
        return (_a = layer.opacity) != null ? _a : 1;
      }).join(STORAGE_SEPARATOR)) || "";
    }
    bgLayerNameToBgLayer(bgLayerName) {
      const themes2 = useThemes();
      return bgLayerName ? themes2.findBgLayerByName(bgLayerName) : null;
    }
    bgLayerToBgLayerName(layer) {
      return (layer == null ? void 0 : layer.name) || BLANK_BACKGROUNDLAYER.name;
    }
  }
  const storageLayerMapper = new StorageLayerMapper();
  const DEFAULT_BGLAYER_NAME = "basemap_2015_global";
  const DEFAULT_BGLAYER_NAME_V2 = "orthogr_2013_global";
  const V2_BGLAYER_TO_V3_ = {
    webbasemap: "basemap_2015_global",
    "pixelmaps-color": "topogr_global",
    "pixelmaps-gray": "topo_bw_jpeg",
    streets: "streets_jpeg",
    voidlayer: "blank"
  };
  class StatePersistorBgLayerService {
    bootstrap() {
      const themeStore = useThemeStore();
      let stop;
      stop = vue.watchEffect(() => {
        if (themeStore.bgLayers.length > 0) {
          this.restore();
          this.persist();
          stop && stop();
        }
      });
    }
    persist() {
      const mapStore = useMapStore();
      const { bgLayer } = storeToRefs(mapStore);
      vue.watch(
        bgLayer,
        (value, oldValue) => {
          if (oldValue !== value) {
            storageHelper.setValue(
              SP_KEY_BGLAYER,
              value,
              storageLayerMapper.bgLayerToBgLayerName
            );
          }
        },
        { immediate: true }
      );
    }
    restore() {
      const { setMapBackground } = useBackgroundLayer();
      const bgLayer = this.getBgLayerFromStorage();
      setMapBackground(bgLayer);
    }
    getBgLayerFromStorage() {
      const version2 = storageHelper.getInitialVersion();
      const bgLayerName = storageHelper.getValue(SP_KEY_BGLAYER);
      const bgLayer = !bgLayerName ? storageLayerMapper.bgLayerNameToBgLayer(DEFAULT_BGLAYER_NAME) : version2 === 2 ? this.getBgLayerFromStorageV2(bgLayerName) : storageLayerMapper.bgLayerNameToBgLayer(bgLayerName);
      return bgLayer;
    }
    getBgLayerFromStorageV2(bgLayerNameFromStorage) {
      const bgLayerOpacity = storageHelper.getValue(
        SP_KEY_V2_BGLAYEROPACITY,
        stringToNumber
      );
      let bgLayerName = "";
      if (bgLayerNameFromStorage) {
        bgLayerName = V2_BGLAYER_TO_V3_[bgLayerNameFromStorage];
      } else if (bgLayerOpacity === 0) {
        bgLayerName = DEFAULT_BGLAYER_NAME_V2;
      }
      return storageLayerMapper.bgLayerNameToBgLayer(bgLayerName);
    }
  }
  const statePersistorBgLayerService = new StatePersistorBgLayerService();
  const _hoisted_1$a = ["title"];
  const _sfc_main$b = /* @__PURE__ */ vue.defineComponent({
    __name: "background-selector-item",
    props: {
      bgTitle: {
        type: String,
        default: ""
      },
      bgName: {
        type: String,
        default: ""
      }
    },
    setup(__props) {
      const props = __props;
      const { t } = useTranslation();
      const buttonTitle = vue.computed(() => {
        const localizedTitle = t(props.bgTitle);
        const hasTitle = props.bgTitle.length > 0;
        const localizedLayerName = `${t("Background layer:")} ${t(props.bgName)}`;
        return `${localizedTitle}${hasTitle ? " - " : ""}${localizedLayerName}`;
      });
      const buttonClasses = vue.computed(
        () => `h-full w-full rounded-sm lux-bg-sel-icon
        lux-bg-sel-${props.bgName}
        bg-${props.bgName}_sm
        md:bg-${props.bgName}
        hd:bg-${props.bgName}_sm_hi
        hd_md:bg-${props.bgName}_hi`
      );
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock("button", {
          title: vue.unref(buttonTitle),
          class: vue.normalizeClass(vue.unref(buttonClasses))
        }, null, 10, _hoisted_1$a);
      };
    }
  });
  const _hoisted_1$9 = { class: "flex flex-row-reverse" };
  const _sfc_main$a = /* @__PURE__ */ vue.defineComponent({
    __name: "background-selector",
    props: {
      isOpen: {
        type: Boolean,
        default: false
      }
    },
    setup(__props) {
      const props = __props;
      const { t } = useTranslation();
      const backgroundLayer = useBackgroundLayer();
      const mapStore = useMapStore();
      const themeStore = useThemeStore();
      const { bgLayer: bgLayerContext } = storeToRefs(mapStore);
      statePersistorBgLayerService.bootstrap();
      const isOpen = vue.ref(props.isOpen);
      const bgLayers = vue.ref([]);
      const activeLayerId = vue.computed(
        () => {
          var _a, _b;
          return (_b = (_a = bgLayerContext.value) == null ? void 0 : _a.id) != null ? _b : backgroundLayer.getNullId();
        }
      );
      const activeLayerName = vue.computed(
        () => {
          var _a, _b;
          return (_b = (_a = bgLayers.value) == null ? void 0 : _a.find((layer) => layer.id === activeLayerId.value)) == null ? void 0 : _b.name;
        }
      );
      vue.watch(
        () => themeStore.bgLayers,
        (bgLayersContext) => {
          bgLayers.value = bgConfigFixture().bg_layers.map(
            (bgl) => Object.assign(
              {
                id: bgl.id
              },
              bgLayersContext.find((l) => bgl.id == l.id),
              {
                name: bgl.icon_id
              }
            )
          );
        },
        { immediate: true }
      );
      vue.watch(
        () => mapStore.bgLayer,
        (bgLayerContext2, bgLayerContextOld) => {
          const layersContext = mapStore.layers;
          if (bgLayerContextOld === void 0 && bgLayerContext2 === null && (layersContext == null ? void 0 : layersContext.length) === 0) {
            backgroundLayer.setBgLayer(backgroundLayer.defaultSelectedBgId.value);
            if (bgLayerContext2 === null) {
              console.log(
                t(
                  "Aucune couche n'\xE9tant d\xE9finie pour cette carte, une couche de fond a automatiquement \xE9t\xE9 ajout\xE9e.",
                  { ns: "client" }
                )
              );
            }
          }
        }
      );
      function setBackgroundLayer(layer) {
        backgroundLayer.setBgLayer(layer.id);
        isOpen.value = false;
      }
      function toggleSelector() {
        isOpen.value = !isOpen.value;
      }
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock("div", _hoisted_1$9, [
          vue.createElementVNode("div", {
            class: vue.normalizeClass(["lux-bg-sel border border-black", isOpen.value === true ? "hidden" : "block"])
          }, [
            vue.createVNode(_sfc_main$b, {
              "aria-expanded": isOpen.value,
              "bg-title": "Select BG layer",
              "bg-name": vue.unref(activeLayerName),
              onClick: toggleSelector
            }, null, 8, ["aria-expanded", "bg-name"])
          ], 2),
          vue.createElementVNode("div", {
            class: vue.normalizeClass(isOpen.value === true ? "flex flex-col md:flex-row" : "hidden")
          }, [
            (vue.openBlock(true), vue.createElementBlock(vue.Fragment, null, vue.renderList(bgLayers.value, (layer) => {
              return vue.openBlock(), vue.createElementBlock("div", {
                key: layer.id,
                class: vue.normalizeClass([
                  "lux-bg-sel hover:bg-cyan-600",
                  layer.id === vue.unref(activeLayerId) ? "border-red-500 border-2" : "border-black border"
                ])
              }, [
                vue.createVNode(_sfc_main$b, {
                  "bg-name": layer.name,
                  onClick: ($event) => setBackgroundLayer(layer)
                }, null, 8, ["bg-name", "onClick"])
              ], 2);
            }), 128))
          ], 2)
        ]);
      };
    }
  });
  const _hoisted_1$8 = { class: "flex flex-row flex-wrap pl-2.5" };
  const _hoisted_2$6 = ["onClick"];
  const _hoisted_3$5 = { class: "text-2xl absolute top-5" };
  const _sfc_main$9 = /* @__PURE__ */ vue.defineComponent({
    __name: "theme-grid",
    props: {
      themes: null
    },
    setup(__props) {
      const props = __props;
      const { t } = useTranslation();
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock("div", _hoisted_1$8, [
          (vue.openBlock(true), vue.createElementBlock(vue.Fragment, null, vue.renderList(props.themes, (theme) => {
            return vue.openBlock(), vue.createElementBlock("button", {
              class: vue.normalizeClass(["relative shrink-0 h-[150px] w-1/2 px-2.5 text-start text-gray-100/40 uppercase hover:bg-[#ccc]", `bg-${theme.name}-primary hover:text-${theme.name}-primary`]),
              key: theme.id,
              onClick: ($event) => _ctx.$emit("setTheme", theme.name)
            }, [
              vue.createElementVNode("div", _hoisted_3$5, vue.toDisplayString(vue.unref(t)(`${theme.name}`)), 1),
              vue.createElementVNode("div", {
                class: vue.normalizeClass(["text-6xl absolute bottom-1 after:font-icons", `after:content-${theme.name}`])
              }, null, 2)
            ], 10, _hoisted_2$6);
          }), 128))
        ]);
      };
    }
  });
  const _hoisted_1$7 = ["aria-expanded"];
  const _hoisted_2$5 = { class: "py-0.5" };
  const _hoisted_3$4 = { class: "px-1 py-0.5 shrink-0 flex flex-row text-[12px] bg-secondary text-white" };
  const _hoisted_4$4 = { class: "py-[3px]" };
  const _hoisted_5$4 = { class: "flex flex-row flex-wrap ml-1 w-12" };
  const _sfc_main$8 = /* @__PURE__ */ vue.defineComponent({
    __name: "theme-selector-button",
    props: {
      themes: null,
      currentTheme: null,
      isOpen: { type: Boolean }
    },
    setup(__props) {
      const props = __props;
      const { t } = useTranslation();
      const themesComputed = vue.computed(() => {
        var _a;
        return ((_a = props.themes) == null ? void 0 : _a.slice(0, 8)) || [];
      });
      return (_ctx, _cache) => {
        var _a;
        return vue.openBlock(), vue.createElementBlock("button", {
          class: "w-full flex flex-row justify-between bg-tertiary text-white px-2 py-1.5 uppercase cursor-pointer hover:bg-white hover:text-primary",
          "aria-expanded": props.isOpen
        }, [
          vue.createElementVNode("span", _hoisted_2$5, vue.toDisplayString(vue.unref(t)("Theme")) + ": " + vue.toDisplayString(vue.unref(t)(`${(_a = props.currentTheme) == null ? void 0 : _a.name}`)), 1),
          vue.createElementVNode("span", _hoisted_3$4, [
            vue.createElementVNode("span", _hoisted_4$4, vue.toDisplayString(vue.unref(t)("Changer")), 1),
            vue.createElementVNode("span", _hoisted_5$4, [
              (vue.openBlock(true), vue.createElementBlock(vue.Fragment, null, vue.renderList(vue.unref(themesComputed), (theme) => {
                return vue.openBlock(), vue.createElementBlock("div", {
                  class: vue.normalizeClass(`h-2.5 w-2.5 m-px bg-${theme.name}-primary`),
                  key: theme.id
                }, null, 2);
              }), 128))
            ])
          ])
        ], 8, _hoisted_1$7);
      };
    }
  });
  const _hoisted_1$6 = {
    key: 0,
    class: "absolute inset-x-0 top-14 bottom-0 mt-1 bg-primary overflow-y-auto overflow-x-hidden"
  };
  const _sfc_main$7 = /* @__PURE__ */ vue.defineComponent({
    __name: "theme-selector",
    emits: ["toggleThemesGrid"],
    setup(__props, { emit }) {
      const themeStore = useThemeStore();
      const themesService = useThemes();
      const { theme, themes: themesFromStore } = storeToRefs(themeStore);
      const themes2 = vue.computed(
        () => {
          var _a;
          return ((_a = themesFromStore.value) == null ? void 0 : _a.filter(
            (theme2) => {
              var _a2;
              return ((_a2 = theme2.metadata) == null ? void 0 : _a2.display_in_switcher) === true;
            }
          )) || [];
        }
      );
      const isOpen = vue.shallowRef(false);
      function toggleThemesGrid() {
        emit("toggleThemesGrid", isOpen.value = !isOpen.value);
      }
      function setTheme(themeName) {
        themesService.setTheme(themeName);
        toggleThemesGrid();
      }
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock(vue.Fragment, null, [
          vue.createVNode(_sfc_main$8, {
            onClick: toggleThemesGrid,
            themes: vue.unref(themes2),
            currentTheme: vue.unref(theme),
            isOpen: vue.unref(isOpen)
          }, null, 8, ["themes", "currentTheme", "isOpen"]),
          vue.unref(isOpen) ? (vue.openBlock(), vue.createElementBlock("div", _hoisted_1$6, [
            vue.createVNode(_sfc_main$9, {
              onSetTheme: setTheme,
              themes: vue.unref(themes2)
            }, null, 8, ["themes"])
          ])) : vue.createCommentVNode("", true)
        ], 64);
      };
    }
  });
  const _hoisted_1$5 = { class: "pt-5" };
  const _sfc_main$6 = /* @__PURE__ */ vue.defineComponent({
    __name: "catalog-tab",
    setup(__props) {
      const themeGridIsOpen = vue.shallowRef(false);
      function toggleThemesGrid(isOpen) {
        themeGridIsOpen.value = isOpen;
      }
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock(vue.Fragment, null, [
          vue.createVNode(_sfc_main$7, { onToggleThemesGrid: toggleThemesGrid }),
          vue.createElementVNode("div", _hoisted_1$5, [
            vue.unref(themeGridIsOpen) === false ? (vue.openBlock(), vue.createBlock(_sfc_main$h, {
              key: 0,
              class: "pt-5 absolute inset-x-2.5 bg-primary overflow-y-auto overflow-x-hidden"
            })) : vue.createCommentVNode("", true)
          ])
        ], 64);
      };
    }
  });
  const _hoisted_1$4 = {
    class: "absolute right-0 top-52 z-50 bg-white lux-modal w-[600px]",
    role: "dialog"
  };
  const _hoisted_2$4 = { class: "lux-modal-header" };
  const _hoisted_3$3 = { class: "p-[15px]" };
  const _hoisted_4$3 = { class: "relative text-center" };
  const _hoisted_5$3 = ["placeholder", "value"];
  const _hoisted_6$1 = {
    key: 0,
    class: "text-center"
  };
  const _hoisted_7$1 = { class: "lux-label" };
  const _hoisted_8$1 = {
    key: 1,
    class: "text-center"
  };
  const _hoisted_9$1 = { class: "lux-label" };
  const _hoisted_10$1 = {
    key: 2,
    class: "text-center"
  };
  const _hoisted_11$1 = /* @__PURE__ */ vue.createElementVNode("div", { class: "fa fa-refresh fa-spin" }, null, -1);
  const _hoisted_12$1 = {
    key: 3,
    class: "overflow-auto max-h-[calc(400px-36px)]"
  };
  const _sfc_main$5 = /* @__PURE__ */ vue.defineComponent({
    __name: "remote-layers",
    setup(__props) {
      const { t } = useTranslation();
      const mapStore = useMapStore();
      const layers = useLayers();
      const wmsLayers = vue.shallowRef([]);
      const layerTree = vue.shallowRef();
      let isLoading = false;
      let inputRemoteUrl;
      let currentRemoteUrl;
      let currentRemoteEndpoint;
      vue.watchEffect(updateLayerTree);
      function updateLayerTree() {
        layerTree.value = layerTree.value ? layerTreeService.updateLayers(
          layerTree.value,
          mapStore.layers
        ) : void 0;
      }
      remoteLayersService.fetchRemoteWmsEndpoint().then((wmsLayersFetch) => {
        wmsLayers.value = wmsLayersFetch.map(({ url, label }) => ({
          label,
          value: url
        }));
      });
      async function getRemoteEndpoint(url) {
        isLoading = true;
        currentRemoteEndpoint = await remoteLayersService.getRemoteEndpoint(url).catch(() => alert(t("Impossible de contacter ce WMS", { ns: "client" })));
        currentRemoteUrl = url;
        isLoading = false;
      }
      async function getRemoteLayers() {
        const remoteEndpoint = currentRemoteEndpoint;
        const remoteLayers = remoteEndpoint == null ? void 0 : remoteEndpoint.getLayers();
        if (remoteLayers && remoteLayers[0]) {
          const treeLayers = remoteLayersToLayerTreeMapper(
            remoteLayers[0],
            currentRemoteUrl
          );
          layerTree.value = layerTreeService.updateLayers(treeLayers, mapStore.layers);
        }
      }
      async function onChangeRemoteEndpoint(url) {
        currentRemoteUrl = inputRemoteUrl = url;
        await getRemoteEndpoint(currentRemoteUrl);
        getRemoteLayers();
      }
      function onChangeRemoteUrl(event) {
        inputRemoteUrl = event.target.value;
      }
      async function onClickGetLayers() {
        await getRemoteEndpoint(inputRemoteUrl);
        getRemoteLayers();
      }
      function toggleParent(node) {
        layerTree.value = layerTreeService.toggleNode(
          node.id,
          layerTree.value,
          "expanded"
        );
      }
      function toggleLayer(node) {
        const { id, name } = node;
        const remoteEndpoint = currentRemoteEndpoint;
        if (node.checked === true) {
          mapStore.removeLayers(id);
        } else {
          const remoteLayer = remoteEndpoint == null ? void 0 : remoteEndpoint.getLayerByName(name);
          if (remoteLayer) {
            const layer = layers.initLayer(
              remoteLayerToLayer({
                id,
                url: remoteLayersService.getProxyfiedUrl(currentRemoteUrl),
                remoteLayer
              })
            );
            mapStore.addLayers(layer);
          }
        }
      }
      return (_ctx, _cache) => {
        var _a, _b;
        return vue.openBlock(), vue.createElementBlock("div", _hoisted_1$4, [
          vue.createElementVNode("div", _hoisted_2$4, [
            vue.createElementVNode("h4", null, vue.toDisplayString(vue.unref(t)("Add external data", { ns: "client" })), 1)
          ]),
          vue.createElementVNode("div", _hoisted_3$3, [
            vue.createElementVNode("div", _hoisted_4$3, [
              vue.createVNode(_sfc_main$o, {
                options: vue.unref(wmsLayers),
                placeholder: vue.unref(t)("Predefined wms", { ns: "client" }),
                onChange: onChangeRemoteEndpoint
              }, null, 8, ["options", "placeholder"]),
              vue.createElementVNode("input", {
                class: "lux-input w-[300px]",
                type: "url",
                placeholder: vue.unref(t)("Choose or write a WMS url", {
                  ns: "client"
                }),
                value: vue.unref(currentRemoteUrl) || "",
                onChange: onChangeRemoteUrl
              }, null, 40, _hoisted_5$3),
              vue.createElementVNode("button", {
                type: "button",
                class: "lux-btn",
                onClick: onClickGetLayers
              }, vue.toDisplayString(vue.unref(t)("Get the layers", { ns: "client" })), 1)
            ]),
            !vue.unref(isLoading) && vue.unref(currentRemoteEndpoint) ? (vue.openBlock(), vue.createElementBlock("div", _hoisted_6$1, [
              vue.createElementVNode("span", _hoisted_7$1, vue.toDisplayString(vue.unref(t)("Description du service :", {
                ns: "client"
              })), 1),
              vue.createTextVNode(" " + vue.toDisplayString((_a = vue.unref(currentRemoteEndpoint).getServiceInfo()) == null ? void 0 : _a.abstract), 1)
            ])) : vue.createCommentVNode("", true),
            !vue.unref(isLoading) && vue.unref(currentRemoteEndpoint) ? (vue.openBlock(), vue.createElementBlock("div", _hoisted_8$1, [
              vue.createElementVNode("span", _hoisted_9$1, vue.toDisplayString(vue.unref(t)("Access constraints :", {
                ns: "client"
              })), 1),
              vue.createTextVNode(" " + vue.toDisplayString((_b = vue.unref(currentRemoteEndpoint).getServiceInfo()) == null ? void 0 : _b.constraints), 1)
            ])) : vue.createCommentVNode("", true),
            vue.unref(isLoading) ? (vue.openBlock(), vue.createElementBlock("div", _hoisted_10$1, [
              _hoisted_11$1,
              vue.createElementVNode("span", null, vue.toDisplayString(vue.unref(t)("Chargement des informations", {
                ns: "client"
              })), 1)
            ])) : vue.createCommentVNode("", true),
            !vue.unref(isLoading) ? (vue.openBlock(), vue.createElementBlock("div", _hoisted_12$1, [
              vue.unref(layerTree) ? (vue.openBlock(), vue.createBlock(_sfc_main$i, {
                key: 0,
                class: "block p-[10px] mb-[11px]",
                node: vue.unref(layerTree),
                onToggleParent: toggleParent,
                onToggleLayer: toggleLayer
              }, null, 8, ["node"])) : vue.createCommentVNode("", true)
            ])) : vue.createCommentVNode("", true)
          ])
        ]);
      };
    }
  });
  function formatDate(dateString, language = "fr-FR") {
    const date = new Date(dateString);
    return new Intl.DateTimeFormat(language).format(date);
  }
  const _hoisted_1$3 = { class: "font-bold" };
  const _hoisted_2$3 = { class: "col-span-2" };
  const _sfc_main$4 = /* @__PURE__ */ vue.defineComponent({
    __name: "layer-metadata-item",
    props: {
      label: null,
      value: null
    },
    setup(__props) {
      const props = __props;
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock(vue.Fragment, null, [
          vue.createElementVNode("span", _hoisted_1$3, vue.toDisplayString(props.label), 1),
          vue.createElementVNode("span", _hoisted_2$3, vue.toDisplayString(props.value), 1)
        ], 64);
      };
    }
  });
  function isoLang2To3(code) {
    const lang = {
      fr: "fre",
      en: "eng",
      de: "ger",
      lb: "ltz"
    };
    return lang[code.toLowerCase()];
  }
  function stringToHtml(str) {
    const parser = new DOMParser();
    const doc = parser.parseFromString(str, "text/html");
    return doc.body;
  }
  function getMetadataLinks(link) {
    const links = [];
    function splitLink(link2) {
      const currentLink = link2.split("|");
      if (currentLink[3] === "WWW:LINK-1.0-http--link" && links.indexOf(currentLink[2]) === -1) {
        links.push(currentLink[2]);
      }
    }
    if (Array.isArray(link)) {
      link.forEach(splitLink, link);
    } else {
      splitLink(link);
    }
    return links;
  }
  function getResponsibleParty(responsibleParty) {
    const pocs = Array.isArray(responsibleParty) ? responsibleParty : [responsibleParty];
    const poc = pocs.filter((poc2) => poc2.split("|")[1] === "metadata");
    return {
      organisaton: poc[0].split("|")[2],
      name: poc[0].split("|")[5],
      unknown: poc[0].split("|")[6],
      address: poc[0].split("|")[7],
      email: poc[0].split("|")[4]
    };
  }
  class OwsHelper {
  }
  class WmsHelper extends OwsHelper {
    async getMetadata(serviceType, url, layerName) {
      console.assert(serviceType === REMOTE_SERVICE_TYPE.WMS);
      const wmsEndpoint = remoteLayersService.getWmsEndpoint(url);
      await wmsEndpoint.isReady();
      const service = wmsEndpoint == null ? void 0 : wmsEndpoint.getServiceInfo();
      const layer = wmsEndpoint == null ? void 0 : wmsEndpoint.getLayerByName(layerName);
      return {
        title: layer.title,
        description: layer.abstract,
        keywords: service.keywords,
        accessConstraints: service.constraints,
        serviceDescription: service.abstract
      };
    }
  }
  const wmsHelper = new WmsHelper();
  class WmtsHelper extends OwsHelper {
    async getMetadata(serviceType, url, layerName) {
      console.assert(serviceType === REMOTE_SERVICE_TYPE.WMTS);
      const wmtsEndpoint = remoteLayersService.getWmtsEndpoint(url);
      await wmtsEndpoint.isReady();
      const service = wmtsEndpoint == null ? void 0 : wmtsEndpoint.getServiceInfo();
      const layer = wmtsEndpoint == null ? void 0 : wmtsEndpoint.getLayerByName(layerName);
      return {
        title: layer.title,
        description: layer.abstract,
        accessConstraints: service.constraints,
        serviceDescription: service.abstract
      };
    }
  }
  const wmtsHelper = new WmtsHelper();
  class RemoteMetadataHelper {
    async getMetadata(serviceType, url, layerName) {
      if (serviceType === REMOTE_SERVICE_TYPE.WMS) {
        return wmsHelper.getMetadata(serviceType, url, layerName);
      } else if (serviceType === REMOTE_SERVICE_TYPE.WMTS) {
        return wmtsHelper.getMetadata(serviceType, url, layerName);
      } else {
        throw new Error(`Unsupported service type: ${serviceType}`);
      }
    }
  }
  const remoteMetadataHelper = new RemoteMetadataHelper();
  class LayerMetadataService {
    constructor() {
      __publicField(this, "geonetworkBaseUrl", "https://geocatalogue.geoportail.lu/geonetwork/srv");
      __publicField(this, "legendBaseUrl", "https://map.geoportail.lu/legends/get_html");
      __publicField(this, "localMetadataBaseUrl", "https://map.geoportail.lu/getMetadata");
    }
    async getLayerMetadata(id, currentLanguage) {
      const layer = useThemes().findBgLayerById(+id) || useThemes().findById(+id);
      if (layer) {
        const localMetadata = layer.metadata;
        const metadataId = localMetadata == null ? void 0 : localMetadata.metadata_id;
        const metadata = metadataId && await this.getLocalMetadata(
          this.localMetadataBaseUrl,
          metadataId,
          currentLanguage
        );
        const title = layer.name;
        const legendName = (localMetadata == null ? void 0 : localMetadata.legend_name) || "";
        const layerId = layer == null ? void 0 : layer.id;
        const legendHtml = legendName && await this.getLegendHtml(
          this.legendBaseUrl,
          legendName,
          layerId,
          currentLanguage
        );
        return {
          ...metadata,
          title,
          hasLegend: !!legendHtml,
          ...legendHtml && { legendHtml }
        };
      } else {
        const [serviceType, url, layerName] = String(id).split("%2D").join("-").split("||");
        return remoteMetadataHelper.getMetadata(
          serviceType,
          url,
          layerName
        );
      }
    }
    getLocalMetadata(baseUrl, metadataUid, language) {
      return fetch(`${baseUrl}?lang=${language}&uid=${metadataUid}`).then(async (response) => {
        const metadata = (await response.json()).metadata;
        return {
          name: metadata.title,
          serviceDescription: metadata.serviceDescription,
          description: metadata.abstract,
          legalConstraints: metadata.legalConstraints,
          link: getMetadataLinks(metadata.link),
          revisionDate: metadata.revisionDate,
          keyword: metadata.keyword,
          responsibleParty: metadata.responsibleParty ? getResponsibleParty(metadata.responsibleParty) : void 0,
          metadataLink: `${this.geonetworkBaseUrl}/${isoLang2To3(
            language
          )}/catalog.search#/metadata/${metadataUid}`,
          isError: false
        };
      }).catch(() => {
        return { isError: true };
      });
    }
    getLegendHtml(legendBaseUrl, legendName, layerId, language) {
      const queryParams = {
        lang: language,
        ...legendName && { name: legendName },
        ...layerId && { id: layerId.toString() }
      };
      if (queryParams.name && queryParams.lang) {
        if (window.devicePixelRatio > 1) {
          queryParams.dpi = (window.devicePixelRatio * 96).toString();
        }
        const legendUrl = `${legendBaseUrl}?${new URLSearchParams(
          queryParams
        ).toString()}`;
        return fetch(legendUrl).then(async (response) => {
          if (response.status >= 400 && response.status < 600) {
            throw new Error("Server responded with error code");
          }
          const legendString = await response.text();
          return legendString ? stringToHtml(legendString) : void 0;
        }).catch(() => {
          return void 0;
        });
      }
    }
  }
  const layerMetadataService = new LayerMetadataService();
  const _hoisted_1$2 = {
    key: 0,
    class: "fixed right-32 top-32 z-[100] bg-white lux-modal w-[600px] p-3",
    role: "dialog"
  };
  const _hoisted_2$2 = { class: "lux-modal-header flex flex-row justify-between" };
  const _hoisted_3$2 = { class: "grid gap-2 grid-cols-3 pt-3 text-[13px] font-arial break-words" };
  const _hoisted_4$2 = {
    key: 2,
    class: "col-span-3 grid gap-2 grid-cols-3"
  };
  const _hoisted_5$2 = { class: "font-bold" };
  const _hoisted_6 = { class: "col-span-2" };
  const _hoisted_7 = ["title"];
  const _hoisted_8 = ["title"];
  const _hoisted_9 = {
    key: 4,
    class: "col-span-3"
  };
  const _hoisted_10 = { class: "font-bold" };
  const _hoisted_11 = { class: "col-span-2" };
  const _hoisted_12 = ["href"];
  const _hoisted_13 = {
    key: 7,
    class: "col-span-3 grid gap-2 grid-cols-3"
  };
  const _hoisted_14 = { class: "font-bold" };
  const _hoisted_15 = { class: "col-span-2" };
  const _hoisted_16 = { key: 0 };
  const _hoisted_17 = { key: 1 };
  const _hoisted_18 = { key: 2 };
  const _hoisted_19 = { key: 3 };
  const _hoisted_20 = { key: 4 };
  const _hoisted_21 = ["href"];
  const _hoisted_22 = {
    key: 8,
    class: "grid gap-2 grid-cols-3 col-span-3"
  };
  const _hoisted_23 = { class: "font-bold" };
  const _hoisted_24 = { class: "col-span-2" };
  const _hoisted_25 = ["href"];
  const _hoisted_26 = {
    key: 9,
    class: "col-span-3"
  };
  const _hoisted_27 = { key: 10 };
  const _hoisted_28 = { class: "text-xl" };
  const _hoisted_29 = {
    key: 11,
    class: "col-span-3"
  };
  const _sfc_main$3 = /* @__PURE__ */ vue.defineComponent({
    __name: "layer-metadata",
    setup(__props) {
      const metadataStore = useMetadataStore();
      const { metadataId } = storeToRefs(metadataStore);
      const { t, i18next } = useTranslation();
      const layerMetadata = vue.ref();
      const displayFullDescription = vue.ref(true);
      const MAX_DESCRIPTION_LENGTH = 220;
      vue.watch(metadataId, async (id) => {
        var _a, _b;
        layerMetadata.value = id ? await layerMetadataService.getLayerMetadata(id, i18next.language) : void 0;
        displayFullDescription.value = (((_b = (_a = layerMetadata.value) == null ? void 0 : _a.description) == null ? void 0 : _b.length) || "") < MAX_DESCRIPTION_LENGTH;
      });
      vue.onMounted(() => {
        i18next.on("languageChanged", async () => {
          if (metadataId.value) {
            layerMetadata.value = await layerMetadataService.getLayerMetadata(
              metadataId.value,
              i18next.language
            );
          }
        });
      });
      const description = vue.computed(
        () => {
          var _a, _b, _c;
          return displayFullDescription.value ? (_a = layerMetadata.value) == null ? void 0 : _a.description : (_c = (_b = layerMetadata.value) == null ? void 0 : _b.description) == null ? void 0 : _c.slice(0, MAX_DESCRIPTION_LENGTH);
        }
      );
      function showFullDescription() {
        displayFullDescription.value = true;
      }
      function hideFullDescription() {
        displayFullDescription.value = false;
      }
      function closeLayerMetadata() {
        metadataStore.clearMetadataId();
      }
      return (_ctx, _cache) => {
        var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j, _k, _l, _m, _n, _o;
        const _directive_dompurify_html = vue.resolveDirective("dompurify-html");
        return layerMetadata.value ? (vue.openBlock(), vue.createElementBlock("div", _hoisted_1$2, [
          vue.createElementVNode("div", _hoisted_2$2, [
            vue.createElementVNode("h1", null, vue.toDisplayString(vue.unref(t)(`${layerMetadata.value.title}`)), 1),
            vue.createElementVNode("button", { onClick: closeLayerMetadata }, "X")
          ]),
          vue.createElementVNode("div", _hoisted_3$2, [
            layerMetadata.value.name ? (vue.openBlock(), vue.createBlock(_sfc_main$4, {
              key: 0,
              label: vue.unref(t)("Name"),
              value: layerMetadata.value.name
            }, null, 8, ["label", "value"])) : vue.createCommentVNode("", true),
            layerMetadata.value.serviceDescription ? (vue.openBlock(), vue.createBlock(_sfc_main$4, {
              key: 1,
              label: vue.unref(t)("Description du Service"),
              value: layerMetadata.value.serviceDescription
            }, null, 8, ["label", "value"])) : vue.createCommentVNode("", true),
            layerMetadata.value.description ? (vue.openBlock(), vue.createElementBlock("div", _hoisted_4$2, [
              vue.createElementVNode("span", _hoisted_5$2, vue.toDisplayString(vue.unref(t)("Description")), 1),
              vue.createElementVNode("span", _hoisted_6, [
                vue.withDirectives(vue.createElementVNode("span", null, null, 512), [
                  [_directive_dompurify_html, vue.unref(description)]
                ]),
                !displayFullDescription.value ? (vue.openBlock(), vue.createElementBlock("button", {
                  key: 0,
                  title: vue.unref(t)("Display full description", {
                    ns: "client"
                  }),
                  onClick: showFullDescription,
                  class: "text-secondary hover:underline"
                }, " ... ", 8, _hoisted_7)) : vue.createCommentVNode("", true),
                displayFullDescription.value && (((_a = vue.unref(description)) == null ? void 0 : _a.length) || "") > MAX_DESCRIPTION_LENGTH ? (vue.openBlock(), vue.createElementBlock("button", {
                  key: 1,
                  title: vue.unref(t)("Hide full description", {
                    ns: "client"
                  }),
                  onClick: hideFullDescription,
                  class: "text-secondary hover:underline"
                }, " - ", 8, _hoisted_8)) : vue.createCommentVNode("", true)
              ])
            ])) : vue.createCommentVNode("", true),
            layerMetadata.value.legalConstraints ? (vue.openBlock(), vue.createBlock(_sfc_main$4, {
              key: 3,
              label: vue.unref(t)(`Contrainte d'utilisation`),
              value: layerMetadata.value.legalConstraints
            }, null, 8, ["label", "value"])) : vue.createCommentVNode("", true),
            ((_b = layerMetadata.value.link) == null ? void 0 : _b.length) !== 0 ? (vue.openBlock(), vue.createElementBlock("div", _hoisted_9, [
              (vue.openBlock(true), vue.createElementBlock(vue.Fragment, null, vue.renderList(layerMetadata.value.link, (link) => {
                return vue.openBlock(), vue.createElementBlock("div", {
                  class: "grid gap-2 grid-cols-3",
                  key: link
                }, [
                  vue.createElementVNode("span", _hoisted_10, vue.toDisplayString(vue.unref(t)("Url vers la resource")), 1),
                  vue.createElementVNode("span", _hoisted_11, [
                    vue.createElementVNode("a", {
                      class: "text-secondary hover:underline",
                      target: "_blank",
                      href: link
                    }, vue.toDisplayString(link), 9, _hoisted_12)
                  ])
                ]);
              }), 128))
            ])) : vue.createCommentVNode("", true),
            layerMetadata.value.revisionDate ? (vue.openBlock(), vue.createBlock(_sfc_main$4, {
              key: 5,
              label: vue.unref(t)("Revision date"),
              value: vue.unref(formatDate)(layerMetadata.value.revisionDate, vue.unref(i18next).language)
            }, null, 8, ["label", "value"])) : vue.createCommentVNode("", true),
            layerMetadata.value.keyword ? (vue.openBlock(), vue.createBlock(_sfc_main$4, {
              key: 6,
              label: vue.unref(t)("Keywords"),
              value: (_c = layerMetadata.value.keyword) == null ? void 0 : _c.join(",")
            }, null, 8, ["label", "value"])) : vue.createCommentVNode("", true),
            layerMetadata.value.responsibleParty ? (vue.openBlock(), vue.createElementBlock("div", _hoisted_13, [
              vue.createElementVNode("span", _hoisted_14, vue.toDisplayString(vue.unref(t)("Contact")), 1),
              vue.createElementVNode("span", _hoisted_15, [
                ((_d = layerMetadata.value.responsibleParty) == null ? void 0 : _d.organisaton) ? (vue.openBlock(), vue.createElementBlock("p", _hoisted_16, vue.toDisplayString((_e = layerMetadata.value.responsibleParty) == null ? void 0 : _e.organisaton), 1)) : vue.createCommentVNode("", true),
                ((_f = layerMetadata.value.responsibleParty) == null ? void 0 : _f.name) ? (vue.openBlock(), vue.createElementBlock("p", _hoisted_17, vue.toDisplayString((_g = layerMetadata.value.responsibleParty) == null ? void 0 : _g.name), 1)) : vue.createCommentVNode("", true),
                ((_h = layerMetadata.value.responsibleParty) == null ? void 0 : _h.unknown) ? (vue.openBlock(), vue.createElementBlock("p", _hoisted_18, vue.toDisplayString((_i = layerMetadata.value.responsibleParty) == null ? void 0 : _i.unknown), 1)) : vue.createCommentVNode("", true),
                ((_j = layerMetadata.value.responsibleParty) == null ? void 0 : _j.address) ? (vue.openBlock(), vue.createElementBlock("p", _hoisted_19, vue.toDisplayString((_k = layerMetadata.value.responsibleParty) == null ? void 0 : _k.address), 1)) : vue.createCommentVNode("", true),
                ((_l = layerMetadata.value.responsibleParty) == null ? void 0 : _l.email) ? (vue.openBlock(), vue.createElementBlock("p", _hoisted_20, [
                  vue.createElementVNode("a", {
                    class: "text-secondary hover:underline",
                    href: "mailto:" + ((_m = layerMetadata.value.responsibleParty) == null ? void 0 : _m.email)
                  }, vue.toDisplayString((_n = layerMetadata.value.responsibleParty) == null ? void 0 : _n.email), 9, _hoisted_21)
                ])) : vue.createCommentVNode("", true)
              ])
            ])) : vue.createCommentVNode("", true),
            layerMetadata.value.metadataLink ? (vue.openBlock(), vue.createElementBlock("div", _hoisted_22, [
              vue.createElementVNode("span", _hoisted_23, vue.toDisplayString(vue.unref(t)("Link to the metadata")), 1),
              vue.createElementVNode("span", _hoisted_24, [
                vue.createElementVNode("a", {
                  class: "text-secondary hover:underline",
                  target: "_blank",
                  href: layerMetadata.value.metadataLink
                }, vue.toDisplayString(vue.unref(t)("link")), 9, _hoisted_25)
              ])
            ])) : vue.createCommentVNode("", true),
            layerMetadata.value.isError ? (vue.openBlock(), vue.createElementBlock("div", _hoisted_26, vue.toDisplayString(vue.unref(t)("The metadata is right now not available")), 1)) : vue.createCommentVNode("", true),
            layerMetadata.value.legendHtml ? (vue.openBlock(), vue.createElementBlock("div", _hoisted_27, [
              vue.createElementVNode("h4", _hoisted_28, vue.toDisplayString(vue.unref(t)("Legend")), 1),
              vue.withDirectives(vue.createElementVNode("span", null, null, 512), [
                [_directive_dompurify_html, (_o = layerMetadata.value.legendHtml) == null ? void 0 : _o.innerHTML]
              ])
            ])) : vue.createCommentVNode("", true),
            !layerMetadata.value.hasLegend ? (vue.openBlock(), vue.createElementBlock("div", _hoisted_29, vue.toDisplayString(vue.unref(t)("The legend is not available for this layer")), 1)) : vue.createCommentVNode("", true)
          ])
        ])) : vue.createCommentVNode("", true);
      };
    }
  });
  const _hoisted_1$1 = { class: "flex flex-col h-full" };
  const _hoisted_2$1 = { class: "h-20 shrink-0 flex justify-between lux-panel-title" };
  const _hoisted_3$1 = ["aria-label"];
  const _hoisted_4$1 = { class: "flex flex-row gap-2 h-10 text-2xl" };
  const _hoisted_5$1 = { class: "relative grow p-2.5 bg-primary overflow-auto" };
  const _sfc_main$2 = /* @__PURE__ */ vue.defineComponent({
    __name: "layer-panel",
    setup(__props) {
      const { t } = useTranslation();
      const myLayersOpen = vue.ref(true);
      const { setLayersOpen } = useAppStore();
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock("div", _hoisted_1$1, [
          vue.createElementVNode("div", _hoisted_2$1, [
            vue.createElementVNode("span", null, vue.toDisplayString(vue.unref(t)("Layers", { ns: "client" })), 1),
            vue.createElementVNode("span", null, [
              vue.createElementVNode("button", {
                onClick: _cache[0] || (_cache[0] = () => vue.unref(setLayersOpen)(false)),
                "aria-label": vue.unref(t)("Close", { ns: "client" }),
                class: "fa-sharp fa-solid fa-close"
              }, null, 8, _hoisted_3$1)
            ])
          ]),
          vue.createElementVNode("div", _hoisted_4$1, [
            vue.createElementVNode("button", {
              onClick: _cache[1] || (_cache[1] = () => myLayersOpen.value = true),
              class: vue.normalizeClass(["text-white basis-1/2 hover:bg-primary cursor-pointer text-center uppercase", myLayersOpen.value ? "bg-primary" : "bg-tertiary"])
            }, vue.toDisplayString(vue.unref(t)("my_layers", { ns: "client" })), 3),
            vue.createElementVNode("button", {
              onClick: _cache[2] || (_cache[2] = ($event) => myLayersOpen.value = false),
              class: vue.normalizeClass(["text-white basis-1/2 hover:bg-primary cursor-pointer text-center uppercase", myLayersOpen.value ? "bg-tertiary" : "bg-primary"])
            }, vue.toDisplayString(vue.unref(t)("Catalog", { ns: "client" })), 3)
          ]),
          vue.createElementVNode("div", _hoisted_5$1, [
            !myLayersOpen.value ? (vue.openBlock(), vue.createBlock(_sfc_main$6, { key: 0 })) : vue.createCommentVNode("", true),
            myLayersOpen.value ? (vue.openBlock(), vue.createBlock(_sfc_main$j, { key: 1 })) : vue.createCommentVNode("", true)
          ]),
          vue.createVNode(_sfc_main$5),
          vue.createVNode(_sfc_main$3)
        ]);
      };
    }
  });
  class OlSynchronizer {
    constructor(map2) {
      __publicField(this, "previousLayers");
      __publicField(this, "previousVectorSources");
      const mapStore = useMapStore();
      const styleStore = useStyleStore();
      const mapService = useMap();
      const styleService = useMvtStyles();
      const openLayers = useOpenLayers();
      vue.watch(
        () => mapStore.layers,
        (layers) => {
          console.log("watch layers");
          const oldContext = {
            layers: this.previousLayers
          };
          const newContext = {
            layers
          };
          const removedLayers = mapService.getRemovedLayers(
            newContext,
            oldContext
          );
          const addedLayerComparisons = mapService.getAddedLayers(
            newContext,
            oldContext
          );
          const mutatedLayerComparisons = mapService.getMutatedLayers(
            newContext,
            oldContext
          );
          removedLayers.forEach((layer) => openLayers.removeLayer(map2, layer.id));
          addedLayerComparisons.forEach(
            (cmp) => openLayers.addLayer(map2, cmp.layer)
          );
          mutatedLayerComparisons.forEach((layer) => {
            openLayers.setLayerOpacity(map2, layer.id, layer.opacity);
          });
          if (newContext.layers) {
            openLayers.reorderLayers(map2, newContext.layers);
          }
          this.previousLayers = layers;
        }
      );
      vue.watch(
        () => mapStore.bgLayer,
        (bgLayer) => bgLayer !== void 0 && openLayers.setBgLayer(map2, bgLayer, styleStore.bgVectorSources)
      );
      vue.watch(
        () => styleStore.bgStyle,
        (newStyle) => openLayers.applyOnBgLayer(
          map2,
          (bgLayer) => styleService.applyStyle(bgLayer, newStyle || [])
        )
      );
      vue.watch(
        () => styleStore.bgVectorSources,
        (newVectorSources) => {
          var _a;
          for (const id of newVectorSources.keys()) {
            if (!this.previousVectorSources || this.previousVectorSources.get(id) !== newVectorSources.get(id)) {
              openLayers.removeFromCache(id);
              if (id === ((_a = mapStore == null ? void 0 : mapStore.bgLayer) == null ? void 0 : _a.id)) {
                openLayers.setBgLayer(map2, mapStore == null ? void 0 : mapStore.bgLayer, newVectorSources);
              }
            }
          }
          this.previousVectorSources = newVectorSources;
        }
      );
    }
  }
  const V2_ZOOM_TO_V3_ZOOM_ = {
    "0": 8,
    "1": 9,
    "2": 9,
    "3": 10,
    "4": 11,
    "5": 12,
    "6": 13,
    "7": 14,
    "8": 16,
    "9": 17,
    "10": 18,
    "11": 19,
    "12": 20,
    "13": 21
  };
  class StatePersistorMapService {
    bootstrap() {
      this.restore();
      this.persist();
    }
    persistZoom() {
      const view = useMap().getOlMap().getView();
      const fnStorageSetValueZoom = () => {
        const zoom = view.getZoom();
        storageHelper.setValue(SP_KEY_ZOOM, zoom ? Math.ceil(zoom) : null);
      };
      fnStorageSetValueZoom();
      listen(
        view,
        "change:resolution",
        debounce(fnStorageSetValueZoom, 300)
      );
    }
    persistXY() {
      const view = useMap().getOlMap().getView();
      const fnStorageSetValueXY = () => {
        const center = view.getCenter();
        storageHelper.setValue(SP_KEY_X, center ? Math.round(center[0]) : null);
        storageHelper.setValue(SP_KEY_Y, center ? Math.round(center[1]) : null);
      };
      fnStorageSetValueXY();
      listen(
        view,
        ObjectEventType.PROPERTYCHANGE,
        debounce(fnStorageSetValueXY, 300)
      );
    }
    persist() {
      this.persistXY();
      this.persistZoom();
    }
    restore() {
      const view = useMap().getOlMap().getView();
      const zoom = storageHelper.getValue(SP_KEY_ZOOM, stringToNumber);
      const version2 = storageHelper.getInitialVersion();
      const x = storageHelper.getValue(SP_KEY_X, stringToNumber);
      const y2 = storageHelper.getValue(SP_KEY_Y, stringToNumber);
      const srs = storageHelper.getValue(SP_KEY_SRS);
      const lurefToWebMercatorFn = getTransform(
        PROJECTION_LUX,
        PROJECTION_WEBMERCATOR
      );
      let viewCenter;
      let viewZoom;
      if (zoom !== void 0) {
        viewZoom = version2 === 3 ? Number(zoom) : V2_ZOOM_TO_V3_ZOOM_[zoom];
      } else {
        viewZoom = 8;
      }
      if (x != null && y2 != null) {
        if (version2 === 3 && srs != null) {
          viewCenter = transform$1([x, y2], srs, PROJECTION_WEBMERCATOR);
        } else {
          viewCenter = version2 === 3 ? [x, y2] : lurefToWebMercatorFn([y2, x], void 0, 2);
        }
      } else {
        viewCenter = transform$1(
          [6, 49.7],
          PROJECTION_WGS84,
          PROJECTION_WEBMERCATOR
        );
      }
      view.setCenter(viewCenter);
      view.setZoom(viewZoom);
    }
  }
  const statePersistorMapService = new StatePersistorMapService();
  const _sfc_main$1 = /* @__PURE__ */ vue.defineComponent({
    __name: "map-container",
    setup(__props) {
      const map2 = useMap();
      const mapContainer = vue.ref(null);
      vue.onMounted(async () => {
        if (mapContainer.value) {
          map2.createMap(mapContainer.value);
          new OlSynchronizer(map2.getOlMap());
          statePersistorMapService.bootstrap();
          window.olMap = map2.getOlMap();
        }
      });
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock("div", {
          ref_key: "mapContainer",
          ref: mapContainer,
          class: "h-full w-full bg-white"
        }, null, 512);
      };
    }
  });
  class StatePersistorLayersService {
    bootstrap() {
      const themeStore = useThemeStore();
      let stop;
      stop = vue.watchEffect(() => {
        if (themeStore.themes) {
          this.restore();
          this.persist();
          stop && stop();
        }
      });
    }
    persist() {
      const mapStore = useMapStore();
      const { layers } = storeToRefs(mapStore);
      vue.watch(
        layers,
        (value, oldValue) => {
          if (oldValue !== value) {
            storageHelper.setValue(
              SP_KEY_LAYERS,
              value,
              storageLayerMapper.layersToLayerIds
            );
            storageHelper.setValue(
              SP_KEY_OPACITIES,
              value,
              storageLayerMapper.layersToLayerOpacities
            );
          }
        },
        { immediate: true }
      );
    }
    restore() {
      const version2 = storageHelper.getInitialVersion();
      const mapStore = useMapStore();
      const layers = storageHelper.getValue(
        SP_KEY_LAYERS,
        version2 === 2 ? storageLayerMapper.layerNamesToLayersV2 : storageLayerMapper.layerIdsToLayers
      );
      const opacities = version2 === 2 ? this.getOpacitiesFromStorageV2() : this.getOpacitiesFromStorage();
      if (opacities) {
        layers == null ? void 0 : layers.forEach((layer, index2) => {
          var _a;
          if (layer) {
            layer.opacity = (_a = opacities[index2]) != null ? _a : 1;
          }
        });
      }
      if (version2 === 2) {
        storageHelper.removeItem(SP_KEY_V2_BGLAYEROPACITY);
        storageHelper.removeItem(SP_KEY_V2_LAYERSINDICIES);
        storageHelper.removeItem(SP_KEY_V2_LAYERSOPACITIES);
        storageHelper.removeItem(SP_KEY_V2_LAYERSVISIBILITY);
      }
      mapStore.addLayers(...(layers == null ? void 0 : layers.filter((layer) => layer)) || []);
    }
    getOpacitiesFromStorage() {
      return storageHelper.getValue(
        SP_KEY_OPACITIES,
        storageLayerMapper.layersOpacitiesToNumbers
      );
    }
    getOpacitiesFromStorageV2() {
      const opacities = storageHelper.getValue(
        SP_KEY_V2_LAYERSOPACITIES,
        storageLayerMapper.layersOpacitiesToNumbersV2
      );
      const visibility = storageHelper.getValue(
        SP_KEY_V2_LAYERSVISIBILITY,
        storageLayerMapper.layersVisibilitiesToBooleansV2
      );
      return opacities.map((opacity, index2) => visibility[index2] ? opacity : 0);
    }
  }
  const statePersistorLayersService = new StatePersistorLayersService();
  class StorageThemeMapper {
    themeToThemeName(theme) {
      return (theme == null ? void 0 : theme.name) || "";
    }
  }
  const storageThemeMapper = new StorageThemeMapper();
  class StatePersistorThemeService {
    bootstrap() {
      this.restore();
      let stop;
      stop = vue.watchEffect(() => {
        this.persist();
        stop && stop();
      });
    }
    persist() {
      const themeStore = useThemeStore();
      vue.watch(
        () => themeStore.theme,
        (value, oldValue) => {
          if (oldValue !== value && value) {
            storageHelper.setValue(
              SP_KEY_THEME,
              value,
              storageThemeMapper.themeToThemeName
            );
          }
        },
        { immediate: true }
      );
    }
    restore() {
      const theme = storageHelper.getValue(SP_KEY_THEME);
      if (theme) {
        const { setTheme } = useThemeStore();
        setTheme(theme);
      }
    }
  }
  const statePersistorThemeService = new StatePersistorThemeService();
  class StatePersistorLayersOpenService {
    bootstrapLayersOpen() {
      this.restoreLayersOpen();
      let stop;
      stop = vue.watchEffect(() => {
        this.persistLayersOpen();
        stop && stop();
      });
    }
    persistLayersOpen() {
      const appStore = useAppStore();
      const { layersOpen } = storeToRefs(appStore);
      vue.watch(
        layersOpen,
        (value, oldValue) => {
          if (oldValue !== value) {
            storageHelper.setValue(SP_KEY_LAYERS_OPEN, value);
          }
        },
        { immediate: true }
      );
    }
    restoreLayersOpen() {
      const layersOpen = storageHelper.getValue(SP_KEY_LAYERS_OPEN) !== "false";
      const { setLayersOpen } = useAppStore();
      setLayersOpen(layersOpen);
    }
  }
  const statePersistorLayersOpenService = new StatePersistorLayersOpenService();
  const _hoisted_1 = { class: "h-screen flex flex-col overflow-hidden" };
  const _hoisted_2 = { class: "flex grow" };
  const _hoisted_3 = {
    key: 0,
    class: "w-full sm:w-80 bg-secondary z-10"
  };
  const _hoisted_4 = { class: "grow bg-blue-100" };
  const _hoisted_5 = { class: "absolute right-1 top-16" };
  const _sfc_main = /* @__PURE__ */ vue.defineComponent({
    __name: "App",
    setup(__props) {
      statePersistorLayersService.bootstrap();
      statePersistorThemeService.bootstrap();
      statePersistorLayersOpenService.bootstrapLayersOpen();
      const { layersOpen } = storeToRefs(useAppStore());
      vue.watch(
        layersOpen,
        () => setTimeout(() => {
          useMap().getOlMap().updateSize();
        }, 50)
      );
      return (_ctx, _cache) => {
        return vue.openBlock(), vue.createElementBlock("div", _hoisted_1, [
          vue.createVNode(_sfc_main$f),
          vue.createElementVNode("main", _hoisted_2, [
            vue.unref(layersOpen) ? (vue.openBlock(), vue.createElementBlock("div", _hoisted_3, [
              vue.createVNode(_sfc_main$2)
            ])) : vue.createCommentVNode("", true),
            vue.createElementVNode("div", _hoisted_4, [
              vue.createVNode(_sfc_main$1)
            ]),
            vue.createElementVNode("div", _hoisted_5, [
              vue.createVNode(_sfc_main$a)
            ])
          ]),
          vue.createVNode(_sfc_main$c, { class: "fixed bottom-5 sm:relative sm:bottom-0" })
        ]);
      };
    }
  });
  initProjections();
  instance.use(Backend);
  instance.init({
    lng: "fr",
    debug: false,
    defaultNS: "client",
    supportedLngs: ["de", "en", "fr", "lb"],
    ns: ["client", "legends", "server", "tooltips"],
    fallbackLng: "fr",
    backend: {
      loadPath: `${"/"}assets/locales/{{ns}}.{{lng}}.json`
    }
  });
  const app = vue.createApp(_sfc_main);
  app.use(createPinia());
  app.use(install, { i18next: instance });
  app.use(y);
  const createElementInstance = (component = {}, app2 = null) => {
    return defineCustomElement({
      setup: () => {
        const inst = vue.getCurrentInstance();
        Object.assign(inst.appContext, app2._context);
        Object.assign(inst.provides, app2._context.provides);
      },
      render: () => vue.h(component)
    }, { shadowRoot: false });
  };
  exports2.App = _sfc_main;
  exports2.CatalogTree = _sfc_main$h;
  exports2.DropdownList = _sfc_main$o;
  exports2.I18NextVue = install;
  exports2.LayerManager = _sfc_main$j;
  exports2.VueDOMPurifyHTML = y;
  exports2.app = app;
  exports2.backend = Backend;
  exports2.createElementInstance = createElementInstance;
  exports2.createPinia = createPinia;
  exports2.defineCustomElement = defineCustomElement;
  exports2.i18next = instance;
  Object.defineProperties(exports2, { __esModule: { value: true }, [Symbol.toStringTag]: { value: "Module" } });
});
